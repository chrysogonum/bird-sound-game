var F1=Object.defineProperty;var O1=(t,e,r)=>e in t?F1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ln=(t,e,r)=>O1(t,typeof e!="symbol"?e+"":e,r);function L1(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var mo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function U1(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var fv={exports:{}},_u={},pv={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ea=Symbol.for("react.element"),j1=Symbol.for("react.portal"),G1=Symbol.for("react.fragment"),z1=Symbol.for("react.strict_mode"),H1=Symbol.for("react.profiler"),$1=Symbol.for("react.provider"),W1=Symbol.for("react.context"),V1=Symbol.for("react.forward_ref"),X1=Symbol.for("react.suspense"),Y1=Symbol.for("react.memo"),K1=Symbol.for("react.lazy"),Kp=Symbol.iterator;function q1(t){return t===null||typeof t!="object"?null:(t=Kp&&t[Kp]||t["@@iterator"],typeof t=="function"?t:null)}var mv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gv=Object.assign,yv={};function Ns(t,e,r){this.props=t,this.context=e,this.refs=yv,this.updater=r||mv}Ns.prototype.isReactComponent={};Ns.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ns.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function vv(){}vv.prototype=Ns.prototype;function _f(t,e,r){this.props=t,this.context=e,this.refs=yv,this.updater=r||mv}var wf=_f.prototype=new vv;wf.constructor=_f;gv(wf,Ns.prototype);wf.isPureReactComponent=!0;var qp=Array.isArray,xv=Object.prototype.hasOwnProperty,Ef={current:null},_v={key:!0,ref:!0,__self:!0,__source:!0};function wv(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)xv.call(e,n)&&!_v.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:ea,type:t,key:s,ref:o,props:i,_owner:Ef.current}}function Z1(t,e){return{$$typeof:ea,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sf(t){return typeof t=="object"&&t!==null&&t.$$typeof===ea}function Q1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Zp=/\/+/g;function tc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Q1(""+t.key):e.toString(36)}function sl(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ea:case j1:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+tc(o,0):n,qp(i)?(r="",t!=null&&(r=t.replace(Zp,"$&/")+"/"),sl(i,e,r,"",function(u){return u})):i!=null&&(Sf(i)&&(i=Z1(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Zp,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",qp(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+tc(s,a);o+=sl(s,e,r,l,i)}else if(l=q1(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+tc(s,a++),o+=sl(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ma(t,e,r){if(t==null)return t;var n=[],i=0;return sl(t,n,"","",function(s){return e.call(r,s,i++)}),n}function J1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var xt={current:null},ol={transition:null},ew={ReactCurrentDispatcher:xt,ReactCurrentBatchConfig:ol,ReactCurrentOwner:Ef};function Ev(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:ma,forEach:function(t,e,r){ma(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return ma(t,function(){e++}),e},toArray:function(t){return ma(t,function(e){return e})||[]},only:function(t){if(!Sf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};de.Component=Ns;de.Fragment=G1;de.Profiler=H1;de.PureComponent=_f;de.StrictMode=z1;de.Suspense=X1;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ew;de.act=Ev;de.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=gv({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Ef.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)xv.call(e,l)&&!_v.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:ea,type:t.type,key:i,ref:s,props:n,_owner:o}};de.createContext=function(t){return t={$$typeof:W1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:$1,_context:t},t.Consumer=t};de.createElement=wv;de.createFactory=function(t){var e=wv.bind(null,t);return e.type=t,e};de.createRef=function(){return{current:null}};de.forwardRef=function(t){return{$$typeof:V1,render:t}};de.isValidElement=Sf;de.lazy=function(t){return{$$typeof:K1,_payload:{_status:-1,_result:t},_init:J1}};de.memo=function(t,e){return{$$typeof:Y1,type:t,compare:e===void 0?null:e}};de.startTransition=function(t){var e=ol.transition;ol.transition={};try{t()}finally{ol.transition=e}};de.unstable_act=Ev;de.useCallback=function(t,e){return xt.current.useCallback(t,e)};de.useContext=function(t){return xt.current.useContext(t)};de.useDebugValue=function(){};de.useDeferredValue=function(t){return xt.current.useDeferredValue(t)};de.useEffect=function(t,e){return xt.current.useEffect(t,e)};de.useId=function(){return xt.current.useId()};de.useImperativeHandle=function(t,e,r){return xt.current.useImperativeHandle(t,e,r)};de.useInsertionEffect=function(t,e){return xt.current.useInsertionEffect(t,e)};de.useLayoutEffect=function(t,e){return xt.current.useLayoutEffect(t,e)};de.useMemo=function(t,e){return xt.current.useMemo(t,e)};de.useReducer=function(t,e,r){return xt.current.useReducer(t,e,r)};de.useRef=function(t){return xt.current.useRef(t)};de.useState=function(t){return xt.current.useState(t)};de.useSyncExternalStore=function(t,e,r){return xt.current.useSyncExternalStore(t,e,r)};de.useTransition=function(){return xt.current.useTransition()};de.version="18.3.1";pv.exports=de;var T=pv.exports;const Sv=xf(T),tw=L1({__proto__:null,default:Sv},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rw=T,nw=Symbol.for("react.element"),iw=Symbol.for("react.fragment"),sw=Object.prototype.hasOwnProperty,ow=rw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,aw={key:!0,ref:!0,__self:!0,__source:!0};function Tv(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)sw.call(e,n)&&!aw.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:nw,type:t,key:s,ref:o,props:i,_owner:ow.current}}_u.Fragment=iw;_u.jsx=Tv;_u.jsxs=Tv;fv.exports=_u;var _=fv.exports,bh={},bv={exports:{}},Ot={},Av={exports:{}},Cv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(I,j){var P=I.length;I.push(j);e:for(;0<P;){var k=P-1>>>1,q=I[k];if(0<i(q,j))I[k]=j,I[P]=q,P=k;else break e}}function r(I){return I.length===0?null:I[0]}function n(I){if(I.length===0)return null;var j=I[0],P=I.pop();if(P!==j){I[0]=P;e:for(var k=0,q=I.length,fe=q>>>1;k<fe;){var ue=2*(k+1)-1,Ie=I[ue],ve=ue+1,xe=I[ve];if(0>i(Ie,P))ve<q&&0>i(xe,Ie)?(I[k]=xe,I[ve]=P,k=ve):(I[k]=Ie,I[ue]=P,k=ue);else if(ve<q&&0>i(xe,P))I[k]=xe,I[ve]=P,k=ve;else break e}}return j}function i(I,j){var P=I.sortIndex-j.sortIndex;return P!==0?P:I.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,f=!1,p=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(I){for(var j=r(u);j!==null;){if(j.callback===null)n(u);else if(j.startTime<=I)n(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=r(u)}}function w(I){if(m=!1,g(I),!p)if(r(l)!==null)p=!0,J(S);else{var j=r(u);j!==null&&$(w,j.startTime-I)}}function S(I,j){p=!1,m&&(m=!1,y(E),E=-1),f=!0;var P=d;try{for(g(j),h=r(l);h!==null&&(!(h.expirationTime>j)||I&&!K());){var k=h.callback;if(typeof k=="function"){h.callback=null,d=h.priorityLevel;var q=k(h.expirationTime<=j);j=t.unstable_now(),typeof q=="function"?h.callback=q:h===r(l)&&n(l),g(j)}else n(l);h=r(l)}if(h!==null)var fe=!0;else{var ue=r(u);ue!==null&&$(w,ue.startTime-j),fe=!1}return fe}finally{h=null,d=P,f=!1}}var C=!1,b=null,E=-1,R=5,M=-1;function K(){return!(t.unstable_now()-M<R)}function O(){if(b!==null){var I=t.unstable_now();M=I;var j=!0;try{j=b(!0,I)}finally{j?A():(C=!1,b=null)}}else C=!1}var A;if(typeof v=="function")A=function(){v(O)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,H=B.port2;B.port1.onmessage=O,A=function(){H.postMessage(null)}}else A=function(){x(O,0)};function J(I){b=I,C||(C=!0,A())}function $(I,j){E=x(function(){I(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,J(S))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(I){switch(d){case 1:case 2:case 3:var j=3;break;default:j=d}var P=d;d=j;try{return I()}finally{d=P}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,j){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var P=d;d=I;try{return j()}finally{d=P}},t.unstable_scheduleCallback=function(I,j,P){var k=t.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?k+P:k):P=k,I){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=P+q,I={id:c++,callback:j,priorityLevel:I,startTime:P,expirationTime:q,sortIndex:-1},P>k?(I.sortIndex=P,e(u,I),r(l)===null&&I===r(u)&&(m?(y(E),E=-1):m=!0,$(w,P-k))):(I.sortIndex=q,e(l,I),p||f||(p=!0,J(S))),I},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(I){var j=d;return function(){var P=d;d=j;try{return I.apply(this,arguments)}finally{d=P}}}})(Cv);Av.exports=Cv;var lw=Av.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uw=T,Ft=lw;function N(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Rv=new Set,Io={};function _i(t,e){Ss(t,e),Ss(t+"Capture",e)}function Ss(t,e){for(Io[t]=e,t=0;t<e.length;t++)Rv.add(e[t])}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ah=Object.prototype.hasOwnProperty,cw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Qp={},Jp={};function hw(t){return Ah.call(Jp,t)?!0:Ah.call(Qp,t)?!1:cw.test(t)?Jp[t]=!0:(Qp[t]=!0,!1)}function dw(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function fw(t,e,r,n){if(e===null||typeof e>"u"||dw(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function _t(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ut={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ut[t]=new _t(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ut[e]=new _t(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ut[t]=new _t(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ut[t]=new _t(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ut[t]=new _t(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ut[t]=new _t(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ut[t]=new _t(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ut[t]=new _t(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ut[t]=new _t(t,5,!1,t.toLowerCase(),null,!1,!1)});var Tf=/[\-:]([a-z])/g;function bf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Tf,bf);ut[e]=new _t(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Tf,bf);ut[e]=new _t(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Tf,bf);ut[e]=new _t(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ut[t]=new _t(t,1,!1,t.toLowerCase(),null,!1,!1)});ut.xlinkHref=new _t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ut[t]=new _t(t,1,!1,t.toLowerCase(),null,!0,!0)});function Af(t,e,r,n){var i=ut.hasOwnProperty(e)?ut[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(fw(e,r,i,n)&&(r=null),n||i===null?hw(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var tn=uw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ga=Symbol.for("react.element"),Ki=Symbol.for("react.portal"),qi=Symbol.for("react.fragment"),Cf=Symbol.for("react.strict_mode"),Ch=Symbol.for("react.profiler"),Pv=Symbol.for("react.provider"),Iv=Symbol.for("react.context"),Rf=Symbol.for("react.forward_ref"),Rh=Symbol.for("react.suspense"),Ph=Symbol.for("react.suspense_list"),Pf=Symbol.for("react.memo"),pn=Symbol.for("react.lazy"),Mv=Symbol.for("react.offscreen"),em=Symbol.iterator;function $s(t){return t===null||typeof t!="object"?null:(t=em&&t[em]||t["@@iterator"],typeof t=="function"?t:null)}var Le=Object.assign,rc;function no(t){if(rc===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);rc=e&&e[1]||""}return`
`+rc+t}var nc=!1;function ic(t,e){if(!t||nc)return"";nc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{nc=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?no(t):""}function pw(t){switch(t.tag){case 5:return no(t.type);case 16:return no("Lazy");case 13:return no("Suspense");case 19:return no("SuspenseList");case 0:case 2:case 15:return t=ic(t.type,!1),t;case 11:return t=ic(t.type.render,!1),t;case 1:return t=ic(t.type,!0),t;default:return""}}function Ih(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qi:return"Fragment";case Ki:return"Portal";case Ch:return"Profiler";case Cf:return"StrictMode";case Rh:return"Suspense";case Ph:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Iv:return(t.displayName||"Context")+".Consumer";case Pv:return(t._context.displayName||"Context")+".Provider";case Rf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Pf:return e=t.displayName||null,e!==null?e:Ih(t.type)||"Memo";case pn:e=t._payload,t=t._init;try{return Ih(t(e))}catch{}}return null}function mw(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ih(e);case 8:return e===Cf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function kv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function gw(t){var e=kv(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ya(t){t._valueTracker||(t._valueTracker=gw(t))}function Bv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=kv(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Pl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Mh(t,e){var r=e.checked;return Le({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function tm(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Fn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Nv(t,e){e=e.checked,e!=null&&Af(t,"checked",e,!1)}function kh(t,e){Nv(t,e);var r=Fn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Bh(t,e.type,r):e.hasOwnProperty("defaultValue")&&Bh(t,e.type,Fn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Bh(t,e,r){(e!=="number"||Pl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var io=Array.isArray;function us(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Fn(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Nh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(N(91));return Le({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function nm(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(N(92));if(io(r)){if(1<r.length)throw Error(N(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Fn(r)}}function Dv(t,e){var r=Fn(e.value),n=Fn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function im(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Fv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Fv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var va,Ov=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(va=va||document.createElement("div"),va.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=va.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Mo(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var go={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yw=["Webkit","ms","Moz","O"];Object.keys(go).forEach(function(t){yw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),go[e]=go[t]})});function Lv(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||go.hasOwnProperty(t)&&go[t]?(""+e).trim():e+"px"}function Uv(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Lv(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var vw=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fh(t,e){if(e){if(vw[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(N(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(N(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(N(61))}if(e.style!=null&&typeof e.style!="object")throw Error(N(62))}}function Oh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lh=null;function If(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Uh=null,cs=null,hs=null;function sm(t){if(t=na(t)){if(typeof Uh!="function")throw Error(N(280));var e=t.stateNode;e&&(e=bu(e),Uh(t.stateNode,t.type,e))}}function jv(t){cs?hs?hs.push(t):hs=[t]:cs=t}function Gv(){if(cs){var t=cs,e=hs;if(hs=cs=null,sm(t),e)for(t=0;t<e.length;t++)sm(e[t])}}function zv(t,e){return t(e)}function Hv(){}var sc=!1;function $v(t,e,r){if(sc)return t(e,r);sc=!0;try{return zv(t,e,r)}finally{sc=!1,(cs!==null||hs!==null)&&(Hv(),Gv())}}function ko(t,e){var r=t.stateNode;if(r===null)return null;var n=bu(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(N(231,e,typeof r));return r}var jh=!1;if(Kr)try{var Ws={};Object.defineProperty(Ws,"passive",{get:function(){jh=!0}}),window.addEventListener("test",Ws,Ws),window.removeEventListener("test",Ws,Ws)}catch{jh=!1}function xw(t,e,r,n,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(c){this.onError(c)}}var yo=!1,Il=null,Ml=!1,Gh=null,_w={onError:function(t){yo=!0,Il=t}};function ww(t,e,r,n,i,s,o,a,l){yo=!1,Il=null,xw.apply(_w,arguments)}function Ew(t,e,r,n,i,s,o,a,l){if(ww.apply(this,arguments),yo){if(yo){var u=Il;yo=!1,Il=null}else throw Error(N(198));Ml||(Ml=!0,Gh=u)}}function wi(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Wv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function om(t){if(wi(t)!==t)throw Error(N(188))}function Sw(t){var e=t.alternate;if(!e){if(e=wi(t),e===null)throw Error(N(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return om(i),t;if(s===n)return om(i),e;s=s.sibling}throw Error(N(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(N(189))}}if(r.alternate!==n)throw Error(N(190))}if(r.tag!==3)throw Error(N(188));return r.stateNode.current===r?t:e}function Vv(t){return t=Sw(t),t!==null?Xv(t):null}function Xv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Xv(t);if(e!==null)return e;t=t.sibling}return null}var Yv=Ft.unstable_scheduleCallback,am=Ft.unstable_cancelCallback,Tw=Ft.unstable_shouldYield,bw=Ft.unstable_requestPaint,$e=Ft.unstable_now,Aw=Ft.unstable_getCurrentPriorityLevel,Mf=Ft.unstable_ImmediatePriority,Kv=Ft.unstable_UserBlockingPriority,kl=Ft.unstable_NormalPriority,Cw=Ft.unstable_LowPriority,qv=Ft.unstable_IdlePriority,wu=null,Cr=null;function Rw(t){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(wu,t,void 0,(t.current.flags&128)===128)}catch{}}var or=Math.clz32?Math.clz32:Mw,Pw=Math.log,Iw=Math.LN2;function Mw(t){return t>>>=0,t===0?32:31-(Pw(t)/Iw|0)|0}var xa=64,_a=4194304;function so(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bl(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=so(a):(s&=o,s!==0&&(n=so(s)))}else o=r&~i,o!==0?n=so(o):s!==0&&(n=so(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-or(e),i=1<<r,n|=t[r],e&=~i;return n}function kw(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bw(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-or(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=kw(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function zh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Zv(){var t=xa;return xa<<=1,!(xa&4194240)&&(xa=64),t}function oc(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ta(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-or(e),t[e]=r}function Nw(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-or(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function kf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-or(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var we=0;function Qv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Jv,Bf,e0,t0,r0,Hh=!1,wa=[],An=null,Cn=null,Rn=null,Bo=new Map,No=new Map,yn=[],Dw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lm(t,e){switch(t){case"focusin":case"focusout":An=null;break;case"dragenter":case"dragleave":Cn=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":Bo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":No.delete(e.pointerId)}}function Vs(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=na(e),e!==null&&Bf(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Fw(t,e,r,n,i){switch(e){case"focusin":return An=Vs(An,t,e,r,n,i),!0;case"dragenter":return Cn=Vs(Cn,t,e,r,n,i),!0;case"mouseover":return Rn=Vs(Rn,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Bo.set(s,Vs(Bo.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,No.set(s,Vs(No.get(s)||null,t,e,r,n,i)),!0}return!1}function n0(t){var e=ii(t.target);if(e!==null){var r=wi(e);if(r!==null){if(e=r.tag,e===13){if(e=Wv(r),e!==null){t.blockedOn=e,r0(t.priority,function(){e0(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function al(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=$h(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Lh=n,r.target.dispatchEvent(n),Lh=null}else return e=na(r),e!==null&&Bf(e),t.blockedOn=r,!1;e.shift()}return!0}function um(t,e,r){al(t)&&r.delete(e)}function Ow(){Hh=!1,An!==null&&al(An)&&(An=null),Cn!==null&&al(Cn)&&(Cn=null),Rn!==null&&al(Rn)&&(Rn=null),Bo.forEach(um),No.forEach(um)}function Xs(t,e){t.blockedOn===e&&(t.blockedOn=null,Hh||(Hh=!0,Ft.unstable_scheduleCallback(Ft.unstable_NormalPriority,Ow)))}function Do(t){function e(i){return Xs(i,t)}if(0<wa.length){Xs(wa[0],t);for(var r=1;r<wa.length;r++){var n=wa[r];n.blockedOn===t&&(n.blockedOn=null)}}for(An!==null&&Xs(An,t),Cn!==null&&Xs(Cn,t),Rn!==null&&Xs(Rn,t),Bo.forEach(e),No.forEach(e),r=0;r<yn.length;r++)n=yn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<yn.length&&(r=yn[0],r.blockedOn===null);)n0(r),r.blockedOn===null&&yn.shift()}var ds=tn.ReactCurrentBatchConfig,Nl=!0;function Lw(t,e,r,n){var i=we,s=ds.transition;ds.transition=null;try{we=1,Nf(t,e,r,n)}finally{we=i,ds.transition=s}}function Uw(t,e,r,n){var i=we,s=ds.transition;ds.transition=null;try{we=4,Nf(t,e,r,n)}finally{we=i,ds.transition=s}}function Nf(t,e,r,n){if(Nl){var i=$h(t,e,r,n);if(i===null)gc(t,e,n,Dl,r),lm(t,n);else if(Fw(i,t,e,r,n))n.stopPropagation();else if(lm(t,n),e&4&&-1<Dw.indexOf(t)){for(;i!==null;){var s=na(i);if(s!==null&&Jv(s),s=$h(t,e,r,n),s===null&&gc(t,e,n,Dl,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else gc(t,e,n,null,r)}}var Dl=null;function $h(t,e,r,n){if(Dl=null,t=If(n),t=ii(t),t!==null)if(e=wi(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Wv(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Dl=t,null}function i0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Aw()){case Mf:return 1;case Kv:return 4;case kl:case Cw:return 16;case qv:return 536870912;default:return 16}default:return 16}}var _n=null,Df=null,ll=null;function s0(){if(ll)return ll;var t,e=Df,r=e.length,n,i="value"in _n?_n.value:_n.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return ll=i.slice(t,1<n?1-n:void 0)}function ul(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ea(){return!0}function cm(){return!1}function Lt(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ea:cm,this.isPropagationStopped=cm,this}return Le(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ea)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ea)},persist:function(){},isPersistent:Ea}),e}var Ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ff=Lt(Ds),ra=Le({},Ds,{view:0,detail:0}),jw=Lt(ra),ac,lc,Ys,Eu=Le({},ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Of,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ys&&(Ys&&t.type==="mousemove"?(ac=t.screenX-Ys.screenX,lc=t.screenY-Ys.screenY):lc=ac=0,Ys=t),ac)},movementY:function(t){return"movementY"in t?t.movementY:lc}}),hm=Lt(Eu),Gw=Le({},Eu,{dataTransfer:0}),zw=Lt(Gw),Hw=Le({},ra,{relatedTarget:0}),uc=Lt(Hw),$w=Le({},Ds,{animationName:0,elapsedTime:0,pseudoElement:0}),Ww=Lt($w),Vw=Le({},Ds,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Xw=Lt(Vw),Yw=Le({},Ds,{data:0}),dm=Lt(Yw),Kw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qw(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Zw[t])?!!e[t]:!1}function Of(){return Qw}var Jw=Le({},ra,{key:function(t){if(t.key){var e=Kw[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ul(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?qw[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Of,charCode:function(t){return t.type==="keypress"?ul(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ul(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),eE=Lt(Jw),tE=Le({},Eu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fm=Lt(tE),rE=Le({},ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Of}),nE=Lt(rE),iE=Le({},Ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),sE=Lt(iE),oE=Le({},Eu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),aE=Lt(oE),lE=[9,13,27,32],Lf=Kr&&"CompositionEvent"in window,vo=null;Kr&&"documentMode"in document&&(vo=document.documentMode);var uE=Kr&&"TextEvent"in window&&!vo,o0=Kr&&(!Lf||vo&&8<vo&&11>=vo),pm=" ",mm=!1;function a0(t,e){switch(t){case"keyup":return lE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function l0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Zi=!1;function cE(t,e){switch(t){case"compositionend":return l0(e);case"keypress":return e.which!==32?null:(mm=!0,pm);case"textInput":return t=e.data,t===pm&&mm?null:t;default:return null}}function hE(t,e){if(Zi)return t==="compositionend"||!Lf&&a0(t,e)?(t=s0(),ll=Df=_n=null,Zi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return o0&&e.locale!=="ko"?null:e.data;default:return null}}var dE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dE[t.type]:e==="textarea"}function u0(t,e,r,n){jv(n),e=Fl(e,"onChange"),0<e.length&&(r=new Ff("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var xo=null,Fo=null;function fE(t){_0(t,0)}function Su(t){var e=es(t);if(Bv(e))return t}function pE(t,e){if(t==="change")return e}var c0=!1;if(Kr){var cc;if(Kr){var hc="oninput"in document;if(!hc){var ym=document.createElement("div");ym.setAttribute("oninput","return;"),hc=typeof ym.oninput=="function"}cc=hc}else cc=!1;c0=cc&&(!document.documentMode||9<document.documentMode)}function vm(){xo&&(xo.detachEvent("onpropertychange",h0),Fo=xo=null)}function h0(t){if(t.propertyName==="value"&&Su(Fo)){var e=[];u0(e,Fo,t,If(t)),$v(fE,e)}}function mE(t,e,r){t==="focusin"?(vm(),xo=e,Fo=r,xo.attachEvent("onpropertychange",h0)):t==="focusout"&&vm()}function gE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Su(Fo)}function yE(t,e){if(t==="click")return Su(e)}function vE(t,e){if(t==="input"||t==="change")return Su(e)}function xE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cr=typeof Object.is=="function"?Object.is:xE;function Oo(t,e){if(cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Ah.call(e,i)||!cr(t[i],e[i]))return!1}return!0}function xm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function _m(t,e){var r=xm(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=xm(r)}}function d0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?d0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function f0(){for(var t=window,e=Pl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Pl(t.document)}return e}function Uf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function _E(t){var e=f0(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&d0(r.ownerDocument.documentElement,r)){if(n!==null&&Uf(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=_m(r,s);var o=_m(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wE=Kr&&"documentMode"in document&&11>=document.documentMode,Qi=null,Wh=null,_o=null,Vh=!1;function wm(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Vh||Qi==null||Qi!==Pl(n)||(n=Qi,"selectionStart"in n&&Uf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_o&&Oo(_o,n)||(_o=n,n=Fl(Wh,"onSelect"),0<n.length&&(e=new Ff("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Qi)))}function Sa(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ji={animationend:Sa("Animation","AnimationEnd"),animationiteration:Sa("Animation","AnimationIteration"),animationstart:Sa("Animation","AnimationStart"),transitionend:Sa("Transition","TransitionEnd")},dc={},p0={};Kr&&(p0=document.createElement("div").style,"AnimationEvent"in window||(delete Ji.animationend.animation,delete Ji.animationiteration.animation,delete Ji.animationstart.animation),"TransitionEvent"in window||delete Ji.transitionend.transition);function Tu(t){if(dc[t])return dc[t];if(!Ji[t])return t;var e=Ji[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in p0)return dc[t]=e[r];return t}var m0=Tu("animationend"),g0=Tu("animationiteration"),y0=Tu("animationstart"),v0=Tu("transitionend"),x0=new Map,Em="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jn(t,e){x0.set(t,e),_i(e,[t])}for(var fc=0;fc<Em.length;fc++){var pc=Em[fc],EE=pc.toLowerCase(),SE=pc[0].toUpperCase()+pc.slice(1);jn(EE,"on"+SE)}jn(m0,"onAnimationEnd");jn(g0,"onAnimationIteration");jn(y0,"onAnimationStart");jn("dblclick","onDoubleClick");jn("focusin","onFocus");jn("focusout","onBlur");jn(v0,"onTransitionEnd");Ss("onMouseEnter",["mouseout","mouseover"]);Ss("onMouseLeave",["mouseout","mouseover"]);Ss("onPointerEnter",["pointerout","pointerover"]);Ss("onPointerLeave",["pointerout","pointerover"]);_i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_i("onBeforeInput",["compositionend","keypress","textInput","paste"]);_i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TE=new Set("cancel close invalid load scroll toggle".split(" ").concat(oo));function Sm(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Ew(n,e,void 0,t),t.currentTarget=null}function _0(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Sm(i,a,u),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Sm(i,a,u),s=l}}}if(Ml)throw t=Gh,Ml=!1,Gh=null,t}function Ae(t,e){var r=e[Zh];r===void 0&&(r=e[Zh]=new Set);var n=t+"__bubble";r.has(n)||(w0(e,t,2,!1),r.add(n))}function mc(t,e,r){var n=0;e&&(n|=4),w0(r,t,n,e)}var Ta="_reactListening"+Math.random().toString(36).slice(2);function Lo(t){if(!t[Ta]){t[Ta]=!0,Rv.forEach(function(r){r!=="selectionchange"&&(TE.has(r)||mc(r,!1,t),mc(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ta]||(e[Ta]=!0,mc("selectionchange",!1,e))}}function w0(t,e,r,n){switch(i0(e)){case 1:var i=Lw;break;case 4:i=Uw;break;default:i=Nf}r=i.bind(null,e,r,t),i=void 0,!jh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function gc(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ii(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}$v(function(){var u=s,c=If(r),h=[];e:{var d=x0.get(t);if(d!==void 0){var f=Ff,p=t;switch(t){case"keypress":if(ul(r)===0)break e;case"keydown":case"keyup":f=eE;break;case"focusin":p="focus",f=uc;break;case"focusout":p="blur",f=uc;break;case"beforeblur":case"afterblur":f=uc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=hm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=zw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=nE;break;case m0:case g0:case y0:f=Ww;break;case v0:f=sE;break;case"scroll":f=jw;break;case"wheel":f=aE;break;case"copy":case"cut":case"paste":f=Xw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=fm}var m=(e&4)!==0,x=!m&&t==="scroll",y=m?d!==null?d+"Capture":null:d;m=[];for(var v=u,g;v!==null;){g=v;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,y!==null&&(w=ko(v,y),w!=null&&m.push(Uo(v,w,g)))),x)break;v=v.return}0<m.length&&(d=new f(d,p,null,r,c),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&r!==Lh&&(p=r.relatedTarget||r.fromElement)&&(ii(p)||p[qr]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=r.relatedTarget||r.toElement,f=u,p=p?ii(p):null,p!==null&&(x=wi(p),p!==x||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(m=hm,w="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=fm,w="onPointerLeave",y="onPointerEnter",v="pointer"),x=f==null?d:es(f),g=p==null?d:es(p),d=new m(w,v+"leave",f,r,c),d.target=x,d.relatedTarget=g,w=null,ii(c)===u&&(m=new m(y,v+"enter",p,r,c),m.target=g,m.relatedTarget=x,w=m),x=w,f&&p)t:{for(m=f,y=p,v=0,g=m;g;g=Bi(g))v++;for(g=0,w=y;w;w=Bi(w))g++;for(;0<v-g;)m=Bi(m),v--;for(;0<g-v;)y=Bi(y),g--;for(;v--;){if(m===y||y!==null&&m===y.alternate)break t;m=Bi(m),y=Bi(y)}m=null}else m=null;f!==null&&Tm(h,d,f,m,!1),p!==null&&x!==null&&Tm(h,x,p,m,!0)}}e:{if(d=u?es(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var S=pE;else if(gm(d))if(c0)S=vE;else{S=gE;var C=mE}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=yE);if(S&&(S=S(t,u))){u0(h,S,r,c);break e}C&&C(t,d,u),t==="focusout"&&(C=d._wrapperState)&&C.controlled&&d.type==="number"&&Bh(d,"number",d.value)}switch(C=u?es(u):window,t){case"focusin":(gm(C)||C.contentEditable==="true")&&(Qi=C,Wh=u,_o=null);break;case"focusout":_o=Wh=Qi=null;break;case"mousedown":Vh=!0;break;case"contextmenu":case"mouseup":case"dragend":Vh=!1,wm(h,r,c);break;case"selectionchange":if(wE)break;case"keydown":case"keyup":wm(h,r,c)}var b;if(Lf)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Zi?a0(t,r)&&(E="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(o0&&r.locale!=="ko"&&(Zi||E!=="onCompositionStart"?E==="onCompositionEnd"&&Zi&&(b=s0()):(_n=c,Df="value"in _n?_n.value:_n.textContent,Zi=!0)),C=Fl(u,E),0<C.length&&(E=new dm(E,t,null,r,c),h.push({event:E,listeners:C}),b?E.data=b:(b=l0(r),b!==null&&(E.data=b)))),(b=uE?cE(t,r):hE(t,r))&&(u=Fl(u,"onBeforeInput"),0<u.length&&(c=new dm("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:u}),c.data=b))}_0(h,e)})}function Uo(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Fl(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ko(t,r),s!=null&&n.unshift(Uo(t,s,i)),s=ko(t,e),s!=null&&n.push(Uo(t,s,i))),t=t.return}return n}function Bi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Tm(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,u=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&u!==null&&(a=u,i?(l=ko(r,s),l!=null&&o.unshift(Uo(r,l,a))):i||(l=ko(r,s),l!=null&&o.push(Uo(r,l,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var bE=/\r\n?/g,AE=/\u0000|\uFFFD/g;function bm(t){return(typeof t=="string"?t:""+t).replace(bE,`
`).replace(AE,"")}function ba(t,e,r){if(e=bm(e),bm(t)!==e&&r)throw Error(N(425))}function Ol(){}var Xh=null,Yh=null;function Kh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var qh=typeof setTimeout=="function"?setTimeout:void 0,CE=typeof clearTimeout=="function"?clearTimeout:void 0,Am=typeof Promise=="function"?Promise:void 0,RE=typeof queueMicrotask=="function"?queueMicrotask:typeof Am<"u"?function(t){return Am.resolve(null).then(t).catch(PE)}:qh;function PE(t){setTimeout(function(){throw t})}function yc(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Do(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Do(e)}function Pn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Cm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Fs=Math.random().toString(36).slice(2),br="__reactFiber$"+Fs,jo="__reactProps$"+Fs,qr="__reactContainer$"+Fs,Zh="__reactEvents$"+Fs,IE="__reactListeners$"+Fs,ME="__reactHandles$"+Fs;function ii(t){var e=t[br];if(e)return e;for(var r=t.parentNode;r;){if(e=r[qr]||r[br]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Cm(t);t!==null;){if(r=t[br])return r;t=Cm(t)}return e}t=r,r=t.parentNode}return null}function na(t){return t=t[br]||t[qr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function es(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(N(33))}function bu(t){return t[jo]||null}var Qh=[],ts=-1;function Gn(t){return{current:t}}function Re(t){0>ts||(t.current=Qh[ts],Qh[ts]=null,ts--)}function Te(t,e){ts++,Qh[ts]=t.current,t.current=e}var On={},pt=Gn(On),Ct=Gn(!1),di=On;function Ts(t,e){var r=t.type.contextTypes;if(!r)return On;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Rt(t){return t=t.childContextTypes,t!=null}function Ll(){Re(Ct),Re(pt)}function Rm(t,e,r){if(pt.current!==On)throw Error(N(168));Te(pt,e),Te(Ct,r)}function E0(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(N(108,mw(t)||"Unknown",i));return Le({},r,n)}function Ul(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||On,di=pt.current,Te(pt,t),Te(Ct,Ct.current),!0}function Pm(t,e,r){var n=t.stateNode;if(!n)throw Error(N(169));r?(t=E0(t,e,di),n.__reactInternalMemoizedMergedChildContext=t,Re(Ct),Re(pt),Te(pt,t)):Re(Ct),Te(Ct,r)}var jr=null,Au=!1,vc=!1;function S0(t){jr===null?jr=[t]:jr.push(t)}function kE(t){Au=!0,S0(t)}function zn(){if(!vc&&jr!==null){vc=!0;var t=0,e=we;try{var r=jr;for(we=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}jr=null,Au=!1}catch(i){throw jr!==null&&(jr=jr.slice(t+1)),Yv(Mf,zn),i}finally{we=e,vc=!1}}return null}var rs=[],ns=0,jl=null,Gl=0,jt=[],Gt=0,fi=null,Gr=1,zr="";function Yn(t,e){rs[ns++]=Gl,rs[ns++]=jl,jl=t,Gl=e}function T0(t,e,r){jt[Gt++]=Gr,jt[Gt++]=zr,jt[Gt++]=fi,fi=t;var n=Gr;t=zr;var i=32-or(n)-1;n&=~(1<<i),r+=1;var s=32-or(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Gr=1<<32-or(e)+i|r<<i|n,zr=s+t}else Gr=1<<s|r<<i|n,zr=t}function jf(t){t.return!==null&&(Yn(t,1),T0(t,1,0))}function Gf(t){for(;t===jl;)jl=rs[--ns],rs[ns]=null,Gl=rs[--ns],rs[ns]=null;for(;t===fi;)fi=jt[--Gt],jt[Gt]=null,zr=jt[--Gt],jt[Gt]=null,Gr=jt[--Gt],jt[Gt]=null}var Dt=null,Bt=null,Be=!1,ir=null;function b0(t,e){var r=zt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Im(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Dt=t,Bt=Pn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Dt=t,Bt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=fi!==null?{id:Gr,overflow:zr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=zt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Dt=t,Bt=null,!0):!1;default:return!1}}function Jh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ed(t){if(Be){var e=Bt;if(e){var r=e;if(!Im(t,e)){if(Jh(t))throw Error(N(418));e=Pn(r.nextSibling);var n=Dt;e&&Im(t,e)?b0(n,r):(t.flags=t.flags&-4097|2,Be=!1,Dt=t)}}else{if(Jh(t))throw Error(N(418));t.flags=t.flags&-4097|2,Be=!1,Dt=t}}}function Mm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Dt=t}function Aa(t){if(t!==Dt)return!1;if(!Be)return Mm(t),Be=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Kh(t.type,t.memoizedProps)),e&&(e=Bt)){if(Jh(t))throw A0(),Error(N(418));for(;e;)b0(t,e),e=Pn(e.nextSibling)}if(Mm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(N(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Bt=Pn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Bt=null}}else Bt=Dt?Pn(t.stateNode.nextSibling):null;return!0}function A0(){for(var t=Bt;t;)t=Pn(t.nextSibling)}function bs(){Bt=Dt=null,Be=!1}function zf(t){ir===null?ir=[t]:ir.push(t)}var BE=tn.ReactCurrentBatchConfig;function Ks(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(N(309));var n=r.stateNode}if(!n)throw Error(N(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(N(284));if(!r._owner)throw Error(N(290,t))}return t}function Ca(t,e){throw t=Object.prototype.toString.call(e),Error(N(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function km(t){var e=t._init;return e(t._payload)}function C0(t){function e(y,v){if(t){var g=y.deletions;g===null?(y.deletions=[v],y.flags|=16):g.push(v)}}function r(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function n(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function i(y,v){return y=Bn(y,v),y.index=0,y.sibling=null,y}function s(y,v,g){return y.index=g,t?(g=y.alternate,g!==null?(g=g.index,g<v?(y.flags|=2,v):g):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,v,g,w){return v===null||v.tag!==6?(v=bc(g,y.mode,w),v.return=y,v):(v=i(v,g),v.return=y,v)}function l(y,v,g,w){var S=g.type;return S===qi?c(y,v,g.props.children,w,g.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===pn&&km(S)===v.type)?(w=i(v,g.props),w.ref=Ks(y,v,g),w.return=y,w):(w=gl(g.type,g.key,g.props,null,y.mode,w),w.ref=Ks(y,v,g),w.return=y,w)}function u(y,v,g,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==g.containerInfo||v.stateNode.implementation!==g.implementation?(v=Ac(g,y.mode,w),v.return=y,v):(v=i(v,g.children||[]),v.return=y,v)}function c(y,v,g,w,S){return v===null||v.tag!==7?(v=li(g,y.mode,w,S),v.return=y,v):(v=i(v,g),v.return=y,v)}function h(y,v,g){if(typeof v=="string"&&v!==""||typeof v=="number")return v=bc(""+v,y.mode,g),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ga:return g=gl(v.type,v.key,v.props,null,y.mode,g),g.ref=Ks(y,null,v),g.return=y,g;case Ki:return v=Ac(v,y.mode,g),v.return=y,v;case pn:var w=v._init;return h(y,w(v._payload),g)}if(io(v)||$s(v))return v=li(v,y.mode,g,null),v.return=y,v;Ca(y,v)}return null}function d(y,v,g,w){var S=v!==null?v.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return S!==null?null:a(y,v,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ga:return g.key===S?l(y,v,g,w):null;case Ki:return g.key===S?u(y,v,g,w):null;case pn:return S=g._init,d(y,v,S(g._payload),w)}if(io(g)||$s(g))return S!==null?null:c(y,v,g,w,null);Ca(y,g)}return null}function f(y,v,g,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(g)||null,a(v,y,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ga:return y=y.get(w.key===null?g:w.key)||null,l(v,y,w,S);case Ki:return y=y.get(w.key===null?g:w.key)||null,u(v,y,w,S);case pn:var C=w._init;return f(y,v,g,C(w._payload),S)}if(io(w)||$s(w))return y=y.get(g)||null,c(v,y,w,S,null);Ca(v,w)}return null}function p(y,v,g,w){for(var S=null,C=null,b=v,E=v=0,R=null;b!==null&&E<g.length;E++){b.index>E?(R=b,b=null):R=b.sibling;var M=d(y,b,g[E],w);if(M===null){b===null&&(b=R);break}t&&b&&M.alternate===null&&e(y,b),v=s(M,v,E),C===null?S=M:C.sibling=M,C=M,b=R}if(E===g.length)return r(y,b),Be&&Yn(y,E),S;if(b===null){for(;E<g.length;E++)b=h(y,g[E],w),b!==null&&(v=s(b,v,E),C===null?S=b:C.sibling=b,C=b);return Be&&Yn(y,E),S}for(b=n(y,b);E<g.length;E++)R=f(b,y,E,g[E],w),R!==null&&(t&&R.alternate!==null&&b.delete(R.key===null?E:R.key),v=s(R,v,E),C===null?S=R:C.sibling=R,C=R);return t&&b.forEach(function(K){return e(y,K)}),Be&&Yn(y,E),S}function m(y,v,g,w){var S=$s(g);if(typeof S!="function")throw Error(N(150));if(g=S.call(g),g==null)throw Error(N(151));for(var C=S=null,b=v,E=v=0,R=null,M=g.next();b!==null&&!M.done;E++,M=g.next()){b.index>E?(R=b,b=null):R=b.sibling;var K=d(y,b,M.value,w);if(K===null){b===null&&(b=R);break}t&&b&&K.alternate===null&&e(y,b),v=s(K,v,E),C===null?S=K:C.sibling=K,C=K,b=R}if(M.done)return r(y,b),Be&&Yn(y,E),S;if(b===null){for(;!M.done;E++,M=g.next())M=h(y,M.value,w),M!==null&&(v=s(M,v,E),C===null?S=M:C.sibling=M,C=M);return Be&&Yn(y,E),S}for(b=n(y,b);!M.done;E++,M=g.next())M=f(b,y,E,M.value,w),M!==null&&(t&&M.alternate!==null&&b.delete(M.key===null?E:M.key),v=s(M,v,E),C===null?S=M:C.sibling=M,C=M);return t&&b.forEach(function(O){return e(y,O)}),Be&&Yn(y,E),S}function x(y,v,g,w){if(typeof g=="object"&&g!==null&&g.type===qi&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case ga:e:{for(var S=g.key,C=v;C!==null;){if(C.key===S){if(S=g.type,S===qi){if(C.tag===7){r(y,C.sibling),v=i(C,g.props.children),v.return=y,y=v;break e}}else if(C.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===pn&&km(S)===C.type){r(y,C.sibling),v=i(C,g.props),v.ref=Ks(y,C,g),v.return=y,y=v;break e}r(y,C);break}else e(y,C);C=C.sibling}g.type===qi?(v=li(g.props.children,y.mode,w,g.key),v.return=y,y=v):(w=gl(g.type,g.key,g.props,null,y.mode,w),w.ref=Ks(y,v,g),w.return=y,y=w)}return o(y);case Ki:e:{for(C=g.key;v!==null;){if(v.key===C)if(v.tag===4&&v.stateNode.containerInfo===g.containerInfo&&v.stateNode.implementation===g.implementation){r(y,v.sibling),v=i(v,g.children||[]),v.return=y,y=v;break e}else{r(y,v);break}else e(y,v);v=v.sibling}v=Ac(g,y.mode,w),v.return=y,y=v}return o(y);case pn:return C=g._init,x(y,v,C(g._payload),w)}if(io(g))return p(y,v,g,w);if($s(g))return m(y,v,g,w);Ca(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,v!==null&&v.tag===6?(r(y,v.sibling),v=i(v,g),v.return=y,y=v):(r(y,v),v=bc(g,y.mode,w),v.return=y,y=v),o(y)):r(y,v)}return x}var As=C0(!0),R0=C0(!1),zl=Gn(null),Hl=null,is=null,Hf=null;function $f(){Hf=is=Hl=null}function Wf(t){var e=zl.current;Re(zl),t._currentValue=e}function td(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function fs(t,e){Hl=t,Hf=is=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Tt=!0),t.firstContext=null)}function Xt(t){var e=t._currentValue;if(Hf!==t)if(t={context:t,memoizedValue:e,next:null},is===null){if(Hl===null)throw Error(N(308));is=t,Hl.dependencies={lanes:0,firstContext:t}}else is=is.next=t;return e}var si=null;function Vf(t){si===null?si=[t]:si.push(t)}function P0(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Vf(e)):(r.next=i.next,i.next=r),e.interleaved=r,Zr(t,n)}function Zr(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var mn=!1;function Xf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function I0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function In(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,ye&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Zr(t,r)}return i=n.interleaved,i===null?(e.next=e,Vf(n)):(e.next=i.next,i.next=e),n.interleaved=e,Zr(t,r)}function cl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,kf(t,r)}}function Bm(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function $l(t,e,r,n){var i=t.updateQueue;mn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,c=u=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((n&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(d=e,f=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=Le({},h,d);break e;case 2:mn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,o|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);mi|=o,t.lanes=o,t.memoizedState=h}}function Nm(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(N(191,i));i.call(n)}}}var ia={},Rr=Gn(ia),Go=Gn(ia),zo=Gn(ia);function oi(t){if(t===ia)throw Error(N(174));return t}function Yf(t,e){switch(Te(zo,e),Te(Go,t),Te(Rr,ia),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Dh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Dh(e,t)}Re(Rr),Te(Rr,e)}function Cs(){Re(Rr),Re(Go),Re(zo)}function M0(t){oi(zo.current);var e=oi(Rr.current),r=Dh(e,t.type);e!==r&&(Te(Go,t),Te(Rr,r))}function Kf(t){Go.current===t&&(Re(Rr),Re(Go))}var De=Gn(0);function Wl(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xc=[];function qf(){for(var t=0;t<xc.length;t++)xc[t]._workInProgressVersionPrimary=null;xc.length=0}var hl=tn.ReactCurrentDispatcher,_c=tn.ReactCurrentBatchConfig,pi=0,Oe=null,Ze=null,tt=null,Vl=!1,wo=!1,Ho=0,NE=0;function ht(){throw Error(N(321))}function Zf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!cr(t[r],e[r]))return!1;return!0}function Qf(t,e,r,n,i,s){if(pi=s,Oe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hl.current=t===null||t.memoizedState===null?LE:UE,t=r(n,i),wo){s=0;do{if(wo=!1,Ho=0,25<=s)throw Error(N(301));s+=1,tt=Ze=null,e.updateQueue=null,hl.current=jE,t=r(n,i)}while(wo)}if(hl.current=Xl,e=Ze!==null&&Ze.next!==null,pi=0,tt=Ze=Oe=null,Vl=!1,e)throw Error(N(300));return t}function Jf(){var t=Ho!==0;return Ho=0,t}function wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tt===null?Oe.memoizedState=tt=t:tt=tt.next=t,tt}function Yt(){if(Ze===null){var t=Oe.alternate;t=t!==null?t.memoizedState:null}else t=Ze.next;var e=tt===null?Oe.memoizedState:tt.next;if(e!==null)tt=e,Ze=t;else{if(t===null)throw Error(N(310));Ze=t,t={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},tt===null?Oe.memoizedState=tt=t:tt=tt.next=t}return tt}function $o(t,e){return typeof e=="function"?e(t):e}function wc(t){var e=Yt(),r=e.queue;if(r===null)throw Error(N(311));r.lastRenderedReducer=t;var n=Ze,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((pi&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,Oe.lanes|=c,mi|=c}u=u.next}while(u!==null&&u!==s);l===null?o=n:l.next=a,cr(n,e.memoizedState)||(Tt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Oe.lanes|=s,mi|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Ec(t){var e=Yt(),r=e.queue;if(r===null)throw Error(N(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);cr(s,e.memoizedState)||(Tt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function k0(){}function B0(t,e){var r=Oe,n=Yt(),i=e(),s=!cr(n.memoizedState,i);if(s&&(n.memoizedState=i,Tt=!0),n=n.queue,ep(F0.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||tt!==null&&tt.memoizedState.tag&1){if(r.flags|=2048,Wo(9,D0.bind(null,r,n,i,e),void 0,null),nt===null)throw Error(N(349));pi&30||N0(r,e,i)}return i}function N0(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Oe.updateQueue,e===null?(e={lastEffect:null,stores:null},Oe.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function D0(t,e,r,n){e.value=r,e.getSnapshot=n,O0(e)&&L0(t)}function F0(t,e,r){return r(function(){O0(e)&&L0(t)})}function O0(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!cr(t,r)}catch{return!0}}function L0(t){var e=Zr(t,1);e!==null&&ar(e,t,1,-1)}function Dm(t){var e=wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$o,lastRenderedState:t},e.queue=t,t=t.dispatch=OE.bind(null,Oe,t),[e.memoizedState,t]}function Wo(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Oe.updateQueue,e===null?(e={lastEffect:null,stores:null},Oe.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function U0(){return Yt().memoizedState}function dl(t,e,r,n){var i=wr();Oe.flags|=t,i.memoizedState=Wo(1|e,r,void 0,n===void 0?null:n)}function Cu(t,e,r,n){var i=Yt();n=n===void 0?null:n;var s=void 0;if(Ze!==null){var o=Ze.memoizedState;if(s=o.destroy,n!==null&&Zf(n,o.deps)){i.memoizedState=Wo(e,r,s,n);return}}Oe.flags|=t,i.memoizedState=Wo(1|e,r,s,n)}function Fm(t,e){return dl(8390656,8,t,e)}function ep(t,e){return Cu(2048,8,t,e)}function j0(t,e){return Cu(4,2,t,e)}function G0(t,e){return Cu(4,4,t,e)}function z0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function H0(t,e,r){return r=r!=null?r.concat([t]):null,Cu(4,4,z0.bind(null,e,t),r)}function tp(){}function $0(t,e){var r=Yt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Zf(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function W0(t,e){var r=Yt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Zf(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function V0(t,e,r){return pi&21?(cr(r,e)||(r=Zv(),Oe.lanes|=r,mi|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Tt=!0),t.memoizedState=r)}function DE(t,e){var r=we;we=r!==0&&4>r?r:4,t(!0);var n=_c.transition;_c.transition={};try{t(!1),e()}finally{we=r,_c.transition=n}}function X0(){return Yt().memoizedState}function FE(t,e,r){var n=kn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Y0(t))K0(e,r);else if(r=P0(t,e,r,n),r!==null){var i=vt();ar(r,t,n,i),q0(r,e,n)}}function OE(t,e,r){var n=kn(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Y0(t))K0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,cr(a,o)){var l=e.interleaved;l===null?(i.next=i,Vf(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=P0(t,e,i,n),r!==null&&(i=vt(),ar(r,t,n,i),q0(r,e,n))}}function Y0(t){var e=t.alternate;return t===Oe||e!==null&&e===Oe}function K0(t,e){wo=Vl=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function q0(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,kf(t,r)}}var Xl={readContext:Xt,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useInsertionEffect:ht,useLayoutEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useMutableSource:ht,useSyncExternalStore:ht,useId:ht,unstable_isNewReconciler:!1},LE={readContext:Xt,useCallback:function(t,e){return wr().memoizedState=[t,e===void 0?null:e],t},useContext:Xt,useEffect:Fm,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,dl(4194308,4,z0.bind(null,e,t),r)},useLayoutEffect:function(t,e){return dl(4194308,4,t,e)},useInsertionEffect:function(t,e){return dl(4,2,t,e)},useMemo:function(t,e){var r=wr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=wr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=FE.bind(null,Oe,t),[n.memoizedState,t]},useRef:function(t){var e=wr();return t={current:t},e.memoizedState=t},useState:Dm,useDebugValue:tp,useDeferredValue:function(t){return wr().memoizedState=t},useTransition:function(){var t=Dm(!1),e=t[0];return t=DE.bind(null,t[1]),wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Oe,i=wr();if(Be){if(r===void 0)throw Error(N(407));r=r()}else{if(r=e(),nt===null)throw Error(N(349));pi&30||N0(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Fm(F0.bind(null,n,s,t),[t]),n.flags|=2048,Wo(9,D0.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=wr(),e=nt.identifierPrefix;if(Be){var r=zr,n=Gr;r=(n&~(1<<32-or(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ho++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=NE++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},UE={readContext:Xt,useCallback:$0,useContext:Xt,useEffect:ep,useImperativeHandle:H0,useInsertionEffect:j0,useLayoutEffect:G0,useMemo:W0,useReducer:wc,useRef:U0,useState:function(){return wc($o)},useDebugValue:tp,useDeferredValue:function(t){var e=Yt();return V0(e,Ze.memoizedState,t)},useTransition:function(){var t=wc($o)[0],e=Yt().memoizedState;return[t,e]},useMutableSource:k0,useSyncExternalStore:B0,useId:X0,unstable_isNewReconciler:!1},jE={readContext:Xt,useCallback:$0,useContext:Xt,useEffect:ep,useImperativeHandle:H0,useInsertionEffect:j0,useLayoutEffect:G0,useMemo:W0,useReducer:Ec,useRef:U0,useState:function(){return Ec($o)},useDebugValue:tp,useDeferredValue:function(t){var e=Yt();return Ze===null?e.memoizedState=t:V0(e,Ze.memoizedState,t)},useTransition:function(){var t=Ec($o)[0],e=Yt().memoizedState;return[t,e]},useMutableSource:k0,useSyncExternalStore:B0,useId:X0,unstable_isNewReconciler:!1};function rr(t,e){if(t&&t.defaultProps){e=Le({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function rd(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Le({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Ru={isMounted:function(t){return(t=t._reactInternals)?wi(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=vt(),i=kn(t),s=Xr(n,i);s.payload=e,r!=null&&(s.callback=r),e=In(t,s,i),e!==null&&(ar(e,t,i,n),cl(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=vt(),i=kn(t),s=Xr(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=In(t,s,i),e!==null&&(ar(e,t,i,n),cl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=vt(),n=kn(t),i=Xr(r,n);i.tag=2,e!=null&&(i.callback=e),e=In(t,i,n),e!==null&&(ar(e,t,n,r),cl(e,t,n))}};function Om(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Oo(r,n)||!Oo(i,s):!0}function Z0(t,e,r){var n=!1,i=On,s=e.contextType;return typeof s=="object"&&s!==null?s=Xt(s):(i=Rt(e)?di:pt.current,n=e.contextTypes,s=(n=n!=null)?Ts(t,i):On),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ru,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Lm(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Ru.enqueueReplaceState(e,e.state,null)}function nd(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Xf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Xt(s):(s=Rt(e)?di:pt.current,i.context=Ts(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(rd(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ru.enqueueReplaceState(i,i.state,null),$l(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Rs(t,e){try{var r="",n=e;do r+=pw(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Sc(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function id(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var GE=typeof WeakMap=="function"?WeakMap:Map;function Q0(t,e,r){r=Xr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Kl||(Kl=!0,pd=n),id(t,e)},r}function J0(t,e,r){r=Xr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){id(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){id(t,e),typeof n!="function"&&(Mn===null?Mn=new Set([this]):Mn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Um(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new GE;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=tS.bind(null,t,e,r),e.then(t,t))}function jm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Gm(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Xr(-1,1),e.tag=2,In(r,e,1))),r.lanes|=1),t)}var zE=tn.ReactCurrentOwner,Tt=!1;function gt(t,e,r,n){e.child=t===null?R0(e,null,r,n):As(e,t.child,r,n)}function zm(t,e,r,n,i){r=r.render;var s=e.ref;return fs(e,i),n=Qf(t,e,r,n,s,i),r=Jf(),t!==null&&!Tt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Qr(t,e,i)):(Be&&r&&jf(e),e.flags|=1,gt(t,e,n,i),e.child)}function Hm(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!up(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,ex(t,e,s,n,i)):(t=gl(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Oo,r(o,n)&&t.ref===e.ref)return Qr(t,e,i)}return e.flags|=1,t=Bn(s,n),t.ref=e.ref,t.return=e,e.child=t}function ex(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Oo(s,n)&&t.ref===e.ref)if(Tt=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Tt=!0);else return e.lanes=t.lanes,Qr(t,e,i)}return sd(t,e,r,n,i)}function tx(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(os,kt),kt|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Te(os,kt),kt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Te(os,kt),kt|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Te(os,kt),kt|=n;return gt(t,e,i,r),e.child}function rx(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function sd(t,e,r,n,i){var s=Rt(r)?di:pt.current;return s=Ts(e,s),fs(e,i),r=Qf(t,e,r,n,s,i),n=Jf(),t!==null&&!Tt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Qr(t,e,i)):(Be&&n&&jf(e),e.flags|=1,gt(t,e,r,i),e.child)}function $m(t,e,r,n,i){if(Rt(r)){var s=!0;Ul(e)}else s=!1;if(fs(e,i),e.stateNode===null)fl(t,e),Z0(e,r,n),nd(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Xt(u):(u=Rt(r)?di:pt.current,u=Ts(e,u));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==u)&&Lm(e,o,n,u),mn=!1;var d=e.memoizedState;o.state=d,$l(e,n,o,i),l=e.memoizedState,a!==n||d!==l||Ct.current||mn?(typeof c=="function"&&(rd(e,r,c,n),l=e.memoizedState),(a=mn||Om(e,r,a,n,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,I0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:rr(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=Xt(l):(l=Rt(r)?di:pt.current,l=Ts(e,l));var f=r.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&Lm(e,o,n,l),mn=!1,d=e.memoizedState,o.state=d,$l(e,n,o,i);var p=e.memoizedState;a!==h||d!==p||Ct.current||mn?(typeof f=="function"&&(rd(e,r,f,n),p=e.memoizedState),(u=mn||Om(e,r,u,n,d,p,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),o.props=n,o.state=p,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return od(t,e,r,n,s,i)}function od(t,e,r,n,i,s){rx(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Pm(e,r,!1),Qr(t,e,s);n=e.stateNode,zE.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=As(e,t.child,null,s),e.child=As(e,null,a,s)):gt(t,e,a,s),e.memoizedState=n.state,i&&Pm(e,r,!0),e.child}function nx(t){var e=t.stateNode;e.pendingContext?Rm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Rm(t,e.context,!1),Yf(t,e.containerInfo)}function Wm(t,e,r,n,i){return bs(),zf(i),e.flags|=256,gt(t,e,r,n),e.child}var ad={dehydrated:null,treeContext:null,retryLane:0};function ld(t){return{baseLanes:t,cachePool:null,transitions:null}}function ix(t,e,r){var n=e.pendingProps,i=De.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Te(De,i&1),t===null)return ed(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Mu(o,n,0,null),t=li(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=ld(r),e.memoizedState=ad,t):rp(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return HE(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Bn(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Bn(a,s):(s=li(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?ld(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=ad,n}return s=t.child,t=s.sibling,n=Bn(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function rp(t,e){return e=Mu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ra(t,e,r,n){return n!==null&&zf(n),As(e,t.child,null,r),t=rp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HE(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=Sc(Error(N(422))),Ra(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Mu({mode:"visible",children:n.children},i,0,null),s=li(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&As(e,t.child,null,o),e.child.memoizedState=ld(o),e.memoizedState=ad,s);if(!(e.mode&1))return Ra(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(N(419)),n=Sc(s,n,void 0),Ra(t,e,o,n)}if(a=(o&t.childLanes)!==0,Tt||a){if(n=nt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Zr(t,i),ar(n,t,i,-1))}return lp(),n=Sc(Error(N(421))),Ra(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=rS.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Bt=Pn(i.nextSibling),Dt=e,Be=!0,ir=null,t!==null&&(jt[Gt++]=Gr,jt[Gt++]=zr,jt[Gt++]=fi,Gr=t.id,zr=t.overflow,fi=e),e=rp(e,n.children),e.flags|=4096,e)}function Vm(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),td(t.return,e,r)}function Tc(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function sx(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(gt(t,e,n.children,r),n=De.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Vm(t,r,e);else if(t.tag===19)Vm(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Te(De,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Wl(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Tc(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Wl(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Tc(e,!0,r,null,s);break;case"together":Tc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qr(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),mi|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(N(153));if(e.child!==null){for(t=e.child,r=Bn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Bn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function $E(t,e,r){switch(e.tag){case 3:nx(e),bs();break;case 5:M0(e);break;case 1:Rt(e.type)&&Ul(e);break;case 4:Yf(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Te(zl,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Te(De,De.current&1),e.flags|=128,null):r&e.child.childLanes?ix(t,e,r):(Te(De,De.current&1),t=Qr(t,e,r),t!==null?t.sibling:null);Te(De,De.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return sx(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Te(De,De.current),n)break;return null;case 22:case 23:return e.lanes=0,tx(t,e,r)}return Qr(t,e,r)}var ox,ud,ax,lx;ox=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ud=function(){};ax=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,oi(Rr.current);var s=null;switch(r){case"input":i=Mh(t,i),n=Mh(t,n),s=[];break;case"select":i=Le({},i,{value:void 0}),n=Le({},n,{value:void 0}),s=[];break;case"textarea":i=Nh(t,i),n=Nh(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Ol)}Fh(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Io.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(a=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Io.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ae("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};lx=function(t,e,r,n){r!==n&&(e.flags|=4)};function qs(t,e){if(!Be)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function dt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function WE(t,e,r){var n=e.pendingProps;switch(Gf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(e),null;case 1:return Rt(e.type)&&Ll(),dt(e),null;case 3:return n=e.stateNode,Cs(),Re(Ct),Re(pt),qf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Aa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ir!==null&&(yd(ir),ir=null))),ud(t,e),dt(e),null;case 5:Kf(e);var i=oi(zo.current);if(r=e.type,t!==null&&e.stateNode!=null)ax(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(N(166));return dt(e),null}if(t=oi(Rr.current),Aa(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[br]=e,n[jo]=s,t=(e.mode&1)!==0,r){case"dialog":Ae("cancel",n),Ae("close",n);break;case"iframe":case"object":case"embed":Ae("load",n);break;case"video":case"audio":for(i=0;i<oo.length;i++)Ae(oo[i],n);break;case"source":Ae("error",n);break;case"img":case"image":case"link":Ae("error",n),Ae("load",n);break;case"details":Ae("toggle",n);break;case"input":tm(n,s),Ae("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ae("invalid",n);break;case"textarea":nm(n,s),Ae("invalid",n)}Fh(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&ba(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&ba(n.textContent,a,t),i=["children",""+a]):Io.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ae("scroll",n)}switch(r){case"input":ya(n),rm(n,s,!0);break;case"textarea":ya(n),im(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ol)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Fv(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[br]=e,t[jo]=n,ox(t,e,!1,!1),e.stateNode=t;e:{switch(o=Oh(r,n),r){case"dialog":Ae("cancel",t),Ae("close",t),i=n;break;case"iframe":case"object":case"embed":Ae("load",t),i=n;break;case"video":case"audio":for(i=0;i<oo.length;i++)Ae(oo[i],t);i=n;break;case"source":Ae("error",t),i=n;break;case"img":case"image":case"link":Ae("error",t),Ae("load",t),i=n;break;case"details":Ae("toggle",t),i=n;break;case"input":tm(t,n),i=Mh(t,n),Ae("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Le({},n,{value:void 0}),Ae("invalid",t);break;case"textarea":nm(t,n),i=Nh(t,n),Ae("invalid",t);break;default:i=n}Fh(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Uv(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ov(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Mo(t,l):typeof l=="number"&&Mo(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Io.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ae("scroll",t):l!=null&&Af(t,s,l,o))}switch(r){case"input":ya(t),rm(t,n,!1);break;case"textarea":ya(t),im(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Fn(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?us(t,!!n.multiple,s,!1):n.defaultValue!=null&&us(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ol)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return dt(e),null;case 6:if(t&&e.stateNode!=null)lx(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(N(166));if(r=oi(zo.current),oi(Rr.current),Aa(e)){if(n=e.stateNode,r=e.memoizedProps,n[br]=e,(s=n.nodeValue!==r)&&(t=Dt,t!==null))switch(t.tag){case 3:ba(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ba(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[br]=e,e.stateNode=n}return dt(e),null;case 13:if(Re(De),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Be&&Bt!==null&&e.mode&1&&!(e.flags&128))A0(),bs(),e.flags|=98560,s=!1;else if(s=Aa(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(N(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(N(317));s[br]=e}else bs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;dt(e),s=!1}else ir!==null&&(yd(ir),ir=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||De.current&1?Qe===0&&(Qe=3):lp())),e.updateQueue!==null&&(e.flags|=4),dt(e),null);case 4:return Cs(),ud(t,e),t===null&&Lo(e.stateNode.containerInfo),dt(e),null;case 10:return Wf(e.type._context),dt(e),null;case 17:return Rt(e.type)&&Ll(),dt(e),null;case 19:if(Re(De),s=e.memoizedState,s===null)return dt(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)qs(s,!1);else{if(Qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Wl(t),o!==null){for(e.flags|=128,qs(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Te(De,De.current&1|2),e.child}t=t.sibling}s.tail!==null&&$e()>Ps&&(e.flags|=128,n=!0,qs(s,!1),e.lanes=4194304)}else{if(!n)if(t=Wl(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),qs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Be)return dt(e),null}else 2*$e()-s.renderingStartTime>Ps&&r!==1073741824&&(e.flags|=128,n=!0,qs(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=$e(),e.sibling=null,r=De.current,Te(De,n?r&1|2:r&1),e):(dt(e),null);case 22:case 23:return ap(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?kt&1073741824&&(dt(e),e.subtreeFlags&6&&(e.flags|=8192)):dt(e),null;case 24:return null;case 25:return null}throw Error(N(156,e.tag))}function VE(t,e){switch(Gf(e),e.tag){case 1:return Rt(e.type)&&Ll(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Cs(),Re(Ct),Re(pt),qf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Kf(e),null;case 13:if(Re(De),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(N(340));bs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Re(De),null;case 4:return Cs(),null;case 10:return Wf(e.type._context),null;case 22:case 23:return ap(),null;case 24:return null;default:return null}}var Pa=!1,ft=!1,XE=typeof WeakSet=="function"?WeakSet:Set,W=null;function ss(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ge(t,e,n)}else r.current=null}function cd(t,e,r){try{r()}catch(n){Ge(t,e,n)}}var Xm=!1;function YE(t,e){if(Xh=Nl,t=f0(),Uf(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var f;h!==r||i!==0&&h.nodeType!==3||(a=o+i),h!==s||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===r&&++u===i&&(a=o),d===s&&++c===n&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Yh={focusedElem:t,selectionRange:r},Nl=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,x=p.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:rr(e.type,m),x);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(w){Ge(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return p=Xm,Xm=!1,p}function Eo(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&cd(e,r,s)}i=i.next}while(i!==n)}}function Pu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function hd(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function ux(t){var e=t.alternate;e!==null&&(t.alternate=null,ux(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[br],delete e[jo],delete e[Zh],delete e[IE],delete e[ME])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function cx(t){return t.tag===5||t.tag===3||t.tag===4}function Ym(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||cx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function dd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Ol));else if(n!==4&&(t=t.child,t!==null))for(dd(t,e,r),t=t.sibling;t!==null;)dd(t,e,r),t=t.sibling}function fd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(fd(t,e,r),t=t.sibling;t!==null;)fd(t,e,r),t=t.sibling}var ot=null,nr=!1;function un(t,e,r){for(r=r.child;r!==null;)hx(t,e,r),r=r.sibling}function hx(t,e,r){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(wu,r)}catch{}switch(r.tag){case 5:ft||ss(r,e);case 6:var n=ot,i=nr;ot=null,un(t,e,r),ot=n,nr=i,ot!==null&&(nr?(t=ot,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ot.removeChild(r.stateNode));break;case 18:ot!==null&&(nr?(t=ot,r=r.stateNode,t.nodeType===8?yc(t.parentNode,r):t.nodeType===1&&yc(t,r),Do(t)):yc(ot,r.stateNode));break;case 4:n=ot,i=nr,ot=r.stateNode.containerInfo,nr=!0,un(t,e,r),ot=n,nr=i;break;case 0:case 11:case 14:case 15:if(!ft&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&cd(r,e,o),i=i.next}while(i!==n)}un(t,e,r);break;case 1:if(!ft&&(ss(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Ge(r,e,a)}un(t,e,r);break;case 21:un(t,e,r);break;case 22:r.mode&1?(ft=(n=ft)||r.memoizedState!==null,un(t,e,r),ft=n):un(t,e,r);break;default:un(t,e,r)}}function Km(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new XE),e.forEach(function(n){var i=nS.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Zt(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ot=a.stateNode,nr=!1;break e;case 3:ot=a.stateNode.containerInfo,nr=!0;break e;case 4:ot=a.stateNode.containerInfo,nr=!0;break e}a=a.return}if(ot===null)throw Error(N(160));hx(s,o,i),ot=null,nr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Ge(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dx(e,t),e=e.sibling}function dx(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zt(e,t),pr(t),n&4){try{Eo(3,t,t.return),Pu(3,t)}catch(m){Ge(t,t.return,m)}try{Eo(5,t,t.return)}catch(m){Ge(t,t.return,m)}}break;case 1:Zt(e,t),pr(t),n&512&&r!==null&&ss(r,r.return);break;case 5:if(Zt(e,t),pr(t),n&512&&r!==null&&ss(r,r.return),t.flags&32){var i=t.stateNode;try{Mo(i,"")}catch(m){Ge(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Nv(i,s),Oh(a,o);var u=Oh(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?Uv(i,h):c==="dangerouslySetInnerHTML"?Ov(i,h):c==="children"?Mo(i,h):Af(i,c,h,u)}switch(a){case"input":kh(i,s);break;case"textarea":Dv(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?us(i,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?us(i,!!s.multiple,s.defaultValue,!0):us(i,!!s.multiple,s.multiple?[]:"",!1))}i[jo]=s}catch(m){Ge(t,t.return,m)}}break;case 6:if(Zt(e,t),pr(t),n&4){if(t.stateNode===null)throw Error(N(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Ge(t,t.return,m)}}break;case 3:if(Zt(e,t),pr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Do(e.containerInfo)}catch(m){Ge(t,t.return,m)}break;case 4:Zt(e,t),pr(t);break;case 13:Zt(e,t),pr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(sp=$e())),n&4&&Km(t);break;case 22:if(c=r!==null&&r.memoizedState!==null,t.mode&1?(ft=(u=ft)||c,Zt(e,t),ft=u):Zt(e,t),pr(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(W=t,c=t.child;c!==null;){for(h=W=c;W!==null;){switch(d=W,f=d.child,d.tag){case 0:case 11:case 14:case 15:Eo(4,d,d.return);break;case 1:ss(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Ge(n,r,m)}}break;case 5:ss(d,d.return);break;case 22:if(d.memoizedState!==null){Zm(h);continue}}f!==null?(f.return=d,W=f):Zm(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Lv("display",o))}catch(m){Ge(t,t.return,m)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Ge(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Zt(e,t),pr(t),n&4&&Km(t);break;case 21:break;default:Zt(e,t),pr(t)}}function pr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(cx(r)){var n=r;break e}r=r.return}throw Error(N(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Mo(i,""),n.flags&=-33);var s=Ym(t);fd(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=Ym(t);dd(t,a,o);break;default:throw Error(N(161))}}catch(l){Ge(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function KE(t,e,r){W=t,fx(t)}function fx(t,e,r){for(var n=(t.mode&1)!==0;W!==null;){var i=W,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Pa;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||ft;a=Pa;var u=ft;if(Pa=o,(ft=l)&&!u)for(W=i;W!==null;)o=W,l=o.child,o.tag===22&&o.memoizedState!==null?Qm(i):l!==null?(l.return=o,W=l):Qm(i);for(;s!==null;)W=s,fx(s),s=s.sibling;W=i,Pa=a,ft=u}qm(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,W=s):qm(t)}}function qm(t){for(;W!==null;){var e=W;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ft||Pu(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ft)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:rr(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Nm(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Nm(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Do(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}ft||e.flags&512&&hd(e)}catch(d){Ge(e,e.return,d)}}if(e===t){W=null;break}if(r=e.sibling,r!==null){r.return=e.return,W=r;break}W=e.return}}function Zm(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var r=e.sibling;if(r!==null){r.return=e.return,W=r;break}W=e.return}}function Qm(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Pu(4,e)}catch(l){Ge(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Ge(e,i,l)}}var s=e.return;try{hd(e)}catch(l){Ge(e,s,l)}break;case 5:var o=e.return;try{hd(e)}catch(l){Ge(e,o,l)}}}catch(l){Ge(e,e.return,l)}if(e===t){W=null;break}var a=e.sibling;if(a!==null){a.return=e.return,W=a;break}W=e.return}}var qE=Math.ceil,Yl=tn.ReactCurrentDispatcher,np=tn.ReactCurrentOwner,Vt=tn.ReactCurrentBatchConfig,ye=0,nt=null,Ve=null,lt=0,kt=0,os=Gn(0),Qe=0,Vo=null,mi=0,Iu=0,ip=0,So=null,St=null,sp=0,Ps=1/0,Lr=null,Kl=!1,pd=null,Mn=null,Ia=!1,wn=null,ql=0,To=0,md=null,pl=-1,ml=0;function vt(){return ye&6?$e():pl!==-1?pl:pl=$e()}function kn(t){return t.mode&1?ye&2&&lt!==0?lt&-lt:BE.transition!==null?(ml===0&&(ml=Zv()),ml):(t=we,t!==0||(t=window.event,t=t===void 0?16:i0(t.type)),t):1}function ar(t,e,r,n){if(50<To)throw To=0,md=null,Error(N(185));ta(t,r,n),(!(ye&2)||t!==nt)&&(t===nt&&(!(ye&2)&&(Iu|=r),Qe===4&&vn(t,lt)),Pt(t,n),r===1&&ye===0&&!(e.mode&1)&&(Ps=$e()+500,Au&&zn()))}function Pt(t,e){var r=t.callbackNode;Bw(t,e);var n=Bl(t,t===nt?lt:0);if(n===0)r!==null&&am(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&am(r),e===1)t.tag===0?kE(Jm.bind(null,t)):S0(Jm.bind(null,t)),RE(function(){!(ye&6)&&zn()}),r=null;else{switch(Qv(n)){case 1:r=Mf;break;case 4:r=Kv;break;case 16:r=kl;break;case 536870912:r=qv;break;default:r=kl}r=wx(r,px.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function px(t,e){if(pl=-1,ml=0,ye&6)throw Error(N(327));var r=t.callbackNode;if(ps()&&t.callbackNode!==r)return null;var n=Bl(t,t===nt?lt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Zl(t,n);else{e=n;var i=ye;ye|=2;var s=gx();(nt!==t||lt!==e)&&(Lr=null,Ps=$e()+500,ai(t,e));do try{JE();break}catch(a){mx(t,a)}while(!0);$f(),Yl.current=s,ye=i,Ve!==null?e=0:(nt=null,lt=0,e=Qe)}if(e!==0){if(e===2&&(i=zh(t),i!==0&&(n=i,e=gd(t,i))),e===1)throw r=Vo,ai(t,0),vn(t,n),Pt(t,$e()),r;if(e===6)vn(t,n);else{if(i=t.current.alternate,!(n&30)&&!ZE(i)&&(e=Zl(t,n),e===2&&(s=zh(t),s!==0&&(n=s,e=gd(t,s))),e===1))throw r=Vo,ai(t,0),vn(t,n),Pt(t,$e()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(N(345));case 2:Kn(t,St,Lr);break;case 3:if(vn(t,n),(n&130023424)===n&&(e=sp+500-$e(),10<e)){if(Bl(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){vt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=qh(Kn.bind(null,t,St,Lr),e);break}Kn(t,St,Lr);break;case 4:if(vn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-or(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=$e()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*qE(n/1960))-n,10<n){t.timeoutHandle=qh(Kn.bind(null,t,St,Lr),n);break}Kn(t,St,Lr);break;case 5:Kn(t,St,Lr);break;default:throw Error(N(329))}}}return Pt(t,$e()),t.callbackNode===r?px.bind(null,t):null}function gd(t,e){var r=So;return t.current.memoizedState.isDehydrated&&(ai(t,e).flags|=256),t=Zl(t,e),t!==2&&(e=St,St=r,e!==null&&yd(e)),t}function yd(t){St===null?St=t:St.push.apply(St,t)}function ZE(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!cr(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vn(t,e){for(e&=~ip,e&=~Iu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-or(e),n=1<<r;t[r]=-1,e&=~n}}function Jm(t){if(ye&6)throw Error(N(327));ps();var e=Bl(t,0);if(!(e&1))return Pt(t,$e()),null;var r=Zl(t,e);if(t.tag!==0&&r===2){var n=zh(t);n!==0&&(e=n,r=gd(t,n))}if(r===1)throw r=Vo,ai(t,0),vn(t,e),Pt(t,$e()),r;if(r===6)throw Error(N(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Kn(t,St,Lr),Pt(t,$e()),null}function op(t,e){var r=ye;ye|=1;try{return t(e)}finally{ye=r,ye===0&&(Ps=$e()+500,Au&&zn())}}function gi(t){wn!==null&&wn.tag===0&&!(ye&6)&&ps();var e=ye;ye|=1;var r=Vt.transition,n=we;try{if(Vt.transition=null,we=1,t)return t()}finally{we=n,Vt.transition=r,ye=e,!(ye&6)&&zn()}}function ap(){kt=os.current,Re(os)}function ai(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,CE(r)),Ve!==null)for(r=Ve.return;r!==null;){var n=r;switch(Gf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ll();break;case 3:Cs(),Re(Ct),Re(pt),qf();break;case 5:Kf(n);break;case 4:Cs();break;case 13:Re(De);break;case 19:Re(De);break;case 10:Wf(n.type._context);break;case 22:case 23:ap()}r=r.return}if(nt=t,Ve=t=Bn(t.current,null),lt=kt=e,Qe=0,Vo=null,ip=Iu=mi=0,St=So=null,si!==null){for(e=0;e<si.length;e++)if(r=si[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}si=null}return t}function mx(t,e){do{var r=Ve;try{if($f(),hl.current=Xl,Vl){for(var n=Oe.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Vl=!1}if(pi=0,tt=Ze=Oe=null,wo=!1,Ho=0,np.current=null,r===null||r.return===null){Qe=1,Vo=e,Ve=null;break}e:{var s=t,o=r.return,a=r,l=e;if(e=lt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=jm(o);if(f!==null){f.flags&=-257,Gm(f,o,a,s,e),f.mode&1&&Um(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){Um(s,u,e),lp();break e}l=Error(N(426))}}else if(Be&&a.mode&1){var x=jm(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Gm(x,o,a,s,e),zf(Rs(l,a));break e}}s=l=Rs(l,a),Qe!==4&&(Qe=2),So===null?So=[s]:So.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=Q0(s,l,e);Bm(s,y);break e;case 1:a=l;var v=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Mn===null||!Mn.has(g)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=J0(s,a,e);Bm(s,w);break e}}s=s.return}while(s!==null)}vx(r)}catch(S){e=S,Ve===r&&r!==null&&(Ve=r=r.return);continue}break}while(!0)}function gx(){var t=Yl.current;return Yl.current=Xl,t===null?Xl:t}function lp(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),nt===null||!(mi&268435455)&&!(Iu&268435455)||vn(nt,lt)}function Zl(t,e){var r=ye;ye|=2;var n=gx();(nt!==t||lt!==e)&&(Lr=null,ai(t,e));do try{QE();break}catch(i){mx(t,i)}while(!0);if($f(),ye=r,Yl.current=n,Ve!==null)throw Error(N(261));return nt=null,lt=0,Qe}function QE(){for(;Ve!==null;)yx(Ve)}function JE(){for(;Ve!==null&&!Tw();)yx(Ve)}function yx(t){var e=_x(t.alternate,t,kt);t.memoizedProps=t.pendingProps,e===null?vx(t):Ve=e,np.current=null}function vx(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=VE(r,e),r!==null){r.flags&=32767,Ve=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qe=6,Ve=null;return}}else if(r=WE(r,e,kt),r!==null){Ve=r;return}if(e=e.sibling,e!==null){Ve=e;return}Ve=e=t}while(e!==null);Qe===0&&(Qe=5)}function Kn(t,e,r){var n=we,i=Vt.transition;try{Vt.transition=null,we=1,eS(t,e,r,n)}finally{Vt.transition=i,we=n}return null}function eS(t,e,r,n){do ps();while(wn!==null);if(ye&6)throw Error(N(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(N(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Nw(t,s),t===nt&&(Ve=nt=null,lt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ia||(Ia=!0,wx(kl,function(){return ps(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Vt.transition,Vt.transition=null;var o=we;we=1;var a=ye;ye|=4,np.current=null,YE(t,r),dx(r,t),_E(Yh),Nl=!!Xh,Yh=Xh=null,t.current=r,KE(r),bw(),ye=a,we=o,Vt.transition=s}else t.current=r;if(Ia&&(Ia=!1,wn=t,ql=i),s=t.pendingLanes,s===0&&(Mn=null),Rw(r.stateNode),Pt(t,$e()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Kl)throw Kl=!1,t=pd,pd=null,t;return ql&1&&t.tag!==0&&ps(),s=t.pendingLanes,s&1?t===md?To++:(To=0,md=t):To=0,zn(),null}function ps(){if(wn!==null){var t=Qv(ql),e=Vt.transition,r=we;try{if(Vt.transition=null,we=16>t?16:t,wn===null)var n=!1;else{if(t=wn,wn=null,ql=0,ye&6)throw Error(N(331));var i=ye;for(ye|=4,W=t.current;W!==null;){var s=W,o=s.child;if(W.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(W=u;W!==null;){var c=W;switch(c.tag){case 0:case 11:case 15:Eo(8,c,s)}var h=c.child;if(h!==null)h.return=c,W=h;else for(;W!==null;){c=W;var d=c.sibling,f=c.return;if(ux(c),c===u){W=null;break}if(d!==null){d.return=f,W=d;break}W=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}W=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,W=o;else e:for(;W!==null;){if(s=W,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Eo(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,W=y;break e}W=s.return}}var v=t.current;for(W=v;W!==null;){o=W;var g=o.child;if(o.subtreeFlags&2064&&g!==null)g.return=o,W=g;else e:for(o=v;W!==null;){if(a=W,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Pu(9,a)}}catch(S){Ge(a,a.return,S)}if(a===o){W=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,W=w;break e}W=a.return}}if(ye=i,zn(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(wu,t)}catch{}n=!0}return n}finally{we=r,Vt.transition=e}}return!1}function eg(t,e,r){e=Rs(r,e),e=Q0(t,e,1),t=In(t,e,1),e=vt(),t!==null&&(ta(t,1,e),Pt(t,e))}function Ge(t,e,r){if(t.tag===3)eg(t,t,r);else for(;e!==null;){if(e.tag===3){eg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Mn===null||!Mn.has(n))){t=Rs(r,t),t=J0(e,t,1),e=In(e,t,1),t=vt(),e!==null&&(ta(e,1,t),Pt(e,t));break}}e=e.return}}function tS(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=vt(),t.pingedLanes|=t.suspendedLanes&r,nt===t&&(lt&r)===r&&(Qe===4||Qe===3&&(lt&130023424)===lt&&500>$e()-sp?ai(t,0):ip|=r),Pt(t,e)}function xx(t,e){e===0&&(t.mode&1?(e=_a,_a<<=1,!(_a&130023424)&&(_a=4194304)):e=1);var r=vt();t=Zr(t,e),t!==null&&(ta(t,e,r),Pt(t,r))}function rS(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),xx(t,r)}function nS(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(N(314))}n!==null&&n.delete(e),xx(t,r)}var _x;_x=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ct.current)Tt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Tt=!1,$E(t,e,r);Tt=!!(t.flags&131072)}else Tt=!1,Be&&e.flags&1048576&&T0(e,Gl,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;fl(t,e),t=e.pendingProps;var i=Ts(e,pt.current);fs(e,r),i=Qf(null,e,n,t,i,r);var s=Jf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rt(n)?(s=!0,Ul(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Xf(e),i.updater=Ru,e.stateNode=i,i._reactInternals=e,nd(e,n,t,r),e=od(null,e,n,!0,s,r)):(e.tag=0,Be&&s&&jf(e),gt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(fl(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=sS(n),t=rr(n,t),i){case 0:e=sd(null,e,n,t,r);break e;case 1:e=$m(null,e,n,t,r);break e;case 11:e=zm(null,e,n,t,r);break e;case 14:e=Hm(null,e,n,rr(n.type,t),r);break e}throw Error(N(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:rr(n,i),sd(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:rr(n,i),$m(t,e,n,i,r);case 3:e:{if(nx(e),t===null)throw Error(N(387));n=e.pendingProps,s=e.memoizedState,i=s.element,I0(t,e),$l(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Rs(Error(N(423)),e),e=Wm(t,e,n,r,i);break e}else if(n!==i){i=Rs(Error(N(424)),e),e=Wm(t,e,n,r,i);break e}else for(Bt=Pn(e.stateNode.containerInfo.firstChild),Dt=e,Be=!0,ir=null,r=R0(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(bs(),n===i){e=Qr(t,e,r);break e}gt(t,e,n,r)}e=e.child}return e;case 5:return M0(e),t===null&&ed(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Kh(n,i)?o=null:s!==null&&Kh(n,s)&&(e.flags|=32),rx(t,e),gt(t,e,o,r),e.child;case 6:return t===null&&ed(e),null;case 13:return ix(t,e,r);case 4:return Yf(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=As(e,null,n,r):gt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:rr(n,i),zm(t,e,n,i,r);case 7:return gt(t,e,e.pendingProps,r),e.child;case 8:return gt(t,e,e.pendingProps.children,r),e.child;case 12:return gt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Te(zl,n._currentValue),n._currentValue=o,s!==null)if(cr(s.value,o)){if(s.children===i.children&&!Ct.current){e=Qr(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Xr(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),td(s.return,r,e),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(N(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),td(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}gt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,fs(e,r),i=Xt(i),n=n(i),e.flags|=1,gt(t,e,n,r),e.child;case 14:return n=e.type,i=rr(n,e.pendingProps),i=rr(n.type,i),Hm(t,e,n,i,r);case 15:return ex(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:rr(n,i),fl(t,e),e.tag=1,Rt(n)?(t=!0,Ul(e)):t=!1,fs(e,r),Z0(e,n,i),nd(e,n,i,r),od(null,e,n,!0,t,r);case 19:return sx(t,e,r);case 22:return tx(t,e,r)}throw Error(N(156,e.tag))};function wx(t,e){return Yv(t,e)}function iS(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zt(t,e,r,n){return new iS(t,e,r,n)}function up(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sS(t){if(typeof t=="function")return up(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Rf)return 11;if(t===Pf)return 14}return 2}function Bn(t,e){var r=t.alternate;return r===null?(r=zt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function gl(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")up(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qi:return li(r.children,i,s,e);case Cf:o=8,i|=8;break;case Ch:return t=zt(12,r,e,i|2),t.elementType=Ch,t.lanes=s,t;case Rh:return t=zt(13,r,e,i),t.elementType=Rh,t.lanes=s,t;case Ph:return t=zt(19,r,e,i),t.elementType=Ph,t.lanes=s,t;case Mv:return Mu(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Pv:o=10;break e;case Iv:o=9;break e;case Rf:o=11;break e;case Pf:o=14;break e;case pn:o=16,n=null;break e}throw Error(N(130,t==null?t:typeof t,""))}return e=zt(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function li(t,e,r,n){return t=zt(7,t,n,e),t.lanes=r,t}function Mu(t,e,r,n){return t=zt(22,t,n,e),t.elementType=Mv,t.lanes=r,t.stateNode={isHidden:!1},t}function bc(t,e,r){return t=zt(6,t,null,e),t.lanes=r,t}function Ac(t,e,r){return e=zt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function oS(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oc(0),this.expirationTimes=oc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oc(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function cp(t,e,r,n,i,s,o,a,l){return t=new oS(t,e,r,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=zt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xf(s),t}function aS(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ki,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Ex(t){if(!t)return On;t=t._reactInternals;e:{if(wi(t)!==t||t.tag!==1)throw Error(N(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(N(171))}if(t.tag===1){var r=t.type;if(Rt(r))return E0(t,r,e)}return e}function Sx(t,e,r,n,i,s,o,a,l){return t=cp(r,n,!0,t,i,s,o,a,l),t.context=Ex(null),r=t.current,n=vt(),i=kn(r),s=Xr(n,i),s.callback=e??null,In(r,s,i),t.current.lanes=i,ta(t,i,n),Pt(t,n),t}function ku(t,e,r,n){var i=e.current,s=vt(),o=kn(i);return r=Ex(r),e.context===null?e.context=r:e.pendingContext=r,e=Xr(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=In(i,e,o),t!==null&&(ar(t,i,o,s),cl(t,i,o)),o}function Ql(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function tg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function hp(t,e){tg(t,e),(t=t.alternate)&&tg(t,e)}function lS(){return null}var Tx=typeof reportError=="function"?reportError:function(t){console.error(t)};function dp(t){this._internalRoot=t}Bu.prototype.render=dp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(N(409));ku(t,e,null,null)};Bu.prototype.unmount=dp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;gi(function(){ku(null,t,null,null)}),e[qr]=null}};function Bu(t){this._internalRoot=t}Bu.prototype.unstable_scheduleHydration=function(t){if(t){var e=t0();t={blockedOn:null,target:t,priority:e};for(var r=0;r<yn.length&&e!==0&&e<yn[r].priority;r++);yn.splice(r,0,t),r===0&&n0(t)}};function fp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Nu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rg(){}function uS(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Ql(o);s.call(u)}}var o=Sx(e,n,t,0,null,!1,!1,"",rg);return t._reactRootContainer=o,t[qr]=o.current,Lo(t.nodeType===8?t.parentNode:t),gi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var u=Ql(l);a.call(u)}}var l=cp(t,0,!1,null,null,!1,!1,"",rg);return t._reactRootContainer=l,t[qr]=l.current,Lo(t.nodeType===8?t.parentNode:t),gi(function(){ku(e,l,r,n)}),l}function Du(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Ql(o);a.call(l)}}ku(e,o,t,i)}else o=uS(r,e,t,i,n);return Ql(o)}Jv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=so(e.pendingLanes);r!==0&&(kf(e,r|1),Pt(e,$e()),!(ye&6)&&(Ps=$e()+500,zn()))}break;case 13:gi(function(){var n=Zr(t,1);if(n!==null){var i=vt();ar(n,t,1,i)}}),hp(t,1)}};Bf=function(t){if(t.tag===13){var e=Zr(t,134217728);if(e!==null){var r=vt();ar(e,t,134217728,r)}hp(t,134217728)}};e0=function(t){if(t.tag===13){var e=kn(t),r=Zr(t,e);if(r!==null){var n=vt();ar(r,t,e,n)}hp(t,e)}};t0=function(){return we};r0=function(t,e){var r=we;try{return we=t,e()}finally{we=r}};Uh=function(t,e,r){switch(e){case"input":if(kh(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=bu(n);if(!i)throw Error(N(90));Bv(n),kh(n,i)}}}break;case"textarea":Dv(t,r);break;case"select":e=r.value,e!=null&&us(t,!!r.multiple,e,!1)}};zv=op;Hv=gi;var cS={usingClientEntryPoint:!1,Events:[na,es,bu,jv,Gv,op]},Zs={findFiberByHostInstance:ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hS={bundleType:Zs.bundleType,version:Zs.version,rendererPackageName:Zs.rendererPackageName,rendererConfig:Zs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:tn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Vv(t),t===null?null:t.stateNode},findFiberByHostInstance:Zs.findFiberByHostInstance||lS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ma=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ma.isDisabled&&Ma.supportsFiber)try{wu=Ma.inject(hS),Cr=Ma}catch{}}Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cS;Ot.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fp(e))throw Error(N(200));return aS(t,e,null,r)};Ot.createRoot=function(t,e){if(!fp(t))throw Error(N(299));var r=!1,n="",i=Tx;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=cp(t,1,!1,null,null,r,!1,n,i),t[qr]=e.current,Lo(t.nodeType===8?t.parentNode:t),new dp(e)};Ot.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(N(188)):(t=Object.keys(t).join(","),Error(N(268,t)));return t=Vv(e),t=t===null?null:t.stateNode,t};Ot.flushSync=function(t){return gi(t)};Ot.hydrate=function(t,e,r){if(!Nu(e))throw Error(N(200));return Du(null,t,e,!0,r)};Ot.hydrateRoot=function(t,e,r){if(!fp(t))throw Error(N(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=Tx;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Sx(e,null,t,1,r??null,i,!1,s,o),t[qr]=e.current,Lo(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Bu(e)};Ot.render=function(t,e,r){if(!Nu(e))throw Error(N(200));return Du(null,t,e,!1,r)};Ot.unmountComponentAtNode=function(t){if(!Nu(t))throw Error(N(40));return t._reactRootContainer?(gi(function(){Du(null,null,t,!1,function(){t._reactRootContainer=null,t[qr]=null})}),!0):!1};Ot.unstable_batchedUpdates=op;Ot.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Nu(r))throw Error(N(200));if(t==null||t._reactInternals===void 0)throw Error(N(38));return Du(t,e,r,!1,n)};Ot.version="18.3.1-next-f1338f8080-20240426";function bx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bx)}catch(t){console.error(t)}}bx(),bv.exports=Ot;var dS=bv.exports,ng=dS;bh.createRoot=ng.createRoot,bh.hydrateRoot=ng.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xo(){return Xo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Xo.apply(this,arguments)}var En;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(En||(En={}));const ig="popstate";function fS(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return vd("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Jl(i)}return mS(e,r,null,t)}function Xe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function pp(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function pS(){return Math.random().toString(36).substr(2,8)}function sg(t,e){return{usr:t.state,key:t.key,idx:e}}function vd(t,e,r,n){return r===void 0&&(r=null),Xo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Os(e):e,{state:r,key:e&&e.key||n||pS()})}function Jl(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Os(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function mS(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=En.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(Xo({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=En.Pop;let x=c(),y=x==null?null:x-u;u=x,l&&l({action:a,location:m.location,delta:y})}function d(x,y){a=En.Push;let v=vd(m.location,x,y);u=c()+1;let g=sg(v,u),w=m.createHref(v);try{o.pushState(g,"",w)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(w)}s&&l&&l({action:a,location:m.location,delta:1})}function f(x,y){a=En.Replace;let v=vd(m.location,x,y);u=c();let g=sg(v,u),w=m.createHref(v);o.replaceState(g,"",w),s&&l&&l({action:a,location:m.location,delta:0})}function p(x){let y=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof x=="string"?x:Jl(x);return v=v.replace(/ $/,"%20"),Xe(y,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,y)}let m={get action(){return a},get location(){return t(i,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(ig,h),l=x,()=>{i.removeEventListener(ig,h),l=null}},createHref(x){return e(i,x)},createURL:p,encodeLocation(x){let y=p(x);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:f,go(x){return o.go(x)}};return m}var og;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(og||(og={}));function gS(t,e,r){return r===void 0&&(r="/"),yS(t,e,r)}function yS(t,e,r,n){let i=typeof e=="string"?Os(e):e,s=mp(i.pathname||"/",r);if(s==null)return null;let o=Ax(t);vS(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=IS(s);a=CS(o[l],u)}return a}function Ax(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Xe(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=Nn([n,l.relativePath]),c=r.concat(l);s.children&&s.children.length>0&&(Xe(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Ax(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:bS(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of Cx(s.path))i(s,o,l)}),e}function Cx(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=Cx(n.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function vS(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:AS(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const xS=/^:[\w-]+$/,_S=3,wS=2,ES=1,SS=10,TS=-2,ag=t=>t==="*";function bS(t,e){let r=t.split("/"),n=r.length;return r.some(ag)&&(n+=TS),e&&(n+=wS),r.filter(i=>!ag(i)).reduce((i,s)=>i+(xS.test(s)?_S:s===""?ES:SS),n)}function AS(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function CS(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],u=a===n.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=RS({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Nn([s,h.pathname]),pathnameBase:DS(Nn([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=Nn([s,h.pathnameBase]))}return o}function RS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=PS(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let m=a[h]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[h];return f&&!p?u[d]=void 0:u[d]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function PS(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),pp(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function IS(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return pp(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function mp(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const MS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kS=t=>MS.test(t);function BS(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Os(t):t,s;if(r)if(kS(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),pp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=lg(r.substring(1),"/"):s=lg(r,e)}else s=e;return{pathname:s,search:FS(n),hash:OS(i)}}function lg(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Cc(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function NS(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Rx(t,e){let r=NS(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Px(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Os(t):(i=Xo({},t),Xe(!i.pathname||!i.pathname.includes("?"),Cc("?","pathname","search",i)),Xe(!i.pathname||!i.pathname.includes("#"),Cc("#","pathname","hash",i)),Xe(!i.search||!i.search.includes("#"),Cc("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=BS(i,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Nn=t=>t.join("/").replace(/\/\/+/g,"/"),DS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),FS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,OS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function LS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Ix=["post","put","patch","delete"];new Set(Ix);const US=["get",...Ix];new Set(US);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yo(){return Yo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Yo.apply(this,arguments)}const gp=T.createContext(null),jS=T.createContext(null),Ei=T.createContext(null),Fu=T.createContext(null),Si=T.createContext({outlet:null,matches:[],isDataRoute:!1}),Mx=T.createContext(null);function GS(t,e){let{relative:r}=e===void 0?{}:e;sa()||Xe(!1);let{basename:n,navigator:i}=T.useContext(Ei),{hash:s,pathname:o,search:a}=Bx(t,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:Nn([n,o])),i.createHref({pathname:l,search:a,hash:s})}function sa(){return T.useContext(Fu)!=null}function oa(){return sa()||Xe(!1),T.useContext(Fu).location}function kx(t){T.useContext(Ei).static||T.useLayoutEffect(t)}function kr(){let{isDataRoute:t}=T.useContext(Si);return t?eT():zS()}function zS(){sa()||Xe(!1);let t=T.useContext(gp),{basename:e,future:r,navigator:n}=T.useContext(Ei),{matches:i}=T.useContext(Si),{pathname:s}=oa(),o=JSON.stringify(Rx(i,r.v7_relativeSplatPath)),a=T.useRef(!1);return kx(()=>{a.current=!0}),T.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){n.go(u);return}let h=Px(u,JSON.parse(o),s,c.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Nn([e,h.pathname])),(c.replace?n.replace:n.push)(h,c.state,c)},[e,n,o,s,t])}function Bx(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=T.useContext(Ei),{matches:i}=T.useContext(Si),{pathname:s}=oa(),o=JSON.stringify(Rx(i,n.v7_relativeSplatPath));return T.useMemo(()=>Px(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function HS(t,e){return $S(t,e)}function $S(t,e,r,n){sa()||Xe(!1);let{navigator:i}=T.useContext(Ei),{matches:s}=T.useContext(Si),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=oa(),c;if(e){var h;let x=typeof e=="string"?Os(e):e;l==="/"||(h=x.pathname)!=null&&h.startsWith(l)||Xe(!1),c=x}else c=u;let d=c.pathname||"/",f=d;if(l!=="/"){let x=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(x.length).join("/")}let p=gS(t,{pathname:f}),m=KS(p&&p.map(x=>Object.assign({},x,{params:Object.assign({},a,x.params),pathname:Nn([l,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:Nn([l,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,r,n);return e&&m?T.createElement(Fu.Provider,{value:{location:Yo({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:En.Pop}},m):m}function WS(){let t=JS(),e=LS(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),r?T.createElement("pre",{style:i},r):null,null)}const VS=T.createElement(WS,null);class XS extends T.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?T.createElement(Si.Provider,{value:this.props.routeContext},T.createElement(Mx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YS(t){let{routeContext:e,match:r,children:n}=t,i=T.useContext(gp);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),T.createElement(Si.Provider,{value:e},n)}function KS(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let c=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);c>=0||Xe(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let c=0;c<o.length;c++){let h=o[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:f}=r,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,h,d)=>{let f,p=!1,m=null,x=null;r&&(f=a&&h.route.id?a[h.route.id]:void 0,m=h.route.errorElement||VS,l&&(u<0&&d===0?(tT("route-fallback"),p=!0,x=null):u===d&&(p=!0,x=h.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,d+1)),v=()=>{let g;return f?g=m:p?g=x:h.route.Component?g=T.createElement(h.route.Component,null):h.route.element?g=h.route.element:g=c,T.createElement(YS,{match:h,routeContext:{outlet:c,matches:y,isDataRoute:r!=null},children:g})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?T.createElement(XS,{location:r.location,revalidation:r.revalidation,component:m,error:f,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}var Nx=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Nx||{}),Dx=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Dx||{});function qS(t){let e=T.useContext(gp);return e||Xe(!1),e}function ZS(t){let e=T.useContext(jS);return e||Xe(!1),e}function QS(t){let e=T.useContext(Si);return e||Xe(!1),e}function Fx(t){let e=QS(),r=e.matches[e.matches.length-1];return r.route.id||Xe(!1),r.route.id}function JS(){var t;let e=T.useContext(Mx),r=ZS(),n=Fx();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function eT(){let{router:t}=qS(Nx.UseNavigateStable),e=Fx(Dx.UseNavigateStable),r=T.useRef(!1);return kx(()=>{r.current=!0}),T.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Yo({fromRouteId:e},s)))},[t,e])}const ug={};function tT(t,e,r){ug[t]||(ug[t]=!0)}function rT(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Or(t){Xe(!1)}function nT(t){let{basename:e="/",children:r=null,location:n,navigationType:i=En.Pop,navigator:s,static:o=!1,future:a}=t;sa()&&Xe(!1);let l=e.replace(/^\/*/,"/"),u=T.useMemo(()=>({basename:l,navigator:s,static:o,future:Yo({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof n=="string"&&(n=Os(n));let{pathname:c="/",search:h="",hash:d="",state:f=null,key:p="default"}=n,m=T.useMemo(()=>{let x=mp(c,l);return x==null?null:{location:{pathname:x,search:h,hash:d,state:f,key:p},navigationType:i}},[l,c,h,d,f,p,i]);return m==null?null:T.createElement(Ei.Provider,{value:u},T.createElement(Fu.Provider,{children:r,value:m}))}function iT(t){let{children:e,location:r}=t;return HS(xd(e),r)}new Promise(()=>{});function xd(t,e){e===void 0&&(e=[]);let r=[];return T.Children.forEach(t,(n,i)=>{if(!T.isValidElement(n))return;let s=[...e,i];if(n.type===T.Fragment){r.push.apply(r,xd(n.props.children,s));return}n.type!==Or&&Xe(!1),!n.props.index||!n.props.children||Xe(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=xd(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _d(){return _d=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_d.apply(this,arguments)}function sT(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function oT(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function aT(t,e){return t.button===0&&(!e||e==="_self")&&!oT(t)}function wd(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function lT(t,e){let r=wd(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(s=>{r.append(i,s)})}),r}const uT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],cT="6";try{window.__reactRouterVersion=cT}catch{}const hT="startTransition",cg=tw[hT];function dT(t){let{basename:e,children:r,future:n,window:i}=t,s=T.useRef();s.current==null&&(s.current=fS({window:i,v5Compat:!0}));let o=s.current,[a,l]=T.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},c=T.useCallback(h=>{u&&cg?cg(()=>l(h)):l(h)},[l,u]);return T.useLayoutEffect(()=>o.listen(c),[o,c]),T.useEffect(()=>rT(n),[n]),T.createElement(nT,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const fT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",pT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mT=T.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:h}=e,d=sT(e,uT),{basename:f}=T.useContext(Ei),p,m=!1;if(typeof u=="string"&&pT.test(u)&&(p=u,fT))try{let g=new URL(window.location.href),w=u.startsWith("//")?new URL(g.protocol+u):new URL(u),S=mp(w.pathname,f);w.origin===g.origin&&S!=null?u=S+w.search+w.hash:m=!0}catch{}let x=GS(u,{relative:i}),y=gT(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:i,viewTransition:h});function v(g){n&&n(g),g.defaultPrevented||y(g)}return T.createElement("a",_d({},d,{href:p||x,onClick:m||s?n:v,ref:r,target:l}))});var hg;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(hg||(hg={}));var dg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(dg||(dg={}));function gT(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=kr(),u=oa(),c=Bx(t,{relative:o});return T.useCallback(h=>{if(aT(h,r)){h.preventDefault();let d=n!==void 0?n:Jl(u)===Jl(c);l(t,{replace:d,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,c,n,i,r,t,s,o,a])}function Ox(t){let e=T.useRef(wd(t)),r=T.useRef(!1),n=oa(),i=T.useMemo(()=>lT(n.search,r.current?null:e.current),[n.search]),s=kr(),o=T.useCallback((a,l)=>{const u=wd(typeof a=="function"?a(i):a);r.current=!0,s("?"+u,l)},[s,i]);return[i,o]}function yT(){const t=kr();return _.jsxs("div",{className:"screen screen-center",style:{position:"relative"},children:[_.jsx("div",{style:{position:"absolute",top:"10%",left:"5%",opacity:.08,transform:"rotate(-15deg)"},children:_.jsx(fg,{size:120})}),_.jsx("div",{style:{position:"absolute",bottom:"15%",right:"8%",opacity:.06,transform:"rotate(20deg) scaleX(-1)"},children:_.jsx(fg,{size:100})}),_.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px",zIndex:1},children:[_.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:_.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"16px",background:"linear-gradient(135deg, var(--color-primary) 0%, #1a3d2a 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(45, 90, 39, 0.3)"},children:_.jsx(vT,{})})}),_.jsx("h1",{style:{margin:0,fontSize:"36px",letterSpacing:"-1px"},children:"SOUNDFIELD"}),_.jsx("div",{style:{fontSize:"18px",color:"var(--color-accent)",fontWeight:600,marginTop:"-12px",letterSpacing:"3px"},children:"BIRDS"}),_.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"15px",maxWidth:"280px",textAlign:"center",lineHeight:1.5,marginTop:"8px"},children:"Train your ear to identify birds by their songs and calls"}),_.jsx("button",{onClick:()=>t("/pack-select"),style:{marginTop:"24px",padding:"18px 64px",fontSize:"20px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"16px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.4)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(45, 90, 39, 0.5)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(45, 90, 39, 0.4)"},children:"Play"}),_.jsx("div",{style:{marginTop:"32px",padding:"16px 20px",background:"var(--color-surface)",borderRadius:"12px",maxWidth:"300px"},children:_.jsxs("div",{style:{display:"flex",justifyContent:"space-around",gap:"16px"},children:[_.jsxs("div",{style:{textAlign:"center"},children:[_.jsx("div",{style:{fontSize:"24px",marginBottom:"4px"},children:_.jsx(xT,{})}),_.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Listen"})]}),_.jsxs("div",{style:{textAlign:"center"},children:[_.jsx("div",{style:{fontSize:"24px",marginBottom:"4px"},children:_.jsx(_T,{})}),_.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Identify"})]}),_.jsxs("div",{style:{textAlign:"center"},children:[_.jsx("div",{style:{fontSize:"24px",marginBottom:"4px"},children:_.jsx(wT,{})}),_.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Tap"})]})]})})]}),_.jsxs("div",{style:{position:"absolute",bottom:"calc(24px + var(--safe-area-bottom, 0px))",left:0,right:0,display:"flex",justifyContent:"center",gap:"32px"},children:[_.jsxs("button",{className:"btn-icon",onClick:()=>t("/help"),"aria-label":"How to Play",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[_.jsx(ET,{}),_.jsx("span",{style:{fontSize:"10px",opacity:.6},children:"Help"})]}),_.jsxs("button",{className:"btn-icon",onClick:()=>t("/settings"),"aria-label":"Settings",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[_.jsx(ST,{}),_.jsx("span",{style:{fontSize:"10px",opacity:.6},children:"Settings"})]}),_.jsxs("button",{className:"btn-icon",onClick:()=>t("/progress"),"aria-label":"Progress",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[_.jsx(TT,{}),_.jsx("span",{style:{fontSize:"10px",opacity:.6},children:"Stats"})]})]})]})}function vT(){return _.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"1.5",children:[_.jsx("path",{d:"M3 18v-6a9 9 0 0 1 18 0v6"}),_.jsx("path",{d:"M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3v5z"}),_.jsx("path",{d:"M3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3v5z"})]})}function xT(){return _.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-accent)",strokeWidth:"2",children:[_.jsx("path",{d:"M6 8.5a6.5 6.5 0 1 1 13 0c0 6-6 6-6 10.5a3.5 3.5 0 1 1-7 0"}),_.jsx("path",{d:"M15 8.5a2.5 2.5 0 0 0-5 0v1a2 2 0 0 0 4 0"})]})}function _T(){return _.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-accent)",strokeWidth:"2",children:[_.jsx("path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"}),_.jsx("path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"}),_.jsx("path",{d:"M12 5v14"})]})}function wT(){return _.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-accent)",strokeWidth:"2",children:[_.jsx("path",{d:"M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0"}),_.jsx("path",{d:"M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2"}),_.jsx("path",{d:"M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8"}),_.jsx("path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"})]})}function ET(){return _.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[_.jsx("circle",{cx:"12",cy:"12",r:"10"}),_.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),_.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}function ST(){return _.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[_.jsx("circle",{cx:"12",cy:"12",r:"3"}),_.jsx("path",{d:"M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"})]})}function TT(){return _.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[_.jsx("path",{d:"M3 3v18h18"}),_.jsx("path",{d:"M7 16l4-4 4 4 6-6"})]})}function fg({size:t=80}){return _.jsx("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"currentColor",children:_.jsx("path",{d:"M85 35c-5-3-12-2-18 1-3-8-10-14-19-16 2-3 3-7 2-11-1-5-5-8-9-7s-7 5-6 10c0 2 1 4 2 5-10 3-18 11-21 21-8-1-16 2-21 8-2 2-1 5 1 6s5 0 7-2c3-4 8-5 13-4 0 12 7 23 18 28l-8 12c-2 2-1 5 1 7 2 1 5 1 6-2l10-14c3 1 6 1 9 1 4 0 7-1 10-2l10 14c2 2 5 3 7 1s2-5 0-7l-8-12c11-5 18-16 18-28 5-1 10 0 13 4 2 2 5 3 7 2s3-4 1-6c-5-6-13-9-21-8z"})})}const pg=[{id:"starter_birds",name:"5 Common Backyard Birds",speciesCount:5,isUnlocked:!0,description:"Start here! Five distinctive birds with bold, recognizable voices."},{id:"expanded_backyard",name:"Expanded Local Birds",speciesCount:27,isUnlocked:!0,description:"Ready for more? 9 random birds per round from 27 eastern US species."},{id:"sparrows",name:"Sparrows",speciesCount:7,isUnlocked:!0,description:"Master the subtle songs of seven sparrow species."},{id:"woodpeckers",name:"Woodpeckers",speciesCount:7,isUnlocked:!0,description:"Learn the drums, calls, and rattles of seven woodpecker species."}],bT={starter_birds:["NOCA","CARW","TUTI","BLJA","AMCR"],expanded_backyard:["NOCA","CARW","BLJA","AMCR","TUTI","BEKI","RSHA","AMGO","CACH","PIWA","WTSP","HOFI","EABL","AMRO","HETH","BHNU","BRCR","WBNU","YBSA","RBWO","DOWO","HAWO","NOFL","PIWO","BRTH","GRCA","MODO"],sparrows:["WTSP","SOSP","CHSP","SWSP","SASP","FISP","LISP"],woodpeckers:["DOWO","HAWO","RBWO","PIWO","YBSA","NOFL","RHWO"]};function AT(){const t=kr(),[e,r]=T.useState([]),[n,i]=T.useState(null),s=T.useRef(null);T.useEffect(()=>{fetch("/bird-sound-game/data/clips.json").then(u=>u.json()).then(u=>r(u)).catch(u=>console.error("Failed to load clips:",u))},[]);const o=u=>(bT[u]||[]).map(h=>{const d=e.find(m=>m.species_code===h&&m.canonical&&!m.rejected),f=e.find(m=>m.species_code===h&&!m.rejected),p=d||f;return{code:h,name:(p==null?void 0:p.common_name)||h,canonicalClipPath:p?`/bird-sound-game/data/clips/${p.file_path.split("/").pop()}`:null}}).sort((h,d)=>h.code.localeCompare(d.code)),a=u=>{u.isUnlocked&&t(`/level-select?pack=${u.id}`)},l=(u,c)=>{if(s.current&&(s.current.pause(),s.current=null),n===c){i(null);return}const h=new Audio(u);s.current=h,i(c),h.play().catch(d=>console.error("Failed to play audio:",d)),h.onended=()=>{i(null),s.current=null}};return T.useEffect(()=>()=>{s.current&&s.current.pause()},[]),_.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[_.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[_.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:_.jsx(CT,{})}),_.jsx("h2",{style:{margin:0},children:"Select a Bird Pack"})]}),_.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.6},children:[_.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[_.jsx("li",{children:"Each pack has 6 levels - from signature sounds to full repertoires"}),_.jsx("li",{children:"New to 4-letter codes? See the Bird Reference section below"}),_.jsx("li",{children:"Pro tip: Once expert, try playing muted using only spectrograms!"})]}),_.jsxs("div",{style:{marginTop:"8px"},children:[_.jsx(mT,{to:"/help",style:{color:"var(--color-accent)"},children:"How to Play"})," for full instructions"]})]}),_.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"32px"},children:pg.map((u,c)=>_.jsxs("button",{onClick:()=>a(u),style:{position:"relative",overflow:"hidden",textAlign:"left",padding:"20px 16px",borderRadius:"16px",border:"none",background:c===0?"linear-gradient(135deg, #2d5a3d 0%, #1a3d2a 100%)":"linear-gradient(135deg, #4a6741 0%, #2d4a32 100%)",boxShadow:u.isUnlocked?"0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"none",opacity:u.isUnlocked?1:.5,cursor:u.isUnlocked?"pointer":"not-allowed",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:h=>{u.isUnlocked&&(h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1)")},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[_.jsx("div",{style:{position:"absolute",right:"-10px",bottom:"-10px",opacity:.15,transform:"rotate(-15deg)"},children:_.jsx(MT,{size:80})}),_.jsxs("div",{style:{position:"relative",zIndex:1},children:[_.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#f5f0e6",lineHeight:1.3,marginBottom:"6px"},children:u.name}),_.jsx("div",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.6)",lineHeight:1.4,marginBottom:"10px"},children:u.description}),_.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[_.jsxs("span",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.7)",fontWeight:500},children:[u.speciesCount," species"]}),u.isUnlocked&&_.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#a8d5a2",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Play ",_.jsx(IT,{})]})]})]})]},u.id))}),_.jsxs("div",{style:{marginTop:"16px"},children:[_.jsx("h3",{style:{fontSize:"16px",marginBottom:"16px",color:"var(--color-text-muted)"},children:"Bird Reference"}),pg.filter(u=>u.isUnlocked).map(u=>_.jsxs("div",{style:{marginBottom:"24px"},children:[_.jsx("h4",{style:{fontSize:"14px",marginBottom:"12px",color:"var(--color-accent)"},children:u.name}),_.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:o(u.id).map(c=>_.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[_.jsx("button",{onClick:()=>c.canonicalClipPath&&l(c.canonicalClipPath,c.code),disabled:!c.canonicalClipPath,style:{width:"32px",height:"32px",borderRadius:"50%",border:"none",background:n===c.code?"var(--color-accent)":"var(--color-primary)",color:"white",cursor:c.canonicalClipPath?"pointer":"not-allowed",opacity:c.canonicalClipPath?1:.3,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play ${c.name}`,children:n===c.code?_.jsx(PT,{}):_.jsx(RT,{})}),_.jsxs("div",{style:{minWidth:0},children:[_.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:c.code}),_.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:c.name})]})]},c.code))})]},u.id))]})]})}function CT(){return _.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:_.jsx("path",{d:"M15 18l-6-6 6-6"})})}function RT(){return _.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:_.jsx("path",{d:"M8 5v14l11-7z"})})}function PT(){return _.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:_.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function IT(){return _.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:_.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}function MT({size:t=80}){return _.jsx("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"currentColor",children:_.jsx("path",{d:"M85 35c-5-3-12-2-18 1-3-8-10-14-19-16 2-3 3-7 2-11-1-5-5-8-9-7s-7 5-6 10c0 2 1 4 2 5-10 3-18 11-21 21-8-1-16 2-21 8-2 2-1 5 1 6s5 0 7-2c3-4 8-5 13-4 0 12 7 23 18 28l-8 12c-2 2-1 5 1 7 2 1 5 1 6-2l10-14c3 1 6 1 9 1 4 0 7-1 10-2l10 14c2 2 5 3 7 1s2-5 0-7l-8-12c11-5 18-16 18-28 5-1 10 0 13 4 2 2 5 3 7 2s3-4 1-6c-5-6-13-9-21-8z"})})}const kT={starter_birds:"5 Common Backyard Birds",expanded_backyard:"Expanded Local Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers"};function BT(t){const e=[];return t.clip_selection==="canonical"?e.push("Signature sounds only"):t.clip_selection==="all"?e.push("Full repertoire"):typeof t.clip_selection=="number"&&e.push(`${t.clip_selection} variations per bird`),t.channel_mode==="offset"?e.push("both ears"):e.push("one ear"),e.join("  ")}function NT(t){const e=t.level_id;return e<=2?{label:"Easy",color:"#4CAF50"}:e<=4?{label:"Medium",color:"#FFC107"}:{label:"Hard",color:"#FF5722"}}function DT(){const t=kr(),[e]=Ox(),r=e.get("pack")||"starter_birds",[n,i]=T.useState([]),[s,o]=T.useState(!0);T.useEffect(()=>{fetch("/bird-sound-game/data/levels.json").then(u=>u.json()).then(u=>{const c=u.filter(h=>h.pack_id===r);i(c.sort((h,d)=>h.level_id-d.level_id)),o(!1)}).catch(u=>{console.error("Failed to load levels:",u),o(!1)})},[r]);const a=u=>{t(`/gameplay?mode=campaign&pack=${r}&level=${u.level_id}`)},l=kT[r]||r;return _.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[_.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"8px"},children:[_.jsx("button",{className:"btn-icon",onClick:()=>t("/pack-select"),"aria-label":"Back",children:_.jsx(FT,{})}),_.jsxs("div",{children:[_.jsx("h2",{style:{margin:0,fontSize:"20px"},children:l}),_.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:"Select a level"})]})]}),s?_.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--color-text-muted)"},children:"Loading levels..."}):_.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:n.map(u=>{const c=NT(u);return _.jsxs("button",{onClick:()=>a(u),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"var(--color-surface)",border:"none",borderRadius:"12px",cursor:"pointer",textAlign:"left",transition:"transform 0.15s, background 0.15s"},onMouseEnter:h=>{h.currentTarget.style.transform="translateX(4px)",h.currentTarget.style.background="rgba(45, 45, 68, 1)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateX(0)",h.currentTarget.style.background="var(--color-surface)"},children:[_.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:`linear-gradient(135deg, ${c.color}33, ${c.color}11)`,border:`2px solid ${c.color}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"20px",color:c.color,flexShrink:0},children:u.level_id}),_.jsxs("div",{style:{flex:1,minWidth:0},children:[_.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:u.title}),_.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:BT(u)})]}),_.jsx("div",{style:{color:"var(--color-text-muted)",flexShrink:0},children:_.jsx(OT,{})})]},u.level_id)})}),_.jsx("div",{style:{marginTop:"24px",padding:"12px 16px",background:"rgba(245, 166, 35, 0.1)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:_.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:[_.jsx("strong",{style:{color:"var(--color-accent)"},children:"Tip:"})," Start with Level 1 to learn each bird's signature sound, then progress to variations and both-ear challenges."]})})]})}function FT(){return _.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:_.jsx("path",{d:"M15 18l-6-6 6-6"})})}function OT(){return _.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:_.jsx("path",{d:"M9 18l6-6-6-6"})})}const LT={campaign:"Learn",practice:"Practice",challenge:"Challenge",random:"Random"};function UT({score:t,streak:e,timeRemaining:r,mode:n,levelId:i,levelTitle:s}){const o=Math.floor(r/60),a=r%60,l=`${o}:${a.toString().padStart(2,"0")}`;return _.jsxs("div",{className:"hud",children:[_.jsxs("div",{className:"hud-score",children:[_.jsx("span",{className:"hud-label",children:"Score"}),_.jsx("span",{className:"hud-value",children:t.toLocaleString()})]}),_.jsxs("div",{className:"hud-center",children:[n==="campaign"&&i?_.jsxs("span",{className:"hud-mode",children:["Level ",i,s?`: ${s}`:""]}):n?_.jsx("span",{className:"hud-mode",children:LT[n]||n}):null,_.jsx("div",{className:"hud-streak",children:e===0?_.jsx("span",{className:"streak-dot",children:""}):Array.from({length:e}).map((u,c)=>_.jsx("span",{className:"streak-dot active",children:""},c))})]}),_.jsxs("div",{className:"hud-timer",children:[_.jsx("span",{className:"hud-label",children:"Time"}),_.jsx("span",{className:"hud-value",children:l})]}),_.jsx("style",{children:`
        .hud {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          padding-top: calc(12px + var(--safe-area-top, 0px));
          background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.3) 100%);
          border-bottom: 1px solid var(--color-surface);
        }

        .hud-score, .hud-timer {
          display: flex;
          flex-direction: column;
          align-items: center;
          min-width: 80px;
        }

        .hud-label {
          font-size: 10px;
          text-transform: uppercase;
          color: var(--color-text-muted);
          letter-spacing: 0.5px;
        }

        .hud-value {
          font-family: var(--font-mono);
          font-size: 20px;
          font-weight: 600;
          color: var(--color-accent);
        }

        .hud-center {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 4px;
        }

        .hud-mode {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1px;
          color: var(--color-text-muted);
          padding: 2px 8px;
          border-radius: 4px;
          background: rgba(255, 255, 255, 0.1);
        }

        .hud-streak {
          display: flex;
          gap: 4px;
          font-size: 12px;
        }

        .streak-dot {
          color: var(--color-text-muted);
          transition: color 0.2s, transform 0.2s;
        }

        .streak-dot.active {
          color: var(--color-accent);
          transform: scale(1.2);
        }
      `})]})}const jT=T.memo(UT);var Ti=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(Ti||{}),Lx=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(Lx||{}),Ed=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Ed||{}),ee=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(ee||{}),Ar=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(Ar||{}),D=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(D||{}),ms=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(ms||{}),Z=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(Z||{}),G=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(G||{}),Hr=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(Hr||{}),Dn=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Dn||{}),Mr=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Mr||{}),bt=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(bt||{}),Sr=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Sr||{}),yp=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(yp||{}),Ht=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(Ht||{}),qe=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(qe||{}),We=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(We||{}),Pr=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(Pr||{});const GT={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},z={ADAPTER:GT,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Rc=/iPhone/i,mg=/iPod/i,gg=/iPad/i,yg=/\biOS-universal(?:.+)Mac\b/i,Pc=/\bAndroid(?:.+)Mobile\b/i,vg=/Android/i,Ni=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ka=/Silk/i,Dr=/Windows Phone/i,xg=/\bWindows(?:.+)ARM\b/i,_g=/BlackBerry/i,wg=/BB10/i,Eg=/Opera Mini/i,Sg=/\b(CriOS|Chrome)(?:.+)Mobile/i,Tg=/Mobile(?:.+)Firefox\b/i,bg=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function zT(t){return function(e){return e.test(t)}}function Ag(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,n=r.split("[FBAN");typeof n[1]<"u"&&(r=n[0]),n=r.split("Twitter"),typeof n[1]<"u"&&(r=n[0]);var i=zT(r),s={apple:{phone:i(Rc)&&!i(Dr),ipod:i(mg),tablet:!i(Rc)&&(i(gg)||bg(e))&&!i(Dr),universal:i(yg),device:(i(Rc)||i(mg)||i(gg)||i(yg)||bg(e))&&!i(Dr)},amazon:{phone:i(Ni),tablet:!i(Ni)&&i(ka),device:i(Ni)||i(ka)},android:{phone:!i(Dr)&&i(Ni)||!i(Dr)&&i(Pc),tablet:!i(Dr)&&!i(Ni)&&!i(Pc)&&(i(ka)||i(vg)),device:!i(Dr)&&(i(Ni)||i(ka)||i(Pc)||i(vg))||i(/\bokhttp\b/i)},windows:{phone:i(Dr),tablet:i(xg),device:i(Dr)||i(xg)},other:{blackberry:i(_g),blackberry10:i(wg),opera:i(Eg),firefox:i(Tg),chrome:i(Sg),device:i(_g)||i(wg)||i(Eg)||i(Tg)||i(Sg)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const HT=Ag.default??Ag,$r=HT(globalThis.navigator);z.RETINA_PREFIX=/@([0-9\.]+)x/;z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Ux={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new i(c,h||l,d),p=r?r+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=r?r+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,p=new Array(f);d<f;d++)p[d]=h[d].fn;return p},a.prototype.listenerCount=function(u){var c=r?r+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,d,f,p){var m=r?r+u:u;if(!this._events[m])return!1;var x=this._events[m],y=arguments.length,v,g;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),y){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,c),!0;case 3:return x.fn.call(x.context,c,h),!0;case 4:return x.fn.call(x.context,c,h,d),!0;case 5:return x.fn.call(x.context,c,h,d,f),!0;case 6:return x.fn.call(x.context,c,h,d,f,p),!0}for(g=1,v=new Array(y-1);g<y;g++)v[g-1]=arguments[g];x.fn.apply(x.context,v)}else{var w=x.length,S;for(g=0;g<w;g++)switch(x[g].once&&this.removeListener(u,x[g].fn,void 0,!0),y){case 1:x[g].fn.call(x[g].context);break;case 2:x[g].fn.call(x[g].context,c);break;case 3:x[g].fn.call(x[g].context,c,h);break;case 4:x[g].fn.call(x[g].context,c,h,d);break;default:if(!v)for(S=1,v=new Array(y-1);S<y;S++)v[S-1]=arguments[S];x[g].fn.apply(x[g].context,v)}}return!0},a.prototype.on=function(u,c,h){return s(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return s(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,d){var f=r?r+u:u;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!h||p.context===h)&&o(this,f);else{for(var m=0,x=[],y=p.length;m<y;m++)(p[m].fn!==c||d&&!p[m].once||h&&p[m].context!==h)&&x.push(p[m]);x.length?this._events[f]=x.length===1?x[0]:x:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=r?r+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(Ux);var $T=Ux.exports;const aa=xf($T);var vp={exports:{}};vp.exports=Ou;vp.exports.default=Ou;function Ou(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=jx(t,0,i,r,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,c,h,d,f;if(n&&(s=KT(t,e,s,r)),t.length>80*r){a=u=t[0],l=c=t[1];for(var p=r;p<i;p+=r)h=t[p],d=t[p+1],h<a&&(a=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);f=Math.max(u-a,c-l),f=f!==0?32767/f:0}return Ko(s,o,r,a,l,f,0),o}function jx(t,e,r,n,i){var s,o;if(i===bd(t,e,r,n)>0)for(s=e;s<r;s+=n)o=Cg(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=Cg(s,t[s],t[s+1],o);return o&&Lu(o,o.next)&&(Zo(o),o=o.next),o}function yi(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Lu(r,r.next)||Fe(r.prev,r,r.next)===0)){if(Zo(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function Ko(t,e,r,n,i,s,o){if(t){!o&&s&&eb(t,n,i,s);for(var a=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,s?VT(t,n,i,s):WT(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),Zo(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=XT(yi(t),e,r),Ko(t,e,r,n,i,s,2)):o===2&&YT(t,e,r,n,i,s):Ko(yi(t),e,r,n,i,s,1);break}}}}function WT(t){var e=t.prev,r=t,n=t.next;if(Fe(e,r,n)>=0)return!1;for(var i=e.x,s=r.x,o=n.x,a=e.y,l=r.y,u=n.y,c=i<s?i<o?i:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,d=i>s?i>o?i:o:s>o?s:o,f=a>l?a>u?a:u:l>u?l:u,p=n.next;p!==e;){if(p.x>=c&&p.x<=d&&p.y>=h&&p.y<=f&&as(i,a,s,l,o,u,p.x,p.y)&&Fe(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function VT(t,e,r,n){var i=t.prev,s=t,o=t.next;if(Fe(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,u=o.x,c=i.y,h=s.y,d=o.y,f=a<l?a<u?a:u:l<u?l:u,p=c<h?c<d?c:d:h<d?h:d,m=a>l?a>u?a:u:l>u?l:u,x=c>h?c>d?c:d:h>d?h:d,y=Sd(f,p,e,r,n),v=Sd(m,x,e,r,n),g=t.prevZ,w=t.nextZ;g&&g.z>=y&&w&&w.z<=v;){if(g.x>=f&&g.x<=m&&g.y>=p&&g.y<=x&&g!==i&&g!==o&&as(a,c,l,h,u,d,g.x,g.y)&&Fe(g.prev,g,g.next)>=0||(g=g.prevZ,w.x>=f&&w.x<=m&&w.y>=p&&w.y<=x&&w!==i&&w!==o&&as(a,c,l,h,u,d,w.x,w.y)&&Fe(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;g&&g.z>=y;){if(g.x>=f&&g.x<=m&&g.y>=p&&g.y<=x&&g!==i&&g!==o&&as(a,c,l,h,u,d,g.x,g.y)&&Fe(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;w&&w.z<=v;){if(w.x>=f&&w.x<=m&&w.y>=p&&w.y<=x&&w!==i&&w!==o&&as(a,c,l,h,u,d,w.x,w.y)&&Fe(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function XT(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!Lu(i,s)&&Gx(i,n,n.next,s)&&qo(i,s)&&qo(s,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(s.i/r|0),Zo(n),Zo(n.next),n=t=s),n=n.next}while(n!==t);return yi(n)}function YT(t,e,r,n,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&nb(o,a)){var l=zx(o,a);o=yi(o,o.next),l=yi(l,l.next),Ko(o,e,r,n,i,s,0),Ko(l,e,r,n,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function KT(t,e,r,n){var i=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:t.length,u=jx(t,a,l,n,!1),u===u.next&&(u.steiner=!0),i.push(rb(u));for(i.sort(qT),s=0;s<i.length;s++)r=ZT(i[s],r);return r}function qT(t,e){return t.x-e.x}function ZT(t,e){var r=QT(t,e);if(!r)return e;var n=zx(r,t);return yi(n,n.next),yi(r,r.next)}function QT(t,e){var r=e,n=t.x,i=t.y,s=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s&&(s=a,o=r.x<r.next.x?r:r.next,a===n))return o}r=r.next}while(r!==e);if(!o)return null;var l=o,u=o.x,c=o.y,h=1/0,d;r=o;do n>=r.x&&r.x>=u&&n!==r.x&&as(i<c?n:s,i,u,c,i<c?s:n,i,r.x,r.y)&&(d=Math.abs(i-r.y)/(n-r.x),qo(r,t)&&(d<h||d===h&&(r.x>o.x||r.x===o.x&&JT(o,r)))&&(o=r,h=d)),r=r.next;while(r!==l);return o}function JT(t,e){return Fe(t.prev,t,e.prev)<0&&Fe(e.next,t,t.next)<0}function eb(t,e,r,n){var i=t;do i.z===0&&(i.z=Sd(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,tb(i)}function tb(t){var e,r,n,i,s,o,a,l,u=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,n=r,a=0,e=0;e<u&&(a++,n=n.nextZ,!!n);e++);for(l=u;a>0||l>0&&n;)a!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n}s.nextZ=null,u*=2}while(o>1);return t}function Sd(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function rb(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function as(t,e,r,n,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(r-o)*(e-a)&&(r-o)*(s-a)>=(i-o)*(n-a)}function nb(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!ib(t,e)&&(qo(t,e)&&qo(e,t)&&sb(t,e)&&(Fe(t.prev,t,e.prev)||Fe(t,e.prev,e))||Lu(t,e)&&Fe(t.prev,t,t.next)>0&&Fe(e.prev,e,e.next)>0)}function Fe(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Lu(t,e){return t.x===e.x&&t.y===e.y}function Gx(t,e,r,n){var i=Na(Fe(t,e,r)),s=Na(Fe(t,e,n)),o=Na(Fe(r,n,t)),a=Na(Fe(r,n,e));return!!(i!==s&&o!==a||i===0&&Ba(t,r,e)||s===0&&Ba(t,n,e)||o===0&&Ba(r,t,n)||a===0&&Ba(r,e,n))}function Ba(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Na(t){return t>0?1:t<0?-1:0}function ib(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Gx(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function qo(t,e){return Fe(t.prev,t,t.next)<0?Fe(t,e,t.next)>=0&&Fe(t,t.prev,e)>=0:Fe(t,e,t.prev)<0||Fe(t,t.next,e)<0}function sb(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function zx(t,e){var r=new Td(t.i,t.x,t.y),n=new Td(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function Cg(t,e,r,n){var i=new Td(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Zo(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Td(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ou.deviation=function(t,e,r,n){var i=e&&e.length,s=i?e[0]*r:t.length,o=Math.abs(bd(t,0,s,r));if(i)for(var a=0,l=e.length;a<l;a++){var u=e[a]*r,c=a<l-1?e[a+1]*r:t.length;o-=Math.abs(bd(t,u,c,r))}var h=0;for(a=0;a<n.length;a+=3){var d=n[a]*r,f=n[a+1]*r,p=n[a+2]*r;h+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function bd(t,e,r,n){for(var i=0,s=e,o=r-n;s<r;s+=n)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}Ou.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[i][s][o]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var ob=vp.exports;const ab=xf(ob);var eu={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */eu.exports;(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof mo=="object"&&mo;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a=2147483647,l=36,u=1,c=26,h=38,d=700,f=72,p=128,m="-",x=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=l-u,S=Math.floor,C=String.fromCharCode,b;function E(P){throw new RangeError(g[P])}function R(P,k){for(var q=P.length,fe=[];q--;)fe[q]=k(P[q]);return fe}function M(P,k){var q=P.split("@"),fe="";q.length>1&&(fe=q[0]+"@",P=q[1]),P=P.replace(v,".");var ue=P.split("."),Ie=R(ue,k).join(".");return fe+Ie}function K(P){for(var k=[],q=0,fe=P.length,ue,Ie;q<fe;)ue=P.charCodeAt(q++),ue>=55296&&ue<=56319&&q<fe?(Ie=P.charCodeAt(q++),(Ie&64512)==56320?k.push(((ue&1023)<<10)+(Ie&1023)+65536):(k.push(ue),q--)):k.push(ue);return k}function O(P){return R(P,function(k){var q="";return k>65535&&(k-=65536,q+=C(k>>>10&1023|55296),k=56320|k&1023),q+=C(k),q}).join("")}function A(P){return P-48<10?P-22:P-65<26?P-65:P-97<26?P-97:l}function B(P,k){return P+22+75*(P<26)-((k!=0)<<5)}function H(P,k,q){var fe=0;for(P=q?S(P/d):P>>1,P+=S(P/k);P>w*c>>1;fe+=l)P=S(P/w);return S(fe+(w+1)*P/(P+h))}function J(P){var k=[],q=P.length,fe,ue=0,Ie=p,ve=f,xe,Je,Ye,Me,_e,be,ke,mt,wt;for(xe=P.lastIndexOf(m),xe<0&&(xe=0),Je=0;Je<xe;++Je)P.charCodeAt(Je)>=128&&E("not-basic"),k.push(P.charCodeAt(Je));for(Ye=xe>0?xe+1:0;Ye<q;){for(Me=ue,_e=1,be=l;Ye>=q&&E("invalid-input"),ke=A(P.charCodeAt(Ye++)),(ke>=l||ke>S((a-ue)/_e))&&E("overflow"),ue+=ke*_e,mt=be<=ve?u:be>=ve+c?c:be-ve,!(ke<mt);be+=l)wt=l-mt,_e>S(a/wt)&&E("overflow"),_e*=wt;fe=k.length+1,ve=H(ue-Me,fe,Me==0),S(ue/fe)>a-Ie&&E("overflow"),Ie+=S(ue/fe),ue%=fe,k.splice(ue++,0,Ie)}return O(k)}function $(P){var k,q,fe,ue,Ie,ve,xe,Je,Ye,Me,_e,be=[],ke,mt,wt,Nr;for(P=K(P),ke=P.length,k=p,q=0,Ie=f,ve=0;ve<ke;++ve)_e=P[ve],_e<128&&be.push(C(_e));for(fe=ue=be.length,ue&&be.push(m);fe<ke;){for(xe=a,ve=0;ve<ke;++ve)_e=P[ve],_e>=k&&_e<xe&&(xe=_e);for(mt=fe+1,xe-k>S((a-q)/mt)&&E("overflow"),q+=(xe-k)*mt,k=xe,ve=0;ve<ke;++ve)if(_e=P[ve],_e<k&&++q>a&&E("overflow"),_e==k){for(Je=q,Ye=l;Me=Ye<=Ie?u:Ye>=Ie+c?c:Ye-Ie,!(Je<Me);Ye+=l)Nr=Je-Me,wt=l-Me,be.push(C(B(Me+Nr%wt,0))),Je=S(Nr/wt);be.push(C(B(Je,0))),Ie=H(q,mt,fe==ue),q=0,++fe}++q,++k}return be.join("")}function I(P){return M(P,function(k){return x.test(k)?J(k.slice(4).toLowerCase()):k})}function j(P){return M(P,function(k){return y.test(k)?"xn--"+$(k):k})}if(o={version:"1.4.1",ucs2:{decode:K,encode:O},decode:J,encode:$,toASCII:j,toUnicode:I},n&&i)if(t.exports==n)i.exports=o;else for(b in o)o.hasOwnProperty(b)&&(n[b]=o[b]);else r.punycode=o})(mo)})(eu,eu.exports);var lb=eu.exports,Ls=TypeError;const ub={},cb=Object.freeze(Object.defineProperty({__proto__:null,default:ub},Symbol.toStringTag,{value:"Module"})),hb=U1(cb);var xp=typeof Map=="function"&&Map.prototype,Ic=Object.getOwnPropertyDescriptor&&xp?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,tu=xp&&Ic&&typeof Ic.get=="function"?Ic.get:null,Rg=xp&&Map.prototype.forEach,_p=typeof Set=="function"&&Set.prototype,Mc=Object.getOwnPropertyDescriptor&&_p?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ru=_p&&Mc&&typeof Mc.get=="function"?Mc.get:null,Pg=_p&&Set.prototype.forEach,db=typeof WeakMap=="function"&&WeakMap.prototype,bo=db?WeakMap.prototype.has:null,fb=typeof WeakSet=="function"&&WeakSet.prototype,Ao=fb?WeakSet.prototype.has:null,pb=typeof WeakRef=="function"&&WeakRef.prototype,Ig=pb?WeakRef.prototype.deref:null,mb=Boolean.prototype.valueOf,gb=Object.prototype.toString,yb=Function.prototype.toString,vb=String.prototype.match,wp=String.prototype.slice,Sn=String.prototype.replace,xb=String.prototype.toUpperCase,Mg=String.prototype.toLowerCase,Hx=RegExp.prototype.test,kg=Array.prototype.concat,Tr=Array.prototype.join,_b=Array.prototype.slice,Bg=Math.floor,Ad=typeof BigInt=="function"?BigInt.prototype.valueOf:null,kc=Object.getOwnPropertySymbols,Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Is=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Co=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Is||!0)?Symbol.toStringTag:null,$x=Object.prototype.propertyIsEnumerable,Ng=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Dg(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||Hx.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-Bg(-t):Bg(t);if(n!==t){var i=String(n),s=wp.call(e,i.length+1);return Sn.call(i,r,"$&_")+"."+Sn.call(Sn.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Sn.call(e,r,"$&_")}var Rd=hb,Fg=Rd.custom,Og=Xx(Fg)?Fg:null,Wx={__proto__:null,double:'"',single:"'"},wb={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},Uu=function t(e,r,n,i){var s=r||{};if(Ur(s,"quoteStyle")&&!Ur(Wx,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ur(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Ur(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ur(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ur(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return Kx(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?Dg(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return a?Dg(e,u):u}var c=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=c&&c>0&&typeof e=="object")return Pd(e)?"[Array]":"[Object]";var h=Ub(s,n);if(typeof i>"u")i=[];else if(Yx(i,e)>=0)return"[Circular]";function d(A,B,H){if(B&&(i=_b.call(i),i.push(B)),H){var J={depth:s.depth};return Ur(s,"quoteStyle")&&(J.quoteStyle=s.quoteStyle),t(A,J,n+1,i)}return t(A,s,n+1,i)}if(typeof e=="function"&&!Lg(e)){var f=Ib(e),p=Da(e,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+Tr.call(p,", ")+" }":"")}if(Xx(e)){var m=Is?Sn.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Cd.call(e);return typeof e=="object"&&!Is?Qs(m):m}if(Fb(e)){for(var x="<"+Mg.call(String(e.nodeName)),y=e.attributes||[],v=0;v<y.length;v++)x+=" "+y[v].name+"="+Vx(Eb(y[v].value),"double",s);return x+=">",e.childNodes&&e.childNodes.length&&(x+="..."),x+="</"+Mg.call(String(e.nodeName))+">",x}if(Pd(e)){if(e.length===0)return"[]";var g=Da(e,d);return h&&!Lb(g)?"["+Id(g,h)+"]":"[ "+Tr.call(g,", ")+" ]"}if(Tb(e)){var w=Da(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!$x.call(e,"cause")?"{ ["+String(e)+"] "+Tr.call(kg.call("[cause]: "+d(e.cause),w),", ")+" }":w.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Tr.call(w,", ")+" }"}if(typeof e=="object"&&o){if(Og&&typeof e[Og]=="function"&&Rd)return Rd(e,{depth:c-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Mb(e)){var S=[];return Rg&&Rg.call(e,function(A,B){S.push(d(B,e,!0)+" => "+d(A,e))}),Ug("Map",tu.call(e),S,h)}if(Nb(e)){var C=[];return Pg&&Pg.call(e,function(A){C.push(d(A,e))}),Ug("Set",ru.call(e),C,h)}if(kb(e))return Bc("WeakMap");if(Db(e))return Bc("WeakSet");if(Bb(e))return Bc("WeakRef");if(Ab(e))return Qs(d(Number(e)));if(Rb(e))return Qs(d(Ad.call(e)));if(Cb(e))return Qs(mb.call(e));if(bb(e))return Qs(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof mo<"u"&&e===mo)return"{ [object globalThis] }";if(!Sb(e)&&!Lg(e)){var b=Da(e,d),E=Ng?Ng(e)===Object.prototype:e instanceof Object||e.constructor===Object,R=e instanceof Object?"":"null prototype",M=!E&&Co&&Object(e)===e&&Co in e?wp.call(Hn(e),8,-1):R?"Object":"",K=E||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",O=K+(M||R?"["+Tr.call(kg.call([],M||[],R||[]),": ")+"] ":"");return b.length===0?O+"{}":h?O+"{"+Id(b,h)+"}":O+"{ "+Tr.call(b,", ")+" }"}return String(e)};function Vx(t,e,r){var n=r.quoteStyle||e,i=Wx[n];return i+t+i}function Eb(t){return Sn.call(String(t),/"/g,"&quot;")}function bi(t){return!Co||!(typeof t=="object"&&(Co in t||typeof t[Co]<"u"))}function Pd(t){return Hn(t)==="[object Array]"&&bi(t)}function Sb(t){return Hn(t)==="[object Date]"&&bi(t)}function Lg(t){return Hn(t)==="[object RegExp]"&&bi(t)}function Tb(t){return Hn(t)==="[object Error]"&&bi(t)}function bb(t){return Hn(t)==="[object String]"&&bi(t)}function Ab(t){return Hn(t)==="[object Number]"&&bi(t)}function Cb(t){return Hn(t)==="[object Boolean]"&&bi(t)}function Xx(t){if(Is)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Cd)return!1;try{return Cd.call(t),!0}catch{}return!1}function Rb(t){if(!t||typeof t!="object"||!Ad)return!1;try{return Ad.call(t),!0}catch{}return!1}var Pb=Object.prototype.hasOwnProperty||function(t){return t in this};function Ur(t,e){return Pb.call(t,e)}function Hn(t){return gb.call(t)}function Ib(t){if(t.name)return t.name;var e=vb.call(yb.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function Yx(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function Mb(t){if(!tu||!t||typeof t!="object")return!1;try{tu.call(t);try{ru.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function kb(t){if(!bo||!t||typeof t!="object")return!1;try{bo.call(t,bo);try{Ao.call(t,Ao)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function Bb(t){if(!Ig||!t||typeof t!="object")return!1;try{return Ig.call(t),!0}catch{}return!1}function Nb(t){if(!ru||!t||typeof t!="object")return!1;try{ru.call(t);try{tu.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function Db(t){if(!Ao||!t||typeof t!="object")return!1;try{Ao.call(t,Ao);try{bo.call(t,bo)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function Fb(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function Kx(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Kx(wp.call(t,0,e.maxStringLength),e)+n}var i=wb[e.quoteStyle||"single"];i.lastIndex=0;var s=Sn.call(Sn.call(t,i,"\\$1"),/[\x00-\x1f]/g,Ob);return Vx(s,"single",e)}function Ob(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+xb.call(e.toString(16))}function Qs(t){return"Object("+t+")"}function Bc(t){return t+" { ? }"}function Ug(t,e,r,n){var i=n?Id(r,n):Tr.call(r,", ");return t+" ("+e+") {"+i+"}"}function Lb(t){for(var e=0;e<t.length;e++)if(Yx(t[e],`
`)>=0)return!1;return!0}function Ub(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=Tr.call(Array(t.indent+1)," ");else return null;return{base:r,prev:Tr.call(Array(e+1),r)}}function Id(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+Tr.call(t,","+r)+`
`+e.prev}function Da(t,e){var r=Pd(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=Ur(t,i)?e(t[i],t):""}var s=typeof kc=="function"?kc(t):[],o;if(Is){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in t)Ur(t,l)&&(r&&String(Number(l))===l&&l<t.length||Is&&o["$"+l]instanceof Symbol||(Hx.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if(typeof kc=="function")for(var u=0;u<s.length;u++)$x.call(t,s[u])&&n.push("["+e(s[u])+"]: "+e(t[s[u]],t));return n}var jb=Uu,Gb=Ls,ju=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},zb=function(t,e){if(t){var r=ju(t,e);return r&&r.value}},Hb=function(t,e,r){var n=ju(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},$b=function(t,e){return t?!!ju(t,e):!1},Wb=function(t,e){if(t)return ju(t,e,!0)},Vb=function(){var e,r={assert:function(n){if(!r.has(n))throw new Gb("Side channel does not contain "+jb(n))},delete:function(n){var i=e&&e.next,s=Wb(e,n);return s&&i&&i===s&&(e=void 0),!!s},get:function(n){return zb(e,n)},has:function(n){return $b(e,n)},set:function(n,i){e||(e={next:void 0}),Hb(e,n,i)}};return r},qx=Object,Xb=Error,Yb=EvalError,Kb=RangeError,qb=ReferenceError,Zb=SyntaxError,Qb=URIError,Jb=Math.abs,eA=Math.floor,tA=Math.max,rA=Math.min,nA=Math.pow,iA=Math.round,sA=Number.isNaN||function(e){return e!==e},oA=sA,aA=function(e){return oA(e)||e===0?e:e<0?-1:1},lA=Object.getOwnPropertyDescriptor,yl=lA;if(yl)try{yl([],"length")}catch{yl=null}var Zx=yl,vl=Object.defineProperty||!1;if(vl)try{vl({},"a",{value:1})}catch{vl=!1}var uA=vl,Nc,jg;function cA(){return jg||(jg=1,Nc=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),Nc}var Dc,Gg;function hA(){if(Gg)return Dc;Gg=1;var t=typeof Symbol<"u"&&Symbol,e=cA();return Dc=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Dc}var Fc,zg;function Qx(){return zg||(zg=1,Fc=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Fc}var Oc,Hg;function Jx(){if(Hg)return Oc;Hg=1;var t=qx;return Oc=t.getPrototypeOf||null,Oc}var Lc,$g;function dA(){if($g)return Lc;$g=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,n="[object Function]",i=function(l,u){for(var c=[],h=0;h<l.length;h+=1)c[h]=l[h];for(var d=0;d<u.length;d+=1)c[d+l.length]=u[d];return c},s=function(l,u){for(var c=[],h=u,d=0;h<l.length;h+=1,d+=1)c[d]=l[h];return c},o=function(a,l){for(var u="",c=0;c<a.length;c+=1)u+=a[c],c+1<a.length&&(u+=l);return u};return Lc=function(l){var u=this;if(typeof u!="function"||e.apply(u)!==n)throw new TypeError(t+u);for(var c=s(arguments,1),h,d=function(){if(this instanceof h){var y=u.apply(this,i(c,arguments));return Object(y)===y?y:this}return u.apply(l,i(c,arguments))},f=r(0,u.length-c.length),p=[],m=0;m<f;m++)p[m]="$"+m;if(h=Function("binder","return function ("+o(p,",")+"){ return binder.apply(this,arguments); }")(d),u.prototype){var x=function(){};x.prototype=u.prototype,h.prototype=new x,x.prototype=null}return h},Lc}var Uc,Wg;function Gu(){if(Wg)return Uc;Wg=1;var t=dA();return Uc=Function.prototype.bind||t,Uc}var jc,Vg;function Ep(){return Vg||(Vg=1,jc=Function.prototype.call),jc}var Gc,Xg;function e_(){return Xg||(Xg=1,Gc=Function.prototype.apply),Gc}var fA=typeof Reflect<"u"&&Reflect&&Reflect.apply,pA=Gu(),mA=e_(),gA=Ep(),yA=fA,vA=yA||pA.call(gA,mA),xA=Gu(),_A=Ls,wA=Ep(),EA=vA,t_=function(e){if(e.length<1||typeof e[0]!="function")throw new _A("a function is required");return EA(xA,wA,e)},zc,Yg;function SA(){if(Yg)return zc;Yg=1;var t=t_,e=Zx,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return zc=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,zc}var Hc,Kg;function TA(){if(Kg)return Hc;Kg=1;var t=Qx(),e=Jx(),r=SA();return Hc=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,Hc}var $c,qg;function bA(){if(qg)return $c;qg=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=Gu();return $c=r.call(t,e),$c}var ce,AA=qx,CA=Xb,RA=Yb,PA=Kb,IA=qb,Ms=Zb,gs=Ls,MA=Qb,kA=Jb,BA=eA,NA=tA,DA=rA,FA=nA,OA=iA,LA=aA,r_=Function,Wc=function(t){try{return r_('"use strict"; return ('+t+").constructor;")()}catch{}},Qo=Zx,UA=uA,Vc=function(){throw new gs},jA=Qo?function(){try{return arguments.callee,Vc}catch{try{return Qo(arguments,"callee").get}catch{return Vc}}}():Vc,Di=hA()(),et=TA(),GA=Jx(),zA=Qx(),n_=e_(),la=Ep(),zi={},HA=typeof Uint8Array>"u"||!et?ce:et(Uint8Array),ui={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?ce:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ce:ArrayBuffer,"%ArrayIteratorPrototype%":Di&&et?et([][Symbol.iterator]()):ce,"%AsyncFromSyncIteratorPrototype%":ce,"%AsyncFunction%":zi,"%AsyncGenerator%":zi,"%AsyncGeneratorFunction%":zi,"%AsyncIteratorPrototype%":zi,"%Atomics%":typeof Atomics>"u"?ce:Atomics,"%BigInt%":typeof BigInt>"u"?ce:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ce:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ce:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ce:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":CA,"%eval%":eval,"%EvalError%":RA,"%Float16Array%":typeof Float16Array>"u"?ce:Float16Array,"%Float32Array%":typeof Float32Array>"u"?ce:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ce:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ce:FinalizationRegistry,"%Function%":r_,"%GeneratorFunction%":zi,"%Int8Array%":typeof Int8Array>"u"?ce:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ce:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ce:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Di&&et?et(et([][Symbol.iterator]())):ce,"%JSON%":typeof JSON=="object"?JSON:ce,"%Map%":typeof Map>"u"?ce:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Di||!et?ce:et(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":AA,"%Object.getOwnPropertyDescriptor%":Qo,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ce:Promise,"%Proxy%":typeof Proxy>"u"?ce:Proxy,"%RangeError%":PA,"%ReferenceError%":IA,"%Reflect%":typeof Reflect>"u"?ce:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ce:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Di||!et?ce:et(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ce:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Di&&et?et(""[Symbol.iterator]()):ce,"%Symbol%":Di?Symbol:ce,"%SyntaxError%":Ms,"%ThrowTypeError%":jA,"%TypedArray%":HA,"%TypeError%":gs,"%Uint8Array%":typeof Uint8Array>"u"?ce:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ce:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ce:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ce:Uint32Array,"%URIError%":MA,"%WeakMap%":typeof WeakMap>"u"?ce:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ce:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ce:WeakSet,"%Function.prototype.call%":la,"%Function.prototype.apply%":n_,"%Object.defineProperty%":UA,"%Object.getPrototypeOf%":GA,"%Math.abs%":kA,"%Math.floor%":BA,"%Math.max%":NA,"%Math.min%":DA,"%Math.pow%":FA,"%Math.round%":OA,"%Math.sign%":LA,"%Reflect.getPrototypeOf%":zA};if(et)try{null.error}catch(t){var $A=et(et(t));ui["%Error.prototype%"]=$A}var WA=function t(e){var r;if(e==="%AsyncFunction%")r=Wc("async function () {}");else if(e==="%GeneratorFunction%")r=Wc("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Wc("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&et&&(r=et(i.prototype))}return ui[e]=r,r},Zg={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ua=Gu(),nu=bA(),VA=ua.call(la,Array.prototype.concat),XA=ua.call(n_,Array.prototype.splice),Qg=ua.call(la,String.prototype.replace),iu=ua.call(la,String.prototype.slice),YA=ua.call(la,RegExp.prototype.exec),KA=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,qA=/\\(\\)?/g,ZA=function(e){var r=iu(e,0,1),n=iu(e,-1);if(r==="%"&&n!=="%")throw new Ms("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Ms("invalid intrinsic syntax, expected opening `%`");var i=[];return Qg(e,KA,function(s,o,a,l){i[i.length]=a?Qg(l,qA,"$1"):o||s}),i},QA=function(e,r){var n=e,i;if(nu(Zg,n)&&(i=Zg[n],n="%"+i[0]+"%"),nu(ui,n)){var s=ui[n];if(s===zi&&(s=WA(n)),typeof s>"u"&&!r)throw new gs("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Ms("intrinsic "+e+" does not exist!")},Sp=function(e,r){if(typeof e!="string"||e.length===0)throw new gs("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new gs('"allowMissing" argument must be a boolean');if(YA(/^%?[^%]*%?$/,e)===null)throw new Ms("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=ZA(e),i=n.length>0?n[0]:"",s=QA("%"+i+"%",r),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],XA(n,VA([0,1],u)));for(var c=1,h=!0;c<n.length;c+=1){var d=n[c],f=iu(d,0,1),p=iu(d,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new Ms("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(l=!0),i+="."+d,o="%"+i+"%",nu(ui,o))a=ui[o];else if(a!=null){if(!(d in a)){if(!r)throw new gs("base intrinsic for "+e+" exists, but the property is not available.");return}if(Qo&&c+1>=n.length){var m=Qo(a,d);h=!!m,h&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else h=nu(a,d),a=a[d];h&&!l&&(ui[o]=a)}}return a},i_=Sp,s_=t_,JA=s_([i_("%String.prototype.indexOf%")]),o_=function(e,r){var n=i_(e,!!r);return typeof n=="function"&&JA(e,".prototype.")>-1?s_([n]):n},eC=Sp,ca=o_,tC=Uu,rC=Ls,Jg=eC("%Map%",!0),nC=ca("Map.prototype.get",!0),iC=ca("Map.prototype.set",!0),sC=ca("Map.prototype.has",!0),oC=ca("Map.prototype.delete",!0),aC=ca("Map.prototype.size",!0),a_=!!Jg&&function(){var e,r={assert:function(n){if(!r.has(n))throw new rC("Side channel does not contain "+tC(n))},delete:function(n){if(e){var i=oC(e,n);return aC(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return nC(e,n)},has:function(n){return e?sC(e,n):!1},set:function(n,i){e||(e=new Jg),iC(e,n,i)}};return r},lC=Sp,zu=o_,uC=Uu,Fa=a_,cC=Ls,Fi=lC("%WeakMap%",!0),hC=zu("WeakMap.prototype.get",!0),dC=zu("WeakMap.prototype.set",!0),fC=zu("WeakMap.prototype.has",!0),pC=zu("WeakMap.prototype.delete",!0),mC=Fi?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new cC("Side channel does not contain "+uC(i))},delete:function(i){if(Fi&&i&&(typeof i=="object"||typeof i=="function")){if(e)return pC(e,i)}else if(Fa&&r)return r.delete(i);return!1},get:function(i){return Fi&&i&&(typeof i=="object"||typeof i=="function")&&e?hC(e,i):r&&r.get(i)},has:function(i){return Fi&&i&&(typeof i=="object"||typeof i=="function")&&e?fC(e,i):!!r&&r.has(i)},set:function(i,s){Fi&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new Fi),dC(e,i,s)):Fa&&(r||(r=Fa()),r.set(i,s))}};return n}:Fa,gC=Ls,yC=Uu,vC=Vb,xC=a_,_C=mC,wC=_C||xC||vC,l_=function(){var e,r={assert:function(n){if(!r.has(n))throw new gC("Side channel does not contain "+yC(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=wC()),e.set(n,i)}};return r},EC=String.prototype.replace,SC=/%20/g,Xc={RFC1738:"RFC1738",RFC3986:"RFC3986"},Tp={default:Xc.RFC3986,formatters:{RFC1738:function(t){return EC.call(t,SC,"+")},RFC3986:function(t){return String(t)}},RFC1738:Xc.RFC1738,RFC3986:Xc.RFC3986},TC=Tp,bC=l_,Yc=Object.prototype.hasOwnProperty,ri=Array.isArray,Hu=bC(),u_=function(e,r){return Hu.set(e,r),e},su=function(e){return Hu.has(e)},Md=function(e){return Hu.get(e)},c_=function(e,r){Hu.set(e,r)},mr=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),AC=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(ri(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]<"u"&&i.push(n[s]);r.obj[r.prop]=i}}},bp=function(e,r){for(var n=r&&r.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},CC=function t(e,r,n){if(!r)return e;if(typeof r!="object"&&typeof r!="function"){if(ri(e))e.push(r);else if(e&&typeof e=="object")if(su(e)){var i=Md(e)+1;e[i]=r,c_(e,i)}else(n&&(n.plainObjects||n.allowPrototypes)||!Yc.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object"){if(su(r)){for(var s=Object.keys(r),o=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},a=0;a<s.length;a++){var l=parseInt(s[a],10);o[l+1]=r[s[a]]}return u_(o,Md(r)+1)}return[e].concat(r)}var u=e;return ri(e)&&!ri(r)&&(u=bp(e,n)),ri(e)&&ri(r)?(r.forEach(function(c,h){if(Yc.call(e,h)){var d=e[h];d&&typeof d=="object"&&c&&typeof c=="object"?e[h]=t(d,c,n):e.push(c)}else e[h]=c}),e):Object.keys(r).reduce(function(c,h){var d=r[h];return Yc.call(c,h)?c[h]=t(c[h],d,n):c[h]=d,c},u)},RC=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},PC=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},Kc=1024,IC=function(e,r,n,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;l+=Kc){for(var u=o.length>=Kc?o.slice(l,l+Kc):o,c=[],h=0;h<u.length;++h){var d=u.charCodeAt(h);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===TC.RFC1738&&(d===40||d===41)){c[c.length]=u.charAt(h);continue}if(d<128){c[c.length]=mr[d];continue}if(d<2048){c[c.length]=mr[192|d>>6]+mr[128|d&63];continue}if(d<55296||d>=57344){c[c.length]=mr[224|d>>12]+mr[128|d>>6&63]+mr[128|d&63];continue}h+=1,d=65536+((d&1023)<<10|u.charCodeAt(h)&1023),c[c.length]=mr[240|d>>18]+mr[128|d>>12&63]+mr[128|d>>6&63]+mr[128|d&63]}a+=c.join("")}return a},MC=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var u=a[l],c=o[u];typeof c=="object"&&c!==null&&n.indexOf(c)===-1&&(r.push({obj:o,prop:u}),n.push(c))}return AC(r),e},kC=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},BC=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},NC=function(e,r,n,i){if(su(e)){var s=Md(e)+1;return e[s]=r,c_(e,s),e}var o=[].concat(e,r);return o.length>n?u_(bp(o,{plainObjects:i}),o.length-1):o},DC=function(e,r){if(ri(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},h_={arrayToObject:bp,assign:RC,combine:NC,compact:MC,decode:PC,encode:IC,isBuffer:BC,isOverflow:su,isRegExp:kC,maybeMap:DC,merge:CC},d_=l_,xl=h_,Ro=Tp,FC=Object.prototype.hasOwnProperty,f_={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Er=Array.isArray,OC=Array.prototype.push,p_=function(t,e){OC.apply(t,Er(e)?e:[e])},LC=Date.prototype.toISOString,ey=Ro.default,Ke={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:xl.encode,encodeValuesOnly:!1,filter:void 0,format:ey,formatter:Ro.formatters[ey],indices:!1,serializeDate:function(e){return LC.call(e)},skipNulls:!1,strictNullHandling:!1},UC=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},qc={},jC=function t(e,r,n,i,s,o,a,l,u,c,h,d,f,p,m,x,y,v){for(var g=e,w=v,S=0,C=!1;(w=w.get(qc))!==void 0&&!C;){var b=w.get(e);if(S+=1,typeof b<"u"){if(b===S)throw new RangeError("Cyclic object value");C=!0}typeof w.get(qc)>"u"&&(S=0)}if(typeof c=="function"?g=c(r,g):g instanceof Date?g=f(g):n==="comma"&&Er(g)&&(g=xl.maybeMap(g,function(P){return P instanceof Date?f(P):P})),g===null){if(o)return u&&!x?u(r,Ke.encoder,y,"key",p):r;g=""}if(UC(g)||xl.isBuffer(g)){if(u){var E=x?r:u(r,Ke.encoder,y,"key",p);return[m(E)+"="+m(u(g,Ke.encoder,y,"value",p))]}return[m(r)+"="+m(String(g))]}var R=[];if(typeof g>"u")return R;var M;if(n==="comma"&&Er(g))x&&u&&(g=xl.maybeMap(g,u)),M=[{value:g.length>0?g.join(",")||null:void 0}];else if(Er(c))M=c;else{var K=Object.keys(g);M=h?K.sort(h):K}var O=l?String(r).replace(/\./g,"%2E"):String(r),A=i&&Er(g)&&g.length===1?O+"[]":O;if(s&&Er(g)&&g.length===0)return A+"[]";for(var B=0;B<M.length;++B){var H=M[B],J=typeof H=="object"&&H&&typeof H.value<"u"?H.value:g[H];if(!(a&&J===null)){var $=d&&l?String(H).replace(/\./g,"%2E"):String(H),I=Er(g)?typeof n=="function"?n(A,$):A:A+(d?"."+$:"["+$+"]");v.set(e,S);var j=d_();j.set(qc,v),p_(R,t(J,I,n,i,s,o,a,l,n==="comma"&&x&&Er(g)?null:u,c,h,d,f,p,m,x,y,j))}}return R},GC=function(e){if(!e)return Ke;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||Ke.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Ro.default;if(typeof e.format<"u"){if(!FC.call(Ro.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=Ro.formatters[n],s=Ke.filter;(typeof e.filter=="function"||Er(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in f_?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=Ke.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Ke.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ke.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ke.allowEmptyArrays,arrayFormat:o,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ke.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Ke.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ke.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Ke.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Ke.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ke.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ke.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ke.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ke.strictNullHandling}},zC=function(t,e){var r=t,n=GC(e),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):Er(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var a=f_[n.arrayFormat],l=a==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var u=d_(),c=0;c<i.length;++c){var h=i[c],d=r[h];n.skipNulls&&d===null||p_(o,jC(d,h,a,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var f=o.join(n.delimiter),p=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""},Ln=h_,_l=Object.prototype.hasOwnProperty,ty=Array.isArray,je={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Ln.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},HC=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},m_=function(t,e,r){if(t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&r>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return t},$C="utf8=%26%2310003%3B",WC="utf8=%E2%9C%93",VC=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,r.throwOnLimitExceeded?s+1:s);if(r.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,l,u=r.charset;if(r.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===WC?u="utf-8":o[l]===$C&&(u="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var c=o[l],h=c.indexOf("]="),d=h===-1?c.indexOf("="):h+1,f,p;if(d===-1?(f=r.decoder(c,je.decoder,u,"key"),p=r.strictNullHandling?null:""):(f=r.decoder(c.slice(0,d),je.decoder,u,"key"),f!==null&&(p=Ln.maybeMap(m_(c.slice(d+1),r,ty(n[f])?n[f].length:0),function(x){return r.decoder(x,je.decoder,u,"value")}))),p&&r.interpretNumericEntities&&u==="iso-8859-1"&&(p=HC(String(p))),c.indexOf("[]=")>-1&&(p=ty(p)?[p]:p),f!==null){var m=_l.call(n,f);m&&r.duplicates==="combine"?n[f]=Ln.combine(n[f],p,r.arrayLimit,r.plainObjects):(!m||r.duplicates==="last")&&(n[f]=p)}}return n},XC=function(t,e,r,n){var i=0;if(t.length>0&&t[t.length-1]==="[]"){var s=t.slice(0,-1).join("");i=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=n?e:m_(e,r,i),a=t.length-1;a>=0;--a){var l,u=t[a];if(u==="[]"&&r.parseArrays)Ln.isOverflow(o)?l=o:l=r.allowEmptyArrays&&(o===""||r.strictNullHandling&&o===null)?[]:Ln.combine([],o,r.arrayLimit,r.plainObjects);else{l=r.plainObjects?{__proto__:null}:{};var c=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,h=r.decodeDotInKeys?c.replace(/%2E/g,"."):c,d=parseInt(h,10);!r.parseArrays&&h===""?l={0:o}:!isNaN(d)&&u!==h&&String(d)===h&&d>=0&&r.parseArrays&&d<=r.arrayLimit?(l=[],l[d]=o):h!=="__proto__"&&(l[h]=o)}o=l}return o},YC=function(e,r){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e;if(r.depth<=0)return!r.plainObjects&&_l.call(Object.prototype,n)&&!r.allowPrototypes?void 0:[n];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(n),a=o?n.slice(0,o.index):n,l=[];if(a){if(!r.plainObjects&&_l.call(Object.prototype,a)&&!r.allowPrototypes)return;l.push(a)}for(var u=0;(o=s.exec(n))!==null&&u<r.depth;){u+=1;var c=o[1].slice(1,-1);if(!r.plainObjects&&_l.call(Object.prototype,c)&&!r.allowPrototypes)return;l.push(o[1])}if(o){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");l.push("["+n.slice(o.index)+"]")}return l},KC=function(e,r,n,i){if(e){var s=YC(e,n);if(s)return XC(s,r,n,i)}},qC=function(e){if(!e)return je;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=typeof e.charset>"u"?je.charset:e.charset,n=typeof e.duplicates>"u"?je.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:je.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:je.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:je.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:je.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:je.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:je.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:je.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:je.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:je.decoder,delimiter:typeof e.delimiter=="string"||Ln.isRegExp(e.delimiter)?e.delimiter:je.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:je.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:je.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:je.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:je.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:je.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:je.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},ZC=function(t,e){var r=qC(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?{__proto__:null}:{};for(var n=typeof t=="string"?VC(t,r):t,i=r.plainObjects?{__proto__:null}:{},s=Object.keys(n),o=0;o<s.length;++o){var a=s[o],l=KC(a,n[a],r,typeof t=="string");i=Ln.merge(i,l,r)}return r.allowSparse===!0?i:Ln.compact(i)},QC=zC,JC=ZC,eR=Tp,tR={formats:eR,parse:JC,stringify:QC},rR=lb;function Yr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var nR=/^([a-z0-9.+-]+:)/i,iR=/:[0-9]*$/,sR=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,oR=["<",">",'"',"`"," ","\r",`
`,"	"],aR=["{","}","|","\\","^","`"].concat(oR),kd=["'"].concat(aR),ry=["%","/","?",";","#"].concat(kd),ny=["/","?","#"],lR=255,iy=/^[+a-z0-9A-Z_-]{0,63}$/,uR=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,cR={javascript:!0,"javascript:":!0},Bd={javascript:!0,"javascript:":!0},ys={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Nd=tR;function hR(t,e,r){if(t&&typeof t=="object"&&t instanceof Yr)return t;var n=new Yr;return n.parse(t,e,r),n}Yr.prototype.parse=function(t,e,r){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var a=t;if(a=a.trim(),!r&&t.split("#").length===1){var l=sR.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=Nd.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=nR.exec(a);if(u){u=u[0];var c=u.toLowerCase();this.protocol=c,a=a.substr(u.length)}if(r||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var h=a.substr(0,2)==="//";h&&!(u&&Bd[u])&&(a=a.substr(2),this.slashes=!0)}if(!Bd[u]&&(h||u&&!ys[u])){for(var d=-1,f=0;f<ny.length;f++){var p=a.indexOf(ny[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var m,x;d===-1?x=a.lastIndexOf("@"):x=a.lastIndexOf("@",d),x!==-1&&(m=a.slice(0,x),a=a.slice(x+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<ry.length;f++){var p=a.indexOf(ry[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var v=this.hostname.split(/\./),f=0,g=v.length;f<g;f++){var w=v[f];if(w&&!w.match(iy)){for(var S="",C=0,b=w.length;C<b;C++)w.charCodeAt(C)>127?S+="x":S+=w[C];if(!S.match(iy)){var E=v.slice(0,f),R=v.slice(f+1),M=w.match(uR);M&&(E.push(M[1]),R.unshift(M[2])),R.length&&(a="/"+R.join(".")+a),this.hostname=E.join(".");break}}}this.hostname.length>lR?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=rR.toASCII(this.hostname));var K=this.port?":"+this.port:"",O=this.hostname||"";this.host=O+K,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!cR[c])for(var f=0,g=kd.length;f<g;f++){var A=kd[f];if(a.indexOf(A)!==-1){var B=encodeURIComponent(A);B===A&&(B=escape(A)),a=a.split(A).join(B)}}var H=a.indexOf("#");H!==-1&&(this.hash=a.substr(H),a=a.slice(0,H));var J=a.indexOf("?");if(J!==-1?(this.search=a.substr(J),this.query=a.substr(J+1),e&&(this.query=Nd.parse(this.query)),a=a.slice(0,J)):e&&(this.search="",this.query={}),a&&(this.pathname=a),ys[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var K=this.pathname||"",$=this.search||"";this.path=K+$}return this.href=this.format(),this};Yr.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Nd.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||ys[e])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+r+o+n};Yr.prototype.resolve=function(t){return this.resolveObject(hR(t,!1,!0)).format()};Yr.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new Yr;e.parse(t,!1,!0),t=e}for(var r=new Yr,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(r[l]=t[l])}return ys[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!ys[t.protocol]){for(var u=Object.keys(t),c=0;c<u.length;c++){var h=u[c];r[h]=t[h]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!Bd[t.protocol]){for(var g=(t.pathname||"").split("/");g.length&&!(t.host=g.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),r.pathname=g.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var d=r.pathname||"",f=r.search||"";r.path=d+f}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var p=r.pathname&&r.pathname.charAt(0)==="/",m=t.host||t.pathname&&t.pathname.charAt(0)==="/",x=m||p||r.host&&t.pathname,y=x,v=r.pathname&&r.pathname.split("/")||[],g=t.pathname&&t.pathname.split("/")||[],w=r.protocol&&!ys[r.protocol];if(w&&(r.hostname="",r.port=null,r.host&&(v[0]===""?v[0]=r.host:v.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(g[0]===""?g[0]=t.host:g.unshift(t.host)),t.host=null),x=x&&(g[0]===""||v[0]==="")),m)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,v=g;else if(g.length)v||(v=[]),v.pop(),v=v.concat(g),r.search=t.search,r.query=t.query;else if(t.search!=null){if(w){r.host=v.shift(),r.hostname=r.host;var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return r.search=t.search,r.query=t.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!v.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var C=v.slice(-1)[0],b=(r.host||t.host||v.length>1)&&(C==="."||C==="..")||C==="",E=0,R=v.length;R>=0;R--)C=v[R],C==="."?v.splice(R,1):C===".."?(v.splice(R,1),E++):E&&(v.splice(R,1),E--);if(!x&&!y)for(;E--;E)v.unshift("..");x&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),b&&v.join("/").substr(-1)!=="/"&&v.push("");var M=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(w){r.hostname=M?"":v.length?v.shift():"",r.host=r.hostname;var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return x=x||r.host&&v.length,x&&!M&&v.unshift(""),v.length>0?r.pathname=v.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};Yr.prototype.parseHost=function(){var t=this.host,e=iR.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const sy={};function he(t,e,r=3){if(sy[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),sy[e]=!0}function Qt(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Js(t){return t.split("?")[0].split("#")[0]}function dR(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function fR(t,e,r){return t.replace(new RegExp(dR(e),"g"),r)}function pR(t,e){let r="",n=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),i=a,s=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=a,s=0;continue}}}else r.length>0?r+=`/${t.slice(i+1,a)}`:r=t.slice(i+1,a),n=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return r}const it={toPosix(t){return fR(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Qt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(Qt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=Js(this.toPosix(e??z.ADAPTER.getBaseUrl())),i=Js(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?it.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(Qt(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=pR(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return Qt(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(Qt(n),n.length>0)if(e===void 0)e=n;else{const i=t[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Qt(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){n=a;break}}else i=!1;return n===-1?r?"/":this.isUrl(o)?s+t:s:r&&n===1?"//":s+t.slice(0,n)},rootname(t){Qt(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Qt(t),e&&Qt(e),t=Js(this.toPosix(t));let r=0,n=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const l=t.charCodeAt(s);if(l===47){if(!i){r=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return r===n?n=a:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){r=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){Qt(t),t=Js(this.toPosix(t));let e=-1,r=0,n=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){r=o+1;break}continue}n===-1&&(i=!1,n=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){Qt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=Js(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let i;e.root=this.rootname(t),n||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,a=-1,l=!0,u=t.length-1,c=0;for(;u>=i;--u){if(r=t.charCodeAt(u),r===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),r===46?s===-1?s=u:c!==1&&(c=1):s!==-1&&(c=-1)}return s===-1||a===-1||c===0||c===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&n?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&n?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let Zc;async function mR(){return Zc??(Zc=(async()=>{var s;const t=document.createElement("canvas").getContext("webgl");if(!t)return bt.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return bt.UNPACK;const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(s=t.getExtension("WEBGL_lose_context"))==null||s.loseContext(),i[0]<=i[3]?bt.PMA:bt.UNPACK})()),Zc}let Qc;function gR(){return typeof Qc>"u"&&(Qc=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!z.ADAPTER.getWebGLRenderingContext())return!1;const r=z.ADAPTER.createCanvas();let n=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,i}catch{return!1}}()),Qc}var yR={grad:.9,turn:360,rad:360/(2*Math.PI)},Fr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},rt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},$t=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},g_=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},oy=function(t){return{r:$t(t.r,0,255),g:$t(t.g,0,255),b:$t(t.b,0,255),a:$t(t.a)}},Jc=function(t){return{r:rt(t.r),g:rt(t.g),b:rt(t.b),a:rt(t.a,3)}},vR=/^#([0-9a-f]{3,8})$/i,Oa=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},y_=function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=Math.max(e,r,n),o=s-Math.min(e,r,n),a=o?s===e?(r-n)/o:s===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},v_=function(t){var e=t.h,r=t.s,n=t.v,i=t.a;e=e/360*6,r/=100,n/=100;var s=Math.floor(e),o=n*(1-r),a=n*(1-(e-s)*r),l=n*(1-(1-e+s)*r),u=s%6;return{r:255*[n,a,o,o,l,n][u],g:255*[l,n,n,a,o,o][u],b:255*[o,o,l,n,n,a][u],a:i}},ay=function(t){return{h:g_(t.h),s:$t(t.s,0,100),l:$t(t.l,0,100),a:$t(t.a)}},ly=function(t){return{h:rt(t.h),s:rt(t.s),l:rt(t.l),a:rt(t.a,3)}},uy=function(t){return v_((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},Po=function(t){return{h:(e=y_(t)).h,s:(i=(200-(r=e.s))*(n=e.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,r,n,i},xR=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_R=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,wR=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ER=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Dd={string:[[function(t){var e=vR.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?rt(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?rt(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=wR.exec(t)||ER.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:oy({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=xR.exec(t)||_R.exec(t);if(!e)return null;var r,n,i=ay({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(yR[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return uy(i)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=i===void 0?1:i;return Fr(e)&&Fr(r)&&Fr(n)?oy({r:Number(e),g:Number(r),b:Number(n),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,i=t.a,s=i===void 0?1:i;if(!Fr(e)||!Fr(r)||!Fr(n))return null;var o=ay({h:Number(e),s:Number(r),l:Number(n),a:Number(s)});return uy(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,i=t.a,s=i===void 0?1:i;if(!Fr(e)||!Fr(r)||!Fr(n))return null;var o=function(a){return{h:g_(a.h),s:$t(a.s,0,100),v:$t(a.v,0,100),a:$t(a.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(s)});return v_(o)},"hsv"]]},cy=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},SR=function(t){return typeof t=="string"?cy(t.trim(),Dd.string):typeof t=="object"&&t!==null?cy(t,Dd.object):[null,void 0]},eh=function(t,e){var r=Po(t);return{h:r.h,s:$t(r.s+100*e,0,100),l:r.l,a:r.a}},th=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},hy=function(t,e){var r=Po(t);return{h:r.h,s:r.s,l:$t(r.l+100*e,0,100),a:r.a}},Fd=function(){function t(e){this.parsed=SR(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return rt(th(this.rgba),2)},t.prototype.isDark=function(){return th(this.rgba)<.5},t.prototype.isLight=function(){return th(this.rgba)>=.5},t.prototype.toHex=function(){return e=Jc(this.rgba),r=e.r,n=e.g,i=e.b,o=(s=e.a)<1?Oa(rt(255*s)):"","#"+Oa(r)+Oa(n)+Oa(i)+o;var e,r,n,i,s,o},t.prototype.toRgb=function(){return Jc(this.rgba)},t.prototype.toRgbString=function(){return e=Jc(this.rgba),r=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+r+", "+n+", "+i+", "+s+")":"rgb("+r+", "+n+", "+i+")";var e,r,n,i,s},t.prototype.toHsl=function(){return ly(Po(this.rgba))},t.prototype.toHslString=function(){return e=ly(Po(this.rgba)),r=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+r+", "+n+"%, "+i+"%, "+s+")":"hsl("+r+", "+n+"%, "+i+"%)";var e,r,n,i,s},t.prototype.toHsv=function(){return e=y_(this.rgba),{h:rt(e.h),s:rt(e.s),v:rt(e.v),a:rt(e.a,3)};var e},t.prototype.invert=function(){return gr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),gr(eh(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),gr(eh(this.rgba,-e))},t.prototype.grayscale=function(){return gr(eh(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),gr(hy(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),gr(hy(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?gr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):rt(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=Po(this.rgba);return typeof e=="number"?gr({h:e,s:r.s,l:r.l,a:r.a}):rt(r.h)},t.prototype.isEqual=function(e){return this.toHex()===gr(e).toHex()},t}(),gr=function(t){return t instanceof Fd?t:new Fd(t)},dy=[],TR=function(t){t.forEach(function(e){dy.indexOf(e)<0&&(e(Fd,Dd),dy.push(e))})};function bR(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=n[this.toHex()];if(u)return u;if(o!=null&&o.closest){var c=this.toRgb(),h=1/0,d="black";if(!s.length)for(var f in r)s[f]=new t(r[f]).toRgb();for(var p in r){var m=(a=c,l=s[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));m<h&&(h=m,d=p)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}TR([bR]);const Hi=class wl{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof wl)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,s)=>i===r[s]);if(e!==null&&r!==null){const i=Object.keys(e),s=Object.keys(r);return i.length!==s.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,n,i]=this._components;return{r:e,g:r,b:n,a:i}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,i]=this._components;return e=e??[],e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[r,n,i]=this._components;return e[0]=r,e[1]=n,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,i,s]=wl.temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return r&&(n=n*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[r,n,i]=this._components;return this._components[0]=Math.round(r*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[r,n,i,s]=this._components;return e[0]=r,e[1]=n,e[2]=i,e[3]=s,e}normalize(e){let r,n,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,i,s=255]=e,r/=255,n/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=wl.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=gr(e);o.isValid()&&({r,g:n,b:i,a:s}=o.rgba,r/=255,n/=255,i/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,r),n)}),e)}};Hi.shared=new Hi,Hi.temp=new Hi,Hi.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Ce=Hi;function AR(t){return he("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Ce.shared.setValue(t).toHex()}function CR(t){return he("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Ce.shared.setValue(t).toNumber()}function RR(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[ee.NORMAL_NPM]=ee.NORMAL,t[ee.ADD_NPM]=ee.ADD,t[ee.SCREEN_NPM]=ee.SCREEN,e[ee.NORMAL]=ee.NORMAL_NPM,e[ee.ADD]=ee.ADD_NPM,e[ee.SCREEN]=ee.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}const x_=RR();function __(t,e){return x_[e?1:0][t]}function PR(t,e=null){const r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let n=0,i=0;n<r;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function w_(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function ou(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function fy(t){return!(t&t-1)&&!!t}function py(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function vs(t,e,r){const n=t.length;let i;if(e>=n||r===0)return;r=e+r>n?n-e:r;const s=n-r;for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}function Tn(t){return t===0?0:t<0?-1:1}let IR=0;function vi(){return++IR}const Od=class{constructor(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Od.EMPTY=new Od(0,0,0,0);let my=Od;const gy={},yr=Object.create(null),cn=Object.create(null);class MR{constructor(e,r,n){this._canvas=z.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||z.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function yy(t,e,r){for(let n=0,i=4*r*e;n<e;++n,i+=4)if(t[i+3]!==0)return!1;return!0}function vy(t,e,r,n,i){const s=4*e;for(let o=n,a=n*s+4*r;o<=i;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function kR(t){const{width:e,height:r}=t,n=t.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,e,r).data;let s=0,o=0,a=e-1,l=r-1;for(;o<r&&yy(i,e,o);)++o;if(o===r)return my.EMPTY;for(;yy(i,e,l);)--l;for(;vy(i,e,s,o,l);)++s;for(;vy(i,e,a,o,l);)--a;return++a,++l,new my(s,o,a,l)}function BR(t){const e=kR(t),{width:r,height:n}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,r,n)}return{width:r,height:n,data:i}}function NR(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}function Jr(t,e=1){var n;const r=(n=z.RETINA_PREFIX)==null?void 0:n.exec(t);return r?parseFloat(r[1]):e}var U=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(U||{});const Ld=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},xy=(t,e)=>Ld(t).priority??e,X={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Ld).forEach(e=>{e.type.forEach(r=>{var n,i;return(i=(n=this._removeHandlers)[r])==null?void 0:i.call(n,e)})}),this},add(...t){return t.map(Ld).forEach(e=>{e.type.forEach(r=>{var s,o;const n=this._addHandlers,i=this._queue;n[r]?(s=n[r])==null||s.call(n,e):(i[r]=i[r]||[],(o=i[r])==null||o.push(e))})}),this},handle(t,e,r){var o;const n=this._addHandlers,i=this._removeHandlers;if(n[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,i[t]=r;const s=this._queue;return s[t]&&((o=s[t])==null||o.forEach(a=>e(a)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,s)=>xy(s,r)-xy(i,r)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}};class Ud{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const DR=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function FR(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function OR(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=DR.replace(/%forloop%/gi,FR(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}const rh=0,nh=1,ih=2,sh=3,oh=4,ah=5;class Br{constructor(){this.data=0,this.blendMode=ee.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<rh)}set blend(e){!!(this.data&1<<rh)!==e&&(this.data^=1<<rh)}get offsets(){return!!(this.data&1<<nh)}set offsets(e){!!(this.data&1<<nh)!==e&&(this.data^=1<<nh)}get culling(){return!!(this.data&1<<ih)}set culling(e){!!(this.data&1<<ih)!==e&&(this.data^=1<<ih)}get depthTest(){return!!(this.data&1<<sh)}set depthTest(e){!!(this.data&1<<sh)!==e&&(this.data^=1<<sh)}get depthMask(){return!!(this.data&1<<ah)}set depthMask(e){!!(this.data&1<<ah)!==e&&(this.data^=1<<ah)}get clockwiseFrontFace(){return!!(this.data&1<<oh)}set clockwiseFrontFace(e){!!(this.data&1<<oh)!==e&&(this.data^=1<<oh)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==ee.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Br;return e.depthTest=!1,e.blend=!0,e}}Br.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const jd=[];function E_(t,e){if(!t)return null;let r="";if(typeof t=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(let n=jd.length-1;n>=0;--n){const i=jd[n];if(i.test&&i.test(t,r))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class lr{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,n,i,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:c}=this;this._aliasCount++;for(let h=0,d=c.length;h<d;h++)c[h][u](e,r,n,i,s,o,a,l);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(lr.prototype,{dispatch:{value:lr.prototype.emit},run:{value:lr.prototype.emit}});class Jo{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new lr("setRealSize"),this.onUpdate=new lr("update"),this.onError=new lr("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}}class $u extends Jo{constructor(e,r){const{width:n,height:i}=r||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=e,this.unpackAlignment=r.unpackAlignment??4}upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===bt.UNPACK);const s=r.realWidth,o=r.realHeight;return n.width===s&&n.height===o?i.texSubImage2D(r.target,0,0,0,s,o,r.format,n.type,this.data):(n.width=s,n.height=o,i.texImage2D(r.target,0,n.internalFormat,s,o,0,r.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const LR={scaleMode:Hr.NEAREST,alphaMode:bt.NPM},Gd=class $i extends aa{constructor(e=null,r=null){super(),r=Object.assign({},$i.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:u,format:c,type:h,target:d,resolution:f,resourceOptions:p}=r;e&&!(e instanceof Jo)&&(e=E_(e,p),e.internal=!0),this.resolution=f||z.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=u,this._scaleMode=o,this.format=c,this.type=h,this.target=d,this.alphaMode=n,this.uid=vi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,r){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,n=!0),n&&this.dirtyStyleId++,this}setSize(e,r,n){return n=n||this.resolution,this.setRealSize(e*n,r*n,n)}setRealSize(e,r,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(r)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=fy(this.realWidth)&&fy(this.realHeight)}setResolution(e){const r=this.resolution;return r===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*r)/e,this.height=Math.round(this.height*r)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete cn[this.cacheId],delete yr[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),$i.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,r,n=z.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${vi()}`}s=e._pixiId}let o=cn[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new $i(e,r),o.cacheId=s,$i.addToCache(o,s)),o}static fromBuffer(e,r,n,i){e=e||new Float32Array(r*n*4);const s=new $u(e,{width:r,height:n,...i==null?void 0:i.resourceOptions});let o,a;return e instanceof Float32Array?(o=D.RGBA,a=Z.FLOAT):e instanceof Int32Array?(o=D.RGBA_INTEGER,a=Z.INT):e instanceof Uint32Array?(o=D.RGBA_INTEGER,a=Z.UNSIGNED_INT):e instanceof Int16Array?(o=D.RGBA_INTEGER,a=Z.SHORT):e instanceof Uint16Array?(o=D.RGBA_INTEGER,a=Z.UNSIGNED_SHORT):e instanceof Int8Array?(o=D.RGBA,a=Z.BYTE):(o=D.RGBA,a=Z.UNSIGNED_BYTE),s.internal=!0,new $i(s,Object.assign({},LR,{type:a,format:o},i))}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),cn[r]&&cn[r]!==e&&console.warn(`BaseTexture added to the cache with an id [${r}] that already had an entry`),cn[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=cn[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete cn[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)delete cn[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}};Gd.defaultOptions={mipmap:Mr.POW2,anisotropicLevel:0,scaleMode:Hr.LINEAR,wrapMode:Dn.CLAMP,alphaMode:bt.UNPACK,target:ms.TEXTURE_2D,format:D.RGBA,type:Z.UNSIGNED_BYTE},Gd._globalBatch=0;let se=Gd;class zd{constructor(){this.texArray=null,this.blend=0,this.type=Ar.TRIANGLES,this.start=0,this.size=0,this.data=null}}let UR=0;class He{constructor(e,r=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=r,this.id=UR++,this.disposeRunner=new lr("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Pr.ELEMENT_ARRAY_BUFFER:Pr.ARRAY_BUFFER}get index(){return this.type===Pr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new He(e)}}class au{constructor(e,r=0,n=!1,i=Z.FLOAT,s,o,a,l=1){this.buffer=e,this.size=r,this.normalized=n,this.type=i,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,r,n,i,s){return new au(e,r,n,i,s)}}const jR={Float32Array,Uint32Array,Int32Array,Uint8Array};function GR(t,e){let r=0,n=0;const i={};for(let l=0;l<t.length;l++)n+=e[l],r+=t[l].length;const s=new ArrayBuffer(r*4);let o=null,a=0;for(let l=0;l<t.length;l++){const u=e[l],c=t[l],h=w_(c);i[h]||(i[h]=new jR[h](s)),o=i[h];for(let d=0;d<c.length;d++){const f=(d/u|0)*n+a,p=d%u;o[f+p]=c[d]}a+=u}return new Float32Array(s)}const _y={5126:4,5123:2,5121:1};let zR=0;const HR={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Un{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=zR++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new lr("disposeGeometry"),this.refCount=0}addAttribute(e,r,n=0,i=!1,s,o,a,l=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof He||(r instanceof Array&&(r=new Float32Array(r)),r=new He(r));const u=e.split("|");if(u.length>1){for(let h=0;h<u.length;h++)this.addAttribute(u[h],r,n,i,s);return this}let c=this.buffers.indexOf(r);return c===-1&&(this.buffers.push(r),c=this.buffers.length-1),this.attributes[e]=new au(c,n,i,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof He||(e instanceof Array&&(e=new Uint16Array(e)),e=new He(e)),e.type=Pr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],r=[],n=new He;let i;for(i in this.attributes){const s=this.attributes[i],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*_y[s.type]/4),s.buffer=0}for(n.data=GR(e,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Un;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new He(this.buffers[r].data.slice(0));for(const r in this.attributes){const n=this.attributes[r];e.attributes[r]=new au(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Pr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const r=new Un,n=[],i=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l]=i[l]||0,i[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)n[a]=new HR[w_(o.buffers[a].data)](i[a]),r.buffers[a]=new He(n[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)n[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=Pr.ELEMENT_ARRAY_BUFFER;let a=0,l=0,u=0,c=0;for(let h=0;h<o.buffers.length;h++)if(o.buffers[h]!==o.indexBuffer){c=h;break}for(const h in o.attributes){const d=o.attributes[h];(d.buffer|0)===c&&(l+=d.size*_y[d.type]/4)}for(let h=0;h<e.length;h++){const d=e[h].indexBuffer.data;for(let f=0;f<d.length;f++)r.indexBuffer.data[f+u]+=a;a+=e[h].buffers[c].data.length/l,u+=d.length}}return r}}class S_ extends Un{constructor(e=!1){super(),this._buffer=new He(null,e,!1),this._indexBuffer=new He(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Z.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Z.FLOAT).addAttribute("aColor",this._buffer,4,!0,Z.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Z.FLOAT).addIndex(this._indexBuffer)}}const lu=Math.PI*2,$R=180/Math.PI,WR=Math.PI/180;var at=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(at||{});class me{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new me(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}}me.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const La=[new me,new me,new me,new me];class ae{constructor(e=0,r=0,n=0,i=0){this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(i),this.type=at.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ae(0,0,0,0)}clone(){return new ae(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){const E=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=E)return!1;const R=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>R}const n=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=n||o<=s)return!1;const a=La[0].set(e.left,e.top),l=La[1].set(e.left,e.bottom),u=La[2].set(e.right,e.top),c=La[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(l,l),r.apply(u,u),r.apply(c,c),Math.max(a.x,l.x,u.x,c.x)<=n||Math.min(a.x,l.x,u.x,c.x)>=i||Math.max(a.y,l.y,u.y,c.y)<=s||Math.min(a.y,l.y,u.y,c.y)>=o))return!1;const d=h*(l.y-a.y),f=h*(a.x-l.x),p=d*n+f*s,m=d*i+f*s,x=d*n+f*o,y=d*i+f*o;if(Math.max(p,m,x,y)<=d*a.x+f*a.y||Math.min(p,m,x,y)>=d*c.x+f*c.y)return!1;const v=h*(a.y-u.y),g=h*(u.x-a.x),w=v*n+g*s,S=v*i+g*s,C=v*n+g*o,b=v*i+g*o;return!(Math.max(w,S,C,b)<=v*a.x+g*a.y||Math.min(w,S,C,b)>=v*c.x+g*c.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,i=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=i,this.height=s-i,this}}ae.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Wu{constructor(e=0,r=0,n=0){this.x=e,this.y=r,this.radius=n,this.type=at.CIRC}clone(){return new Wu(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,s=this.y-r;return i*=i,s*=s,i+s<=n}getBounds(){return new ae(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Wu.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Vu{constructor(e=0,r=0,n=0,i=0){this.x=e,this.y=r,this.width=n,this.height=i,this.type=at.ELIP}clone(){return new Vu(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,i=(r-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new ae(this.x-this.width,this.y-this.height,this.width,this.height)}}Vu.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class ci{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let i=0,s=r.length;i<s;i++)n.push(r[i].x,r[i].y);r=n}this.points=r,this.type=at.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),r=new ci(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let n=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],c=this.points[o*2+1];l>r!=c>r&&e<(u-a)*((r-l)/(c-l))+a&&(n=!n)}return n}}ci.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class Xu{constructor(e=0,r=0,n=0,i=0,s=20){this.x=e,this.y=r,this.width=n,this.height=i,this.radius=s,this.type=at.RREC}clone(){return new Xu(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),s=r-(this.y+n);const o=n*n;if(i*i+s*s<=o||(i=e-(this.x+this.width-n),i*i+s*s<=o)||(s=r-(this.y+this.height-n),i*i+s*s<=o)||(i=e-(this.x+n),i*i+s*s<=o))return!0}return!1}}Xu.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Pe{constructor(e=1,r=0,n=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,i,s,o){return this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new me;const n=e.x,i=e.y;return r.x=this.a*n+this.c*i+this.tx,r.y=this.b*n+this.d*i+this.ty,r}applyInverse(e,r){r=r||new me;const n=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return r.x=this.d*n*i+-this.c*n*s+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*s+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*r-this.b*n,this.b=i*n+this.b*r,this.c=s*r-this.d*n,this.d=s*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,i=this.c,s=this.d;return this.a=e.a*r+e.b*i,this.b=e.a*n+e.b*s,this.c=e.c*r+e.d*i,this.d=e.c*n+e.d*s,this.tx=e.tx*r+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}setTransform(e,r,n,i,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(n*this.a+i*this.c),this.ty=r-(n*this.b+i*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),l=Math.atan2(n,r),u=Math.abs(a+l);return u<1e-5||Math.abs(lu-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*r+o.y*i),e.position.y=this.ty+(o.x*n+o.y*s),e}invert(){const e=this.a,r=this.b,n=this.c,i=this.d,s=this.tx,o=e*i-r*n;return this.a=i/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-i*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Pe;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Pe}static get TEMP_MATRIX(){return new Pe}}Pe.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const qn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Zn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Qn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Jn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Hd=[],T_=[],Ua=Math.sign;function VR(){for(let t=0;t<16;t++){const e=[];Hd.push(e);for(let r=0;r<16;r++){const n=Ua(qn[t]*qn[r]+Qn[t]*Zn[r]),i=Ua(Zn[t]*qn[r]+Jn[t]*Zn[r]),s=Ua(qn[t]*Qn[r]+Qn[t]*Jn[r]),o=Ua(Zn[t]*Qn[r]+Jn[t]*Jn[r]);for(let a=0;a<16;a++)if(qn[a]===n&&Zn[a]===i&&Qn[a]===s&&Jn[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Pe;e.set(qn[t],Zn[t],Qn[t],Jn[t],0,0),T_.push(e)}}VR();const Ne={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>qn[t],uY:t=>Zn[t],vX:t=>Qn[t],vY:t=>Jn[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Hd[t][e],sub:(t,e)=>Hd[t][Ne.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?Ne.S:Ne.N:Math.abs(e)*2<=Math.abs(t)?t>0?Ne.E:Ne.W:e>0?t>0?Ne.SE:Ne.SW:t>0?Ne.NE:Ne.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const i=T_[Ne.inv(e)];i.tx=r,i.ty=n,t.append(i)}};class Wr{constructor(e,r,n=0,i=0){this._x=n,this._y=i,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new Wr(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Wr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const $d=class{constructor(){this.worldTransform=new Pe,this.localTransform=new Pe,this.position=new Wr(this.onChange,this,0,0),this.scale=new Wr(this.onChange,this,1,1),this.pivot=new Wr(this.onChange,this,0,0),this.skew=new Wr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};$d.IDENTITY=new $d;let Ap=$d;Ap.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var XR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,YR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function wy(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function lh(t){const e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function b_(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return lh(2*e);case"bvec3":return lh(3*e);case"bvec4":return lh(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const xs=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],KR={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},qR={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function ZR(t,e){var n;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const s=e[i];if(!s){((n=t.uniforms[i])==null?void 0:n.group)===!0&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let a=!1;for(let l=0;l<xs.length;l++)if(xs[l].test(s,o)){r.push(xs[l].code(i,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?KR:qR)[s.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const A_={};let Oi=A_;function QR(){if(Oi===A_||Oi!=null&&Oi.isContextLost()){const t=z.ADAPTER.createCanvas();let e;z.PREFER_ENV>=Ti.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Oi=e}return Oi}let ja;function JR(){if(!ja){ja=Ht.MEDIUM;const t=QR();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(ja=e.precision?Ht.HIGH:Ht.MEDIUM)}}return ja}function Ey(t,e){const r=t.getShaderSource(e).split(`
`).map((u,c)=>`${c}: ${u}`),n=t.getShaderInfoLog(e),i=n.split(`
`),s={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{r[u-1]=`%c${r[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=r.join(`
`);a[0]=l,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function eP(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||Ey(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||Ey(t,n),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const tP={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function C_(t){return tP[t]}let Ga=null;const Sy={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function R_(t,e){if(!Ga){const r=Object.keys(Sy);Ga={};for(let n=0;n<r.length;++n){const i=r[n];Ga[t[i]]=Sy[i]}}return Ga[e]}function Ty(t,e,r){if(t.substring(0,9)!=="precision"){let n=e;return e===Ht.HIGH&&r!==Ht.HIGH&&(n=Ht.MEDIUM),`precision ${n} float;
${t}`}else if(r!==Ht.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let eo;function rP(){if(typeof eo=="boolean")return eo;try{eo=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{eo=!1}return eo}let nP=0;const za={},Wd=class Wi{constructor(e,r,n="pixi-shader",i={}){this.extra={},this.id=nP++,this.vertexSrc=e||Wi.defaultVertexSrc,this.fragmentSrc=r||Wi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),za[n]?(za[n]++,n+=`-${za[n]}`):za[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=Ty(this.vertexSrc,Wi.defaultVertexPrecision,Ht.HIGH),this.fragmentSrc=Ty(this.fragmentSrc,Wi.defaultFragmentPrecision,JR())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return YR}static get defaultFragmentSrc(){return XR}static from(e,r,n){const i=e+r;let s=gy[i];return s||(gy[i]=s=new Wi(e,r,n)),s}};Wd.defaultVertexPrecision=Ht.HIGH,Wd.defaultFragmentPrecision=$r.apple.device?Ht.HIGH:Ht.MEDIUM;let Vr=Wd,iP=0;class ur{constructor(e,r,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=iP++,this.static=!!r,this.ubo=!!n,e instanceof He?(this.buffer=e,this.buffer.type=Pr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new He(new Float32Array(1)),this.buffer.type=Pr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,n){if(!this.ubo)this.uniforms[e]=new ur(r,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,n){return new ur(e,r,n)}static uboFrom(e,r){return new ur(e,r??!0,!0)}}class Ir{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof ur?this.uniformGroup=r:this.uniformGroup=new ur(r):this.uniformGroup=new ur({}),this.disposeRunner=new lr("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(const n in r.uniforms){const i=r.uniforms[n];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,n){const i=Vr.from(e,r);return new Ir(i,n)}}class sP{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let s=0;s<e;s++)n[s]=s;this.defaultGroupCache[e]=ur.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Vr(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pe,default:this.defaultGroupCache[e]};return new Ir(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let n=0;n<e;n++)n>0&&(r+=`
else `),n<e-1&&(r+=`if(vTextureId < ${n}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class Vd{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function oP(){return!$r.apple.device}function aP(t){let e=!0;const r=z.ADAPTER.getNavigator();if($r.tablet||$r.phone){if($r.apple.device){const n=r.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if($r.android.device){const n=r.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?t:4}class Yu{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var lP=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,uP=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ao=class er extends Yu{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=S_,this.vertexSize=6,this.state=Br.for2d(),this.size=er.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??aP(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??oP(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return he("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return uP}static get defaultFragmentTemplate(){return lP}setShaderGenerator({vertex:e=er.defaultVertexSrc,fragment:r=er.defaultFragmentTemplate}={}){this.shaderGenerator=new sP(e,r)}contextChange(){const e=this.renderer.gl;z.PREFER_ENV===Ti.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),er.defaultMaxTextures),this.maxTextures=OR(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:r}=er,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;e.length<n;)e.push(new zd);for(;r.length<i;)r.push(new Vd);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:r}=this,n=er._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++se._globalBatch,l=0,u=n[0],c=0;i.copyBoundTextures(s,r);for(let h=0;h<this._bufferSize;++h){const d=e[h];e[h]=null,d._batchEnabled!==a&&(u.count>=r&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,c,h),c=h,u=n[++l],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,c,this._bufferSize),++l,++a);for(let h=0;h<s.length;h++)s[h]=null;se._globalBatch=a}buildDrawCalls(e,r,n){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=er._drawCallPool;let u=this._dcIndex,c=this._aIndex,h=this._iIndex,d=l[u];d.start=this._iIndex,d.texArray=e;for(let f=r;f<n;++f){const p=i[f],m=p._texture.baseTexture,x=x_[m.alphaMode?1:0][p.blendMode];i[f]=null,r<f&&d.blend!==x&&(d.size=h-d.start,r=f,d=l[++u],d.texArray=e,d.start=h),this.packInterleavedGeometry(p,s,o,c,h),c+=p.vertexData.length/2*a,h+=p.indices.length,d.blend=x}r<n&&(d.size=h-d.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=h}bindAndClearTexArray(e){const r=this.renderer.texture;for(let n=0;n<e.count;n++)r.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:r,_indexBuffer:n}=this;er.canUploadSameBuffer?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:r,state:n}=this.renderer,i=er._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:u,start:c,blend:h}=i[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=h,n.set(this.state),r.drawElements(l,u,r.UNSIGNED_SHORT,c*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),er.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const r=ou(Math.ceil(e/8)),n=py(r),i=r*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new Ud(i*this.vertexSize*4)),s}getIndexBuffer(e){const r=ou(Math.ceil(e/12)),n=py(r),i=r*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._iBuffers[n];return s||(this._iBuffers[n]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,r,n,i,s){const{uint32View:o,float32View:a}=r,l=i/this.vertexSize,u=e.uvs,c=e.indices,h=e.vertexData,d=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),p=Ce.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let m=0;m<h.length;m+=2)a[i++]=h[m],a[i++]=h[m+1],a[i++]=u[m],a[i++]=u[m+1],o[i++]=p,a[i++]=d;for(let m=0;m<c.length;m++)n[s++]=l+c[m]}};ao.defaultBatchSize=4096,ao.extension={name:"batch",type:U.RendererPlugin},ao._drawCallPool=[],ao._textureArrayPool=[];let ei=ao;X.add(ei);var cP=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,hP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Xd=class lo extends Ir{constructor(e,r,n){const i=Vr.from(e||lo.defaultVertexSrc,r||lo.defaultFragmentSrc);super(i,n),this.padding=0,this.resolution=lo.defaultResolution,this.multisample=lo.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Br}apply(e,r,n,i,s){e.applyFilter(this,r,n,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return hP}static get defaultFragmentSrc(){return cP}};Xd.defaultResolution=1,Xd.defaultMultisample=We.NONE;let yt=Xd;class uu{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Ce(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:r,background:n,backgroundAlpha:i}=e,s=n??r;s!==void 0&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}uu.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},uu.extension={type:[U.RendererSystem,U.CanvasRendererSystem],name:"background"};X.add(uu);class P_{constructor(e){this.renderer=e,this.emptyRenderer=new Yu(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){const{boundTextures:n}=this.renderer.texture;for(let i=r-1;i>=0;--i)e[i]=n[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,r,n,i){const{elements:s,ids:o,count:a}=e;let l=0;for(let u=0;u<a;u++){const c=s[u],h=c._batchLocation;if(h>=0&&h<i&&r[h]===c){o[u]=h;continue}for(;l<i;){const d=r[l];if(d&&d._batchEnabled===n&&d._batchLocation===l){l++;continue}o[u]=l,c._batchLocation=l,r[l]=c;break}}}destroy(){this.renderer=null}}P_.extension={type:U.RendererSystem,name:"batch"};X.add(P_);let by=0;class cu{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=by++}init(e){if(e.context)this.initFromContext(e.context);else{const r=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=by++,this.renderer.runners.contextChange.emit(e);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let n;if(z.PREFER_ENV>=Ti.WEBGL2&&(n=e.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const r=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}cu.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},cu.extension={type:U.RendererSystem,name:"context"};X.add(cu);class Yd{constructor(e,r){if(this.width=Math.round(e),this.height=Math.round(r),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new lr("disposeFramebuffer"),this.multisample=We.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new se(null,{scaleMode:Hr.NEAREST,resolution:1,mipmap:Mr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new se(null,{scaleMode:Hr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Mr.OFF,format:D.DEPTH_COMPONENT,type:Z.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!e||!r)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],s=i.resolution;i.setSize(e/s,r/s)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,r/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class I_ extends se{constructor(e={}){if(typeof e=="number"){const r=arguments[0],n=arguments[1],i=arguments[2],s=arguments[3];e={width:r,height:n,scaleMode:i,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=We.NONE),super(null,e),this.mipmap=Mr.OFF,this.valid=!0,this._clear=new Ce([0,0,0,0]),this.framebuffer=new Yd(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class en extends Jo{constructor(e){const r=e,n=r.naturalWidth||r.videoWidth||r.displayWidth||r.width,i=r.naturalHeight||r.videoHeight||r.displayHeight||r.height;super(n,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,n){n===void 0&&!r.startsWith("data:")?e.crossOrigin=NR(r):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,r,n,i){const s=e.gl,o=r.realWidth,a=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===bt.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&n.width===o&&n.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,n.type,i):(n.width=o,n.height=a,s.texImage2D(r.target,0,n.internalFormat,r.format,n.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),super.update()}dispose(){this.source=null}}class M_ extends en{constructor(e,r){if(r=r||{},typeof e=="string"){const n=new Image;en.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??z.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,n)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{n(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===bt.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,n,this.bitmap),!this.preserveBitmap){let i=!0;const s=r._glTextures;for(const o in s){const a=s[o];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class Cp{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,n){const i=r.width,s=r.height;if(n){const o=e.width/2/i,a=e.height/2/s,l=e.x/i+o,u=e.y/s+a;n=Ne.add(n,Ne.NW),this.x0=l+o*Ne.uX(n),this.y0=u+a*Ne.uY(n),n=Ne.add(n,2),this.x1=l+o*Ne.uX(n),this.y1=u+a*Ne.uY(n),n=Ne.add(n,2),this.x2=l+o*Ne.uX(n),this.y2=u+a*Ne.uY(n),n=Ne.add(n,2),this.x3=l+o*Ne.uX(n),this.y3=u+a*Ne.uY(n)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Cp.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Ay=new Cp;function Ha(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class V extends aa{constructor(e,r,n,i,s,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new ae(0,0,1,1)),e instanceof V&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=Ay,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new me(o.x,o.y):new me(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:r}=this.baseTexture;r!=null&&r.url&&yr[r.url]&&V.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,V.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new V(this.baseTexture,!this.noFrame&&e,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===Ay&&(this._uvs=new Cp),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},n=z.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else if(e instanceof se){if(!e.cacheId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${vi()}`,se.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${vi()}`}s=e._pixiId}let o=yr[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof se)?(r.resolution||(r.resolution=Jr(e)),o=new V(new se(e,r)),o.baseTexture.cacheId=s,se.addToCache(o.baseTexture,s),V.addToCache(o,s)):!o&&e instanceof se&&(o=new V(e),V.addToCache(o,s)),o}static fromURL(e,r){const n=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=V.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,r,n,i){return new V(se.fromBuffer(e,r,n,i))}static fromLoader(e,r,n,i){const s=new se(e,Object.assign({scaleMode:se.defaultOptions.scaleMode,resolution:Jr(r)},i)),{resource:o}=s;o instanceof M_&&(o.url=r);const a=new V(s);return n||(n=r),se.addToCache(a.baseTexture,n),V.addToCache(a,n),n!==r&&(se.addToCache(a.baseTexture,r),V.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),yr[r]&&yr[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),yr[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=yr[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete yr[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)yr[e.textureCacheIds[r]]===e&&delete yr[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:r,y:n,width:i,height:s}=e,o=r+i>this.baseTexture.width,a=n+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",u=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,c=`Y: ${n} + ${s} = ${n+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${l} ${c}`)}this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return V._EMPTY||(V._EMPTY=new V(new se),Ha(V._EMPTY),Ha(V._EMPTY.baseTexture)),V._EMPTY}static get WHITE(){if(!V._WHITE){const e=z.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),V._WHITE=new V(se.from(e)),Ha(V._WHITE),Ha(V._WHITE.baseTexture)}return V._WHITE}}class Ai extends V{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,n=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(r*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new Ai(new I_(e))}}class k_{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,n=We.NONE){const i=new I_(Object.assign({width:e,height:r,resolution:1,multisample:n},this.textureOptions));return new Ai(i)}getOptimalTexture(e,r,n=1,i=We.NONE){let s;e=Math.max(Math.ceil(e*n-1e-6),1),r=Math.max(Math.ceil(r*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=ou(e),r=ou(r),s=((e&65535)<<16|r&65535)>>>0,i>1&&(s+=i*4294967296)):s=i>1?-i:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,i)),o.filterPoolKey=s,o.setResolution(n),o}getFilterTexture(e,r,n){const i=this.getOptimalTexture(e.width,e.height,r||e.resolution,n||We.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const r in this.texturePool){const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}k_.SCREEN_KEY=-1;class dP extends Un{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class B_ extends Un{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new He(this.vertices),this.uvBuffer=new He(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+r.width/e.width,this.uvs[3]=i,this.uvs[4]=n+r.width/e.width,this.uvs[5]=i+r.height/e.height,this.uvs[6]=n,this.uvs[7]=i+r.height/e.height,n=r.x,i=r.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+r.width,this.vertices[3]=i,this.vertices[4]=n+r.width,this.vertices[5]=i+r.height,this.vertices[6]=n,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class fP{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=We.NONE,this.sourceFrame=new ae,this.destinationFrame=new ae,this.bindingSourceFrame=new ae,this.bindingDestinationFrame=new ae,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const $a=[new me,new me,new me,new me],uh=new Pe;class N_{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new k_,this.statePool=[],this.quad=new dP,this.quadUv=new B_,this.tempRect=new ae,this.activeState={},this.globalUniforms=new ur({outputFrame:new ae,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){const n=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new fP,o=n.renderTexture;let a,l;if(o.current){const x=o.current;a=x.resolution,l=x.multisample}else a=n.resolution,l=n.multisample;let u=r[0].resolution||a,c=r[0].multisample??l,h=r[0].padding,d=r[0].autoFit,f=r[0].legacy??!0;for(let x=1;x<r.length;x++){const y=r[x];u=Math.min(u,y.resolution||a),c=Math.min(c,y.multisample??l),h=this.useMaxPadding?Math.max(h,y.padding):h+y.padding,d=d&&y.autoFit,f=f||(y.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=u,s.multisample=c,s.legacy=f,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(h);const p=this.tempRect.copyFrom(o.sourceFrame);n.projection.transform&&this.transformAABB(uh.copyFrom(n.projection.transform).invert(),p),d?(s.sourceFrame.fit(p),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(p)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:n.resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,u,c),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const m=this.tempRect;m.x=0,m.y=0,m.width=s.sourceFrame.width,m.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=n.projection.transform,n.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,m),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,r=e.pop(),n=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const s=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*s[2]-.5*o[2],a[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){const u=i.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,l.renderTexture,Sr.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let u=r.renderTexture,c=this.getOptimalFilterTexture(u.width,u.height,r.resolution);c.filterFrame=u.filterFrame;let h=0;for(h=0;h<n.length-1;++h){h===1&&r.multisample>1&&(c=this.getOptimalFilterTexture(u.width,u.height,r.resolution),c.filterFrame=u.filterFrame),n[h].apply(this,u,c,Sr.CLEAR,r);const d=u;u=c,c=d}n[h].apply(this,u,l.renderTexture,Sr.BLEND,r),h>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(c)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=Sr.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,n.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=i.stateId&1||this.forceClear;(r===Sr.CLEAR||r===Sr.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,n,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(n,i),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Ar.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Ar.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:s}=r._texture,o=e.set(i.width,0,0,i.height,n.x,n.y),a=r.worldTransform.copyTo(Pe.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,n=1,i=We.NONE){return this.texturePool.getOptimalTexture(e,r,n,i)}getFilterTexture(e,r,n){if(typeof e=="number"){const s=e;e=r,r=s}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,n||We.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){const n=$a[0],i=$a[1],s=$a[2],o=$a[3];n.set(r.left,r.top),i.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(n,n),e.apply(i,i),e.apply(s,s),e.apply(o,o);const a=Math.min(n.x,i.x,s.x,o.x),l=Math.min(n.y,i.y,s.y,o.y),u=Math.max(n.x,i.x,s.x,o.x),c=Math.max(n.y,i.y,s.y,o.y);r.x=a,r.y=l,r.width=u-a,r.height=c-l}roundFrame(e,r,n,i,s){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(s){const{a:o,b:a,c:l,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?uh.copyFrom(s):uh.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}}N_.extension={type:U.RendererSystem,name:"filter"};X.add(N_);class pP{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=We.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const mP=new ae;class D_{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Yd(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ae,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;z.PREFER_ENV===Ti.WEBGL_LEGACY&&(r=null,n=null),r?e.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,n=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=n),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){const o=r.width>>n,a=r.height>>n,l=o/r.width;this.setViewport(r.x*l,r.y*l,o,a)}else{const o=e.width>>n,a=e.height>>n;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,n,i){const s=this.viewport;e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),(s.width!==n||s.height!==i||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=n,s.height=i,this.gl.viewport(e,r,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,n,i,s=Ed.COLOR|Ed.DEPTH){const{gl:o}=this;o.clearColor(e,r,n,i),o.clear(s)}initFramebuffer(e){const{gl:r}=this,n=new pP(r.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){r.bindRenderbuffer(r.RENDERBUFFER,n.stencil);let o;this.renderer.context.webGLVersion===1?o=r.DEPTH_STENCIL:e.depth&&e.stencil?o=r.DEPTH24_STENCIL8:e.depth?o=r.DEPTH_COMPONENT24:o=r.STENCIL_INDEX8,n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,o,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let s=i.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=i[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&n.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const u=s[l],c=u.parentTextureArray||u;this.renderer.texture.bind(c,0),l===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+l,u.target,c._glTextures[this.CONTEXT_UID].texture,r),a.push(n.COLOR_ATTACHMENT0+l))}if(a.length>1&&n.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,r)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||n.createRenderbuffer();let l,u;this.renderer.context.webGLVersion===1?(l=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH_STENCIL):e.depth&&e.stencil?(l=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH24_STENCIL8):e.depth?(l=n.DEPTH_ATTACHMENT,u=n.DEPTH_COMPONENT24):(l=n.STENCIL_ATTACHMENT,u=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,u,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,u,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,l,n.RENDERBUFFER,i.stencil)}else i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:r}=this;let n=We.NONE;if(e<=1||r===null)return n;for(let i=0;i<r.length;i++)if(r[i]<=e){n=r[i];break}return n===1&&(n=We.NONE),n}blit(e,r,n){const{current:i,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!i)return;const l=i.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const c=i.colorTextures[0];if(!c)return;l.blitFramebuffer||(l.blitFramebuffer=new Yd(i.width,i.height),l.blitFramebuffer.addColorTexture(0,c)),e=l.blitFramebuffer,e.colorTextures[0]!==c&&(e.colorTextures[0]=c,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}r||(r=mP,r.width=i.width,r.height=i.height),n||(n=r);const u=r.width===n.width&&r.height===n.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,r){const n=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,r)}disposeAll(e){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<r.length;n++)this.disposeFramebuffer(r[n],e)}forceStencil(){const e=this.current;if(!e)return;const r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil&&e.stencil)return;e.stencil=!0;const n=e.width,i=e.height,s=this.gl,o=r.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,l,n,i):s.renderbufferStorage(s.RENDERBUFFER,l,n,i),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ae}destroy(){this.renderer=null}}D_.extension={type:U.RendererSystem,name:"framebuffer"};X.add(D_);const ch={5126:4,5123:2,5121:1};class F_{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;z.PREFER_ENV===Ti.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(i,s)=>n.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,a,l)=>n.drawElementsInstancedANGLE(i,s,o,a,l),e.drawArraysInstanced=(i,s,o,a)=>n.drawArraysInstancedANGLE(i,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;const{gl:n}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,r=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];r.update(i)}}checkCompatibility(e,r){const n=e.attributes,i=r.attributeData;for(const s in i)if(!n[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){const n=e.attributes,i=r.attributeData,s=["g",e.id];for(const o in n)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,r,n=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,a);const l=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let c=u[l];if(c)return u[a.id]=c,c;const h=e.buffers,d=e.attributes,f={},p={};for(const m in h)f[m]=0,p[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[m].buffer]+=d[m].size*ch[d[m].type];for(const m in d){const x=d[m],y=x.size;x.stride===void 0&&(f[x.buffer]===y*ch[x.type]?x.stride=0:x.stride=f[x.buffer]),x.start===void 0&&(x.start=p[x.buffer],p[x.buffer]+=y*ch[x.type])}c=i.createVertexArray(),i.bindVertexArray(c);for(let m=0;m<h.length;m++){const x=h[m];o.bind(x),n&&x._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=c,u[l]=c,i.bindVertexArray(null),o.unbind(Pr.ARRAY_BUFFER),c}disposeGeometry(e,r){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!n){if(o)for(let l=0;l<s.length;l++){const u=s[l]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!r&&o.dispose(s[l],r))}if(!r){for(const l in n)if(l[0]==="g"){const u=n[l];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const r=Object.keys(this.managedGeometries);for(let n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],e)}activateVao(e,r){const n=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const u in a){const c=a[u],h=o[c.buffer],d=h._glBuffers[i];if(r.attributeData[u]){l!==d&&(s.bind(h),l=d);const f=r.attributeData[u].location;if(n.enableVertexAttribArray(f),n.vertexAttribPointer(f,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)n.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,n,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,l,(n||0)*a,i||1):s.drawElements(e,r||o.indexBuffer.data.length,l,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,n,r||o.getSize(),i||1):s.drawArrays(e,n,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}F_.extension={type:U.RendererSystem,name:"geometry"};X.add(F_);const Cy=new Pe;class O_{constructor(e,r){this._texture=e,this.mapCoord=new Pe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];r[i]=s*n.a+o*n.c+n.tx,r[i+1]=s*n.b+o*n.d+n.ty}return r}update(e){const r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const n=r._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=r.orig,s=r.trim;s&&(Cy.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Cy));const o=r.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(r._frame.x+l+u)/o.width,a[1]=(r._frame.y+l+u)/o.height,a[2]=(r._frame.x+r._frame.width-l+u)/o.width,a[3]=(r._frame.y+r._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}}var gP=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,yP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class vP extends yt{constructor(e,r,n){let i=null;typeof e!="string"&&r===void 0&&n===void 0&&(i=e,e=void 0,r=void 0,n=void 0),super(e||yP,r||gP,n),this.maskSprite=i,this.maskMatrix=new Pe}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,n,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new O_(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,n,i))}}class xP{constructor(e=null){this.type=qe.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=yt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=qe.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class L_{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let n=r;if(!n.isMaskData){const s=this.maskDataPool.pop()||new xP;s.pooled=!0,s.maskObject=r,n=s}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==qe.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case qe.SCISSOR:this.renderer.scissor.push(n);break;case qe.STENCIL:this.renderer.stencil.push(n);break;case qe.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case qe.COLOR:this.pushColorMask(n);break}n.type===qe.SPRITE&&this.maskStack.push(n)}pop(e){const r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case qe.SCISSOR:this.renderer.scissor.pop(r);break;case qe.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case qe.SPRITE:this.popSpriteMask(r);break;case qe.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===qe.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const r=e.maskObject;r?r.isSprite?e.type=qe.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=qe.SCISSOR:e.type=qe.STENCIL:e.type=qe.COLOR}pushSpriteMask(e){const{maskObject:r}=e,n=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new vP])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=r;const s=n.filterArea;n.filterArea=r.getBounds(!0),this.renderer.filter.push(n,i),n.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const r=e._colorMask,n=e._colorMask=r&e.colorMask;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const r=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}L_.extension={type:U.RendererSystem,name:"mask"};X.add(L_);class U_{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:r}=this.renderer,n=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==n&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Ry=new Pe,Py=[],j_=class El extends U_{constructor(e){super(e),this.glConst=z.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const r=e._scissorRect,{maskObject:n}=e,{renderer:i}=this,s=i.renderTexture,o=n.getBounds(!0,Py.pop()??new ae);this.roundFrameToPixels(o,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),r&&o.fit(r),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:r,b:n,c:i,d:s}=e;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(r)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:r}=e;if(!r.isFastRect||!r.isFastRect()||El.isMatrixRotated(r.worldTransform)||El.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const n=e._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(e,r,n,i,s){El.isMatrixRotated(s)||(s=s?Ry.copyFrom(s):Ry.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*r),e.y=Math.round(e.y*r),e.width=Math.round(e.width*r),e.height=Math.round(e.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:r}=this.renderer;e._scissorRect||r.enable(r.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:r}=this.renderer;e&&Py.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():r.disable(r.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let r;this.renderer.renderTexture.current?r=e.y:r=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,r,e.width,e.height)}};j_.extension={type:U.RendererSystem,name:"scissor"};let _P=j_;X.add(_P);class G_ extends U_{constructor(e){super(e),this.glConst=z.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const r=e.maskObject,{gl:n}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,n.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(n._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}G_.extension={type:U.RendererSystem,name:"stencil"};X.add(G_);class z_{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return he("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return he("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return he("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}z_.extension={type:[U.RendererSystem,U.CanvasRendererSystem],name:"_plugin"};X.add(z_);class H_{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Pe,this.transform=null}update(e,r,n,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,n,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}}H_.extension={type:U.RendererSystem,name:"projection"};X.add(H_);const wP=new Ap,Iy=new ae;class $_{constructor(e){this.renderer=e,this._tempMatrix=new Pe}generateTexture(e,r){const{region:n,...i}=r||{},s=(n==null?void 0:n.copyTo(Iy))||e.getLocalBounds(Iy,!0),o=i.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),i.width=s.width,i.height=s.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const a=Ai.create(i);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=wP,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}$_.extension={type:[U.RendererSystem,U.CanvasRendererSystem],name:"textureGenerator"};X.add($_);const Wn=new ae,to=new ae;class W_{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ae,this.destinationFrame=new ae,this.viewportFrame=new ae}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,r,n){const i=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,r||(Wn.width=e.frame.width,Wn.height=e.frame.height,r=Wn),n||(to.x=e.frame.x,to.y=e.frame.y,to.width=r.width,to.height=r.height,n=to),o=s.framebuffer):(a=i.resolution,r||(Wn.width=i._view.screen.width,Wn.height=i._view.screen.height,r=Wn),n||(n=Wn,n.width=r.width,n.height=r.height));const l=this.viewportFrame;l.x=n.x*a,l.y=n.y*a,l.width=n.width*a,l.height=n.height*a,e||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(n,r,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)}clear(e,r){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=Ce.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:u,width:c,height:h}=this.viewportFrame;l=Math.round(l),u=Math.round(u),c=Math.round(c),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,u,c,h)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}W_.extension={type:U.RendererSystem,name:"renderTexture"};X.add(W_);class EP{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function SP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=R_(e,s.type),a={type:o,name:s.name,size:C_(o),location:e.getAttribLocation(t,s.name)};r[s.name]=a}return r}function TP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=R_(e,s.type);r[o]={name:o,index:i,type:l,size:s.size,isArray:a,value:b_(l,s.size)}}return r}function bP(t,e){var a;const r=wy(t,t.VERTEX_SHADER,e.vertexSrc),n=wy(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||eP(t,i,r,n),e.attributeData=SP(i,t),e.uniformData=TP(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((u,c)=>u>c?1:-1);for(let u=0;u<l.length;u++)e.attributeData[l[u]].location=u,t.bindAttribLocation(i,u,l[u]);t.linkProgram(i)}t.deleteShader(r),t.deleteShader(n);const o={};for(const l in e.uniformData){const u=e.uniformData[l];o[l]={location:t.getUniformLocation(i,l),value:b_(u.type,u.size)}}return new EP(i,o)}function AP(t,e,r,n,i){r.buffer.update(i)}const CP={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},V_={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function RP(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let r=0,n=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(r=V_[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!==0&&n<16){const a=n%r%16;n+=a,i+=a}n+r>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function PP(t,e){const r=[];for(const n in t)e[n]&&r.push(e[n]);return r.sort((n,i)=>n.index-i.index),r}function IP(t,e){if(!t.autoManage)return{size:0,syncFunc:AP};const r=PP(t.uniforms,e),{uboElements:n,size:i}=RP(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<n.length;o++){const a=n[o],l=t.uniforms[a.data.name],u=a.data.name;let c=!1;for(let h=0;h<xs.length;h++){const d=xs[h];if(d.codeUbo&&d.test(a.data,l)){s.push(`offset = ${a.offset/4};`,xs[h].codeUbo(a.data.name,l)),c=!0;break}}if(!c)if(a.data.size>1){const h=C_(a.data.type),d=Math.max(V_[a.data.type]/16,1),f=h/d,p=(4-f%4)%4;s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const h=CP[a.data.type];s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${h};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let MP=0;const Wa={textureCount:0,uboCount:0};class X_{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=MP++}systemCheck(){if(!rP())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),r||(Wa.textureCount=0,Wa.uboCount=0,this.syncUniformGroup(e.uniformGroup,Wa)),i}setUniforms(e){const r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,r){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,r))}syncUniforms(e,r,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=ZR(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const i=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,r);e.buffer.update(),i(n.uniformData,e.uniforms,this.renderer,Wa,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[r])}createSyncBufferGroup(e,r,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(r.program,n);r.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=IP(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return r.uniformGroups[e.id]=a.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,n){const i=e.uniforms,s=[`${n}-`];for(const o in i)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=this.gl,n=e.program,i=bP(r,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}X_.extension={type:U.RendererSystem,name:"shader"};X.add(X_);class hu{constructor(e){this.renderer=e}run(e){const{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.4.3 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}}hu.defaultOptions={hello:!1},hu.extension={type:[U.RendererSystem,U.CanvasRendererSystem],name:"startup"};X.add(hu);function kP(t,e=[]){return e[ee.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.ADD]=[t.ONE,t.ONE],e[ee.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.NONE]=[0,0],e[ee.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[ee.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ee.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[ee.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[ee.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ee.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[ee.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[ee.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[ee.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[ee.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ee.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const BP=0,NP=1,DP=2,FP=3,OP=4,LP=5,Y_=class Kd{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ee.NONE,this._blendEq=!1,this.map=[],this.map[BP]=this.setBlend,this.map[NP]=this.setOffset,this.map[DP]=this.setCullFace,this.map[FP]=this.setDepthTest,this.map[OP]=this.setFrontFace,this.map[LP]=this.setDepthMask,this.checks=[],this.defaultState=new Br,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=kP(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let r=this.stateId^e.data,n=0;for(;r;)r&1&&this.map[n].call(this,!!(e.data&1<<n)),r=r>>1,n++;this.stateId=e.data}for(let r=0;r<this.checks.length;r++)this.checks[r](this,e)}forceState(e){e=e||this.defaultState;for(let r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(let r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Kd.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Kd.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const r=this.blendModes[e],n=this.gl;r.length===2?n.blendFunc(r[0],r[1]):n.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,n.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,r){this.gl.polygonOffset(e,r)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,r){const n=this.checks.indexOf(e);r&&n===-1?this.checks.push(e):!r&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,r){e.setBlendMode(r.blendMode)}static checkPolygonOffset(e,r){e.setPolygonOffset(1,r.polygonOffset)}destroy(){this.gl=null}};Y_.extension={type:U.RendererSystem,name:"state"};let UP=Y_;X.add(UP);class jP extends aa{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const r=(e.priority??[]).filter(i=>e.systems[i]),n=[...r,...Object.keys(e.systems).filter(i=>!r.includes(i))];for(const i of n)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(r=>{this.runners[r]=new lr(r)})}addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(e,r){const n=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=n.find(o=>this._systemsHash[o]===i);i[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const uo=class Sl{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Sl.defaultMaxIdle,this.checkCountMax=Sl.defaultCheckCountMax,this.mode=Sl.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==yp.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,r=e.managedTextures;let n=!1;for(let i=0;i<r.length;i++){const s=r[i];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),r[i]=null,n=!0)}if(n){let i=0;for(let s=0;s<r.length;s++)r[s]!==null&&(r[i++]=r[s]);r.length=i}}unload(e){const r=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&r.destroyTexture(n);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};uo.defaultMode=yp.AUTO,uo.defaultMaxIdle=60*60,uo.defaultCheckCountMax=60*10,uo.extension={type:U.RendererSystem,name:"textureGC"};let ti=uo;X.add(ti);class hh{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Z.UNSIGNED_BYTE,this.internalFormat=D.RGBA,this.samplerType=0}}function GP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:G.FLOAT,[t.RGBA]:G.FLOAT,[t.ALPHA]:G.FLOAT,[t.LUMINANCE]:G.FLOAT,[t.LUMINANCE_ALPHA]:G.FLOAT,[t.R8]:G.FLOAT,[t.R8_SNORM]:G.FLOAT,[t.RG8]:G.FLOAT,[t.RG8_SNORM]:G.FLOAT,[t.RGB8]:G.FLOAT,[t.RGB8_SNORM]:G.FLOAT,[t.RGB565]:G.FLOAT,[t.RGBA4]:G.FLOAT,[t.RGB5_A1]:G.FLOAT,[t.RGBA8]:G.FLOAT,[t.RGBA8_SNORM]:G.FLOAT,[t.RGB10_A2]:G.FLOAT,[t.RGB10_A2UI]:G.FLOAT,[t.SRGB8]:G.FLOAT,[t.SRGB8_ALPHA8]:G.FLOAT,[t.R16F]:G.FLOAT,[t.RG16F]:G.FLOAT,[t.RGB16F]:G.FLOAT,[t.RGBA16F]:G.FLOAT,[t.R32F]:G.FLOAT,[t.RG32F]:G.FLOAT,[t.RGB32F]:G.FLOAT,[t.RGBA32F]:G.FLOAT,[t.R11F_G11F_B10F]:G.FLOAT,[t.RGB9_E5]:G.FLOAT,[t.R8I]:G.INT,[t.R8UI]:G.UINT,[t.R16I]:G.INT,[t.R16UI]:G.UINT,[t.R32I]:G.INT,[t.R32UI]:G.UINT,[t.RG8I]:G.INT,[t.RG8UI]:G.UINT,[t.RG16I]:G.INT,[t.RG16UI]:G.UINT,[t.RG32I]:G.INT,[t.RG32UI]:G.UINT,[t.RGB8I]:G.INT,[t.RGB8UI]:G.UINT,[t.RGB16I]:G.INT,[t.RGB16UI]:G.UINT,[t.RGB32I]:G.INT,[t.RGB32UI]:G.UINT,[t.RGBA8I]:G.INT,[t.RGBA8UI]:G.UINT,[t.RGBA16I]:G.INT,[t.RGBA16UI]:G.UINT,[t.RGBA32I]:G.INT,[t.RGBA32UI]:G.UINT,[t.DEPTH_COMPONENT16]:G.FLOAT,[t.DEPTH_COMPONENT24]:G.FLOAT,[t.DEPTH_COMPONENT32F]:G.FLOAT,[t.DEPTH_STENCIL]:G.FLOAT,[t.DEPTH24_STENCIL8]:G.FLOAT,[t.DEPTH32F_STENCIL8]:G.FLOAT}:e={[t.RGB]:G.FLOAT,[t.RGBA]:G.FLOAT,[t.ALPHA]:G.FLOAT,[t.LUMINANCE]:G.FLOAT,[t.LUMINANCE_ALPHA]:G.FLOAT,[t.DEPTH_STENCIL]:G.FLOAT},e}function zP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[Z.UNSIGNED_BYTE]:{[D.RGBA]:t.RGBA8,[D.RGB]:t.RGB8,[D.RG]:t.RG8,[D.RED]:t.R8,[D.RGBA_INTEGER]:t.RGBA8UI,[D.RGB_INTEGER]:t.RGB8UI,[D.RG_INTEGER]:t.RG8UI,[D.RED_INTEGER]:t.R8UI,[D.ALPHA]:t.ALPHA,[D.LUMINANCE]:t.LUMINANCE,[D.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Z.BYTE]:{[D.RGBA]:t.RGBA8_SNORM,[D.RGB]:t.RGB8_SNORM,[D.RG]:t.RG8_SNORM,[D.RED]:t.R8_SNORM,[D.RGBA_INTEGER]:t.RGBA8I,[D.RGB_INTEGER]:t.RGB8I,[D.RG_INTEGER]:t.RG8I,[D.RED_INTEGER]:t.R8I},[Z.UNSIGNED_SHORT]:{[D.RGBA_INTEGER]:t.RGBA16UI,[D.RGB_INTEGER]:t.RGB16UI,[D.RG_INTEGER]:t.RG16UI,[D.RED_INTEGER]:t.R16UI,[D.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[Z.SHORT]:{[D.RGBA_INTEGER]:t.RGBA16I,[D.RGB_INTEGER]:t.RGB16I,[D.RG_INTEGER]:t.RG16I,[D.RED_INTEGER]:t.R16I},[Z.UNSIGNED_INT]:{[D.RGBA_INTEGER]:t.RGBA32UI,[D.RGB_INTEGER]:t.RGB32UI,[D.RG_INTEGER]:t.RG32UI,[D.RED_INTEGER]:t.R32UI,[D.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[Z.INT]:{[D.RGBA_INTEGER]:t.RGBA32I,[D.RGB_INTEGER]:t.RGB32I,[D.RG_INTEGER]:t.RG32I,[D.RED_INTEGER]:t.R32I},[Z.FLOAT]:{[D.RGBA]:t.RGBA32F,[D.RGB]:t.RGB32F,[D.RG]:t.RG32F,[D.RED]:t.R32F,[D.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[Z.HALF_FLOAT]:{[D.RGBA]:t.RGBA16F,[D.RGB]:t.RGB16F,[D.RG]:t.RG16F,[D.RED]:t.R16F},[Z.UNSIGNED_SHORT_5_6_5]:{[D.RGB]:t.RGB565},[Z.UNSIGNED_SHORT_4_4_4_4]:{[D.RGBA]:t.RGBA4},[Z.UNSIGNED_SHORT_5_5_5_1]:{[D.RGBA]:t.RGB5_A1},[Z.UNSIGNED_INT_2_10_10_10_REV]:{[D.RGBA]:t.RGB10_A2,[D.RGBA_INTEGER]:t.RGB10_A2UI},[Z.UNSIGNED_INT_10F_11F_11F_REV]:{[D.RGB]:t.R11F_G11F_B10F},[Z.UNSIGNED_INT_5_9_9_9_REV]:{[D.RGB]:t.RGB9_E5},[Z.UNSIGNED_INT_24_8]:{[D.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[Z.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[D.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[Z.UNSIGNED_BYTE]:{[D.RGBA]:t.RGBA,[D.RGB]:t.RGB,[D.ALPHA]:t.ALPHA,[D.LUMINANCE]:t.LUMINANCE,[D.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Z.UNSIGNED_SHORT_5_6_5]:{[D.RGB]:t.RGB},[Z.UNSIGNED_SHORT_4_4_4_4]:{[D.RGBA]:t.RGBA},[Z.UNSIGNED_SHORT_5_5_5_1]:{[D.RGBA]:t.RGBA}},e}class K_{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new se,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=zP(e),this.samplerTypes=GP(e);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new hh(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new hh(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,r=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:r,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}ensureSamplerType(e){const{boundTextures:r,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let s=e-1;s>=0;--s){const o=r[s];o&&o._glTextures[i].samplerType!==G.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const r=new hh(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){var n;r.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,r.samplerType=this.samplerTypes[r.internalFormat]??G.FLOAT,this.webGLVersion===2&&e.type===Z.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){var i;const r=e._glTextures[this.CONTEXT_UID];if(!r)return;const n=this.renderer;if(this.initTextureType(e,r),(i=e.resource)==null?void 0:i.upload(n,e,r))r.samplerType!==G.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=n.gl;(r.width!==s||r.height!==o||r.dirtyId<0)&&(r.width=s,r.height=o,a.texImage2D(e.target,0,r.internalFormat,s,o,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(e);i!==-1&&vs(this.managedTextures,i,1)}}updateTextureStyle(e){var n;const r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===Mr.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=Dn.CLAMP:r.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){const n=this.gl;if(r.mipmap&&e.mipmap!==Mr.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Hr.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===Hr.LINEAR){const s=Math.min(e.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Hr.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===Hr.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}K_.extension={type:U.RendererSystem,name:"texture"};X.add(K_);class q_{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){const{gl:n,renderer:i}=this;r&&i.shader.bind(r),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:r,renderer:n,CONTEXT_UID:i}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[i]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(n.buffer.update(a),a._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){const n=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&s.dispose(a,r))}n&&(r||i.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}q_.extension={type:U.RendererSystem,name:"transformFeedback"};X.add(q_);class du{constructor(e){this.renderer=e}init(e){this.screen=new ae(0,0,e.width,e.height),this.element=e.view||z.ADAPTER.createCanvas(),this.resolution=e.resolution||z.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var r;e&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}du.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},du.extension={type:[U.RendererSystem,U.CanvasRendererSystem],name:"_view"};X.add(du);z.PREFER_ENV=Ti.WEBGL2;z.STRICT_TEXTURE_CACHE=!1;z.RENDER_OPTIONS={...cu.defaultOptions,...uu.defaultOptions,...du.defaultOptions,...hu.defaultOptions};Object.defineProperties(z,{WRAP_MODE:{get(){return se.defaultOptions.wrapMode},set(t){he("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),se.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return se.defaultOptions.scaleMode},set(t){he("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),se.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return se.defaultOptions.mipmap},set(t){he("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),se.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return se.defaultOptions.anisotropicLevel},set(t){he("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),se.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return he("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),yt.defaultResolution},set(t){yt.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return he("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),yt.defaultMultisample},set(t){yt.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return ei.defaultMaxTextures},set(t){he("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ei.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return ei.defaultBatchSize},set(t){he("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ei.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return ei.canUploadSameBuffer},set(t){he("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ei.canUploadSameBuffer=t}},GC_MODE:{get(){return ti.defaultMode},set(t){he("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ti.defaultMode=t}},GC_MAX_IDLE:{get(){return ti.defaultMaxIdle},set(t){he("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ti.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return ti.defaultCheckCountMax},set(t){he("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ti.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Vr.defaultVertexPrecision},set(t){he("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Vr.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Vr.defaultFragmentPrecision},set(t){he("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Vr.defaultFragmentPrecision=t}}});var xi=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(xi||{});class dh{constructor(e,r=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=n,this.once=i}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const Z_=class Mt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new dh(null,null,1/0),this.deltaMS=1/Mt.targetFPMS,this.elapsedMS=1/Mt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=xi.NORMAL){return this._addListener(new dh(e,r,n))}addOnce(e,r,n=xi.NORMAL){return this._addListener(new dh(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*Mt.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,Mt.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!Mt._shared){const e=Mt._shared=new Mt;e.autoStart=!0,e._protected=!0}return Mt._shared}static get system(){if(!Mt._system){const e=Mt._system=new Mt;e.autoStart=!0,e._protected=!0}return Mt._system}};Z_.targetFPMS=.06;let Nt=Z_;Object.defineProperties(z,{TARGET_FPMS:{get(){return Nt.targetFPMS},set(t){he("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Nt.targetFPMS=t}}});class Q_{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,xi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Nt.shared:new Nt,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}Q_.extension=U.Application;X.add(Q_);const J_=[];X.handleByList(U.Renderer,J_);function HP(t){for(const e of J_)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var $P=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,WP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const VP=$P,e1=WP;class t1{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}r>=We.HIGH?this.multisample=We.HIGH:r>=We.MEDIUM?this.multisample=We.MEDIUM:r>=We.LOW?this.multisample=We.LOW:this.multisample=We.NONE}destroy(){}}t1.extension={type:U.RendererSystem,name:"_multisample"};X.add(t1);class XP{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class r1{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);r.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[r]=e,n.bindBufferBase(n.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,n){const{gl:i,CONTEXT_UID:s}=this;n=n||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,o.buffer,n*256,256)}update(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{const s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),n&&(r||i.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const r=Object.keys(this.managedBuffers);for(let n=0;n<r.length;n++)this.dispose(this.managedBuffers[r[n]],e)}createGLBuffer(e){const{CONTEXT_UID:r,gl:n}=this;return e._glBuffers[r]=new XP(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}}r1.extension={type:U.RendererSystem,name:"buffer"};X.add(r1);class n1{constructor(e){this.renderer=e}render(e,r){const n=this.renderer;let i,s,o,a;if(r&&(i=r.renderTexture,s=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=o,!n.context.isLost){if(i||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(s??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),i&&(r.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}n1.extension={type:U.RendererSystem,name:"objectRenderer"};X.add(n1);const Tl=class qd extends jP{constructor(e){super(),this.type=Lx.WEBGL,e=Object.assign({},z.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ur({projectionMatrix:new Pe},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:qd.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in e&&(he("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=qd.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:gR()}render(e,r){this.objectRenderer.render(e,r)}resize(e,r){this._view.resizeView(e,r)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return he("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return he("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return he("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return he("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){he("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return he("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){he("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return he("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,r){return this.textureGenerator.generateTexture(e,r)}};Tl.extension={type:U.Renderer,priority:1},Tl.__plugins={},Tl.__systems={};let Rp=Tl;X.handleByMap(U.RendererPlugin,Rp.__plugins);X.handleByMap(U.RendererSystem,Rp.__systems);X.add(Rp);class i1 extends Jo{constructor(e,r){const{width:n,height:i}=r||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new se;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof Jo?this.addResourceAt(e[n],n):this.addResourceAt(E_(e[n],r),n))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(e).then(()=>{const{realWidth:r,realHeight:n}=this.items[0];return this.resize(r,n),this.update(),Promise.resolve(this)}),this._load}}class YP extends i1{constructor(e,r){const{width:n,height:i}=r||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:n,height:i}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=ms.TEXTURE_2D_ARRAY}upload(e,r,n){const{length:i,itemDirtyIds:s,items:o}=this,{gl:a}=e;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,r.format,n.type,null);for(let l=0;l<i;l++){const u=o[l];s[l]<u.dirtyId&&(s[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,r.format,n.type,u.resource.source))}return!0}}class KP extends en{constructor(e){super(e)}static test(e){const{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const s1=class co extends i1{constructor(e,r){const{width:n,height:i,autoLoad:s,linkBaseTexture:o}=r||{};if(e&&e.length!==co.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:n,height:i});for(let a=0;a<co.SIDES;a++)this.items[a].target=ms.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,r),s!==!1&&this.load()}bind(e){super.bind(e),e.target=ms.TEXTURE_CUBE_MAP}addBaseTextureAt(e,r,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[r])throw new Error(`Index ${r} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=ms.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this}upload(e,r,n){const i=this.itemDirtyIds;for(let s=0;s<co.SIDES;s++){const o=this.items[s];(i[s]<o.dirtyId||n.dirtyId<r.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===co.SIDES}};s1.SIDES=6;let qP=s1;class ls extends en{constructor(e,r){r=r||{};let n,i,s;typeof e=="string"?(n=ls.EMPTY,i=e,s=!0):(n=e,i=null,s=!1),super(n),this.url=i,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.ownsImageBitmap=r.ownsImageBitmap??s,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{const n=await z.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===bt.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(n){if(this.destroyed)return;r(n),this.onError.emit(n)}}),this._load)}upload(e,r,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return ls._EMPTY=ls._EMPTY??z.ADAPTER.createCanvas(0,0),ls._EMPTY}}const Zd=class bl extends en{constructor(e,r){r=r||{},super(z.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},bl.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;en.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=r=>{this._resolve&&(e.onerror=null,this.onError.emit(r))},e.onload=()=>{if(!this._resolve)return;const r=e.width,n=e.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=r*this.scale,s=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/n*r,s=this._overrideHeight||this._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);const o=this.source;o.width=i,o.height=s,o._pixiId=`canvas_${vi()}`,o.getContext("2d").drawImage(e,0,0,r,n,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){const r=bl.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,r){return r==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&bl.SVG_XML.test(e)}};Zd.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Zd.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Qd=Zd;class ZP extends en{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const Jd=class ef extends en{constructor(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){const n=document.createElement("video");r.autoLoad!==!1&&n.setAttribute("preload","auto"),r.playsinline!==!1&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),r.muted===!0&&(n.setAttribute("muted",""),n.muted=!0),r.loop===!0&&n.setAttribute("loop",""),r.autoPlay!==!1&&n.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];en.crossOrigin(n,i,r.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const u=a.split("?").shift().toLowerCase(),c=u.slice(u.lastIndexOf(".")+1);l=l||ef.MIME_TYPES[c]||`video/${c}`}o.src=a,l&&(o.type=l),n.appendChild(o)}e=n}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=r.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),r.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const r=Nt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((r,n)=>{this.valid?r(this):(this._resolve=r,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const r=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!r&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Nt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Nt.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Nt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,r){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||ef.TYPES.includes(r)}};Jd.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Jd.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let o1=Jd;jd.push(ls,M_,KP,o1,ZP,Qd,$u,qP,YP);class fu{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?ae.EMPTY:(e=e||new ae(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){const{a:n,b:i,c:s,d:o,tx:a,ty:l}=e,u=n*r.x+s*r.y+a,c=i*r.x+o*r.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(e){let r=this.minX,n=this.minY,i=this.maxX,s=this.maxY,o=e[0],a=e[1];r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[2],a=e[3],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[4],a=e[5],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[6],a=e[7],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,this.minX=r,this.minY=n,this.maxX=i,this.maxY=s}addFrame(e,r,n,i,s){this.addFrameMatrix(e.worldTransform,r,n,i,s)}addFrameMatrix(e,r,n,i,s){const o=e.a,a=e.b,l=e.c,u=e.d,c=e.tx,h=e.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,x=o*r+l*n+c,y=a*r+u*n+h;d=x<d?x:d,f=y<f?y:f,p=x>p?x:p,m=y>m?y:m,x=o*i+l*n+c,y=a*i+u*n+h,d=x<d?x:d,f=y<f?y:f,p=x>p?x:p,m=y>m?y:m,x=o*r+l*s+c,y=a*r+u*s+h,d=x<d?x:d,f=y<f?y:f,p=x>p?x:p,m=y>m?y:m,x=o*i+l*s+c,y=a*i+u*s+h,d=x<d?x:d,f=y<f?y:f,p=x>p?x:p,m=y>m?y:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addVertexData(e,r,n){let i=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=r;l<n;l+=2){const u=e[l],c=e[l+1];i=u<i?u:i,s=c<s?c:s,o=u>o?u:o,a=c>a?c:a}this.minX=i,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,r,n,i){this.addVerticesMatrix(e.worldTransform,r,n,i)}addVerticesMatrix(e,r,n,i,s=0,o=s){const a=e.a,l=e.b,u=e.c,c=e.d,h=e.tx,d=e.ty;let f=this.minX,p=this.minY,m=this.maxX,x=this.maxY;for(let y=n;y<i;y+=2){const v=r[y],g=r[y+1],w=a*v+u*g+h,S=c*g+l*v+d;f=Math.min(f,w-s),m=Math.max(m,w+s),p=Math.min(p,S-o),x=Math.max(x,S+o)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=x}addBounds(e){const r=this.minX,n=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,r){const n=e.minX>r.minX?e.minX:r.minX,i=e.minY>r.minY?e.minY:r.minY,s=e.maxX<r.maxX?e.maxX:r.maxX,o=e.maxY<r.maxY?e.maxY:r.maxY;if(n<=s&&i<=o){const a=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=n<a?n:a,this.minY=i<l?i:l,this.maxX=s>u?s:u,this.maxY=o>c?o:c}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){const n=e.minX>r.x?e.minX:r.x,i=e.minY>r.y?e.minY:r.y,s=e.maxX<r.x+r.width?e.maxX:r.x+r.width,o=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(n<=s&&i<=o){const a=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=n<a?n:a,this.minY=i<l?i:l,this.maxX=s>u?s:u,this.maxY=o>c?o:c}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,n,i,s,o){e-=s,r-=o,n+=s,i+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class Ue extends aa{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Ap,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new fu,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.defineProperty(Ue.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new ae),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new ae),e=this._localBoundsRect),this._localBounds||(this._localBounds=new fu);const r=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(n==null?void 0:n.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=n,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,n,i){return r&&(e=r.toGlobal(e,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,r=0,n=1,i=1,s=0,o=0,a=0,l=0,u=0){return this.position.x=e,this.position.y=r,this.scale.x=n||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new QP),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*$R}set angle(e){this.transform.rotation=e*WR}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class QP extends Ue{constructor(){super(...arguments),this.sortDirty=null}}Ue.prototype.displayObjectUpdateTransform=Ue.prototype.updateTransform;const JP=new Pe;function eI(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const a1=class tf extends Ue{constructor(){super(),this.children=[],this.sortableChildren=tf.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.addChild(e[r]);else{const r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]}addChildAt(e,r){if(r<0||r>this.children.length)throw new Error(`${e}addChildAt: The index ${r} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e}swapChildren(e,r){if(e===r)return;const n=this.getChildIndex(e),i=this.getChildIndex(r);this.children[n]=r,this.children[i]=e,this.onChildrenChange(n<i?n:i)}getChildIndex(e){const r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r}setChildIndex(e,r){if(r<0||r>=this.children.length)throw new Error(`The index ${r} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(e);vs(this.children,n,1),this.children.splice(r,0,e),this.onChildrenChange(r)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.removeChild(e[r]);else{const r=e[0],n=this.children.indexOf(r);if(n===-1)return null;r.parent=null,r.transform._parentID=-1,vs(this.children,n,1),this._boundsID++,this.onChildrenChange(n),r.emit("removed",this),this.emit("childRemoved",r,this,n)}return e[0]}removeChildAt(e){const r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,vs(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r}removeChildren(e=0,r=this.children.length){const n=e,i=r,s=i-n;let o;if(s>0&&s<=i){o=this.children.splice(n,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let r=0,n=this.children.length;r<n;++r){const i=this.children[r];i._lastSortedIndex=r,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(eI),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,r=this.children.length;e<r;++e){const n=this.children[e];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const r=this.children[e];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){const n=r._mask.isMaskData?r._mask.maskObject:r._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,r=!1){const n=super.getLocalBounds(e);if(!r)for(let i=0,s=this.children.length;i<s;++i){const o=this.children[i];o.visible&&o.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const r=e.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==tf.prototype._render&&(n=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=JP.copyFrom(i),i.prepend(s)):i=s),n&&r.intersects(n,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],u=l.cullable;l.cullable=u||!this.cullArea,l.render(e),l.cullable=u}}render(e){var r;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(r=this.filters)!=null&&r.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,i=this.children.length;n<i;++n)this.children[n].render(e)}}renderAdvanced(e){var s,o,a;const r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<r.length;l++)r[l].enabled&&this._enabledFilters.push(r[l])}const i=r&&((s=this._enabledFilters)==null?void 0:s.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==qe.NONE));if(i&&e.batch.flush(),r&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,u=this.children.length;l<u;++l)this.children[l].render(e)}i&&e.batch.flush(),n&&e.mask.pop(this),r&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const r=typeof e=="boolean"?e:e==null?void 0:e.children,n=this.removeChildren(0,this.children.length);if(r)for(let i=0;i<n.length;++i)n[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const r=this.getLocalBounds().width;r!==0?this.scale.x=e/r:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const r=this.getLocalBounds().height;r!==0?this.scale.y=e/r:this.scale.y=1,this._height=e}};a1.defaultSortableChildren=!1;let It=a1;It.prototype.containerUpdateTransform=It.prototype.updateTransform;Object.defineProperties(z,{SORTABLE_CHILDREN:{get(){return It.defaultSortableChildren},set(t){he("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),It.defaultSortableChildren=t}}});const ro=new me,tI=new Uint16Array([0,1,2,0,2,3]);class Ci extends It{constructor(e){super(),this._anchor=new Wr(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Ce(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=ee.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||V.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=tI,this.pluginName="batch",this.isSprite=!0,this._roundPixels=z.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Tn(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Tn(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,u=this.vertexData,c=e.trim,h=e.orig,d=this._anchor;let f=0,p=0,m=0,x=0;if(c?(p=c.x-d._x*h.width,f=p+c.width,x=c.y-d._y*h.height,m=x+c.height):(p=-d._x*h.width,f=p+h.width,x=-d._y*h.height,m=x+h.height),u[0]=n*p+s*x+a,u[1]=o*x+i*p+l,u[2]=n*f+s*x+a,u[3]=o*x+i*f+l,u[4]=n*f+s*m+a,u[5]=o*m+i*f+l,u[6]=n*p+s*m+a,u[7]=o*m+i*p+l,this._roundPixels){const y=z.RESOLUTION;for(let v=0;v<u.length;++v)u[v]=Math.round(u[v]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,r=this.vertexTrimmedData,n=e.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,u=s.d,c=s.tx,h=s.ty,d=-i._x*n.width,f=d+n.width,p=-i._y*n.height,m=p+n.height;if(r[0]=o*d+l*p+c,r[1]=u*p+a*d+h,r[2]=o*f+l*p+c,r[3]=u*p+a*f+h,r[4]=o*f+l*m+c,r[5]=u*m+a*f+h,r[6]=o*d+l*m+c,r[7]=u*m+a*d+h,this._roundPixels){const x=z.RESOLUTION;for(let y=0;y<r.length;++y)r[y]=Math.round(r[y]*x)/x}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new fu),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new ae),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,ro);const r=this._texture.orig.width,n=this._texture.orig.height,i=-r*this.anchor.x;let s=0;return ro.x>=i&&ro.x<i+r&&(s=-n*this.anchor.y,ro.y>=s&&ro.y<s+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const r=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(e,r){const n=e instanceof V?e:V.from(e,r);return new Ci(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const r=Tn(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const r=Tn(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||V.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const l1=new Pe;Ue.prototype._cacheAsBitmap=!1;Ue.prototype._cacheData=null;Ue.prototype._cacheAsBitmapResolution=null;Ue.prototype._cacheAsBitmapMultisample=null;class rI{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Ue.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new rI),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});Ue.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Ue.prototype._initCachedDisplayObject=function(t){var d,f;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(new ae,!0);if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;r.pad(p)}const n=this.cacheAsBitmapResolution||t.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=Ai.create({width:r.width,height:r.height,resolution:n,multisample:this.cacheAsBitmapMultisample??t.multisample}),u=`cacheAsBitmap_${vi()}`;this._cacheData.textureCacheId=u,se.addToCache(l.baseTexture,u),V.addToCache(l,u);const c=this.transform.localTransform.copyTo(l1).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const h=new Ci(l);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(r.x/r.width),h.anchor.y=-(r.y/r.height),h.alpha=e,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h)};Ue.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Ue.prototype._initCachedDisplayObjectCanvas=function(t){var c;if((c=this._cacheData)!=null&&c.sprite)return;const e=this.getLocalBounds(new ae,!0),r=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Ai.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${vi()}`;this._cacheData.textureCacheId=a,se.addToCache(o.baseTexture,a),V.addToCache(o,a);const l=l1;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const u=new Ci(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};Ue.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Ue.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Ue.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,se.removeFromCache(this._cacheData.textureCacheId),V.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Ue.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Ue.prototype.name=null;It.prototype.getChildByName=function(t,e){for(let r=0,n=this.children.length;r<n;r++)if(this.children[r].name===t)return this.children[r];if(e)for(let r=0,n=this.children.length;r<n;r++){const i=this.children[r];if(!i.getChildByName)continue;const s=i.getChildByName(t,!0);if(s)return s}return null};Ue.prototype.getGlobalPosition=function(t=new me,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var nI=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class iI extends yt{constructor(e=1){super(VP,nI,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const sI={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},oI=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function aI(t){const e=sI[t],r=e.length;let n=oI,i="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let l=s.replace("%index%",a.toString());o=a,a>=r&&(o=t-a-1),l=l.replace("%value%",e[o].toString()),i+=l,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}const lI=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function uI(t,e){const r=Math.ceil(t/2);let n=lI,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),i+=a,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}class rf extends yt{constructor(e,r=8,n=4,i=yt.defaultResolution,s=5){const o=uI(s,e),a=aI(s);super(o,a),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=n,this.blur=r}apply(e,r,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,n,i);else{const s=e.getFilterTexture(),o=e.renderer;let a=r,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Sr.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,Sr.BLIT),this.uniforms.uSampler=l;const c=l;l=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,n,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class cI extends yt{constructor(e=8,r=4,n=yt.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new rf(!0,e,r,n,i),this.blurYFilter=new rf(!1,e,r,n,i),this.resolution=n,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,n,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,r,a,Sr.CLEAR),this.blurYFilter.apply(e,a,n,i),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,r,n,i):this.blurXFilter.apply(e,r,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var hI=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class nf extends yt{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(e1,hI,e),this.alpha=1}_loadMatrix(e,r=!1){let n=e;r&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,r,n){return e[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],e[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],e[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],e[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],e[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],e[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],e[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],e[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],e[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],e[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],e[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],e[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],e[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],e[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],e[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],e[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],e[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],e[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],e[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],e[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],e}_colorMatrix(e){const r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(e,r){const[n,i,s]=Ce.shared.setValue(e).toArray(),o=[n,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(e,r){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(e){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;const n=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=n+(1-n)*o,u=o*(1-n)-a*i,c=o*(1-n)+a*i,h=o*(1-n)+a*i,d=n+o*(1-n),f=o*(1-n)-a*i,p=o*(1-n)-a*i,m=o*(1-n)+a*i,x=n+o*(1-n),y=[l,u,c,0,0,h,d,f,0,0,p,m,x,0,0,0,0,0,1,0];this._loadMatrix(y,r)}contrast(e,r){const n=(e||0)+1,i=-.5*(n-1),s=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(s,r)}saturate(e=0,r){const n=e*2/3+1,i=(n-1)*-.5,s=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(e){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,n,i,s){e=e||.2,r=r||.15,n=n||16770432,i=i||3375104;const o=Ce.shared,[a,l,u]=o.setValue(n).toArray(),[c,h,d]=o.setValue(i).toArray(),f=[.3,.59,.11,0,0,a,l,u,e,0,c,h,d,r,0,a-c,l-h,u-d,0,0];this._loadMatrix(f,s)}night(e,r){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(e,r){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,r)}lsd(e){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}nf.prototype.grayscale=nf.prototype.greyscale;var dI=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,fI=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class pI extends yt{constructor(e,r){const n=new Pe;e.renderable=!1,super(fI,dI,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,r==null&&(r=20),this.scale=new me(r,r)}apply(e,r,n,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,r,n,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var mI=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,gI=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class yI extends yt{constructor(){super(gI,mI)}}var vI=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class xI extends yt{constructor(e=.5,r=Math.random()){super(e1,vI,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const My={AlphaFilter:iI,BlurFilter:cI,BlurFilterPass:rf,ColorMatrixFilter:nf,DisplacementFilter:pI,FXAAFilter:yI,NoiseFilter:xI};Object.entries(My).forEach(([t,e])=>{Object.defineProperty(My,t,{get(){return he("7.1.0",`filters.${t} has moved to ${t}`),e}})});class _I{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(Nt.system.add(this.tickerUpdate,this,xi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Nt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const xn=new _I;class ha{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ha.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new me,this.page=new me,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,n,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class pu extends ha{constructor(){super(...arguments),this.client=new me,this.movement=new me,this.offset=new me,this.global=new me,this.screen=new me}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,r,n){return e.worldTransform.applyInverse(n||this.global,r)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,n,i,s,o,a,l,u,c,h,d,f,p,m){throw new Error("Method not implemented.")}}class tr extends pu{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class _s extends pu{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}_s.DOM_DELTA_PIXEL=0,_s.DOM_DELTA_LINE=1,_s.DOM_DELTA_PAGE=2;const wI=2048,EI=new me,fh=new me;class SI{constructor(e){this.dispatch=new aa,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const r=this.mappingTable[e.type];if(r)for(let n=0,i=r.length;n<i;n++)r[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){xn.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[n](this.rootTarget,this.rootTarget.eventMode,EI.set(e,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,r){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=n.length-1;i<s;i++)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(r)?r:[r];for(let s=n.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=n[s],this.notifyTarget(e,o)})}propagationPath(e){const r=[e];for(let n=0;n<wI&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestMoveRecursive(e,r,n,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(xn.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let h=c.length-1;h>=0;h--){const d=c[h],f=this.hitTestMoveRecursive(d,this._isInteractive(r)?r:d.eventMode,n,i,s,o||s(e,n));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(e),f.push(e)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const l=this._isInteractive(r),u=e.isInteractive();return l&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,n)&&i(e,n)?u?[e]:[]:null}hitTestRecursive(e,r,n,i,s){if(this._interactivePrune(e)||s(e,n))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(xn.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let u=l.length-1;u>=0;u--){const c=l[u],h=this.hitTestRecursive(c,this._isInteractive(r)?r:c.eventMode,n,i,s);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const d=e.isInteractive();return(h.length>0||d)&&h.push(e),h}}}const o=this._isInteractive(r),a=e.isInteractive();return o&&i(e,n)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,r){var n;if(e.hitArea&&(e.worldTransform.applyInverse(r,fh),!e.hitArea.contains(fh.x,fh.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,r)))return!0}return!1}hitTestFn(e,r){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){var s,o;r=r??e.type;const n=`on${r}`;(o=(s=e.currentTarget)[n])==null||o.call(s,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof tr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){var l,u;if(!(e instanceof tr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(((l=i.overTargets)==null?void 0:l.length)>0&&s!==r.target){const c=e.type==="mousemove"?"mouseout":"pointerout",h=this.createPointerEvent(e,c,s);if(this.dispatchEvent(h,"pointerout"),n&&this.dispatchEvent(h,"mouseout"),!r.composedPath().includes(s)){const d=this.createPointerEvent(e,"pointerleave",s);for(d.eventPhase=d.AT_TARGET;d.target&&!r.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),n&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(h)}if(s!==r.target){const c=e.type==="mousemove"?"mouseover":"pointerover",h=this.clonePointerEvent(r,c);this.dispatchEvent(h,"pointerover"),n&&this.dispatchEvent(h,"mouseover");let d=s==null?void 0:s.parent;for(;d&&d!==this.rootTarget.parent&&d!==r.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const f=this.clonePointerEvent(r,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==s&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),n&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(h)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),n&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=r.target)==null?void 0:u.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){var o;if(!(e instanceof tr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(o=n.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(n,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof tr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId);if(r.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),n&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof tr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const a=n.button===2;this.dispatchEvent(n,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!n.composedPath().includes(s)){let a=s;for(;a&&!n.composedPath().includes(a);){if(n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.notifyTarget(n,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(n,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:r});const l=i.clicksByButton[e.button];if(l.target===a.target&&r-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=r,a.detail=l.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof tr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let s=n;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof _s)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let n=1;n<e.length&&e[n].parent===r;n++)r=e[n];return r}createPointerEvent(e,r,n){const i=this.allocateEvent(tr);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof r=="string"&&(i.type=r),i}createWheelEvent(e){const r=this.allocateEvent(_s);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){const n=this.allocateEvent(tr);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=r??n.type,n}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof tr&&r instanceof tr&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof pu&&r instanceof pu&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.shiftKey=e.shiftKey,r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){const n=e.currentTarget._events[r];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(r,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let i=0,s=n.length;i<s&&!e.propagationImmediatelyStopped;i++)n[i].once&&e.currentTarget.removeListener(r,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,e)}}const TI=1,bI={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},sf=class of{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new SI(null),xn.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new tr(null),this.rootWheelEvent=new _s(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...of.defaultEventFeatures},{set:(r,n,i)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),r[n]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,of._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=r.length;n<i;n++){const s=r[n],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,xn.pointerMoved();const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let r=e.target;e.composedPath&&e.composedPath().length>0&&(r=e.composedPath()[0]);const n=r!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,i[s]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const r=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(e){this.removeEvents(),this.domElement=e,xn.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;xn.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;xn.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,r,n){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(r-i.left)*(this.domElement.width/i.width)*s,e.y=(n-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){const r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const s=e.changedTouches[n];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,r.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=TI),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(e);return r}normalizeWheelEvent(e){const r=this.rootWheelEvent;return this.transferMouseData(r,e),r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ,r.deltaMode=e.deltaMode,this.mapPositionToPoint(r.screen,e.clientX,e.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=e,r.type=e.type,r}bootstrapEvent(e,r){return e.originalEvent=null,e.nativeEvent=r,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r),this.mapPositionToPoint(e.screen,r.clientX,r.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=r.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=bI[e.type]||e.type),e}transferMouseData(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=performance.now(),e.type=r.type,e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.relatedTarget=null,e.shiftKey=r.shiftKey}};sf.extension={name:"events",type:[U.RendererSystem,U.CanvasRendererSystem]},sf.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let af=sf;X.add(af);function ky(t){return t==="dynamic"||t==="static"}const AI={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??ky(af.defaultEventMode)},set interactive(t){he("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??af.defaultEventMode},set eventMode(t){this._internalInteractive=ky(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof r=="object"?r.signal:void 0,s=typeof r=="object"?r.once===!0:!1,o=typeof e=="function"?void 0:e;t=n?`${t}capture`:t;const a=typeof e=="function"?e:e.handleEvent,l=this;i&&i.addEventListener("abort",()=>{l.off(t,a,o)}),s?l.once(t,a,o):l.on(t,a,o)},removeEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof ha))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};Ue.mixin(AI);const CI={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Ue.mixin(CI);const RI=9,Va=100,PI=0,II=0,By=2,Ny=1,MI=-1e3,kI=-1e3,BI=2;class u1{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,($r.tablet||$r.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${Va}px`,r.style.height=`${Va}px`,r.style.position="absolute",r.style.top=`${PI}px`,r.style.left=`${II}px`,r.style.zIndex=By.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${Ny}px`,e.style.height=`${Ny}px`,e.style.position="absolute",e.style.top=`${MI}px`,e.style.left=`${kI}px`,e.style.zIndex=BI.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const r=e.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const e=performance.now();if($r.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,u=i/o*l,c=s/a*l;let h=this.div;h.style.left=`${r}px`,h.style.top=`${n}px`,h.style.width=`${o}px`,h.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,vs(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{h=f._accessibleDiv;let p=f.hitArea;const m=f.worldTransform;f.hitArea?(h.style.left=`${(m.tx+p.x*m.a)*u}px`,h.style.top=`${(m.ty+p.y*m.d)*c}px`,h.style.width=`${p.width*m.a*u}px`,h.style.height=`${p.height*m.d*c}px`):(p=f.getBounds(),this.capHitArea(p),h.style.left=`${p.x*u}px`,h.style.top=`${p.y*c}px`,h.style.width=`${p.width*u}px`,h.style.height=`${p.height*c}px`,h.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(h.title=f.accessibleTitle),h.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&h.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==h.title||f.tabIndex!==h.tabIndex)&&(h.title=f.accessibleTitle,h.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:r,height:n}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${Va}px`,r.style.height=`${Va}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=By.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){const{displayObject:n}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new ha(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===RI&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}u1.extension={name:"accessibility",type:[U.RendererPlugin,U.CanvasRendererPlugin]};X.add(u1);const c1=class lf{constructor(e){this.stage=new It,e=Object.assign({forceCanvas:!1},e),this.renderer=HP(e),lf._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,r){const n=lf._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};c1._plugins=[];let h1=c1;X.handleByList(U.Application,h1._plugins);class d1{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;r=i,n=s}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}d1.extension=U.Application;X.add(d1);const Dy={loader:U.LoadParser,resolver:U.ResolveParser,cache:U.CacheParser,detection:U.DetectionParser};X.handle(U.Asset,t=>{const e=t.ref;Object.entries(Dy).filter(([r])=>!!e[r]).forEach(([r,n])=>X.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(Dy).filter(r=>!!e[r]).forEach(r=>X.remove(e[r]))});class NI{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Us(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function $n(t,e){const r=t.split("?")[0],n=it.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const sr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t),uf=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t};function f1(t,e,r,n,i){const s=e[r];for(let o=0;o<s.length;o++){const a=s[o];r<e.length-1?f1(t.replace(n[r],a),e,r+1,n,i):i.push(t.replace(n[r],a))}}function DI(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const i=[];r.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),f1(t,i,0,r,n)}else n.push(t);return n}const mu=t=>!Array.isArray(t);class FI{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=sr(e);let i;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(r)){i=l.getCacheableAssets(n,r);break}}i||(i={},n.forEach(a=>{i[a]=r}));const s=Object.keys(i),o={cacheKeys:s,keys:n};if(n.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{const l=i?i[a]:r;this._cache.has(a)&&this._cache.get(a)!==l&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),r instanceof V){const a=r;n.forEach(l=>{a.baseTexture!==V.EMPTY.baseTexture&&se.addToCache(a.baseTexture,l),V.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const ni=new FI;class OI{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{var o,a;let i=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.load&&((o=u.test)!=null&&o.call(u,e,r,this))){s=u;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,r,this),n.parser=s;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,i,r,this))&&(i=await u.parse(i,r,this)||i,n.parser=u)}return i})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const i={},s=mu(e),o=sr(e,u=>({alias:[u],src:u})),a=o.length,l=o.map(async u=>{const c=it.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,u)),i[u.src]=await this.promiseCache[c].promise,r&&r(++n/a)}catch(h){throw delete this.promiseCache[c],delete i[u.src],new Error(`[Loader.load] Failed to load ${c}.
${h}`)}});return await Promise.all(l),s?i[o[0].src]:i}async unload(e){const r=sr(e,n=>({alias:[n],src:n})).map(async n=>{var o,a;const i=it.toAbsolute(n.src),s=this.promiseCache[i];if(s){const l=await s.promise;delete this.promiseCache[i],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,n,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(e[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...e,[r.name]:r}),{})}}var dr=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(dr||{});const LI=".json",UI="application/json",jI={extension:{type:U.LoadParser,priority:dr.Low},name:"loadJson",test(t){return Us(t,UI)||$n(t,LI)},async load(t){return await(await z.ADAPTER.fetch(t)).json()}};X.add(jI);const GI=".txt",zI="text/plain",HI={name:"loadTxt",extension:{type:U.LoadParser,priority:dr.Low},test(t){return Us(t,zI)||$n(t,GI)},async load(t){return await(await z.ADAPTER.fetch(t)).text()}};X.add(HI);const $I=["normal","bold","100","200","300","400","500","600","700","800","900"],WI=[".ttf",".otf",".woff",".woff2"],VI=["font/ttf","font/otf","font/woff","font/woff2"],XI=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function YI(t){const e=it.extname(t),r=it.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let n=r.length>0;for(const s of r)if(!s.match(XI)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const KI=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function qI(t){return KI.test(t)?t:encodeURI(t)}const ZI={extension:{type:U.LoadParser,priority:dr.Low},name:"loadWebFont",test(t){return Us(t,VI)||$n(t,WI)},async load(t,e){var n,i,s;const r=z.ADAPTER.getFontFaceSet();if(r){const o=[],a=((n=e.data)==null?void 0:n.family)??YI(t),l=((s=(i=e.data)==null?void 0:i.weights)==null?void 0:s.filter(c=>$I.includes(c)))??["normal"],u=e.data??{};for(let c=0;c<l.length;c++){const h=l[c],d=new FontFace(a,`url(${qI(t)})`,{...u,weight:h});await d.load(),r.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>z.ADAPTER.getFontFaceSet().delete(e))}};X.add(ZI);const QI=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let ws=null,cf=class{constructor(){ws||(ws=URL.createObjectURL(new Blob([QI],{type:"application/javascript"}))),this.worker=new Worker(ws)}};cf.revokeObjectURL=function(){ws&&(URL.revokeObjectURL(ws),ws=null)};const JI=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Es=null;class p1{constructor(){Es||(Es=URL.createObjectURL(new Blob([JI],{type:"application/javascript"}))),this.worker=new Worker(Es)}}p1.revokeObjectURL=function(){Es&&(URL.revokeObjectURL(Es),Es=null)};let Fy=0,ph;class e2{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new cf;r.addEventListener("message",n=>{r.terminate(),cf.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){ph===void 0&&(ph=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<ph&&(this._createdWorkers++,e=new p1().worker,e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((i,s)=>{this.queue.push({id:e,arguments:r,resolve:i,reject:s})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const r=this.queue.pop(),n=r.id;this.resolveHash[Fy]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:Fy++,id:n})}}const Oy=new e2;function da(t,e,r){t.resource.internal=!0;const n=new V(t),i=()=>{delete e.promiseCache[r],ni.has(r)&&ni.remove(r)};return n.baseTexture.once("destroyed",()=>{r in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),n.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const t2=[".jpeg",".jpg",".png",".webp",".avif"],r2=["image/jpeg","image/png","image/webp","image/avif"];async function n2(t){const e=await z.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}const Ku={name:"loadTextures",extension:{type:U.LoadParser,priority:dr.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Us(t,r2)||$n(t,t2)},async load(t,e,r){var a;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;n?this.config.preferWorkers&&await Oy.isImageBitmapSupported()?i=await Oy.loadImageBitmap(t):i=await n2(t):i=await new Promise((l,u)=>{const c=new Image;c.crossOrigin=this.config.crossOrigin,c.src=t,c.complete?l(c):(c.onload=()=>l(c),c.onerror=h=>u(h))});const s={...e.data};s.resolution??(s.resolution=Jr(t)),n&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new se(i,s);return o.resource.src=t,da(o,r,t)},unload(t){t.destroy(!0)}};X.add(Ku);const i2=".svg",s2="image/svg+xml",o2={extension:{type:U.LoadParser,priority:dr.High},name:"loadSVG",test(t){return Us(t,s2)||$n(t,i2)},async testParse(t){return Qd.test(t)},async parse(t,e,r){var s;const n=new Qd(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await n.load();const i=new se(n,{resolution:Jr(t),...e==null?void 0:e.data});return i.resource.src=e.src,da(i,r,e.src)},async load(t,e){return(await z.ADAPTER.fetch(t)).text()},unload:Ku.unload};X.add(o2);const a2=[".mp4",".m4v",".webm",".ogv"],l2=["video/mp4","video/webm","video/ogg"],u2={name:"loadVideo",extension:{type:U.LoadParser,priority:dr.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return Us(t,l2)||$n(t,a2)},async load(t,e,r){var o;let n;const i=await(await z.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},l=new o1(s,a);await l.load();const u=new se(l,{alphaMode:await mR(),resolution:Jr(t),...e==null?void 0:e.data});u.resource.src=t,n=da(u,r,t),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return n},unload(t){t.destroy(!0)}};X.add(u2);class c2{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,name:n,src:i,srcs:s}=e;return sr(r||n||i||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];Array.isArray(r)?r.forEach(i=>{const s=i.src??i.srcs,o=i.alias??i.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);n.push(l),a=[o,l]}else{const l=o.map(u=>this._createBundleAssetId(e,u));n.push(...l),a=[...o,...l]}this.add({...i,alias:a,src:s})}):Object.keys(r).forEach(i=>{const s=[i,this._createBundleAssetId(e,i)];if(typeof r[i]=="string")this.add({alias:s,src:r[i]});else if(Array.isArray(r[i]))this.add({alias:s,src:r[i]});else{const o=r[i],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}n.push(...s)}),this._bundles[e]=n}add(e,r,n,i,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(he("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:r,data:n,format:i,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},sr(o).forEach(l=>{const{src:u,srcs:c}=l;let{data:h,format:d,loadParser:f}=l;const p=sr(u||c).map(y=>typeof y=="string"?DI(y):Array.isArray(y)?y:[y]),m=this.getAlias(l);Array.isArray(m)?m.forEach(a):a(m);const x=[];p.forEach(y=>{y.forEach(v=>{let g={};if(typeof v!="object"){g.src=v;for(let w=0;w<this._parsers.length;w++){const S=this._parsers[w];if(S.test(v)){g=S.parse(v);break}}}else h=v.data??h,d=v.format??d,f=v.loadParser??f,g={...g,...v};if(!m)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this.buildResolvedAsset(g,{aliases:m,data:h,format:d,loadParser:f}),x.push(g)})}),m.forEach(y=>{this._assetMap[y]=x})})}resolveBundle(e){const r=mu(e);e=sr(e);const n={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(i,l)]=u}n[i]=a}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const i in r)n[i]=r[i].src;return n}return r.src}resolve(e){const r=mu(e);e=sr(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(u=>{const c=s.filter(h=>h[l]?h[l]===u:!1);c.length&&(s=c)})}),this._resolverHash[i]=s[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}buildResolvedAsset(e,r){const{aliases:n,data:i,loadParser:s,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=it.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??it.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class h2{constructor(){this._detections=[],this._initialized=!1,this.resolver=new c2,this.loader=new OI,this.cache=ni,this._backgroundLoader=new NI(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const r=((s=e.texturePreference)==null?void 0:s.resolution)??1,n=typeof r=="number"?[r]:r,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e,r,n,i,s){this.resolver.add(e,r,n,i,s)}async load(e,r){this._initialized||await this.init();const n=mu(e),i=sr(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,r);return n?o[i[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,l=0;const u=()=>{r==null||r(++a/l)},c=o.map(h=>{const d=i[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,u).then(f=>{s[h]=f})});return await Promise.all(c),n?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return ni.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=ni.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const o={};return n.forEach((a,l)=>{const u=s[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[i[l]]=u,ni.set(c,u)}),o}async unload(e){this._initialized||await this.init();const r=sr(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=sr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{ni.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,i)=>r.indexOf(n)===i),r}get detections(){return this._detections}get preferWorkers(){return Ku.config.preferWorkers}set preferWorkers(e){he("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const Xa=new h2;X.handleByList(U.LoadParser,Xa.loader.parsers).handleByList(U.ResolveParser,Xa.resolver.parsers).handleByList(U.CacheParser,Xa.cache.parsers).handleByList(U.DetectionParser,Xa.detections);const d2={extension:U.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof V),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((i,s)=>{r[n+(s===0?"":s+1)]=i})}),r}};X.add(d2);async function m1(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const f2={extension:{type:U.DetectionParser,priority:1},test:async()=>m1("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};X.add(f2);const p2={extension:{type:U.DetectionParser,priority:0},test:async()=>m1("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};X.add(p2);const Ly=["png","jpg","jpeg"],m2={extension:{type:U.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...Ly],remove:async t=>t.filter(e=>!Ly.includes(e))};X.add(m2);const g2="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Pp(t){return g2?!1:document.createElement("video").canPlayType(t)!==""}const y2={extension:{type:U.DetectionParser,priority:0},test:async()=>Pp("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};X.add(y2);const v2={extension:{type:U.DetectionParser,priority:0},test:async()=>Pp("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};X.add(v2);const x2={extension:{type:U.DetectionParser,priority:0},test:async()=>Pp("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};X.add(x2);const _2={extension:U.ResolveParser,test:Ku.test,parse:t=>{var e;return{resolution:parseFloat(((e=z.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:it.extname(t).slice(1),src:t}}};X.add(_2);var st=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(st||{});const gu={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let vr,Vi;function Uy(){Vi={bptc:vr.getExtension("EXT_texture_compression_bptc"),astc:vr.getExtension("WEBGL_compressed_texture_astc"),etc:vr.getExtension("WEBGL_compressed_texture_etc"),s3tc:vr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:vr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:vr.getExtension("WEBGL_compressed_texture_pvrtc")||vr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:vr.getExtension("WEBGL_compressed_texture_etc1"),atc:vr.getExtension("WEBGL_compressed_texture_atc")}}const w2={extension:{type:U.DetectionParser,priority:2},test:async()=>{const t=z.ADAPTER.createCanvas().getContext("webgl");return t?(vr=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{Vi||Uy();const e=[];for(const r in Vi)Vi[r]&&e.push(r);return[...e,...t]},remove:async t=>(Vi||Uy(),t.filter(e=>!(e in Vi)))};X.add(w2);class E2 extends $u{constructor(e,r={width:1,height:1,autoLoad:!0}){let n,i;typeof e=="string"?(n=e,i=new Uint8Array):(n=null,i=e),super(i,r),this.origin=n,this.buffer=i?new Ud(i):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new Ud(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class hi extends E2{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=hi._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||hi._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,n){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:u,levelBuffer:c}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,l,u,0,c)}return!0}onBlobLoaded(){this._levelBuffers=hi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,r,n,i,s,o,a){const l=new Array(n);let u=e.byteOffset,c=o,h=a,d=c+i-1&~(i-1),f=h+s-1&~(s-1),p=d*f*gu[r];for(let m=0;m<n;m++)l[m]={levelID:m,levelWidth:n>1?c:d,levelHeight:n>1?h:f,levelBuffer:new Uint8Array(e.buffer,u,p)},u+=p,c=c>>1||1,h=h>>1||1,d=c+i-1&~(i-1),f=h+s-1&~(s-1),p=d*f*gu[r];return l}}const mh=4,Ya=124,S2=32,jy=20,T2=542327876,Ka={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},b2={FOURCC:2},qa={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},A2=1,C2=2,R2=4,P2=64,I2=512,M2=131072,k2=827611204,B2=861165636,N2=894720068,D2=808540228,F2=4,O2={[k2]:st.COMPRESSED_RGBA_S3TC_DXT1_EXT,[B2]:st.COMPRESSED_RGBA_S3TC_DXT3_EXT,[N2]:st.COMPRESSED_RGBA_S3TC_DXT5_EXT},L2={70:st.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:st.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:st.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:st.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:st.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:st.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:st.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:st.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:st.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:st.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:st.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:st.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:st.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function U2(t){const e=new Uint32Array(t);if(e[0]!==T2)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,Ya/Uint32Array.BYTES_PER_ELEMENT),n=r[Ka.HEIGHT],i=r[Ka.WIDTH],s=r[Ka.MIPMAP_COUNT],o=new Uint32Array(t,Ka.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,S2/Uint32Array.BYTES_PER_ELEMENT),a=o[A2];if(a&R2){const l=o[b2.FOURCC];if(l!==D2){const v=O2[l],g=mh+Ya,w=new Uint8Array(t,g);return[new hi(w,{format:v,width:i,height:n,levels:s})]}const u=mh+Ya,c=new Uint32Array(e.buffer,u,jy/Uint32Array.BYTES_PER_ELEMENT),h=c[qa.DXGI_FORMAT],d=c[qa.RESOURCE_DIMENSION],f=c[qa.MISC_FLAG],p=c[qa.ARRAY_SIZE],m=L2[h];if(m===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(f===F2)throw new Error("DDSParser does not support cubemap textures");if(d===6)throw new Error("DDSParser does not supported 3D texture data");const x=new Array,y=mh+Ya+jy;if(p===1)x.push(new Uint8Array(t,y));else{const v=gu[m];let g=0,w=i,S=n;for(let b=0;b<s;b++){const E=Math.max(1,w+3&-4),R=Math.max(1,S+3&-4),M=E*R*v;g+=M,w=w>>>1,S=S>>>1}let C=y;for(let b=0;b<p;b++)x.push(new Uint8Array(t,C,g)),C+=g}return x.map(v=>new hi(v,{format:m,width:i,height:n,levels:s}))}throw a&P2?new Error("DDSParser does not support uncompressed texture data."):a&I2?new Error("DDSParser does not supported YUV uncompressed texture data."):a&M2?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&C2?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Gy=[171,75,84,88,32,49,49,187,13,10,26,10],j2=67305985,Jt={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},hf=64,zy={[Z.UNSIGNED_BYTE]:1,[Z.UNSIGNED_SHORT]:2,[Z.INT]:4,[Z.UNSIGNED_INT]:4,[Z.FLOAT]:4,[Z.HALF_FLOAT]:8},G2={[D.RGBA]:4,[D.RGB]:3,[D.RG]:2,[D.RED]:1,[D.LUMINANCE]:1,[D.LUMINANCE_ALPHA]:2,[D.ALPHA]:1},z2={[Z.UNSIGNED_SHORT_4_4_4_4]:2,[Z.UNSIGNED_SHORT_5_5_5_1]:2,[Z.UNSIGNED_SHORT_5_6_5]:2};function H2(t,e,r=!1){const n=new DataView(e);if(!$2(t,n))return null;const i=n.getUint32(Jt.ENDIANNESS,!0)===j2,s=n.getUint32(Jt.GL_TYPE,i),o=n.getUint32(Jt.GL_FORMAT,i),a=n.getUint32(Jt.GL_INTERNAL_FORMAT,i),l=n.getUint32(Jt.PIXEL_WIDTH,i),u=n.getUint32(Jt.PIXEL_HEIGHT,i)||1,c=n.getUint32(Jt.PIXEL_DEPTH,i)||1,h=n.getUint32(Jt.NUMBER_OF_ARRAY_ELEMENTS,i)||1,d=n.getUint32(Jt.NUMBER_OF_FACES,i),f=n.getUint32(Jt.NUMBER_OF_MIPMAP_LEVELS,i),p=n.getUint32(Jt.BYTES_OF_KEY_VALUE_DATA,i);if(u===0||c!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");const m=4,x=4,y=l+3&-4,v=u+3&-4,g=new Array(h);let w=l*u;s===0&&(w=y*v);let S;if(s!==0?zy[s]?S=zy[s]*G2[o]:S=z2[s]:S=gu[a],S===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const C=r?V2(n,p,i):null;let b=w*S,E=l,R=u,M=y,K=v,O=hf+p;for(let A=0;A<f;A++){const B=n.getUint32(O,i);let H=O+4;for(let J=0;J<h;J++){let $=g[J];$||($=g[J]=new Array(f)),$[A]={levelID:A,levelWidth:f>1||s!==0?E:M,levelHeight:f>1||s!==0?R:K,levelBuffer:new Uint8Array(e,H,b)},H+=b}O+=B+4,O=O%4!==0?O+4-O%4:O,E=E>>1||1,R=R>>1||1,M=E+m-1&-4,K=R+x-1&-4,b=M*K*S}return s!==0?{uncompressed:g.map(A=>{let B=A[0].levelBuffer,H=!1;return s===Z.FLOAT?B=new Float32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4):s===Z.UNSIGNED_INT?(H=!0,B=new Uint32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)):s===Z.INT&&(H=!0,B=new Int32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)),{resource:new $u(B,{width:A[0].levelWidth,height:A[0].levelHeight}),type:s,format:H?W2(o):o}}),kvData:C}:{compressed:g.map(A=>new hi(null,{format:a,width:l,height:u,levels:f,levelBuffers:A})),kvData:C}}function $2(t,e){for(let r=0;r<Gy.length;r++)if(e.getUint8(r)!==Gy[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function W2(t){switch(t){case D.RGBA:return D.RGBA_INTEGER;case D.RGB:return D.RGB_INTEGER;case D.RG:return D.RG_INTEGER;case D.RED:return D.RED_INTEGER;default:return t}}function V2(t,e,r){const n=new Map;let i=0;for(;i<e;){const s=t.getUint32(hf+i,r),o=hf+i+4,a=3-(s+3)%4;if(s===0||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&t.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(t.buffer,o,l)),c=new DataView(t.buffer,o+l+1,s-l-1);n.set(u,c),i+=4+s+a}return n}const X2={extension:{type:U.LoadParser,priority:dr.High},name:"loadDDS",test(t){return $n(t,".dds")},async load(t,e,r){const n=await(await z.ADAPTER.fetch(t)).arrayBuffer(),i=U2(n).map(s=>{const o=new se(s,{mipmap:Mr.OFF,alphaMode:bt.NO_PREMULTIPLIED_ALPHA,resolution:Jr(t),...e.data});return da(o,r,t)});return i.length===1?i[0]:i},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};X.add(X2);const Y2={extension:{type:U.LoadParser,priority:dr.High},name:"loadKTX",test(t){return $n(t,".ktx")},async load(t,e,r){const n=await(await z.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=H2(t,n),a=i??s,l={mipmap:Mr.OFF,alphaMode:bt.NO_PREMULTIPLIED_ALPHA,resolution:Jr(t),...e.data},u=a.map(c=>{a===s&&Object.assign(l,{type:c.type,format:c.format});const h=c.resource??c,d=new se(h,l);return d.ktxKeyValueData=o,da(d,r,t)});return u.length===1?u[0]:u},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};X.add(Y2);const K2=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],q2={extension:U.ResolveParser,test:t=>{const e=it.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var n,i;const e=t.split("."),r=e.pop();if(["ktx","dds"].includes(r)){const s=e.pop();if(K2.includes(s))return{resolution:parseFloat(((n=z.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:s,src:t}}return{resolution:parseFloat(((i=z.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:r,src:t}}};X.add(q2);const Za=new ae,Z2=4,g1=class ho{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,r,n,i){const s=new Image;return s.src=await this.base64(e,r,n,i),s}async base64(e,r,n,i){const s=this.canvas(e,i);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>o(u.result),u.onerror=a,u.readAsDataURL(l)},r,n)});if(s.toDataURL!==void 0)return s.toDataURL(r,n);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:r,quality:n});return new Promise((a,l)=>{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=l,u.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);o&&ho._flipY(n,i,s),a&&ho._unpremultiplyAlpha(n);const l=new MR(i,s,1),u=new ImageData(new Uint8ClampedArray(n.buffer),i,s);return l.context.putImageData(u,0,0),l.canvas}pixels(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);return o&&ho._flipY(n,i,s),a&&ho._unpremultiplyAlpha(n),n}_rawPixels(e,r){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let i,s=!1,o=!1,a,l=!1;e&&(e instanceof Ai?a=e:(a=n.generateTexture(e,{region:r,resolution:n.resolution,multisample:n.multisample}),l=!0,r&&(Za.width=r.width,Za.height=r.height,r=Za)));const u=n.gl;if(a){if(i=a.baseTexture.resolution,r=r??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===D.RGBA,!l){n.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[n.CONTEXT_UID];f.blitFramebuffer&&n.framebuffer.bind(f.blitFramebuffer)}}else i=n.resolution,r||(r=Za,r.width=n.width/i,r.height=n.height/i),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const c=Math.max(Math.round(r.width*i),1),h=Math.max(Math.round(r.height*i),1),d=new Uint8Array(Z2*c*h);return u.readPixels(Math.round(r.x*i),Math.round(r.y*i),c,h,u.RGBA,u.UNSIGNED_BYTE,d),l&&(a==null||a.destroy(!0)),{pixels:d,width:c,height:h,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,r,n){const i=r<<2,s=n>>1,o=new Uint8Array(i);for(let a=0;a<s;a++){const l=a*i,u=(n-a-1)*i;o.set(e.subarray(l,l+i)),e.copyWithin(l,u,u+i),e.set(o,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const r=e.length;for(let n=0;n<r;n+=4){const i=e[n+3];if(i!==0){const s=255.001/i;e[n]=e[n]*s+.5,e[n+1]=e[n+1]*s+.5,e[n+2]=e[n+2]*s+.5}}}};g1.extension={name:"extract",type:U.RendererSystem};let Q2=g1;X.add(Q2);const yu={build(t){const e=t.points;let r,n,i,s,o,a;if(t.type===at.CIRC){const p=t.shape;r=p.x,n=p.y,o=a=p.radius,i=s=0}else if(t.type===at.ELIP){const p=t.shape;r=p.x,n=p.y,o=p.width,a=p.height,i=s=0}else{const p=t.shape,m=p.width/2,x=p.height/2;r=p.x+m,n=p.y+x,o=a=Math.max(0,Math.min(p.radius,Math.min(m,x))),i=m-o,s=x-a}if(!(o>=0&&a>=0&&i>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(i?4:0)+(s?4:0);if(e.length=u,u===0)return;if(l===0){e.length=8,e[0]=e[6]=r+i,e[1]=e[3]=n+s,e[2]=e[4]=r-i,e[5]=e[7]=n-s;return}let c=0,h=l*4+(i?2:0)+2,d=h,f=u;{const p=i+o,m=s,x=r+p,y=r-p,v=n+m;if(e[c++]=x,e[c++]=v,e[--h]=v,e[--h]=y,s){const g=n-m;e[d++]=y,e[d++]=g,e[--f]=g,e[--f]=x}}for(let p=1;p<l;p++){const m=Math.PI/2*(p/l),x=i+Math.cos(m)*o,y=s+Math.sin(m)*a,v=r+x,g=r-x,w=n+y,S=n-y;e[c++]=v,e[c++]=w,e[--h]=w,e[--h]=g,e[d++]=g,e[d++]=S,e[--f]=S,e[--f]=v}{const p=i,m=s+a,x=r+p,y=r-p,v=n+m,g=n-m;e[c++]=x,e[c++]=v,e[--f]=g,e[--f]=x,i&&(e[c++]=y,e[c++]=v,e[--f]=g,e[--f]=y)}},triangulate(t,e){const r=t.points,n=e.points,i=e.indices;if(r.length===0)return;let s=n.length/2;const o=s;let a,l;if(t.type!==at.RREC){const c=t.shape;a=c.x,l=c.y}else{const c=t.shape;a=c.x+c.width/2,l=c.y+c.height/2}const u=t.matrix;n.push(t.matrix?u.a*a+u.c*l+u.tx:a,t.matrix?u.b*a+u.d*l+u.ty:l),s++,n.push(r[0],r[1]);for(let c=2;c<r.length;c+=2)n.push(r[c],r[c+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function Hy(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let i=0,s=t[r-2],o=t[r-1];i<r;i+=2){const a=t[i],l=t[i+1];n+=(a-s)*(l+o),s=a,o=l}if(!e&&n>0||e&&n<=0){const i=r/2;for(let s=i+i%2;s<r;s+=2){const o=r-s-2,a=r-s-1,l=s,u=s+1;[t[o],t[l]]=[t[l],t[o]],[t[a],t[u]]=[t[u],t[a]]}}}const y1={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const n=t.holes,i=e.points,s=e.indices;if(r.length>=6){Hy(r,!1);const o=[];for(let u=0;u<n.length;u++){const c=n[u];Hy(c.points,!0),o.push(r.length/2),r=r.concat(c.points)}const a=ab(r,o,2);if(!a)return;const l=i.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+l),s.push(a[u+1]+l),s.push(a[u+2]+l);for(let u=0;u<r.length;u++)i.push(r[u])}}},J2={build(t){const e=t.shape,r=e.x,n=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(r,n,r+i,n,r+i,n+s,r,n+s)},triangulate(t,e){const r=t.points,n=e.points;if(r.length===0)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},eM={build(t){yu.build(t)},triangulate(t,e){yu.triangulate(t,e)}};var Ut=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Ut||{}),bn=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(bn||{});const ks={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class $y{static curveTo(e,r,n,i,s,o){const a=o[o.length-2],l=o[o.length-1]-r,u=a-e,c=i-r,h=n-e,d=Math.abs(l*h-u*c);if(d<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==r)&&o.push(e,r),null;const f=l*l+u*u,p=c*c+h*h,m=l*c+u*h,x=s*Math.sqrt(f)/d,y=s*Math.sqrt(p)/d,v=x*m/f,g=y*m/p,w=x*h+y*u,S=x*c+y*l,C=u*(y+v),b=l*(y+v),E=h*(x+g),R=c*(x+g),M=Math.atan2(b-S,C-w),K=Math.atan2(R-S,E-w);return{cx:w+e,cy:S+r,radius:s,startAngle:M,endAngle:K,anticlockwise:u*c>h*l}}static arc(e,r,n,i,s,o,a,l,u){const c=a-o,h=ks._segmentsCount(Math.abs(c)*s,Math.ceil(Math.abs(c)/lu)*40),d=c/(h*2),f=d*2,p=Math.cos(d),m=Math.sin(d),x=h-1,y=x%1/x;for(let v=0;v<=x;++v){const g=v+y*v,w=d+o+f*g,S=Math.cos(w),C=-Math.sin(w);u.push((p*S+m*C)*s+n,(p*-C+m*S)*s+i)}}}class tM{constructor(){this.reset()}begin(e,r,n){this.reset(),this.style=e,this.start=r,this.attribStart=n}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Ip{static curveLength(e,r,n,i,s,o,a,l){let u=0,c=0,h=0,d=0,f=0,p=0,m=0,x=0,y=0,v=0,g=0,w=e,S=r;for(let C=1;C<=10;++C)c=C/10,h=c*c,d=h*c,f=1-c,p=f*f,m=p*f,x=m*e+3*p*c*n+3*f*h*s+d*a,y=m*r+3*p*c*i+3*f*h*o+d*l,v=w-x,g=S-y,w=x,S=y,u+=Math.sqrt(v*v+g*g);return u}static curveTo(e,r,n,i,s,o,a){const l=a[a.length-2],u=a[a.length-1];a.length-=2;const c=ks._segmentsCount(Ip.curveLength(l,u,e,r,n,i,s,o));let h=0,d=0,f=0,p=0,m=0;a.push(l,u);for(let x=1,y=0;x<=c;++x)y=x/c,h=1-y,d=h*h,f=d*h,p=y*y,m=p*y,a.push(f*l+3*d*y*e+3*h*p*n+m*s,f*u+3*d*y*r+3*h*p*i+m*o)}}function Wy(t,e,r,n,i,s,o,a){const l=t-r*i,u=e-n*i,c=t+r*s,h=e+n*s;let d,f;o?(d=n,f=-r):(d=-n,f=r);const p=l+d,m=u+f,x=c+d,y=h+f;return a.push(p,m,x,y),2}function Vn(t,e,r,n,i,s,o,a){const l=r-t,u=n-e;let c=Math.atan2(l,u),h=Math.atan2(i-t,s-e);a&&c<h?c+=Math.PI*2:!a&&c>h&&(h+=Math.PI*2);let d=c;const f=h-c,p=Math.abs(f),m=Math.sqrt(l*l+u*u),x=(15*p*Math.sqrt(m)/Math.PI>>0)+1,y=f/x;if(d+=y,a){o.push(t,e,r,n);for(let v=1,g=d;v<x;v++,g+=y)o.push(t,e,t+Math.sin(g)*m,e+Math.cos(g)*m);o.push(t,e,i,s)}else{o.push(r,n,t,e);for(let v=1,g=d;v<x;v++,g+=y)o.push(t+Math.sin(g)*m,e+Math.cos(g)*m,t,e);o.push(i,s,t,e)}return x*2}function rM(t,e){const r=t.shape;let n=t.points||r.points.slice();const i=e.closePointEps;if(n.length===0)return;const s=t.lineStyle,o=new me(n[0],n[1]),a=new me(n[n.length-2],n[n.length-1]),l=r.type!==at.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){n=n.slice(),u&&(n.pop(),n.pop(),a.set(n[n.length-2],n[n.length-1]));const $=(o.x+a.x)*.5,I=(a.y+o.y)*.5;n.unshift($,I),n.push($,I)}const c=e.points,h=n.length/2;let d=n.length;const f=c.length/2,p=s.width/2,m=p*p,x=s.miterLimit*s.miterLimit;let y=n[0],v=n[1],g=n[2],w=n[3],S=0,C=0,b=-(v-w),E=y-g,R=0,M=0,K=Math.sqrt(b*b+E*E);b/=K,E/=K,b*=p,E*=p;const O=s.alignment,A=(1-O)*2,B=O*2;l||(s.cap===bn.ROUND?d+=Vn(y-b*(A-B)*.5,v-E*(A-B)*.5,y-b*A,v-E*A,y+b*B,v+E*B,c,!0)+2:s.cap===bn.SQUARE&&(d+=Wy(y,v,b,E,A,B,!0,c))),c.push(y-b*A,v-E*A,y+b*B,v+E*B);for(let $=1;$<h-1;++$){y=n[($-1)*2],v=n[($-1)*2+1],g=n[$*2],w=n[$*2+1],S=n[($+1)*2],C=n[($+1)*2+1],b=-(v-w),E=y-g,K=Math.sqrt(b*b+E*E),b/=K,E/=K,b*=p,E*=p,R=-(w-C),M=g-S,K=Math.sqrt(R*R+M*M),R/=K,M/=K,R*=p,M*=p;const I=g-y,j=v-w,P=g-S,k=C-w,q=I*P+j*k,fe=j*P-k*I,ue=fe<0;if(Math.abs(fe)<.001*Math.abs(q)){c.push(g-b*A,w-E*A,g+b*B,w+E*B),q>=0&&(s.join===Ut.ROUND?d+=Vn(g,w,g-b*A,w-E*A,g-R*A,w-M*A,c,!1)+4:d+=2,c.push(g-R*B,w-M*B,g+R*A,w+M*A));continue}const Ie=(-b+y)*(-E+w)-(-b+g)*(-E+v),ve=(-R+S)*(-M+w)-(-R+g)*(-M+C),xe=(I*ve-P*Ie)/fe,Je=(k*Ie-j*ve)/fe,Ye=(xe-g)*(xe-g)+(Je-w)*(Je-w),Me=g+(xe-g)*A,_e=w+(Je-w)*A,be=g-(xe-g)*B,ke=w-(Je-w)*B,mt=Math.min(I*I+j*j,P*P+k*k),wt=ue?A:B,Nr=mt+wt*wt*m,js=Ye<=Nr;let rn=s.join;if(rn===Ut.MITER&&Ye/m>x&&(rn=Ut.BEVEL),js)switch(rn){case Ut.MITER:{c.push(Me,_e,be,ke);break}case Ut.BEVEL:{ue?c.push(Me,_e,g+b*B,w+E*B,Me,_e,g+R*B,w+M*B):c.push(g-b*A,w-E*A,be,ke,g-R*A,w-M*A,be,ke),d+=2;break}case Ut.ROUND:{ue?(c.push(Me,_e,g+b*B,w+E*B),d+=Vn(g,w,g+b*B,w+E*B,g+R*B,w+M*B,c,!0)+4,c.push(Me,_e,g+R*B,w+M*B)):(c.push(g-b*A,w-E*A,be,ke),d+=Vn(g,w,g-b*A,w-E*A,g-R*A,w-M*A,c,!1)+4,c.push(g-R*A,w-M*A,be,ke));break}}else{switch(c.push(g-b*A,w-E*A,g+b*B,w+E*B),rn){case Ut.MITER:{ue?c.push(be,ke,be,ke):c.push(Me,_e,Me,_e),d+=2;break}case Ut.ROUND:{ue?d+=Vn(g,w,g+b*B,w+E*B,g+R*B,w+M*B,c,!0)+2:d+=Vn(g,w,g-b*A,w-E*A,g-R*A,w-M*A,c,!1)+2;break}}c.push(g-R*A,w-M*A,g+R*B,w+M*B),d+=2}}y=n[(h-2)*2],v=n[(h-2)*2+1],g=n[(h-1)*2],w=n[(h-1)*2+1],b=-(v-w),E=y-g,K=Math.sqrt(b*b+E*E),b/=K,E/=K,b*=p,E*=p,c.push(g-b*A,w-E*A,g+b*B,w+E*B),l||(s.cap===bn.ROUND?d+=Vn(g-b*(A-B)*.5,w-E*(A-B)*.5,g-b*A,w-E*A,g+b*B,w+E*B,c,!1)+2:s.cap===bn.SQUARE&&(d+=Wy(g,w,b,E,A,B,!1,c)));const H=e.indices,J=ks.epsilon*ks.epsilon;for(let $=f;$<d+f-2;++$)y=c[$*2],v=c[$*2+1],g=c[($+1)*2],w=c[($+1)*2+1],S=c[($+2)*2],C=c[($+2)*2+1],!(Math.abs(y*(w-C)+g*(C-v)+S*(v-w))<J)&&H.push($,$+1,$+2)}function nM(t,e){let r=0;const n=t.shape,i=t.points||n.points,s=n.type!==at.POLY||n.closeStroke;if(i.length===0)return;const o=e.points,a=e.indices,l=i.length/2,u=o.length/2;let c=u;for(o.push(i[0],i[1]),r=1;r<l;r++)o.push(i[r*2],i[r*2+1]),a.push(c,c+1),c++;s&&a.push(c,u)}function Vy(t,e){t.lineStyle.native?nM(t,e):rM(t,e)}class Mp{static curveLength(e,r,n,i,s,o){const a=e-2*n+s,l=r-2*i+o,u=2*n-2*e,c=2*i-2*r,h=4*(a*a+l*l),d=4*(a*u+l*c),f=u*u+c*c,p=2*Math.sqrt(h+d+f),m=Math.sqrt(h),x=2*h*m,y=2*Math.sqrt(f),v=d/m;return(x*p+m*d*(p-y)+(4*f*h-d*d)*Math.log((2*m+v+p)/(v+y)))/(4*x)}static curveTo(e,r,n,i,s){const o=s[s.length-2],a=s[s.length-1],l=ks._segmentsCount(Mp.curveLength(o,a,e,r,n,i));let u=0,c=0;for(let h=1;h<=l;++h){const d=h/l;u=o+(e-o)*d,c=a+(r-a)*d,s.push(u+(e+(n-e)*d-u)*d,c+(r+(i-r)*d-c)*d)}}}const gh={[at.POLY]:y1,[at.CIRC]:yu,[at.ELIP]:yu,[at.RECT]:J2,[at.RREC]:eM},Xy=[],Qa=[];class vu{constructor(e,r=null,n=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=r,this.matrix=i,this.type=e.type}clone(){return new vu(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Li=new me,v1=class x1 extends S_{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new fu,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Qa.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r.reset(),Xy.push(r)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,r=null,n=null,i=null){const s=new vu(e,r,n,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,r=null){if(!this.graphicsData.length)return null;const n=new vu(e,null,null,r),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const r=this.graphicsData;for(let n=0;n<r.length;++n){const i=r[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,Li):Li.copyFrom(e),i.shape.contains(Li.x,Li.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Li.x,Li.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,r=this.graphicsData;let n=null,i=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],i=n.style);for(let l=this.shapeIndex;l<r.length;l++){this.shapeIndex++;const u=r[l],c=u.fillStyle,h=u.lineStyle;gh[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(c.visible||h.visible)&&this.processHoles(u.holes);for(let d=0;d<2;d++){const f=d===0?c:h;if(!f.visible)continue;const p=f.texture.baseTexture,m=this.indices.length,x=this.points.length/2;p.wrapMode=Dn.REPEAT,d===0?this.processFill(u):this.processLine(u);const y=this.points.length/2-x;y!==0&&(n&&!this._compareStyles(i,f)&&(n.end(m,x),n=null),n||(n=Xy.pop()||new tM,n.begin(f,m,x),this.batches.push(n),i=f),this.addUvs(this.points,e,f.texture,x,y,f.matrix))}}const s=this.indices.length,o=this.points.length/2;if(n&&n.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,r){return!(!e||!r||e.texture.baseTexture!==r.texture.baseTexture||e.color+e.alpha!==r.color+r.alpha||!!e.native!=!!r.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,r=this.graphicsData.length;e<r;e++){const n=this.graphicsData[e],i=n.fillStyle,s=n.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let r=0,n=e.length;r<n;r++){const i=e[r];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<x1.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++se._globalBatch;for(let h=0;h<this.drawCalls.length;h++)this.drawCalls[h].texArray.clear(),Qa.push(this.drawCalls[h]);this.drawCalls.length=0;const r=this.colors,n=this.textureIds;let i=Qa.pop();i||(i=new zd,i.texArray=new Vd),i.texArray.count=0,i.start=0,i.size=0,i.type=Ar.TRIANGLES;let s=0,o=null,a=0,l=!1,u=Ar.TRIANGLES,c=0;this.drawCalls.push(i);for(let h=0;h<this.batches.length;h++){const d=this.batches[h],f=8,p=d.style,m=p.texture.baseTexture;l!==!!p.native&&(l=!!p.native,u=l?Ar.LINES:Ar.TRIANGLES,o=null,s=f,e++),o!==m&&(o=m,m._batchEnabled!==e&&(s===f&&(e++,s=0,i.size>0&&(i=Qa.pop(),i||(i=new zd,i.texArray=new Vd),this.drawCalls.push(i)),i.start=c,i.size=0,i.texArray.count=0,i.type=u),m.touched=1,m._batchEnabled=e,m._batchLocation=s,m.wrapMode=Dn.REPEAT,i.texArray.elements[i.texArray.count++]=m,s++)),i.size+=d.size,c+=d.size,a=m._batchLocation,this.addColors(r,p.color,p.alpha,d.attribSize,d.attribStart),this.addTextureIds(n,a,d.attribSize,d.attribStart)}se._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,r=this.uvs,n=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let u=0;u<e.length/2;u++)o[l++]=e[u*2],o[l++]=e[u*2+1],o[l++]=r[u*2],o[l++]=r[u*2+1],a[l++]=n[u],o[l++]=i[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?y1.triangulate(e,this):gh[e.type].triangulate(e,this)}processLine(e){Vy(e,this);for(let r=0;r<e.holes.length;r++)Vy(e.holes[r],this)}processHoles(e){for(let r=0;r<e.length;r++){const n=e[r];gh[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,r){for(let n=0;n<e.length/2;n++){const i=e[n*2],s=e[n*2+1];e[n*2]=r.a*i+r.c*s+r.tx,e[n*2+1]=r.b*i+r.d*s+r.ty}}addColors(e,r,n,i,s=0){const o=Ce.shared.setValue(r).toLittleEndianNumber(),a=Ce.shared.setValue(o).toPremultiplied(n);e.length=Math.max(e.length,s+i);for(let l=0;l<i;l++)e[s+l]=a}addTextureIds(e,r,n,i=0){e.length=Math.max(e.length,i+n);for(let s=0;s<n;s++)e[i+s]=r}addUvs(e,r,n,i,s,o=null){let a=0;const l=r.length,u=n.frame;for(;a<s;){let h=e[(i+a)*2],d=e[(i+a)*2+1];if(o){const f=o.a*h+o.c*d+o.tx;d=o.b*h+o.d*d+o.ty,h=f}a++,r.push(h/u.width,d/u.height)}const c=n.baseTexture;(u.width<c.width||u.height<c.height)&&this.adjustUvs(r,n,l,s)}adjustUvs(e,r,n,i){const s=r.baseTexture,o=1e-6,a=n+i*2,l=r.frame,u=l.width/s.width,c=l.height/s.height;let h=l.x/l.width,d=l.y/l.height,f=Math.floor(e[n]+o),p=Math.floor(e[n+1]+o);for(let m=n+2;m<a;m+=2)f=Math.min(f,Math.floor(e[m]+o)),p=Math.min(p,Math.floor(e[m+1]+o));h-=f,d-=p;for(let m=n;m<a;m+=2)e[m]=(e[m]+h)*u,e[m+1]=(e[m+1]+d)*c}};v1.BATCHABLE_SIZE=100;let iM=v1;class qu{constructor(){this.color=16777215,this.alpha=1,this.texture=V.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new qu;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=V.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class kp extends qu{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=bn.BUTT,this.join=Ut.MITER,this.miterLimit=10}clone(){const e=new kp;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=bn.BUTT,this.join=Ut.MITER,this.miterLimit=10}}const yh={},df=class Al extends It{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new qu,this._lineStyle=new kp,this._matrix=null,this._holeMode=!1,this.state=Br.for2d(),this._geometry=e||new iM,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Ce(16777215),this.blendMode=ee.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Al(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,r=0,n,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:r,alpha:n,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const r={width:0,texture:V.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:bn.BUTT,join:Ut.MITER,miterLimit:10};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new ci,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new ci,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this}lineTo(e,r){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,i=n[n.length-2],s=n[n.length-1];return(i!==e||s!==r)&&n.push(e,r),this}_initCurve(e=0,r=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)}quadraticCurveTo(e,r,n,i){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),Mp.curveTo(e,r,n,i,s),this}bezierCurveTo(e,r,n,i,s,o){return this._initCurve(),Ip.curveTo(e,r,n,i,s,o,this.currentPath.points),this}arcTo(e,r,n,i,s){this._initCurve(e,r);const o=this.currentPath.points,a=$y.curveTo(e,r,n,i,s,o);if(a){const{cx:l,cy:u,radius:c,startAngle:h,endAngle:d,anticlockwise:f}=a;this.arc(l,u,c,h,d,f)}return this}arc(e,r,n,i,s,o=!1){if(i===s)return this;if(!o&&s<=i?s+=lu:o&&i<=s&&(i+=lu),s-i===0)return this;const a=e+Math.cos(i)*n,l=r+Math.sin(i)*n,u=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const h=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-l);h<u&&d<u||c.push(a,l)}else this.moveTo(a,l),c=this.currentPath.points;return $y.arc(a,l,e,r,n,i,s,o,c),this}beginFill(e=0,r){return this.beginTextureFill({texture:V.WHITE,color:e,alpha:r})}normalizeColor(e){const r=Ce.shared.setValue(e.color??0);e.color=r.toNumber(),e.alpha??(e.alpha=r.alpha)}beginTextureFill(e){const r={texture:V.WHITE,color:16777215,matrix:null};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,r,n,i){return this.drawShape(new ae(e,r,n,i))}drawRoundedRect(e,r,n,i,s){return this.drawShape(new Xu(e,r,n,i,s))}drawCircle(e,r,n){return this.drawShape(new Wu(e,r,n))}drawEllipse(e,r,n,i){return this.drawShape(new Vu(e,r,n,i))}drawPolygon(...e){let r,n=!0;const i=e[0];i.points?(n=i.closeStroke,r=i.points):Array.isArray(e[0])?r=e[0]:r=e;const s=new ci(r);return s.closeStroke=n,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===at.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,r=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let i=0;i<n;i++){const s=e.batches[i],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),c={vertexData:a,blendMode:r,indices:u,uvs:l,_batchRGB:Ce.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=c}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let r=0,n=this.batches.length;r<n;r++){const i=this.batches[r];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const r=this._resolveDirectShader(e),n=this._geometry,i=this.worldAlpha,s=r.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,Ce.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(r),e.geometry.bind(n,r),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,n.drawCalls[a])}_renderDrawCallDirect(e,r){const{texArray:n,type:i,size:s,start:o}=r,a=n.count;for(let l=0;l<a;l++)e.texture.bind(n.elements[l],l);e.geometry.draw(i,s,o)}_resolveDirectShader(e){let r=this.shader;const n=this.pluginName;if(!r){if(!yh[n]){const{maxTextures:i}=e.plugins[n],s=new Int32Array(i);for(let l=0;l<i;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pe,default:ur.from({uSamplers:s},!0)},a=e.plugins[n]._shader.program;yh[n]=new Ir(a,o)}r=yh[n]}return r}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:r,minY:n,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,r,n,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,Al._TEMP_POINT),this._geometry.containsPoint(Al._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r._tintRGB=Ce.shared.setValue(this._tintColor).multiply(r._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,u=this._geometry.points,c=this.vertexData;let h=0;for(let d=0;d<u.length;d+=2){const f=u[d],p=u[d+1];c[h++]=n*f+s*p+a,c[h++]=o*p+i*f+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};df.curves=ks,df._TEMP_POINT=new me;let Wt=df;class sM{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const vh=new me,Yy=new ci,_1=class w1 extends It{constructor(e,r,n,i=Ar.TRIANGLES){super(),this.geometry=e,this.shader=r,this.state=n||Br.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=z.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Ar.TRIANGLES&&r.length<w1.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const r=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const e=this.geometry.buffers[0],r=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,u=i.tx,c=i.ty,h=this.vertexData;for(let d=0;d<h.length/2;d++){const f=r[d*2],p=r[d*2+1];h[d*2]=s*f+a*p+u,h[d*2+1]=o*f+l*p+c}if(this._roundPixels){const d=z.RESOLUTION;for(let f=0;f<h.length;++f)h[f]=Math.round(h[f]*d)/d}this.vertexDirty=n}calculateUvs(){const e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new sM(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,vh);const r=this.geometry.getBuffer("aVertexPosition").data,n=Yy.points,i=this.geometry.getIndex().data,s=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=i[a]*2,u=i[a+1]*2,c=i[a+2]*2;if(n[0]=r[l],n[1]=r[l+1],n[2]=r[u],n[3]=r[u+1],n[4]=r[c],n[5]=r[c+1],Yy.contains(vh.x,vh.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};_1.BATCHABLE_SIZE=100;let Ky=_1;class oM extends Un{constructor(e,r,n){super();const i=new He(e),s=new He(r,!0),o=new He(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,Z.FLOAT).addAttribute("aTextureCoord",s,2,!1,Z.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var aM=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,lM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class qy extends Ir{constructor(e,r){const n={uSampler:e,alpha:1,uTextureMatrix:Pe.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||Vr.from(lM,aM),n),this._colorDirty=!1,this.uvMatrix=new O_(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new Ce(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Ce.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Zy{constructor(e,r,n){this.geometry=new Un,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||Z.FLOAT,offset:s.offset},r[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let r=0;this.indexBuffer=new He(PR(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new He(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new He(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===Z.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===Z.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,r,n){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,r,n,s.type===Z.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,n){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,r,n,s.type===Z.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var uM=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,cM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class E1 extends Yu{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Pe,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Z.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Ir.from(cM,uM,{}),this.state=Br.for2d()}render(e){const r=e.children,n=e._maxSize,i=e._batchSize,s=this.renderer;let o=r.length;if(o===0)return;o>n&&!e.autoResize&&(o=n);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=r[0]._texture.baseTexture,u=l.alphaMode>0;this.state.blendMode=__(e.blendMode,u),s.state.set(this.state);const c=s.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=Ce.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=i,p+=1){let m=o-f;m>i&&(m=i),p>=a.length&&a.push(this._generateOneMoreBuffer(e));const x=a[p];x.uploadDynamic(r,f,m);const y=e._bufferUpdateIDs[p]||0;d=d||x._updateID<y,d&&(x._updateID=e._updateID,x.uploadStatic(r,f,m)),s.geometry.bind(x.geometry),c.drawElements(c.TRIANGLES,m*6,c.UNSIGNED_SHORT,0)}}generateBuffers(e){const r=[],n=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<n;o+=i)r.push(new Zy(this.properties,s,i));return r}_generateOneMoreBuffer(e){const r=e._batchSize,n=e._properties;return new Zy(this.properties,n,r)}uploadVertices(e,r,n,i,s,o){let a=0,l=0,u=0,c=0;for(let h=0;h<n;++h){const d=e[r+h],f=d._texture,p=d.scale.x,m=d.scale.y,x=f.trim,y=f.orig;x?(l=x.x-d.anchor.x*y.width,a=l+x.width,c=x.y-d.anchor.y*y.height,u=c+x.height):(a=y.width*(1-d.anchor.x),l=y.width*-d.anchor.x,u=y.height*(1-d.anchor.y),c=y.height*-d.anchor.y),i[o]=l*p,i[o+1]=c*m,i[o+s]=a*p,i[o+s+1]=c*m,i[o+s*2]=a*p,i[o+s*2+1]=u*m,i[o+s*3]=l*p,i[o+s*3+1]=u*m,o+=s*4}}uploadPosition(e,r,n,i,s,o){for(let a=0;a<n;a++){const l=e[r+a].position;i[o]=l.x,i[o+1]=l.y,i[o+s]=l.x,i[o+s+1]=l.y,i[o+s*2]=l.x,i[o+s*2+1]=l.y,i[o+s*3]=l.x,i[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,r,n,i,s,o){for(let a=0;a<n;a++){const l=e[r+a].rotation;i[o]=l,i[o+s]=l,i[o+s*2]=l,i[o+s*3]=l,o+=s*4}}uploadUvs(e,r,n,i,s,o){for(let a=0;a<n;++a){const l=e[r+a]._texture._uvs;l?(i[o]=l.x0,i[o+1]=l.y0,i[o+s]=l.x1,i[o+s+1]=l.y1,i[o+s*2]=l.x2,i[o+s*2+1]=l.y2,i[o+s*3]=l.x3,i[o+s*3+1]=l.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}}uploadTint(e,r,n,i,s,o){for(let a=0;a<n;++a){const l=e[r+a],u=Ce.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);i[o]=u,i[o+s]=u,i[o+s*2]=u,i[o+s*3]=u,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}E1.extension={name:"particle",type:U.RendererPlugin};X.add(E1);var Zu=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(Zu||{});const Ja={willReadFrequently:!0},xr=class Y{static get experimentalLetterSpacingSupported(){let e=Y._experimentalLetterSpacingSupported;if(e!==void 0){const r=z.ADAPTER.getCanvasRenderingContext2D().prototype;e=Y._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,i,s,o,a,l,u){this.text=e,this.style=r,this.width=n,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e,r,n,i=Y._canvas){n=n??r.wordWrap;const s=r.toFontString(),o=Y.measureFont(s);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const a=i.getContext("2d",Ja);a.font=s;const l=(n?Y.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let c=0;for(let p=0;p<l.length;p++){const m=Y._measureText(l[p],r.letterSpacing,a);u[p]=m,c=Math.max(c,m)}let h=c+r.strokeThickness;r.dropShadow&&(h+=r.dropShadowDistance);const d=r.lineHeight||o.fontSize+r.strokeThickness;let f=Math.max(d,o.fontSize+r.strokeThickness*2)+r.leading+(l.length-1)*(d+r.leading);return r.dropShadow&&(f+=r.dropShadowDistance),new Y(e,r,h,f,l,u,d+r.leading,c,o)}static _measureText(e,r,n){let i=!1;Y.experimentalLetterSpacingSupported&&(Y.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let s=n.measureText(e).width;return s>0&&(i?s-=r:s+=(Y.graphemeSegmenter(e).length-1)*r),s}static wordWrap(e,r,n=Y._canvas){const i=n.getContext("2d",Ja);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:c}=r,h=Y.collapseSpaces(c),d=Y.collapseNewlines(c);let f=!h;const p=r.wordWrapWidth+u,m=Y.tokenize(e);for(let x=0;x<m.length;x++){let y=m[x];if(Y.isNewline(y)){if(!d){a+=Y.addLine(o),f=!h,o="",s=0;continue}y=" "}if(h){const g=Y.isBreakingSpace(y),w=Y.isBreakingSpace(o[o.length-1]);if(g&&w)continue}const v=Y.getFromCache(y,u,l,i);if(v>p)if(o!==""&&(a+=Y.addLine(o),o="",s=0),Y.canBreakWords(y,r.breakWords)){const g=Y.wordWrapSplit(y);for(let w=0;w<g.length;w++){let S=g[w],C=S,b=1;for(;g[w+b];){const R=g[w+b];if(!Y.canBreakChars(C,R,y,w,r.breakWords))S+=R;else break;C=R,b++}w+=b-1;const E=Y.getFromCache(S,u,l,i);E+s>p&&(a+=Y.addLine(o),f=!1,o="",s=0),o+=S,s+=E}}else{o.length>0&&(a+=Y.addLine(o),o="",s=0);const g=x===m.length-1;a+=Y.addLine(y,!g),f=!1,o="",s=0}else v+s>p&&(f=!1,a+=Y.addLine(o),o="",s=0),(o.length>0||!Y.isBreakingSpace(y)||f)&&(o+=y,s+=v)}return a+=Y.addLine(o,!1),a}static addLine(e,r=!0){return e=Y.trimRight(e),e=r?`${e}
`:e,e}static getFromCache(e,r,n,i){let s=n[e];return typeof s!="number"&&(s=Y._measureText(e,r,i)+r,n[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!Y.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:Y._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:Y._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(Y.isBreakingSpace(s,o)||Y.isNewline(s)){n!==""&&(r.push(n),n=""),r.push(s);continue}n+=s}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,i,s){return!0}static wordWrapSplit(e){return Y.graphemeSegmenter(e)}static measureFont(e){if(Y._fonts[e])return Y._fonts[e];const r={ascent:0,descent:0,fontSize:0},n=Y._canvas,i=Y._context;i.font=e;const s=Y.METRICS_STRING+Y.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(Y.BASELINE_SYMBOL).width);const l=Math.ceil(Y.HEIGHT_MULTIPLIER*a);if(a=a*Y.BASELINE_MULTIPLIER|0,o===0||l===0)return Y._fonts[e]=r,r;n.width=o,n.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const u=i.getImageData(0,0,o,l).data,c=u.length,h=o*4;let d=0,f=0,p=!1;for(d=0;d<a;++d){for(let m=0;m<h;m+=4)if(u[f+m]!==255){p=!0;break}if(!p)f+=h;else break}for(r.ascent=a-d,f=c-h,p=!1,d=l;d>a;--d){for(let m=0;m<h;m+=4)if(u[f+m]!==255){p=!0;break}if(!p)f-=h;else break}return r.descent=d-a,r.fontSize=r.ascent+r.descent,Y._fonts[e]=r,r}static clearMetrics(e=""){e?delete Y._fonts[e]:Y._fonts={}}static get _canvas(){var e;if(!Y.__canvas){let r;try{const n=new OffscreenCanvas(0,0);if((e=n.getContext("2d",Ja))!=null&&e.measureText)return Y.__canvas=n,n;r=z.ADAPTER.createCanvas()}catch{r=z.ADAPTER.createCanvas()}r.width=r.height=10,Y.__canvas=r}return Y.__canvas}static get _context(){return Y.__context||(Y.__context=Y._canvas.getContext("2d",Ja)),Y.__context}};xr.METRICS_STRING="|q",xr.BASELINE_SYMBOL="M",xr.BASELINE_MULTIPLIER=1.4,xr.HEIGHT_MULTIPLIER=2,xr.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})(),xr.experimentalLetterSpacing=!1,xr._fonts={},xr._newlines=[10,13],xr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let gn=xr;const hM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],S1=class fo{constructor(e){this.styleID=0,this.reset(),_h(this,e,e)}clone(){const e={};return _h(e,this,fo.defaultStyle),new fo(e)}reset(){_h(this,fo.defaultStyle,fo.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const r=xh(e);this._dropShadowColor!==r&&(this._dropShadowColor=r,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const r=xh(e);this._fill!==r&&(this._fill=r,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){dM(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const r=xh(e);this._stroke!==r&&(this._stroke=r,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let r=this.fontFamily;Array.isArray(this.fontFamily)||(r=this.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let i=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!hM.includes(i)&&(i=`"${i}"`),r[n]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${r.join(",")}`}};S1.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Zu.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let hr=S1;function xh(t){const e=Ce.shared,r=n=>{const i=e.setValue(n);return i.alpha===1?i.toHex():i.toRgbaString()};return Array.isArray(t)?t.map(r):r(t)}function dM(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function _h(t,e,r){for(const n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}const fM={texture:!0,children:!1,baseTexture:!0},T1=class ff extends Ci{constructor(e,r,n){let i=!1;n||(n=z.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const s=V.from(n);s.orig=new ae,s.trim=new ae,super(s),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=ff.defaultResolution??z.RESOLUTION,this._autoResolution=ff.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return gn.experimentalLetterSpacing}static set experimentalLetterSpacing(e){he("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),gn.experimentalLetterSpacing=e}updateText(e){const r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const n=this.context,i=gn.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,a=i.lines,l=i.lineHeight,u=i.lineWidths,c=i.maxLineWidth,h=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;let d,f;const p=r.dropShadow?2:1;for(let m=0;m<p;++m){const x=r.dropShadow&&m===0,y=x?Math.ceil(Math.max(1,o)+r.padding*2):0,v=y*this._resolution;if(x){n.fillStyle="black",n.strokeStyle="black";const w=r.dropShadowColor,S=r.dropShadowBlur*this._resolution,C=r.dropShadowDistance*this._resolution;n.shadowColor=Ce.shared.setValue(w).setAlpha(r.dropShadowAlpha).toRgbaString(),n.shadowBlur=S,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*C,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*C+v}else n.fillStyle=this._generateFillStyle(r,a,i),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let g=(l-h.fontSize)/2;l-h.fontSize<0&&(g=0);for(let w=0;w<a.length;w++)d=r.strokeThickness/2,f=r.strokeThickness/2+w*l+h.ascent+g,r.align==="right"?d+=c-u[w]:r.align==="center"&&(d+=(c-u[w])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(a[w],d+r.padding,f+r.padding-y,!0),r.fill&&this.drawLetterSpacing(a[w],d+r.padding,f+r.padding-y)}this.updateTexture()}drawLetterSpacing(e,r,n,i=!1){const s=this._style.letterSpacing;let o=!1;if(gn.experimentalLetterSpacingSupported&&(gn.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(e,r,n):this.context.fillText(e,r,n);return}let a=r;const l=gn.graphemeSegmenter(e);let u=this.context.measureText(e).width,c=0;for(let h=0;h<l.length;++h){const d=l[h];i?this.context.strokeText(d,a,n):this.context.fillText(d,a,n);let f="";for(let p=h+1;p<l.length;++p)f+=l[p];c=this.context.measureText(f).width,a+=u-c+s,u=c}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=BR(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const r=this._texture,n=this._style,i=n.trim?0:n.padding,s=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-i*2,r.orig.height=r._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,r){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,r)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,r,n){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,u=this.canvas.height/this._resolution-o-a*2,c=i.slice(),h=e.fillGradientStops.slice();if(!h.length){const d=c.length+1;for(let f=1;f<d;++f)h.push(f/d)}if(c.unshift(i[0]),h.unshift(0),c.push(i[i.length-1]),h.push(1),e.fillGradientType===Zu.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,u+a);const d=n.fontProperties.fontSize+e.strokeThickness;for(let f=0;f<r.length;f++){const p=n.lineHeight*(f-1)+d,m=n.lineHeight*f;let x=m;f>0&&p>m&&(x=(m+p)/2);const y=m+d,v=n.lineHeight*(f+1);let g=y;f+1<r.length&&v<y&&(g=(y+v)/2);const w=(g-x)/u;for(let S=0;S<c.length;S++){let C=0;typeof h[S]=="number"?C=h[S]:C=S/c.length;let b=Math.min(1,Math.max(0,x/u+C*w));b=Number(b.toFixed(5)),s.addColorStop(b,c[S])}}}else{s=this.context.createLinearGradient(a,u/2,l+a,u/2);const d=c.length+1;let f=1;for(let p=0;p<c.length;p++){let m;typeof h[p]=="number"?m=h[p]:m=f/d,s.addColorStop(m,c[p]),f++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},fM,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const r=Tn(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const r=Tn(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof hr?this._style=e:this._style=new hr(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};T1.defaultAutoResolution=!0;let Bs=T1;class pM{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function mM(t,e){var n;let r=!1;if((n=t==null?void 0:t._textures)!=null&&n.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof V){const s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),r=!0)}}return r}function gM(t,e){if(t.baseTexture instanceof se){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function yM(t,e){if(t._texture&&t._texture instanceof V){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function vM(t,e){return e instanceof Bs?(e.updateText(!0),!0):!1}function xM(t,e){if(e instanceof hr){const r=e.toFontString();return gn.measureFont(r),!0}return!1}function _M(t,e){if(t instanceof Bs){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function wM(t,e){return t instanceof hr?(e.includes(t)||e.push(t),!0):!1}const b1=class A1{constructor(e){this.limiter=new pM(A1.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(_M),this.registerFindHook(wM),this.registerFindHook(mM),this.registerFindHook(gM),this.registerFindHook(yM),this.registerUploadHook(vM),this.registerUploadHook(xM)}upload(e){return new Promise(r=>{e&&this.add(e),this.queue.length?(this.completes.push(r),this.ticking||(this.ticking=!0,Nt.system.addOnce(this.tick,this,xi.UTILITY))):r()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let r=!1;if(e&&!e._destroyed){for(let n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),r=!0;break}}r||this.queue.shift()}if(this.queue.length)Nt.system.addOnce(this.tick,this,xi.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let r=0,n=e.length;r<n;r++)e[r]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let r=0,n=this.addHooks.length;r<n&&!this.addHooks[r](e,this.queue);r++);if(e instanceof It)for(let r=e.children.length-1;r>=0;r--)this.add(e.children[r]);return this}destroy(){this.ticking&&Nt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};b1.uploadsPerFrame=4;let pf=b1;Object.defineProperties(z,{UPLOADS_PER_FRAME:{get(){return pf.uploadsPerFrame},set(t){he("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),pf.uploadsPerFrame=t}}});function C1(t,e){return e instanceof se?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function EM(t,e){if(!(e instanceof Wt))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:n}=r;for(let i=0;i<n.length;i++){const{texture:s}=n[i].style;s&&C1(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function SM(t,e){return t instanceof Wt?(e.push(t),!0):!1}class R1 extends pf{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(SM),this.registerUploadHook(C1),this.registerUploadHook(EM)}}R1.extension={name:"prepare",type:U.RendererSystem};X.add(R1);var TM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,bM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,AM=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Qy=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,CM=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const el=new Pe;class P1 extends Yu{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new B_,this.state=Br.for2d()}contextChange(){const e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=Ir.from(Qy,CM,r),this.shader=e.context.webGLVersion>1?Ir.from(bM,TM,r):Ir.from(Qy,AM,r)}render(e){const r=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=n.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,n.invalidate();const a=e._texture,l=a.baseTexture,u=l.alphaMode>0,c=e.tileTransform.localTransform,h=e.uvMatrix;let d=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;d&&(l._glTextures[r.CONTEXT_UID]?d=l.wrapMode!==Dn.CLAMP:l.wrapMode===Dn.CLAMP&&(l.wrapMode=Dn.REPEAT));const f=d?this.simpleShader:this.shader,p=a.width,m=a.height,x=e._width,y=e._height;el.set(c.a*p/x,c.b*p/y,c.c*m/x,c.d*m/y,c.tx/x,c.ty/y),el.invert(),d?el.prepend(h.mapCoord):(f.uniforms.uMapCoord=h.mapCoord.toArray(!0),f.uniforms.uClampFrame=h.uClampFrame,f.uniforms.uClampOffset=h.uClampOffset),f.uniforms.uTransform=el.toArray(!0),f.uniforms.uColor=Ce.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,r.shader.bind(f),r.geometry.bind(n),this.state.blendMode=__(e.blendMode,u),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}P1.extension={name:"tilingSprite",type:U.RendererPlugin};X.add(P1);const I1=class po{constructor(e,r,n){this.linkedSheets=[],(e instanceof se||e instanceof V)&&(e={texture:e,data:r,resolutionFilename:n});const{texture:i,data:s,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=i instanceof V?i:null,this.baseTexture=i instanceof se?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const l=this.baseTexture.resource;this.resolution=this._updateResolution(o||(l?l.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:r}=this.data.meta;let n=Jr(e,null);return n===null&&(n=typeof r=="number"?r:parseFloat(r??"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=po.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=po.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const i=this._frameKeys[r],s=this._frames[i],o=s.frame;if(o){let a=null,l=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,c=new ae(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new ae(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new ae(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new ae(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new V(this.baseTexture,a,c,l,s.rotated?2:0,s.anchor,s.borders),V.addToCache(this.textures[i],this.cachePrefix+i.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const i=e[r][n];this.animations[r].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*po.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*po.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var r;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((r=this._texture)==null||r.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};I1.BATCH_SIZE=1e3;let Jy=I1;const RM=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function M1(t,e,r){const n={};if(t.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[`${e.cachePrefix}${i}`]=e.textures[i]}),!r){const i=it.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(n,M1([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return n}const PM={extension:U.Asset,cache:{test:t=>t instanceof Jy,getCacheableAssets:(t,e)=>M1(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&RM.includes(n)},parse:t=>{var r;const e=t.split(".");return{resolution:parseFloat(((r=z.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:U.LoadParser,priority:dr.Normal},async testParse(t,e){return it.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){var c,h;const{texture:n,imageFilename:i,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=it.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(n&&n.baseTexture)a=n;else{const d=uf(o+(i??t.meta.image),e.src);a=(await r.load([d]))[d]}const l=new Jy({texture:a.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await l.parse();const u=(c=t==null?void 0:t.meta)==null?void 0:c.related_multi_packs;if(Array.isArray(u)){const d=[];for(const p of u){if(typeof p!="string")continue;let m=o+p;(h=e.data)!=null&&h.ignoreMultiPack||(m=uf(m,e.src),d.push(r.load({src:m,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(d);l.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[l].concat(l.linkedSheets.filter(m=>m!==p))})}return l},unload(t){t.destroy(!0)}}};X.add(PM);class xu{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Cl{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const r=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in r){const o=r[s].match(/^[a-z]+/gm)[0],a=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const u in a){const c=a[u].split("="),h=c[0],d=c[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;l[h]=p}n[o].push(l)}const i=new xu;return n.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),n.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),n.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),n.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),n.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),n.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class mf{static test(e){const r=e;return typeof e!="string"&&"getElementsByTagName"in e&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const r=new xu,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let u=0;u<n.length;u++)r.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(let u=0;u<i.length;u++)r.common.push({lineHeight:parseInt(i[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)r.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const c=o[u];r.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)r.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<l.length;u++)r.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return r}}class gf{static test(e){return typeof e=="string"&&e.includes("<font>")?mf.test(z.ADAPTER.parseXML(e)):!1}static parse(e){return mf.parse(z.ADAPTER.parseXML(e))}}const wh=[Cl,mf,gf];function IM(t){for(let e=0;e<wh.length;e++)if(wh[e].test(t))return wh[e];return null}function MM(t,e,r,n,i,s){const o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,c=t.width/n-l-u*2,h=t.height/n-l-u*2,d=o.slice(),f=r.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),r.fillGradientType===Zu.LINEAR_VERTICAL){a=e.createLinearGradient(c/2,u,c/2,h+u);let p=0;const m=(s.fontProperties.fontSize+r.strokeThickness)/h;for(let x=0;x<i.length;x++){const y=s.lineHeight*x;for(let v=0;v<d.length;v++){let g=0;typeof f[v]=="number"?g=f[v]:g=v/d.length;const w=y/h+g*m;let S=Math.max(p,w);S=Math.min(S,1),a.addColorStop(S,d[v]),p=S}}}else{a=e.createLinearGradient(u,h/2,c+u,h/2);const p=d.length+1;let m=1;for(let x=0;x<d.length;x++){let y;typeof f[x]=="number"?y=f[x]:y=m/p,a.addColorStop(y,d[x]),m++}}return a}function kM(t,e,r,n,i,s,o){const a=r.text,l=r.fontProperties;e.translate(n,i),e.scale(s,s);const u=o.strokeThickness/2,c=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=MM(t,e,o,s,[a],r),e.strokeStyle=o.stroke,o.dropShadow){const h=o.dropShadowColor,d=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor=Ce.shared.setValue(h).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=d,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,c+r.lineHeight-l.descent),o.fill&&e.fillText(a,u,c+r.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Rl(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function k1(t){return Array.from?Array.from(t):t.split("")}function BM(t){typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...k1(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const dn=class _r{constructor(e,r,n){var c;const[i]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=Jr(o.file),u={};this._ownsTextures=n,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=u;for(let h=0;h<e.page.length;h++){const{id:d,file:f}=e.page[h];u[d]=r instanceof Array?r[h]:r[f],a!=null&&a.fieldType&&a.fieldType!=="none"&&(u[d].baseTexture.alphaMode=bt.NO_PREMULTIPLIED_ALPHA,u[d].baseTexture.mipmap=Mr.OFF)}for(let h=0;h<e.char.length;h++){const{id:d,page:f}=e.char[h];let{x:p,y:m,width:x,height:y,xoffset:v,yoffset:g,xadvance:w}=e.char[h];p/=l,m/=l,x/=l,y/=l,v/=l,g/=l,w/=l;const S=new ae(p+u[f].frame.x/l,m+u[f].frame.y/l,x,y);this.chars[d]={xOffset:v,yOffset:g,xAdvance:w,kerning:{},texture:new V(u[f].baseTexture,S),page:f}}for(let h=0;h<e.kerning.length;h++){let{first:d,second:f,amount:p}=e.kerning[h];d/=l,f/=l,p/=l,this.chars[f]&&(this.chars[f].kerning[d]=p)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((c=a==null?void 0:a.fieldType)==null?void 0:c.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,r,n){let i;if(e instanceof xu)i=e;else{const o=IM(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof V&&(r=[r]);const s=new _r(i,r,n);return _r.available[s.font]=s,s}static uninstall(e){const r=_r.available[e];if(!r)throw new Error(`No font found named '${e}'`);r.destroy(),delete _r.available[e]}static from(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:l,...u}=Object.assign({},_r.defaultOptions,n),c=BM(i),h=r instanceof hr?r:new hr(r),d=a,f=new xu;f.info[0]={face:h.fontFamily,size:h.fontSize},f.common[0]={lineHeight:h.fontSize};let p=0,m=0,x,y,v,g=0;const w=[];for(let C=0;C<c.length;C++){x||(x=z.ADAPTER.createCanvas(),x.width=a,x.height=l,y=x.getContext("2d"),v=new se(x,{resolution:o,...u}),w.push(new V(v)),f.page.push({id:w.length-1,file:""}));const b=c[C],E=gn.measureText(b,h,!1,x),R=E.width,M=Math.ceil(E.height),K=Math.ceil((h.fontStyle==="italic"?2:1)*R);if(m>=l-M*o){if(m===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${b}')`);--C,x=null,y=null,v=null,m=0,p=0,g=0;continue}if(g=Math.max(M+E.fontProperties.descent,g),K*o+p>=d){if(p===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${b}')`);--C,m+=g*o,m=Math.ceil(m),p=0,g=0;continue}kM(x,y,E,p,m,o,h);const O=Rl(E.text);f.char.push({id:O,page:w.length-1,x:p/o,y:m/o,width:K,height:M,xoffset:0,yoffset:0,xadvance:R-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0)}),p+=(K+2*s)*o,p=Math.ceil(p)}if(!(n!=null&&n.skipKerning))for(let C=0,b=c.length;C<b;C++){const E=c[C];for(let R=0;R<b;R++){const M=c[R],K=y.measureText(E).width,O=y.measureText(M).width,A=y.measureText(E+M).width-(K+O);A&&f.kerning.push({first:Rl(E),second:Rl(M),amount:A})}}const S=new _r(f,w,!0);return _r.available[e]!==void 0&&_r.uninstall(e),_r.available[e]=S,S}};dn.ALPHA=[["a","z"],["A","Z"]," "],dn.NUMERIC=[["0","9"]],dn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],dn.ASCII=[[" ","~"]],dn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:dn.ALPHANUMERIC},dn.available={};let fn=dn;var NM=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,DM=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const ev=[],tv=[],rv=[],FM=class B1 extends It{constructor(e,r={}){super();const{align:n,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},B1.styleDefaults,r);if(!fn.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new Ce(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Wr(()=>{this.dirty=!0},this,0,0),this._roundPixels=z.ROUND_PIXELS,this.dirty=!0,this._resolution=z.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var K;const e=fn.available[this._fontName],r=this.fontSize,n=r/e.size,i=new me,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=k1(l),c=this._maxWidth*e.size/r,h=e.distanceFieldType==="none"?ev:tv;let d=null,f=0,p=0,m=0,x=-1,y=0,v=0,g=0,w=0;for(let O=0;O<u.length;O++){const A=u[O],B=Rl(A);if(/(?:\s)/.test(A)&&(x=O,y=f,w++),A==="\r"||A===`
`){o.push(f),a.push(-1),p=Math.max(p,f),++m,++v,i.x=0,i.y+=e.lineHeight,d=null,w=0;continue}const H=e.chars[B];if(!H)continue;d&&H.kerning[d]&&(i.x+=H.kerning[d]);const J=rv.pop()||{texture:V.EMPTY,line:0,charCode:0,prevSpaces:0,position:new me};J.texture=H.texture,J.line=m,J.charCode=B,J.position.x=Math.round(i.x+H.xOffset+this._letterSpacing/2),J.position.y=Math.round(i.y+H.yOffset),J.prevSpaces=w,s.push(J),f=J.position.x+Math.max(H.xAdvance-H.xOffset,H.texture.orig.width),i.x+=H.xAdvance+this._letterSpacing,g=Math.max(g,H.yOffset+H.texture.height),d=B,x!==-1&&c>0&&i.x>c&&(++v,vs(s,1+x-v,1+O-x),O=x,x=-1,o.push(y),a.push(s.length>0?s[s.length-1].prevSpaces:0),p=Math.max(p,y),m++,i.x=0,i.y+=e.lineHeight,d=null,w=0)}const S=u[u.length-1];S!=="\r"&&S!==`
`&&(/(?:\s)/.test(S)&&(f=y),o.push(f),p=Math.max(p,f),a.push(-1));const C=[];for(let O=0;O<=m;O++){let A=0;this._align==="right"?A=p-o[O]:this._align==="center"?A=(p-o[O])/2:this._align==="justify"&&(A=a[O]<0?0:(p-o[O])/a[O]),C.push(A)}const b=s.length,E={},R=[],M=this._activePagesMeshData;h.push(...M);for(let O=0;O<b;O++){const A=s[O].texture,B=A.baseTexture.uid;if(!E[B]){let H=h.pop();if(!H){const $=new oM;let I,j;e.distanceFieldType==="none"?(I=new qy(V.EMPTY),j=ee.NORMAL):(I=new qy(V.EMPTY,{program:Vr.from(DM,NM),uniforms:{uFWidth:0}}),j=ee.NORMAL_NPM);const P=new Ky($,I);P.blendMode=j,H={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:P,vertices:null,uvs:null,indices:null}}H.index=0,H.indexCount=0,H.vertexCount=0,H.uvsCount=0,H.total=0;const{_textureCache:J}=this;J[B]=J[B]||new V(A.baseTexture),H.mesh.texture=J[B],H.mesh.tint=this._tintColor.value,R.push(H),E[B]=H}E[B].total++}for(let O=0;O<M.length;O++)R.includes(M[O])||this.removeChild(M[O].mesh);for(let O=0;O<R.length;O++)R[O].mesh.parent!==this&&this.addChild(R[O].mesh);this._activePagesMeshData=R;for(const O in E){const A=E[O],B=A.total;if(!(((K=A.indices)==null?void 0:K.length)>6*B)||A.vertices.length<Ky.BATCHABLE_SIZE*2)A.vertices=new Float32Array(4*2*B),A.uvs=new Float32Array(4*2*B),A.indices=new Uint16Array(6*B);else{const H=A.total,J=A.vertices;for(let $=H*4*2;$<J.length;$++)J[$]=0}A.mesh.size=6*B}for(let O=0;O<b;O++){const A=s[O];let B=A.position.x+C[A.line]*(this._align==="justify"?A.prevSpaces:1);this._roundPixels&&(B=Math.round(B));const H=B*n,J=A.position.y*n,$=A.texture,I=E[$.baseTexture.uid],j=$.frame,P=$._uvs,k=I.index++;I.indices[k*6+0]=0+k*4,I.indices[k*6+1]=1+k*4,I.indices[k*6+2]=2+k*4,I.indices[k*6+3]=0+k*4,I.indices[k*6+4]=2+k*4,I.indices[k*6+5]=3+k*4,I.vertices[k*8+0]=H,I.vertices[k*8+1]=J,I.vertices[k*8+2]=H+j.width*n,I.vertices[k*8+3]=J,I.vertices[k*8+4]=H+j.width*n,I.vertices[k*8+5]=J+j.height*n,I.vertices[k*8+6]=H,I.vertices[k*8+7]=J+j.height*n,I.uvs[k*8+0]=P.x0,I.uvs[k*8+1]=P.y0,I.uvs[k*8+2]=P.x1,I.uvs[k*8+3]=P.y1,I.uvs[k*8+4]=P.x2,I.uvs[k*8+5]=P.y2,I.uvs[k*8+6]=P.x3,I.uvs[k*8+7]=P.y3}this._textWidth=p*n,this._textHeight=(i.y+e.lineHeight)*n;for(const O in E){const A=E[O];if(this.anchor.x!==0||this.anchor.y!==0){let $=0;const I=this._textWidth*this.anchor.x,j=this._textHeight*this.anchor.y;for(let P=0;P<A.total;P++)A.vertices[$++]-=I,A.vertices[$++]-=j,A.vertices[$++]-=I,A.vertices[$++]-=j,A.vertices[$++]-=I,A.vertices[$++]-=j,A.vertices[$++]-=I,A.vertices[$++]-=j}this._maxLineHeight=g*n;const B=A.mesh.geometry.getBuffer("aVertexPosition"),H=A.mesh.geometry.getBuffer("aTextureCoord"),J=A.mesh.geometry.getIndex();B.data=A.vertices,H.data=A.uvs,J.data=A.indices,B.update(),H.update(),J.update()}for(let O=0;O<s.length;O++)rv.push(s[O]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:r,distanceFieldType:n,size:i}=fn.available[this._fontName];if(n!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,u=Math.sqrt(s*s+o*o),c=Math.sqrt(a*a+l*l),h=(Math.abs(u)+Math.abs(c))/2,d=this.fontSize/i,f=e._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=h*r*d*f}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=fn.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!fn.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??fn.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:r}=this,n=fn.available[this._fontName].distanceFieldType==="none"?ev:tv;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>r[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=V.EMPTY});for(const i in r)r[i].destroy(),delete r[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};FM.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const OM=[".xml",".fnt"],LM={extension:{type:U.LoadParser,priority:dr.Normal},name:"loadBitmapFont",test(t){return OM.includes(it.extname(t).toLowerCase())},async testParse(t){return Cl.test(t)||gf.test(t)},async parse(t,e,r){const n=Cl.test(t)?Cl.parse(t):gf.parse(t),{src:i}=e,{page:s}=n,o=[];for(let u=0;u<s.length;++u){const c=s[u].file;let h=it.join(it.dirname(i),c);h=uf(h,i),o.push(h)}const a=await r.load(o),l=o.map(u=>a[u]);return fn.install(n,l,!0)},async load(t,e){return(await z.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};X.add(LM);const yf=class Xi extends hr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new Xi(Object.keys(Xi.defaultOptions).reduce((r,n)=>({...r,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete Xi.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,r={}){const{availableFonts:n}=Xi;if(n[e]){const i=n[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return z.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,o)=>{const a=URL.createObjectURL(i),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(i)})).then(async([i,s])=>{const o=Object.assign({family:it.basename(e,it.extname(e)),weight:"normal",style:"normal",display:"auto",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},r);n[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const r=e.filter(n=>!this._overrides.includes(n));r.length>0&&(this._overrides.push(...r),this.styleID++)}removeOverride(...e){const r=e.filter(n=>this._overrides.includes(n));r.length>0&&(this._overrides=this._overrides.filter(n=>!r.includes(n)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,r)=>`${e}
            @font-face {
                font-family: "${r.family}";
                src: url('${r.dataSrc}');
                font-weight: ${r.weight};
                font-style: ${r.style};
                font-display: ${r.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=CR(e)),typeof e=="number"?AR(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const r=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&r<1&&(e+=(r*255|0).toString(16).padStart(2,"0"));const s=`${n}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,Xi.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(r=>setTimeout(r,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=z.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};yf.availableFonts={},yf.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Eh=yf;const tl=class Yi extends Ci{constructor(e="",r={}){super(V.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,i=V.from(n,{scaleMode:z.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new ae,i.trim=new ae,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),u=document.createElementNS(o,"div"),c=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Yi.defaultMaxWidth,this.maxHeight=Yi.defaultMaxHeight,this._domElement=u,this._styleElement=c,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(c),this._foreignObject.appendChild(u),this._image=n,this._loadImage=new Image,this._autoResolution=Yi.defaultAutoResolution,this._resolution=Yi.defaultResolution??z.RESOLUTION,this.text=e,this.style=r}measureText(e){var c,h;const{text:r,style:n,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:r,style:n.toCSS(i)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",u.toString()),r!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(c=this._style)==null?void 0:c.toCSS(i)}),this._styleElement.textContent=(h=this._style)==null?void 0:h.toGlobalCSS()),{width:l+n.padding*2,height:u+n.padding*2}}async updateText(e=!0){const{style:r,_image:n,_loadImage:i}=this;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();n.width=i.width=Math.ceil(Math.max(1,s)),n.height=i.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{i.onload=async()=>{if(a<this._updateID){l();return}await r.onBeforeDraw(),n.src=i.src,i.onload=null,i.src="",this.updateTexture(),l()};const u=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:r,_image:n,resolution:i}=this,{padding:s}=e,{baseTexture:o}=r;r.trim.width=r._frame.width=n.width/i,r.trim.height=r._frame.height=n.height/i,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-s*2,r.orig.height=r._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(n.width,n.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var n,i,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Yi.defaultDestroyOptions,e),super.destroy(e);const r=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=r,(i=this._svgRoot)==null||i.remove(),this._svgRoot=r,(s=this._domElement)==null||s.remove(),this._domElement=r,(o=this._foreignObject)==null||o.remove(),this._foreignObject=r,(a=this._styleElement)==null||a.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const r=Tn(this.scale.x)||1;this.scale.x=r*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const r=Tn(this.scale.y)||1;this.scale.y=r*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Eh?(this.ownsStyle=!1,this._style=e):e instanceof hr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Eh.from(e)):(this.ownsStyle=!0,this._style=new Eh(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};tl.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},tl.defaultMaxWidth=2024,tl.defaultMaxHeight=2024,tl.defaultAutoResolution=!0;const At={background:1710638,surface:2960708,hitZone:16098851,laneLeft:2972199,laneRight:4886745,textMuted:10526896,perfect:5025616,partial:16098851,miss:15037299},UM=.55,Sh=70,vf=.82,nv=new Map;function jM({width:t,height:e,scheduledEvents:r,activeEvents:n,roundStartTime:i,roundState:s,scrollSpeed:o,currentFeedback:a,onChannelTap:l}){const u=T.useRef(null),c=T.useRef(null),h=T.useRef(new Map),d=T.useRef(null),f=T.useCallback(p=>{var S;if(!l||!u.current)return;let m;"touches"in p?m=((S=p.touches[0])==null?void 0:S.clientX)??0:m=p.clientX;const x=u.current.getBoundingClientRect(),y=m-x.left,v=x.width/2,g=x.width*.1;if(Math.abs(y-v)<g/2)return;const w=y<v?"left":"right";l(w)},[l]);return T.useEffect(()=>{if(!u.current)return;const p=new h1({width:t,height:e,backgroundColor:At.background,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0});u.current.appendChild(p.view),c.current=p,sv(p,t,e),ov(p,t,e),av(p,t,e);const m=new It;return p.stage.addChild(m),d.current=m,()=>{c.current&&(c.current.destroy(!0,{children:!0}),c.current=null),h.current.clear()}},[t,e]),T.useEffect(()=>{if(c.current){c.current.renderer.resize(t,e);const p=c.current;for(;p.stage.children.length>0;)p.stage.removeChildAt(0);sv(p,t,e),ov(p,t,e),av(p,t,e);const m=new It;p.stage.addChild(m),d.current=m,h.current.clear()}},[t,e]),T.useEffect(()=>{const p=d.current;if(!p)return;if(s!=="playing"){p.removeChildren(),h.current.clear();return}if(r.length===0)return;const m=t/2,x=m*UM,y=e*vf;for(const v of r){if(h.current.has(v.event_id))continue;const g=GM(v,m,x,Sh,y,v.spectrogramPath);g.container.y=-Sh,p.addChild(g.container),h.current.set(v.event_id,g)}},[r,s,t,e]),T.useEffect(()=>{if(s!=="playing"||!c.current)return;const p=e*vf;let m;const x=()=>{const y=performance.now(),v=y-i;for(const g of h.current.values())if(g.hasBeenScored&&g.feedbackType){const w=y-g.feedbackStartTime;w>500&&(g.container.alpha=Math.max(0,1-(w-500)/200),g.container.alpha<=0&&(g.container.visible=!1))}else{const w=g.scheduledTimeMs-g.enterTimeMs,S=v-g.enterTimeMs,C=Math.max(0,S/w),b=-Sh,E=p;g.container.y=b+C*(E-b),g.container.y>p+100&&(g.container.alpha=Math.max(0,1-(g.container.y-p-100)/50))}m=requestAnimationFrame(x)};return m=requestAnimationFrame(x),()=>{cancelAnimationFrame(m)}},[s,i,e,o]),T.useEffect(()=>{var p;if(a){for(const m of n)if(m.hasBeenScored&&m.channel===a.channel){const x=h.current.get(m.event_id);x&&!x.feedbackType&&(x.hasBeenScored=!0,x.feedbackType=a.type,x.feedbackStartTime=performance.now(),((p=a.breakdown)==null?void 0:p.speciesCorrect)?(iv(x,a.type,a.score),x.container.scale.set(1.3),setTimeout(()=>{x.container.visible=!1},150)):iv(x,a.type,a.score))}}},[a,n]),_.jsx("div",{ref:u,className:"pixi-game-container",onClick:f,onTouchStart:f,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none"}})}function GM(t,e,r,n,i,s){const o=new It,a=t.channel==="left"?e/2:e+e/2;o.x=a;const l=t.channel==="left"?At.laneLeft:At.laneRight,u=new Wt;if(u.beginFill(l,.4),u.lineStyle(2,l,.8),u.drawRoundedRect(-r/2,-n/2,r,n,8),u.endFill(),o.addChild(u),s){let c=nv.get(s);c||(c=V.from(`/bird-sound-game/${s}`),nv.set(s,c));const h=new Ci(c);h.anchor.set(.5),h.position.set(0,0);const d=r-16,f=n-16;h.width=d,h.height=f,o.addChild(h)}else{const c=new Wt;for(let f=0;f<6;f++){const p=-n/2+10+f*10,m=(Math.random()*.4+.4)*r,x=-m/2+(Math.random()-.5)*20;c.beginFill(16777215,.2+Math.random()*.2),c.drawRect(x,p,m,2),c.endFill()}o.addChild(c);const h=new hr({fontFamily:"Inter, sans-serif",fontSize:18,fill:16777215,fontWeight:"700"}),d=new Bs("?",h);d.anchor.set(.5),d.position.set(0,0),d.alpha=.4,o.addChild(d)}return{container:o,eventId:t.event_id,scheduledTimeMs:t.scheduled_time_ms,enterTimeMs:t.scoring_window_start_ms,channel:t.channel,speciesCode:t.species_code,hasBeenScored:!1,feedbackType:null,feedbackStartTime:0,spectrogramPath:s}}function iv(t,e,r){const n=t.container,i=e==="perfect"||e==="good"?At.perfect:e==="partial"?At.partial:At.miss,s=new Wt,o=100,a=70;if(s.beginFill(i,.5),s.drawRoundedRect(-o/2,-a/2,o,a,8),s.endFill(),n.addChildAt(s,1),r>0){const l=new hr({fontFamily:"JetBrains Mono, monospace",fontSize:20,fontWeight:"700",fill:i,stroke:0,strokeThickness:3}),u=new Bs(`+${r}`,l);u.anchor.set(.5),u.position.set(0,-a/2-15),n.addChild(u)}n.scale.set(1.1),setTimeout(()=>{n.scale.set(1)},100)}function sv(t,e,r){const n=e/2,i=new Wt;i.beginFill(At.background,1),i.drawRect(0,0,n-1,r),i.endFill(),t.stage.addChild(i);const s=new Wt;s.beginFill(At.background,1),s.drawRect(n+1,0,n-1,r),s.endFill(),t.stage.addChild(s);const o=new hr({fontFamily:"Inter, sans-serif",fontSize:14,fill:At.textMuted,fontWeight:"600"}),a=new Bs("LEFT",o);a.anchor.set(.5),a.position.set(n/2,30),a.alpha=.5,t.stage.addChild(a);const l=new Bs("RIGHT",o);l.anchor.set(.5),l.position.set(n+n/2,30),l.alpha=.5,t.stage.addChild(l)}function ov(t,e,r){const n=e/2,i=r*vf,s=4,o=new Wt;o.beginFill(At.hitZone,.8),o.drawRect(20,i,n-40,s),o.endFill(),t.stage.addChild(o);const a=new Wt;a.beginFill(At.hitZone,.8),a.drawRect(n+20,i,n-40,s),a.endFill(),t.stage.addChild(a);const l=new Wt;l.beginFill(At.hitZone,.2),l.drawRect(20,i-2,n-40,s+4),l.endFill(),t.stage.addChild(l);const u=new Wt;u.beginFill(At.hitZone,.2),u.drawRect(n+20,i-2,n-40,s+4),u.endFill(),t.stage.addChild(u)}function av(t,e,r){const n=e/2,i=new Wt,s=20,o=10;let a=0;for(i.beginFill(At.surface,.5);a<r;)i.drawRect(n-1,a,2,s),a+=s+o;i.endFill(),t.stage.addChild(i)}const zM=T.memo(jM),Ui={SPECIES_CORRECT:50,CHANNEL_CORRECT:25};class HM{constructor(e){ln(this,"panner");this.panner=e.createStereoPanner()}get output(){return this.panner}setPan(e){this.panner.pan.value=Math.max(-1,Math.min(1,e))}disconnect(){this.panner.disconnect()}}class lv{constructor(e){ln(this,"ctx");ln(this,"inputGain");ln(this,"leftGain");ln(this,"rightGain");ln(this,"merger");this.ctx=e,this.inputGain=e.createGain(),this.leftGain=e.createGain(),this.rightGain=e.createGain(),this.merger=e.createChannelMerger(2),this.inputGain.connect(this.leftGain),this.inputGain.connect(this.rightGain),this.leftGain.connect(this.merger,0,0),this.rightGain.connect(this.merger,0,1),this.setPan(0)}get output(){return this.inputGain}get destination(){return this.merger}setPan(e){const n=(Math.max(-1,Math.min(1,e))+1)*Math.PI/4,i=Math.cos(n),s=Math.sin(n);this.leftGain.gain.setValueAtTime(i,this.ctx.currentTime),this.rightGain.gain.setValueAtTime(s,this.ctx.currentTime)}disconnect(){this.inputGain.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.merger.disconnect()}}class $M{constructor(){ln(this,"capabilities");this.capabilities=this.detectCapabilities(),console.log("Audio capabilities:",this.capabilities)}detectCapabilities(){const e=navigator.userAgent,r=/iPad|iPhone|iPod/.test(e)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,n=r&&/CriOS/.test(e),i=r&&/FxiOS/.test(e),s=r&&/EdgiOS/.test(e),o=typeof AudioContext<"u"||typeof window.webkitAudioContext<"u",a=o&&typeof StereoPannerNode<"u"&&!n&&!i&&!s;return{supportsStereoPanner:a,supportsWebAudio:o,isIOSChrome:n,isIOS:r,browserInfo:`iOS: ${r}, Chrome: ${n}, StereoPanner: ${a}`}}getCapabilities(){return{...this.capabilities}}supportsStereoPanner(){return this.capabilities.supportsStereoPanner}isIOSChrome(){return this.capabilities.isIOSChrome}createPanner(e){return this.capabilities.supportsStereoPanner?new HM(e):new lv(e)}createChannelPanner(e,r){const n=this.createPanner(e);return n.setPan(r==="left"?-1:1),n}connectPannerToDestination(e,r){e instanceof lv?e.destination.connect(r):e.output.connect(r)}}let Th=null;function uv(){return Th||(Th=new $M),Th}const cv={low:100,medium:150,high:200},WM={level_id:1,pack_id:"common_se_birds",mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},VM={NOCA:"#E57373",CARW:"#81C784",BLJA:"#4FC3F7",AMCR:"#424242",TUTI:"#FFD54F",BEKI:"#00BCD4",RSHA:"#8D6E63",AMGO:"#FFEB3B",CACH:"#B0BEC5",PIWA:"#AED581",WTSP:"#BCAAA4",HOFI:"#EF9A9A",EABL:"#64B5F6",AMRO:"#FF8A65",HETH:"#D7CCC8",BHNU:"#A1887F",BRCR:"#8D6E63",WBNU:"#80CBC4",YBSA:"#FFF59D",RBWO:"#CE93D8",DOWO:"#90A4AE",HAWO:"#CFD8DC",NOFL:"#FFCC80",PIWO:"#B39DDB",BRTH:"#A1887F",GRCA:"#78909C",MODO:"#BCAAA4"};function XM(t){let e=t;return()=>(e=e*1103515245+12345&2147483647,e/2147483647)}function YM(t=WM){const e=T.useRef(null),r=T.useRef(new Map),n=T.useRef(new Map),i=T.useRef(new Map),s=T.useRef(new Map),o=T.useRef(new Map),a=T.useRef(null),[l,u]=T.useState([]),[c,h]=T.useState([]),[d,f]=T.useState([]);T.useEffect(()=>{console.log("species state changed, now has",d.length,"species:",d.map(F=>F.code))},[d]);const[p,m]=T.useState("idle"),[x,y]=T.useState(0),[v,g]=T.useState(0),[w,S]=T.useState(t.round_duration_sec),[C,b]=T.useState(0),[E,R]=T.useState(0),[M,K]=T.useState(0),[O,A]=T.useState(0),[B,H]=T.useState(0),[J,$]=T.useState([]),[I,j]=T.useState([]),[P,k]=T.useState(0),q=T.useRef(1),fe=5e3,[ue,Ie]=T.useState(()=>{const F=cv[t.event_density]||100,te=localStorage.getItem("soundfield_scroll_speed"),ie=te?parseFloat(te):.5;return q.current=ie,F*ie}),[ve,xe]=T.useState(null),[Je,Ye]=T.useState(!0),Me=T.useRef(null),_e=T.useRef([]),be=T.useRef(0),ke=T.useRef([]),mt=T.useRef(new Set),wt=T.useRef(0),Nr=T.useRef(0),js=T.useRef(0),rn=T.useRef(0),Qu=T.useRef(0),Ri=T.useRef(0),fa=T.useRef([]),Bp=T.useRef([]),Ju=T.useRef(0),nn=T.useRef(null),Et=T.useRef(null),sn=T.useRef({left:null,right:null}),ct=T.useRef({left:null,right:null}),Np=T.useCallback(async()=>{var F;console.log("loadClips called with level:",{pack_id:t.pack_id,species_pool_length:(F=t.species_pool)==null?void 0:F.length,species_count:t.species_count});try{const te=await fetch("/bird-sound-game/data/clips.json");if(!te.ok)throw new Error("Failed to load clips.json");const ie=await te.json();u(ie);const Q=t.species_pool,oe=Q?new Set(Q):null,re=new Map;for(const Ee of ie)oe&&!oe.has(Ee.species_code)||re.has(Ee.species_code)||re.set(Ee.species_code,{code:Ee.species_code,name:Ee.common_name,color:VM[Ee.species_code]});const le=Array.from(re.values());h(le),!t.species_count||le.length<=t.species_count,f(le)}catch(te){console.error("Error loading clips:",te)}},[t.species_pool,t.species_count]),Dp=T.useCallback(async()=>{if(e.current){console.log("initializeAudio: Already initialized, setting isAudioReady"),Ye(!0);return}try{const F=uv();console.log("initializeAudio: Browser capabilities:",F.getCapabilities());const te=new AudioContext;e.current=te,console.log("initializeAudio: AudioContext created, state:",te.state),te.state==="suspended"&&(console.log("initializeAudio: AudioContext suspended, attempting resume..."),await te.resume(),console.log("initializeAudio: AudioContext resumed, state:",te.state)),Ye(!0),console.log("initializeAudio: Audio is ready!")}catch(F){console.error("initializeAudio: Failed to initialize audio:",F),Ye(!0)}},[]),Fp=T.useCallback(async F=>{const te=e.current;if(!te)throw new Error("Audio context not initialized");const ie=r.current.get(F);if(ie)return console.log("loadAudioBuffer: Using cached buffer for",F),ie;console.log("loadAudioBuffer: Fetching",F);const Q=await fetch(`/bird-sound-game/${F}`);if(!Q.ok)throw console.error("loadAudioBuffer: Fetch failed",Q.status,Q.statusText),new Error(`Failed to load audio: ${F}`);console.log("loadAudioBuffer: Fetch OK, decoding...");const oe=await Q.arrayBuffer(),re=await te.decodeAudioData(oe);return console.log("loadAudioBuffer: Decoded OK, duration:",re.duration),r.current.set(F,re),re},[]),Op=T.useCallback(async(F,te,ie,Q)=>{const oe=e.current;if(!oe){console.error("playAudio: No AudioContext!");return}console.log("playAudio:",F,"ctx.state:",oe.state);try{oe.state==="suspended"&&(console.log("playAudio: Context suspended, trying to resume..."),await oe.resume());const re=await Fp(F);console.log("playAudio: Buffer loaded, duration:",re.duration);const le=uv();console.log("playAudio: Using adapter, capabilities:",le.getCapabilities());const Ee=oe.createBufferSource(),Se=oe.createGain(),pe=le.createChannelPanner(oe,te);Se.gain.value=.05,Ee.buffer=re,Ee.connect(Se),Se.connect(pe.output),le.connectPannerToDestination(pe,oe.destination),Ee.loop=!0,n.current.set(ie,Ee),i.current.set(ie,Se),s.current.set(ie,pe),o.current.set(ie,Q),Ee.onended=()=>{n.current.delete(ie),i.current.delete(ie);const ge=s.current.get(ie);ge&&(ge.disconnect(),s.current.delete(ie)),o.current.delete(ie)},Ee.start(),console.log("playAudio: Started playing")}catch(re){console.error("Error playing audio:",re)}},[Fp]),Gs=T.useCallback(F=>{const te=n.current.get(F);if(te)try{te.stop()}catch{}const ie=s.current.get(F);ie&&ie.disconnect(),n.current.delete(F),i.current.delete(F),s.current.delete(F),o.current.delete(F)},[]),Lp=T.useCallback((F,te,ie,Q)=>{const oe=te.filter(L=>L.species_code===F&&!L.rejected);if(oe.length===0)return[];const re=oe.filter(L=>L.canonical),le=oe.filter(L=>!L.canonical);if(ie==="canonical")return re.length>0?re:oe.slice(0,1);if(ie==="all")return oe;const Ee=ie,Se=[];re.length>0&&Se.push(...re);const pe=[...le];for(let L=pe.length-1;L>0;L--){const ne=Math.floor(Q()*(L+1));[pe[L],pe[ne]]=[pe[ne],pe[L]]}const ge=Ee-Se.length;return Se.push(...pe.slice(0,ge)),Se},[]),Up=T.useCallback(F=>{const te=[],ie=Date.now(),Q=XM(ie),oe=t.clip_selection??(t.canonical_only?"canonical":"all");let re;if(F&&F.length>0)re=[...F];else if(t.species_pool&&t.species_pool.length>0)re=[...t.species_pool];else{const ge=new Set;for(const ne of l)ne.rejected||ge.add(ne.species_code);const L=Array.from(ge);for(let ne=L.length-1;ne>0;ne--){const fr=Math.floor(Q()*(ne+1));[L[ne],L[fr]]=[L[fr],L[ne]]}re=L.slice(0,t.species_count)}const le=new Map;for(const ge of re){const L=Lp(ge,l,oe,Q);L.length>0&&le.set(ge,L)}if(re=re.filter(ge=>le.has(ge)),re.length===0)return console.error("No species with available clips!"),[];console.log("generateEvents:",{clipSelection:oe,selectedSpecies:re,clipsPerSpecies:Object.fromEntries(Array.from(le.entries()).map(([ge,L])=>[ge,L.map(ne=>ne.clip_id)]))});const Ee=3,Se=new Map,pe=Math.ceil(t.round_duration_sec/2)+5;for(let ge=0;ge<pe;ge++){const L=re[Math.floor(Q()*re.length)],ne=le.get(L)||[],fr=ne.filter(zs=>(Se.get(zs.clip_id)||0)<Ee),on=fr.length>0?fr:ne,ze=on[Math.floor(Q()*on.length)];if(!ze)continue;Se.set(ze.clip_id,(Se.get(ze.clip_id)||0)+1);const an=Q()<.5?"left":"right";te.push({event_id:`evt_${ge}_${ie}`,clip_id:ze.clip_id,species_code:L,channel:an,scheduled_time_ms:0,scoring_window_start_ms:0,scoring_window_end_ms:0,duration_ms:ze.duration_ms,vocalization_type:ze.vocalization_type})}return te},[l,t,Lp]),jp=T.useCallback(F=>l.find(te=>te.clip_id===F),[l]),Kt=T.useCallback(F=>{const te=Bp.current,ie=Ju.current,Q=t.channel_mode||"single",oe=fe/q.current;if(ie>=te.length){Q==="single"?nn.current=null:F&&(sn.current[F]=null);return}const re=performance.now(),le=be.current,Ee=re-le;if(t.round_duration_sec*1e3-Ee<2e3){Q==="single"?nn.current=null:F&&(sn.current[F]=null);return}const L=te[ie];Ju.current=ie+1;let ne;if(Q==="offset"&&F?ne=F:ne=L.channel,Q==="single")Et.current!==null&&(clearTimeout(Et.current),Et.current=null);else{const qt=ct.current[ne];qt!==null&&(clearTimeout(qt),ct.current[ne]=null)}const fr=Ee,on=Ee+oe,ze={...L,channel:ne,scheduled_time_ms:on,scoring_window_start_ms:fr,scoring_window_end_ms:on+500};Q==="single"?nn.current=ze.event_id:sn.current[ne]=ze.event_id;const an=jp(ze.clip_id);if(!an){console.error("spawnNextEvent: clip not found for clip_id:",ze.clip_id,"species:",ze.species_code),Q==="single"?Kt():F&&Kt(F);return}ke.current.push(ze);const zs={...ze,spectrogramPath:an.spectrogram_path||null,filePath:an.file_path};j(qt=>[...qt,zs]),Op(an.file_path,ne,ze.event_id,ze.scheduled_time_ms),$(qt=>[...qt,{...ze,isActive:!0,hasBeenScored:!1}]);const ec=oe+500,Ii=ze.event_id,Hs=ne,Xp=ze.species_code,Yp=window.setTimeout(()=>{if(Q==="single"){if(nn.current!==Ii)return;Et.current=null}else{if(sn.current[Hs]!==Ii)return;ct.current[Hs]=null}Gs(Ii),$(qt=>qt.map(Mi=>Mi.event_id===Ii?{...Mi,isActive:!1}:Mi)),$(qt=>{const Mi=qt.find(pa=>pa.event_id===Ii);if(Mi&&!Mi.hasBeenScored){H(ki=>ki+1),Qu.current+=1,g(0),fa.current.push({expectedSpecies:Xp,guessedSpecies:null,channel:Hs});const pa={id:`miss_${Date.now()}`,type:"miss",score:0,breakdown:{speciesCorrect:!1,channelCorrect:!1,timingAccuracy:"miss",speciesPoints:0,channelPoints:0,timingPoints:0,totalPoints:0},channel:Hs,timestamp:performance.now(),expectedSpecies:Xp};xe(pa),setTimeout(()=>{xe(ki=>(ki==null?void 0:ki.id)===pa.id?null:ki)},1500)}return qt}),window.setTimeout(()=>{Q==="single"?Kt():Kt(Hs)},200)},ec);Q==="single"?Et.current=Yp:ct.current[ne]=Yp},[jp,Op,Gs,t.round_duration_sec,t.channel_mode]),Gp=T.useCallback((F,te)=>{if((t.channel_mode||"single")==="single"){if(nn.current!==F)return;Et.current!==null&&(clearTimeout(Et.current),Et.current=null),nn.current=null,Gs(F),Kt()}else{if(sn.current[te]!==F)return;const Q=ct.current[te];Q!==null&&(clearTimeout(Q),ct.current[te]=null),sn.current[te]=null,Gs(F),Kt(te)}},[Gs,Kt,t.channel_mode]),zp=T.useCallback(async()=>{console.log("initialize: Starting...");try{await Promise.all([Np().catch(F=>console.error("initialize: loadClips failed:",F)),Dp().catch(F=>console.error("initialize: initializeAudio failed:",F))])}catch(F){console.error("initialize: Failed:",F)}Ye(!0),console.log("initialize: Complete, isAudioReady forced to true")},[Np,Dp]),Hp=T.useCallback(async()=>{if(console.log("startRound called, roundState:",p,"clips.length:",l.length),p!=="idle"||l.length===0)return;let F=e.current;if(F||(F=new AudioContext,e.current=F,console.log("AudioContext created during tap")),F.state==="suspended")try{await F.resume(),console.log("AudioContext resumed, state:",F.state)}catch(pe){console.error("Failed to resume AudioContext:",pe)}console.log("AudioContext state:",F.state),Ye(!0);const te=cv[t.event_density]||100,ie=localStorage.getItem("soundfield_scroll_speed"),Q=ie?parseFloat(ie):.5;q.current=Q,Ie(te*Q),y(0),g(0),b(0),R(0),K(0),A(0),H(0),$([]),j([]),xe(null),S(t.round_duration_sec),mt.current.clear(),wt.current=0,Nr.current=0,js.current=0,rn.current=0,Qu.current=0,Ri.current=0,fa.current=[],ke.current=[];let oe;if(console.log("startRound: allPoolSpecies.length =",c.length,"species_count =",t.species_count),t.species_count&&c.length>t.species_count){const pe=[...c];for(let L=pe.length-1;L>0;L--){const ne=Math.floor(Math.random()*(L+1));[pe[L],pe[ne]]=[pe[ne],pe[L]]}const ge=pe.slice(0,t.species_count).sort((L,ne)=>L.code.localeCompare(ne.code));console.log("Random selection: setting species to",ge.length,"species:",ge.map(L=>L.code)),f(ge),oe=ge.map(L=>L.code)}else console.log("Using all pool species:",c.length),f(c),oe=c.map(pe=>pe.code);const re=Up(oe);Bp.current=re,Ju.current=0,nn.current=null,Et.current!==null&&(clearTimeout(Et.current),Et.current=null),sn.current={left:null,right:null},ct.current.left!==null&&clearTimeout(ct.current.left),ct.current.right!==null&&clearTimeout(ct.current.right),ct.current={left:null,right:null};const le=performance.now();if(m("playing"),k(le),be.current=le,(t.channel_mode||"single")==="single")Kt();else{Kt("left");const ge=window.setTimeout(()=>{Kt("right")},1500);_e.current.push(ge)}Me.current=window.setInterval(()=>{S(pe=>pe<=1?(Pi(),0):pe-1)},1e3);const Se=window.setTimeout(()=>{Pi()},t.round_duration_sec*1e3);_e.current.push(Se)},[p,l.length,t.round_duration_sec,t.channel_mode,t.species_count,c,Up,Kt]),Pi=T.useCallback(()=>{m("ended"),Me.current&&(clearInterval(Me.current),Me.current=null),Et.current!==null&&(clearTimeout(Et.current),Et.current=null),nn.current=null,ct.current.left!==null&&clearTimeout(ct.current.left),ct.current.right!==null&&clearTimeout(ct.current.right),ct.current={left:null,right:null},sn.current={left:null,right:null};for(const Q of _e.current)clearTimeout(Q);_e.current=[];for(const Q of n.current.values())try{Q.stop()}catch{}for(const Q of s.current.values())Q.disconnect();n.current.clear(),i.current.clear(),s.current.clear(),o.current.clear();const F={};for(const Q of ke.current){const oe=Q.species_code;F[oe]||(F[oe]={total:0,correct:0}),F[oe].total++,mt.current.has(Q.event_id)&&F[oe].correct++}const te=mt.current.size,ie={score:Nr.current,eventsScored:te,totalEvents:ke.current.length,speciesCorrect:js.current,channelCorrect:rn.current,perfectCount:wt.current,missCount:Qu.current,maxStreak:Ri.current,speciesResults:F,species:d.map(Q=>({code:Q.code,name:Q.name})),mode:t.mode,packId:t.pack_id,levelId:t.level_id,levelTitle:t.title,confusionData:fa.current};localStorage.setItem("soundfield_round_results",JSON.stringify(ie))},[d,t.mode,t.pack_id,t.level_id,t.title]),$p=T.useCallback((F,te,ie,Q)=>{const oe=te===F.species_code,re=ie===F.channel,le=F.scheduled_time_ms,Ee=F.scoring_window_start_ms,Se=le-Ee,pe=le-Q,ge=Math.max(0,Math.min(1,pe/Se));let L,ne;ge>=.75?(L=1,ne="perfect"):ge>=.5?(L=.75,ne="perfect"):ge>=.25?(L=.5,ne="partial"):(L=.25,ne="partial");const fr=oe?Ui.SPECIES_CORRECT:0,on=oe&&re?Ui.CHANNEL_CORRECT:0,ze=fr+on,an=Math.round(ze*L),zs=Math.round(fr*L),ec=Math.round(on*L);return{speciesPoints:zs,channelPoints:ec,timingPoints:0,totalPoints:an,speciesCorrect:oe,channelCorrect:re,timingAccuracy:ne}},[]),Wp=T.useCallback((F,te)=>{if(p!=="playing")return;const ie=performance.now(),Q=ie-be.current,oe=t.channel_mode||"single",re=J.find(L=>!(L.hasBeenScored||Q<L.scoring_window_start_ms||Q>L.scoring_window_end_ms||oe==="offset"&&L.channel!==te));if(!re)return;const le=$p(re,F,te,Q);fa.current.push({expectedSpecies:re.species_code,guessedSpecies:F,channel:re.channel}),le.speciesCorrect&&mt.current.add(re.event_id),Gp(re.event_id,re.channel),$(L=>L.map(ne=>ne.event_id===re.event_id?{...ne,hasBeenScored:!0}:ne)),y(L=>L+le.totalPoints),Nr.current+=le.totalPoints,b(L=>L+1),le.speciesCorrect&&(R(L=>L+1),js.current+=1),le.channelCorrect&&(K(L=>L+1),rn.current+=1);const Ee=Ui.SPECIES_CORRECT+Ui.CHANNEL_CORRECT;le.totalPoints===Ee?(A(L=>L+1),wt.current+=1,g(L=>{const ne=L+1;return Ri.current=Math.max(Ri.current,ne),ne})):le.totalPoints>0?g(L=>{const ne=L+1;return Ri.current=Math.max(Ri.current,ne),ne}):g(0);let Se;const pe=Ui.SPECIES_CORRECT+Ui.CHANNEL_CORRECT;le.totalPoints===pe?Se="perfect":le.speciesCorrect&&le.channelCorrect?Se="good":le.speciesCorrect?Se="partial":Se="miss";const ge={id:`feedback_${Date.now()}`,type:Se,score:le.totalPoints,breakdown:le,channel:re.channel,timestamp:ie,expectedSpecies:Se==="miss"?re.species_code:void 0};xe(ge),setTimeout(()=>{xe(L=>(L==null?void 0:L.id)===ge.id?null:L)},Se==="miss"?1500:500)},[p,J,$p,Gp,t.channel_mode]),Vp=T.useCallback(()=>{Pi(),m("idle"),y(0),g(0),b(0),R(0),K(0),A(0),H(0),$([]),j([]),k(0),xe(null),S(t.round_duration_sec)},[Pi,t.round_duration_sec]);T.useEffect(()=>{if(p!=="playing"){a.current&&(cancelAnimationFrame(a.current),a.current=null);return}const F=()=>{var Q;const te=performance.now()-be.current,ie=fe/q.current;for(const[oe,re]of i.current.entries()){const le=o.current.get(oe);if(le===void 0)continue;const Ee=le-te,pe=.05+Math.max(0,Math.min(1,1-Ee/ie))*.95;re.gain.setValueAtTime(pe,((Q=e.current)==null?void 0:Q.currentTime)||0)}a.current=requestAnimationFrame(F)};return a.current=requestAnimationFrame(F),()=>{a.current&&cancelAnimationFrame(a.current)}},[p]),T.useEffect(()=>()=>{Me.current&&clearInterval(Me.current),a.current&&cancelAnimationFrame(a.current);for(const F of _e.current)clearTimeout(F);for(const F of n.current.values())try{F.stop()}catch{}},[]);const N1={roundState:p,score:x,streak:v,timeRemaining:w,totalTime:t.round_duration_sec,eventsScored:C,speciesCorrect:E,channelCorrect:M,perfectCount:O,missCount:B,activeEvents:J,scheduledEvents:I,roundStartTime:P,scrollSpeed:ue,currentFeedback:ve,species:d,isAudioReady:Je},D1=T.useMemo(()=>({initialize:zp,startRound:Hp,endRound:Pi,submitInput:Wp,reset:Vp}),[zp,Hp,Pi,Wp,Vp]);return[N1,D1]}const hv=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F"],dv={campaign:{mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},practice:{mode:"practice",round_duration_sec:60,species_count:3,event_density:"low",overlap_probability:0,scoring_window_ms:3e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},challenge:{mode:"challenge",round_duration_sec:60,species_count:8,event_density:"medium",overlap_probability:0,scoring_window_ms:1500,spectrogram_mode:"fading",clip_selection:"all",channel_mode:"offset"},random:{mode:"random",round_duration_sec:45,species_count:6,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"all",channel_mode:"single"}};function KM(){const t=kr(),[e]=Ox(),r=T.useRef(null),[n,i]=T.useState({width:400,height:400}),[s,o]=T.useState(null),[a,l]=T.useState(null),[u,c]=T.useState([]),h=e.get("mode")||"campaign",d=e.get("pack")||"common_se_birds",f=parseInt(e.get("level")||"1",10);T.useEffect(()=>{console.log("Fetching levels.json..."),fetch("/bird-sound-game/data/levels.json").then(E=>E.json()).then(E=>{console.log("Loaded",E.length,"levels from levels.json"),c(E)}).catch(E=>{console.error("Failed to load levels.json:",E)})},[]);const p=T.useMemo(()=>{var R;if(console.log("levelConfig useMemo: mode =",h,"packId =",d,"campaignLevels.length =",u.length),h==="campaign"&&u.length>0){const M=u.find(O=>O.pack_id===d&&O.level_id===f);if(M)return console.log("Found level from levels.json:",M.pack_id,M.title,"species_pool:",(R=M.species_pool)==null?void 0:R.length),M;const K=u.find(O=>O.pack_id===d);return K?(console.log("Using first level for pack:",K.pack_id,K.title),K):(console.log("Ultimate fallback to first level"),u[0])}console.log("Using hardcoded MODE_CONFIGS (no campaign levels loaded yet)");const E=dv[h]||dv.campaign;return{level_id:1,pack_id:d,...E}},[h,d,f,u]),[m,x]=YM(p),y=T.useRef(null);T.useEffect(()=>{var M;if(h==="campaign"&&u.length===0){console.log("Waiting for levels.json to load...");return}const E=((M=p.species_pool)==null?void 0:M.length)??"none",R=`${p.pack_id}-${p.level_id}-${E}`;console.log("Init effect: key =",R,"lastKey =",y.current),y.current!==R&&(y.current=R,console.log("Initializing for",R),x.initialize())},[h,u.length,p.pack_id,p.level_id,p.species_pool,x]),T.useEffect(()=>{const E=()=>{if(r.current){const R=r.current.getBoundingClientRect();i({width:R.width,height:R.height})}};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const v=m.species.map((E,R)=>({code:E.code,name:E.name,color:E.color||hv[R%hv.length]})),g=T.useCallback(E=>{o(E);const R=document.getElementById(`flash-${E}`);R&&(R.classList.add("active"),setTimeout(()=>R.classList.remove("active"),150)),a&&(x.submitInput(a,E),o(null),l(null))},[a,x]),w=T.useCallback(E=>{l(E),s&&(x.submitInput(E,s),o(null),l(null))},[s,x]);T.useEffect(()=>{const E=R=>{if(m.roundState==="playing"){if(R.key==="a"||R.key==="A"||R.key==="ArrowLeft"||R.key==="1")g("left");else if(R.key==="d"||R.key==="D"||R.key==="ArrowRight"||R.key==="2")g("right");else if(R.key>="3"&&R.key<="9"){const M=parseInt(R.key)-3;M<v.length&&w(v[M].code)}}};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[m.roundState,g,w,v]);const S=T.useCallback(()=>{x.reset(),t("/")},[t,x]),C=T.useCallback(()=>{console.log("handleStart clicked, isAudioReady:",m.isAudioReady,"species.length:",m.species.length),m.isAudioReady&&m.species.length>0?(console.log("Calling startRound..."),x.startRound()):console.log("Not calling startRound - conditions not met")},[m.isAudioReady,m.species.length,x]),b=T.useCallback(()=>{x.endRound(),t("/summary")},[t,x]);return T.useEffect(()=>{m.roundState==="ended"&&t("/summary")},[m.roundState,t]),_.jsxs("div",{className:"gameplay-screen",children:[_.jsx(jT,{score:m.score,streak:m.streak,timeRemaining:m.timeRemaining,mode:h,levelId:p.level_id,levelTitle:p.title}),_.jsx("button",{className:"back-button",onClick:S,"aria-label":"Back to menu",children:_.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:_.jsx("path",{d:"M15 18l-6-6 6-6"})})}),_.jsxs("div",{ref:r,className:"game-container",children:[_.jsx(zM,{width:n.width,height:n.height,scheduledEvents:m.scheduledEvents,activeEvents:m.activeEvents,roundStartTime:m.roundStartTime,roundState:m.roundState,scrollSpeed:m.scrollSpeed,currentFeedback:m.currentFeedback,onChannelTap:g}),_.jsx("div",{id:"flash-left",className:"channel-flash left"}),_.jsx("div",{id:"flash-right",className:"channel-flash right"}),s&&_.jsx("div",{className:`channel-indicator ${s}`,children:s.toUpperCase()}),m.roundState==="idle"&&_.jsx("div",{className:"start-overlay",children:_.jsx("button",{className:"start-button",onClick:C,disabled:!m.isAudioReady||m.species.length===0,children:m.isAudioReady&&m.species.length>0?"Start Round":"Loading..."})}),m.currentFeedback&&_.jsxs("div",{className:`feedback-overlay ${m.currentFeedback.type} ${m.currentFeedback.channel}`,children:[_.jsxs("div",{className:"feedback-score",children:["+",m.currentFeedback.score]}),_.jsx("div",{className:"feedback-type",children:m.currentFeedback.type.toUpperCase()}),m.currentFeedback.type==="miss"&&m.currentFeedback.expectedSpecies&&_.jsxs("div",{className:"feedback-correct",children:["Was: ",m.currentFeedback.expectedSpecies]})]})]}),_.jsxs("div",{className:"dual-input-panel",children:[_.jsxs("div",{className:"input-column left",children:[_.jsx("div",{className:"column-label",children:"LEFT EAR"}),_.jsx("div",{className:"species-buttons",children:v.map(E=>_.jsx("button",{className:`species-btn ${a===E.code?"selected":""}`,style:{borderColor:E.color,backgroundColor:a===E.code?E.color:void 0},onClick:()=>{x.submitInput(E.code,"left");const R=document.getElementById("flash-left");R&&(R.classList.add("active"),setTimeout(()=>R.classList.remove("active"),150))},disabled:m.roundState!=="playing",children:E.code},E.code))})]}),_.jsxs("div",{className:"input-column right",children:[_.jsx("div",{className:"column-label",children:"RIGHT EAR"}),_.jsx("div",{className:"species-buttons",children:v.map(E=>_.jsx("button",{className:`species-btn ${a===E.code?"selected":""}`,style:{borderColor:E.color,backgroundColor:a===E.code?E.color:void 0},onClick:()=>{x.submitInput(E.code,"right");const R=document.getElementById("flash-right");R&&(R.classList.add("active"),setTimeout(()=>R.classList.remove("active"),150))},disabled:m.roundState!=="playing",children:E.code},E.code))})]})]}),m.roundState==="playing"&&_.jsx("button",{className:"dev-end-button",onClick:b,children:"End Round (dev)"}),_.jsx("style",{children:`
        .gameplay-screen {
          display: flex;
          flex-direction: column;
          height: 100%;
          background-color: var(--color-background);
          overflow: hidden;
        }

        .back-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 8px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-text);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .back-button:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .game-container {
          flex: 1;
          position: relative;
          min-height: 0;
          overflow: hidden;
        }

        .channel-flash {
          position: absolute;
          top: 0;
          bottom: 0;
          width: 50%;
          pointer-events: none;
          background: transparent;
          transition: background 0.1s;
        }

        .channel-flash.left {
          left: 0;
        }

        .channel-flash.right {
          right: 0;
        }

        .channel-flash.active {
          background: rgba(255, 255, 255, 0.1);
        }

        .channel-indicator {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 8px 16px;
          background: var(--color-accent);
          color: var(--color-background);
          font-weight: 700;
          font-size: 14px;
          border-radius: 4px;
          pointer-events: none;
          animation: fadeIn 0.15s ease-out;
        }

        .channel-indicator.left {
          left: 20px;
        }

        .channel-indicator.right {
          right: 20px;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-50%) scale(0.9);
          }
          to {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
        }

        .start-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(0, 0, 0, 0.7);
          z-index: 50;
        }

        .start-button {
          padding: 16px 32px;
          font-size: 18px;
          font-weight: 700;
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: transform 0.2s, background 0.2s;
        }

        .start-button:hover:not(:disabled) {
          transform: scale(1.05);
          background: var(--color-accent);
        }

        .start-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .feedback-overlay {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 12px 20px;
          border-radius: 8px;
          pointer-events: none;
          animation: feedbackPop 0.5s ease-out forwards;
          z-index: 60;
        }

        .feedback-overlay.left {
          left: 20%;
        }

        .feedback-overlay.right {
          right: 20%;
        }

        .feedback-overlay.perfect {
          background: var(--color-success);
        }

        .feedback-overlay.good {
          background: #4CAF50;
        }

        .feedback-overlay.partial {
          background: var(--color-accent);
        }

        .feedback-overlay.miss {
          background: var(--color-error);
          animation: feedbackPopMiss 1.5s ease-out forwards;
        }

        .feedback-score {
          font-family: var(--font-mono);
          font-size: 24px;
          font-weight: 700;
          color: white;
          text-align: center;
        }

        .feedback-type {
          font-size: 12px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          text-align: center;
        }

        .feedback-correct {
          font-size: 14px;
          font-weight: 700;
          color: white;
          text-align: center;
          margin-top: 4px;
          padding-top: 4px;
          border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes feedbackPop {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          20% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          40% {
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-80%) scale(1);
          }
        }

        @keyframes feedbackPopMiss {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          5% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          10% {
            transform: translateY(-50%) scale(1);
          }
          85% {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-70%) scale(1);
          }
        }

        .dev-end-button {
          position: absolute;
          bottom: calc(170px + var(--safe-area-bottom, 0px));
          right: 8px;
          padding: 4px 8px;
          font-size: 10px;
          background: var(--color-surface);
          border: 1px solid var(--color-text-muted);
          border-radius: 4px;
          color: var(--color-text-muted);
          cursor: pointer;
          opacity: 0.5;
          z-index: 100;
        }

        .dev-end-button:hover {
          opacity: 1;
        }

        .dual-input-panel {
          display: flex;
          justify-content: space-between;
          padding: 8px 12px;
          padding-bottom: calc(12px + var(--safe-area-bottom, 0px));
          background: linear-gradient(0deg, var(--color-surface) 0%, rgba(26, 26, 46, 0.9) 100%);
          gap: 20px;
        }

        .input-column {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }

        .input-column.left {
          align-items: flex-start;
        }

        .input-column.right {
          align-items: flex-end;
        }

        .column-label {
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          padding: 2px 8px;
          border-radius: 4px;
        }

        .input-column.left .column-label {
          color: #81C784;
          background: rgba(129, 199, 132, 0.15);
        }

        .input-column.right .column-label {
          color: #64B5F6;
          background: rgba(100, 181, 246, 0.15);
        }

        .species-buttons {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
        }

        .input-column.left .species-buttons {
          justify-content: flex-start;
        }

        .input-column.right .species-buttons {
          justify-content: flex-end;
        }

        .species-btn {
          width: 48px;
          height: 48px;
          border-radius: 50%;
          border: 3px solid;
          background: var(--color-surface);
          color: var(--color-text);
          font-size: 10px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.15s ease-out;
          touch-action: manipulation;
          -webkit-tap-highlight-color: transparent;
        }

        .species-btn:hover:not(:disabled) {
          transform: scale(1.1);
        }

        .species-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .species-btn.selected {
          color: var(--color-background);
          transform: scale(1.05);
        }

        .species-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }
      `})]})}const qM=6;function ZM(){const t=kr(),[e,r]=T.useState(null),[n,i]=T.useState([]),[s,o]=T.useState([]);T.useEffect(()=>{var d;const h=localStorage.getItem("soundfield_round_results");if(h)try{const f=JSON.parse(h);if(r(f),f.mode==="campaign"&&f.levelId){const m="soundfield_progress",x=JSON.parse(localStorage.getItem(m)||"{}"),y=`level_${f.levelId}`,v=((d=x[y])==null?void 0:d.bestScore)||0;x[y]={completed:!0,bestScore:Math.max(v,f.score),accuracy:f.totalEvents>0?Math.round(f.eventsScored/f.totalEvents*100):0},localStorage.setItem(m,JSON.stringify(x))}const p=[];for(const m of f.species){const x=f.speciesResults[m.code]||{total:0,correct:0};x.total>0&&p.push({code:m.code,name:m.name,total:x.total,correct:x.correct,accuracy:Math.round(x.correct/x.total*100)})}if(p.sort((m,x)=>m.accuracy-x.accuracy),i(p),f.confusionData&&f.confusionData.length>0){const m=new Map;for(const y of f.confusionData){if(y.guessedSpecies===y.expectedSpecies)continue;const v=`${y.expectedSpecies}|${y.guessedSpecies??"MISS"}`;m.set(v,(m.get(v)||0)+1)}const x=[];for(const[y,v]of m.entries()){const[g,w]=y.split("|");x.push({expectedSpecies:g,guessedSpecies:w==="MISS"?null:w,count:v})}x.sort((y,v)=>v.count-y.count),o(x)}}catch(f){console.error("Failed to parse round results:",f)}},[]);const a=e&&e.totalEvents>0?Math.round(e.eventsScored/e.totalEvents*100):0,l=(e==null?void 0:e.mode)==="campaign",u=(e==null?void 0:e.levelId)||1,c=l&&u<qM;return _.jsxs("div",{className:"screen screen-center",style:{paddingTop:"48px"},children:[_.jsx("h1",{children:"ROUND COMPLETE"}),l&&_.jsxs("p",{className:"text-muted",style:{marginTop:"-8px",marginBottom:"16px"},children:["Level ",u,": ",(e==null?void 0:e.levelTitle)||"Campaign"]}),_.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",marginBottom:"24px"},children:[_.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"16px"},children:[_.jsx("span",{children:"Score"}),_.jsx("span",{className:"text-accent",style:{fontFamily:"var(--font-mono)",fontSize:"24px"},children:(e==null?void 0:e.score)||0})]}),_.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"16px"},children:[_.jsx("span",{children:"Birds Identified"}),_.jsxs("span",{children:[(e==null?void 0:e.eventsScored)||0," / ",(e==null?void 0:e.totalEvents)||0]})]}),_.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"16px"},children:[_.jsx("span",{children:"Overall Accuracy"}),_.jsxs("span",{className:a>=70?"text-success":a>=50?"text-accent":"text-error",children:[a,"%"]})]}),_.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"16px"},children:[_.jsx("span",{children:"Perfect Hits"}),_.jsx("span",{className:"text-success",children:(e==null?void 0:e.perfectCount)||0})]}),_.jsxs("div",{className:"flex-row justify-between",children:[_.jsx("span",{children:"Best Streak"}),_.jsx("span",{children:(e==null?void 0:e.maxStreak)||0})]})]}),n.length>0&&_.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",marginBottom:"24px"},children:[_.jsx("h3",{style:{marginBottom:"12px"},children:"Species Breakdown"}),n.map(h=>_.jsxs("div",{style:{marginBottom:"12px"},children:[_.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[_.jsxs("span",{style:{fontSize:"14px"},children:[h.code," ",_.jsxs("span",{className:"text-muted",children:["(",h.name,")"]})]}),_.jsxs("span",{style:{fontSize:"14px"},children:[h.correct,"/",h.total," (",h.accuracy,"%)"]})]}),_.jsx("div",{style:{height:"8px",backgroundColor:"var(--color-background)",borderRadius:"4px",overflow:"hidden"},children:_.jsx("div",{style:{width:`${h.accuracy}%`,height:"100%",backgroundColor:h.accuracy>=80?"var(--color-success)":h.accuracy>=50?"var(--color-accent)":"var(--color-error)",borderRadius:"4px",transition:"width 0.3s ease"}})})]},h.code))]}),s.length>0&&_.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",marginBottom:"24px"},children:[_.jsx("h3",{style:{marginBottom:"12px"},children:"Confusion Summary"}),s.map((h,d)=>_.jsx("div",{style:{marginBottom:"8px",fontSize:"14px"},children:h.guessedSpecies===null?_.jsxs("span",{children:["You missed ",_.jsx("span",{className:"text-accent",children:h.expectedSpecies}),": ",h.count," time",h.count!==1?"s":""]}):_.jsxs("span",{children:["You heard ",_.jsx("span",{className:"text-accent",children:h.expectedSpecies})," but picked"," ",_.jsx("span",{className:"text-error",children:h.guessedSpecies}),": ",h.count," time",h.count!==1?"s":""]})},d))]}),_.jsxs("div",{className:"flex-col gap-md",style:{width:"100%",maxWidth:"320px"},children:[c&&_.jsx("button",{className:"btn-primary",onClick:()=>{const h=(e==null?void 0:e.packId)||"common_se_birds";t(`/gameplay?mode=campaign&pack=${h}&level=${u+1}`)},style:{width:"100%"},children:"Next Level"}),_.jsxs("div",{className:"flex-row gap-md",children:[_.jsx("button",{className:c?"btn-secondary":"btn-primary",onClick:()=>{const h=(e==null?void 0:e.mode)||"campaign",d=(e==null?void 0:e.packId)||"common_se_birds",f=(e==null?void 0:e.levelId)||1;t(`/gameplay?mode=${h}&pack=${d}&level=${f}`)},style:{flex:1},children:"Play Again"}),_.jsx("button",{className:"btn-secondary",onClick:()=>t("/"),style:{flex:1},children:"Menu"})]})]})]})}const ji={SCROLL_SPEED:"soundfield_scroll_speed",SPECTROGRAM_MODE:"soundfield_spectrogram_mode",HIGH_CONTRAST:"soundfield_high_contrast"};function QM(){const t=kr(),[e,r]=T.useState(()=>localStorage.getItem(ji.SPECTROGRAM_MODE)||"full"),[n,i]=T.useState(()=>{const a=localStorage.getItem(ji.SCROLL_SPEED);return a?parseFloat(a):.5}),[s,o]=T.useState(()=>localStorage.getItem(ji.HIGH_CONTRAST)==="true");return T.useEffect(()=>{localStorage.setItem(ji.SPECTROGRAM_MODE,e)},[e]),T.useEffect(()=>{localStorage.setItem(ji.SCROLL_SPEED,n.toString())},[n]),T.useEffect(()=>{localStorage.setItem(ji.HIGH_CONTRAST,s.toString())},[s]),_.jsxs("div",{className:"screen",children:[_.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[_.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:_.jsx(JM,{})}),_.jsx("h2",{style:{margin:0},children:"Settings"})]}),_.jsxs("div",{className:"flex-col gap-lg",children:[_.jsxs("div",{className:"card",children:[_.jsx("h3",{children:"Spectrogram Mode"}),_.jsx("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:"Visual difficulty setting"}),_.jsx("div",{className:"flex-row gap-sm",children:["full","fading","none"].map(a=>_.jsx("button",{className:e===a?"btn-primary":"btn-secondary",onClick:()=>r(a),style:{flex:1,textTransform:"capitalize"},children:a},a))})]}),_.jsxs("div",{className:"card",children:[_.jsx("h3",{children:"Scroll Speed"}),_.jsxs("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:["How fast tiles move: ",n.toFixed(1),"x"]}),_.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:n,onChange:a=>i(parseFloat(a.target.value)),style:{width:"100%"}})]}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"flex-row justify-between items-center",children:[_.jsxs("div",{children:[_.jsx("h3",{style:{marginBottom:"4px"},children:"High Contrast"}),_.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Enhanced visibility"})]}),_.jsx("button",{className:s?"btn-primary":"btn-secondary",onClick:()=>o(!s),style:{width:"60px"},children:s?"ON":"OFF"})]})}),_.jsxs("div",{className:"card",children:[_.jsx("h3",{children:"Audio"}),_.jsx("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:"Run headphone calibration"}),_.jsx("button",{className:"btn-secondary",style:{width:"100%"},children:"Calibrate Headphones"})]}),_.jsx("div",{className:"card",children:_.jsx("button",{className:"btn-secondary",style:{width:"100%",color:"var(--color-error)"},children:"Reset All Progress"})})]})]})}function JM(){return _.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:_.jsx("path",{d:"M15 18l-6-6 6-6"})})}const rl=[{code:"NOCA",name:"Northern Cardinal",accuracy:92,attempts:45},{code:"BLJA",name:"Blue Jay",accuracy:88,attempts:38},{code:"CARW",name:"Carolina Wren",accuracy:76,attempts:29},{code:"AMCR",name:"American Crow",accuracy:95,attempts:22},{code:"TUTI",name:"Tufted Titmouse",accuracy:71,attempts:18}];function ek(){const t=kr(),e=Math.round(rl.reduce((r,n)=>r+n.accuracy,0)/rl.length);return _.jsxs("div",{className:"screen",children:[_.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[_.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:_.jsx(tk,{})}),_.jsx("h2",{style:{margin:0},children:"Progress"})]}),_.jsx("div",{className:"card",style:{marginBottom:"24px"},children:_.jsxs("div",{className:"flex-row justify-between items-center",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Overall Accuracy"}),_.jsxs("div",{style:{fontSize:"32px",fontWeight:700},className:"text-success",children:[e,"%"]})]}),_.jsxs("div",{style:{textAlign:"right"},children:[_.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Total Attempts"}),_.jsx("div",{style:{fontSize:"24px",fontWeight:600},children:rl.reduce((r,n)=>r+n.attempts,0)})]})]})}),_.jsxs("div",{className:"card",style:{marginBottom:"24px"},children:[_.jsx("h3",{children:"This Session"}),_.jsxs("div",{className:"flex-row justify-between",style:{marginTop:"12px"},children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Rounds"}),_.jsx("div",{style:{fontSize:"20px"},children:"5"})]}),_.jsxs("div",{children:[_.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Score"}),_.jsx("div",{style:{fontSize:"20px"},className:"text-accent",children:"12,450"})]}),_.jsxs("div",{children:[_.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Best Streak"}),_.jsx("div",{style:{fontSize:"20px"},children:"18"})]})]})]}),_.jsxs("div",{className:"card",children:[_.jsx("h3",{style:{marginBottom:"16px"},children:"Species Accuracy"}),rl.map(r=>_.jsxs("div",{style:{marginBottom:"12px"},children:[_.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[_.jsxs("span",{style:{fontSize:"14px"},children:[r.code," ",_.jsxs("span",{className:"text-muted",children:["(",r.attempts,")"]})]}),_.jsxs("span",{style:{fontSize:"14px"},className:r.accuracy>=80?"text-success":r.accuracy>=60?"text-accent":"text-error",children:[r.accuracy,"%"]})]}),_.jsx("div",{style:{height:"6px",backgroundColor:"var(--color-background)",borderRadius:"3px",overflow:"hidden"},children:_.jsx("div",{style:{width:`${r.accuracy}%`,height:"100%",backgroundColor:r.accuracy>=80?"var(--color-success)":r.accuracy>=60?"var(--color-accent)":"var(--color-error)",borderRadius:"3px"}})})]},r.code))]}),_.jsx("div",{className:"card",style:{marginTop:"24px"},children:_.jsx("button",{className:"btn-secondary",style:{width:"100%"},children:"View Confusion Matrix"})})]})}function tk(){return _.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:_.jsx("path",{d:"M15 18l-6-6 6-6"})})}function rk(){const t=kr();return _.jsxs("div",{className:"screen",style:{paddingBottom:"32px"},children:[_.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[_.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:_.jsx(nk,{})}),_.jsx("h2",{style:{margin:0},children:"How to Play"})]}),_.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[_.jsxs(hn,{title:"The Basics",children:[_.jsx("p",{children:_.jsx("strong",{children:"Listen. Identify. Tap."})}),_.jsx("p",{children:"Bird sounds play through your left or right ear. Identify which bird is singing and tap its circle on the correct side before the tile passes the scoring zone."}),_.jsx("p",{children:"Each round is 30 seconds. Use headphones for the best experience!"})]}),_.jsxs(hn,{title:"Scoring",children:[_.jsx(nl,{label:"Perfect",points:100,description:"Right bird + right ear + great timing",color:"var(--color-success)"}),_.jsx(nl,{label:"Good",points:75,description:"Right bird + right ear",color:"var(--color-success)"}),_.jsx(nl,{label:"Partial",points:25,description:"Right bird, wrong ear",color:"var(--color-accent)"}),_.jsx(nl,{label:"Miss",points:0,description:"Wrong bird or no response",color:"var(--color-error)"})]}),_.jsxs(hn,{title:"The Packs",children:[_.jsx(il,{name:"5 Common Backyard Birds",description:"Perfect for beginners. Five distinctive birds you'll hear in your own backyard: Cardinal, Carolina Wren, Titmouse, Blue Jay, and Crow."}),_.jsx(il,{name:"Expanded Local Birds",description:"27 species from the eastern US. Each round picks 9 random birds, so every game is different!"}),_.jsx(il,{name:"Sparrows",description:"Master the subtle singers! Seven sparrow species with distinctive patterns: White-throated, Song, Chipping, Swamp, Savannah, Field, and Lincoln's."}),_.jsx(il,{name:"Woodpeckers",description:"Drums, rattles, and calls. Learn seven species: Downy, Hairy, Red-bellied, Pileated, Yellow-bellied Sapsucker, Northern Flicker, and Red-headed."})]}),_.jsxs(hn,{title:"The Levels",children:[_.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Each pack has 6 levels that build your skills:"}),_.jsx(Gi,{level:1,title:"Meet the Birds",description:"One clear recording per bird, single ear. Learn each signature voice."}),_.jsx(Gi,{level:2,title:"Sound Variations",description:"Up to 3 recordings per bird. Same species, different songs."}),_.jsx(Gi,{level:3,title:"Full Repertoire",description:"All recordings in play. Master every variation."}),_.jsx(Gi,{level:4,title:"Both Ears",description:"Sounds from either side. Identify the bird AND the direction."}),_.jsx(Gi,{level:5,title:"Variations + Both Ears",description:"Multiple recordings, either ear. Getting challenging!"}),_.jsx(Gi,{level:6,title:"Master Birder",description:"Everything at once. You're a pro now."})]}),_.jsxs(hn,{title:"Tips",children:[_.jsx(Xn,{children:"Use headphones - unless you want everyone to know you're a bird nerd! Left/right matters for scoring, and phone speakers vary in stereo quality."}),_.jsx(Xn,{children:"Start with the Starter Pack, even if you're eager for more."}),_.jsx(Xn,{children:"Use Bird Reference on the Pack Select screen to preview sounds."}),_.jsx(Xn,{children:"Don't rush. Let the sound register before you tap."}),_.jsx(Xn,{children:"Check the round summary to see which birds need practice."}),_.jsx(Xn,{children:"Once you've mastered the sounds, try playing muted - identify birds by their spectrograms alone!"}),_.jsx(Xn,{children:"Adjust tile speed in Settings if things move too fast (or too slow)."})]}),_.jsxs(hn,{title:"The 4-Letter Codes",children:[_.jsx("p",{children:`Birders use standardized 4-letter codes (called "Alpha codes") as shorthand for species names. They're easy to learn:`}),_.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"8px",fontSize:"14px",lineHeight:1.6},children:[_.jsxs("div",{children:[_.jsx("strong",{children:"Two-word names:"})," First 2 letters of each word"]}),_.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Northern Cardinal  NO + CA  NOCA"}),_.jsxs("div",{style:{marginTop:"8px"},children:[_.jsx("strong",{children:"Three-word names:"})," 1 + 1 + 2 letters"]}),_.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Red-bellied Woodpecker  R + B + WO  RBWO"})]})]}),_.jsxs(hn,{title:"The Spectrograms",children:[_.jsx("p",{children:"The colorful images on tiles are spectrograms - visual pictures of sound. Time flows left to right, pitch goes bottom to top, and brightness shows volume."}),_.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"14px"},children:"With practice, you'll recognize birds by their visual patterns too!"})]}),_.jsx(hn,{title:"Sound Credits",children:_.jsxs("p",{style:{fontSize:"14px"},children:["All recordings from ",_.jsx("a",{href:"https://xeno-canto.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"xeno-canto.org"}),", a community library of bird sounds from around the world."]})})]})]})}function hn({title:t,children:e}){return _.jsxs("div",{style:{marginBottom:"28px"},children:[_.jsx("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"12px",color:"var(--color-accent)",borderBottom:"1px solid var(--color-surface)",paddingBottom:"8px"},children:t}),_.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,color:"var(--color-text)"},children:e})]})}function nl({label:t,points:e,description:r,color:n}){return _.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[_.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:n,minWidth:"40px"},children:["+",e]}),_.jsxs("div",{children:[_.jsx("span",{style:{fontWeight:600},children:t}),_.jsx("span",{style:{color:"var(--color-text-muted)",marginLeft:"8px",fontSize:"13px"},children:r})]})]})}function il({name:t,description:e}){return _.jsxs("div",{style:{marginBottom:"12px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px"},children:[_.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:t}),_.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:e})]})}function Gi({level:t,title:e,description:r}){return _.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[_.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:"var(--color-accent)",minWidth:"24px"},children:t}),_.jsxs("div",{children:[_.jsx("span",{style:{fontWeight:600},children:e}),_.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:r})]})]})}function Xn({children:t}){return _.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px"},children:[_.jsx("span",{style:{color:"var(--color-accent)"},children:""}),_.jsx("span",{children:t})]})}function nk(){return _.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:_.jsx("path",{d:"M15 18l-6-6 6-6"})})}function ik(){return _.jsxs(iT,{children:[_.jsx(Or,{path:"/",element:_.jsx(yT,{})}),_.jsx(Or,{path:"/pack-select",element:_.jsx(AT,{})}),_.jsx(Or,{path:"/level-select",element:_.jsx(DT,{})}),_.jsx(Or,{path:"/gameplay",element:_.jsx(KM,{})}),_.jsx(Or,{path:"/summary",element:_.jsx(ZM,{})}),_.jsx(Or,{path:"/settings",element:_.jsx(QM,{})}),_.jsx(Or,{path:"/progress",element:_.jsx(ek,{})}),_.jsx(Or,{path:"/help",element:_.jsx(rk,{})})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/bird-sound-game/sw.js").then(e=>{console.log("SW registered:",e.scope)}).catch(e=>{console.log("SW registration failed:",e)})});bh.createRoot(document.getElementById("root")).render(_.jsx(Sv.StrictMode,{children:_.jsx(dT,{basename:"/bird-sound-game/",children:_.jsx(ik,{})})}));
