var Q1=Object.defineProperty;var Z1=(t,e,r)=>e in t?Q1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var pn=(t,e,r)=>Z1(t,typeof e!="symbol"?e+"":e,r);function J1(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var wo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ew(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Rx={exports:{}},Tc={},Px={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oa=Symbol.for("react.element"),tw=Symbol.for("react.portal"),rw=Symbol.for("react.fragment"),nw=Symbol.for("react.strict_mode"),iw=Symbol.for("react.profiler"),sw=Symbol.for("react.provider"),ow=Symbol.for("react.context"),aw=Symbol.for("react.forward_ref"),lw=Symbol.for("react.suspense"),cw=Symbol.for("react.memo"),uw=Symbol.for("react.lazy"),rm=Symbol.iterator;function hw(t){return t===null||typeof t!="object"?null:(t=rm&&t[rm]||t["@@iterator"],typeof t=="function"?t:null)}var Ix={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kx=Object.assign,Mx={};function Us(t,e,r){this.props=t,this.context=e,this.refs=Mx,this.updater=r||Ix}Us.prototype.isReactComponent={};Us.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Us.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Bx(){}Bx.prototype=Us.prototype;function If(t,e,r){this.props=t,this.context=e,this.refs=Mx,this.updater=r||Ix}var kf=If.prototype=new Bx;kf.constructor=If;kx(kf,Us.prototype);kf.isPureReactComponent=!0;var nm=Array.isArray,Nx=Object.prototype.hasOwnProperty,Mf={current:null},Lx={key:!0,ref:!0,__self:!0,__source:!0};function Fx(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Nx.call(e,n)&&!Lx.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:oa,type:t,key:s,ref:o,props:i,_owner:Mf.current}}function dw(t,e){return{$$typeof:oa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Bf(t){return typeof t=="object"&&t!==null&&t.$$typeof===oa}function fw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var im=/\/+/g;function cu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fw(""+t.key):e.toString(36)}function ul(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case oa:case tw:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+cu(o,0):n,nm(i)?(r="",t!=null&&(r=t.replace(im,"$&/")+"/"),ul(i,e,r,"",function(c){return c})):i!=null&&(Bf(i)&&(i=dw(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(im,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",nm(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+cu(s,a);o+=ul(s,e,r,l,i)}else if(l=hw(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+cu(s,a++),o+=ul(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function wa(t,e,r){if(t==null)return t;var n=[],i=0;return ul(t,n,"","",function(s){return e.call(r,s,i++)}),n}function pw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var bt={current:null},hl={transition:null},mw={ReactCurrentDispatcher:bt,ReactCurrentBatchConfig:hl,ReactCurrentOwner:Mf};function Dx(){throw Error("act(...) is not supported in production builds of React.")}ye.Children={map:wa,forEach:function(t,e,r){wa(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return wa(t,function(){e++}),e},toArray:function(t){return wa(t,function(e){return e})||[]},only:function(t){if(!Bf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ye.Component=Us;ye.Fragment=rw;ye.Profiler=iw;ye.PureComponent=If;ye.StrictMode=nw;ye.Suspense=lw;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mw;ye.act=Dx;ye.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=kx({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Mf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Nx.call(e,l)&&!Lx.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:oa,type:t.type,key:i,ref:s,props:n,_owner:o}};ye.createContext=function(t){return t={$$typeof:ow,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sw,_context:t},t.Consumer=t};ye.createElement=Fx;ye.createFactory=function(t){var e=Fx.bind(null,t);return e.type=t,e};ye.createRef=function(){return{current:null}};ye.forwardRef=function(t){return{$$typeof:aw,render:t}};ye.isValidElement=Bf;ye.lazy=function(t){return{$$typeof:uw,_payload:{_status:-1,_result:t},_init:pw}};ye.memo=function(t,e){return{$$typeof:cw,type:t,compare:e===void 0?null:e}};ye.startTransition=function(t){var e=hl.transition;hl.transition={};try{t()}finally{hl.transition=e}};ye.unstable_act=Dx;ye.useCallback=function(t,e){return bt.current.useCallback(t,e)};ye.useContext=function(t){return bt.current.useContext(t)};ye.useDebugValue=function(){};ye.useDeferredValue=function(t){return bt.current.useDeferredValue(t)};ye.useEffect=function(t,e){return bt.current.useEffect(t,e)};ye.useId=function(){return bt.current.useId()};ye.useImperativeHandle=function(t,e,r){return bt.current.useImperativeHandle(t,e,r)};ye.useInsertionEffect=function(t,e){return bt.current.useInsertionEffect(t,e)};ye.useLayoutEffect=function(t,e){return bt.current.useLayoutEffect(t,e)};ye.useMemo=function(t,e){return bt.current.useMemo(t,e)};ye.useReducer=function(t,e,r){return bt.current.useReducer(t,e,r)};ye.useRef=function(t){return bt.current.useRef(t)};ye.useState=function(t){return bt.current.useState(t)};ye.useSyncExternalStore=function(t,e,r){return bt.current.useSyncExternalStore(t,e,r)};ye.useTransition=function(){return bt.current.useTransition()};ye.version="18.3.1";Px.exports=ye;var E=Px.exports;const jx=Pf(E),gw=J1({__proto__:null,default:jx},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yw=E,xw=Symbol.for("react.element"),vw=Symbol.for("react.fragment"),_w=Object.prototype.hasOwnProperty,ww=yw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Sw={key:!0,ref:!0,__self:!0,__source:!0};function Ox(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)_w.call(e,n)&&!Sw.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:xw,type:t,key:s,ref:o,props:i,_owner:ww.current}}Tc.Fragment=vw;Tc.jsx=Ox;Tc.jsxs=Ox;Rx.exports=Tc;var u=Rx.exports,Lh={},Ux={exports:{}},$t={},Gx={exports:{}},zx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,G){var k=M.length;M.push(G);e:for(;0<k;){var P=k-1>>>1,F=M[P];if(0<i(F,G))M[P]=G,M[k]=F,k=P;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var G=M[0],k=M.pop();if(k!==G){M[0]=k;e:for(var P=0,F=M.length,q=F>>>1;P<q;){var Q=2*(P+1)-1,le=M[Q],xe=Q+1,oe=M[xe];if(0>i(le,k))xe<F&&0>i(oe,le)?(M[P]=oe,M[xe]=k,P=xe):(M[P]=le,M[Q]=k,P=Q);else if(xe<F&&0>i(oe,k))M[P]=oe,M[xe]=k,P=xe;else break e}}return G}function i(M,G){var k=M.sortIndex-G.sortIndex;return k!==0?k:M.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,d=null,f=3,p=!1,g=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(M){for(var G=r(c);G!==null;){if(G.callback===null)n(c);else if(G.startTime<=M)n(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=r(c)}}function w(M){if(v=!1,m(M),!g)if(r(l)!==null)g=!0,D(b);else{var G=r(c);G!==null&&j(w,G.startTime-M)}}function b(M,G){g=!1,v&&(v=!1,y(S),S=-1),p=!0;var k=f;try{for(m(G),d=r(l);d!==null&&(!(d.expirationTime>G)||M&&!L());){var P=d.callback;if(typeof P=="function"){d.callback=null,f=d.priorityLevel;var F=P(d.expirationTime<=G);G=t.unstable_now(),typeof F=="function"?d.callback=F:d===r(l)&&n(l),m(G)}else n(l);d=r(l)}if(d!==null)var q=!0;else{var Q=r(c);Q!==null&&j(w,Q.startTime-G),q=!1}return q}finally{d=null,f=k,p=!1}}var T=!1,A=null,S=-1,R=5,I=-1;function L(){return!(t.unstable_now()-I<R)}function B(){if(A!==null){var M=t.unstable_now();I=M;var G=!0;try{G=A(!0,M)}finally{G?C():(T=!1,A=null)}}else T=!1}var C;if(typeof x=="function")C=function(){x(B)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,O=N.port2;N.port1.onmessage=B,C=function(){O.postMessage(null)}}else C=function(){_(B,0)};function D(M){A=M,T||(T=!0,C())}function j(M,G){S=_(function(){M(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,D(b))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(M){switch(f){case 1:case 2:case 3:var G=3;break;default:G=f}var k=f;f=G;try{return M()}finally{f=k}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,G){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var k=f;f=M;try{return G()}finally{f=k}},t.unstable_scheduleCallback=function(M,G,k){var P=t.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?P+k:P):k=P,M){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=k+F,M={id:h++,callback:G,priorityLevel:M,startTime:k,expirationTime:F,sortIndex:-1},k>P?(M.sortIndex=k,e(c,M),r(l)===null&&M===r(c)&&(v?(y(S),S=-1):v=!0,j(w,k-P))):(M.sortIndex=F,e(l,M),g||p||(g=!0,D(b))),M},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(M){var G=f;return function(){var k=f;f=G;try{return M.apply(this,arguments)}finally{f=k}}}})(zx);Gx.exports=zx;var bw=Gx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ew=E,Ht=bw;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hx=new Set,Fo={};function Ri(t,e){Is(t,e),Is(t+"Capture",e)}function Is(t,e){for(Fo[t]=e,t=0;t<e.length;t++)Hx.add(e[t])}var tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fh=Object.prototype.hasOwnProperty,Tw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sm={},om={};function Aw(t){return Fh.call(om,t)?!0:Fh.call(sm,t)?!1:Tw.test(t)?om[t]=!0:(sm[t]=!0,!1)}function Cw(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Rw(t,e,r,n){if(e===null||typeof e>"u"||Cw(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Et(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ft[t]=new Et(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ft[e]=new Et(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ft[t]=new Et(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ft[t]=new Et(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ft[t]=new Et(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ft[t]=new Et(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ft[t]=new Et(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ft[t]=new Et(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ft[t]=new Et(t,5,!1,t.toLowerCase(),null,!1,!1)});var Nf=/[\-:]([a-z])/g;function Lf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Nf,Lf);ft[e]=new Et(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Nf,Lf);ft[e]=new Et(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Nf,Lf);ft[e]=new Et(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ft[t]=new Et(t,1,!1,t.toLowerCase(),null,!1,!1)});ft.xlinkHref=new Et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ft[t]=new Et(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ff(t,e,r,n){var i=ft.hasOwnProperty(e)?ft[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Rw(e,r,i,n)&&(r=null),n||i===null?Aw(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ln=Ew.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sa=Symbol.for("react.element"),rs=Symbol.for("react.portal"),ns=Symbol.for("react.fragment"),Df=Symbol.for("react.strict_mode"),Dh=Symbol.for("react.profiler"),$x=Symbol.for("react.provider"),Vx=Symbol.for("react.context"),jf=Symbol.for("react.forward_ref"),jh=Symbol.for("react.suspense"),Oh=Symbol.for("react.suspense_list"),Of=Symbol.for("react.memo"),_n=Symbol.for("react.lazy"),Wx=Symbol.for("react.offscreen"),am=Symbol.iterator;function Ks(t){return t===null||typeof t!="object"?null:(t=am&&t[am]||t["@@iterator"],typeof t=="function"?t:null)}var ze=Object.assign,uu;function lo(t){if(uu===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);uu=e&&e[1]||""}return`
`+uu+t}var hu=!1;function du(t,e){if(!t||hu)return"";hu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{hu=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?lo(t):""}function Pw(t){switch(t.tag){case 5:return lo(t.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return t=du(t.type,!1),t;case 11:return t=du(t.type.render,!1),t;case 1:return t=du(t.type,!0),t;default:return""}}function Uh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ns:return"Fragment";case rs:return"Portal";case Dh:return"Profiler";case Df:return"StrictMode";case jh:return"Suspense";case Oh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vx:return(t.displayName||"Context")+".Consumer";case $x:return(t._context.displayName||"Context")+".Provider";case jf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Of:return e=t.displayName||null,e!==null?e:Uh(t.type)||"Memo";case _n:e=t._payload,t=t._init;try{return Uh(t(e))}catch{}}return null}function Iw(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Uh(e);case 8:return e===Df?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Xx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kw(t){var e=Xx(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ba(t){t._valueTracker||(t._valueTracker=kw(t))}function Yx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Xx(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Nl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gh(t,e){var r=e.checked;return ze({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function lm(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=zn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Kx(t,e){e=e.checked,e!=null&&Ff(t,"checked",e,!1)}function zh(t,e){Kx(t,e);var r=zn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Hh(t,e.type,r):e.hasOwnProperty("defaultValue")&&Hh(t,e.type,zn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function cm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Hh(t,e,r){(e!=="number"||Nl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var co=Array.isArray;function gs(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+zn(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function $h(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return ze({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function um(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(U(92));if(co(r)){if(1<r.length)throw Error(U(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:zn(r)}}function qx(t,e){var r=zn(e.value),n=zn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function hm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Qx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Qx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ea,Zx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ea=Ea||document.createElement("div"),Ea.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ea.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Do(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var So={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mw=["Webkit","ms","Moz","O"];Object.keys(So).forEach(function(t){Mw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),So[e]=So[t]})});function Jx(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||So.hasOwnProperty(t)&&So[t]?(""+e).trim():e+"px"}function ev(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Jx(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Bw=ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wh(t,e){if(e){if(Bw[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Xh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yh=null;function Uf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kh=null,ys=null,xs=null;function dm(t){if(t=ca(t)){if(typeof Kh!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Ic(e),Kh(t.stateNode,t.type,e))}}function tv(t){ys?xs?xs.push(t):xs=[t]:ys=t}function rv(){if(ys){var t=ys,e=xs;if(xs=ys=null,dm(t),e)for(t=0;t<e.length;t++)dm(e[t])}}function nv(t,e){return t(e)}function iv(){}var fu=!1;function sv(t,e,r){if(fu)return t(e,r);fu=!0;try{return nv(t,e,r)}finally{fu=!1,(ys!==null||xs!==null)&&(iv(),rv())}}function jo(t,e){var r=t.stateNode;if(r===null)return null;var n=Ic(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(U(231,e,typeof r));return r}var qh=!1;if(tn)try{var qs={};Object.defineProperty(qs,"passive",{get:function(){qh=!0}}),window.addEventListener("test",qs,qs),window.removeEventListener("test",qs,qs)}catch{qh=!1}function Nw(t,e,r,n,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(h){this.onError(h)}}var bo=!1,Ll=null,Fl=!1,Qh=null,Lw={onError:function(t){bo=!0,Ll=t}};function Fw(t,e,r,n,i,s,o,a,l){bo=!1,Ll=null,Nw.apply(Lw,arguments)}function Dw(t,e,r,n,i,s,o,a,l){if(Fw.apply(this,arguments),bo){if(bo){var c=Ll;bo=!1,Ll=null}else throw Error(U(198));Fl||(Fl=!0,Qh=c)}}function Pi(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function ov(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function fm(t){if(Pi(t)!==t)throw Error(U(188))}function jw(t){var e=t.alternate;if(!e){if(e=Pi(t),e===null)throw Error(U(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return fm(i),t;if(s===n)return fm(i),e;s=s.sibling}throw Error(U(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(U(189))}}if(r.alternate!==n)throw Error(U(190))}if(r.tag!==3)throw Error(U(188));return r.stateNode.current===r?t:e}function av(t){return t=jw(t),t!==null?lv(t):null}function lv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lv(t);if(e!==null)return e;t=t.sibling}return null}var cv=Ht.unstable_scheduleCallback,pm=Ht.unstable_cancelCallback,Ow=Ht.unstable_shouldYield,Uw=Ht.unstable_requestPaint,Xe=Ht.unstable_now,Gw=Ht.unstable_getCurrentPriorityLevel,Gf=Ht.unstable_ImmediatePriority,uv=Ht.unstable_UserBlockingPriority,Dl=Ht.unstable_NormalPriority,zw=Ht.unstable_LowPriority,hv=Ht.unstable_IdlePriority,Ac=null,Nr=null;function Hw(t){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Ac,t,void 0,(t.current.flags&128)===128)}catch{}}var pr=Math.clz32?Math.clz32:Ww,$w=Math.log,Vw=Math.LN2;function Ww(t){return t>>>=0,t===0?32:31-($w(t)/Vw|0)|0}var Ta=64,Aa=4194304;function uo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jl(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=uo(a):(s&=o,s!==0&&(n=uo(s)))}else o=r&~i,o!==0?n=uo(o):s!==0&&(n=uo(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-pr(e),i=1<<r,n|=t[r],e&=~i;return n}function Xw(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yw(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-pr(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=Xw(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Zh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function dv(){var t=Ta;return Ta<<=1,!(Ta&4194240)&&(Ta=64),t}function pu(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function aa(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pr(e),t[e]=r}function Kw(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-pr(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function zf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-pr(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Ae=0;function fv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pv,Hf,mv,gv,yv,Jh=!1,Ca=[],Mn=null,Bn=null,Nn=null,Oo=new Map,Uo=new Map,bn=[],qw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mm(t,e){switch(t){case"focusin":case"focusout":Mn=null;break;case"dragenter":case"dragleave":Bn=null;break;case"mouseover":case"mouseout":Nn=null;break;case"pointerover":case"pointerout":Oo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uo.delete(e.pointerId)}}function Qs(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ca(e),e!==null&&Hf(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Qw(t,e,r,n,i){switch(e){case"focusin":return Mn=Qs(Mn,t,e,r,n,i),!0;case"dragenter":return Bn=Qs(Bn,t,e,r,n,i),!0;case"mouseover":return Nn=Qs(Nn,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Oo.set(s,Qs(Oo.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Uo.set(s,Qs(Uo.get(s)||null,t,e,r,n,i)),!0}return!1}function xv(t){var e=hi(t.target);if(e!==null){var r=Pi(e);if(r!==null){if(e=r.tag,e===13){if(e=ov(r),e!==null){t.blockedOn=e,yv(t.priority,function(){mv(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function dl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=ed(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Yh=n,r.target.dispatchEvent(n),Yh=null}else return e=ca(r),e!==null&&Hf(e),t.blockedOn=r,!1;e.shift()}return!0}function gm(t,e,r){dl(t)&&r.delete(e)}function Zw(){Jh=!1,Mn!==null&&dl(Mn)&&(Mn=null),Bn!==null&&dl(Bn)&&(Bn=null),Nn!==null&&dl(Nn)&&(Nn=null),Oo.forEach(gm),Uo.forEach(gm)}function Zs(t,e){t.blockedOn===e&&(t.blockedOn=null,Jh||(Jh=!0,Ht.unstable_scheduleCallback(Ht.unstable_NormalPriority,Zw)))}function Go(t){function e(i){return Zs(i,t)}if(0<Ca.length){Zs(Ca[0],t);for(var r=1;r<Ca.length;r++){var n=Ca[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Mn!==null&&Zs(Mn,t),Bn!==null&&Zs(Bn,t),Nn!==null&&Zs(Nn,t),Oo.forEach(e),Uo.forEach(e),r=0;r<bn.length;r++)n=bn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<bn.length&&(r=bn[0],r.blockedOn===null);)xv(r),r.blockedOn===null&&bn.shift()}var vs=ln.ReactCurrentBatchConfig,Ol=!0;function Jw(t,e,r,n){var i=Ae,s=vs.transition;vs.transition=null;try{Ae=1,$f(t,e,r,n)}finally{Ae=i,vs.transition=s}}function eS(t,e,r,n){var i=Ae,s=vs.transition;vs.transition=null;try{Ae=4,$f(t,e,r,n)}finally{Ae=i,vs.transition=s}}function $f(t,e,r,n){if(Ol){var i=ed(t,e,r,n);if(i===null)Eu(t,e,n,Ul,r),mm(t,n);else if(Qw(i,t,e,r,n))n.stopPropagation();else if(mm(t,n),e&4&&-1<qw.indexOf(t)){for(;i!==null;){var s=ca(i);if(s!==null&&pv(s),s=ed(t,e,r,n),s===null&&Eu(t,e,n,Ul,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Eu(t,e,n,null,r)}}var Ul=null;function ed(t,e,r,n){if(Ul=null,t=Uf(n),t=hi(t),t!==null)if(e=Pi(t),e===null)t=null;else if(r=e.tag,r===13){if(t=ov(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ul=t,null}function vv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gw()){case Gf:return 1;case uv:return 4;case Dl:case zw:return 16;case hv:return 536870912;default:return 16}default:return 16}}var An=null,Vf=null,fl=null;function _v(){if(fl)return fl;var t,e=Vf,r=e.length,n,i="value"in An?An.value:An.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return fl=i.slice(t,1<n?1-n:void 0)}function pl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ra(){return!0}function ym(){return!1}function Vt(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ra:ym,this.isPropagationStopped=ym,this}return ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ra)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ra)},persist:function(){},isPersistent:Ra}),e}var Gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wf=Vt(Gs),la=ze({},Gs,{view:0,detail:0}),tS=Vt(la),mu,gu,Js,Cc=ze({},la,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Js&&(Js&&t.type==="mousemove"?(mu=t.screenX-Js.screenX,gu=t.screenY-Js.screenY):gu=mu=0,Js=t),mu)},movementY:function(t){return"movementY"in t?t.movementY:gu}}),xm=Vt(Cc),rS=ze({},Cc,{dataTransfer:0}),nS=Vt(rS),iS=ze({},la,{relatedTarget:0}),yu=Vt(iS),sS=ze({},Gs,{animationName:0,elapsedTime:0,pseudoElement:0}),oS=Vt(sS),aS=ze({},Gs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),lS=Vt(aS),cS=ze({},Gs,{data:0}),vm=Vt(cS),uS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dS[t])?!!e[t]:!1}function Xf(){return fS}var pS=ze({},la,{key:function(t){if(t.key){var e=uS[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=pl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?hS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xf,charCode:function(t){return t.type==="keypress"?pl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?pl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),mS=Vt(pS),gS=ze({},Cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_m=Vt(gS),yS=ze({},la,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xf}),xS=Vt(yS),vS=ze({},Gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),_S=Vt(vS),wS=ze({},Cc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SS=Vt(wS),bS=[9,13,27,32],Yf=tn&&"CompositionEvent"in window,Eo=null;tn&&"documentMode"in document&&(Eo=document.documentMode);var ES=tn&&"TextEvent"in window&&!Eo,wv=tn&&(!Yf||Eo&&8<Eo&&11>=Eo),wm=" ",Sm=!1;function Sv(t,e){switch(t){case"keyup":return bS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var is=!1;function TS(t,e){switch(t){case"compositionend":return bv(e);case"keypress":return e.which!==32?null:(Sm=!0,wm);case"textInput":return t=e.data,t===wm&&Sm?null:t;default:return null}}function AS(t,e){if(is)return t==="compositionend"||!Yf&&Sv(t,e)?(t=_v(),fl=Vf=An=null,is=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wv&&e.locale!=="ko"?null:e.data;default:return null}}var CS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!CS[t.type]:e==="textarea"}function Ev(t,e,r,n){tv(n),e=Gl(e,"onChange"),0<e.length&&(r=new Wf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var To=null,zo=null;function RS(t){Lv(t,0)}function Rc(t){var e=as(t);if(Yx(e))return t}function PS(t,e){if(t==="change")return e}var Tv=!1;if(tn){var xu;if(tn){var vu="oninput"in document;if(!vu){var Em=document.createElement("div");Em.setAttribute("oninput","return;"),vu=typeof Em.oninput=="function"}xu=vu}else xu=!1;Tv=xu&&(!document.documentMode||9<document.documentMode)}function Tm(){To&&(To.detachEvent("onpropertychange",Av),zo=To=null)}function Av(t){if(t.propertyName==="value"&&Rc(zo)){var e=[];Ev(e,zo,t,Uf(t)),sv(RS,e)}}function IS(t,e,r){t==="focusin"?(Tm(),To=e,zo=r,To.attachEvent("onpropertychange",Av)):t==="focusout"&&Tm()}function kS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Rc(zo)}function MS(t,e){if(t==="click")return Rc(e)}function BS(t,e){if(t==="input"||t==="change")return Rc(e)}function NS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xr=typeof Object.is=="function"?Object.is:NS;function Ho(t,e){if(xr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Fh.call(e,i)||!xr(t[i],e[i]))return!1}return!0}function Am(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Cm(t,e){var r=Am(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Am(r)}}function Cv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Cv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Rv(){for(var t=window,e=Nl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Nl(t.document)}return e}function Kf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LS(t){var e=Rv(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Cv(r.ownerDocument.documentElement,r)){if(n!==null&&Kf(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Cm(r,s);var o=Cm(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var FS=tn&&"documentMode"in document&&11>=document.documentMode,ss=null,td=null,Ao=null,rd=!1;function Rm(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;rd||ss==null||ss!==Nl(n)||(n=ss,"selectionStart"in n&&Kf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ao&&Ho(Ao,n)||(Ao=n,n=Gl(td,"onSelect"),0<n.length&&(e=new Wf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ss)))}function Pa(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var os={animationend:Pa("Animation","AnimationEnd"),animationiteration:Pa("Animation","AnimationIteration"),animationstart:Pa("Animation","AnimationStart"),transitionend:Pa("Transition","TransitionEnd")},_u={},Pv={};tn&&(Pv=document.createElement("div").style,"AnimationEvent"in window||(delete os.animationend.animation,delete os.animationiteration.animation,delete os.animationstart.animation),"TransitionEvent"in window||delete os.transitionend.transition);function Pc(t){if(_u[t])return _u[t];if(!os[t])return t;var e=os[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Pv)return _u[t]=e[r];return t}var Iv=Pc("animationend"),kv=Pc("animationiteration"),Mv=Pc("animationstart"),Bv=Pc("transitionend"),Nv=new Map,Pm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xn(t,e){Nv.set(t,e),Ri(e,[t])}for(var wu=0;wu<Pm.length;wu++){var Su=Pm[wu],DS=Su.toLowerCase(),jS=Su[0].toUpperCase()+Su.slice(1);Xn(DS,"on"+jS)}Xn(Iv,"onAnimationEnd");Xn(kv,"onAnimationIteration");Xn(Mv,"onAnimationStart");Xn("dblclick","onDoubleClick");Xn("focusin","onFocus");Xn("focusout","onBlur");Xn(Bv,"onTransitionEnd");Is("onMouseEnter",["mouseout","mouseover"]);Is("onMouseLeave",["mouseout","mouseover"]);Is("onPointerEnter",["pointerout","pointerover"]);Is("onPointerLeave",["pointerout","pointerover"]);Ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ri("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OS=new Set("cancel close invalid load scroll toggle".split(" ").concat(ho));function Im(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Dw(n,e,void 0,t),t.currentTarget=null}function Lv(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Im(i,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Im(i,a,c),s=l}}}if(Fl)throw t=Qh,Fl=!1,Qh=null,t}function ke(t,e){var r=e[ad];r===void 0&&(r=e[ad]=new Set);var n=t+"__bubble";r.has(n)||(Fv(e,t,2,!1),r.add(n))}function bu(t,e,r){var n=0;e&&(n|=4),Fv(r,t,n,e)}var Ia="_reactListening"+Math.random().toString(36).slice(2);function $o(t){if(!t[Ia]){t[Ia]=!0,Hx.forEach(function(r){r!=="selectionchange"&&(OS.has(r)||bu(r,!1,t),bu(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ia]||(e[Ia]=!0,bu("selectionchange",!1,e))}}function Fv(t,e,r,n){switch(vv(e)){case 1:var i=Jw;break;case 4:i=eS;break;default:i=$f}r=i.bind(null,e,r,t),i=void 0,!qh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Eu(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=hi(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}sv(function(){var c=s,h=Uf(r),d=[];e:{var f=Nv.get(t);if(f!==void 0){var p=Wf,g=t;switch(t){case"keypress":if(pl(r)===0)break e;case"keydown":case"keyup":p=mS;break;case"focusin":g="focus",p=yu;break;case"focusout":g="blur",p=yu;break;case"beforeblur":case"afterblur":p=yu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=xm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=nS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=xS;break;case Iv:case kv:case Mv:p=oS;break;case Bv:p=_S;break;case"scroll":p=tS;break;case"wheel":p=SS;break;case"copy":case"cut":case"paste":p=lS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=_m}var v=(e&4)!==0,_=!v&&t==="scroll",y=v?f!==null?f+"Capture":null:f;v=[];for(var x=c,m;x!==null;){m=x;var w=m.stateNode;if(m.tag===5&&w!==null&&(m=w,y!==null&&(w=jo(x,y),w!=null&&v.push(Vo(x,w,m)))),_)break;x=x.return}0<v.length&&(f=new p(f,g,null,r,h),d.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&r!==Yh&&(g=r.relatedTarget||r.fromElement)&&(hi(g)||g[rn]))break e;if((p||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?hi(g):null,g!==null&&(_=Pi(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(v=xm,w="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(v=_m,w="onPointerLeave",y="onPointerEnter",x="pointer"),_=p==null?f:as(p),m=g==null?f:as(g),f=new v(w,x+"leave",p,r,h),f.target=_,f.relatedTarget=m,w=null,hi(h)===c&&(v=new v(y,x+"enter",g,r,h),v.target=m,v.relatedTarget=_,w=v),_=w,p&&g)t:{for(v=p,y=g,x=0,m=v;m;m=Oi(m))x++;for(m=0,w=y;w;w=Oi(w))m++;for(;0<x-m;)v=Oi(v),x--;for(;0<m-x;)y=Oi(y),m--;for(;x--;){if(v===y||y!==null&&v===y.alternate)break t;v=Oi(v),y=Oi(y)}v=null}else v=null;p!==null&&km(d,f,p,v,!1),g!==null&&_!==null&&km(d,_,g,v,!0)}}e:{if(f=c?as(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var b=PS;else if(bm(f))if(Tv)b=BS;else{b=kS;var T=IS}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=MS);if(b&&(b=b(t,c))){Ev(d,b,r,h);break e}T&&T(t,f,c),t==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&Hh(f,"number",f.value)}switch(T=c?as(c):window,t){case"focusin":(bm(T)||T.contentEditable==="true")&&(ss=T,td=c,Ao=null);break;case"focusout":Ao=td=ss=null;break;case"mousedown":rd=!0;break;case"contextmenu":case"mouseup":case"dragend":rd=!1,Rm(d,r,h);break;case"selectionchange":if(FS)break;case"keydown":case"keyup":Rm(d,r,h)}var A;if(Yf)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else is?Sv(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(wv&&r.locale!=="ko"&&(is||S!=="onCompositionStart"?S==="onCompositionEnd"&&is&&(A=_v()):(An=h,Vf="value"in An?An.value:An.textContent,is=!0)),T=Gl(c,S),0<T.length&&(S=new vm(S,t,null,r,h),d.push({event:S,listeners:T}),A?S.data=A:(A=bv(r),A!==null&&(S.data=A)))),(A=ES?TS(t,r):AS(t,r))&&(c=Gl(c,"onBeforeInput"),0<c.length&&(h=new vm("onBeforeInput","beforeinput",null,r,h),d.push({event:h,listeners:c}),h.data=A))}Lv(d,e)})}function Vo(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Gl(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=jo(t,r),s!=null&&n.unshift(Vo(t,s,i)),s=jo(t,e),s!=null&&n.push(Vo(t,s,i))),t=t.return}return n}function Oi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function km(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,i?(l=jo(r,s),l!=null&&o.unshift(Vo(r,l,a))):i||(l=jo(r,s),l!=null&&o.push(Vo(r,l,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var US=/\r\n?/g,GS=/\u0000|\uFFFD/g;function Mm(t){return(typeof t=="string"?t:""+t).replace(US,`
`).replace(GS,"")}function ka(t,e,r){if(e=Mm(e),Mm(t)!==e&&r)throw Error(U(425))}function zl(){}var nd=null,id=null;function sd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var od=typeof setTimeout=="function"?setTimeout:void 0,zS=typeof clearTimeout=="function"?clearTimeout:void 0,Bm=typeof Promise=="function"?Promise:void 0,HS=typeof queueMicrotask=="function"?queueMicrotask:typeof Bm<"u"?function(t){return Bm.resolve(null).then(t).catch($S)}:od;function $S(t){setTimeout(function(){throw t})}function Tu(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Go(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Go(e)}function Ln(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Nm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var zs=Math.random().toString(36).slice(2),Mr="__reactFiber$"+zs,Wo="__reactProps$"+zs,rn="__reactContainer$"+zs,ad="__reactEvents$"+zs,VS="__reactListeners$"+zs,WS="__reactHandles$"+zs;function hi(t){var e=t[Mr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[rn]||r[Mr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Nm(t);t!==null;){if(r=t[Mr])return r;t=Nm(t)}return e}t=r,r=t.parentNode}return null}function ca(t){return t=t[Mr]||t[rn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function as(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Ic(t){return t[Wo]||null}var ld=[],ls=-1;function Yn(t){return{current:t}}function Be(t){0>ls||(t.current=ld[ls],ld[ls]=null,ls--)}function Ie(t,e){ls++,ld[ls]=t.current,t.current=e}var Hn={},vt=Yn(Hn),kt=Yn(!1),vi=Hn;function ks(t,e){var r=t.type.contextTypes;if(!r)return Hn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Mt(t){return t=t.childContextTypes,t!=null}function Hl(){Be(kt),Be(vt)}function Lm(t,e,r){if(vt.current!==Hn)throw Error(U(168));Ie(vt,e),Ie(kt,r)}function Dv(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(U(108,Iw(t)||"Unknown",i));return ze({},r,n)}function $l(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Hn,vi=vt.current,Ie(vt,t),Ie(kt,kt.current),!0}function Fm(t,e,r){var n=t.stateNode;if(!n)throw Error(U(169));r?(t=Dv(t,e,vi),n.__reactInternalMemoizedMergedChildContext=t,Be(kt),Be(vt),Ie(vt,t)):Be(kt),Ie(kt,r)}var Wr=null,kc=!1,Au=!1;function jv(t){Wr===null?Wr=[t]:Wr.push(t)}function XS(t){kc=!0,jv(t)}function Kn(){if(!Au&&Wr!==null){Au=!0;var t=0,e=Ae;try{var r=Wr;for(Ae=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Wr=null,kc=!1}catch(i){throw Wr!==null&&(Wr=Wr.slice(t+1)),cv(Gf,Kn),i}finally{Ae=e,Au=!1}}return null}var cs=[],us=0,Vl=null,Wl=0,Kt=[],qt=0,_i=null,Xr=1,Yr="";function ti(t,e){cs[us++]=Wl,cs[us++]=Vl,Vl=t,Wl=e}function Ov(t,e,r){Kt[qt++]=Xr,Kt[qt++]=Yr,Kt[qt++]=_i,_i=t;var n=Xr;t=Yr;var i=32-pr(n)-1;n&=~(1<<i),r+=1;var s=32-pr(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Xr=1<<32-pr(e)+i|r<<i|n,Yr=s+t}else Xr=1<<s|r<<i|n,Yr=t}function qf(t){t.return!==null&&(ti(t,1),Ov(t,1,0))}function Qf(t){for(;t===Vl;)Vl=cs[--us],cs[us]=null,Wl=cs[--us],cs[us]=null;for(;t===_i;)_i=Kt[--qt],Kt[qt]=null,Yr=Kt[--qt],Kt[qt]=null,Xr=Kt[--qt],Kt[qt]=null}var zt=null,Ot=null,Fe=!1,dr=null;function Uv(t,e){var r=Qt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Dm(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,zt=t,Ot=Ln(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,zt=t,Ot=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=_i!==null?{id:Xr,overflow:Yr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Qt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,zt=t,Ot=null,!0):!1;default:return!1}}function cd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ud(t){if(Fe){var e=Ot;if(e){var r=e;if(!Dm(t,e)){if(cd(t))throw Error(U(418));e=Ln(r.nextSibling);var n=zt;e&&Dm(t,e)?Uv(n,r):(t.flags=t.flags&-4097|2,Fe=!1,zt=t)}}else{if(cd(t))throw Error(U(418));t.flags=t.flags&-4097|2,Fe=!1,zt=t}}}function jm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;zt=t}function Ma(t){if(t!==zt)return!1;if(!Fe)return jm(t),Fe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sd(t.type,t.memoizedProps)),e&&(e=Ot)){if(cd(t))throw Gv(),Error(U(418));for(;e;)Uv(t,e),e=Ln(e.nextSibling)}if(jm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ot=Ln(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ot=null}}else Ot=zt?Ln(t.stateNode.nextSibling):null;return!0}function Gv(){for(var t=Ot;t;)t=Ln(t.nextSibling)}function Ms(){Ot=zt=null,Fe=!1}function Zf(t){dr===null?dr=[t]:dr.push(t)}var YS=ln.ReactCurrentBatchConfig;function eo(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(U(309));var n=r.stateNode}if(!n)throw Error(U(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(U(284));if(!r._owner)throw Error(U(290,t))}return t}function Ba(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Om(t){var e=t._init;return e(t._payload)}function zv(t){function e(y,x){if(t){var m=y.deletions;m===null?(y.deletions=[x],y.flags|=16):m.push(x)}}function r(y,x){if(!t)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function n(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function i(y,x){return y=On(y,x),y.index=0,y.sibling=null,y}function s(y,x,m){return y.index=m,t?(m=y.alternate,m!==null?(m=m.index,m<x?(y.flags|=2,x):m):(y.flags|=2,x)):(y.flags|=1048576,x)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,x,m,w){return x===null||x.tag!==6?(x=Bu(m,y.mode,w),x.return=y,x):(x=i(x,m),x.return=y,x)}function l(y,x,m,w){var b=m.type;return b===ns?h(y,x,m.props.children,w,m.key):x!==null&&(x.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===_n&&Om(b)===x.type)?(w=i(x,m.props),w.ref=eo(y,x,m),w.return=y,w):(w=wl(m.type,m.key,m.props,null,y.mode,w),w.ref=eo(y,x,m),w.return=y,w)}function c(y,x,m,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==m.containerInfo||x.stateNode.implementation!==m.implementation?(x=Nu(m,y.mode,w),x.return=y,x):(x=i(x,m.children||[]),x.return=y,x)}function h(y,x,m,w,b){return x===null||x.tag!==7?(x=mi(m,y.mode,w,b),x.return=y,x):(x=i(x,m),x.return=y,x)}function d(y,x,m){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Bu(""+x,y.mode,m),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Sa:return m=wl(x.type,x.key,x.props,null,y.mode,m),m.ref=eo(y,null,x),m.return=y,m;case rs:return x=Nu(x,y.mode,m),x.return=y,x;case _n:var w=x._init;return d(y,w(x._payload),m)}if(co(x)||Ks(x))return x=mi(x,y.mode,m,null),x.return=y,x;Ba(y,x)}return null}function f(y,x,m,w){var b=x!==null?x.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return b!==null?null:a(y,x,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Sa:return m.key===b?l(y,x,m,w):null;case rs:return m.key===b?c(y,x,m,w):null;case _n:return b=m._init,f(y,x,b(m._payload),w)}if(co(m)||Ks(m))return b!==null?null:h(y,x,m,w,null);Ba(y,m)}return null}function p(y,x,m,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(m)||null,a(x,y,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Sa:return y=y.get(w.key===null?m:w.key)||null,l(x,y,w,b);case rs:return y=y.get(w.key===null?m:w.key)||null,c(x,y,w,b);case _n:var T=w._init;return p(y,x,m,T(w._payload),b)}if(co(w)||Ks(w))return y=y.get(m)||null,h(x,y,w,b,null);Ba(x,w)}return null}function g(y,x,m,w){for(var b=null,T=null,A=x,S=x=0,R=null;A!==null&&S<m.length;S++){A.index>S?(R=A,A=null):R=A.sibling;var I=f(y,A,m[S],w);if(I===null){A===null&&(A=R);break}t&&A&&I.alternate===null&&e(y,A),x=s(I,x,S),T===null?b=I:T.sibling=I,T=I,A=R}if(S===m.length)return r(y,A),Fe&&ti(y,S),b;if(A===null){for(;S<m.length;S++)A=d(y,m[S],w),A!==null&&(x=s(A,x,S),T===null?b=A:T.sibling=A,T=A);return Fe&&ti(y,S),b}for(A=n(y,A);S<m.length;S++)R=p(A,y,S,m[S],w),R!==null&&(t&&R.alternate!==null&&A.delete(R.key===null?S:R.key),x=s(R,x,S),T===null?b=R:T.sibling=R,T=R);return t&&A.forEach(function(L){return e(y,L)}),Fe&&ti(y,S),b}function v(y,x,m,w){var b=Ks(m);if(typeof b!="function")throw Error(U(150));if(m=b.call(m),m==null)throw Error(U(151));for(var T=b=null,A=x,S=x=0,R=null,I=m.next();A!==null&&!I.done;S++,I=m.next()){A.index>S?(R=A,A=null):R=A.sibling;var L=f(y,A,I.value,w);if(L===null){A===null&&(A=R);break}t&&A&&L.alternate===null&&e(y,A),x=s(L,x,S),T===null?b=L:T.sibling=L,T=L,A=R}if(I.done)return r(y,A),Fe&&ti(y,S),b;if(A===null){for(;!I.done;S++,I=m.next())I=d(y,I.value,w),I!==null&&(x=s(I,x,S),T===null?b=I:T.sibling=I,T=I);return Fe&&ti(y,S),b}for(A=n(y,A);!I.done;S++,I=m.next())I=p(A,y,S,I.value,w),I!==null&&(t&&I.alternate!==null&&A.delete(I.key===null?S:I.key),x=s(I,x,S),T===null?b=I:T.sibling=I,T=I);return t&&A.forEach(function(B){return e(y,B)}),Fe&&ti(y,S),b}function _(y,x,m,w){if(typeof m=="object"&&m!==null&&m.type===ns&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Sa:e:{for(var b=m.key,T=x;T!==null;){if(T.key===b){if(b=m.type,b===ns){if(T.tag===7){r(y,T.sibling),x=i(T,m.props.children),x.return=y,y=x;break e}}else if(T.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===_n&&Om(b)===T.type){r(y,T.sibling),x=i(T,m.props),x.ref=eo(y,T,m),x.return=y,y=x;break e}r(y,T);break}else e(y,T);T=T.sibling}m.type===ns?(x=mi(m.props.children,y.mode,w,m.key),x.return=y,y=x):(w=wl(m.type,m.key,m.props,null,y.mode,w),w.ref=eo(y,x,m),w.return=y,y=w)}return o(y);case rs:e:{for(T=m.key;x!==null;){if(x.key===T)if(x.tag===4&&x.stateNode.containerInfo===m.containerInfo&&x.stateNode.implementation===m.implementation){r(y,x.sibling),x=i(x,m.children||[]),x.return=y,y=x;break e}else{r(y,x);break}else e(y,x);x=x.sibling}x=Nu(m,y.mode,w),x.return=y,y=x}return o(y);case _n:return T=m._init,_(y,x,T(m._payload),w)}if(co(m))return g(y,x,m,w);if(Ks(m))return v(y,x,m,w);Ba(y,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,x!==null&&x.tag===6?(r(y,x.sibling),x=i(x,m),x.return=y,y=x):(r(y,x),x=Bu(m,y.mode,w),x.return=y,y=x),o(y)):r(y,x)}return _}var Bs=zv(!0),Hv=zv(!1),Xl=Yn(null),Yl=null,hs=null,Jf=null;function ep(){Jf=hs=Yl=null}function tp(t){var e=Xl.current;Be(Xl),t._currentValue=e}function hd(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function _s(t,e){Yl=t,Jf=hs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Rt=!0),t.firstContext=null)}function tr(t){var e=t._currentValue;if(Jf!==t)if(t={context:t,memoizedValue:e,next:null},hs===null){if(Yl===null)throw Error(U(308));hs=t,Yl.dependencies={lanes:0,firstContext:t}}else hs=hs.next=t;return e}var di=null;function rp(t){di===null?di=[t]:di.push(t)}function $v(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,rp(e)):(r.next=i.next,i.next=r),e.interleaved=r,nn(t,n)}function nn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var wn=!1;function np(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,we&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,nn(t,r)}return i=n.interleaved,i===null?(e.next=e,rp(n)):(e.next=i.next,i.next=e),n.interleaved=e,nn(t,r)}function ml(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,zf(t,r)}}function Um(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Kl(t,e,r,n){var i=t.updateQueue;wn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,h=c=l=null,a=s;do{var f=a.lane,p=a.eventTime;if((n&f)===f){h!==null&&(h=h.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,v=a;switch(f=e,p=r,v.tag){case 1:if(g=v.payload,typeof g=="function"){d=g.call(p,d,f);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,f=typeof g=="function"?g.call(p,d,f):g,f==null)break e;d=ze({},d,f);break e;case 2:wn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=p,l=d):h=h.next=p,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(h===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Si|=o,t.lanes=o,t.memoizedState=d}}function Gm(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(U(191,i));i.call(n)}}}var ua={},Lr=Yn(ua),Xo=Yn(ua),Yo=Yn(ua);function fi(t){if(t===ua)throw Error(U(174));return t}function ip(t,e){switch(Ie(Yo,e),Ie(Xo,t),Ie(Lr,ua),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vh(e,t)}Be(Lr),Ie(Lr,e)}function Ns(){Be(Lr),Be(Xo),Be(Yo)}function Wv(t){fi(Yo.current);var e=fi(Lr.current),r=Vh(e,t.type);e!==r&&(Ie(Xo,t),Ie(Lr,r))}function sp(t){Xo.current===t&&(Be(Lr),Be(Xo))}var Oe=Yn(0);function ql(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Cu=[];function op(){for(var t=0;t<Cu.length;t++)Cu[t]._workInProgressVersionPrimary=null;Cu.length=0}var gl=ln.ReactCurrentDispatcher,Ru=ln.ReactCurrentBatchConfig,wi=0,Ge=null,et=null,st=null,Ql=!1,Co=!1,Ko=0,KS=0;function gt(){throw Error(U(321))}function ap(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!xr(t[r],e[r]))return!1;return!0}function lp(t,e,r,n,i,s){if(wi=s,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,gl.current=t===null||t.memoizedState===null?JS:eb,t=r(n,i),Co){s=0;do{if(Co=!1,Ko=0,25<=s)throw Error(U(301));s+=1,st=et=null,e.updateQueue=null,gl.current=tb,t=r(n,i)}while(Co)}if(gl.current=Zl,e=et!==null&&et.next!==null,wi=0,st=et=Ge=null,Ql=!1,e)throw Error(U(300));return t}function cp(){var t=Ko!==0;return Ko=0,t}function Rr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Ge.memoizedState=st=t:st=st.next=t,st}function rr(){if(et===null){var t=Ge.alternate;t=t!==null?t.memoizedState:null}else t=et.next;var e=st===null?Ge.memoizedState:st.next;if(e!==null)st=e,et=t;else{if(t===null)throw Error(U(310));et=t,t={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},st===null?Ge.memoizedState=st=t:st=st.next=t}return st}function qo(t,e){return typeof e=="function"?e(t):e}function Pu(t){var e=rr(),r=e.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=t;var n=et,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,c=s;do{var h=c.lane;if((wi&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=n):l=l.next=d,Ge.lanes|=h,Si|=h}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,xr(n,e.memoizedState)||(Rt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Ge.lanes|=s,Si|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Iu(t){var e=rr(),r=e.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);xr(s,e.memoizedState)||(Rt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Xv(){}function Yv(t,e){var r=Ge,n=rr(),i=e(),s=!xr(n.memoizedState,i);if(s&&(n.memoizedState=i,Rt=!0),n=n.queue,up(Qv.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||st!==null&&st.memoizedState.tag&1){if(r.flags|=2048,Qo(9,qv.bind(null,r,n,i,e),void 0,null),at===null)throw Error(U(349));wi&30||Kv(r,e,i)}return i}function Kv(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function qv(t,e,r,n){e.value=r,e.getSnapshot=n,Zv(e)&&Jv(t)}function Qv(t,e,r){return r(function(){Zv(e)&&Jv(t)})}function Zv(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!xr(t,r)}catch{return!0}}function Jv(t){var e=nn(t,1);e!==null&&mr(e,t,1,-1)}function zm(t){var e=Rr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:t},e.queue=t,t=t.dispatch=ZS.bind(null,Ge,t),[e.memoizedState,t]}function Qo(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function e0(){return rr().memoizedState}function yl(t,e,r,n){var i=Rr();Ge.flags|=t,i.memoizedState=Qo(1|e,r,void 0,n===void 0?null:n)}function Mc(t,e,r,n){var i=rr();n=n===void 0?null:n;var s=void 0;if(et!==null){var o=et.memoizedState;if(s=o.destroy,n!==null&&ap(n,o.deps)){i.memoizedState=Qo(e,r,s,n);return}}Ge.flags|=t,i.memoizedState=Qo(1|e,r,s,n)}function Hm(t,e){return yl(8390656,8,t,e)}function up(t,e){return Mc(2048,8,t,e)}function t0(t,e){return Mc(4,2,t,e)}function r0(t,e){return Mc(4,4,t,e)}function n0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function i0(t,e,r){return r=r!=null?r.concat([t]):null,Mc(4,4,n0.bind(null,e,t),r)}function hp(){}function s0(t,e){var r=rr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&ap(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function o0(t,e){var r=rr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&ap(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function a0(t,e,r){return wi&21?(xr(r,e)||(r=dv(),Ge.lanes|=r,Si|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Rt=!0),t.memoizedState=r)}function qS(t,e){var r=Ae;Ae=r!==0&&4>r?r:4,t(!0);var n=Ru.transition;Ru.transition={};try{t(!1),e()}finally{Ae=r,Ru.transition=n}}function l0(){return rr().memoizedState}function QS(t,e,r){var n=jn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},c0(t))u0(e,r);else if(r=$v(t,e,r,n),r!==null){var i=St();mr(r,t,n,i),h0(r,e,n)}}function ZS(t,e,r){var n=jn(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(c0(t))u0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,xr(a,o)){var l=e.interleaved;l===null?(i.next=i,rp(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=$v(t,e,i,n),r!==null&&(i=St(),mr(r,t,n,i),h0(r,e,n))}}function c0(t){var e=t.alternate;return t===Ge||e!==null&&e===Ge}function u0(t,e){Co=Ql=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function h0(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,zf(t,r)}}var Zl={readContext:tr,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useInsertionEffect:gt,useLayoutEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useMutableSource:gt,useSyncExternalStore:gt,useId:gt,unstable_isNewReconciler:!1},JS={readContext:tr,useCallback:function(t,e){return Rr().memoizedState=[t,e===void 0?null:e],t},useContext:tr,useEffect:Hm,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,yl(4194308,4,n0.bind(null,e,t),r)},useLayoutEffect:function(t,e){return yl(4194308,4,t,e)},useInsertionEffect:function(t,e){return yl(4,2,t,e)},useMemo:function(t,e){var r=Rr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Rr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=QS.bind(null,Ge,t),[n.memoizedState,t]},useRef:function(t){var e=Rr();return t={current:t},e.memoizedState=t},useState:zm,useDebugValue:hp,useDeferredValue:function(t){return Rr().memoizedState=t},useTransition:function(){var t=zm(!1),e=t[0];return t=qS.bind(null,t[1]),Rr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ge,i=Rr();if(Fe){if(r===void 0)throw Error(U(407));r=r()}else{if(r=e(),at===null)throw Error(U(349));wi&30||Kv(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Hm(Qv.bind(null,n,s,t),[t]),n.flags|=2048,Qo(9,qv.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Rr(),e=at.identifierPrefix;if(Fe){var r=Yr,n=Xr;r=(n&~(1<<32-pr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ko++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=KS++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},eb={readContext:tr,useCallback:s0,useContext:tr,useEffect:up,useImperativeHandle:i0,useInsertionEffect:t0,useLayoutEffect:r0,useMemo:o0,useReducer:Pu,useRef:e0,useState:function(){return Pu(qo)},useDebugValue:hp,useDeferredValue:function(t){var e=rr();return a0(e,et.memoizedState,t)},useTransition:function(){var t=Pu(qo)[0],e=rr().memoizedState;return[t,e]},useMutableSource:Xv,useSyncExternalStore:Yv,useId:l0,unstable_isNewReconciler:!1},tb={readContext:tr,useCallback:s0,useContext:tr,useEffect:up,useImperativeHandle:i0,useInsertionEffect:t0,useLayoutEffect:r0,useMemo:o0,useReducer:Iu,useRef:e0,useState:function(){return Iu(qo)},useDebugValue:hp,useDeferredValue:function(t){var e=rr();return et===null?e.memoizedState=t:a0(e,et.memoizedState,t)},useTransition:function(){var t=Iu(qo)[0],e=rr().memoizedState;return[t,e]},useMutableSource:Xv,useSyncExternalStore:Yv,useId:l0,unstable_isNewReconciler:!1};function ur(t,e){if(t&&t.defaultProps){e=ze({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function dd(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:ze({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Bc={isMounted:function(t){return(t=t._reactInternals)?Pi(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=St(),i=jn(t),s=Jr(n,i);s.payload=e,r!=null&&(s.callback=r),e=Fn(t,s,i),e!==null&&(mr(e,t,i,n),ml(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=St(),i=jn(t),s=Jr(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Fn(t,s,i),e!==null&&(mr(e,t,i,n),ml(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=St(),n=jn(t),i=Jr(r,n);i.tag=2,e!=null&&(i.callback=e),e=Fn(t,i,n),e!==null&&(mr(e,t,n,r),ml(e,t,n))}};function $m(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ho(r,n)||!Ho(i,s):!0}function d0(t,e,r){var n=!1,i=Hn,s=e.contextType;return typeof s=="object"&&s!==null?s=tr(s):(i=Mt(e)?vi:vt.current,n=e.contextTypes,s=(n=n!=null)?ks(t,i):Hn),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Vm(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Bc.enqueueReplaceState(e,e.state,null)}function fd(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},np(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=tr(s):(s=Mt(e)?vi:vt.current,i.context=ks(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(dd(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Bc.enqueueReplaceState(i,i.state,null),Kl(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ls(t,e){try{var r="",n=e;do r+=Pw(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function ku(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function pd(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var rb=typeof WeakMap=="function"?WeakMap:Map;function f0(t,e,r){r=Jr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){ec||(ec=!0,Ed=n),pd(t,e)},r}function p0(t,e,r){r=Jr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){pd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){pd(t,e),typeof n!="function"&&(Dn===null?Dn=new Set([this]):Dn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Wm(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new rb;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=gb.bind(null,t,e,r),e.then(t,t))}function Xm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ym(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Jr(-1,1),e.tag=2,Fn(r,e,1))),r.lanes|=1),t)}var nb=ln.ReactCurrentOwner,Rt=!1;function _t(t,e,r,n){e.child=t===null?Hv(e,null,r,n):Bs(e,t.child,r,n)}function Km(t,e,r,n,i){r=r.render;var s=e.ref;return _s(e,i),n=lp(t,e,r,n,s,i),r=cp(),t!==null&&!Rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,sn(t,e,i)):(Fe&&r&&qf(e),e.flags|=1,_t(t,e,n,i),e.child)}function qm(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!vp(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,m0(t,e,s,n,i)):(t=wl(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ho,r(o,n)&&t.ref===e.ref)return sn(t,e,i)}return e.flags|=1,t=On(s,n),t.ref=e.ref,t.return=e,e.child=t}function m0(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Ho(s,n)&&t.ref===e.ref)if(Rt=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Rt=!0);else return e.lanes=t.lanes,sn(t,e,i)}return md(t,e,r,n,i)}function g0(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ie(fs,jt),jt|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ie(fs,jt),jt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Ie(fs,jt),jt|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Ie(fs,jt),jt|=n;return _t(t,e,i,r),e.child}function y0(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function md(t,e,r,n,i){var s=Mt(r)?vi:vt.current;return s=ks(e,s),_s(e,i),r=lp(t,e,r,n,s,i),n=cp(),t!==null&&!Rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,sn(t,e,i)):(Fe&&n&&qf(e),e.flags|=1,_t(t,e,r,i),e.child)}function Qm(t,e,r,n,i){if(Mt(r)){var s=!0;$l(e)}else s=!1;if(_s(e,i),e.stateNode===null)xl(t,e),d0(e,r,n),fd(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=tr(c):(c=Mt(r)?vi:vt.current,c=ks(e,c));var h=r.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&Vm(e,o,n,c),wn=!1;var f=e.memoizedState;o.state=f,Kl(e,n,o,i),l=e.memoizedState,a!==n||f!==l||kt.current||wn?(typeof h=="function"&&(dd(e,r,h,n),l=e.memoizedState),(a=wn||$m(e,r,a,n,f,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Vv(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ur(e.type,a),o.props=c,d=e.pendingProps,f=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=tr(l):(l=Mt(r)?vi:vt.current,l=ks(e,l));var p=r.getDerivedStateFromProps;(h=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&Vm(e,o,n,l),wn=!1,f=e.memoizedState,o.state=f,Kl(e,n,o,i);var g=e.memoizedState;a!==d||f!==g||kt.current||wn?(typeof p=="function"&&(dd(e,r,p,n),g=e.memoizedState),(c=wn||$m(e,r,c,n,f,g,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),o.props=n,o.state=g,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return gd(t,e,r,n,s,i)}function gd(t,e,r,n,i,s){y0(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Fm(e,r,!1),sn(t,e,s);n=e.stateNode,nb.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Bs(e,t.child,null,s),e.child=Bs(e,null,a,s)):_t(t,e,a,s),e.memoizedState=n.state,i&&Fm(e,r,!0),e.child}function x0(t){var e=t.stateNode;e.pendingContext?Lm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Lm(t,e.context,!1),ip(t,e.containerInfo)}function Zm(t,e,r,n,i){return Ms(),Zf(i),e.flags|=256,_t(t,e,r,n),e.child}var yd={dehydrated:null,treeContext:null,retryLane:0};function xd(t){return{baseLanes:t,cachePool:null,transitions:null}}function v0(t,e,r){var n=e.pendingProps,i=Oe.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ie(Oe,i&1),t===null)return ud(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Fc(o,n,0,null),t=mi(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=xd(r),e.memoizedState=yd,t):dp(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return ib(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=On(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=On(a,s):(s=mi(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?xd(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=yd,n}return s=t.child,t=s.sibling,n=On(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function dp(t,e){return e=Fc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Na(t,e,r,n){return n!==null&&Zf(n),Bs(e,t.child,null,r),t=dp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ib(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=ku(Error(U(422))),Na(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Fc({mode:"visible",children:n.children},i,0,null),s=mi(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Bs(e,t.child,null,o),e.child.memoizedState=xd(o),e.memoizedState=yd,s);if(!(e.mode&1))return Na(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(U(419)),n=ku(s,n,void 0),Na(t,e,o,n)}if(a=(o&t.childLanes)!==0,Rt||a){if(n=at,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,nn(t,i),mr(n,t,i,-1))}return xp(),n=ku(Error(U(421))),Na(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=yb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ot=Ln(i.nextSibling),zt=e,Fe=!0,dr=null,t!==null&&(Kt[qt++]=Xr,Kt[qt++]=Yr,Kt[qt++]=_i,Xr=t.id,Yr=t.overflow,_i=e),e=dp(e,n.children),e.flags|=4096,e)}function Jm(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),hd(t.return,e,r)}function Mu(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function _0(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(_t(t,e,n.children,r),n=Oe.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Jm(t,r,e);else if(t.tag===19)Jm(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ie(Oe,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&ql(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Mu(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ql(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Mu(e,!0,r,null,s);break;case"together":Mu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Si|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,r=On(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=On(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function sb(t,e,r){switch(e.tag){case 3:x0(e),Ms();break;case 5:Wv(e);break;case 1:Mt(e.type)&&$l(e);break;case 4:ip(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Ie(Xl,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ie(Oe,Oe.current&1),e.flags|=128,null):r&e.child.childLanes?v0(t,e,r):(Ie(Oe,Oe.current&1),t=sn(t,e,r),t!==null?t.sibling:null);Ie(Oe,Oe.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return _0(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ie(Oe,Oe.current),n)break;return null;case 22:case 23:return e.lanes=0,g0(t,e,r)}return sn(t,e,r)}var w0,vd,S0,b0;w0=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};vd=function(){};S0=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,fi(Lr.current);var s=null;switch(r){case"input":i=Gh(t,i),n=Gh(t,n),s=[];break;case"select":i=ze({},i,{value:void 0}),n=ze({},n,{value:void 0}),s=[];break;case"textarea":i=$h(t,i),n=$h(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=zl)}Wh(r,n);var o;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fo.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fo.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ke("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};b0=function(t,e,r,n){r!==n&&(e.flags|=4)};function to(t,e){if(!Fe)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function yt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function ob(t,e,r){var n=e.pendingProps;switch(Qf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(e),null;case 1:return Mt(e.type)&&Hl(),yt(e),null;case 3:return n=e.stateNode,Ns(),Be(kt),Be(vt),op(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Ma(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,dr!==null&&(Cd(dr),dr=null))),vd(t,e),yt(e),null;case 5:sp(e);var i=fi(Yo.current);if(r=e.type,t!==null&&e.stateNode!=null)S0(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(U(166));return yt(e),null}if(t=fi(Lr.current),Ma(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Mr]=e,n[Wo]=s,t=(e.mode&1)!==0,r){case"dialog":ke("cancel",n),ke("close",n);break;case"iframe":case"object":case"embed":ke("load",n);break;case"video":case"audio":for(i=0;i<ho.length;i++)ke(ho[i],n);break;case"source":ke("error",n);break;case"img":case"image":case"link":ke("error",n),ke("load",n);break;case"details":ke("toggle",n);break;case"input":lm(n,s),ke("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ke("invalid",n);break;case"textarea":um(n,s),ke("invalid",n)}Wh(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&ka(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&ka(n.textContent,a,t),i=["children",""+a]):Fo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ke("scroll",n)}switch(r){case"input":ba(n),cm(n,s,!0);break;case"textarea":ba(n),hm(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=zl)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Qx(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Mr]=e,t[Wo]=n,w0(t,e,!1,!1),e.stateNode=t;e:{switch(o=Xh(r,n),r){case"dialog":ke("cancel",t),ke("close",t),i=n;break;case"iframe":case"object":case"embed":ke("load",t),i=n;break;case"video":case"audio":for(i=0;i<ho.length;i++)ke(ho[i],t);i=n;break;case"source":ke("error",t),i=n;break;case"img":case"image":case"link":ke("error",t),ke("load",t),i=n;break;case"details":ke("toggle",t),i=n;break;case"input":lm(t,n),i=Gh(t,n),ke("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=ze({},n,{value:void 0}),ke("invalid",t);break;case"textarea":um(t,n),i=$h(t,n),ke("invalid",t);break;default:i=n}Wh(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?ev(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Zx(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Do(t,l):typeof l=="number"&&Do(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Fo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ke("scroll",t):l!=null&&Ff(t,s,l,o))}switch(r){case"input":ba(t),cm(t,n,!1);break;case"textarea":ba(t),hm(t);break;case"option":n.value!=null&&t.setAttribute("value",""+zn(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?gs(t,!!n.multiple,s,!1):n.defaultValue!=null&&gs(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=zl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return yt(e),null;case 6:if(t&&e.stateNode!=null)b0(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(U(166));if(r=fi(Yo.current),fi(Lr.current),Ma(e)){if(n=e.stateNode,r=e.memoizedProps,n[Mr]=e,(s=n.nodeValue!==r)&&(t=zt,t!==null))switch(t.tag){case 3:ka(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ka(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Mr]=e,e.stateNode=n}return yt(e),null;case 13:if(Be(Oe),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Fe&&Ot!==null&&e.mode&1&&!(e.flags&128))Gv(),Ms(),e.flags|=98560,s=!1;else if(s=Ma(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(U(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(U(317));s[Mr]=e}else Ms(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;yt(e),s=!1}else dr!==null&&(Cd(dr),dr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Oe.current&1?tt===0&&(tt=3):xp())),e.updateQueue!==null&&(e.flags|=4),yt(e),null);case 4:return Ns(),vd(t,e),t===null&&$o(e.stateNode.containerInfo),yt(e),null;case 10:return tp(e.type._context),yt(e),null;case 17:return Mt(e.type)&&Hl(),yt(e),null;case 19:if(Be(Oe),s=e.memoizedState,s===null)return yt(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)to(s,!1);else{if(tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ql(t),o!==null){for(e.flags|=128,to(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Ie(Oe,Oe.current&1|2),e.child}t=t.sibling}s.tail!==null&&Xe()>Fs&&(e.flags|=128,n=!0,to(s,!1),e.lanes=4194304)}else{if(!n)if(t=ql(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),to(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Fe)return yt(e),null}else 2*Xe()-s.renderingStartTime>Fs&&r!==1073741824&&(e.flags|=128,n=!0,to(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Xe(),e.sibling=null,r=Oe.current,Ie(Oe,n?r&1|2:r&1),e):(yt(e),null);case 22:case 23:return yp(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?jt&1073741824&&(yt(e),e.subtreeFlags&6&&(e.flags|=8192)):yt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function ab(t,e){switch(Qf(e),e.tag){case 1:return Mt(e.type)&&Hl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ns(),Be(kt),Be(vt),op(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return sp(e),null;case 13:if(Be(Oe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Ms()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be(Oe),null;case 4:return Ns(),null;case 10:return tp(e.type._context),null;case 22:case 23:return yp(),null;case 24:return null;default:return null}}var La=!1,xt=!1,lb=typeof WeakSet=="function"?WeakSet:Set,Y=null;function ds(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ve(t,e,n)}else r.current=null}function _d(t,e,r){try{r()}catch(n){Ve(t,e,n)}}var eg=!1;function cb(t,e){if(nd=Ol,t=Rv(),Kf(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,c=0,h=0,d=t,f=null;t:for(;;){for(var p;d!==r||i!==0&&d.nodeType!==3||(a=o+i),d!==s||n!==0&&d.nodeType!==3||(l=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===t)break t;if(f===r&&++c===i&&(a=o),f===s&&++h===n&&(l=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(id={focusedElem:t,selectionRange:r},Ol=!1,Y=e;Y!==null;)if(e=Y,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Y=t;else for(;Y!==null;){e=Y;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,_=g.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?v:ur(e.type,v),_);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(w){Ve(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}return g=eg,eg=!1,g}function Ro(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&_d(e,r,s)}i=i.next}while(i!==n)}}function Nc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function wd(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function E0(t){var e=t.alternate;e!==null&&(t.alternate=null,E0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Mr],delete e[Wo],delete e[ad],delete e[VS],delete e[WS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function T0(t){return t.tag===5||t.tag===3||t.tag===4}function tg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||T0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=zl));else if(n!==4&&(t=t.child,t!==null))for(Sd(t,e,r),t=t.sibling;t!==null;)Sd(t,e,r),t=t.sibling}function bd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(bd(t,e,r),t=t.sibling;t!==null;)bd(t,e,r),t=t.sibling}var ut=null,hr=!1;function mn(t,e,r){for(r=r.child;r!==null;)A0(t,e,r),r=r.sibling}function A0(t,e,r){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Ac,r)}catch{}switch(r.tag){case 5:xt||ds(r,e);case 6:var n=ut,i=hr;ut=null,mn(t,e,r),ut=n,hr=i,ut!==null&&(hr?(t=ut,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ut.removeChild(r.stateNode));break;case 18:ut!==null&&(hr?(t=ut,r=r.stateNode,t.nodeType===8?Tu(t.parentNode,r):t.nodeType===1&&Tu(t,r),Go(t)):Tu(ut,r.stateNode));break;case 4:n=ut,i=hr,ut=r.stateNode.containerInfo,hr=!0,mn(t,e,r),ut=n,hr=i;break;case 0:case 11:case 14:case 15:if(!xt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&_d(r,e,o),i=i.next}while(i!==n)}mn(t,e,r);break;case 1:if(!xt&&(ds(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Ve(r,e,a)}mn(t,e,r);break;case 21:mn(t,e,r);break;case 22:r.mode&1?(xt=(n=xt)||r.memoizedState!==null,mn(t,e,r),xt=n):mn(t,e,r);break;default:mn(t,e,r)}}function rg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new lb),e.forEach(function(n){var i=xb.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function sr(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ut=a.stateNode,hr=!1;break e;case 3:ut=a.stateNode.containerInfo,hr=!0;break e;case 4:ut=a.stateNode.containerInfo,hr=!0;break e}a=a.return}if(ut===null)throw Error(U(160));A0(s,o,i),ut=null,hr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Ve(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)C0(e,t),e=e.sibling}function C0(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(sr(e,t),_r(t),n&4){try{Ro(3,t,t.return),Nc(3,t)}catch(v){Ve(t,t.return,v)}try{Ro(5,t,t.return)}catch(v){Ve(t,t.return,v)}}break;case 1:sr(e,t),_r(t),n&512&&r!==null&&ds(r,r.return);break;case 5:if(sr(e,t),_r(t),n&512&&r!==null&&ds(r,r.return),t.flags&32){var i=t.stateNode;try{Do(i,"")}catch(v){Ve(t,t.return,v)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Kx(i,s),Xh(a,o);var c=Xh(a,s);for(o=0;o<l.length;o+=2){var h=l[o],d=l[o+1];h==="style"?ev(i,d):h==="dangerouslySetInnerHTML"?Zx(i,d):h==="children"?Do(i,d):Ff(i,h,d,c)}switch(a){case"input":zh(i,s);break;case"textarea":qx(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?gs(i,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?gs(i,!!s.multiple,s.defaultValue,!0):gs(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wo]=s}catch(v){Ve(t,t.return,v)}}break;case 6:if(sr(e,t),_r(t),n&4){if(t.stateNode===null)throw Error(U(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){Ve(t,t.return,v)}}break;case 3:if(sr(e,t),_r(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Go(e.containerInfo)}catch(v){Ve(t,t.return,v)}break;case 4:sr(e,t),_r(t);break;case 13:sr(e,t),_r(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(mp=Xe())),n&4&&rg(t);break;case 22:if(h=r!==null&&r.memoizedState!==null,t.mode&1?(xt=(c=xt)||h,sr(e,t),xt=c):sr(e,t),_r(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!h&&t.mode&1)for(Y=t,h=t.child;h!==null;){for(d=Y=h;Y!==null;){switch(f=Y,p=f.child,f.tag){case 0:case 11:case 14:case 15:Ro(4,f,f.return);break;case 1:ds(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(v){Ve(n,r,v)}}break;case 5:ds(f,f.return);break;case 22:if(f.memoizedState!==null){ig(d);continue}}p!==null?(p.return=f,Y=p):ig(d)}h=h.sibling}e:for(h=null,d=t;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Jx("display",o))}catch(v){Ve(t,t.return,v)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(v){Ve(t,t.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:sr(e,t),_r(t),n&4&&rg(t);break;case 21:break;default:sr(e,t),_r(t)}}function _r(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(T0(r)){var n=r;break e}r=r.return}throw Error(U(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Do(i,""),n.flags&=-33);var s=tg(t);bd(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=tg(t);Sd(t,a,o);break;default:throw Error(U(161))}}catch(l){Ve(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ub(t,e,r){Y=t,R0(t)}function R0(t,e,r){for(var n=(t.mode&1)!==0;Y!==null;){var i=Y,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||La;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||xt;a=La;var c=xt;if(La=o,(xt=l)&&!c)for(Y=i;Y!==null;)o=Y,l=o.child,o.tag===22&&o.memoizedState!==null?sg(i):l!==null?(l.return=o,Y=l):sg(i);for(;s!==null;)Y=s,R0(s),s=s.sibling;Y=i,La=a,xt=c}ng(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Y=s):ng(t)}}function ng(t){for(;Y!==null;){var e=Y;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:xt||Nc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!xt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:ur(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Gm(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Gm(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Go(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}xt||e.flags&512&&wd(e)}catch(f){Ve(e,e.return,f)}}if(e===t){Y=null;break}if(r=e.sibling,r!==null){r.return=e.return,Y=r;break}Y=e.return}}function ig(t){for(;Y!==null;){var e=Y;if(e===t){Y=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Y=r;break}Y=e.return}}function sg(t){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Nc(4,e)}catch(l){Ve(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Ve(e,i,l)}}var s=e.return;try{wd(e)}catch(l){Ve(e,s,l)}break;case 5:var o=e.return;try{wd(e)}catch(l){Ve(e,o,l)}}}catch(l){Ve(e,e.return,l)}if(e===t){Y=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Y=a;break}Y=e.return}}var hb=Math.ceil,Jl=ln.ReactCurrentDispatcher,fp=ln.ReactCurrentOwner,er=ln.ReactCurrentBatchConfig,we=0,at=null,qe=null,dt=0,jt=0,fs=Yn(0),tt=0,Zo=null,Si=0,Lc=0,pp=0,Po=null,Ct=null,mp=0,Fs=1/0,$r=null,ec=!1,Ed=null,Dn=null,Fa=!1,Cn=null,tc=0,Io=0,Td=null,vl=-1,_l=0;function St(){return we&6?Xe():vl!==-1?vl:vl=Xe()}function jn(t){return t.mode&1?we&2&&dt!==0?dt&-dt:YS.transition!==null?(_l===0&&(_l=dv()),_l):(t=Ae,t!==0||(t=window.event,t=t===void 0?16:vv(t.type)),t):1}function mr(t,e,r,n){if(50<Io)throw Io=0,Td=null,Error(U(185));aa(t,r,n),(!(we&2)||t!==at)&&(t===at&&(!(we&2)&&(Lc|=r),tt===4&&En(t,dt)),Bt(t,n),r===1&&we===0&&!(e.mode&1)&&(Fs=Xe()+500,kc&&Kn()))}function Bt(t,e){var r=t.callbackNode;Yw(t,e);var n=jl(t,t===at?dt:0);if(n===0)r!==null&&pm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&pm(r),e===1)t.tag===0?XS(og.bind(null,t)):jv(og.bind(null,t)),HS(function(){!(we&6)&&Kn()}),r=null;else{switch(fv(n)){case 1:r=Gf;break;case 4:r=uv;break;case 16:r=Dl;break;case 536870912:r=hv;break;default:r=Dl}r=F0(r,P0.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function P0(t,e){if(vl=-1,_l=0,we&6)throw Error(U(327));var r=t.callbackNode;if(ws()&&t.callbackNode!==r)return null;var n=jl(t,t===at?dt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=rc(t,n);else{e=n;var i=we;we|=2;var s=k0();(at!==t||dt!==e)&&($r=null,Fs=Xe()+500,pi(t,e));do try{pb();break}catch(a){I0(t,a)}while(!0);ep(),Jl.current=s,we=i,qe!==null?e=0:(at=null,dt=0,e=tt)}if(e!==0){if(e===2&&(i=Zh(t),i!==0&&(n=i,e=Ad(t,i))),e===1)throw r=Zo,pi(t,0),En(t,n),Bt(t,Xe()),r;if(e===6)En(t,n);else{if(i=t.current.alternate,!(n&30)&&!db(i)&&(e=rc(t,n),e===2&&(s=Zh(t),s!==0&&(n=s,e=Ad(t,s))),e===1))throw r=Zo,pi(t,0),En(t,n),Bt(t,Xe()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(U(345));case 2:ri(t,Ct,$r);break;case 3:if(En(t,n),(n&130023424)===n&&(e=mp+500-Xe(),10<e)){if(jl(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){St(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=od(ri.bind(null,t,Ct,$r),e);break}ri(t,Ct,$r);break;case 4:if(En(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-pr(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=Xe()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hb(n/1960))-n,10<n){t.timeoutHandle=od(ri.bind(null,t,Ct,$r),n);break}ri(t,Ct,$r);break;case 5:ri(t,Ct,$r);break;default:throw Error(U(329))}}}return Bt(t,Xe()),t.callbackNode===r?P0.bind(null,t):null}function Ad(t,e){var r=Po;return t.current.memoizedState.isDehydrated&&(pi(t,e).flags|=256),t=rc(t,e),t!==2&&(e=Ct,Ct=r,e!==null&&Cd(e)),t}function Cd(t){Ct===null?Ct=t:Ct.push.apply(Ct,t)}function db(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!xr(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function En(t,e){for(e&=~pp,e&=~Lc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-pr(e),n=1<<r;t[r]=-1,e&=~n}}function og(t){if(we&6)throw Error(U(327));ws();var e=jl(t,0);if(!(e&1))return Bt(t,Xe()),null;var r=rc(t,e);if(t.tag!==0&&r===2){var n=Zh(t);n!==0&&(e=n,r=Ad(t,n))}if(r===1)throw r=Zo,pi(t,0),En(t,e),Bt(t,Xe()),r;if(r===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ri(t,Ct,$r),Bt(t,Xe()),null}function gp(t,e){var r=we;we|=1;try{return t(e)}finally{we=r,we===0&&(Fs=Xe()+500,kc&&Kn())}}function bi(t){Cn!==null&&Cn.tag===0&&!(we&6)&&ws();var e=we;we|=1;var r=er.transition,n=Ae;try{if(er.transition=null,Ae=1,t)return t()}finally{Ae=n,er.transition=r,we=e,!(we&6)&&Kn()}}function yp(){jt=fs.current,Be(fs)}function pi(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,zS(r)),qe!==null)for(r=qe.return;r!==null;){var n=r;switch(Qf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Hl();break;case 3:Ns(),Be(kt),Be(vt),op();break;case 5:sp(n);break;case 4:Ns();break;case 13:Be(Oe);break;case 19:Be(Oe);break;case 10:tp(n.type._context);break;case 22:case 23:yp()}r=r.return}if(at=t,qe=t=On(t.current,null),dt=jt=e,tt=0,Zo=null,pp=Lc=Si=0,Ct=Po=null,di!==null){for(e=0;e<di.length;e++)if(r=di[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}di=null}return t}function I0(t,e){do{var r=qe;try{if(ep(),gl.current=Zl,Ql){for(var n=Ge.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ql=!1}if(wi=0,st=et=Ge=null,Co=!1,Ko=0,fp.current=null,r===null||r.return===null){tt=1,Zo=e,qe=null;break}e:{var s=t,o=r.return,a=r,l=e;if(e=dt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=Xm(o);if(p!==null){p.flags&=-257,Ym(p,o,a,s,e),p.mode&1&&Wm(s,c,e),e=p,l=c;var g=e.updateQueue;if(g===null){var v=new Set;v.add(l),e.updateQueue=v}else g.add(l);break e}else{if(!(e&1)){Wm(s,c,e),xp();break e}l=Error(U(426))}}else if(Fe&&a.mode&1){var _=Xm(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Ym(_,o,a,s,e),Zf(Ls(l,a));break e}}s=l=Ls(l,a),tt!==4&&(tt=2),Po===null?Po=[s]:Po.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=f0(s,l,e);Um(s,y);break e;case 1:a=l;var x=s.type,m=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Dn===null||!Dn.has(m)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=p0(s,a,e);Um(s,w);break e}}s=s.return}while(s!==null)}B0(r)}catch(b){e=b,qe===r&&r!==null&&(qe=r=r.return);continue}break}while(!0)}function k0(){var t=Jl.current;return Jl.current=Zl,t===null?Zl:t}function xp(){(tt===0||tt===3||tt===2)&&(tt=4),at===null||!(Si&268435455)&&!(Lc&268435455)||En(at,dt)}function rc(t,e){var r=we;we|=2;var n=k0();(at!==t||dt!==e)&&($r=null,pi(t,e));do try{fb();break}catch(i){I0(t,i)}while(!0);if(ep(),we=r,Jl.current=n,qe!==null)throw Error(U(261));return at=null,dt=0,tt}function fb(){for(;qe!==null;)M0(qe)}function pb(){for(;qe!==null&&!Ow();)M0(qe)}function M0(t){var e=L0(t.alternate,t,jt);t.memoizedProps=t.pendingProps,e===null?B0(t):qe=e,fp.current=null}function B0(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=ab(r,e),r!==null){r.flags&=32767,qe=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tt=6,qe=null;return}}else if(r=ob(r,e,jt),r!==null){qe=r;return}if(e=e.sibling,e!==null){qe=e;return}qe=e=t}while(e!==null);tt===0&&(tt=5)}function ri(t,e,r){var n=Ae,i=er.transition;try{er.transition=null,Ae=1,mb(t,e,r,n)}finally{er.transition=i,Ae=n}return null}function mb(t,e,r,n){do ws();while(Cn!==null);if(we&6)throw Error(U(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Kw(t,s),t===at&&(qe=at=null,dt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Fa||(Fa=!0,F0(Dl,function(){return ws(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=er.transition,er.transition=null;var o=Ae;Ae=1;var a=we;we|=4,fp.current=null,cb(t,r),C0(r,t),LS(id),Ol=!!nd,id=nd=null,t.current=r,ub(r),Uw(),we=a,Ae=o,er.transition=s}else t.current=r;if(Fa&&(Fa=!1,Cn=t,tc=i),s=t.pendingLanes,s===0&&(Dn=null),Hw(r.stateNode),Bt(t,Xe()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(ec)throw ec=!1,t=Ed,Ed=null,t;return tc&1&&t.tag!==0&&ws(),s=t.pendingLanes,s&1?t===Td?Io++:(Io=0,Td=t):Io=0,Kn(),null}function ws(){if(Cn!==null){var t=fv(tc),e=er.transition,r=Ae;try{if(er.transition=null,Ae=16>t?16:t,Cn===null)var n=!1;else{if(t=Cn,Cn=null,tc=0,we&6)throw Error(U(331));var i=we;for(we|=4,Y=t.current;Y!==null;){var s=Y,o=s.child;if(Y.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Y=c;Y!==null;){var h=Y;switch(h.tag){case 0:case 11:case 15:Ro(8,h,s)}var d=h.child;if(d!==null)d.return=h,Y=d;else for(;Y!==null;){h=Y;var f=h.sibling,p=h.return;if(E0(h),h===c){Y=null;break}if(f!==null){f.return=p,Y=f;break}Y=p}}}var g=s.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}Y=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Y=o;else e:for(;Y!==null;){if(s=Y,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ro(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,Y=y;break e}Y=s.return}}var x=t.current;for(Y=x;Y!==null;){o=Y;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,Y=m;else e:for(o=x;Y!==null;){if(a=Y,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Nc(9,a)}}catch(b){Ve(a,a.return,b)}if(a===o){Y=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,Y=w;break e}Y=a.return}}if(we=i,Kn(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Ac,t)}catch{}n=!0}return n}finally{Ae=r,er.transition=e}}return!1}function ag(t,e,r){e=Ls(r,e),e=f0(t,e,1),t=Fn(t,e,1),e=St(),t!==null&&(aa(t,1,e),Bt(t,e))}function Ve(t,e,r){if(t.tag===3)ag(t,t,r);else for(;e!==null;){if(e.tag===3){ag(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Dn===null||!Dn.has(n))){t=Ls(r,t),t=p0(e,t,1),e=Fn(e,t,1),t=St(),e!==null&&(aa(e,1,t),Bt(e,t));break}}e=e.return}}function gb(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=St(),t.pingedLanes|=t.suspendedLanes&r,at===t&&(dt&r)===r&&(tt===4||tt===3&&(dt&130023424)===dt&&500>Xe()-mp?pi(t,0):pp|=r),Bt(t,e)}function N0(t,e){e===0&&(t.mode&1?(e=Aa,Aa<<=1,!(Aa&130023424)&&(Aa=4194304)):e=1);var r=St();t=nn(t,e),t!==null&&(aa(t,e,r),Bt(t,r))}function yb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),N0(t,r)}function xb(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(U(314))}n!==null&&n.delete(e),N0(t,r)}var L0;L0=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||kt.current)Rt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Rt=!1,sb(t,e,r);Rt=!!(t.flags&131072)}else Rt=!1,Fe&&e.flags&1048576&&Ov(e,Wl,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;xl(t,e),t=e.pendingProps;var i=ks(e,vt.current);_s(e,r),i=lp(null,e,n,t,i,r);var s=cp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Mt(n)?(s=!0,$l(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,np(e),i.updater=Bc,e.stateNode=i,i._reactInternals=e,fd(e,n,t,r),e=gd(null,e,n,!0,s,r)):(e.tag=0,Fe&&s&&qf(e),_t(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(xl(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=_b(n),t=ur(n,t),i){case 0:e=md(null,e,n,t,r);break e;case 1:e=Qm(null,e,n,t,r);break e;case 11:e=Km(null,e,n,t,r);break e;case 14:e=qm(null,e,n,ur(n.type,t),r);break e}throw Error(U(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ur(n,i),md(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ur(n,i),Qm(t,e,n,i,r);case 3:e:{if(x0(e),t===null)throw Error(U(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Vv(t,e),Kl(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ls(Error(U(423)),e),e=Zm(t,e,n,r,i);break e}else if(n!==i){i=Ls(Error(U(424)),e),e=Zm(t,e,n,r,i);break e}else for(Ot=Ln(e.stateNode.containerInfo.firstChild),zt=e,Fe=!0,dr=null,r=Hv(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ms(),n===i){e=sn(t,e,r);break e}_t(t,e,n,r)}e=e.child}return e;case 5:return Wv(e),t===null&&ud(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,sd(n,i)?o=null:s!==null&&sd(n,s)&&(e.flags|=32),y0(t,e),_t(t,e,o,r),e.child;case 6:return t===null&&ud(e),null;case 13:return v0(t,e,r);case 4:return ip(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Bs(e,null,n,r):_t(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ur(n,i),Km(t,e,n,i,r);case 7:return _t(t,e,e.pendingProps,r),e.child;case 8:return _t(t,e,e.pendingProps.children,r),e.child;case 12:return _t(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ie(Xl,n._currentValue),n._currentValue=o,s!==null)if(xr(s.value,o)){if(s.children===i.children&&!kt.current){e=sn(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Jr(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),hd(s.return,r,e),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(U(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),hd(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}_t(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,_s(e,r),i=tr(i),n=n(i),e.flags|=1,_t(t,e,n,r),e.child;case 14:return n=e.type,i=ur(n,e.pendingProps),i=ur(n.type,i),qm(t,e,n,i,r);case 15:return m0(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ur(n,i),xl(t,e),e.tag=1,Mt(n)?(t=!0,$l(e)):t=!1,_s(e,r),d0(e,n,i),fd(e,n,i,r),gd(null,e,n,!0,t,r);case 19:return _0(t,e,r);case 22:return g0(t,e,r)}throw Error(U(156,e.tag))};function F0(t,e){return cv(t,e)}function vb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(t,e,r,n){return new vb(t,e,r,n)}function vp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _b(t){if(typeof t=="function")return vp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===jf)return 11;if(t===Of)return 14}return 2}function On(t,e){var r=t.alternate;return r===null?(r=Qt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function wl(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")vp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ns:return mi(r.children,i,s,e);case Df:o=8,i|=8;break;case Dh:return t=Qt(12,r,e,i|2),t.elementType=Dh,t.lanes=s,t;case jh:return t=Qt(13,r,e,i),t.elementType=jh,t.lanes=s,t;case Oh:return t=Qt(19,r,e,i),t.elementType=Oh,t.lanes=s,t;case Wx:return Fc(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $x:o=10;break e;case Vx:o=9;break e;case jf:o=11;break e;case Of:o=14;break e;case _n:o=16,n=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Qt(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function mi(t,e,r,n){return t=Qt(7,t,n,e),t.lanes=r,t}function Fc(t,e,r,n){return t=Qt(22,t,n,e),t.elementType=Wx,t.lanes=r,t.stateNode={isHidden:!1},t}function Bu(t,e,r){return t=Qt(6,t,null,e),t.lanes=r,t}function Nu(t,e,r){return e=Qt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function wb(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pu(0),this.expirationTimes=pu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pu(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function _p(t,e,r,n,i,s,o,a,l){return t=new wb(t,e,r,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Qt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},np(s),t}function Sb(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rs,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function D0(t){if(!t)return Hn;t=t._reactInternals;e:{if(Pi(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Mt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var r=t.type;if(Mt(r))return Dv(t,r,e)}return e}function j0(t,e,r,n,i,s,o,a,l){return t=_p(r,n,!0,t,i,s,o,a,l),t.context=D0(null),r=t.current,n=St(),i=jn(r),s=Jr(n,i),s.callback=e??null,Fn(r,s,i),t.current.lanes=i,aa(t,i,n),Bt(t,n),t}function Dc(t,e,r,n){var i=e.current,s=St(),o=jn(i);return r=D0(r),e.context===null?e.context=r:e.pendingContext=r,e=Jr(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Fn(i,e,o),t!==null&&(mr(t,i,o,s),ml(t,i,o)),o}function nc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function lg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function wp(t,e){lg(t,e),(t=t.alternate)&&lg(t,e)}function bb(){return null}var O0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Sp(t){this._internalRoot=t}jc.prototype.render=Sp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));Dc(t,e,null,null)};jc.prototype.unmount=Sp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;bi(function(){Dc(null,t,null,null)}),e[rn]=null}};function jc(t){this._internalRoot=t}jc.prototype.unstable_scheduleHydration=function(t){if(t){var e=gv();t={blockedOn:null,target:t,priority:e};for(var r=0;r<bn.length&&e!==0&&e<bn[r].priority;r++);bn.splice(r,0,t),r===0&&xv(t)}};function bp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Oc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function cg(){}function Eb(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=nc(o);s.call(c)}}var o=j0(e,n,t,0,null,!1,!1,"",cg);return t._reactRootContainer=o,t[rn]=o.current,$o(t.nodeType===8?t.parentNode:t),bi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var c=nc(l);a.call(c)}}var l=_p(t,0,!1,null,null,!1,!1,"",cg);return t._reactRootContainer=l,t[rn]=l.current,$o(t.nodeType===8?t.parentNode:t),bi(function(){Dc(e,l,r,n)}),l}function Uc(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=nc(o);a.call(l)}}Dc(e,o,t,i)}else o=Eb(r,e,t,i,n);return nc(o)}pv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=uo(e.pendingLanes);r!==0&&(zf(e,r|1),Bt(e,Xe()),!(we&6)&&(Fs=Xe()+500,Kn()))}break;case 13:bi(function(){var n=nn(t,1);if(n!==null){var i=St();mr(n,t,1,i)}}),wp(t,1)}};Hf=function(t){if(t.tag===13){var e=nn(t,134217728);if(e!==null){var r=St();mr(e,t,134217728,r)}wp(t,134217728)}};mv=function(t){if(t.tag===13){var e=jn(t),r=nn(t,e);if(r!==null){var n=St();mr(r,t,e,n)}wp(t,e)}};gv=function(){return Ae};yv=function(t,e){var r=Ae;try{return Ae=t,e()}finally{Ae=r}};Kh=function(t,e,r){switch(e){case"input":if(zh(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Ic(n);if(!i)throw Error(U(90));Yx(n),zh(n,i)}}}break;case"textarea":qx(t,r);break;case"select":e=r.value,e!=null&&gs(t,!!r.multiple,e,!1)}};nv=gp;iv=bi;var Tb={usingClientEntryPoint:!1,Events:[ca,as,Ic,tv,rv,gp]},ro={findFiberByHostInstance:hi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ab={bundleType:ro.bundleType,version:ro.version,rendererPackageName:ro.rendererPackageName,rendererConfig:ro.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ln.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=av(t),t===null?null:t.stateNode},findFiberByHostInstance:ro.findFiberByHostInstance||bb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Da=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Da.isDisabled&&Da.supportsFiber)try{Ac=Da.inject(Ab),Nr=Da}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tb;$t.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bp(e))throw Error(U(200));return Sb(t,e,null,r)};$t.createRoot=function(t,e){if(!bp(t))throw Error(U(299));var r=!1,n="",i=O0;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=_p(t,1,!1,null,null,r,!1,n,i),t[rn]=e.current,$o(t.nodeType===8?t.parentNode:t),new Sp(e)};$t.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=av(e),t=t===null?null:t.stateNode,t};$t.flushSync=function(t){return bi(t)};$t.hydrate=function(t,e,r){if(!Oc(e))throw Error(U(200));return Uc(null,t,e,!0,r)};$t.hydrateRoot=function(t,e,r){if(!bp(t))throw Error(U(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=O0;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=j0(e,null,t,1,r??null,i,!1,s,o),t[rn]=e.current,$o(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new jc(e)};$t.render=function(t,e,r){if(!Oc(e))throw Error(U(200));return Uc(null,t,e,!1,r)};$t.unmountComponentAtNode=function(t){if(!Oc(t))throw Error(U(40));return t._reactRootContainer?(bi(function(){Uc(null,null,t,!1,function(){t._reactRootContainer=null,t[rn]=null})}),!0):!1};$t.unstable_batchedUpdates=gp;$t.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Oc(r))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return Uc(t,e,r,!1,n)};$t.version="18.3.1-next-f1338f8080-20240426";function U0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(U0)}catch(t){console.error(t)}}U0(),Ux.exports=$t;var Cb=Ux.exports,ug=Cb;Lh.createRoot=ug.createRoot,Lh.hydrateRoot=ug.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jo(){return Jo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jo.apply(this,arguments)}var Rn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Rn||(Rn={}));const hg="popstate";function Rb(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return Rd("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:ic(i)}return Ib(e,r,null,t)}function Qe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ep(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Pb(){return Math.random().toString(36).substr(2,8)}function dg(t,e){return{usr:t.state,key:t.key,idx:e}}function Rd(t,e,r,n){return r===void 0&&(r=null),Jo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Hs(e):e,{state:r,key:e&&e.key||n||Pb()})}function ic(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Hs(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function Ib(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=Rn.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(Jo({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function d(){a=Rn.Pop;let _=h(),y=_==null?null:_-c;c=_,l&&l({action:a,location:v.location,delta:y})}function f(_,y){a=Rn.Push;let x=Rd(v.location,_,y);c=h()+1;let m=dg(x,c),w=v.createHref(x);try{o.pushState(m,"",w)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;i.location.assign(w)}s&&l&&l({action:a,location:v.location,delta:1})}function p(_,y){a=Rn.Replace;let x=Rd(v.location,_,y);c=h();let m=dg(x,c),w=v.createHref(x);o.replaceState(m,"",w),s&&l&&l({action:a,location:v.location,delta:0})}function g(_){let y=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof _=="string"?_:ic(_);return x=x.replace(/ $/,"%20"),Qe(y,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,y)}let v={get action(){return a},get location(){return t(i,o)},listen(_){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(hg,d),l=_,()=>{i.removeEventListener(hg,d),l=null}},createHref(_){return e(i,_)},createURL:g,encodeLocation(_){let y=g(_);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:p,go(_){return o.go(_)}};return v}var fg;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(fg||(fg={}));function kb(t,e,r){return r===void 0&&(r="/"),Mb(t,e,r)}function Mb(t,e,r,n){let i=typeof e=="string"?Hs(e):e,s=Tp(i.pathname||"/",r);if(s==null)return null;let o=G0(t);Bb(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=Vb(s);a=zb(o[l],c)}return a}function G0(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Qe(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Un([n,l.relativePath]),h=r.concat(l);s.children&&s.children.length>0&&(Qe(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),G0(s.children,e,h,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:Ub(c,s.index),routesMeta:h})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of z0(s.path))i(s,o,l)}),e}function z0(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=z0(n.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function Bb(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Gb(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Nb=/^:[\w-]+$/,Lb=3,Fb=2,Db=1,jb=10,Ob=-2,pg=t=>t==="*";function Ub(t,e){let r=t.split("/"),n=r.length;return r.some(pg)&&(n+=Ob),e&&(n+=Fb),r.filter(i=>!pg(i)).reduce((i,s)=>i+(Nb.test(s)?Lb:s===""?Db:jb),n)}function Gb(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function zb(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,h=s==="/"?e:e.slice(s.length)||"/",d=Hb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),f=l.route;if(!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:Un([s,d.pathname]),pathnameBase:qb(Un([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=Un([s,d.pathnameBase]))}return o}function Hb(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=$b(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((c,h,d)=>{let{paramName:f,isOptional:p}=h;if(f==="*"){let v=a[d]||"";o=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const g=a[d];return p&&!g?c[f]=void 0:c[f]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:t}}function $b(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Ep(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function Vb(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ep(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Tp(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const Wb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xb=t=>Wb.test(t);function Yb(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Hs(t):t,s;if(r)if(Xb(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Ep(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=mg(r.substring(1),"/"):s=mg(r,e)}else s=e;return{pathname:s,search:Qb(n),hash:Zb(i)}}function mg(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Lu(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Kb(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function H0(t,e){let r=Kb(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function $0(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Hs(t):(i=Jo({},t),Qe(!i.pathname||!i.pathname.includes("?"),Lu("?","pathname","search",i)),Qe(!i.pathname||!i.pathname.includes("#"),Lu("#","pathname","hash",i)),Qe(!i.search||!i.search.includes("#"),Lu("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let d=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=Yb(i,a),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}const Un=t=>t.join("/").replace(/\/\/+/g,"/"),qb=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Qb=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Zb=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Jb(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const V0=["post","put","patch","delete"];new Set(V0);const eE=["get",...V0];new Set(eE);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ea(){return ea=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ea.apply(this,arguments)}const Ap=E.createContext(null),tE=E.createContext(null),Ii=E.createContext(null),Gc=E.createContext(null),ki=E.createContext({outlet:null,matches:[],isDataRoute:!1}),W0=E.createContext(null);function rE(t,e){let{relative:r}=e===void 0?{}:e;ha()||Qe(!1);let{basename:n,navigator:i}=E.useContext(Ii),{hash:s,pathname:o,search:a}=Y0(t,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:Un([n,o])),i.createHref({pathname:l,search:a,hash:s})}function ha(){return E.useContext(Gc)!=null}function $s(){return ha()||Qe(!1),E.useContext(Gc).location}function X0(t){E.useContext(Ii).static||E.useLayoutEffect(t)}function Wt(){let{isDataRoute:t}=E.useContext(ki);return t?mE():nE()}function nE(){ha()||Qe(!1);let t=E.useContext(Ap),{basename:e,future:r,navigator:n}=E.useContext(Ii),{matches:i}=E.useContext(ki),{pathname:s}=$s(),o=JSON.stringify(H0(i,r.v7_relativeSplatPath)),a=E.useRef(!1);return X0(()=>{a.current=!0}),E.useCallback(function(c,h){if(h===void 0&&(h={}),!a.current)return;if(typeof c=="number"){n.go(c);return}let d=$0(c,JSON.parse(o),s,h.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Un([e,d.pathname])),(h.replace?n.replace:n.push)(d,h.state,h)},[e,n,o,s,t])}function Y0(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=E.useContext(Ii),{matches:i}=E.useContext(ki),{pathname:s}=$s(),o=JSON.stringify(H0(i,n.v7_relativeSplatPath));return E.useMemo(()=>$0(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function iE(t,e){return sE(t,e)}function sE(t,e,r,n){ha()||Qe(!1);let{navigator:i}=E.useContext(Ii),{matches:s}=E.useContext(ki),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=$s(),h;if(e){var d;let _=typeof e=="string"?Hs(e):e;l==="/"||(d=_.pathname)!=null&&d.startsWith(l)||Qe(!1),h=_}else h=c;let f=h.pathname||"/",p=f;if(l!=="/"){let _=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(_.length).join("/")}let g=kb(t,{pathname:p}),v=uE(g&&g.map(_=>Object.assign({},_,{params:Object.assign({},a,_.params),pathname:Un([l,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?l:Un([l,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,r,n);return e&&v?E.createElement(Gc.Provider,{value:{location:ea({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Rn.Pop}},v):v}function oE(){let t=pE(),e=Jb(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),r?E.createElement("pre",{style:i},r):null,null)}const aE=E.createElement(oE,null);class lE extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?E.createElement(ki.Provider,{value:this.props.routeContext},E.createElement(W0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cE(t){let{routeContext:e,match:r,children:n}=t,i=E.useContext(Ap);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),E.createElement(ki.Provider,{value:e},n)}function uE(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let h=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);h>=0||Qe(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<o.length;h++){let d=o[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=h),d.route.id){let{loaderData:f,errors:p}=r,g=d.route.loader&&f[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||g){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((h,d,f)=>{let p,g=!1,v=null,_=null;r&&(p=a&&d.route.id?a[d.route.id]:void 0,v=d.route.errorElement||aE,l&&(c<0&&f===0?(gE("route-fallback"),g=!0,_=null):c===f&&(g=!0,_=d.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,f+1)),x=()=>{let m;return p?m=v:g?m=_:d.route.Component?m=E.createElement(d.route.Component,null):d.route.element?m=d.route.element:m=h,E.createElement(cE,{match:d,routeContext:{outlet:h,matches:y,isDataRoute:r!=null},children:m})};return r&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?E.createElement(lE,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}var K0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(K0||{}),q0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(q0||{});function hE(t){let e=E.useContext(Ap);return e||Qe(!1),e}function dE(t){let e=E.useContext(tE);return e||Qe(!1),e}function fE(t){let e=E.useContext(ki);return e||Qe(!1),e}function Q0(t){let e=fE(),r=e.matches[e.matches.length-1];return r.route.id||Qe(!1),r.route.id}function pE(){var t;let e=E.useContext(W0),r=dE(),n=Q0();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function mE(){let{router:t}=hE(K0.UseNavigateStable),e=Q0(q0.UseNavigateStable),r=E.useRef(!1);return X0(()=>{r.current=!0}),E.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,ea({fromRouteId:e},s)))},[t,e])}const gg={};function gE(t,e,r){gg[t]||(gg[t]=!0)}function yE(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Xt(t){Qe(!1)}function xE(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Rn.Pop,navigator:s,static:o=!1,future:a}=t;ha()&&Qe(!1);let l=e.replace(/^\/*/,"/"),c=E.useMemo(()=>({basename:l,navigator:s,static:o,future:ea({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof n=="string"&&(n=Hs(n));let{pathname:h="/",search:d="",hash:f="",state:p=null,key:g="default"}=n,v=E.useMemo(()=>{let _=Tp(h,l);return _==null?null:{location:{pathname:_,search:d,hash:f,state:p,key:g},navigationType:i}},[l,h,d,f,p,g,i]);return v==null?null:E.createElement(Ii.Provider,{value:c},E.createElement(Gc.Provider,{children:r,value:v}))}function vE(t){let{children:e,location:r}=t;return iE(Pd(e),r)}new Promise(()=>{});function Pd(t,e){e===void 0&&(e=[]);let r=[];return E.Children.forEach(t,(n,i)=>{if(!E.isValidElement(n))return;let s=[...e,i];if(n.type===E.Fragment){r.push.apply(r,Pd(n.props.children,s));return}n.type!==Xt&&Qe(!1),!n.props.index||!n.props.children||Qe(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Pd(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Id(){return Id=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Id.apply(this,arguments)}function _E(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function wE(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function SE(t,e){return t.button===0&&(!e||e==="_self")&&!wE(t)}function kd(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function bE(t,e){let r=kd(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(s=>{r.append(i,s)})}),r}const EE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],TE="6";try{window.__reactRouterVersion=TE}catch{}const AE="startTransition",yg=gw[AE];function CE(t){let{basename:e,children:r,future:n,window:i}=t,s=E.useRef();s.current==null&&(s.current=Rb({window:i,v5Compat:!0}));let o=s.current,[a,l]=E.useState({action:o.action,location:o.location}),{v7_startTransition:c}=n||{},h=E.useCallback(d=>{c&&yg?yg(()=>l(d)):l(d)},[l,c]);return E.useLayoutEffect(()=>o.listen(h),[o,h]),E.useEffect(()=>yE(n),[n]),E.createElement(xE,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const RE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",PE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IE=E.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:h,viewTransition:d}=e,f=_E(e,EE),{basename:p}=E.useContext(Ii),g,v=!1;if(typeof c=="string"&&PE.test(c)&&(g=c,RE))try{let m=new URL(window.location.href),w=c.startsWith("//")?new URL(m.protocol+c):new URL(c),b=Tp(w.pathname,p);w.origin===m.origin&&b!=null?c=b+w.search+w.hash:v=!0}catch{}let _=rE(c,{relative:i}),y=kE(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,viewTransition:d});function x(m){n&&n(m),m.defaultPrevented||y(m)}return E.createElement("a",Id({},f,{href:g||_,onClick:v||s?n:x,ref:r,target:l}))});var xg;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(xg||(xg={}));var vg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(vg||(vg={}));function kE(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=Wt(),c=$s(),h=Y0(t,{relative:o});return E.useCallback(d=>{if(SE(d,r)){d.preventDefault();let f=n!==void 0?n:ic(c)===ic(h);l(t,{replace:f,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[c,l,h,n,i,r,t,s,o,a])}function Cp(t){let e=E.useRef(kd(t)),r=E.useRef(!1),n=$s(),i=E.useMemo(()=>bE(n.search,r.current?null:e.current),[n.search]),s=Wt(),o=E.useCallback((a,l)=>{const c=kd(typeof a=="function"?a(i):a);r.current=!0,s("?"+c,l)},[s,i]);return[i,o]}function ME(){const t=Wt(),[e,r]=E.useState(0),[n,i]=E.useState(!1),s=E.useRef(null),o=80;return E.useEffect(()=>{const a=s.current;if(!a)return;let l=0,c=0,h=!1;const d=g=>{a.scrollTop===0&&(l=g.touches[0].clientY,h=!0,console.log("Pull-to-refresh: Touch started"))},f=g=>{if(!h)return;c=g.touches[0].clientY;const v=c-l;if(v>0){g.preventDefault();const _=Math.pow(v,.85);r(Math.min(_,o*1.5)),console.log("Pull distance:",Math.min(_,o*1.5).toFixed(0))}},p=()=>{e>o?(i(!0),r(0),setTimeout(()=>{window.location.reload()},400)):r(0),h=!1};return a.addEventListener("touchstart",d,{passive:!0}),a.addEventListener("touchmove",f,{passive:!1}),a.addEventListener("touchend",p),()=>{a.removeEventListener("touchstart",d),a.removeEventListener("touchmove",f),a.removeEventListener("touchend",p)}},[e]),u.jsxs("div",{ref:s,className:"screen screen-center",style:{position:"relative",overflow:"auto"},children:[u.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:`${e}px`,display:"flex",alignItems:"flex-end",justifyContent:"center",paddingBottom:"8px",opacity:Math.min(e/o,1),transition:e===0?"all 0.3s ease":"none",pointerEvents:"none",zIndex:10},children:n?u.jsx("div",{style:{width:"24px",height:"24px",border:"3px solid var(--color-surface)",borderTop:"3px solid var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}):u.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",fontWeight:600},children:e>o?" Release to refresh":" Pull to refresh"})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",zIndex:1,transform:`translateY(${e}px)`,transition:e===0?"transform 0.3s ease":"none",paddingBottom:"120px"},children:[u.jsx("img",{src:"/data/icons/OwlHeadphones.png",alt:"ChipNotes Owl Professor",style:{width:"180px",height:"180px",borderRadius:"50%",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",marginBottom:"4px"}}),u.jsx("h1",{style:{margin:0,fontSize:"44px",fontWeight:800,letterSpacing:"-1px",background:"linear-gradient(135deg, #FFD54F 0%, #FF8A65 50%, #E57373 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"ChipNotes!"}),u.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"16px",maxWidth:"280px",textAlign:"center",lineHeight:1.4,marginTop:"4px",fontWeight:600},children:"Train your ear. Know the birds."}),u.jsx("button",{onClick:()=>t("/pack-select"),style:{marginTop:"16px",padding:"18px 64px",fontSize:"20px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"16px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.4)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:a=>{a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow="0 6px 20px rgba(45, 90, 39, 0.5)"},onMouseLeave:a=>{a.currentTarget.style.transform="translateY(0)",a.currentTarget.style.boxShadow="0 4px 16px rgba(45, 90, 39, 0.4)"},children:"Play"}),u.jsx("div",{style:{marginTop:"20px",padding:"16px",background:"var(--color-surface)",borderRadius:"16px",maxWidth:"360px"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px"},children:[u.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[u.jsx("div",{style:{width:"72px",height:"52px",background:"linear-gradient(180deg, #1a1a2e 0%, #0d1520 100%)",borderRadius:"10px",padding:"6px",display:"flex",alignItems:"flex-end",justifyContent:"center",gap:"2px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.3)"},children:u.jsx(BE,{})}),u.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Hear"})]}),u.jsx("div",{style:{color:"var(--color-accent)",fontSize:"24px",marginTop:"-16px"},children:""}),u.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"4px"},children:["NOCA","BLJA","TUTI","CAWR"].map((a,l)=>u.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",overflow:"hidden",border:l===0?"2px solid var(--color-accent)":"2px solid transparent",boxShadow:l===0?"0 0 8px rgba(255, 152, 0, 0.4)":"none"},children:u.jsx("img",{src:`/data/icons/${a}.png`,alt:a,style:{width:"100%",height:"100%",objectFit:"cover"}})},a))}),u.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Match"})]}),u.jsx("div",{style:{color:"var(--color-accent)",fontSize:"24px",marginTop:"-16px"},children:""}),u.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[u.jsx("div",{style:{width:"72px",height:"52px",background:"#2a2a3e",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.4)"},children:u.jsx("div",{style:{fontSize:"32px"},children:""})}),u.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Train"})]})]})})]}),u.jsxs("div",{style:{position:"absolute",bottom:"70px",left:0,right:0,display:"flex",justifyContent:"center",gap:"40px",zIndex:1e3},children:[u.jsx("button",{className:"btn-icon",onClick:()=>t("/help"),"aria-label":"How to Play",children:u.jsx(NE,{})}),u.jsx("button",{className:"btn-icon",onClick:()=>t("/settings"),"aria-label":"Settings",children:u.jsx(LE,{})}),u.jsx("button",{className:"btn-icon",onClick:()=>t("/progress"),"aria-label":"Progress",children:u.jsx(FE,{})})]}),u.jsx("button",{onClick:()=>t("/help",{state:{openVersionHistory:!0}}),style:{position:"absolute",bottom:"calc(4px + var(--safe-area-bottom, 0px))",left:0,right:0,textAlign:"center",fontSize:"11px",color:"var(--color-text-muted)",opacity:.6,background:"none",border:"none",cursor:"pointer",padding:"4px",transition:"opacity 0.2s",zIndex:1001},onMouseEnter:a=>a.currentTarget.style.opacity="1",onMouseLeave:a=>a.currentTarget.style.opacity="0.6","aria-label":"View version history",children:"v3.26"})]})}function BE(){const t=[8,16,24,32,26,34,28,36,20,12,26,32];return u.jsx("svg",{width:"76",height:"40",viewBox:"0 0 76 40",children:t.map((e,r)=>u.jsx("rect",{x:r*6+2,y:40-e,width:"4",height:e,rx:"1.5",fill:`hsl(${30+r*8}, 80%, ${50+r*2}%)`,opacity:.8+r*.015},r))})}function NE(){return u.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),u.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}function LE(){return u.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"3"}),u.jsx("path",{d:"M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"})]})}function FE(){return u.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 3v18h18"}),u.jsx("path",{d:"M7 16l4-4 4 4 6-6"})]})}function da(t,e){typeof window.gtag=="function"&&window.gtag("event",t,e)}function DE(t,e){da("pack_select",{pack_id:t,pack_name:e})}function jE(t,e,r){da("game_start",{pack_id:t,level_id:e,species_count:r})}function OE(t,e,r,n,i){da("round_complete",{pack_id:t,level_id:e,score:r,accuracy:n,duration_sec:i})}function UE(t){da("training_mode_toggle",{enabled:t})}function GE(t,e,r){da("level_select",{pack_id:t,level_id:e,level_title:r})}const Fu=[{id:"starter_birds",name:"Eastern Backyard Birds",speciesCount:5,isUnlocked:!0,description:"Start here! Distinctive, bold, recognizable voices."},{id:"expanded_backyard",name:"Expanded Eastern Birds",speciesCount:39,isUnlocked:!0,description:"Ready for more? 9 random per round."},{id:"sparrows",name:"Sparrows",speciesCount:8,isUnlocked:!0,description:"Master their subtle songs."},{id:"woodpeckers",name:"Woodpeckers",speciesCount:7,isUnlocked:!0,description:"Drums, calls, and rattles."},{id:"western_birds",name:"Western Backyard Birds",speciesCount:14,isUnlocked:!0,description:"Pacific coast to the Rockies."},{id:"spring_warblers",name:"Warbler Academy",speciesCount:33,isUnlocked:!0,description:"9 random per round. Custom Pack mode recommended!"}];function zE(){const t=Wt(),[e,r]=E.useState([]),[n,i]=E.useState({}),[s,o]=E.useState({}),[a,l]=E.useState(null),[c,h]=E.useState(null),[d,f]=E.useState(new Set),[p,g]=E.useState(!1),[v,_]=E.useState(!1),y=E.useRef(null);E.useEffect(()=>{fetch("/data/clips.json").then(b=>b.json()).then(b=>{r(b);const T=Array.from(new Set(b.filter(A=>!A.rejected&&(!A.spectrogram_path||!A.spectrogram_path.includes("spectrograms-rejected"))).map(A=>A.species_code))).sort();o(A=>({...A,all_birds:T}))}).catch(b=>console.error("Failed to load clips:",b))},[]),E.useEffect(()=>{const b=["starter_birds","expanded_backyard","sparrows","woodpeckers","spring_warblers","western_birds"];Promise.all(b.map(T=>fetch(`/data/packs/${T}.json`).then(A=>A.json()).catch(A=>(console.error(`Failed to load pack ${T}:`,A),null)))).then(T=>{const A={},S={};T.forEach((R,I)=>{R&&R.species&&(A[b[I]]=R.species,S[b[I]]=R.display_species||R.species)}),i(A),o(R=>({...R,...S}))})},[]);const x=b=>(s[b]||[]).map(A=>{const S=e.filter(B=>B.species_code===A&&!B.rejected&&(!B.spectrogram_path||!B.spectrogram_path.includes("spectrograms-rejected"))),I=S.find(B=>B.canonical)||S[0],L=S.sort((B,C)=>B.canonical&&!C.canonical?-1:!B.canonical&&C.canonical?1:B.clip_id.localeCompare(C.clip_id)).map(B=>({id:B.clip_id,path:`/data/clips/${B.file_path.split("/").pop()}`,isCanonical:!!B.canonical,vocalizationType:B.vocalization_type,source:B.source,sourceId:B.source_id,recordist:B.recordist}));return{code:A,name:(I==null?void 0:I.common_name)||A,canonicalClipPath:I?`/data/clips/${I.file_path.split("/").pop()}`:null,clipCount:S.length,allClips:L}}).sort((A,S)=>A.code.localeCompare(S.code)),m=b=>{b.isUnlocked&&(DE(b.id,b.name),t(`/level-select?pack=${b.id}`))},w=(b,T)=>{if(y.current&&(y.current.pause(),y.current=null),a===T){l(null);return}const A=new Audio(b);y.current=A,l(T),A.play().catch(S=>console.error("Failed to play audio:",S)),A.onended=()=>{l(null),y.current=null}};return E.useEffect(()=>()=>{y.current&&y.current.pause()},[]),u.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[u.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[u.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",children:u.jsx(HE,{})}),u.jsx("h2",{style:{margin:0},children:"Select a Bird Pack"})]}),u.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.6},children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[u.jsx("li",{children:"Each pack has 6 levels - from signature sounds to full repertoires. Start at level 1 and repeat when ready for a challenge."}),u.jsxs("li",{children:['Pro tip: Enable "training" mode () to kick-start your learning. See ',u.jsx(IE,{to:"/help",style:{color:"var(--color-accent)"},children:"How to Play"})," for full instructions"]}),u.jsx("li",{children:"Timer anxiety? Turn on Continuous Play in Settings for chill, timer-less practice sessions "}),u.jsx("li",{style:{fontWeight:600},children:"Phone ringer  ON (unmute) and  for best experience!"})]})}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"32px"},children:Fu.map(b=>{const T={starter_birds:"linear-gradient(135deg, #2d5a3d 0%, #1a3d2a 100%)",expanded_backyard:"linear-gradient(135deg, #3d5a6e 0%, #2a3d4a 100%)",sparrows:"linear-gradient(135deg, #6b5344 0%, #4a3a2e 100%)",woodpeckers:"linear-gradient(135deg, #6e3d3d 0%, #4a2a2a 100%)",spring_warblers:"linear-gradient(135deg, #7a6b2d 0%, #5a4a1a 100%)",western_birds:"linear-gradient(135deg, #5a4a7a 0%, #3a2a5a 100%)"},A={starter_birds:"NOCA",expanded_backyard:"AMGO",sparrows:"WTSP",woodpeckers:"PIWO",spring_warblers:"BLBW",western_birds:"STJA"};return u.jsxs("button",{onClick:()=>m(b),style:{position:"relative",overflow:"hidden",textAlign:"left",padding:"12px 12px 14px 12px",borderRadius:"16px",border:"none",background:T[b.id]||T.starter_birds,boxShadow:b.isUnlocked?"0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"none",opacity:b.isUnlocked?1:.5,cursor:b.isUnlocked?"pointer":"not-allowed",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:S=>{b.isUnlocked&&(S.currentTarget.style.transform="translateY(-2px)",S.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1)")},onMouseLeave:S=>{S.currentTarget.style.transform="translateY(0)",S.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[u.jsx("img",{src:`/data/icons/${A[b.id]}.png`,alt:"",style:{position:"absolute",right:"-10px",bottom:"-10px",width:"80px",height:"80px",opacity:.3,transform:"rotate(-15deg)",objectFit:"cover"}}),b.isUnlocked&&u.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:2},children:u.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#a8d5a2",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Play ",u.jsx($E,{})]})}),u.jsxs("div",{style:{position:"relative",zIndex:1},children:[u.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#f5f0e6",lineHeight:1.3,marginBottom:"6px",paddingRight:"50px"},children:b.name}),u.jsx("div",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.6)",lineHeight:1.4,marginBottom:"10px"},children:b.description}),u.jsx("div",{children:u.jsxs("span",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.7)",fontWeight:500},children:[b.speciesCount," species"]})})]})]},b.id)})}),u.jsxs("div",{onClick:()=>t("/custom-pack"),style:{marginBottom:"32px",background:"var(--color-surface)",border:"2px solid var(--color-accent)",borderRadius:"16px",padding:"20px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:b=>{b.currentTarget.style.background="rgba(45, 90, 39, 0.15)",b.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:b=>{b.currentTarget.style.background="var(--color-surface)",b.currentTarget.style.transform="translateY(0)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[u.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"var(--color-accent)",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:u.jsx(VE,{})}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)"},children:"Create Custom Pack"}),u.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:"Build your own training session"})]})]}),u.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6},children:[u.jsxs("div",{style:{marginBottom:"8px"},children:[u.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Got a nemesis bird? Queue it up and drill all its variations."]}),u.jsxs("div",{style:{marginBottom:v?"8px":"12px"},children:[u.jsx("span",{style:{color:"var(--color-accent)"},children:""})," A friend's eBird checklist has you jealous? Queue up their birds, and it will be like you were there."]}),v&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{marginBottom:"8px"},children:[u.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Constantly confuse Kinglets, Creepers and Waxwings? Put them head-to-head."]}),u.jsxs("div",{style:{marginBottom:"8px"},children:[u.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Warbler Wizard Wannabe? Training starts here!"]}),u.jsxs("div",{style:{marginBottom:"8px"},children:[u.jsx("span",{style:{color:"var(--color-accent)"},children:""})," You think you know your woodpeckers? Try the Pileated vs. Northern Flicker on Level 5."]}),u.jsxs("div",{style:{marginBottom:"12px"},children:[u.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Mix species from any pack  your rules, your practice."]})]}),u.jsx("button",{onClick:b=>{b.stopPropagation(),_(!v)},style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",cursor:"pointer",padding:"4px 0",textDecoration:"underline",display:"flex",alignItems:"center",gap:"4px"},children:v?" Show less":"More examples "})]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",marginTop:"24px",marginBottom:"16px",opacity:.5},children:[u.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",textAlign:"center"},children:"Browse all birds below"}),u.jsx("div",{style:{animation:"bounce 2s ease-in-out infinite"},children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-text-muted)",strokeWidth:"2",children:u.jsx("path",{d:"M12 5v14M5 12l7 7 7-7"})})})]}),u.jsxs("div",{style:{marginTop:"16px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[u.jsx("h3",{style:{fontSize:"16px",margin:0,color:"var(--color-text-muted)"},children:"Bird Reference"}),u.jsx("button",{onClick:()=>{if(p)f(new Set),g(!1);else{const b=Fu.filter(T=>T.isUnlocked).map(T=>T.id);f(new Set(b)),g(!0)}},style:{fontSize:"12px",padding:"6px 12px",background:p?"var(--color-accent)":"var(--color-surface)",color:p?"#000":"var(--color-text)",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:600},children:p?"Collapse All":"Expand All"})]}),u.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"20px",paddingLeft:"12px",borderLeft:"3px solid var(--color-accent)"},children:"Preview signature sounds for each bird before you play. Click pack names to expand and see all birds, or click individual birds to explore their full library of recordings."}),s.all_birds&&(()=>{var A;const b="all_birds",T=p||d.has(b);return u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsxs("div",{onClick:()=>{const S=new Set(d);S.has(b)?S.delete(b):S.add(b),f(S)},style:{fontSize:"14px",marginBottom:T?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:S=>S.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:S=>S.currentTarget.style.background="var(--color-surface)",children:[u.jsx("span",{style:{fontSize:"14px"},children:T?"":""}),u.jsx("span",{style:{fontWeight:600},children:"All Birds"}),u.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((A=s[b])==null?void 0:A.length)||0," species"]})]}),T&&u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:x(b).map(S=>{const R=c===S.code;return u.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:S.clipCount>1?"pointer":"default"},onClick:()=>{S.clipCount>1&&h(R?null:S.code)},children:[u.jsx(Sg,{code:S.code,size:36}),u.jsxs("div",{style:{minWidth:0,flex:1},children:[u.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:S.code}),u.jsx("div",{style:{fontSize:"13px",fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:S.name})]}),S.canonicalClipPath&&u.jsx("button",{onClick:I=>{I.stopPropagation(),w(S.canonicalClipPath,S.code)},style:{width:"32px",height:"32px",borderRadius:"50%",border:"none",background:a===S.code?"var(--color-accent)":"rgba(255,255,255,0.1)",color:a===S.code?"#000":"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px"},children:a===S.code?"":""}),S.clipCount>1&&u.jsx("span",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:R?"":""})]}),R&&S.allClips.length>0&&u.jsxs("div",{style:{padding:"0 12px 12px 12px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[u.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"8px",marginBottom:"8px",fontWeight:600},children:["All Recordings (",S.allClips.length,")"]}),S.allClips.map((I,L)=>u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",padding:"6px",background:"rgba(0,0,0,0.2)",borderRadius:"6px"},children:[u.jsx("button",{onClick:()=>w(I.path,`${S.code}_${L}`),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===`${S.code}_${L}`?"var(--color-accent)":"rgba(255,255,255,0.1)",color:a===`${S.code}_${L}`?"#000":"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",flexShrink:0},children:a===`${S.code}_${L}`?"":""}),u.jsx("div",{style:{flex:1,fontSize:"11px"},children:u.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",flexWrap:"wrap"},children:[I.isCanonical&&u.jsx("span",{style:{fontSize:"9px",background:"var(--color-accent)",color:"#000",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"SIGNATURE"}),u.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:I.vocalizationType==="song"?"rgba(76, 175, 80, 0.2)":"rgba(245, 166, 35, 0.2)",padding:"2px 6px",borderRadius:"4px",textTransform:"uppercase"},children:I.vocalizationType}),(I.source||I.recordist)&&u.jsxs("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:[I.source==="xenocanto"?"Xeno-canto":I.source==="cornell"?"Cornell":"user",I.recordist&&` - ${I.recordist}`]})]})})]},I.id))]})]},S.code)})})]},b)})(),Fu.filter(b=>b.isUnlocked).map(b=>{var A;const T=p||d.has(b.id);return u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsxs("div",{onClick:()=>{const S=new Set(d);S.has(b.id)?S.delete(b.id):S.add(b.id),f(S)},style:{fontSize:"14px",marginBottom:T?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:S=>S.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:S=>S.currentTarget.style.background="var(--color-surface)",children:[u.jsx("span",{style:{fontSize:"14px"},children:T?"":""}),u.jsx("span",{style:{fontWeight:600},children:b.name}),u.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((A=s[b.id])==null?void 0:A.length)||0," species"]})]}),T&&u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:x(b.id).map(S=>{const R=c===S.code;return u.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:S.clipCount>1?"pointer":"default"},onClick:()=>{S.clipCount>1&&h(R?null:S.code)},children:[u.jsx(Sg,{code:S.code,size:36}),u.jsxs("div",{style:{minWidth:0,flex:1},children:[u.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:S.code}),u.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:S.name}),u.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)"},children:[S.clipCount," clip",S.clipCount!==1?"s":"",S.clipCount>1&&u.jsx("span",{style:{marginLeft:"4px",color:"var(--color-accent)"},children:R?"":""})]})]}),u.jsx("button",{onClick:I=>{I.stopPropagation(),S.canonicalClipPath&&w(S.canonicalClipPath,S.code)},disabled:!S.canonicalClipPath,style:{width:"28px",height:"28px",borderRadius:"50%",border:"none",background:a===S.code?"var(--color-accent)":"var(--color-primary)",color:"white",cursor:S.canonicalClipPath?"pointer":"not-allowed",opacity:S.canonicalClipPath?1:.3,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play ${S.name}`,children:a===S.code?u.jsx(wg,{}):u.jsx(_g,{})})]}),R&&S.allClips.length>0&&u.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"8px 12px",background:"rgba(0,0,0,0.2)"},children:[u.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"8px"},children:["All ",S.clipCount," clips:"]}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:S.allClips.map((I,L)=>u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("button",{onClick:()=>w(I.path,I.id),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===I.id?"var(--color-accent)":"rgba(255,255,255,0.15)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play clip ${L+1}`,children:a===I.id?u.jsx(wg,{size:8}):u.jsx(_g,{size:8})}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px",flex:1},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[u.jsx("span",{style:{fontSize:"11px",color:"var(--color-text)"},children:I.sourceId||`Clip ${L+1}`}),I.isCanonical&&u.jsx("span",{style:{fontSize:"9px",color:"#000",background:"var(--color-accent)",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:" SIGNATURE"}),I.vocalizationType&&u.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px",textTransform:"capitalize"},children:I.vocalizationType}),I.source&&u.jsxs("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:[I.source==="xenocanto"?"Xeno-canto":I.source==="cornell"?"Cornell":"user",I.recordist&&` - ${I.recordist}`]})]})})]},I.id))})]})]},S.code)})})]},b.id)})]})]})}function HE(){return u.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),u.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function _g({size:t=14}){return u.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8 5v14l11-7z"})})}function wg({size:t=12}){return u.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function $E(){return u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:u.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}function VE(){return u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:u.jsx("path",{d:"M12 5v14M5 12h14"})})}function WE({size:t=80}){return u.jsx("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"currentColor",children:u.jsx("path",{d:"M85 35c-5-3-12-2-18 1-3-8-10-14-19-16 2-3 3-7 2-11-1-5-5-8-9-7s-7 5-6 10c0 2 1 4 2 5-10 3-18 11-21 21-8-1-16 2-21 8-2 2-1 5 1 6s5 0 7-2c3-4 8-5 13-4 0 12 7 23 18 28l-8 12c-2 2-1 5 1 7 2 1 5 1 6-2l10-14c3 1 6 1 9 1 4 0 7-1 10-2l10 14c2 2 5 3 7 1s2-5 0-7l-8-12c11-5 18-16 18-28 5-1 10 0 13 4 2 2 5 3 7 2s3-4 1-6c-5-6-13-9-21-8z"})})}function Sg({code:t,size:e=36}){const[r,n]=E.useState(!0),i=`/data/icons/${t}.png`;return r?u.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",flexShrink:0},onError:()=>n(!1)}):u.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-primary)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.4,flexShrink:0},children:u.jsx(WE,{size:e*.7})})}const XE={starter_birds:"Common Eastern US Backyard Birds",expanded_backyard:"Expanded Eastern US Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard Birds",custom:"Custom Pack"};function YE(t){return[{level_id:1,pack_id:"custom",mode:"campaign",title:"Meet Your Birds",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:2,pack_id:"custom",mode:"campaign",title:"Sound Variations",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:3,pack_id:"custom",mode:"campaign",title:"Full Repertoire",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:4,pack_id:"custom",mode:"campaign",title:"Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:5,pack_id:"custom",mode:"campaign",title:"Variations + Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:6,pack_id:"custom",mode:"campaign",title:"Master Birder",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"}]}function KE(t){const e=[];return t.clip_selection==="canonical"?e.push("Signature sounds only"):t.clip_selection==="all"?e.push("Full repertoire"):typeof t.clip_selection=="number"&&e.push(`${t.clip_selection} variations per bird`),t.channel_mode==="offset"?e.push("both ears"):e.push("one ear"),e.join("  ")}function qE(t){const e=t.level_id;return e<=2?{label:"Easy",color:"#4CAF50"}:e<=4?{label:"Medium",color:"#FFC107"}:{label:"Hard",color:"#FF5722"}}function QE(){const t=Wt(),[e]=Cp(),r=e.get("pack")||"starter_birds",[n,i]=E.useState([]),[s,o]=E.useState(!0);E.useEffect(()=>{if(r==="custom"){try{const c=localStorage.getItem("soundfield_custom_pack");if(c){const h=JSON.parse(c);if(Array.isArray(h)&&h.length>0){i(YE(h.length)),o(!1);return}}t("/custom-pack",{replace:!0})}catch(c){console.error("Failed to load custom pack:",c),t("/custom-pack",{replace:!0})}return}fetch("/data/levels.json").then(c=>c.json()).then(c=>{const h=c.filter(d=>d.pack_id===r);i(h.sort((d,f)=>d.level_id-f.level_id)),o(!1)}).catch(c=>{console.error("Failed to load levels:",c),o(!1)})},[r,t]);const a=c=>{GE(r,c.level_id,c.title||`Level ${c.level_id}`),t(`/preview?pack=${r}&level=${c.level_id}`)},l=XE[r]||r;return u.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[u.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"8px"},children:[u.jsx("button",{className:"btn-icon",onClick:()=>t(r==="custom"?"/custom-pack":"/pack-select"),"aria-label":"Back",children:u.jsx(ZE,{})}),u.jsxs("div",{children:[u.jsx("h2",{style:{margin:0,fontSize:"20px"},children:l}),u.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:"Select a level"})]})]}),s?u.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--color-text-muted)"},children:"Loading levels..."}):u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:n.map(c=>{const h=qE(c);return u.jsxs("button",{onClick:()=>a(c),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"var(--color-surface)",border:"none",borderRadius:"12px",cursor:"pointer",textAlign:"left",transition:"transform 0.15s, background 0.15s"},onMouseEnter:d=>{d.currentTarget.style.transform="translateX(4px)",d.currentTarget.style.background="rgba(45, 45, 68, 1)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateX(0)",d.currentTarget.style.background="var(--color-surface)"},children:[u.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:`linear-gradient(135deg, ${h.color}33, ${h.color}11)`,border:`2px solid ${h.color}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"20px",color:h.color,flexShrink:0},children:c.level_id}),u.jsxs("div",{style:{flex:1,minWidth:0},children:[u.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:c.title}),u.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:KE(c)})]}),u.jsx("div",{style:{color:"var(--color-text-muted)",flexShrink:0},children:u.jsx(JE,{})})]},c.level_id)})}),u.jsx("div",{style:{marginTop:"24px",padding:"12px 16px",background:"rgba(245, 166, 35, 0.1)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:u.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:[u.jsx("strong",{style:{color:"var(--color-accent)"},children:"Tip:"})," Start with Level 1 to learn each bird's signature sound, then progress to variations and both-ear challenges."]})})]})}function ZE(){return u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}function JE(){return u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M9 18l6-6-6-6"})})}const ja=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"],eT={starter_birds:"5 Common Eastern US Backyard Birds",expanded_backyard:"Expanded Eastern US Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard Birds",custom:"Custom Pack"},tT={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function rT(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function nT(t){return t>=4?"offset":"single"}function iT({code:t,size:e=56,color:r}){const[n,i]=E.useState(!0),s=`/data/icons/${t}.png`;return u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",WebkitTapHighlightColor:"transparent"},children:[n&&u.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?u.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",WebkitTapHighlightColor:"transparent"},onError:()=>i(!1)}):u.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"var(--color-surface)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.25,fontWeight:700,color:"#1A1A2E"},children:t})]})}function sT(){const t=Wt(),[e]=Cp(),r=e.get("pack")||"starter_birds",n=parseInt(e.get("level")||"1",10),i=e.get("keepBirds")==="true",[s,o]=E.useState(null),[a,l]=E.useState([]),[c,h]=E.useState([]),[d,f]=E.useState(null),[p,g]=E.useState(!0),[v,_]=E.useState("idle"),[y,x]=E.useState({loaded:0,total:0}),[m,w]=E.useState(()=>{try{return localStorage.getItem("soundfield_training_mode")==="true"}catch{return!1}}),b=E.useRef(null),T=()=>{const C=!m;w(C);try{localStorage.setItem("soundfield_training_mode",String(C))}catch(N){console.error("Failed to save training mode:",N)}},A=E.useCallback((C,N)=>C.sort().map((O,D)=>{const j=N.find(k=>k.species_code===O&&k.canonical&&!k.rejected),M=N.find(k=>k.species_code===O&&!k.rejected),G=j||M;return{code:O,name:(G==null?void 0:G.common_name)||O,color:ja[D%ja.length],clipPath:G?`/data/clips/${G.file_path.split("/").pop()}`:null}}),[]),S=E.useCallback((C,N)=>{const O=C.species_pool||[],D=C.species_count||O.length,G=[...O].sort(()=>Math.random()-.5).slice(0,D).sort().map((k,P)=>{const F=N.find(le=>le.species_code===k&&le.canonical&&!le.rejected),q=N.find(le=>le.species_code===k&&!le.rejected),Q=F||q;return{code:k,name:(Q==null?void 0:Q.common_name)||k,color:ja[P%ja.length],clipPath:Q?`/data/clips/${Q.file_path.split("/").pop()}`:null}});h(G)},[]);E.useEffect(()=>{Promise.all([fetch("/data/levels.json").then(C=>C.json()),fetch("/data/clips.json").then(C=>C.json())]).then(([C,N])=>{if(l(N),r==="custom"){const D=localStorage.getItem("soundfield_custom_pack");if(D)try{const j=JSON.parse(D),M={level_id:n,pack_id:"custom",mode:"campaign",title:tT[n]||`Level ${n}`,round_duration_sec:30,species_count:j.length,species_pool:j,clip_selection:rT(n),channel_mode:nT(n),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"};o(M),h(A(j,N))}catch(j){console.error("Failed to parse custom pack:",j)}g(!1);return}const O=C.find(D=>D.pack_id===r&&D.level_id===n);if(O){if(o(O),i){const D=sessionStorage.getItem("roundSpecies");if(D)try{const j=JSON.parse(D),M=O.species_pool||[],G=j.filter(k=>M.includes(k));if(G.length===j.length){h(A(G,N)),g(!1);return}}catch(j){console.error("Failed to parse saved species:",j)}}S(O,N)}g(!1)}).catch(C=>{console.error("Failed to load data:",C),g(!1)})},[r,n,i,A,S]),E.useEffect(()=>{if(c.length===0||a.length===0){_("idle");return}const C=c.map(j=>j.code),N=a.filter(j=>C.includes(j.species_code)&&!j.rejected);if(N.length===0){_("ready"),x({loaded:0,total:0});return}_("loading"),x({loaded:0,total:N.length}),console.log(`Preloading ${N.length} clips for ${C.length} species...`);let O=0;const D=N.map(async j=>{const M=`/${j.file_path}`;try{const G=await fetch(M);G.ok&&await G.arrayBuffer()}catch(G){console.warn("Failed to preload:",j.file_path,G)}finally{O++,x({loaded:O,total:N.length})}});Promise.all(D).then(()=>{console.log("Preloading complete!"),_("ready")})},[c,a]);const R=()=>{s&&a.length>0&&(b.current&&(b.current.pause(),b.current=null,f(null)),_("idle"),S(s,a))},I=C=>{if(console.log(`[Preview] Attempting to play: ${C.code}`),console.log(`[Preview] Clip path: ${C.clipPath}`),b.current&&(b.current.pause(),b.current=null),d===C.code){f(null);return}if(!C.clipPath){console.error(`[Preview] No clip path for ${C.code}!`);return}const N=new Audio(C.clipPath);b.current=N,f(C.code),N.play().then(()=>console.log(`[Preview] Playing ${C.code} successfully`)).catch(O=>{console.error(`[Preview] Failed to play ${C.code}:`,O),console.error(`[Preview] Clip path was: ${C.clipPath}`)}),N.onended=()=>{console.log(`[Preview] ${C.code} finished playing`),f(null),b.current=null}},L=()=>{b.current&&b.current.pause();const C=c.map(N=>N.code);sessionStorage.setItem("roundSpecies",JSON.stringify(C)),t(`/gameplay?mode=campaign&pack=${r}&level=${n}&preview=true`)};if(E.useEffect(()=>()=>{b.current&&b.current.pause()},[]),p)return u.jsx("div",{className:"screen screen-center",children:u.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading..."})});if(!s)return u.jsxs("div",{className:"screen screen-center",children:[u.jsx("div",{style:{color:"var(--color-error)"},children:"Level not found"}),u.jsx("button",{onClick:()=>t(-1),style:{marginTop:"16px",padding:"8px 16px",background:"var(--color-surface)",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"Go Back"})]});const B=eT[r]||r;return u.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column"},children:[u.jsxs("div",{style:{marginBottom:"12px"},children:[u.jsxs("div",{className:"flex-row items-center",style:{marginBottom:"8px"},children:[u.jsx("button",{className:"btn-icon",onClick:()=>t(`/level-select?pack=${r}`),"aria-label":"Back",children:u.jsx(oT,{})}),u.jsxs("div",{style:{flex:1,marginLeft:"8px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"16px"},children:B}),u.jsxs("div",{style:{fontSize:"13px",color:"var(--color-accent)"},children:["Level ",s.level_id,": ",s.title]})]})]}),u.jsxs("button",{onClick:L,style:{width:"100%",padding:"14px",fontSize:"16px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",boxShadow:"0 4px 12px rgba(45, 90, 39, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:["Ready to Play ",u.jsx(lT,{})]}),v==="loading"&&u.jsxs("div",{style:{marginTop:"8px",textAlign:"center"},children:[u.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"6px"},children:["Loading sounds ",y.loaded,"/",y.total]}),u.jsx("div",{style:{width:"100%",height:"4px",background:"var(--color-surface)",borderRadius:"2px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${y.loaded/y.total*100}%`,height:"100%",background:"var(--color-accent)",transition:"width 0.2s ease"}})})]}),v==="ready"&&u.jsxs("div",{style:{marginTop:"6px",fontSize:"11px",color:"var(--color-success)",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[u.jsx("span",{children:""})," Sounds ready"]}),u.jsxs("button",{onClick:T,style:{width:"100%",marginTop:"8px",padding:"10px 14px",background:m?"rgba(245, 166, 35, 0.15)":"var(--color-surface)",border:m?"1px solid var(--color-accent)":"1px solid transparent",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.15s"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx(cT,{filled:m}),u.jsx("span",{style:{fontSize:"14px",color:"var(--color-text)"},children:"Training Mode"})]}),u.jsx("div",{style:{width:"40px",height:"22px",borderRadius:"11px",background:m?"var(--color-accent)":"var(--color-text-muted)",position:"relative",transition:"background 0.15s"},children:u.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:m?"20px":"2px",transition:"left 0.15s"}})})]}),m&&u.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"4px",paddingLeft:"4px"},children:"Bird icons appear on spectrograms. Toggle on mid-round? Icons show up on the next new bird."})]}),u.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"16px 0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"12px",textAlign:"center",maxWidth:"280px"},children:s.level_id===1?"Tap to preview each bird's signature sound":u.jsxs(u.Fragment,{children:["Tap to preview signature sounds.",u.jsx("br",{}),u.jsx("span",{style:{fontSize:"12px",opacity:.8},children:"You'll hear variations during play!"})]})}),s.species_pool&&s.species_pool.length>(s.species_count||0)&&u.jsxs("button",{onClick:R,style:{marginBottom:"16px",padding:"8px 16px",background:"transparent",border:"1px solid var(--color-accent)",borderRadius:"8px",color:"var(--color-accent)",fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.15s"},onMouseEnter:C=>{C.currentTarget.style.background="rgba(245, 166, 35, 0.1)"},onMouseLeave:C=>{C.currentTarget.style.background="transparent"},children:[u.jsx(aT,{}),"Shuffle Birds"]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",maxWidth:"320px",width:"100%"},children:c.map(C=>u.jsxs("button",{onClick:()=>I(C),disabled:!C.clipPath,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"12px 8px",background:d===C.code?`${C.color}33`:"var(--color-surface)",border:`2px solid ${C.color}`,borderRadius:"12px",cursor:C.clipPath?"pointer":"not-allowed",opacity:C.clipPath?1:.5,transition:"transform 0.15s, background 0.15s",WebkitTapHighlightColor:"transparent"},children:[u.jsx("div",{style:{position:"relative",WebkitTapHighlightColor:"transparent"},children:u.jsx(iT,{code:C.code,size:56,color:C.color})}),u.jsx("div",{style:{fontSize:"11px",color:"var(--color-text)",textAlign:"center",lineHeight:1.2,maxWidth:"80px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:C.name})]},C.code))})]}),u.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.7; }
        }
        * {
          -webkit-tap-highlight-color: transparent;
        }
      `})]})}function oT(){return u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}function aT(){return u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M16 3h5v5"}),u.jsx("path",{d:"M4 20L21 3"}),u.jsx("path",{d:"M21 16v5h-5"}),u.jsx("path",{d:"M15 15l6 6"}),u.jsx("path",{d:"M4 4l5 5"})]})}function lT(){return u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8 5v14l11-7z"})})}function cT({filled:t}){return u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:t?"var(--color-accent)":"var(--color-text-muted)",strokeWidth:"2",children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3",fill:t?"var(--color-accent)":"none"})]})}const Ui=9,bg="soundfield_custom_pack",Eg=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"];function uT(){const t=Wt(),[e,r]=E.useState([]),[n,i]=E.useState([]),[s,o]=E.useState(""),[a,l]=E.useState(null),[c,h]=E.useState(!0),d=E.useRef(null),f=E.useRef(null);E.useEffect(()=>{fetch("/data/clips.json").then(m=>{if(!m.ok)throw new Error(`HTTP ${m.status}: ${m.statusText}`);return m.json()}).then(m=>{const w=new Map;for(const T of m)if(!T.rejected&&!w.has(T.species_code)){const S=m.find(R=>R.species_code===T.species_code&&R.canonical&&!R.rejected&&R.common_name)||m.find(R=>R.species_code===T.species_code&&R.common_name&&!R.rejected)||T;if(!S.common_name){console.warn(`Skipping ${T.species_code} - missing common_name`);continue}w.set(T.species_code,{code:T.species_code,name:S.common_name,clipPath:`/data/clips/${S.file_path.split("/").pop()}`})}const b=Array.from(w.values()).sort((T,A)=>(T.name||T.code).localeCompare(A.name||A.code));r(b),h(!1)}).catch(m=>{console.error("Failed to load clips:",m),h(!1)});try{const m=localStorage.getItem(bg);if(m){const w=JSON.parse(m);Array.isArray(w)&&w.length>0&&i(w)}}catch(m){console.error("Failed to load saved pack:",m)}},[]);const p=E.useCallback(m=>{i(w=>{const b=w.includes(m),T=w.length>=Ui;return b?w.filter(A=>A!==m):T?w:(o(""),setTimeout(()=>{var A;(A=f.current)==null||A.focus()},0),[...w,m])})},[]),g=(m,w)=>{if(w.stopPropagation(),d.current&&(d.current.pause(),d.current=null),a===m.code){l(null);return}if(!m.clipPath)return;const b=new Audio(m.clipPath);d.current=b,l(m.code),b.play().catch(T=>console.error("Failed to play:",T)),b.onended=()=>{l(null),d.current=null}},v=()=>{n.length!==0&&(localStorage.setItem(bg,JSON.stringify(n)),t("/level-select?pack=custom"))},_=()=>{i([])},y=()=>{o(""),setTimeout(()=>{var m;(m=f.current)==null||m.focus()},0)},x=s?e.filter(m=>m.name.toLowerCase().includes(s.toLowerCase())||m.code.toLowerCase().includes(s.toLowerCase())):e;return E.useEffect(()=>()=>{d.current&&d.current.pause()},[]),c?u.jsx("div",{className:"screen screen-center",children:u.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading species..."})}):u.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",overflow:"hidden"},children:[u.jsx("div",{style:{flexShrink:0,marginBottom:"12px"},children:u.jsxs("div",{className:"flex-row items-center gap-md",children:[u.jsx("button",{className:"btn-icon",onClick:()=>t("/pack-select"),"aria-label":"Back",children:u.jsx(hT,{})}),u.jsxs("div",{children:[u.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Custom Pack Builder"}),u.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:["Select up to ",Ui," birds"]})]})]})}),u.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",position:"relative"},children:[u.jsx("input",{ref:f,type:"text",placeholder:"Search birds...",value:s,onChange:m=>o(m.target.value),style:{width:"100%",padding:"10px 12px",paddingRight:s?"36px":"12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px"}}),s&&u.jsx("button",{onClick:y,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"var(--color-text-muted)",border:"none",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:0},"aria-label":"Clear search",children:u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-background)",strokeWidth:"3",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),u.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",padding:"8px 12px",background:"rgba(45, 90, 39, 0.1)",borderRadius:"8px",fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.4},children:[u.jsx("span",{style:{color:"var(--color-accent)"},children:" Tip:"})," Click the ",u.jsx("strong",{style:{color:"var(--color-text)"},children:" play button"})," to preview a bird's signature sound. Click the ",u.jsx("strong",{style:{color:"var(--color-text)"},children:"bird card"})," to add it to your pack."]}),n.length>0&&u.jsx("div",{style:{flexShrink:0,marginBottom:"12px",position:"sticky",top:"0",zIndex:100,paddingTop:"4px",paddingBottom:"4px",background:"var(--color-background)"},children:u.jsxs("button",{onClick:v,style:{width:"100%",padding:"14px 20px",fontSize:"16px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s"},children:[u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8 5v14l11-7z"})}),"Start with ",n.length," bird",n.length>1?"s":""]})}),u.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",padding:"8px 12px",background:n.length>0?"rgba(45, 90, 39, 0.2)":"var(--color-surface)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("span",{style:{fontSize:"14px"},children:[u.jsx("span",{style:{fontWeight:700,color:"var(--color-accent)"},children:n.length}),"/",Ui," selected"]}),n.length>0&&u.jsx("button",{onClick:_,style:{background:"none",border:"none",color:"var(--color-text-muted)",fontSize:"12px",cursor:"pointer",textDecoration:"underline"},children:"Clear all"})]}),u.jsx("div",{style:{flex:1,overflowY:"auto",marginBottom:"12px"},children:u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"8px"},children:x.map(m=>{const w=n.includes(m.code),b=n.indexOf(m.code),T=w?Eg[b%Eg.length]:void 0;return u.jsxs("button",{onClick:()=>p(m.code),disabled:!w&&n.length>=Ui,style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px",background:w?`${T}22`:"var(--color-surface)",border:w?`2px solid ${T}`:"1px solid transparent",borderRadius:"8px",cursor:w||n.length<Ui?"pointer":"not-allowed",opacity:w||n.length<Ui?1:.5,textAlign:"left",transition:"all 0.15s"},children:[u.jsx("div",{onClick:A=>g(m,A),style:{width:"32px",height:"32px",borderRadius:"50%",background:w?T:"var(--color-background)",border:w?"none":"1px solid var(--color-text-muted)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,cursor:"pointer"},children:a===m.code?u.jsx(fT,{color:w?"#1A1A2E":"var(--color-text)"}):w?u.jsx(pT,{}):u.jsx(dT,{})}),u.jsxs("div",{style:{minWidth:0,flex:1},children:[u.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:w?T:"var(--color-accent)"},children:m.code}),u.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:m.name})]})]},m.code)})})})]})}function hT(){return u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}function dT(){return u.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-text-muted)",children:u.jsx("path",{d:"M8 5v14l11-7z"})})}function fT({color:t="currentColor"}){return u.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:t,children:u.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function pT(){return u.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#1A1A2E",strokeWidth:"3",children:u.jsx("path",{d:"M20 6L9 17l-5-5"})})}const mT={campaign:"Learn",practice:"Practice",challenge:"Challenge",random:"Random"};function gT({score:t,streak:e,timeRemaining:r,mode:n,levelId:i,levelTitle:s}){const o=Math.floor(r/60),a=r%60,l=`${o}:${a.toString().padStart(2,"0")}`;return u.jsxs("div",{className:"hud",children:[u.jsxs("div",{className:"hud-score",children:[u.jsx("span",{className:"hud-label",children:"Score"}),u.jsx("span",{className:"hud-value",children:t.toLocaleString()})]}),u.jsxs("div",{className:"hud-center",children:[n==="campaign"&&i?u.jsxs("span",{className:"hud-mode",children:["Level ",i,s?`: ${s}`:""]}):n?u.jsx("span",{className:"hud-mode",children:mT[n]||n}):null,u.jsx("div",{className:"hud-streak",children:e===0?u.jsx("span",{className:"streak-dot",children:""}):Array.from({length:e}).map((c,h)=>u.jsx("span",{className:"streak-dot active",children:""},h))})]}),u.jsxs("div",{className:"hud-timer",children:[u.jsx("span",{className:"hud-label",children:"Time"}),u.jsx("span",{className:"hud-value",children:l})]}),u.jsx("style",{children:`
        .hud {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          padding-top: calc(12px + var(--safe-area-top, 0px));
          background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.3) 100%);
          border-bottom: 1px solid var(--color-surface);
        }

        .hud-score, .hud-timer {
          display: flex;
          flex-direction: column;
          align-items: center;
          min-width: 80px;
        }

        .hud-label {
          font-size: 10px;
          text-transform: uppercase;
          color: var(--color-text-muted);
          letter-spacing: 0.5px;
        }

        .hud-value {
          font-family: var(--font-mono);
          font-size: 20px;
          font-weight: 600;
          color: var(--color-accent);
        }

        .hud-center {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 4px;
        }

        .hud-mode {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1px;
          color: var(--color-text-muted);
          padding: 2px 8px;
          border-radius: 4px;
          background: rgba(255, 255, 255, 0.1);
        }

        .hud-streak {
          display: flex;
          gap: 4px;
          font-size: 12px;
        }

        .streak-dot {
          color: var(--color-text-muted);
          transition: color 0.2s, transform 0.2s;
        }

        .streak-dot.active {
          color: var(--color-accent);
          transform: scale(1.2);
        }
      `})]})}const yT=E.memo(gT);var Mi=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(Mi||{}),Z0=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(Z0||{}),Md=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Md||{}),se=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(se||{}),Br=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(Br||{}),$=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))($||{}),Ss=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Ss||{}),te=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(te||{}),W=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(W||{}),Kr=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(Kr||{}),Gn=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Gn||{}),jr=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(jr||{}),Pt=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Pt||{}),Ir=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Ir||{}),Rp=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(Rp||{}),Zt=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(Zt||{}),Je=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(Je||{}),Ke=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(Ke||{}),Fr=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(Fr||{});const xT={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},X={ADAPTER:xT,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Du=/iPhone/i,Tg=/iPod/i,Ag=/iPad/i,Cg=/\biOS-universal(?:.+)Mac\b/i,ju=/\bAndroid(?:.+)Mobile\b/i,Rg=/Android/i,Gi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Oa=/Silk/i,zr=/Windows Phone/i,Pg=/\bWindows(?:.+)ARM\b/i,Ig=/BlackBerry/i,kg=/BB10/i,Mg=/Opera Mini/i,Bg=/\b(CriOS|Chrome)(?:.+)Mobile/i,Ng=/Mobile(?:.+)Firefox\b/i,Lg=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function vT(t){return function(e){return e.test(t)}}function Fg(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,n=r.split("[FBAN");typeof n[1]<"u"&&(r=n[0]),n=r.split("Twitter"),typeof n[1]<"u"&&(r=n[0]);var i=vT(r),s={apple:{phone:i(Du)&&!i(zr),ipod:i(Tg),tablet:!i(Du)&&(i(Ag)||Lg(e))&&!i(zr),universal:i(Cg),device:(i(Du)||i(Tg)||i(Ag)||i(Cg)||Lg(e))&&!i(zr)},amazon:{phone:i(Gi),tablet:!i(Gi)&&i(Oa),device:i(Gi)||i(Oa)},android:{phone:!i(zr)&&i(Gi)||!i(zr)&&i(ju),tablet:!i(zr)&&!i(Gi)&&!i(ju)&&(i(Oa)||i(Rg)),device:!i(zr)&&(i(Gi)||i(Oa)||i(ju)||i(Rg))||i(/\bokhttp\b/i)},windows:{phone:i(zr),tablet:i(Pg),device:i(zr)||i(Pg)},other:{blackberry:i(Ig),blackberry10:i(kg),opera:i(Mg),firefox:i(Ng),chrome:i(Bg),device:i(Ig)||i(kg)||i(Mg)||i(Ng)||i(Bg)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const _T=Fg.default??Fg,qr=_T(globalThis.navigator);X.RETINA_PREFIX=/@([0-9\.]+)x/;X.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var J0={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,c,h){this.fn=l,this.context=c,this.once=h||!1}function s(l,c,h,d,f){if(typeof h!="function")throw new TypeError("The listener must be a function");var p=new i(h,d||l,f),g=r?r+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],p]:l._events[g].push(p):(l._events[g]=p,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],h,d;if(this._eventsCount===0)return c;for(d in h=this._events)e.call(h,d)&&c.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(h)):c},a.prototype.listeners=function(c){var h=r?r+c:c,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,p=d.length,g=new Array(p);f<p;f++)g[f]=d[f].fn;return g},a.prototype.listenerCount=function(c){var h=r?r+c:c,d=this._events[h];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,h,d,f,p,g){var v=r?r+c:c;if(!this._events[v])return!1;var _=this._events[v],y=arguments.length,x,m;if(_.fn){switch(_.once&&this.removeListener(c,_.fn,void 0,!0),y){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,h),!0;case 3:return _.fn.call(_.context,h,d),!0;case 4:return _.fn.call(_.context,h,d,f),!0;case 5:return _.fn.call(_.context,h,d,f,p),!0;case 6:return _.fn.call(_.context,h,d,f,p,g),!0}for(m=1,x=new Array(y-1);m<y;m++)x[m-1]=arguments[m];_.fn.apply(_.context,x)}else{var w=_.length,b;for(m=0;m<w;m++)switch(_[m].once&&this.removeListener(c,_[m].fn,void 0,!0),y){case 1:_[m].fn.call(_[m].context);break;case 2:_[m].fn.call(_[m].context,h);break;case 3:_[m].fn.call(_[m].context,h,d);break;case 4:_[m].fn.call(_[m].context,h,d,f);break;default:if(!x)for(b=1,x=new Array(y-1);b<y;b++)x[b-1]=arguments[b];_[m].fn.apply(_[m].context,x)}}return!0},a.prototype.on=function(c,h,d){return s(this,c,h,d,!1)},a.prototype.once=function(c,h,d){return s(this,c,h,d,!0)},a.prototype.removeListener=function(c,h,d,f){var p=r?r+c:c;if(!this._events[p])return this;if(!h)return o(this,p),this;var g=this._events[p];if(g.fn)g.fn===h&&(!f||g.once)&&(!d||g.context===d)&&o(this,p);else{for(var v=0,_=[],y=g.length;v<y;v++)(g[v].fn!==h||f&&!g[v].once||d&&g[v].context!==d)&&_.push(g[v]);_.length?this._events[p]=_.length===1?_[0]:_:o(this,p)}return this},a.prototype.removeAllListeners=function(c){var h;return c?(h=r?r+c:c,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(J0);var wT=J0.exports;const fa=Pf(wT);var Pp={exports:{}};Pp.exports=zc;Pp.exports.default=zc;function zc(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=e_(t,0,i,r,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,c,h,d,f,p;if(n&&(s=AT(t,e,s,r)),t.length>80*r){a=c=t[0],l=h=t[1];for(var g=r;g<i;g+=r)d=t[g],f=t[g+1],d<a&&(a=d),f<l&&(l=f),d>c&&(c=d),f>h&&(h=f);p=Math.max(c-a,h-l),p=p!==0?32767/p:0}return ta(s,o,r,a,l,p,0),o}function e_(t,e,r,n,i){var s,o;if(i===Ld(t,e,r,n)>0)for(s=e;s<r;s+=n)o=Dg(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=Dg(s,t[s],t[s+1],o);return o&&Hc(o,o.next)&&(na(o),o=o.next),o}function Ei(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Hc(r,r.next)||Ue(r.prev,r,r.next)===0)){if(na(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function ta(t,e,r,n,i,s,o){if(t){!o&&s&&kT(t,n,i,s);for(var a=t,l,c;t.prev!==t.next;){if(l=t.prev,c=t.next,s?bT(t,n,i,s):ST(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(c.i/r|0),na(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=ET(Ei(t),e,r),ta(t,e,r,n,i,s,2)):o===2&&TT(t,e,r,n,i,s):ta(Ei(t),e,r,n,i,s,1);break}}}}function ST(t){var e=t.prev,r=t,n=t.next;if(Ue(e,r,n)>=0)return!1;for(var i=e.x,s=r.x,o=n.x,a=e.y,l=r.y,c=n.y,h=i<s?i<o?i:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,f=i>s?i>o?i:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c,g=n.next;g!==e;){if(g.x>=h&&g.x<=f&&g.y>=d&&g.y<=p&&ps(i,a,s,l,o,c,g.x,g.y)&&Ue(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function bT(t,e,r,n){var i=t.prev,s=t,o=t.next;if(Ue(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,h=i.y,d=s.y,f=o.y,p=a<l?a<c?a:c:l<c?l:c,g=h<d?h<f?h:f:d<f?d:f,v=a>l?a>c?a:c:l>c?l:c,_=h>d?h>f?h:f:d>f?d:f,y=Bd(p,g,e,r,n),x=Bd(v,_,e,r,n),m=t.prevZ,w=t.nextZ;m&&m.z>=y&&w&&w.z<=x;){if(m.x>=p&&m.x<=v&&m.y>=g&&m.y<=_&&m!==i&&m!==o&&ps(a,h,l,d,c,f,m.x,m.y)&&Ue(m.prev,m,m.next)>=0||(m=m.prevZ,w.x>=p&&w.x<=v&&w.y>=g&&w.y<=_&&w!==i&&w!==o&&ps(a,h,l,d,c,f,w.x,w.y)&&Ue(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;m&&m.z>=y;){if(m.x>=p&&m.x<=v&&m.y>=g&&m.y<=_&&m!==i&&m!==o&&ps(a,h,l,d,c,f,m.x,m.y)&&Ue(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;w&&w.z<=x;){if(w.x>=p&&w.x<=v&&w.y>=g&&w.y<=_&&w!==i&&w!==o&&ps(a,h,l,d,c,f,w.x,w.y)&&Ue(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function ET(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!Hc(i,s)&&t_(i,n,n.next,s)&&ra(i,s)&&ra(s,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(s.i/r|0),na(n),na(n.next),n=t=s),n=n.next}while(n!==t);return Ei(n)}function TT(t,e,r,n,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&NT(o,a)){var l=r_(o,a);o=Ei(o,o.next),l=Ei(l,l.next),ta(o,e,r,n,i,s,0),ta(l,e,r,n,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function AT(t,e,r,n){var i=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:t.length,c=e_(t,a,l,n,!1),c===c.next&&(c.steiner=!0),i.push(BT(c));for(i.sort(CT),s=0;s<i.length;s++)r=RT(i[s],r);return r}function CT(t,e){return t.x-e.x}function RT(t,e){var r=PT(t,e);if(!r)return e;var n=r_(r,t);return Ei(n,n.next),Ei(r,r.next)}function PT(t,e){var r=e,n=t.x,i=t.y,s=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s&&(s=a,o=r.x<r.next.x?r:r.next,a===n))return o}r=r.next}while(r!==e);if(!o)return null;var l=o,c=o.x,h=o.y,d=1/0,f;r=o;do n>=r.x&&r.x>=c&&n!==r.x&&ps(i<h?n:s,i,c,h,i<h?s:n,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(n-r.x),ra(r,t)&&(f<d||f===d&&(r.x>o.x||r.x===o.x&&IT(o,r)))&&(o=r,d=f)),r=r.next;while(r!==l);return o}function IT(t,e){return Ue(t.prev,t,e.prev)<0&&Ue(e.next,t,t.next)<0}function kT(t,e,r,n){var i=t;do i.z===0&&(i.z=Bd(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,MT(i)}function MT(t){var e,r,n,i,s,o,a,l,c=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,n=r,a=0,e=0;e<c&&(a++,n=n.nextZ,!!n);e++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n}s.nextZ=null,c*=2}while(o>1);return t}function Bd(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function BT(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function ps(t,e,r,n,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(r-o)*(e-a)&&(r-o)*(s-a)>=(i-o)*(n-a)}function NT(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!LT(t,e)&&(ra(t,e)&&ra(e,t)&&FT(t,e)&&(Ue(t.prev,t,e.prev)||Ue(t,e.prev,e))||Hc(t,e)&&Ue(t.prev,t,t.next)>0&&Ue(e.prev,e,e.next)>0)}function Ue(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Hc(t,e){return t.x===e.x&&t.y===e.y}function t_(t,e,r,n){var i=Ga(Ue(t,e,r)),s=Ga(Ue(t,e,n)),o=Ga(Ue(r,n,t)),a=Ga(Ue(r,n,e));return!!(i!==s&&o!==a||i===0&&Ua(t,r,e)||s===0&&Ua(t,n,e)||o===0&&Ua(r,t,n)||a===0&&Ua(r,e,n))}function Ua(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ga(t){return t>0?1:t<0?-1:0}function LT(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&t_(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function ra(t,e){return Ue(t.prev,t,t.next)<0?Ue(t,e,t.next)>=0&&Ue(t,t.prev,e)>=0:Ue(t,e,t.prev)<0||Ue(t,t.next,e)<0}function FT(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function r_(t,e){var r=new Nd(t.i,t.x,t.y),n=new Nd(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function Dg(t,e,r,n){var i=new Nd(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function na(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Nd(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}zc.deviation=function(t,e,r,n){var i=e&&e.length,s=i?e[0]*r:t.length,o=Math.abs(Ld(t,0,s,r));if(i)for(var a=0,l=e.length;a<l;a++){var c=e[a]*r,h=a<l-1?e[a+1]*r:t.length;o-=Math.abs(Ld(t,c,h,r))}var d=0;for(a=0;a<n.length;a+=3){var f=n[a]*r,p=n[a+1]*r,g=n[a+2]*r;d+=Math.abs((t[f]-t[g])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[g+1]-t[f+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function Ld(t,e,r,n){for(var i=0,s=e,o=r-n;s<r;s+=n)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}zc.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[i][s][o]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var DT=Pp.exports;const jT=Pf(DT);var sc={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */sc.exports;(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof wo=="object"&&wo;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a=2147483647,l=36,c=1,h=26,d=38,f=700,p=72,g=128,v="-",_=/^xn--/,y=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=l-c,b=Math.floor,T=String.fromCharCode,A;function S(k){throw new RangeError(m[k])}function R(k,P){for(var F=k.length,q=[];F--;)q[F]=P(k[F]);return q}function I(k,P){var F=k.split("@"),q="";F.length>1&&(q=F[0]+"@",k=F[1]),k=k.replace(x,".");var Q=k.split("."),le=R(Q,P).join(".");return q+le}function L(k){for(var P=[],F=0,q=k.length,Q,le;F<q;)Q=k.charCodeAt(F++),Q>=55296&&Q<=56319&&F<q?(le=k.charCodeAt(F++),(le&64512)==56320?P.push(((Q&1023)<<10)+(le&1023)+65536):(P.push(Q),F--)):P.push(Q);return P}function B(k){return R(k,function(P){var F="";return P>65535&&(P-=65536,F+=T(P>>>10&1023|55296),P=56320|P&1023),F+=T(P),F}).join("")}function C(k){return k-48<10?k-22:k-65<26?k-65:k-97<26?k-97:l}function N(k,P){return k+22+75*(k<26)-((P!=0)<<5)}function O(k,P,F){var q=0;for(k=F?b(k/f):k>>1,k+=b(k/P);k>w*h>>1;q+=l)k=b(k/w);return b(q+(w+1)*k/(k+d))}function D(k){var P=[],F=k.length,q,Q=0,le=g,xe=p,oe,Pe,Le,Te,Se,be,Ee,Ye,rt;for(oe=k.lastIndexOf(v),oe<0&&(oe=0),Pe=0;Pe<oe;++Pe)k.charCodeAt(Pe)>=128&&S("not-basic"),P.push(k.charCodeAt(Pe));for(Le=oe>0?oe+1:0;Le<F;){for(Te=Q,Se=1,be=l;Le>=F&&S("invalid-input"),Ee=C(k.charCodeAt(Le++)),(Ee>=l||Ee>b((a-Q)/Se))&&S("overflow"),Q+=Ee*Se,Ye=be<=xe?c:be>=xe+h?h:be-xe,!(Ee<Ye);be+=l)rt=l-Ye,Se>b(a/rt)&&S("overflow"),Se*=rt;q=P.length+1,xe=O(Q-Te,q,Te==0),b(Q/q)>a-le&&S("overflow"),le+=b(Q/q),Q%=q,P.splice(Q++,0,le)}return B(P)}function j(k){var P,F,q,Q,le,xe,oe,Pe,Le,Te,Se,be=[],Ee,Ye,rt,Lt;for(k=L(k),Ee=k.length,P=g,F=0,le=p,xe=0;xe<Ee;++xe)Se=k[xe],Se<128&&be.push(T(Se));for(q=Q=be.length,Q&&be.push(v);q<Ee;){for(oe=a,xe=0;xe<Ee;++xe)Se=k[xe],Se>=P&&Se<oe&&(oe=Se);for(Ye=q+1,oe-P>b((a-F)/Ye)&&S("overflow"),F+=(oe-P)*Ye,P=oe,xe=0;xe<Ee;++xe)if(Se=k[xe],Se<P&&++F>a&&S("overflow"),Se==P){for(Pe=F,Le=l;Te=Le<=le?c:Le>=le+h?h:Le-le,!(Pe<Te);Le+=l)Lt=Pe-Te,rt=l-Te,be.push(T(N(Te+Lt%rt,0))),Pe=b(Lt/rt);be.push(T(N(Pe,0))),le=O(F,Ye,q==Q),F=0,++q}++F,++P}return be.join("")}function M(k){return I(k,function(P){return _.test(P)?D(P.slice(4).toLowerCase()):P})}function G(k){return I(k,function(P){return y.test(P)?"xn--"+j(P):P})}if(o={version:"1.4.1",ucs2:{decode:L,encode:B},decode:D,encode:j,toASCII:G,toUnicode:M},n&&i)if(t.exports==n)i.exports=o;else for(A in o)o.hasOwnProperty(A)&&(n[A]=o[A]);else r.punycode=o})(wo)})(sc,sc.exports);var OT=sc.exports,Vs=TypeError;const UT={},GT=Object.freeze(Object.defineProperty({__proto__:null,default:UT},Symbol.toStringTag,{value:"Module"})),zT=ew(GT);var Ip=typeof Map=="function"&&Map.prototype,Ou=Object.getOwnPropertyDescriptor&&Ip?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,oc=Ip&&Ou&&typeof Ou.get=="function"?Ou.get:null,jg=Ip&&Map.prototype.forEach,kp=typeof Set=="function"&&Set.prototype,Uu=Object.getOwnPropertyDescriptor&&kp?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ac=kp&&Uu&&typeof Uu.get=="function"?Uu.get:null,Og=kp&&Set.prototype.forEach,HT=typeof WeakMap=="function"&&WeakMap.prototype,ko=HT?WeakMap.prototype.has:null,$T=typeof WeakSet=="function"&&WeakSet.prototype,Mo=$T?WeakSet.prototype.has:null,VT=typeof WeakRef=="function"&&WeakRef.prototype,Ug=VT?WeakRef.prototype.deref:null,WT=Boolean.prototype.valueOf,XT=Object.prototype.toString,YT=Function.prototype.toString,KT=String.prototype.match,Mp=String.prototype.slice,Pn=String.prototype.replace,qT=String.prototype.toUpperCase,Gg=String.prototype.toLowerCase,n_=RegExp.prototype.test,zg=Array.prototype.concat,kr=Array.prototype.join,QT=Array.prototype.slice,Hg=Math.floor,Fd=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Gu=Object.getOwnPropertySymbols,Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Bo=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ds||!0)?Symbol.toStringTag:null,i_=Object.prototype.propertyIsEnumerable,$g=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Vg(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||n_.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-Hg(-t):Hg(t);if(n!==t){var i=String(n),s=Mp.call(e,i.length+1);return Pn.call(i,r,"$&_")+"."+Pn.call(Pn.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Pn.call(e,r,"$&_")}var jd=zT,Wg=jd.custom,Xg=a_(Wg)?Wg:null,s_={__proto__:null,double:'"',single:"'"},ZT={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},$c=function t(e,r,n,i){var s=r||{};if(Vr(s,"quoteStyle")&&!Vr(s_,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Vr(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Vr(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Vr(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Vr(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return c_(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?Vg(e,l):l}if(typeof e=="bigint"){var c=String(e)+"n";return a?Vg(e,c):c}var h=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=h&&h>0&&typeof e=="object")return Od(e)?"[Array]":"[Object]";var d=gA(s,n);if(typeof i>"u")i=[];else if(l_(i,e)>=0)return"[Circular]";function f(C,N,O){if(N&&(i=QT.call(i),i.push(N)),O){var D={depth:s.depth};return Vr(s,"quoteStyle")&&(D.quoteStyle=s.quoteStyle),t(C,D,n+1,i)}return t(C,s,n+1,i)}if(typeof e=="function"&&!Yg(e)){var p=aA(e),g=za(e,f);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(g.length>0?" { "+kr.call(g,", ")+" }":"")}if(a_(e)){var v=Ds?Pn.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Dd.call(e);return typeof e=="object"&&!Ds?no(v):v}if(fA(e)){for(var _="<"+Gg.call(String(e.nodeName)),y=e.attributes||[],x=0;x<y.length;x++)_+=" "+y[x].name+"="+o_(JT(y[x].value),"double",s);return _+=">",e.childNodes&&e.childNodes.length&&(_+="..."),_+="</"+Gg.call(String(e.nodeName))+">",_}if(Od(e)){if(e.length===0)return"[]";var m=za(e,f);return d&&!mA(m)?"["+Ud(m,d)+"]":"[ "+kr.call(m,", ")+" ]"}if(tA(e)){var w=za(e,f);return!("cause"in Error.prototype)&&"cause"in e&&!i_.call(e,"cause")?"{ ["+String(e)+"] "+kr.call(zg.call("[cause]: "+f(e.cause),w),", ")+" }":w.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+kr.call(w,", ")+" }"}if(typeof e=="object"&&o){if(Xg&&typeof e[Xg]=="function"&&jd)return jd(e,{depth:h-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(lA(e)){var b=[];return jg&&jg.call(e,function(C,N){b.push(f(N,e,!0)+" => "+f(C,e))}),Kg("Map",oc.call(e),b,d)}if(hA(e)){var T=[];return Og&&Og.call(e,function(C){T.push(f(C,e))}),Kg("Set",ac.call(e),T,d)}if(cA(e))return zu("WeakMap");if(dA(e))return zu("WeakSet");if(uA(e))return zu("WeakRef");if(nA(e))return no(f(Number(e)));if(sA(e))return no(f(Fd.call(e)));if(iA(e))return no(WT.call(e));if(rA(e))return no(f(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof wo<"u"&&e===wo)return"{ [object globalThis] }";if(!eA(e)&&!Yg(e)){var A=za(e,f),S=$g?$g(e)===Object.prototype:e instanceof Object||e.constructor===Object,R=e instanceof Object?"":"null prototype",I=!S&&Bo&&Object(e)===e&&Bo in e?Mp.call(qn(e),8,-1):R?"Object":"",L=S||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",B=L+(I||R?"["+kr.call(zg.call([],I||[],R||[]),": ")+"] ":"");return A.length===0?B+"{}":d?B+"{"+Ud(A,d)+"}":B+"{ "+kr.call(A,", ")+" }"}return String(e)};function o_(t,e,r){var n=r.quoteStyle||e,i=s_[n];return i+t+i}function JT(t){return Pn.call(String(t),/"/g,"&quot;")}function Bi(t){return!Bo||!(typeof t=="object"&&(Bo in t||typeof t[Bo]<"u"))}function Od(t){return qn(t)==="[object Array]"&&Bi(t)}function eA(t){return qn(t)==="[object Date]"&&Bi(t)}function Yg(t){return qn(t)==="[object RegExp]"&&Bi(t)}function tA(t){return qn(t)==="[object Error]"&&Bi(t)}function rA(t){return qn(t)==="[object String]"&&Bi(t)}function nA(t){return qn(t)==="[object Number]"&&Bi(t)}function iA(t){return qn(t)==="[object Boolean]"&&Bi(t)}function a_(t){if(Ds)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Dd)return!1;try{return Dd.call(t),!0}catch{}return!1}function sA(t){if(!t||typeof t!="object"||!Fd)return!1;try{return Fd.call(t),!0}catch{}return!1}var oA=Object.prototype.hasOwnProperty||function(t){return t in this};function Vr(t,e){return oA.call(t,e)}function qn(t){return XT.call(t)}function aA(t){if(t.name)return t.name;var e=KT.call(YT.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function l_(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function lA(t){if(!oc||!t||typeof t!="object")return!1;try{oc.call(t);try{ac.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function cA(t){if(!ko||!t||typeof t!="object")return!1;try{ko.call(t,ko);try{Mo.call(t,Mo)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function uA(t){if(!Ug||!t||typeof t!="object")return!1;try{return Ug.call(t),!0}catch{}return!1}function hA(t){if(!ac||!t||typeof t!="object")return!1;try{ac.call(t);try{oc.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function dA(t){if(!Mo||!t||typeof t!="object")return!1;try{Mo.call(t,Mo);try{ko.call(t,ko)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function fA(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function c_(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return c_(Mp.call(t,0,e.maxStringLength),e)+n}var i=ZT[e.quoteStyle||"single"];i.lastIndex=0;var s=Pn.call(Pn.call(t,i,"\\$1"),/[\x00-\x1f]/g,pA);return o_(s,"single",e)}function pA(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+qT.call(e.toString(16))}function no(t){return"Object("+t+")"}function zu(t){return t+" { ? }"}function Kg(t,e,r,n){var i=n?Ud(r,n):kr.call(r,", ");return t+" ("+e+") {"+i+"}"}function mA(t){for(var e=0;e<t.length;e++)if(l_(t[e],`
`)>=0)return!1;return!0}function gA(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=kr.call(Array(t.indent+1)," ");else return null;return{base:r,prev:kr.call(Array(e+1),r)}}function Ud(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+kr.call(t,","+r)+`
`+e.prev}function za(t,e){var r=Od(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=Vr(t,i)?e(t[i],t):""}var s=typeof Gu=="function"?Gu(t):[],o;if(Ds){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in t)Vr(t,l)&&(r&&String(Number(l))===l&&l<t.length||Ds&&o["$"+l]instanceof Symbol||(n_.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if(typeof Gu=="function")for(var c=0;c<s.length;c++)i_.call(t,s[c])&&n.push("["+e(s[c])+"]: "+e(t[s[c]],t));return n}var yA=$c,xA=Vs,Vc=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},vA=function(t,e){if(t){var r=Vc(t,e);return r&&r.value}},_A=function(t,e,r){var n=Vc(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},wA=function(t,e){return t?!!Vc(t,e):!1},SA=function(t,e){if(t)return Vc(t,e,!0)},bA=function(){var e,r={assert:function(n){if(!r.has(n))throw new xA("Side channel does not contain "+yA(n))},delete:function(n){var i=e&&e.next,s=SA(e,n);return s&&i&&i===s&&(e=void 0),!!s},get:function(n){return vA(e,n)},has:function(n){return wA(e,n)},set:function(n,i){e||(e={next:void 0}),_A(e,n,i)}};return r},u_=Object,EA=Error,TA=EvalError,AA=RangeError,CA=ReferenceError,RA=SyntaxError,PA=URIError,IA=Math.abs,kA=Math.floor,MA=Math.max,BA=Math.min,NA=Math.pow,LA=Math.round,FA=Number.isNaN||function(e){return e!==e},DA=FA,jA=function(e){return DA(e)||e===0?e:e<0?-1:1},OA=Object.getOwnPropertyDescriptor,Sl=OA;if(Sl)try{Sl([],"length")}catch{Sl=null}var h_=Sl,bl=Object.defineProperty||!1;if(bl)try{bl({},"a",{value:1})}catch{bl=!1}var UA=bl,Hu,qg;function GA(){return qg||(qg=1,Hu=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),Hu}var $u,Qg;function zA(){if(Qg)return $u;Qg=1;var t=typeof Symbol<"u"&&Symbol,e=GA();return $u=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},$u}var Vu,Zg;function d_(){return Zg||(Zg=1,Vu=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Vu}var Wu,Jg;function f_(){if(Jg)return Wu;Jg=1;var t=u_;return Wu=t.getPrototypeOf||null,Wu}var Xu,ey;function HA(){if(ey)return Xu;ey=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,n="[object Function]",i=function(l,c){for(var h=[],d=0;d<l.length;d+=1)h[d]=l[d];for(var f=0;f<c.length;f+=1)h[f+l.length]=c[f];return h},s=function(l,c){for(var h=[],d=c,f=0;d<l.length;d+=1,f+=1)h[f]=l[d];return h},o=function(a,l){for(var c="",h=0;h<a.length;h+=1)c+=a[h],h+1<a.length&&(c+=l);return c};return Xu=function(l){var c=this;if(typeof c!="function"||e.apply(c)!==n)throw new TypeError(t+c);for(var h=s(arguments,1),d,f=function(){if(this instanceof d){var y=c.apply(this,i(h,arguments));return Object(y)===y?y:this}return c.apply(l,i(h,arguments))},p=r(0,c.length-h.length),g=[],v=0;v<p;v++)g[v]="$"+v;if(d=Function("binder","return function ("+o(g,",")+"){ return binder.apply(this,arguments); }")(f),c.prototype){var _=function(){};_.prototype=c.prototype,d.prototype=new _,_.prototype=null}return d},Xu}var Yu,ty;function Wc(){if(ty)return Yu;ty=1;var t=HA();return Yu=Function.prototype.bind||t,Yu}var Ku,ry;function Bp(){return ry||(ry=1,Ku=Function.prototype.call),Ku}var qu,ny;function p_(){return ny||(ny=1,qu=Function.prototype.apply),qu}var $A=typeof Reflect<"u"&&Reflect&&Reflect.apply,VA=Wc(),WA=p_(),XA=Bp(),YA=$A,KA=YA||VA.call(XA,WA),qA=Wc(),QA=Vs,ZA=Bp(),JA=KA,m_=function(e){if(e.length<1||typeof e[0]!="function")throw new QA("a function is required");return JA(qA,ZA,e)},Qu,iy;function eC(){if(iy)return Qu;iy=1;var t=m_,e=h_,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return Qu=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,Qu}var Zu,sy;function tC(){if(sy)return Zu;sy=1;var t=d_(),e=f_(),r=eC();return Zu=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,Zu}var Ju,oy;function rC(){if(oy)return Ju;oy=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=Wc();return Ju=r.call(t,e),Ju}var me,nC=u_,iC=EA,sC=TA,oC=AA,aC=CA,js=RA,bs=Vs,lC=PA,cC=IA,uC=kA,hC=MA,dC=BA,fC=NA,pC=LA,mC=jA,g_=Function,eh=function(t){try{return g_('"use strict"; return ('+t+").constructor;")()}catch{}},ia=h_,gC=UA,th=function(){throw new bs},yC=ia?function(){try{return arguments.callee,th}catch{try{return ia(arguments,"callee").get}catch{return th}}}():th,zi=zA()(),it=tC(),xC=f_(),vC=d_(),y_=p_(),pa=Bp(),Ki={},_C=typeof Uint8Array>"u"||!it?me:it(Uint8Array),gi={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?me:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?me:ArrayBuffer,"%ArrayIteratorPrototype%":zi&&it?it([][Symbol.iterator]()):me,"%AsyncFromSyncIteratorPrototype%":me,"%AsyncFunction%":Ki,"%AsyncGenerator%":Ki,"%AsyncGeneratorFunction%":Ki,"%AsyncIteratorPrototype%":Ki,"%Atomics%":typeof Atomics>"u"?me:Atomics,"%BigInt%":typeof BigInt>"u"?me:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?me:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?me:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?me:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":iC,"%eval%":eval,"%EvalError%":sC,"%Float16Array%":typeof Float16Array>"u"?me:Float16Array,"%Float32Array%":typeof Float32Array>"u"?me:Float32Array,"%Float64Array%":typeof Float64Array>"u"?me:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?me:FinalizationRegistry,"%Function%":g_,"%GeneratorFunction%":Ki,"%Int8Array%":typeof Int8Array>"u"?me:Int8Array,"%Int16Array%":typeof Int16Array>"u"?me:Int16Array,"%Int32Array%":typeof Int32Array>"u"?me:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":zi&&it?it(it([][Symbol.iterator]())):me,"%JSON%":typeof JSON=="object"?JSON:me,"%Map%":typeof Map>"u"?me:Map,"%MapIteratorPrototype%":typeof Map>"u"||!zi||!it?me:it(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":nC,"%Object.getOwnPropertyDescriptor%":ia,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?me:Promise,"%Proxy%":typeof Proxy>"u"?me:Proxy,"%RangeError%":oC,"%ReferenceError%":aC,"%Reflect%":typeof Reflect>"u"?me:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?me:Set,"%SetIteratorPrototype%":typeof Set>"u"||!zi||!it?me:it(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?me:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":zi&&it?it(""[Symbol.iterator]()):me,"%Symbol%":zi?Symbol:me,"%SyntaxError%":js,"%ThrowTypeError%":yC,"%TypedArray%":_C,"%TypeError%":bs,"%Uint8Array%":typeof Uint8Array>"u"?me:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?me:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?me:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?me:Uint32Array,"%URIError%":lC,"%WeakMap%":typeof WeakMap>"u"?me:WeakMap,"%WeakRef%":typeof WeakRef>"u"?me:WeakRef,"%WeakSet%":typeof WeakSet>"u"?me:WeakSet,"%Function.prototype.call%":pa,"%Function.prototype.apply%":y_,"%Object.defineProperty%":gC,"%Object.getPrototypeOf%":xC,"%Math.abs%":cC,"%Math.floor%":uC,"%Math.max%":hC,"%Math.min%":dC,"%Math.pow%":fC,"%Math.round%":pC,"%Math.sign%":mC,"%Reflect.getPrototypeOf%":vC};if(it)try{null.error}catch(t){var wC=it(it(t));gi["%Error.prototype%"]=wC}var SC=function t(e){var r;if(e==="%AsyncFunction%")r=eh("async function () {}");else if(e==="%GeneratorFunction%")r=eh("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=eh("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&it&&(r=it(i.prototype))}return gi[e]=r,r},ay={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ma=Wc(),lc=rC(),bC=ma.call(pa,Array.prototype.concat),EC=ma.call(y_,Array.prototype.splice),ly=ma.call(pa,String.prototype.replace),cc=ma.call(pa,String.prototype.slice),TC=ma.call(pa,RegExp.prototype.exec),AC=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,CC=/\\(\\)?/g,RC=function(e){var r=cc(e,0,1),n=cc(e,-1);if(r==="%"&&n!=="%")throw new js("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new js("invalid intrinsic syntax, expected opening `%`");var i=[];return ly(e,AC,function(s,o,a,l){i[i.length]=a?ly(l,CC,"$1"):o||s}),i},PC=function(e,r){var n=e,i;if(lc(ay,n)&&(i=ay[n],n="%"+i[0]+"%"),lc(gi,n)){var s=gi[n];if(s===Ki&&(s=SC(n)),typeof s>"u"&&!r)throw new bs("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new js("intrinsic "+e+" does not exist!")},Np=function(e,r){if(typeof e!="string"||e.length===0)throw new bs("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new bs('"allowMissing" argument must be a boolean');if(TC(/^%?[^%]*%?$/,e)===null)throw new js("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=RC(e),i=n.length>0?n[0]:"",s=PC("%"+i+"%",r),o=s.name,a=s.value,l=!1,c=s.alias;c&&(i=c[0],EC(n,bC([0,1],c)));for(var h=1,d=!0;h<n.length;h+=1){var f=n[h],p=cc(f,0,1),g=cc(f,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new js("property names with quotes must have matching quotes");if((f==="constructor"||!d)&&(l=!0),i+="."+f,o="%"+i+"%",lc(gi,o))a=gi[o];else if(a!=null){if(!(f in a)){if(!r)throw new bs("base intrinsic for "+e+" exists, but the property is not available.");return}if(ia&&h+1>=n.length){var v=ia(a,f);d=!!v,d&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else d=lc(a,f),a=a[f];d&&!l&&(gi[o]=a)}}return a},x_=Np,v_=m_,IC=v_([x_("%String.prototype.indexOf%")]),__=function(e,r){var n=x_(e,!!r);return typeof n=="function"&&IC(e,".prototype.")>-1?v_([n]):n},kC=Np,ga=__,MC=$c,BC=Vs,cy=kC("%Map%",!0),NC=ga("Map.prototype.get",!0),LC=ga("Map.prototype.set",!0),FC=ga("Map.prototype.has",!0),DC=ga("Map.prototype.delete",!0),jC=ga("Map.prototype.size",!0),w_=!!cy&&function(){var e,r={assert:function(n){if(!r.has(n))throw new BC("Side channel does not contain "+MC(n))},delete:function(n){if(e){var i=DC(e,n);return jC(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return NC(e,n)},has:function(n){return e?FC(e,n):!1},set:function(n,i){e||(e=new cy),LC(e,n,i)}};return r},OC=Np,Xc=__,UC=$c,Ha=w_,GC=Vs,Hi=OC("%WeakMap%",!0),zC=Xc("WeakMap.prototype.get",!0),HC=Xc("WeakMap.prototype.set",!0),$C=Xc("WeakMap.prototype.has",!0),VC=Xc("WeakMap.prototype.delete",!0),WC=Hi?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new GC("Side channel does not contain "+UC(i))},delete:function(i){if(Hi&&i&&(typeof i=="object"||typeof i=="function")){if(e)return VC(e,i)}else if(Ha&&r)return r.delete(i);return!1},get:function(i){return Hi&&i&&(typeof i=="object"||typeof i=="function")&&e?zC(e,i):r&&r.get(i)},has:function(i){return Hi&&i&&(typeof i=="object"||typeof i=="function")&&e?$C(e,i):!!r&&r.has(i)},set:function(i,s){Hi&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new Hi),HC(e,i,s)):Ha&&(r||(r=Ha()),r.set(i,s))}};return n}:Ha,XC=Vs,YC=$c,KC=bA,qC=w_,QC=WC,ZC=QC||qC||KC,S_=function(){var e,r={assert:function(n){if(!r.has(n))throw new XC("Side channel does not contain "+YC(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=ZC()),e.set(n,i)}};return r},JC=String.prototype.replace,e2=/%20/g,rh={RFC1738:"RFC1738",RFC3986:"RFC3986"},Lp={default:rh.RFC3986,formatters:{RFC1738:function(t){return JC.call(t,e2,"+")},RFC3986:function(t){return String(t)}},RFC1738:rh.RFC1738,RFC3986:rh.RFC3986},t2=Lp,r2=S_,nh=Object.prototype.hasOwnProperty,ci=Array.isArray,Yc=r2(),b_=function(e,r){return Yc.set(e,r),e},uc=function(e){return Yc.has(e)},Gd=function(e){return Yc.get(e)},E_=function(e,r){Yc.set(e,r)},wr=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),n2=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(ci(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]<"u"&&i.push(n[s]);r.obj[r.prop]=i}}},Fp=function(e,r){for(var n=r&&r.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},i2=function t(e,r,n){if(!r)return e;if(typeof r!="object"&&typeof r!="function"){if(ci(e))e.push(r);else if(e&&typeof e=="object")if(uc(e)){var i=Gd(e)+1;e[i]=r,E_(e,i)}else(n&&(n.plainObjects||n.allowPrototypes)||!nh.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object"){if(uc(r)){for(var s=Object.keys(r),o=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},a=0;a<s.length;a++){var l=parseInt(s[a],10);o[l+1]=r[s[a]]}return b_(o,Gd(r)+1)}return[e].concat(r)}var c=e;return ci(e)&&!ci(r)&&(c=Fp(e,n)),ci(e)&&ci(r)?(r.forEach(function(h,d){if(nh.call(e,d)){var f=e[d];f&&typeof f=="object"&&h&&typeof h=="object"?e[d]=t(f,h,n):e.push(h)}else e[d]=h}),e):Object.keys(r).reduce(function(h,d){var f=r[d];return nh.call(h,d)?h[d]=t(h[d],f,n):h[d]=f,h},c)},s2=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},o2=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},ih=1024,a2=function(e,r,n,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(p){return"%26%23"+parseInt(p.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;l+=ih){for(var c=o.length>=ih?o.slice(l,l+ih):o,h=[],d=0;d<c.length;++d){var f=c.charCodeAt(d);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||s===t2.RFC1738&&(f===40||f===41)){h[h.length]=c.charAt(d);continue}if(f<128){h[h.length]=wr[f];continue}if(f<2048){h[h.length]=wr[192|f>>6]+wr[128|f&63];continue}if(f<55296||f>=57344){h[h.length]=wr[224|f>>12]+wr[128|f>>6&63]+wr[128|f&63];continue}d+=1,f=65536+((f&1023)<<10|c.charCodeAt(d)&1023),h[h.length]=wr[240|f>>18]+wr[128|f>>12&63]+wr[128|f>>6&63]+wr[128|f&63]}a+=h.join("")}return a},l2=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var c=a[l],h=o[c];typeof h=="object"&&h!==null&&n.indexOf(h)===-1&&(r.push({obj:o,prop:c}),n.push(h))}return n2(r),e},c2=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},u2=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},h2=function(e,r,n,i){if(uc(e)){var s=Gd(e)+1;return e[s]=r,E_(e,s),e}var o=[].concat(e,r);return o.length>n?b_(Fp(o,{plainObjects:i}),o.length-1):o},d2=function(e,r){if(ci(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},T_={arrayToObject:Fp,assign:s2,combine:h2,compact:l2,decode:o2,encode:a2,isBuffer:u2,isOverflow:uc,isRegExp:c2,maybeMap:d2,merge:i2},A_=S_,El=T_,No=Lp,f2=Object.prototype.hasOwnProperty,C_={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Pr=Array.isArray,p2=Array.prototype.push,R_=function(t,e){p2.apply(t,Pr(e)?e:[e])},m2=Date.prototype.toISOString,uy=No.default,Ze={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:El.encode,encodeValuesOnly:!1,filter:void 0,format:uy,formatter:No.formatters[uy],indices:!1,serializeDate:function(e){return m2.call(e)},skipNulls:!1,strictNullHandling:!1},g2=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},sh={},y2=function t(e,r,n,i,s,o,a,l,c,h,d,f,p,g,v,_,y,x){for(var m=e,w=x,b=0,T=!1;(w=w.get(sh))!==void 0&&!T;){var A=w.get(e);if(b+=1,typeof A<"u"){if(A===b)throw new RangeError("Cyclic object value");T=!0}typeof w.get(sh)>"u"&&(b=0)}if(typeof h=="function"?m=h(r,m):m instanceof Date?m=p(m):n==="comma"&&Pr(m)&&(m=El.maybeMap(m,function(k){return k instanceof Date?p(k):k})),m===null){if(o)return c&&!_?c(r,Ze.encoder,y,"key",g):r;m=""}if(g2(m)||El.isBuffer(m)){if(c){var S=_?r:c(r,Ze.encoder,y,"key",g);return[v(S)+"="+v(c(m,Ze.encoder,y,"value",g))]}return[v(r)+"="+v(String(m))]}var R=[];if(typeof m>"u")return R;var I;if(n==="comma"&&Pr(m))_&&c&&(m=El.maybeMap(m,c)),I=[{value:m.length>0?m.join(",")||null:void 0}];else if(Pr(h))I=h;else{var L=Object.keys(m);I=d?L.sort(d):L}var B=l?String(r).replace(/\./g,"%2E"):String(r),C=i&&Pr(m)&&m.length===1?B+"[]":B;if(s&&Pr(m)&&m.length===0)return C+"[]";for(var N=0;N<I.length;++N){var O=I[N],D=typeof O=="object"&&O&&typeof O.value<"u"?O.value:m[O];if(!(a&&D===null)){var j=f&&l?String(O).replace(/\./g,"%2E"):String(O),M=Pr(m)?typeof n=="function"?n(C,j):C:C+(f?"."+j:"["+j+"]");x.set(e,b);var G=A_();G.set(sh,x),R_(R,t(D,M,n,i,s,o,a,l,n==="comma"&&_&&Pr(m)?null:c,h,d,f,p,g,v,_,y,G))}}return R},x2=function(e){if(!e)return Ze;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||Ze.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=No.default;if(typeof e.format<"u"){if(!f2.call(No.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=No.formatters[n],s=Ze.filter;(typeof e.filter=="function"||Pr(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in C_?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=Ze.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Ze.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ze.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ze.allowEmptyArrays,arrayFormat:o,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ze.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Ze.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ze.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Ze.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Ze.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ze.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ze.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ze.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ze.strictNullHandling}},v2=function(t,e){var r=t,n=x2(e),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):Pr(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var a=C_[n.arrayFormat],l=a==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var c=A_(),h=0;h<i.length;++h){var d=i[h],f=r[d];n.skipNulls&&f===null||R_(o,y2(f,d,a,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}var p=o.join(n.delimiter),g=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?g+="utf8=%26%2310003%3B&":g+="utf8=%E2%9C%93&"),p.length>0?g+p:""},$n=T_,Tl=Object.prototype.hasOwnProperty,hy=Array.isArray,$e={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:$n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},_2=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},P_=function(t,e,r){if(t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&r>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return t},w2="utf8=%26%2310003%3B",S2="utf8=%E2%9C%93",b2=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,r.throwOnLimitExceeded?s+1:s);if(r.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,l,c=r.charset;if(r.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===S2?c="utf-8":o[l]===w2&&(c="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var h=o[l],d=h.indexOf("]="),f=d===-1?h.indexOf("="):d+1,p,g;if(f===-1?(p=r.decoder(h,$e.decoder,c,"key"),g=r.strictNullHandling?null:""):(p=r.decoder(h.slice(0,f),$e.decoder,c,"key"),p!==null&&(g=$n.maybeMap(P_(h.slice(f+1),r,hy(n[p])?n[p].length:0),function(_){return r.decoder(_,$e.decoder,c,"value")}))),g&&r.interpretNumericEntities&&c==="iso-8859-1"&&(g=_2(String(g))),h.indexOf("[]=")>-1&&(g=hy(g)?[g]:g),p!==null){var v=Tl.call(n,p);v&&r.duplicates==="combine"?n[p]=$n.combine(n[p],g,r.arrayLimit,r.plainObjects):(!v||r.duplicates==="last")&&(n[p]=g)}}return n},E2=function(t,e,r,n){var i=0;if(t.length>0&&t[t.length-1]==="[]"){var s=t.slice(0,-1).join("");i=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=n?e:P_(e,r,i),a=t.length-1;a>=0;--a){var l,c=t[a];if(c==="[]"&&r.parseArrays)$n.isOverflow(o)?l=o:l=r.allowEmptyArrays&&(o===""||r.strictNullHandling&&o===null)?[]:$n.combine([],o,r.arrayLimit,r.plainObjects);else{l=r.plainObjects?{__proto__:null}:{};var h=c.charAt(0)==="["&&c.charAt(c.length-1)==="]"?c.slice(1,-1):c,d=r.decodeDotInKeys?h.replace(/%2E/g,"."):h,f=parseInt(d,10);!r.parseArrays&&d===""?l={0:o}:!isNaN(f)&&c!==d&&String(f)===d&&f>=0&&r.parseArrays&&f<=r.arrayLimit?(l=[],l[f]=o):d!=="__proto__"&&(l[d]=o)}o=l}return o},T2=function(e,r){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e;if(r.depth<=0)return!r.plainObjects&&Tl.call(Object.prototype,n)&&!r.allowPrototypes?void 0:[n];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(n),a=o?n.slice(0,o.index):n,l=[];if(a){if(!r.plainObjects&&Tl.call(Object.prototype,a)&&!r.allowPrototypes)return;l.push(a)}for(var c=0;(o=s.exec(n))!==null&&c<r.depth;){c+=1;var h=o[1].slice(1,-1);if(!r.plainObjects&&Tl.call(Object.prototype,h)&&!r.allowPrototypes)return;l.push(o[1])}if(o){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");l.push("["+n.slice(o.index)+"]")}return l},A2=function(e,r,n,i){if(e){var s=T2(e,n);if(s)return E2(s,r,n,i)}},C2=function(e){if(!e)return $e;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=typeof e.charset>"u"?$e.charset:e.charset,n=typeof e.duplicates>"u"?$e.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:$e.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:$e.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:$e.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:$e.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:$e.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:$e.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:$e.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:$e.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:$e.decoder,delimiter:typeof e.delimiter=="string"||$n.isRegExp(e.delimiter)?e.delimiter:$e.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:$e.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:$e.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:$e.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:$e.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:$e.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:$e.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},R2=function(t,e){var r=C2(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?{__proto__:null}:{};for(var n=typeof t=="string"?b2(t,r):t,i=r.plainObjects?{__proto__:null}:{},s=Object.keys(n),o=0;o<s.length;++o){var a=s[o],l=A2(a,n[a],r,typeof t=="string");i=$n.merge(i,l,r)}return r.allowSparse===!0?i:$n.compact(i)},P2=v2,I2=R2,k2=Lp,M2={formats:k2,parse:I2,stringify:P2},B2=OT;function en(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var N2=/^([a-z0-9.+-]+:)/i,L2=/:[0-9]*$/,F2=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,D2=["<",">",'"',"`"," ","\r",`
`,"	"],j2=["{","}","|","\\","^","`"].concat(D2),zd=["'"].concat(j2),dy=["%","/","?",";","#"].concat(zd),fy=["/","?","#"],O2=255,py=/^[+a-z0-9A-Z_-]{0,63}$/,U2=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,G2={javascript:!0,"javascript:":!0},Hd={javascript:!0,"javascript:":!0},Es={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},$d=M2;function z2(t,e,r){if(t&&typeof t=="object"&&t instanceof en)return t;var n=new en;return n.parse(t,e,r),n}en.prototype.parse=function(t,e,r){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var a=t;if(a=a.trim(),!r&&t.split("#").length===1){var l=F2.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=$d.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var c=N2.exec(a);if(c){c=c[0];var h=c.toLowerCase();this.protocol=h,a=a.substr(c.length)}if(r||c||a.match(/^\/\/[^@/]+@[^@/]+/)){var d=a.substr(0,2)==="//";d&&!(c&&Hd[c])&&(a=a.substr(2),this.slashes=!0)}if(!Hd[c]&&(d||c&&!Es[c])){for(var f=-1,p=0;p<fy.length;p++){var g=a.indexOf(fy[p]);g!==-1&&(f===-1||g<f)&&(f=g)}var v,_;f===-1?_=a.lastIndexOf("@"):_=a.lastIndexOf("@",f),_!==-1&&(v=a.slice(0,_),a=a.slice(_+1),this.auth=decodeURIComponent(v)),f=-1;for(var p=0;p<dy.length;p++){var g=a.indexOf(dy[p]);g!==-1&&(f===-1||g<f)&&(f=g)}f===-1&&(f=a.length),this.host=a.slice(0,f),a=a.slice(f),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var x=this.hostname.split(/\./),p=0,m=x.length;p<m;p++){var w=x[p];if(w&&!w.match(py)){for(var b="",T=0,A=w.length;T<A;T++)w.charCodeAt(T)>127?b+="x":b+=w[T];if(!b.match(py)){var S=x.slice(0,p),R=x.slice(p+1),I=w.match(U2);I&&(S.push(I[1]),R.unshift(I[2])),R.length&&(a="/"+R.join(".")+a),this.hostname=S.join(".");break}}}this.hostname.length>O2?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=B2.toASCII(this.hostname));var L=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+L,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!G2[h])for(var p=0,m=zd.length;p<m;p++){var C=zd[p];if(a.indexOf(C)!==-1){var N=encodeURIComponent(C);N===C&&(N=escape(C)),a=a.split(C).join(N)}}var O=a.indexOf("#");O!==-1&&(this.hash=a.substr(O),a=a.slice(0,O));var D=a.indexOf("?");if(D!==-1?(this.search=a.substr(D),this.query=a.substr(D+1),e&&(this.query=$d.parse(this.query)),a=a.slice(0,D)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Es[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",j=this.search||"";this.path=L+j}return this.href=this.format(),this};en.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=$d.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Es[e])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+r+o+n};en.prototype.resolve=function(t){return this.resolveObject(z2(t,!1,!0)).format()};en.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new en;e.parse(t,!1,!0),t=e}for(var r=new en,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(r[l]=t[l])}return Es[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Es[t.protocol]){for(var c=Object.keys(t),h=0;h<c.length;h++){var d=c[h];r[d]=t[d]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!Hd[t.protocol]){for(var m=(t.pathname||"").split("/");m.length&&!(t.host=m.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),m[0]!==""&&m.unshift(""),m.length<2&&m.unshift(""),r.pathname=m.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var f=r.pathname||"",p=r.search||"";r.path=f+p}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var g=r.pathname&&r.pathname.charAt(0)==="/",v=t.host||t.pathname&&t.pathname.charAt(0)==="/",_=v||g||r.host&&t.pathname,y=_,x=r.pathname&&r.pathname.split("/")||[],m=t.pathname&&t.pathname.split("/")||[],w=r.protocol&&!Es[r.protocol];if(w&&(r.hostname="",r.port=null,r.host&&(x[0]===""?x[0]=r.host:x.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(m[0]===""?m[0]=t.host:m.unshift(t.host)),t.host=null),_=_&&(m[0]===""||x[0]==="")),v)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,x=m;else if(m.length)x||(x=[]),x.pop(),x=x.concat(m),r.search=t.search,r.query=t.query;else if(t.search!=null){if(w){r.host=x.shift(),r.hostname=r.host;var b=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;b&&(r.auth=b.shift(),r.hostname=b.shift(),r.host=r.hostname)}return r.search=t.search,r.query=t.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!x.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=x.slice(-1)[0],A=(r.host||t.host||x.length>1)&&(T==="."||T==="..")||T==="",S=0,R=x.length;R>=0;R--)T=x[R],T==="."?x.splice(R,1):T===".."?(x.splice(R,1),S++):S&&(x.splice(R,1),S--);if(!_&&!y)for(;S--;S)x.unshift("..");_&&x[0]!==""&&(!x[0]||x[0].charAt(0)!=="/")&&x.unshift(""),A&&x.join("/").substr(-1)!=="/"&&x.push("");var I=x[0]===""||x[0]&&x[0].charAt(0)==="/";if(w){r.hostname=I?"":x.length?x.shift():"",r.host=r.hostname;var b=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;b&&(r.auth=b.shift(),r.hostname=b.shift(),r.host=r.hostname)}return _=_||r.host&&x.length,_&&!I&&x.unshift(""),x.length>0?r.pathname=x.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};en.prototype.parseHost=function(){var t=this.host,e=L2.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const my={};function ge(t,e,r=3){if(my[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),my[e]=!0}function or(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function io(t){return t.split("?")[0].split("#")[0]}function H2(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function $2(t,e,r){return t.replace(new RegExp(H2(e),"g"),r)}function V2(t,e){let r="",n=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),i=a,s=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=a,s=0;continue}}}else r.length>0?r+=`/${t.slice(i+1,a)}`:r=t.slice(i+1,a),n=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return r}const lt={toPosix(t){return $2(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){or(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(or(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=io(this.toPosix(e??X.ADAPTER.getBaseUrl())),i=io(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?lt.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(or(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=V2(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return or(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(or(n),n.length>0)if(e===void 0)e=n;else{const i=t[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(or(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){n=a;break}}else i=!1;return n===-1?r?"/":this.isUrl(o)?s+t:s:r&&n===1?"//":s+t.slice(0,n)},rootname(t){or(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){or(t),e&&or(e),t=io(this.toPosix(t));let r=0,n=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const l=t.charCodeAt(s);if(l===47){if(!i){r=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return r===n?n=a:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){r=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){or(t),t=io(this.toPosix(t));let e=-1,r=0,n=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){r=o+1;break}continue}n===-1&&(i=!1,n=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){or(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=io(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let i;e.root=this.rootname(t),n||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,a=-1,l=!0,c=t.length-1,h=0;for(;c>=i;--c){if(r=t.charCodeAt(c),r===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===46?s===-1?s=c:h!==1&&(h=1):s!==-1&&(h=-1)}return s===-1||a===-1||h===0||h===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&n?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&n?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let oh;async function W2(){return oh??(oh=(async()=>{var s;const t=document.createElement("canvas").getContext("webgl");if(!t)return Pt.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return Pt.UNPACK;const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(s=t.getExtension("WEBGL_lose_context"))==null||s.loseContext(),i[0]<=i[3]?Pt.PMA:Pt.UNPACK})()),oh}let ah;function X2(){return typeof ah>"u"&&(ah=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:X.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!X.ADAPTER.getWebGLRenderingContext())return!1;const r=X.ADAPTER.createCanvas();let n=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,i}catch{return!1}}()),ah}var Y2={grad:.9,turn:360,rad:360/(2*Math.PI)},Hr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},ot=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Jt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},I_=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},gy=function(t){return{r:Jt(t.r,0,255),g:Jt(t.g,0,255),b:Jt(t.b,0,255),a:Jt(t.a)}},lh=function(t){return{r:ot(t.r),g:ot(t.g),b:ot(t.b),a:ot(t.a,3)}},K2=/^#([0-9a-f]{3,8})$/i,$a=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},k_=function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=Math.max(e,r,n),o=s-Math.min(e,r,n),a=o?s===e?(r-n)/o:s===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},M_=function(t){var e=t.h,r=t.s,n=t.v,i=t.a;e=e/360*6,r/=100,n/=100;var s=Math.floor(e),o=n*(1-r),a=n*(1-(e-s)*r),l=n*(1-(1-e+s)*r),c=s%6;return{r:255*[n,a,o,o,l,n][c],g:255*[l,n,n,a,o,o][c],b:255*[o,o,l,n,n,a][c],a:i}},yy=function(t){return{h:I_(t.h),s:Jt(t.s,0,100),l:Jt(t.l,0,100),a:Jt(t.a)}},xy=function(t){return{h:ot(t.h),s:ot(t.s),l:ot(t.l),a:ot(t.a,3)}},vy=function(t){return M_((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},Lo=function(t){return{h:(e=k_(t)).h,s:(i=(200-(r=e.s))*(n=e.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,r,n,i},q2=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Q2=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Z2=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,J2=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Vd={string:[[function(t){var e=K2.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?ot(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?ot(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=Z2.exec(t)||J2.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:gy({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=q2.exec(t)||Q2.exec(t);if(!e)return null;var r,n,i=yy({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(Y2[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return vy(i)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=i===void 0?1:i;return Hr(e)&&Hr(r)&&Hr(n)?gy({r:Number(e),g:Number(r),b:Number(n),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,i=t.a,s=i===void 0?1:i;if(!Hr(e)||!Hr(r)||!Hr(n))return null;var o=yy({h:Number(e),s:Number(r),l:Number(n),a:Number(s)});return vy(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,i=t.a,s=i===void 0?1:i;if(!Hr(e)||!Hr(r)||!Hr(n))return null;var o=function(a){return{h:I_(a.h),s:Jt(a.s,0,100),v:Jt(a.v,0,100),a:Jt(a.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(s)});return M_(o)},"hsv"]]},_y=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},eR=function(t){return typeof t=="string"?_y(t.trim(),Vd.string):typeof t=="object"&&t!==null?_y(t,Vd.object):[null,void 0]},ch=function(t,e){var r=Lo(t);return{h:r.h,s:Jt(r.s+100*e,0,100),l:r.l,a:r.a}},uh=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},wy=function(t,e){var r=Lo(t);return{h:r.h,s:r.s,l:Jt(r.l+100*e,0,100),a:r.a}},Wd=function(){function t(e){this.parsed=eR(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return ot(uh(this.rgba),2)},t.prototype.isDark=function(){return uh(this.rgba)<.5},t.prototype.isLight=function(){return uh(this.rgba)>=.5},t.prototype.toHex=function(){return e=lh(this.rgba),r=e.r,n=e.g,i=e.b,o=(s=e.a)<1?$a(ot(255*s)):"","#"+$a(r)+$a(n)+$a(i)+o;var e,r,n,i,s,o},t.prototype.toRgb=function(){return lh(this.rgba)},t.prototype.toRgbString=function(){return e=lh(this.rgba),r=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+r+", "+n+", "+i+", "+s+")":"rgb("+r+", "+n+", "+i+")";var e,r,n,i,s},t.prototype.toHsl=function(){return xy(Lo(this.rgba))},t.prototype.toHslString=function(){return e=xy(Lo(this.rgba)),r=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+r+", "+n+"%, "+i+"%, "+s+")":"hsl("+r+", "+n+"%, "+i+"%)";var e,r,n,i,s},t.prototype.toHsv=function(){return e=k_(this.rgba),{h:ot(e.h),s:ot(e.s),v:ot(e.v),a:ot(e.a,3)};var e},t.prototype.invert=function(){return br({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),br(ch(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),br(ch(this.rgba,-e))},t.prototype.grayscale=function(){return br(ch(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),br(wy(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),br(wy(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?br({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):ot(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=Lo(this.rgba);return typeof e=="number"?br({h:e,s:r.s,l:r.l,a:r.a}):ot(r.h)},t.prototype.isEqual=function(e){return this.toHex()===br(e).toHex()},t}(),br=function(t){return t instanceof Wd?t:new Wd(t)},Sy=[],tR=function(t){t.forEach(function(e){Sy.indexOf(e)<0&&(e(Wd,Vd),Sy.push(e))})};function rR(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=n[this.toHex()];if(c)return c;if(o!=null&&o.closest){var h=this.toRgb(),d=1/0,f="black";if(!s.length)for(var p in r)s[p]=new t(r[p]).toRgb();for(var g in r){var v=(a=h,l=s[g],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));v<d&&(d=v,f=g)}return f}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}tR([rR]);const qi=class Al{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Al)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,s)=>i===r[s]);if(e!==null&&r!==null){const i=Object.keys(e),s=Object.keys(r);return i.length!==s.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,n,i]=this._components;return{r:e,g:r,b:n,a:i}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,i]=this._components;return e=e??[],e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[r,n,i]=this._components;return e[0]=r,e[1]=n,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,i,s]=Al.temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return r&&(n=n*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[r,n,i]=this._components;return this._components[0]=Math.round(r*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[r,n,i,s]=this._components;return e[0]=r,e[1]=n,e[2]=i,e[3]=s,e}normalize(e){let r,n,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,i,s=255]=e,r/=255,n/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Al.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=br(e);o.isValid()&&({r,g:n,b:i,a:s}=o.rgba,r/=255,n/=255,i/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,r),n)}),e)}};qi.shared=new qi,qi.temp=new qi,qi.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Me=qi;function nR(t){return ge("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Me.shared.setValue(t).toHex()}function iR(t){return ge("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Me.shared.setValue(t).toNumber()}function sR(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[se.NORMAL_NPM]=se.NORMAL,t[se.ADD_NPM]=se.ADD,t[se.SCREEN_NPM]=se.SCREEN,e[se.NORMAL]=se.NORMAL_NPM,e[se.ADD]=se.ADD_NPM,e[se.SCREEN]=se.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}const B_=sR();function N_(t,e){return B_[e?1:0][t]}function oR(t,e=null){const r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let n=0,i=0;n<r;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function L_(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function hc(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function by(t){return!(t&t-1)&&!!t}function Ey(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function Ts(t,e,r){const n=t.length;let i;if(e>=n||r===0)return;r=e+r>n?n-e:r;const s=n-r;for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}function In(t){return t===0?0:t<0?-1:1}let aR=0;function Ti(){return++aR}const Xd=class{constructor(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Xd.EMPTY=new Xd(0,0,0,0);let Ty=Xd;const Ay={},Er=Object.create(null),gn=Object.create(null);class lR{constructor(e,r,n){this._canvas=X.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||X.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Cy(t,e,r){for(let n=0,i=4*r*e;n<e;++n,i+=4)if(t[i+3]!==0)return!1;return!0}function Ry(t,e,r,n,i){const s=4*e;for(let o=n,a=n*s+4*r;o<=i;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function cR(t){const{width:e,height:r}=t,n=t.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,e,r).data;let s=0,o=0,a=e-1,l=r-1;for(;o<r&&Cy(i,e,o);)++o;if(o===r)return Ty.EMPTY;for(;Cy(i,e,l);)--l;for(;Ry(i,e,s,o,l);)++s;for(;Ry(i,e,a,o,l);)--a;return++a,++l,new Ty(s,o,a,l)}function uR(t){const e=cR(t),{width:r,height:n}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,r,n)}return{width:r,height:n,data:i}}function hR(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}function on(t,e=1){var n;const r=(n=X.RETINA_PREFIX)==null?void 0:n.exec(t);return r?parseFloat(r[1]):e}var V=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(V||{});const Yd=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Py=(t,e)=>Yd(t).priority??e,J={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Yd).forEach(e=>{e.type.forEach(r=>{var n,i;return(i=(n=this._removeHandlers)[r])==null?void 0:i.call(n,e)})}),this},add(...t){return t.map(Yd).forEach(e=>{e.type.forEach(r=>{var s,o;const n=this._addHandlers,i=this._queue;n[r]?(s=n[r])==null||s.call(n,e):(i[r]=i[r]||[],(o=i[r])==null||o.push(e))})}),this},handle(t,e,r){var o;const n=this._addHandlers,i=this._removeHandlers;if(n[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,i[t]=r;const s=this._queue;return s[t]&&((o=s[t])==null||o.forEach(a=>e(a)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,s)=>Py(s,r)-Py(i,r)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}};class Kd{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const dR=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function fR(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function pR(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=dR.replace(/%forloop%/gi,fR(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}const hh=0,dh=1,fh=2,ph=3,mh=4,gh=5;class Or{constructor(){this.data=0,this.blendMode=se.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<hh)}set blend(e){!!(this.data&1<<hh)!==e&&(this.data^=1<<hh)}get offsets(){return!!(this.data&1<<dh)}set offsets(e){!!(this.data&1<<dh)!==e&&(this.data^=1<<dh)}get culling(){return!!(this.data&1<<fh)}set culling(e){!!(this.data&1<<fh)!==e&&(this.data^=1<<fh)}get depthTest(){return!!(this.data&1<<ph)}set depthTest(e){!!(this.data&1<<ph)!==e&&(this.data^=1<<ph)}get depthMask(){return!!(this.data&1<<gh)}set depthMask(e){!!(this.data&1<<gh)!==e&&(this.data^=1<<gh)}get clockwiseFrontFace(){return!!(this.data&1<<mh)}set clockwiseFrontFace(e){!!(this.data&1<<mh)!==e&&(this.data^=1<<mh)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==se.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Or;return e.depthTest=!1,e.blend=!0,e}}Or.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const qd=[];function F_(t,e){if(!t)return null;let r="";if(typeof t=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(let n=qd.length-1;n>=0;--n){const i=qd[n];if(i.test&&i.test(t,r))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class gr{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,n,i,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:c,items:h}=this;this._aliasCount++;for(let d=0,f=h.length;d<f;d++)h[d][c](e,r,n,i,s,o,a,l);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(gr.prototype,{dispatch:{value:gr.prototype.emit},run:{value:gr.prototype.emit}});class sa{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new gr("setRealSize"),this.onUpdate=new gr("update"),this.onError=new gr("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}}class Kc extends sa{constructor(e,r){const{width:n,height:i}=r||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=e,this.unpackAlignment=r.unpackAlignment??4}upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Pt.UNPACK);const s=r.realWidth,o=r.realHeight;return n.width===s&&n.height===o?i.texSubImage2D(r.target,0,0,0,s,o,r.format,n.type,this.data):(n.width=s,n.height=o,i.texImage2D(r.target,0,n.internalFormat,s,o,0,r.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const mR={scaleMode:Kr.NEAREST,alphaMode:Pt.NPM},Qd=class Qi extends fa{constructor(e=null,r=null){super(),r=Object.assign({},Qi.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:c,format:h,type:d,target:f,resolution:p,resourceOptions:g}=r;e&&!(e instanceof sa)&&(e=F_(e,g),e.internal=!0),this.resolution=p||X.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=c,this._scaleMode=o,this.format=h,this.type=d,this.target=f,this.alphaMode=n,this.uid=Ti(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,r){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,n=!0),n&&this.dirtyStyleId++,this}setSize(e,r,n){return n=n||this.resolution,this.setRealSize(e*n,r*n,n)}setRealSize(e,r,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(r)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=by(this.realWidth)&&by(this.realHeight)}setResolution(e){const r=this.resolution;return r===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*r)/e,this.height=Math.round(this.height*r)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete gn[this.cacheId],delete Er[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Qi.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,r,n=X.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Ti()}`}s=e._pixiId}let o=gn[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new Qi(e,r),o.cacheId=s,Qi.addToCache(o,s)),o}static fromBuffer(e,r,n,i){e=e||new Float32Array(r*n*4);const s=new Kc(e,{width:r,height:n,...i==null?void 0:i.resourceOptions});let o,a;return e instanceof Float32Array?(o=$.RGBA,a=te.FLOAT):e instanceof Int32Array?(o=$.RGBA_INTEGER,a=te.INT):e instanceof Uint32Array?(o=$.RGBA_INTEGER,a=te.UNSIGNED_INT):e instanceof Int16Array?(o=$.RGBA_INTEGER,a=te.SHORT):e instanceof Uint16Array?(o=$.RGBA_INTEGER,a=te.UNSIGNED_SHORT):e instanceof Int8Array?(o=$.RGBA,a=te.BYTE):(o=$.RGBA,a=te.UNSIGNED_BYTE),s.internal=!0,new Qi(s,Object.assign({},mR,{type:a,format:o},i))}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),gn[r]&&gn[r]!==e&&console.warn(`BaseTexture added to the cache with an id [${r}] that already had an entry`),gn[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=gn[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete gn[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)delete gn[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}};Qd.defaultOptions={mipmap:jr.POW2,anisotropicLevel:0,scaleMode:Kr.LINEAR,wrapMode:Gn.CLAMP,alphaMode:Pt.UNPACK,target:Ss.TEXTURE_2D,format:$.RGBA,type:te.UNSIGNED_BYTE},Qd._globalBatch=0;let he=Qd;class Zd{constructor(){this.texArray=null,this.blend=0,this.type=Br.TRIANGLES,this.start=0,this.size=0,this.data=null}}let gR=0;class We{constructor(e,r=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=r,this.id=gR++,this.disposeRunner=new gr("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Fr.ELEMENT_ARRAY_BUFFER:Fr.ARRAY_BUFFER}get index(){return this.type===Fr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new We(e)}}class dc{constructor(e,r=0,n=!1,i=te.FLOAT,s,o,a,l=1){this.buffer=e,this.size=r,this.normalized=n,this.type=i,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,r,n,i,s){return new dc(e,r,n,i,s)}}const yR={Float32Array,Uint32Array,Int32Array,Uint8Array};function xR(t,e){let r=0,n=0;const i={};for(let l=0;l<t.length;l++)n+=e[l],r+=t[l].length;const s=new ArrayBuffer(r*4);let o=null,a=0;for(let l=0;l<t.length;l++){const c=e[l],h=t[l],d=L_(h);i[d]||(i[d]=new yR[d](s)),o=i[d];for(let f=0;f<h.length;f++){const p=(f/c|0)*n+a,g=f%c;o[p+g]=h[f]}a+=c}return new Float32Array(s)}const Iy={5126:4,5123:2,5121:1};let vR=0;const _R={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Vn{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=vR++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new gr("disposeGeometry"),this.refCount=0}addAttribute(e,r,n=0,i=!1,s,o,a,l=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof We||(r instanceof Array&&(r=new Float32Array(r)),r=new We(r));const c=e.split("|");if(c.length>1){for(let d=0;d<c.length;d++)this.addAttribute(c[d],r,n,i,s);return this}let h=this.buffers.indexOf(r);return h===-1&&(this.buffers.push(r),h=this.buffers.length-1),this.attributes[e]=new dc(h,n,i,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof We||(e instanceof Array&&(e=new Uint16Array(e)),e=new We(e)),e.type=Fr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],r=[],n=new We;let i;for(i in this.attributes){const s=this.attributes[i],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*Iy[s.type]/4),s.buffer=0}for(n.data=xR(e,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Vn;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new We(this.buffers[r].data.slice(0));for(const r in this.attributes){const n=this.attributes[r];e.attributes[r]=new dc(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Fr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const r=new Vn,n=[],i=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l]=i[l]||0,i[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)n[a]=new _R[L_(o.buffers[a].data)](i[a]),r.buffers[a]=new We(n[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)n[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=Fr.ELEMENT_ARRAY_BUFFER;let a=0,l=0,c=0,h=0;for(let d=0;d<o.buffers.length;d++)if(o.buffers[d]!==o.indexBuffer){h=d;break}for(const d in o.attributes){const f=o.attributes[d];(f.buffer|0)===h&&(l+=f.size*Iy[f.type]/4)}for(let d=0;d<e.length;d++){const f=e[d].indexBuffer.data;for(let p=0;p<f.length;p++)r.indexBuffer.data[p+c]+=a;a+=e[d].buffers[h].data.length/l,c+=f.length}}return r}}class D_ extends Vn{constructor(e=!1){super(),this._buffer=new We(null,e,!1),this._indexBuffer=new We(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,te.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,te.FLOAT).addAttribute("aColor",this._buffer,4,!0,te.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,te.FLOAT).addIndex(this._indexBuffer)}}const fc=Math.PI*2,wR=180/Math.PI,SR=Math.PI/180;var ht=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(ht||{});class _e{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new _e(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}}_e.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Va=[new _e,new _e,new _e,new _e];class fe{constructor(e=0,r=0,n=0,i=0){this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(i),this.type=ht.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new fe(0,0,0,0)}clone(){return new fe(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){const S=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=S)return!1;const R=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>R}const n=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=n||o<=s)return!1;const a=Va[0].set(e.left,e.top),l=Va[1].set(e.left,e.bottom),c=Va[2].set(e.right,e.top),h=Va[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;const d=Math.sign(r.a*r.d-r.b*r.c);if(d===0||(r.apply(a,a),r.apply(l,l),r.apply(c,c),r.apply(h,h),Math.max(a.x,l.x,c.x,h.x)<=n||Math.min(a.x,l.x,c.x,h.x)>=i||Math.max(a.y,l.y,c.y,h.y)<=s||Math.min(a.y,l.y,c.y,h.y)>=o))return!1;const f=d*(l.y-a.y),p=d*(a.x-l.x),g=f*n+p*s,v=f*i+p*s,_=f*n+p*o,y=f*i+p*o;if(Math.max(g,v,_,y)<=f*a.x+p*a.y||Math.min(g,v,_,y)>=f*h.x+p*h.y)return!1;const x=d*(a.y-c.y),m=d*(c.x-a.x),w=x*n+m*s,b=x*i+m*s,T=x*n+m*o,A=x*i+m*o;return!(Math.max(w,b,T,A)<=x*a.x+m*a.y||Math.min(w,b,T,A)>=x*h.x+m*h.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,i=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=i,this.height=s-i,this}}fe.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class qc{constructor(e=0,r=0,n=0){this.x=e,this.y=r,this.radius=n,this.type=ht.CIRC}clone(){return new qc(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,s=this.y-r;return i*=i,s*=s,i+s<=n}getBounds(){return new fe(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}qc.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Qc{constructor(e=0,r=0,n=0,i=0){this.x=e,this.y=r,this.width=n,this.height=i,this.type=ht.ELIP}clone(){return new Qc(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,i=(r-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new fe(this.x-this.width,this.y-this.height,this.width,this.height)}}Qc.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class yi{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let i=0,s=r.length;i<s;i++)n.push(r[i].x,r[i].y);r=n}this.points=r,this.type=ht.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),r=new yi(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let n=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],l=this.points[s*2+1],c=this.points[o*2],h=this.points[o*2+1];l>r!=h>r&&e<(c-a)*((r-l)/(h-l))+a&&(n=!n)}return n}}yi.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class Zc{constructor(e=0,r=0,n=0,i=0,s=20){this.x=e,this.y=r,this.width=n,this.height=i,this.radius=s,this.type=ht.RREC}clone(){return new Zc(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),s=r-(this.y+n);const o=n*n;if(i*i+s*s<=o||(i=e-(this.x+this.width-n),i*i+s*s<=o)||(s=r-(this.y+this.height-n),i*i+s*s<=o)||(i=e-(this.x+n),i*i+s*s<=o))return!0}return!1}}Zc.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Ne{constructor(e=1,r=0,n=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,i,s,o){return this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new _e;const n=e.x,i=e.y;return r.x=this.a*n+this.c*i+this.tx,r.y=this.b*n+this.d*i+this.ty,r}applyInverse(e,r){r=r||new _e;const n=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return r.x=this.d*n*i+-this.c*n*s+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*s+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*r-this.b*n,this.b=i*n+this.b*r,this.c=s*r-this.d*n,this.d=s*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,i=this.c,s=this.d;return this.a=e.a*r+e.b*i,this.b=e.a*n+e.b*s,this.c=e.c*r+e.d*i,this.d=e.c*n+e.d*s,this.tx=e.tx*r+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}setTransform(e,r,n,i,s,o,a,l,c){return this.a=Math.cos(a+c)*s,this.b=Math.sin(a+c)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(n*this.a+i*this.c),this.ty=r-(n*this.b+i*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),l=Math.atan2(n,r),c=Math.abs(a+l);return c<1e-5||Math.abs(fc-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*r+o.y*i),e.position.y=this.ty+(o.x*n+o.y*s),e}invert(){const e=this.a,r=this.b,n=this.c,i=this.d,s=this.tx,o=e*i-r*n;return this.a=i/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-i*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Ne;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Ne}static get TEMP_MATRIX(){return new Ne}}Ne.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const ni=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ii=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],si=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],oi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Jd=[],j_=[],Wa=Math.sign;function bR(){for(let t=0;t<16;t++){const e=[];Jd.push(e);for(let r=0;r<16;r++){const n=Wa(ni[t]*ni[r]+si[t]*ii[r]),i=Wa(ii[t]*ni[r]+oi[t]*ii[r]),s=Wa(ni[t]*si[r]+si[t]*oi[r]),o=Wa(ii[t]*si[r]+oi[t]*oi[r]);for(let a=0;a<16;a++)if(ni[a]===n&&ii[a]===i&&si[a]===s&&oi[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Ne;e.set(ni[t],ii[t],si[t],oi[t],0,0),j_.push(e)}}bR();const je={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>ni[t],uY:t=>ii[t],vX:t=>si[t],vY:t=>oi[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Jd[t][e],sub:(t,e)=>Jd[t][je.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?je.S:je.N:Math.abs(e)*2<=Math.abs(t)?t>0?je.E:je.W:e>0?t>0?je.SE:je.SW:t>0?je.NE:je.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const i=j_[je.inv(e)];i.tx=r,i.ty=n,t.append(i)}};class Qr{constructor(e,r,n=0,i=0){this._x=n,this._y=i,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new Qr(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Qr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const ef=class{constructor(){this.worldTransform=new Ne,this.localTransform=new Ne,this.position=new Qr(this.onChange,this,0,0),this.scale=new Qr(this.onChange,this,1,1),this.pivot=new Qr(this.onChange,this,0,0),this.skew=new Qr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};ef.IDENTITY=new ef;let Dp=ef;Dp.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var ER=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,TR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function ky(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function yh(t){const e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function O_(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return yh(2*e);case"bvec3":return yh(3*e);case"bvec4":return yh(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const As=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],AR={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},CR={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function RR(t,e){var n;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const s=e[i];if(!s){((n=t.uniforms[i])==null?void 0:n.group)===!0&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let a=!1;for(let l=0;l<As.length;l++)if(As[l].test(s,o)){r.push(As[l].code(i,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?AR:CR)[s.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const U_={};let $i=U_;function PR(){if($i===U_||$i!=null&&$i.isContextLost()){const t=X.ADAPTER.createCanvas();let e;X.PREFER_ENV>=Mi.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),$i=e}return $i}let Xa;function IR(){if(!Xa){Xa=Zt.MEDIUM;const t=PR();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(Xa=e.precision?Zt.HIGH:Zt.MEDIUM)}}return Xa}function My(t,e){const r=t.getShaderSource(e).split(`
`).map((c,h)=>`${h}: ${c}`),n=t.getShaderInfoLog(e),i=n.split(`
`),s={},o=i.map(c=>parseFloat(c.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(c=>c&&!s[c]?(s[c]=!0,!0):!1),a=[""];o.forEach(c=>{r[c-1]=`%c${r[c-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=r.join(`
`);a[0]=l,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function kR(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||My(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||My(t,n),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const MR={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function G_(t){return MR[t]}let Ya=null;const By={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function z_(t,e){if(!Ya){const r=Object.keys(By);Ya={};for(let n=0;n<r.length;++n){const i=r[n];Ya[t[i]]=By[i]}}return Ya[e]}function Ny(t,e,r){if(t.substring(0,9)!=="precision"){let n=e;return e===Zt.HIGH&&r!==Zt.HIGH&&(n=Zt.MEDIUM),`precision ${n} float;
${t}`}else if(r!==Zt.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let so;function BR(){if(typeof so=="boolean")return so;try{so=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{so=!1}return so}let NR=0;const Ka={},tf=class Zi{constructor(e,r,n="pixi-shader",i={}){this.extra={},this.id=NR++,this.vertexSrc=e||Zi.defaultVertexSrc,this.fragmentSrc=r||Zi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),Ka[n]?(Ka[n]++,n+=`-${Ka[n]}`):Ka[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=Ny(this.vertexSrc,Zi.defaultVertexPrecision,Zt.HIGH),this.fragmentSrc=Ny(this.fragmentSrc,Zi.defaultFragmentPrecision,IR())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return TR}static get defaultFragmentSrc(){return ER}static from(e,r,n){const i=e+r;let s=Ay[i];return s||(Ay[i]=s=new Zi(e,r,n)),s}};tf.defaultVertexPrecision=Zt.HIGH,tf.defaultFragmentPrecision=qr.apple.device?Zt.HIGH:Zt.MEDIUM;let Zr=tf,LR=0;class yr{constructor(e,r,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=LR++,this.static=!!r,this.ubo=!!n,e instanceof We?(this.buffer=e,this.buffer.type=Fr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new We(new Float32Array(1)),this.buffer.type=Fr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,n){if(!this.ubo)this.uniforms[e]=new yr(r,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,n){return new yr(e,r,n)}static uboFrom(e,r){return new yr(e,r??!0,!0)}}class Dr{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof yr?this.uniformGroup=r:this.uniformGroup=new yr(r):this.uniformGroup=new yr({}),this.disposeRunner=new gr("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(const n in r.uniforms){const i=r.uniforms[n];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,n){const i=Zr.from(e,r);return new Dr(i,n)}}class FR{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let s=0;s<e;s++)n[s]=s;this.defaultGroupCache[e]=yr.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Zr(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ne,default:this.defaultGroupCache[e]};return new Dr(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let n=0;n<e;n++)n>0&&(r+=`
else `),n<e-1&&(r+=`if(vTextureId < ${n}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class rf{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function DR(){return!qr.apple.device}function jR(t){let e=!0;const r=X.ADAPTER.getNavigator();if(qr.tablet||qr.phone){if(qr.apple.device){const n=r.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(qr.android.device){const n=r.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?t:4}class Jc{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var OR=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,UR=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const fo=class lr extends Jc{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=D_,this.vertexSize=6,this.state=Or.for2d(),this.size=lr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??jR(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??DR(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return ge("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return UR}static get defaultFragmentTemplate(){return OR}setShaderGenerator({vertex:e=lr.defaultVertexSrc,fragment:r=lr.defaultFragmentTemplate}={}){this.shaderGenerator=new FR(e,r)}contextChange(){const e=this.renderer.gl;X.PREFER_ENV===Mi.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),lr.defaultMaxTextures),this.maxTextures=pR(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:r}=lr,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;e.length<n;)e.push(new Zd);for(;r.length<i;)r.push(new rf);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:r}=this,n=lr._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++he._globalBatch,l=0,c=n[0],h=0;i.copyBoundTextures(s,r);for(let d=0;d<this._bufferSize;++d){const f=e[d];e[d]=null,f._batchEnabled!==a&&(c.count>=r&&(i.boundArray(c,s,a,r),this.buildDrawCalls(c,h,d),h=d,c=n[++l],++a),f._batchEnabled=a,f.touched=o,c.elements[c.count++]=f)}c.count>0&&(i.boundArray(c,s,a,r),this.buildDrawCalls(c,h,this._bufferSize),++l,++a);for(let d=0;d<s.length;d++)s[d]=null;he._globalBatch=a}buildDrawCalls(e,r,n){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=lr._drawCallPool;let c=this._dcIndex,h=this._aIndex,d=this._iIndex,f=l[c];f.start=this._iIndex,f.texArray=e;for(let p=r;p<n;++p){const g=i[p],v=g._texture.baseTexture,_=B_[v.alphaMode?1:0][g.blendMode];i[p]=null,r<p&&f.blend!==_&&(f.size=d-f.start,r=p,f=l[++c],f.texArray=e,f.start=d),this.packInterleavedGeometry(g,s,o,h,d),h+=g.vertexData.length/2*a,d+=g.indices.length,f.blend=_}r<n&&(f.size=d-f.start,++c),this._dcIndex=c,this._aIndex=h,this._iIndex=d}bindAndClearTexArray(e){const r=this.renderer.texture;for(let n=0;n<e.count;n++)r.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:r,_indexBuffer:n}=this;lr.canUploadSameBuffer?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:r,state:n}=this.renderer,i=lr._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:c,start:h,blend:d}=i[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=d,n.set(this.state),r.drawElements(l,c,r.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),lr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const r=hc(Math.ceil(e/8)),n=Ey(r),i=r*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new Kd(i*this.vertexSize*4)),s}getIndexBuffer(e){const r=hc(Math.ceil(e/12)),n=Ey(r),i=r*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._iBuffers[n];return s||(this._iBuffers[n]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,r,n,i,s){const{uint32View:o,float32View:a}=r,l=i/this.vertexSize,c=e.uvs,h=e.indices,d=e.vertexData,f=e._texture.baseTexture._batchLocation,p=Math.min(e.worldAlpha,1),g=Me.shared.setValue(e._tintRGB).toPremultiplied(p,e._texture.baseTexture.alphaMode>0);for(let v=0;v<d.length;v+=2)a[i++]=d[v],a[i++]=d[v+1],a[i++]=c[v],a[i++]=c[v+1],o[i++]=g,a[i++]=f;for(let v=0;v<h.length;v++)n[s++]=l+h[v]}};fo.defaultBatchSize=4096,fo.extension={name:"batch",type:V.RendererPlugin},fo._drawCallPool=[],fo._textureArrayPool=[];let ai=fo;J.add(ai);var GR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,zR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const nf=class po extends Dr{constructor(e,r,n){const i=Zr.from(e||po.defaultVertexSrc,r||po.defaultFragmentSrc);super(i,n),this.padding=0,this.resolution=po.defaultResolution,this.multisample=po.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Or}apply(e,r,n,i,s){e.applyFilter(this,r,n,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return zR}static get defaultFragmentSrc(){return GR}};nf.defaultResolution=1,nf.defaultMultisample=Ke.NONE;let wt=nf;class pc{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Me(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:r,background:n,backgroundAlpha:i}=e,s=n??r;s!==void 0&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}pc.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},pc.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"background"};J.add(pc);class H_{constructor(e){this.renderer=e,this.emptyRenderer=new Jc(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){const{boundTextures:n}=this.renderer.texture;for(let i=r-1;i>=0;--i)e[i]=n[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,r,n,i){const{elements:s,ids:o,count:a}=e;let l=0;for(let c=0;c<a;c++){const h=s[c],d=h._batchLocation;if(d>=0&&d<i&&r[d]===h){o[c]=d;continue}for(;l<i;){const f=r[l];if(f&&f._batchEnabled===n&&f._batchLocation===l){l++;continue}o[c]=l,h._batchLocation=l,r[l]=h;break}}}destroy(){this.renderer=null}}H_.extension={type:V.RendererSystem,name:"batch"};J.add(H_);let Ly=0;class mc{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Ly++}init(e){if(e.context)this.initFromContext(e.context);else{const r=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Ly++,this.renderer.runners.contextChange.emit(e);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let n;if(X.PREFER_ENV>=Mi.WEBGL2&&(n=e.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const r=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}mc.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},mc.extension={type:V.RendererSystem,name:"context"};J.add(mc);class sf{constructor(e,r){if(this.width=Math.round(e),this.height=Math.round(r),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new gr("disposeFramebuffer"),this.multisample=Ke.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new he(null,{scaleMode:Kr.NEAREST,resolution:1,mipmap:jr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new he(null,{scaleMode:Kr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:jr.OFF,format:$.DEPTH_COMPONENT,type:te.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!e||!r)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],s=i.resolution;i.setSize(e/s,r/s)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,r/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class $_ extends he{constructor(e={}){if(typeof e=="number"){const r=arguments[0],n=arguments[1],i=arguments[2],s=arguments[3];e={width:r,height:n,scaleMode:i,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=Ke.NONE),super(null,e),this.mipmap=jr.OFF,this.valid=!0,this._clear=new Me([0,0,0,0]),this.framebuffer=new sf(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class an extends sa{constructor(e){const r=e,n=r.naturalWidth||r.videoWidth||r.displayWidth||r.width,i=r.naturalHeight||r.videoHeight||r.displayHeight||r.height;super(n,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,n){n===void 0&&!r.startsWith("data:")?e.crossOrigin=hR(r):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,r,n,i){const s=e.gl,o=r.realWidth,a=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Pt.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&n.width===o&&n.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,n.type,i):(n.width=o,n.height=a,s.texImage2D(r.target,0,n.internalFormat,r.format,n.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),super.update()}dispose(){this.source=null}}class V_ extends an{constructor(e,r){if(r=r||{},typeof e=="string"){const n=new Image;an.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??X.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,n)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{n(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Pt.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,n,this.bitmap),!this.preserveBitmap){let i=!0;const s=r._glTextures;for(const o in s){const a=s[o];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class jp{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,n){const i=r.width,s=r.height;if(n){const o=e.width/2/i,a=e.height/2/s,l=e.x/i+o,c=e.y/s+a;n=je.add(n,je.NW),this.x0=l+o*je.uX(n),this.y0=c+a*je.uY(n),n=je.add(n,2),this.x1=l+o*je.uX(n),this.y1=c+a*je.uY(n),n=je.add(n,2),this.x2=l+o*je.uX(n),this.y2=c+a*je.uY(n),n=je.add(n,2),this.x3=l+o*je.uX(n),this.y3=c+a*je.uY(n)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}jp.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Fy=new jp;function qa(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class Z extends fa{constructor(e,r,n,i,s,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new fe(0,0,1,1)),e instanceof Z&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=Fy,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new _e(o.x,o.y):new _e(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:r}=this.baseTexture;r!=null&&r.url&&Er[r.url]&&Z.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Z.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new Z(this.baseTexture,!this.noFrame&&e,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===Fy&&(this._uvs=new jp),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},n=X.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else if(e instanceof he){if(!e.cacheId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${Ti()}`,he.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Ti()}`}s=e._pixiId}let o=Er[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof he)?(r.resolution||(r.resolution=on(e)),o=new Z(new he(e,r)),o.baseTexture.cacheId=s,he.addToCache(o.baseTexture,s),Z.addToCache(o,s)):!o&&e instanceof he&&(o=new Z(e),Z.addToCache(o,s)),o}static fromURL(e,r){const n=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=Z.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,r,n,i){return new Z(he.fromBuffer(e,r,n,i))}static fromLoader(e,r,n,i){const s=new he(e,Object.assign({scaleMode:he.defaultOptions.scaleMode,resolution:on(r)},i)),{resource:o}=s;o instanceof V_&&(o.url=r);const a=new Z(s);return n||(n=r),he.addToCache(a.baseTexture,n),Z.addToCache(a,n),n!==r&&(he.addToCache(a.baseTexture,r),Z.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),Er[r]&&Er[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Er[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=Er[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete Er[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)Er[e.textureCacheIds[r]]===e&&delete Er[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:r,y:n,width:i,height:s}=e,o=r+i>this.baseTexture.width,a=n+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",c=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,h=`Y: ${n} + ${s} = ${n+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${c} ${l} ${h}`)}this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Z._EMPTY||(Z._EMPTY=new Z(new he),qa(Z._EMPTY),qa(Z._EMPTY.baseTexture)),Z._EMPTY}static get WHITE(){if(!Z._WHITE){const e=X.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),Z._WHITE=new Z(he.from(e)),qa(Z._WHITE),qa(Z._WHITE.baseTexture)}return Z._WHITE}}class Ni extends Z{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,n=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(r*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new Ni(new $_(e))}}class W_{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,n=Ke.NONE){const i=new $_(Object.assign({width:e,height:r,resolution:1,multisample:n},this.textureOptions));return new Ni(i)}getOptimalTexture(e,r,n=1,i=Ke.NONE){let s;e=Math.max(Math.ceil(e*n-1e-6),1),r=Math.max(Math.ceil(r*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=hc(e),r=hc(r),s=((e&65535)<<16|r&65535)>>>0,i>1&&(s+=i*4294967296)):s=i>1?-i:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,i)),o.filterPoolKey=s,o.setResolution(n),o}getFilterTexture(e,r,n){const i=this.getOptimalTexture(e.width,e.height,r||e.resolution,n||Ke.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const r in this.texturePool){const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}W_.SCREEN_KEY=-1;class HR extends Vn{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class X_ extends Vn{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new We(this.vertices),this.uvBuffer=new We(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+r.width/e.width,this.uvs[3]=i,this.uvs[4]=n+r.width/e.width,this.uvs[5]=i+r.height/e.height,this.uvs[6]=n,this.uvs[7]=i+r.height/e.height,n=r.x,i=r.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+r.width,this.vertices[3]=i,this.vertices[4]=n+r.width,this.vertices[5]=i+r.height,this.vertices[6]=n,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class $R{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Ke.NONE,this.sourceFrame=new fe,this.destinationFrame=new fe,this.bindingSourceFrame=new fe,this.bindingDestinationFrame=new fe,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Qa=[new _e,new _e,new _e,new _e],xh=new Ne;class Y_{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new W_,this.statePool=[],this.quad=new HR,this.quadUv=new X_,this.tempRect=new fe,this.activeState={},this.globalUniforms=new yr({outputFrame:new fe,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){const n=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new $R,o=n.renderTexture;let a,l;if(o.current){const _=o.current;a=_.resolution,l=_.multisample}else a=n.resolution,l=n.multisample;let c=r[0].resolution||a,h=r[0].multisample??l,d=r[0].padding,f=r[0].autoFit,p=r[0].legacy??!0;for(let _=1;_<r.length;_++){const y=r[_];c=Math.min(c,y.resolution||a),h=Math.min(h,y.multisample??l),d=this.useMaxPadding?Math.max(d,y.padding):d+y.padding,f=f&&y.autoFit,p=p||(y.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=c,s.multisample=h,s.legacy=p,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(d);const g=this.tempRect.copyFrom(o.sourceFrame);n.projection.transform&&this.transformAABB(xh.copyFrom(n.projection.transform).invert(),g),f?(s.sourceFrame.fit(g),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(g)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:n.resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,c,h),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const v=this.tempRect;v.x=0,v.y=0,v.width=s.sourceFrame.width,v.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=n.projection.transform,n.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,v),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,r=e.pop(),n=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const s=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*s[2]-.5*o[2],a[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){const c=i.filterArea;c[0]=r.destinationFrame.width,c[1]=r.destinationFrame.height,c[2]=r.sourceFrame.x,c[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,l.renderTexture,Ir.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let c=r.renderTexture,h=this.getOptimalFilterTexture(c.width,c.height,r.resolution);h.filterFrame=c.filterFrame;let d=0;for(d=0;d<n.length-1;++d){d===1&&r.multisample>1&&(h=this.getOptimalFilterTexture(c.width,c.height,r.resolution),h.filterFrame=c.filterFrame),n[d].apply(this,c,h,Ir.CLEAR,r);const f=c;c=h,h=f}n[d].apply(this,c,l.renderTexture,Ir.BLEND,r),d>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(h)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=Ir.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,n.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=i.stateId&1||this.forceClear;(r===Ir.CLEAR||r===Ir.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,n,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(n,i),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Br.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Br.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:s}=r._texture,o=e.set(i.width,0,0,i.height,n.x,n.y),a=r.worldTransform.copyTo(Ne.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,n=1,i=Ke.NONE){return this.texturePool.getOptimalTexture(e,r,n,i)}getFilterTexture(e,r,n){if(typeof e=="number"){const s=e;e=r,r=s}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,n||Ke.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){const n=Qa[0],i=Qa[1],s=Qa[2],o=Qa[3];n.set(r.left,r.top),i.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(n,n),e.apply(i,i),e.apply(s,s),e.apply(o,o);const a=Math.min(n.x,i.x,s.x,o.x),l=Math.min(n.y,i.y,s.y,o.y),c=Math.max(n.x,i.x,s.x,o.x),h=Math.max(n.y,i.y,s.y,o.y);r.x=a,r.y=l,r.width=c-a,r.height=h-l}roundFrame(e,r,n,i,s){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(s){const{a:o,b:a,c:l,d:c}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(c)>1e-4))return}s=s?xh.copyFrom(s):xh.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}}Y_.extension={type:V.RendererSystem,name:"filter"};J.add(Y_);class VR{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Ke.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const WR=new fe;class K_{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new sf(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new fe,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;X.PREFER_ENV===Mi.WEBGL_LEGACY&&(r=null,n=null),r?e.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,n=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=n),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){const o=r.width>>n,a=r.height>>n,l=o/r.width;this.setViewport(r.x*l,r.y*l,o,a)}else{const o=e.width>>n,a=e.height>>n;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,n,i){const s=this.viewport;e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),(s.width!==n||s.height!==i||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=n,s.height=i,this.gl.viewport(e,r,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,n,i,s=Md.COLOR|Md.DEPTH){const{gl:o}=this;o.clearColor(e,r,n,i),o.clear(s)}initFramebuffer(e){const{gl:r}=this,n=new VR(r.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){r.bindRenderbuffer(r.RENDERBUFFER,n.stencil);let o;this.renderer.context.webGLVersion===1?o=r.DEPTH_STENCIL:e.depth&&e.stencil?o=r.DEPTH24_STENCIL8:e.depth?o=r.DEPTH_COMPONENT24:o=r.STENCIL_INDEX8,n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,o,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let s=i.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=i[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&n.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const c=s[l],h=c.parentTextureArray||c;this.renderer.texture.bind(h,0),l===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+l,c.target,h._glTextures[this.CONTEXT_UID].texture,r),a.push(n.COLOR_ATTACHMENT0+l))}if(a.length>1&&n.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,r)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||n.createRenderbuffer();let l,c;this.renderer.context.webGLVersion===1?(l=n.DEPTH_STENCIL_ATTACHMENT,c=n.DEPTH_STENCIL):e.depth&&e.stencil?(l=n.DEPTH_STENCIL_ATTACHMENT,c=n.DEPTH24_STENCIL8):e.depth?(l=n.DEPTH_ATTACHMENT,c=n.DEPTH_COMPONENT24):(l=n.STENCIL_ATTACHMENT,c=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,c,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,c,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,l,n.RENDERBUFFER,i.stencil)}else i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:r}=this;let n=Ke.NONE;if(e<=1||r===null)return n;for(let i=0;i<r.length;i++)if(r[i]<=e){n=r[i];break}return n===1&&(n=Ke.NONE),n}blit(e,r,n){const{current:i,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!i)return;const l=i.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const h=i.colorTextures[0];if(!h)return;l.blitFramebuffer||(l.blitFramebuffer=new sf(i.width,i.height),l.blitFramebuffer.addColorTexture(0,h)),e=l.blitFramebuffer,e.colorTextures[0]!==h&&(e.colorTextures[0]=h,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}r||(r=WR,r.width=i.width,r.height=i.height),n||(n=r);const c=r.width===n.width&&r.height===n.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,r){const n=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,r)}disposeAll(e){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<r.length;n++)this.disposeFramebuffer(r[n],e)}forceStencil(){const e=this.current;if(!e)return;const r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil&&e.stencil)return;e.stencil=!0;const n=e.width,i=e.height,s=this.gl,o=r.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,l,n,i):s.renderbufferStorage(s.RENDERBUFFER,l,n,i),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new fe}destroy(){this.renderer=null}}K_.extension={type:V.RendererSystem,name:"framebuffer"};J.add(K_);const vh={5126:4,5123:2,5121:1};class q_{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;X.PREFER_ENV===Mi.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(i,s)=>n.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,a,l)=>n.drawElementsInstancedANGLE(i,s,o,a,l),e.drawArraysInstanced=(i,s,o,a)=>n.drawArraysInstancedANGLE(i,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;const{gl:n}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,r=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];r.update(i)}}checkCompatibility(e,r){const n=e.attributes,i=r.attributeData;for(const s in i)if(!n[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){const n=e.attributes,i=r.attributeData,s=["g",e.id];for(const o in n)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,r,n=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,a);const l=this.getSignature(e,a),c=e.glVertexArrayObjects[this.CONTEXT_UID];let h=c[l];if(h)return c[a.id]=h,h;const d=e.buffers,f=e.attributes,p={},g={};for(const v in d)p[v]=0,g[v]=0;for(const v in f)!f[v].size&&a.attributeData[v]?f[v].size=a.attributeData[v].size:f[v].size||console.warn(`PIXI Geometry attribute '${v}' size cannot be determined (likely the bound shader does not have the attribute)`),p[f[v].buffer]+=f[v].size*vh[f[v].type];for(const v in f){const _=f[v],y=_.size;_.stride===void 0&&(p[_.buffer]===y*vh[_.type]?_.stride=0:_.stride=p[_.buffer]),_.start===void 0&&(_.start=g[_.buffer],g[_.buffer]+=y*vh[_.type])}h=i.createVertexArray(),i.bindVertexArray(h);for(let v=0;v<d.length;v++){const _=d[v];o.bind(_),n&&_._glBuffers[s].refCount++}return this.activateVao(e,a),c[a.id]=h,c[l]=h,i.bindVertexArray(null),o.unbind(Fr.ARRAY_BUFFER),h}disposeGeometry(e,r){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!n){if(o)for(let l=0;l<s.length;l++){const c=s[l]._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!r&&o.dispose(s[l],r))}if(!r){for(const l in n)if(l[0]==="g"){const c=n[l];this._activeVao===c&&this.unbind(),i.deleteVertexArray(c)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const r=Object.keys(this.managedGeometries);for(let n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],e)}activateVao(e,r){const n=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const c in a){const h=a[c],d=o[h.buffer],f=d._glBuffers[i];if(r.attributeData[c]){l!==f&&(s.bind(d),l=f);const p=r.attributeData[c].location;if(n.enableVertexAttribArray(p),n.vertexAttribPointer(p,h.size,h.type||n.FLOAT,h.normalized,h.stride,h.start),h.instance)if(this.hasInstance)n.vertexAttribDivisor(p,h.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,n,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,l,(n||0)*a,i||1):s.drawElements(e,r||o.indexBuffer.data.length,l,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,n,r||o.getSize(),i||1):s.drawArrays(e,n,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}q_.extension={type:V.RendererSystem,name:"geometry"};J.add(q_);const Dy=new Ne;class Q_{constructor(e,r){this._texture=e,this.mapCoord=new Ne,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];r[i]=s*n.a+o*n.c+n.tx,r[i+1]=s*n.b+o*n.d+n.ty}return r}update(e){const r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const n=r._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=r.orig,s=r.trim;s&&(Dy.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Dy));const o=r.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,c=this.clampOffset;return a[0]=(r._frame.x+l+c)/o.width,a[1]=(r._frame.y+l+c)/o.height,a[2]=(r._frame.x+r._frame.width-l+c)/o.width,a[3]=(r._frame.y+r._frame.height-l+c)/o.height,this.uClampOffset[0]=c/o.realWidth,this.uClampOffset[1]=c/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}}var XR=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,YR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class KR extends wt{constructor(e,r,n){let i=null;typeof e!="string"&&r===void 0&&n===void 0&&(i=e,e=void 0,r=void 0,n=void 0),super(e||YR,r||XR,n),this.maskSprite=i,this.maskMatrix=new Ne}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,n,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Q_(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,n,i))}}class qR{constructor(e=null){this.type=Je.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=wt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Je.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Z_{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let n=r;if(!n.isMaskData){const s=this.maskDataPool.pop()||new qR;s.pooled=!0,s.maskObject=r,n=s}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==Je.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case Je.SCISSOR:this.renderer.scissor.push(n);break;case Je.STENCIL:this.renderer.stencil.push(n);break;case Je.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case Je.COLOR:this.pushColorMask(n);break}n.type===Je.SPRITE&&this.maskStack.push(n)}pop(e){const r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case Je.SCISSOR:this.renderer.scissor.pop(r);break;case Je.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case Je.SPRITE:this.popSpriteMask(r);break;case Je.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===Je.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const r=e.maskObject;r?r.isSprite?e.type=Je.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Je.SCISSOR:e.type=Je.STENCIL:e.type=Je.COLOR}pushSpriteMask(e){const{maskObject:r}=e,n=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new KR])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=r;const s=n.filterArea;n.filterArea=r.getBounds(!0),this.renderer.filter.push(n,i),n.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const r=e._colorMask,n=e._colorMask=r&e.colorMask;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const r=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}Z_.extension={type:V.RendererSystem,name:"mask"};J.add(Z_);class J_{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:r}=this.renderer,n=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==n&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const jy=new Ne,Oy=[],e1=class Cl extends J_{constructor(e){super(e),this.glConst=X.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const r=e._scissorRect,{maskObject:n}=e,{renderer:i}=this,s=i.renderTexture,o=n.getBounds(!0,Oy.pop()??new fe);this.roundFrameToPixels(o,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),r&&o.fit(r),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:r,b:n,c:i,d:s}=e;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(r)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:r}=e;if(!r.isFastRect||!r.isFastRect()||Cl.isMatrixRotated(r.worldTransform)||Cl.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const n=e._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(e,r,n,i,s){Cl.isMatrixRotated(s)||(s=s?jy.copyFrom(s):jy.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*r),e.y=Math.round(e.y*r),e.width=Math.round(e.width*r),e.height=Math.round(e.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:r}=this.renderer;e._scissorRect||r.enable(r.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:r}=this.renderer;e&&Oy.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():r.disable(r.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let r;this.renderer.renderTexture.current?r=e.y:r=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,r,e.width,e.height)}};e1.extension={type:V.RendererSystem,name:"scissor"};let QR=e1;J.add(QR);class t1 extends J_{constructor(e){super(e),this.glConst=X.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const r=e.maskObject,{gl:n}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,n.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(n._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}t1.extension={type:V.RendererSystem,name:"stencil"};J.add(t1);class r1{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return ge("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return ge("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return ge("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}r1.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"_plugin"};J.add(r1);class n1{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ne,this.transform=null}update(e,r,n,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,n,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}}n1.extension={type:V.RendererSystem,name:"projection"};J.add(n1);const ZR=new Dp,Uy=new fe;class i1{constructor(e){this.renderer=e,this._tempMatrix=new Ne}generateTexture(e,r){const{region:n,...i}=r||{},s=(n==null?void 0:n.copyTo(Uy))||e.getLocalBounds(Uy,!0),o=i.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),i.width=s.width,i.height=s.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const a=Ni.create(i);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=ZR,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}i1.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"textureGenerator"};J.add(i1);const Jn=new fe,oo=new fe;class s1{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new fe,this.destinationFrame=new fe,this.viewportFrame=new fe}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,r,n){const i=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,r||(Jn.width=e.frame.width,Jn.height=e.frame.height,r=Jn),n||(oo.x=e.frame.x,oo.y=e.frame.y,oo.width=r.width,oo.height=r.height,n=oo),o=s.framebuffer):(a=i.resolution,r||(Jn.width=i._view.screen.width,Jn.height=i._view.screen.height,r=Jn),n||(n=Jn,n.width=r.width,n.height=r.height));const l=this.viewportFrame;l.x=n.x*a,l.y=n.y*a,l.width=n.width*a,l.height=n.height*a,e||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(n,r,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)}clear(e,r){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=Me.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:c,width:h,height:d}=this.viewportFrame;l=Math.round(l),c=Math.round(c),h=Math.round(h),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,c,h,d)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}s1.extension={type:V.RendererSystem,name:"renderTexture"};J.add(s1);class JR{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function eP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=z_(e,s.type),a={type:o,name:s.name,size:G_(o),location:e.getAttribLocation(t,s.name)};r[s.name]=a}return r}function tP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=z_(e,s.type);r[o]={name:o,index:i,type:l,size:s.size,isArray:a,value:O_(l,s.size)}}return r}function rP(t,e){var a;const r=ky(t,t.VERTEX_SHADER,e.vertexSrc),n=ky(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||kR(t,i,r,n),e.attributeData=eP(i,t),e.uniformData=tP(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((c,h)=>c>h?1:-1);for(let c=0;c<l.length;c++)e.attributeData[l[c]].location=c,t.bindAttribLocation(i,c,l[c]);t.linkProgram(i)}t.deleteShader(r),t.deleteShader(n);const o={};for(const l in e.uniformData){const c=e.uniformData[l];o[l]={location:t.getUniformLocation(i,l),value:O_(c.type,c.size)}}return new JR(i,o)}function nP(t,e,r,n,i){r.buffer.update(i)}const iP={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},o1={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function sP(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let r=0,n=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(r=o1[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!==0&&n<16){const a=n%r%16;n+=a,i+=a}n+r>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function oP(t,e){const r=[];for(const n in t)e[n]&&r.push(e[n]);return r.sort((n,i)=>n.index-i.index),r}function aP(t,e){if(!t.autoManage)return{size:0,syncFunc:nP};const r=oP(t.uniforms,e),{uboElements:n,size:i}=sP(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<n.length;o++){const a=n[o],l=t.uniforms[a.data.name],c=a.data.name;let h=!1;for(let d=0;d<As.length;d++){const f=As[d];if(f.codeUbo&&f.test(a.data,l)){s.push(`offset = ${a.offset/4};`,As[d].codeUbo(a.data.name,l)),h=!0;break}}if(!h)if(a.data.size>1){const d=G_(a.data.type),f=Math.max(o1[a.data.type]/16,1),p=d/f,g=(4-p%4)%4;s.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*f}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${g};
                }

                `)}else{const d=iP[a.data.type];s.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${a.offset/4};
                ${d};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let lP=0;const Za={textureCount:0,uboCount:0};class a1{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=lP++}systemCheck(){if(!BR())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),r||(Za.textureCount=0,Za.uboCount=0,this.syncUniformGroup(e.uniformGroup,Za)),i}setUniforms(e){const r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,r){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,r))}syncUniforms(e,r,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=RR(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const i=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,r);e.buffer.update(),i(n.uniformData,e.uniforms,this.renderer,Za,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[r])}createSyncBufferGroup(e,r,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(r.program,n);r.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=aP(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return r.uniformGroups[e.id]=a.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,n){const i=e.uniforms,s=[`${n}-`];for(const o in i)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=this.gl,n=e.program,i=rP(r,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}a1.extension={type:V.RendererSystem,name:"shader"};J.add(a1);class gc{constructor(e){this.renderer=e}run(e){const{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.4.3 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}}gc.defaultOptions={hello:!1},gc.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"startup"};J.add(gc);function cP(t,e=[]){return e[se.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.ADD]=[t.ONE,t.ONE],e[se.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.NONE]=[0,0],e[se.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[se.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[se.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[se.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[se.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[se.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[se.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[se.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[se.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[se.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[se.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const uP=0,hP=1,dP=2,fP=3,pP=4,mP=5,l1=class of{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=se.NONE,this._blendEq=!1,this.map=[],this.map[uP]=this.setBlend,this.map[hP]=this.setOffset,this.map[dP]=this.setCullFace,this.map[fP]=this.setDepthTest,this.map[pP]=this.setFrontFace,this.map[mP]=this.setDepthMask,this.checks=[],this.defaultState=new Or,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=cP(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let r=this.stateId^e.data,n=0;for(;r;)r&1&&this.map[n].call(this,!!(e.data&1<<n)),r=r>>1,n++;this.stateId=e.data}for(let r=0;r<this.checks.length;r++)this.checks[r](this,e)}forceState(e){e=e||this.defaultState;for(let r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(let r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(of.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(of.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const r=this.blendModes[e],n=this.gl;r.length===2?n.blendFunc(r[0],r[1]):n.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,n.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,r){this.gl.polygonOffset(e,r)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,r){const n=this.checks.indexOf(e);r&&n===-1?this.checks.push(e):!r&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,r){e.setBlendMode(r.blendMode)}static checkPolygonOffset(e,r){e.setPolygonOffset(1,r.polygonOffset)}destroy(){this.gl=null}};l1.extension={type:V.RendererSystem,name:"state"};let gP=l1;J.add(gP);class yP extends fa{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const r=(e.priority??[]).filter(i=>e.systems[i]),n=[...r,...Object.keys(e.systems).filter(i=>!r.includes(i))];for(const i of n)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(r=>{this.runners[r]=new gr(r)})}addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(e,r){const n=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=n.find(o=>this._systemsHash[o]===i);i[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const mo=class Rl{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Rl.defaultMaxIdle,this.checkCountMax=Rl.defaultCheckCountMax,this.mode=Rl.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Rp.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,r=e.managedTextures;let n=!1;for(let i=0;i<r.length;i++){const s=r[i];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),r[i]=null,n=!0)}if(n){let i=0;for(let s=0;s<r.length;s++)r[s]!==null&&(r[i++]=r[s]);r.length=i}}unload(e){const r=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&r.destroyTexture(n);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};mo.defaultMode=Rp.AUTO,mo.defaultMaxIdle=60*60,mo.defaultCheckCountMax=60*10,mo.extension={type:V.RendererSystem,name:"textureGC"};let li=mo;J.add(li);class _h{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=te.UNSIGNED_BYTE,this.internalFormat=$.RGBA,this.samplerType=0}}function xP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:W.FLOAT,[t.RGBA]:W.FLOAT,[t.ALPHA]:W.FLOAT,[t.LUMINANCE]:W.FLOAT,[t.LUMINANCE_ALPHA]:W.FLOAT,[t.R8]:W.FLOAT,[t.R8_SNORM]:W.FLOAT,[t.RG8]:W.FLOAT,[t.RG8_SNORM]:W.FLOAT,[t.RGB8]:W.FLOAT,[t.RGB8_SNORM]:W.FLOAT,[t.RGB565]:W.FLOAT,[t.RGBA4]:W.FLOAT,[t.RGB5_A1]:W.FLOAT,[t.RGBA8]:W.FLOAT,[t.RGBA8_SNORM]:W.FLOAT,[t.RGB10_A2]:W.FLOAT,[t.RGB10_A2UI]:W.FLOAT,[t.SRGB8]:W.FLOAT,[t.SRGB8_ALPHA8]:W.FLOAT,[t.R16F]:W.FLOAT,[t.RG16F]:W.FLOAT,[t.RGB16F]:W.FLOAT,[t.RGBA16F]:W.FLOAT,[t.R32F]:W.FLOAT,[t.RG32F]:W.FLOAT,[t.RGB32F]:W.FLOAT,[t.RGBA32F]:W.FLOAT,[t.R11F_G11F_B10F]:W.FLOAT,[t.RGB9_E5]:W.FLOAT,[t.R8I]:W.INT,[t.R8UI]:W.UINT,[t.R16I]:W.INT,[t.R16UI]:W.UINT,[t.R32I]:W.INT,[t.R32UI]:W.UINT,[t.RG8I]:W.INT,[t.RG8UI]:W.UINT,[t.RG16I]:W.INT,[t.RG16UI]:W.UINT,[t.RG32I]:W.INT,[t.RG32UI]:W.UINT,[t.RGB8I]:W.INT,[t.RGB8UI]:W.UINT,[t.RGB16I]:W.INT,[t.RGB16UI]:W.UINT,[t.RGB32I]:W.INT,[t.RGB32UI]:W.UINT,[t.RGBA8I]:W.INT,[t.RGBA8UI]:W.UINT,[t.RGBA16I]:W.INT,[t.RGBA16UI]:W.UINT,[t.RGBA32I]:W.INT,[t.RGBA32UI]:W.UINT,[t.DEPTH_COMPONENT16]:W.FLOAT,[t.DEPTH_COMPONENT24]:W.FLOAT,[t.DEPTH_COMPONENT32F]:W.FLOAT,[t.DEPTH_STENCIL]:W.FLOAT,[t.DEPTH24_STENCIL8]:W.FLOAT,[t.DEPTH32F_STENCIL8]:W.FLOAT}:e={[t.RGB]:W.FLOAT,[t.RGBA]:W.FLOAT,[t.ALPHA]:W.FLOAT,[t.LUMINANCE]:W.FLOAT,[t.LUMINANCE_ALPHA]:W.FLOAT,[t.DEPTH_STENCIL]:W.FLOAT},e}function vP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[te.UNSIGNED_BYTE]:{[$.RGBA]:t.RGBA8,[$.RGB]:t.RGB8,[$.RG]:t.RG8,[$.RED]:t.R8,[$.RGBA_INTEGER]:t.RGBA8UI,[$.RGB_INTEGER]:t.RGB8UI,[$.RG_INTEGER]:t.RG8UI,[$.RED_INTEGER]:t.R8UI,[$.ALPHA]:t.ALPHA,[$.LUMINANCE]:t.LUMINANCE,[$.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[te.BYTE]:{[$.RGBA]:t.RGBA8_SNORM,[$.RGB]:t.RGB8_SNORM,[$.RG]:t.RG8_SNORM,[$.RED]:t.R8_SNORM,[$.RGBA_INTEGER]:t.RGBA8I,[$.RGB_INTEGER]:t.RGB8I,[$.RG_INTEGER]:t.RG8I,[$.RED_INTEGER]:t.R8I},[te.UNSIGNED_SHORT]:{[$.RGBA_INTEGER]:t.RGBA16UI,[$.RGB_INTEGER]:t.RGB16UI,[$.RG_INTEGER]:t.RG16UI,[$.RED_INTEGER]:t.R16UI,[$.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[te.SHORT]:{[$.RGBA_INTEGER]:t.RGBA16I,[$.RGB_INTEGER]:t.RGB16I,[$.RG_INTEGER]:t.RG16I,[$.RED_INTEGER]:t.R16I},[te.UNSIGNED_INT]:{[$.RGBA_INTEGER]:t.RGBA32UI,[$.RGB_INTEGER]:t.RGB32UI,[$.RG_INTEGER]:t.RG32UI,[$.RED_INTEGER]:t.R32UI,[$.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[te.INT]:{[$.RGBA_INTEGER]:t.RGBA32I,[$.RGB_INTEGER]:t.RGB32I,[$.RG_INTEGER]:t.RG32I,[$.RED_INTEGER]:t.R32I},[te.FLOAT]:{[$.RGBA]:t.RGBA32F,[$.RGB]:t.RGB32F,[$.RG]:t.RG32F,[$.RED]:t.R32F,[$.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[te.HALF_FLOAT]:{[$.RGBA]:t.RGBA16F,[$.RGB]:t.RGB16F,[$.RG]:t.RG16F,[$.RED]:t.R16F},[te.UNSIGNED_SHORT_5_6_5]:{[$.RGB]:t.RGB565},[te.UNSIGNED_SHORT_4_4_4_4]:{[$.RGBA]:t.RGBA4},[te.UNSIGNED_SHORT_5_5_5_1]:{[$.RGBA]:t.RGB5_A1},[te.UNSIGNED_INT_2_10_10_10_REV]:{[$.RGBA]:t.RGB10_A2,[$.RGBA_INTEGER]:t.RGB10_A2UI},[te.UNSIGNED_INT_10F_11F_11F_REV]:{[$.RGB]:t.R11F_G11F_B10F},[te.UNSIGNED_INT_5_9_9_9_REV]:{[$.RGB]:t.RGB9_E5},[te.UNSIGNED_INT_24_8]:{[$.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[te.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[$.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[te.UNSIGNED_BYTE]:{[$.RGBA]:t.RGBA,[$.RGB]:t.RGB,[$.ALPHA]:t.ALPHA,[$.LUMINANCE]:t.LUMINANCE,[$.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[te.UNSIGNED_SHORT_5_6_5]:{[$.RGB]:t.RGB},[te.UNSIGNED_SHORT_4_4_4_4]:{[$.RGBA]:t.RGBA},[te.UNSIGNED_SHORT_5_5_5_1]:{[$.RGBA]:t.RGBA}},e}class c1{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new he,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=vP(e),this.samplerTypes=xP(e);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new _h(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new _h(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,r=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:r,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}ensureSamplerType(e){const{boundTextures:r,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let s=e-1;s>=0;--s){const o=r[s];o&&o._glTextures[i].samplerType!==W.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const r=new _h(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){var n;r.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,r.samplerType=this.samplerTypes[r.internalFormat]??W.FLOAT,this.webGLVersion===2&&e.type===te.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){var i;const r=e._glTextures[this.CONTEXT_UID];if(!r)return;const n=this.renderer;if(this.initTextureType(e,r),(i=e.resource)==null?void 0:i.upload(n,e,r))r.samplerType!==W.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=n.gl;(r.width!==s||r.height!==o||r.dirtyId<0)&&(r.width=s,r.height=o,a.texImage2D(e.target,0,r.internalFormat,s,o,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(e);i!==-1&&Ts(this.managedTextures,i,1)}}updateTextureStyle(e){var n;const r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===jr.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=Gn.CLAMP:r.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){const n=this.gl;if(r.mipmap&&e.mipmap!==jr.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Kr.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===Kr.LINEAR){const s=Math.min(e.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Kr.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===Kr.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}c1.extension={type:V.RendererSystem,name:"texture"};J.add(c1);class u1{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){const{gl:n,renderer:i}=this;r&&i.shader.bind(r),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:r,renderer:n,CONTEXT_UID:i}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[i]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(n.buffer.update(a),a._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){const n=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&s.dispose(a,r))}n&&(r||i.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}u1.extension={type:V.RendererSystem,name:"transformFeedback"};J.add(u1);class yc{constructor(e){this.renderer=e}init(e){this.screen=new fe(0,0,e.width,e.height),this.element=e.view||X.ADAPTER.createCanvas(),this.resolution=e.resolution||X.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var r;e&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}yc.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},yc.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"_view"};J.add(yc);X.PREFER_ENV=Mi.WEBGL2;X.STRICT_TEXTURE_CACHE=!1;X.RENDER_OPTIONS={...mc.defaultOptions,...pc.defaultOptions,...yc.defaultOptions,...gc.defaultOptions};Object.defineProperties(X,{WRAP_MODE:{get(){return he.defaultOptions.wrapMode},set(t){ge("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),he.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return he.defaultOptions.scaleMode},set(t){ge("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),he.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return he.defaultOptions.mipmap},set(t){ge("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),he.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return he.defaultOptions.anisotropicLevel},set(t){ge("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),he.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return ge("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),wt.defaultResolution},set(t){wt.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return ge("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),wt.defaultMultisample},set(t){wt.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return ai.defaultMaxTextures},set(t){ge("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ai.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return ai.defaultBatchSize},set(t){ge("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ai.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return ai.canUploadSameBuffer},set(t){ge("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ai.canUploadSameBuffer=t}},GC_MODE:{get(){return li.defaultMode},set(t){ge("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),li.defaultMode=t}},GC_MAX_IDLE:{get(){return li.defaultMaxIdle},set(t){ge("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),li.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return li.defaultCheckCountMax},set(t){ge("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),li.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Zr.defaultVertexPrecision},set(t){ge("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Zr.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Zr.defaultFragmentPrecision},set(t){ge("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Zr.defaultFragmentPrecision=t}}});var Ai=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Ai||{});class wh{constructor(e,r=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=n,this.once=i}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const h1=class Dt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new wh(null,null,1/0),this.deltaMS=1/Dt.targetFPMS,this.elapsedMS=1/Dt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=Ai.NORMAL){return this._addListener(new wh(e,r,n))}addOnce(e,r,n=Ai.NORMAL){return this._addListener(new wh(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*Dt.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,Dt.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!Dt._shared){const e=Dt._shared=new Dt;e.autoStart=!0,e._protected=!0}return Dt._shared}static get system(){if(!Dt._system){const e=Dt._system=new Dt;e.autoStart=!0,e._protected=!0}return Dt._system}};h1.targetFPMS=.06;let Ut=h1;Object.defineProperties(X,{TARGET_FPMS:{get(){return Ut.targetFPMS},set(t){ge("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ut.targetFPMS=t}}});class d1{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Ai.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Ut.shared:new Ut,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}d1.extension=V.Application;J.add(d1);const f1=[];J.handleByList(V.Renderer,f1);function _P(t){for(const e of f1)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var wP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,SP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const bP=wP,p1=SP;class m1{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}r>=Ke.HIGH?this.multisample=Ke.HIGH:r>=Ke.MEDIUM?this.multisample=Ke.MEDIUM:r>=Ke.LOW?this.multisample=Ke.LOW:this.multisample=Ke.NONE}destroy(){}}m1.extension={type:V.RendererSystem,name:"_multisample"};J.add(m1);class EP{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class g1{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);r.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[r]=e,n.bindBufferBase(n.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,n){const{gl:i,CONTEXT_UID:s}=this;n=n||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,o.buffer,n*256,256)}update(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{const s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),n&&(r||i.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const r=Object.keys(this.managedBuffers);for(let n=0;n<r.length;n++)this.dispose(this.managedBuffers[r[n]],e)}createGLBuffer(e){const{CONTEXT_UID:r,gl:n}=this;return e._glBuffers[r]=new EP(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}}g1.extension={type:V.RendererSystem,name:"buffer"};J.add(g1);class y1{constructor(e){this.renderer=e}render(e,r){const n=this.renderer;let i,s,o,a;if(r&&(i=r.renderTexture,s=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=o,!n.context.isLost){if(i||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(s??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),i&&(r.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}y1.extension={type:V.RendererSystem,name:"objectRenderer"};J.add(y1);const Pl=class af extends yP{constructor(e){super(),this.type=Z0.WEBGL,e=Object.assign({},X.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new yr({projectionMatrix:new Ne},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:af.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in e&&(ge("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=af.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:X2()}render(e,r){this.objectRenderer.render(e,r)}resize(e,r){this._view.resizeView(e,r)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return ge("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return ge("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return ge("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return ge("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){ge("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return ge("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){ge("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return ge("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,r){return this.textureGenerator.generateTexture(e,r)}};Pl.extension={type:V.Renderer,priority:1},Pl.__plugins={},Pl.__systems={};let Op=Pl;J.handleByMap(V.RendererPlugin,Op.__plugins);J.handleByMap(V.RendererSystem,Op.__systems);J.add(Op);class x1 extends sa{constructor(e,r){const{width:n,height:i}=r||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new he;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof sa?this.addResourceAt(e[n],n):this.addResourceAt(F_(e[n],r),n))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(e).then(()=>{const{realWidth:r,realHeight:n}=this.items[0];return this.resize(r,n),this.update(),Promise.resolve(this)}),this._load}}class TP extends x1{constructor(e,r){const{width:n,height:i}=r||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:n,height:i}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Ss.TEXTURE_2D_ARRAY}upload(e,r,n){const{length:i,itemDirtyIds:s,items:o}=this,{gl:a}=e;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,r.format,n.type,null);for(let l=0;l<i;l++){const c=o[l];s[l]<c.dirtyId&&(s[l]=c.dirtyId,c.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,c.resource.width,c.resource.height,1,r.format,n.type,c.resource.source))}return!0}}class AP extends an{constructor(e){super(e)}static test(e){const{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const v1=class go extends x1{constructor(e,r){const{width:n,height:i,autoLoad:s,linkBaseTexture:o}=r||{};if(e&&e.length!==go.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:n,height:i});for(let a=0;a<go.SIDES;a++)this.items[a].target=Ss.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,r),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Ss.TEXTURE_CUBE_MAP}addBaseTextureAt(e,r,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[r])throw new Error(`Index ${r} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Ss.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this}upload(e,r,n){const i=this.itemDirtyIds;for(let s=0;s<go.SIDES;s++){const o=this.items[s];(i[s]<o.dirtyId||n.dirtyId<r.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===go.SIDES}};v1.SIDES=6;let CP=v1;class ms extends an{constructor(e,r){r=r||{};let n,i,s;typeof e=="string"?(n=ms.EMPTY,i=e,s=!0):(n=e,i=null,s=!1),super(n),this.url=i,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.ownsImageBitmap=r.ownsImageBitmap??s,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{const n=await X.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Pt.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(n){if(this.destroyed)return;r(n),this.onError.emit(n)}}),this._load)}upload(e,r,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return ms._EMPTY=ms._EMPTY??X.ADAPTER.createCanvas(0,0),ms._EMPTY}}const lf=class Il extends an{constructor(e,r){r=r||{},super(X.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},Il.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;an.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=r=>{this._resolve&&(e.onerror=null,this.onError.emit(r))},e.onload=()=>{if(!this._resolve)return;const r=e.width,n=e.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=r*this.scale,s=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/n*r,s=this._overrideHeight||this._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);const o=this.source;o.width=i,o.height=s,o._pixiId=`canvas_${Ti()}`,o.getContext("2d").drawImage(e,0,0,r,n,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){const r=Il.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,r){return r==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Il.SVG_XML.test(e)}};lf.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,lf.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let cf=lf;class RP extends an{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const uf=class hf extends an{constructor(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){const n=document.createElement("video");r.autoLoad!==!1&&n.setAttribute("preload","auto"),r.playsinline!==!1&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),r.muted===!0&&(n.setAttribute("muted",""),n.muted=!0),r.loop===!0&&n.setAttribute("loop",""),r.autoPlay!==!1&&n.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];an.crossOrigin(n,i,r.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const c=a.split("?").shift().toLowerCase(),h=c.slice(c.lastIndexOf(".")+1);l=l||hf.MIME_TYPES[h]||`video/${h}`}o.src=a,l&&(o.type=l),n.appendChild(o)}e=n}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=r.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),r.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const r=Ut.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((r,n)=>{this.valid?r(this):(this._resolve=r,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const r=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!r&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ut.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,r){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||hf.TYPES.includes(r)}};uf.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],uf.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let _1=uf;qd.push(ms,V_,AP,_1,RP,cf,Kc,CP,TP);class xc{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?fe.EMPTY:(e=e||new fe(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){const{a:n,b:i,c:s,d:o,tx:a,ty:l}=e,c=n*r.x+s*r.y+a,h=i*r.x+o*r.y+l;this.minX=Math.min(this.minX,c),this.maxX=Math.max(this.maxX,c),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(e){let r=this.minX,n=this.minY,i=this.maxX,s=this.maxY,o=e[0],a=e[1];r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[2],a=e[3],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[4],a=e[5],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[6],a=e[7],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,this.minX=r,this.minY=n,this.maxX=i,this.maxY=s}addFrame(e,r,n,i,s){this.addFrameMatrix(e.worldTransform,r,n,i,s)}addFrameMatrix(e,r,n,i,s){const o=e.a,a=e.b,l=e.c,c=e.d,h=e.tx,d=e.ty;let f=this.minX,p=this.minY,g=this.maxX,v=this.maxY,_=o*r+l*n+h,y=a*r+c*n+d;f=_<f?_:f,p=y<p?y:p,g=_>g?_:g,v=y>v?y:v,_=o*i+l*n+h,y=a*i+c*n+d,f=_<f?_:f,p=y<p?y:p,g=_>g?_:g,v=y>v?y:v,_=o*r+l*s+h,y=a*r+c*s+d,f=_<f?_:f,p=y<p?y:p,g=_>g?_:g,v=y>v?y:v,_=o*i+l*s+h,y=a*i+c*s+d,f=_<f?_:f,p=y<p?y:p,g=_>g?_:g,v=y>v?y:v,this.minX=f,this.minY=p,this.maxX=g,this.maxY=v}addVertexData(e,r,n){let i=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=r;l<n;l+=2){const c=e[l],h=e[l+1];i=c<i?c:i,s=h<s?h:s,o=c>o?c:o,a=h>a?h:a}this.minX=i,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,r,n,i){this.addVerticesMatrix(e.worldTransform,r,n,i)}addVerticesMatrix(e,r,n,i,s=0,o=s){const a=e.a,l=e.b,c=e.c,h=e.d,d=e.tx,f=e.ty;let p=this.minX,g=this.minY,v=this.maxX,_=this.maxY;for(let y=n;y<i;y+=2){const x=r[y],m=r[y+1],w=a*x+c*m+d,b=h*m+l*x+f;p=Math.min(p,w-s),v=Math.max(v,w+s),g=Math.min(g,b-o),_=Math.max(_,b+o)}this.minX=p,this.minY=g,this.maxX=v,this.maxY=_}addBounds(e){const r=this.minX,n=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,r){const n=e.minX>r.minX?e.minX:r.minX,i=e.minY>r.minY?e.minY:r.minY,s=e.maxX<r.maxX?e.maxX:r.maxX,o=e.maxY<r.maxY?e.maxY:r.maxY;if(n<=s&&i<=o){const a=this.minX,l=this.minY,c=this.maxX,h=this.maxY;this.minX=n<a?n:a,this.minY=i<l?i:l,this.maxX=s>c?s:c,this.maxY=o>h?o:h}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){const n=e.minX>r.x?e.minX:r.x,i=e.minY>r.y?e.minY:r.y,s=e.maxX<r.x+r.width?e.maxX:r.x+r.width,o=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(n<=s&&i<=o){const a=this.minX,l=this.minY,c=this.maxX,h=this.maxY;this.minX=n<a?n:a,this.minY=i<l?i:l,this.maxX=s>c?s:c,this.maxY=o>h?o:h}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,n,i,s,o){e-=s,r-=o,n+=s,i+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class He extends fa{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Dp,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new xc,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.defineProperty(He.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new fe),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new fe),e=this._localBoundsRect),this._localBounds||(this._localBounds=new xc);const r=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(n==null?void 0:n.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=n,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,n,i){return r&&(e=r.toGlobal(e,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,r=0,n=1,i=1,s=0,o=0,a=0,l=0,c=0){return this.position.x=e,this.position.y=r,this.scale.x=n||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=c,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new PP),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*wR}set angle(e){this.transform.rotation=e*SR}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class PP extends He{constructor(){super(...arguments),this.sortDirty=null}}He.prototype.displayObjectUpdateTransform=He.prototype.updateTransform;const IP=new Ne;function kP(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const w1=class df extends He{constructor(){super(),this.children=[],this.sortableChildren=df.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.addChild(e[r]);else{const r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]}addChildAt(e,r){if(r<0||r>this.children.length)throw new Error(`${e}addChildAt: The index ${r} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e}swapChildren(e,r){if(e===r)return;const n=this.getChildIndex(e),i=this.getChildIndex(r);this.children[n]=r,this.children[i]=e,this.onChildrenChange(n<i?n:i)}getChildIndex(e){const r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r}setChildIndex(e,r){if(r<0||r>=this.children.length)throw new Error(`The index ${r} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(e);Ts(this.children,n,1),this.children.splice(r,0,e),this.onChildrenChange(r)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.removeChild(e[r]);else{const r=e[0],n=this.children.indexOf(r);if(n===-1)return null;r.parent=null,r.transform._parentID=-1,Ts(this.children,n,1),this._boundsID++,this.onChildrenChange(n),r.emit("removed",this),this.emit("childRemoved",r,this,n)}return e[0]}removeChildAt(e){const r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,Ts(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r}removeChildren(e=0,r=this.children.length){const n=e,i=r,s=i-n;let o;if(s>0&&s<=i){o=this.children.splice(n,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let r=0,n=this.children.length;r<n;++r){const i=this.children[r];i._lastSortedIndex=r,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(kP),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,r=this.children.length;e<r;++e){const n=this.children[e];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const r=this.children[e];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){const n=r._mask.isMaskData?r._mask.maskObject:r._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,r=!1){const n=super.getLocalBounds(e);if(!r)for(let i=0,s=this.children.length;i<s;++i){const o=this.children[i];o.visible&&o.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const r=e.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==df.prototype._render&&(n=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=IP.copyFrom(i),i.prepend(s)):i=s),n&&r.intersects(n,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],c=l.cullable;l.cullable=c||!this.cullArea,l.render(e),l.cullable=c}}render(e){var r;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(r=this.filters)!=null&&r.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,i=this.children.length;n<i;++n)this.children[n].render(e)}}renderAdvanced(e){var s,o,a;const r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<r.length;l++)r[l].enabled&&this._enabledFilters.push(r[l])}const i=r&&((s=this._enabledFilters)==null?void 0:s.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==Je.NONE));if(i&&e.batch.flush(),r&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,c=this.children.length;l<c;++l)this.children[l].render(e)}i&&e.batch.flush(),n&&e.mask.pop(this),r&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const r=typeof e=="boolean"?e:e==null?void 0:e.children,n=this.removeChildren(0,this.children.length);if(r)for(let i=0;i<n.length;++i)n[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const r=this.getLocalBounds().width;r!==0?this.scale.x=e/r:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const r=this.getLocalBounds().height;r!==0?this.scale.y=e/r:this.scale.y=1,this._height=e}};w1.defaultSortableChildren=!1;let Nt=w1;Nt.prototype.containerUpdateTransform=Nt.prototype.updateTransform;Object.defineProperties(X,{SORTABLE_CHILDREN:{get(){return Nt.defaultSortableChildren},set(t){ge("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Nt.defaultSortableChildren=t}}});const ao=new _e,MP=new Uint16Array([0,1,2,0,2,3]);class Wn extends Nt{constructor(e){super(),this._anchor=new Qr(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Me(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=se.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Z.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=MP,this.pluginName="batch",this.isSprite=!0,this._roundPixels=X.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=In(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=In(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,c=this.vertexData,h=e.trim,d=e.orig,f=this._anchor;let p=0,g=0,v=0,_=0;if(h?(g=h.x-f._x*d.width,p=g+h.width,_=h.y-f._y*d.height,v=_+h.height):(g=-f._x*d.width,p=g+d.width,_=-f._y*d.height,v=_+d.height),c[0]=n*g+s*_+a,c[1]=o*_+i*g+l,c[2]=n*p+s*_+a,c[3]=o*_+i*p+l,c[4]=n*p+s*v+a,c[5]=o*v+i*p+l,c[6]=n*g+s*v+a,c[7]=o*v+i*g+l,this._roundPixels){const y=X.RESOLUTION;for(let x=0;x<c.length;++x)c[x]=Math.round(c[x]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,r=this.vertexTrimmedData,n=e.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,c=s.d,h=s.tx,d=s.ty,f=-i._x*n.width,p=f+n.width,g=-i._y*n.height,v=g+n.height;if(r[0]=o*f+l*g+h,r[1]=c*g+a*f+d,r[2]=o*p+l*g+h,r[3]=c*g+a*p+d,r[4]=o*p+l*v+h,r[5]=c*v+a*p+d,r[6]=o*f+l*v+h,r[7]=c*v+a*f+d,this._roundPixels){const _=X.RESOLUTION;for(let y=0;y<r.length;++y)r[y]=Math.round(r[y]*_)/_}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new xc),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new fe),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,ao);const r=this._texture.orig.width,n=this._texture.orig.height,i=-r*this.anchor.x;let s=0;return ao.x>=i&&ao.x<i+r&&(s=-n*this.anchor.y,ao.y>=s&&ao.y<s+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const r=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(e,r){const n=e instanceof Z?e:Z.from(e,r);return new Wn(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const r=In(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const r=In(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Z.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const S1=new Ne;He.prototype._cacheAsBitmap=!1;He.prototype._cacheData=null;He.prototype._cacheAsBitmapResolution=null;He.prototype._cacheAsBitmapMultisample=null;class BP{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(He.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new BP),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});He.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};He.prototype._initCachedDisplayObject=function(t){var f,p;if((f=this._cacheData)!=null&&f.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(new fe,!0);if((p=this.filters)!=null&&p.length){const g=this.filters[0].padding;r.pad(g)}const n=this.cacheAsBitmapResolution||t.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=Ni.create({width:r.width,height:r.height,resolution:n,multisample:this.cacheAsBitmapMultisample??t.multisample}),c=`cacheAsBitmap_${Ti()}`;this._cacheData.textureCacheId=c,he.addToCache(l.baseTexture,c),Z.addToCache(l,c);const h=this.transform.localTransform.copyTo(S1).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:h,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const d=new Wn(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(r.x/r.width),d.anchor.y=-(r.y/r.height),d.alpha=e,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)};He.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};He.prototype._initCachedDisplayObjectCanvas=function(t){var h;if((h=this._cacheData)!=null&&h.sprite)return;const e=this.getLocalBounds(new fe,!0),r=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Ni.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${Ti()}`;this._cacheData.textureCacheId=a,he.addToCache(o.baseTexture,a),Z.addToCache(o,a);const l=S1;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const c=new Wn(o);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(e.x/e.width),c.anchor.y=-(e.y/e.height),c.alpha=r,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=c.containsPoint.bind(c)};He.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};He.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};He.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,he.removeFromCache(this._cacheData.textureCacheId),Z.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};He.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};He.prototype.name=null;Nt.prototype.getChildByName=function(t,e){for(let r=0,n=this.children.length;r<n;r++)if(this.children[r].name===t)return this.children[r];if(e)for(let r=0,n=this.children.length;r<n;r++){const i=this.children[r];if(!i.getChildByName)continue;const s=i.getChildByName(t,!0);if(s)return s}return null};He.prototype.getGlobalPosition=function(t=new _e,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var NP=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class LP extends wt{constructor(e=1){super(bP,NP,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const FP={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},DP=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function jP(t){const e=FP[t],r=e.length;let n=DP,i="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let l=s.replace("%index%",a.toString());o=a,a>=r&&(o=t-a-1),l=l.replace("%value%",e[o].toString()),i+=l,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}const OP=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function UP(t,e){const r=Math.ceil(t/2);let n=OP,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),i+=a,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}class ff extends wt{constructor(e,r=8,n=4,i=wt.defaultResolution,s=5){const o=UP(s,e),a=jP(s);super(o,a),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=n,this.blur=r}apply(e,r,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,n,i);else{const s=e.getFilterTexture(),o=e.renderer;let a=r,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Ir.CLEAR);for(let c=1;c<this.passes-1;c++){e.bindAndClear(a,Ir.BLIT),this.uniforms.uSampler=l;const h=l;l=a,a=h,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,n,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class GP extends wt{constructor(e=8,r=4,n=wt.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new ff(!0,e,r,n,i),this.blurYFilter=new ff(!1,e,r,n,i),this.resolution=n,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,n,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,r,a,Ir.CLEAR),this.blurYFilter.apply(e,a,n,i),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,r,n,i):this.blurXFilter.apply(e,r,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var zP=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class pf extends wt{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(p1,zP,e),this.alpha=1}_loadMatrix(e,r=!1){let n=e;r&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,r,n){return e[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],e[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],e[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],e[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],e[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],e[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],e[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],e[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],e[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],e[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],e[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],e[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],e[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],e[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],e[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],e[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],e[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],e[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],e[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],e[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],e}_colorMatrix(e){const r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(e,r){const[n,i,s]=Me.shared.setValue(e).toArray(),o=[n,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(e,r){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(e){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;const n=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=n+(1-n)*o,c=o*(1-n)-a*i,h=o*(1-n)+a*i,d=o*(1-n)+a*i,f=n+o*(1-n),p=o*(1-n)-a*i,g=o*(1-n)-a*i,v=o*(1-n)+a*i,_=n+o*(1-n),y=[l,c,h,0,0,d,f,p,0,0,g,v,_,0,0,0,0,0,1,0];this._loadMatrix(y,r)}contrast(e,r){const n=(e||0)+1,i=-.5*(n-1),s=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(s,r)}saturate(e=0,r){const n=e*2/3+1,i=(n-1)*-.5,s=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(e){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,n,i,s){e=e||.2,r=r||.15,n=n||16770432,i=i||3375104;const o=Me.shared,[a,l,c]=o.setValue(n).toArray(),[h,d,f]=o.setValue(i).toArray(),p=[.3,.59,.11,0,0,a,l,c,e,0,h,d,f,r,0,a-h,l-d,c-f,0,0];this._loadMatrix(p,s)}night(e,r){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(e,r){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,r)}lsd(e){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}pf.prototype.grayscale=pf.prototype.greyscale;var HP=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,$P=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class VP extends wt{constructor(e,r){const n=new Ne;e.renderable=!1,super($P,HP,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,r==null&&(r=20),this.scale=new _e(r,r)}apply(e,r,n,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,r,n,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var WP=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,XP=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class YP extends wt{constructor(){super(XP,WP)}}var KP=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class qP extends wt{constructor(e=.5,r=Math.random()){super(p1,KP,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const Gy={AlphaFilter:LP,BlurFilter:GP,BlurFilterPass:ff,ColorMatrixFilter:pf,DisplacementFilter:VP,FXAAFilter:YP,NoiseFilter:qP};Object.entries(Gy).forEach(([t,e])=>{Object.defineProperty(Gy,t,{get(){return ge("7.1.0",`filters.${t} has moved to ${t}`),e}})});class QP{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(Ut.system.add(this.tickerUpdate,this,Ai.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Ut.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Tn=new QP;class ya{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ya.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new _e,this.page=new _e,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,n,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class vc extends ya{constructor(){super(...arguments),this.client=new _e,this.movement=new _e,this.offset=new _e,this.global=new _e,this.screen=new _e}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,r,n){return e.worldTransform.applyInverse(n||this.global,r)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,n,i,s,o,a,l,c,h,d,f,p,g,v){throw new Error("Method not implemented.")}}class cr extends vc{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Cs extends vc{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Cs.DOM_DELTA_PIXEL=0,Cs.DOM_DELTA_LINE=1,Cs.DOM_DELTA_PAGE=2;const ZP=2048,JP=new _e,Sh=new _e;class eI{constructor(e){this.dispatch=new fa,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const r=this.mappingTable[e.type];if(r)for(let n=0,i=r.length;n<i;n++)r[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){Tn.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[n](this.rootTarget,this.rootTarget.eventMode,JP.set(e,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,r){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=n.length-1;i<s;i++)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(r)?r:[r];for(let s=n.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=n[s],this.notifyTarget(e,o)})}propagationPath(e){const r=[e];for(let n=0;n<ZP&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestMoveRecursive(e,r,n,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(Tn.pauseUpdate=!1),e.interactiveChildren&&e.children){const h=e.children;for(let d=h.length-1;d>=0;d--){const f=h[d],p=this.hitTestMoveRecursive(f,this._isInteractive(r)?r:f.eventMode,n,i,s,o||s(e,n));if(p){if(p.length>0&&!p[p.length-1].parent)continue;const g=e.isInteractive();(p.length>0||g)&&(g&&this._allInteractiveElements.push(e),p.push(e)),this._hitElements.length===0&&(this._hitElements=p),a=!0}}}const l=this._isInteractive(r),c=e.isInteractive();return l&&c&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,n)&&i(e,n)?c?[e]:[]:null}hitTestRecursive(e,r,n,i,s){if(this._interactivePrune(e)||s(e,n))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(Tn.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let c=l.length-1;c>=0;c--){const h=l[c],d=this.hitTestRecursive(h,this._isInteractive(r)?r:h.eventMode,n,i,s);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const f=e.isInteractive();return(d.length>0||f)&&d.push(e),d}}}const o=this._isInteractive(r),a=e.isInteractive();return o&&i(e,n)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,r){var n;if(e.hitArea&&(e.worldTransform.applyInverse(r,Sh),!e.hitArea.contains(Sh.x,Sh.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,r)))return!0}return!1}hitTestFn(e,r){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){var s,o;r=r??e.type;const n=`on${r}`;(o=(s=e.currentTarget)[n])==null||o.call(s,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof cr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){var l,c;if(!(e instanceof cr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(((l=i.overTargets)==null?void 0:l.length)>0&&s!==r.target){const h=e.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(e,h,s);if(this.dispatchEvent(d,"pointerout"),n&&this.dispatchEvent(d,"mouseout"),!r.composedPath().includes(s)){const f=this.createPointerEvent(e,"pointerleave",s);for(f.eventPhase=f.AT_TARGET;f.target&&!r.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),n&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(d)}if(s!==r.target){const h=e.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(r,h);this.dispatchEvent(d,"pointerover"),n&&this.dispatchEvent(d,"mouseover");let f=s==null?void 0:s.parent;for(;f&&f!==this.rootTarget.parent&&f!==r.target;)f=f.parent;if(!f||f===this.rootTarget.parent){const p=this.clonePointerEvent(r,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==s&&p.target!==this.rootTarget.parent;)p.currentTarget=p.target,this.notifyTarget(p),n&&this.notifyTarget(p,"mouseenter"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(d)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),n&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(c=r.target)==null?void 0:c.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){var o;if(!(e instanceof cr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(o=n.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(n,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof cr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId);if(r.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),n&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof cr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const a=n.button===2;this.dispatchEvent(n,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!n.composedPath().includes(s)){let a=s;for(;a&&!n.composedPath().includes(a);){if(n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.notifyTarget(n,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(n,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:r});const l=i.clicksByButton[e.button];if(l.target===a.target&&r-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=r,a.detail=l.clickCount,a.pointerType==="mouse"){const c=a.button===2;this.dispatchEvent(a,c?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof cr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let s=n;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof Cs)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let n=1;n<e.length&&e[n].parent===r;n++)r=e[n];return r}createPointerEvent(e,r,n){const i=this.allocateEvent(cr);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof r=="string"&&(i.type=r),i}createWheelEvent(e){const r=this.allocateEvent(Cs);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){const n=this.allocateEvent(cr);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=r??n.type,n}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof cr&&r instanceof cr&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof vc&&r instanceof vc&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.shiftKey=e.shiftKey,r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){const n=e.currentTarget._events[r];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(r,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let i=0,s=n.length;i<s&&!e.propagationImmediatelyStopped;i++)n[i].once&&e.currentTarget.removeListener(r,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,e)}}const tI=1,rI={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},mf=class gf{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new eI(null),Tn.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new cr(null),this.rootWheelEvent=new Cs(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...gf.defaultEventFeatures},{set:(r,n,i)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),r[n]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,gf._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=r.length;n<i;n++){const s=r[n],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Tn.pointerMoved();const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let r=e.target;e.composedPath&&e.composedPath().length>0&&(r=e.composedPath()[0]);const n=r!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,i[s]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const r=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(e){this.removeEvents(),this.domElement=e,Tn.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Tn.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Tn.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,r,n){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(r-i.left)*(this.domElement.width/i.width)*s,e.y=(n-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){const r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const s=e.changedTouches[n];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,r.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=tI),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(e);return r}normalizeWheelEvent(e){const r=this.rootWheelEvent;return this.transferMouseData(r,e),r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ,r.deltaMode=e.deltaMode,this.mapPositionToPoint(r.screen,e.clientX,e.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=e,r.type=e.type,r}bootstrapEvent(e,r){return e.originalEvent=null,e.nativeEvent=r,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r),this.mapPositionToPoint(e.screen,r.clientX,r.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=r.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=rI[e.type]||e.type),e}transferMouseData(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=performance.now(),e.type=r.type,e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.relatedTarget=null,e.shiftKey=r.shiftKey}};mf.extension={name:"events",type:[V.RendererSystem,V.CanvasRendererSystem]},mf.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let yf=mf;J.add(yf);function zy(t){return t==="dynamic"||t==="static"}const nI={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??zy(yf.defaultEventMode)},set interactive(t){ge("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??yf.defaultEventMode},set eventMode(t){this._internalInteractive=zy(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof r=="object"?r.signal:void 0,s=typeof r=="object"?r.once===!0:!1,o=typeof e=="function"?void 0:e;t=n?`${t}capture`:t;const a=typeof e=="function"?e:e.handleEvent,l=this;i&&i.addEventListener("abort",()=>{l.off(t,a,o)}),s?l.once(t,a,o):l.on(t,a,o)},removeEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof ya))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};He.mixin(nI);const iI={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};He.mixin(iI);const sI=9,Ja=100,oI=0,aI=0,Hy=2,$y=1,lI=-1e3,cI=-1e3,uI=2;class b1{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(qr.tablet||qr.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${Ja}px`,r.style.height=`${Ja}px`,r.style.position="absolute",r.style.top=`${oI}px`,r.style.left=`${aI}px`,r.style.zIndex=Hy.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${$y}px`,e.style.height=`${$y}px`,e.style.position="absolute",e.style.top=`${lI}px`,e.style.left=`${cI}px`,e.style.zIndex=uI.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const r=e.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const e=performance.now();if(qr.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,c=i/o*l,h=s/a*l;let d=this.div;d.style.left=`${r}px`,d.style.top=`${n}px`,d.style.width=`${o}px`,d.style.height=`${a}px`;for(let f=0;f<this.children.length;f++){const p=this.children[f];if(p.renderId!==this.renderId)p._accessibleActive=!1,Ts(this.children,f,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,f--;else{d=p._accessibleDiv;let g=p.hitArea;const v=p.worldTransform;p.hitArea?(d.style.left=`${(v.tx+g.x*v.a)*c}px`,d.style.top=`${(v.ty+g.y*v.d)*h}px`,d.style.width=`${g.width*v.a*c}px`,d.style.height=`${g.height*v.d*h}px`):(g=p.getBounds(),this.capHitArea(g),d.style.left=`${g.x*c}px`,d.style.top=`${g.y*h}px`,d.style.width=`${g.width*c}px`,d.style.height=`${g.height*h}px`,d.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(d.title=p.accessibleTitle),d.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&d.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==d.title||p.tabIndex!==d.tabIndex)&&(d.title=p.accessibleTitle,d.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:r,height:n}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${Ja}px`,r.style.height=`${Ja}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=Hy.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){const{displayObject:n}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new ya(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===sI&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}b1.extension={name:"accessibility",type:[V.RendererPlugin,V.CanvasRendererPlugin]};J.add(b1);const E1=class xf{constructor(e){this.stage=new Nt,e=Object.assign({forceCanvas:!1},e),this.renderer=_P(e),xf._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,r){const n=xf._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};E1._plugins=[];let T1=E1;J.handleByList(V.Application,T1._plugins);class A1{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;r=i,n=s}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}A1.extension=V.Application;J.add(A1);const Vy={loader:V.LoadParser,resolver:V.ResolveParser,cache:V.CacheParser,detection:V.DetectionParser};J.handle(V.Asset,t=>{const e=t.ref;Object.entries(Vy).filter(([r])=>!!e[r]).forEach(([r,n])=>J.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(Vy).filter(r=>!!e[r]).forEach(r=>J.remove(e[r]))});class hI{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Ws(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function Qn(t,e){const r=t.split("?")[0],n=lt.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const fr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t),vf=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t};function C1(t,e,r,n,i){const s=e[r];for(let o=0;o<s.length;o++){const a=s[o];r<e.length-1?C1(t.replace(n[r],a),e,r+1,n,i):i.push(t.replace(n[r],a))}}function dI(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const i=[];r.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),C1(t,i,0,r,n)}else n.push(t);return n}const _c=t=>!Array.isArray(t);class fI{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=fr(e);let i;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(r)){i=l.getCacheableAssets(n,r);break}}i||(i={},n.forEach(a=>{i[a]=r}));const s=Object.keys(i),o={cacheKeys:s,keys:n};if(n.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{const l=i?i[a]:r;this._cache.has(a)&&this._cache.get(a)!==l&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),r instanceof Z){const a=r;n.forEach(l=>{a.baseTexture!==Z.EMPTY.baseTexture&&he.addToCache(a.baseTexture,l),Z.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const ui=new fI;class pI{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{var o,a;let i=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.load&&((o=c.test)!=null&&o.call(c,e,r,this))){s=c;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,r,this),n.parser=s;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];c.parse&&c.parse&&await((a=c.testParse)==null?void 0:a.call(c,i,r,this))&&(i=await c.parse(i,r,this)||i,n.parser=c)}return i})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const i={},s=_c(e),o=fr(e,c=>({alias:[c],src:c})),a=o.length,l=o.map(async c=>{const h=lt.toAbsolute(c.src);if(!i[c.src])try{this.promiseCache[h]||(this.promiseCache[h]=this._getLoadPromiseAndParser(h,c)),i[c.src]=await this.promiseCache[h].promise,r&&r(++n/a)}catch(d){throw delete this.promiseCache[h],delete i[c.src],new Error(`[Loader.load] Failed to load ${h}.
${d}`)}});return await Promise.all(l),s?i[o[0].src]:i}async unload(e){const r=fr(e,n=>({alias:[n],src:n})).map(async n=>{var o,a;const i=lt.toAbsolute(n.src),s=this.promiseCache[i];if(s){const l=await s.promise;delete this.promiseCache[i],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,n,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(e[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...e,[r.name]:r}),{})}}var vr=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(vr||{});const mI=".json",gI="application/json",yI={extension:{type:V.LoadParser,priority:vr.Low},name:"loadJson",test(t){return Ws(t,gI)||Qn(t,mI)},async load(t){return await(await X.ADAPTER.fetch(t)).json()}};J.add(yI);const xI=".txt",vI="text/plain",_I={name:"loadTxt",extension:{type:V.LoadParser,priority:vr.Low},test(t){return Ws(t,vI)||Qn(t,xI)},async load(t){return await(await X.ADAPTER.fetch(t)).text()}};J.add(_I);const wI=["normal","bold","100","200","300","400","500","600","700","800","900"],SI=[".ttf",".otf",".woff",".woff2"],bI=["font/ttf","font/otf","font/woff","font/woff2"],EI=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function TI(t){const e=lt.extname(t),r=lt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let n=r.length>0;for(const s of r)if(!s.match(EI)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const AI=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function CI(t){return AI.test(t)?t:encodeURI(t)}const RI={extension:{type:V.LoadParser,priority:vr.Low},name:"loadWebFont",test(t){return Ws(t,bI)||Qn(t,SI)},async load(t,e){var n,i,s;const r=X.ADAPTER.getFontFaceSet();if(r){const o=[],a=((n=e.data)==null?void 0:n.family)??TI(t),l=((s=(i=e.data)==null?void 0:i.weights)==null?void 0:s.filter(h=>wI.includes(h)))??["normal"],c=e.data??{};for(let h=0;h<l.length;h++){const d=l[h],f=new FontFace(a,`url(${CI(t)})`,{...c,weight:d});await f.load(),r.add(f),o.push(f)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>X.ADAPTER.getFontFaceSet().delete(e))}};J.add(RI);const PI=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Rs=null,_f=class{constructor(){Rs||(Rs=URL.createObjectURL(new Blob([PI],{type:"application/javascript"}))),this.worker=new Worker(Rs)}};_f.revokeObjectURL=function(){Rs&&(URL.revokeObjectURL(Rs),Rs=null)};const II=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Ps=null;class R1{constructor(){Ps||(Ps=URL.createObjectURL(new Blob([II],{type:"application/javascript"}))),this.worker=new Worker(Ps)}}R1.revokeObjectURL=function(){Ps&&(URL.revokeObjectURL(Ps),Ps=null)};let Wy=0,bh;class kI{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new _f;r.addEventListener("message",n=>{r.terminate(),_f.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){bh===void 0&&(bh=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<bh&&(this._createdWorkers++,e=new R1().worker,e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((i,s)=>{this.queue.push({id:e,arguments:r,resolve:i,reject:s})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const r=this.queue.pop(),n=r.id;this.resolveHash[Wy]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:Wy++,id:n})}}const Xy=new kI;function xa(t,e,r){t.resource.internal=!0;const n=new Z(t),i=()=>{delete e.promiseCache[r],ui.has(r)&&ui.remove(r)};return n.baseTexture.once("destroyed",()=>{r in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),n.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const MI=[".jpeg",".jpg",".png",".webp",".avif"],BI=["image/jpeg","image/png","image/webp","image/avif"];async function NI(t){const e=await X.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}const eu={name:"loadTextures",extension:{type:V.LoadParser,priority:vr.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Ws(t,BI)||Qn(t,MI)},async load(t,e,r){var a;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;n?this.config.preferWorkers&&await Xy.isImageBitmapSupported()?i=await Xy.loadImageBitmap(t):i=await NI(t):i=await new Promise((l,c)=>{const h=new Image;h.crossOrigin=this.config.crossOrigin,h.src=t,h.complete?l(h):(h.onload=()=>l(h),h.onerror=d=>c(d))});const s={...e.data};s.resolution??(s.resolution=on(t)),n&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new he(i,s);return o.resource.src=t,xa(o,r,t)},unload(t){t.destroy(!0)}};J.add(eu);const LI=".svg",FI="image/svg+xml",DI={extension:{type:V.LoadParser,priority:vr.High},name:"loadSVG",test(t){return Ws(t,FI)||Qn(t,LI)},async testParse(t){return cf.test(t)},async parse(t,e,r){var s;const n=new cf(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await n.load();const i=new he(n,{resolution:on(t),...e==null?void 0:e.data});return i.resource.src=e.src,xa(i,r,e.src)},async load(t,e){return(await X.ADAPTER.fetch(t)).text()},unload:eu.unload};J.add(DI);const jI=[".mp4",".m4v",".webm",".ogv"],OI=["video/mp4","video/webm","video/ogg"],UI={name:"loadVideo",extension:{type:V.LoadParser,priority:vr.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return Ws(t,OI)||Qn(t,jI)},async load(t,e,r){var o;let n;const i=await(await X.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},l=new _1(s,a);await l.load();const c=new he(l,{alphaMode:await W2(),resolution:on(t),...e==null?void 0:e.data});c.resource.src=t,n=xa(c,r,t),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return n},unload(t){t.destroy(!0)}};J.add(UI);class GI{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,name:n,src:i,srcs:s}=e;return fr(r||n||i||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];Array.isArray(r)?r.forEach(i=>{const s=i.src??i.srcs,o=i.alias??i.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);n.push(l),a=[o,l]}else{const l=o.map(c=>this._createBundleAssetId(e,c));n.push(...l),a=[...o,...l]}this.add({...i,alias:a,src:s})}):Object.keys(r).forEach(i=>{const s=[i,this._createBundleAssetId(e,i)];if(typeof r[i]=="string")this.add({alias:s,src:r[i]});else if(Array.isArray(r[i]))this.add({alias:s,src:r[i]});else{const o=r[i],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}n.push(...s)}),this._bundles[e]=n}add(e,r,n,i,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(ge("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:r,data:n,format:i,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},fr(o).forEach(l=>{const{src:c,srcs:h}=l;let{data:d,format:f,loadParser:p}=l;const g=fr(c||h).map(y=>typeof y=="string"?dI(y):Array.isArray(y)?y:[y]),v=this.getAlias(l);Array.isArray(v)?v.forEach(a):a(v);const _=[];g.forEach(y=>{y.forEach(x=>{let m={};if(typeof x!="object"){m.src=x;for(let w=0;w<this._parsers.length;w++){const b=this._parsers[w];if(b.test(x)){m=b.parse(x);break}}}else d=x.data??d,f=x.format??f,p=x.loadParser??p,m={...m,...x};if(!v)throw new Error(`[Resolver] alias is undefined for this asset: ${m.src}`);m=this.buildResolvedAsset(m,{aliases:v,data:d,format:f,loadParser:p}),_.push(m)})}),v.forEach(y=>{this._assetMap[y]=_})})}resolveBundle(e){const r=_c(e);e=fr(e);const n={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const l in o){const c=o[l];a[this._extractAssetIdFromBundle(i,l)]=c}n[i]=a}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const i in r)n[i]=r[i].src;return n}return r.src}resolve(e){const r=_c(e);e=fr(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(c=>{const h=s.filter(d=>d[l]?d[l]===c:!1);h.length&&(s=h)})}),this._resolverHash[i]=s[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}buildResolvedAsset(e,r){const{aliases:n,data:i,loadParser:s,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=lt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??lt.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class zI{constructor(){this._detections=[],this._initialized=!1,this.resolver=new GI,this.loader=new pI,this.cache=ui,this._backgroundLoader=new hI(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const r=((s=e.texturePreference)==null?void 0:s.resolution)??1,n=typeof r=="number"?[r]:r,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e,r,n,i,s){this.resolver.add(e,r,n,i,s)}async load(e,r){this._initialized||await this.init();const n=_c(e),i=fr(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,r);return n?o[i[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,l=0;const c=()=>{r==null||r(++a/l)},h=o.map(d=>{const f=i[d];return l+=Object.keys(f).length,this._mapLoadToResolve(f,c).then(p=>{s[d]=p})});return await Promise.all(h),n?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return ui.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=ui.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const o={};return n.forEach((a,l)=>{const c=s[a.src],h=[a.src];a.alias&&h.push(...a.alias),o[i[l]]=c,ui.set(h,c)}),o}async unload(e){this._initialized||await this.init();const r=fr(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=fr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{ui.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,i)=>r.indexOf(n)===i),r}get detections(){return this._detections}get preferWorkers(){return eu.config.preferWorkers}set preferWorkers(e){ge("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const yo=new zI;J.handleByList(V.LoadParser,yo.loader.parsers).handleByList(V.ResolveParser,yo.resolver.parsers).handleByList(V.CacheParser,yo.cache.parsers).handleByList(V.DetectionParser,yo.detections);const HI={extension:V.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof Z),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((i,s)=>{r[n+(s===0?"":s+1)]=i})}),r}};J.add(HI);async function P1(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const $I={extension:{type:V.DetectionParser,priority:1},test:async()=>P1("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};J.add($I);const VI={extension:{type:V.DetectionParser,priority:0},test:async()=>P1("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};J.add(VI);const Yy=["png","jpg","jpeg"],WI={extension:{type:V.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...Yy],remove:async t=>t.filter(e=>!Yy.includes(e))};J.add(WI);const XI="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Up(t){return XI?!1:document.createElement("video").canPlayType(t)!==""}const YI={extension:{type:V.DetectionParser,priority:0},test:async()=>Up("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};J.add(YI);const KI={extension:{type:V.DetectionParser,priority:0},test:async()=>Up("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};J.add(KI);const qI={extension:{type:V.DetectionParser,priority:0},test:async()=>Up("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};J.add(qI);const QI={extension:V.ResolveParser,test:eu.test,parse:t=>{var e;return{resolution:parseFloat(((e=X.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:lt.extname(t).slice(1),src:t}}};J.add(QI);var ct=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(ct||{});const wc={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Tr,Ji;function Ky(){Ji={bptc:Tr.getExtension("EXT_texture_compression_bptc"),astc:Tr.getExtension("WEBGL_compressed_texture_astc"),etc:Tr.getExtension("WEBGL_compressed_texture_etc"),s3tc:Tr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Tr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Tr.getExtension("WEBGL_compressed_texture_pvrtc")||Tr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Tr.getExtension("WEBGL_compressed_texture_etc1"),atc:Tr.getExtension("WEBGL_compressed_texture_atc")}}const ZI={extension:{type:V.DetectionParser,priority:2},test:async()=>{const t=X.ADAPTER.createCanvas().getContext("webgl");return t?(Tr=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{Ji||Ky();const e=[];for(const r in Ji)Ji[r]&&e.push(r);return[...e,...t]},remove:async t=>(Ji||Ky(),t.filter(e=>!(e in Ji)))};J.add(ZI);class JI extends Kc{constructor(e,r={width:1,height:1,autoLoad:!0}){let n,i;typeof e=="string"?(n=e,i=new Uint8Array):(n=null,i=e),super(i,r),this.origin=n,this.buffer=i?new Kd(i):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new Kd(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class xi extends JI{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=xi._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||xi._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,n){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:c,levelBuffer:h}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,l,c,0,h)}return!0}onBlobLoaded(){this._levelBuffers=xi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,r,n,i,s,o,a){const l=new Array(n);let c=e.byteOffset,h=o,d=a,f=h+i-1&~(i-1),p=d+s-1&~(s-1),g=f*p*wc[r];for(let v=0;v<n;v++)l[v]={levelID:v,levelWidth:n>1?h:f,levelHeight:n>1?d:p,levelBuffer:new Uint8Array(e.buffer,c,g)},c+=g,h=h>>1||1,d=d>>1||1,f=h+i-1&~(i-1),p=d+s-1&~(s-1),g=f*p*wc[r];return l}}const Eh=4,el=124,ek=32,qy=20,tk=542327876,tl={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},rk={FOURCC:2},rl={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},nk=1,ik=2,sk=4,ok=64,ak=512,lk=131072,ck=827611204,uk=861165636,hk=894720068,dk=808540228,fk=4,pk={[ck]:ct.COMPRESSED_RGBA_S3TC_DXT1_EXT,[uk]:ct.COMPRESSED_RGBA_S3TC_DXT3_EXT,[hk]:ct.COMPRESSED_RGBA_S3TC_DXT5_EXT},mk={70:ct.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:ct.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:ct.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:ct.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:ct.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:ct.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:ct.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:ct.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:ct.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:ct.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:ct.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:ct.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:ct.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function gk(t){const e=new Uint32Array(t);if(e[0]!==tk)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,el/Uint32Array.BYTES_PER_ELEMENT),n=r[tl.HEIGHT],i=r[tl.WIDTH],s=r[tl.MIPMAP_COUNT],o=new Uint32Array(t,tl.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,ek/Uint32Array.BYTES_PER_ELEMENT),a=o[nk];if(a&sk){const l=o[rk.FOURCC];if(l!==dk){const x=pk[l],m=Eh+el,w=new Uint8Array(t,m);return[new xi(w,{format:x,width:i,height:n,levels:s})]}const c=Eh+el,h=new Uint32Array(e.buffer,c,qy/Uint32Array.BYTES_PER_ELEMENT),d=h[rl.DXGI_FORMAT],f=h[rl.RESOURCE_DIMENSION],p=h[rl.MISC_FLAG],g=h[rl.ARRAY_SIZE],v=mk[d];if(v===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(p===fk)throw new Error("DDSParser does not support cubemap textures");if(f===6)throw new Error("DDSParser does not supported 3D texture data");const _=new Array,y=Eh+el+qy;if(g===1)_.push(new Uint8Array(t,y));else{const x=wc[v];let m=0,w=i,b=n;for(let A=0;A<s;A++){const S=Math.max(1,w+3&-4),R=Math.max(1,b+3&-4),I=S*R*x;m+=I,w=w>>>1,b=b>>>1}let T=y;for(let A=0;A<g;A++)_.push(new Uint8Array(t,T,m)),T+=m}return _.map(x=>new xi(x,{format:v,width:i,height:n,levels:s}))}throw a&ok?new Error("DDSParser does not support uncompressed texture data."):a&ak?new Error("DDSParser does not supported YUV uncompressed texture data."):a&lk?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&ik?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Qy=[171,75,84,88,32,49,49,187,13,10,26,10],yk=67305985,ar={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},wf=64,Zy={[te.UNSIGNED_BYTE]:1,[te.UNSIGNED_SHORT]:2,[te.INT]:4,[te.UNSIGNED_INT]:4,[te.FLOAT]:4,[te.HALF_FLOAT]:8},xk={[$.RGBA]:4,[$.RGB]:3,[$.RG]:2,[$.RED]:1,[$.LUMINANCE]:1,[$.LUMINANCE_ALPHA]:2,[$.ALPHA]:1},vk={[te.UNSIGNED_SHORT_4_4_4_4]:2,[te.UNSIGNED_SHORT_5_5_5_1]:2,[te.UNSIGNED_SHORT_5_6_5]:2};function _k(t,e,r=!1){const n=new DataView(e);if(!wk(t,n))return null;const i=n.getUint32(ar.ENDIANNESS,!0)===yk,s=n.getUint32(ar.GL_TYPE,i),o=n.getUint32(ar.GL_FORMAT,i),a=n.getUint32(ar.GL_INTERNAL_FORMAT,i),l=n.getUint32(ar.PIXEL_WIDTH,i),c=n.getUint32(ar.PIXEL_HEIGHT,i)||1,h=n.getUint32(ar.PIXEL_DEPTH,i)||1,d=n.getUint32(ar.NUMBER_OF_ARRAY_ELEMENTS,i)||1,f=n.getUint32(ar.NUMBER_OF_FACES,i),p=n.getUint32(ar.NUMBER_OF_MIPMAP_LEVELS,i),g=n.getUint32(ar.BYTES_OF_KEY_VALUE_DATA,i);if(c===0||h!==1)throw new Error("Only 2D textures are supported");if(f!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");const v=4,_=4,y=l+3&-4,x=c+3&-4,m=new Array(d);let w=l*c;s===0&&(w=y*x);let b;if(s!==0?Zy[s]?b=Zy[s]*xk[o]:b=vk[s]:b=wc[a],b===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const T=r?bk(n,g,i):null;let A=w*b,S=l,R=c,I=y,L=x,B=wf+g;for(let C=0;C<p;C++){const N=n.getUint32(B,i);let O=B+4;for(let D=0;D<d;D++){let j=m[D];j||(j=m[D]=new Array(p)),j[C]={levelID:C,levelWidth:p>1||s!==0?S:I,levelHeight:p>1||s!==0?R:L,levelBuffer:new Uint8Array(e,O,A)},O+=A}B+=N+4,B=B%4!==0?B+4-B%4:B,S=S>>1||1,R=R>>1||1,I=S+v-1&-4,L=R+_-1&-4,A=I*L*b}return s!==0?{uncompressed:m.map(C=>{let N=C[0].levelBuffer,O=!1;return s===te.FLOAT?N=new Float32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4):s===te.UNSIGNED_INT?(O=!0,N=new Uint32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4)):s===te.INT&&(O=!0,N=new Int32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4)),{resource:new Kc(N,{width:C[0].levelWidth,height:C[0].levelHeight}),type:s,format:O?Sk(o):o}}),kvData:T}:{compressed:m.map(C=>new xi(null,{format:a,width:l,height:c,levels:p,levelBuffers:C})),kvData:T}}function wk(t,e){for(let r=0;r<Qy.length;r++)if(e.getUint8(r)!==Qy[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function Sk(t){switch(t){case $.RGBA:return $.RGBA_INTEGER;case $.RGB:return $.RGB_INTEGER;case $.RG:return $.RG_INTEGER;case $.RED:return $.RED_INTEGER;default:return t}}function bk(t,e,r){const n=new Map;let i=0;for(;i<e;){const s=t.getUint32(wf+i,r),o=wf+i+4,a=3-(s+3)%4;if(s===0||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&t.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const c=new TextDecoder().decode(new Uint8Array(t.buffer,o,l)),h=new DataView(t.buffer,o+l+1,s-l-1);n.set(c,h),i+=4+s+a}return n}const Ek={extension:{type:V.LoadParser,priority:vr.High},name:"loadDDS",test(t){return Qn(t,".dds")},async load(t,e,r){const n=await(await X.ADAPTER.fetch(t)).arrayBuffer(),i=gk(n).map(s=>{const o=new he(s,{mipmap:jr.OFF,alphaMode:Pt.NO_PREMULTIPLIED_ALPHA,resolution:on(t),...e.data});return xa(o,r,t)});return i.length===1?i[0]:i},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};J.add(Ek);const Tk={extension:{type:V.LoadParser,priority:vr.High},name:"loadKTX",test(t){return Qn(t,".ktx")},async load(t,e,r){const n=await(await X.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=_k(t,n),a=i??s,l={mipmap:jr.OFF,alphaMode:Pt.NO_PREMULTIPLIED_ALPHA,resolution:on(t),...e.data},c=a.map(h=>{a===s&&Object.assign(l,{type:h.type,format:h.format});const d=h.resource??h,f=new he(d,l);return f.ktxKeyValueData=o,xa(f,r,t)});return c.length===1?c[0]:c},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};J.add(Tk);const Ak=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],Ck={extension:V.ResolveParser,test:t=>{const e=lt.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var n,i;const e=t.split("."),r=e.pop();if(["ktx","dds"].includes(r)){const s=e.pop();if(Ak.includes(s))return{resolution:parseFloat(((n=X.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:s,src:t}}return{resolution:parseFloat(((i=X.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:r,src:t}}};J.add(Ck);const nl=new fe,Rk=4,I1=class xo{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,r,n,i){const s=new Image;return s.src=await this.base64(e,r,n,i),s}async base64(e,r,n,i){const s=this.canvas(e,i);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const c=new FileReader;c.onload=()=>o(c.result),c.onerror=a,c.readAsDataURL(l)},r,n)});if(s.toDataURL!==void 0)return s.toDataURL(r,n);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:r,quality:n});return new Promise((a,l)=>{const c=new FileReader;c.onload=()=>a(c.result),c.onerror=l,c.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);o&&xo._flipY(n,i,s),a&&xo._unpremultiplyAlpha(n);const l=new lR(i,s,1),c=new ImageData(new Uint8ClampedArray(n.buffer),i,s);return l.context.putImageData(c,0,0),l.canvas}pixels(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);return o&&xo._flipY(n,i,s),a&&xo._unpremultiplyAlpha(n),n}_rawPixels(e,r){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let i,s=!1,o=!1,a,l=!1;e&&(e instanceof Ni?a=e:(a=n.generateTexture(e,{region:r,resolution:n.resolution,multisample:n.multisample}),l=!0,r&&(nl.width=r.width,nl.height=r.height,r=nl)));const c=n.gl;if(a){if(i=a.baseTexture.resolution,r=r??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===$.RGBA,!l){n.renderTexture.bind(a);const p=a.framebuffer.glFramebuffers[n.CONTEXT_UID];p.blitFramebuffer&&n.framebuffer.bind(p.blitFramebuffer)}}else i=n.resolution,r||(r=nl,r.width=n.width/i,r.height=n.height/i),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const h=Math.max(Math.round(r.width*i),1),d=Math.max(Math.round(r.height*i),1),f=new Uint8Array(Rk*h*d);return c.readPixels(Math.round(r.x*i),Math.round(r.y*i),h,d,c.RGBA,c.UNSIGNED_BYTE,f),l&&(a==null||a.destroy(!0)),{pixels:f,width:h,height:d,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,r,n){const i=r<<2,s=n>>1,o=new Uint8Array(i);for(let a=0;a<s;a++){const l=a*i,c=(n-a-1)*i;o.set(e.subarray(l,l+i)),e.copyWithin(l,c,c+i),e.set(o,c)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const r=e.length;for(let n=0;n<r;n+=4){const i=e[n+3];if(i!==0){const s=255.001/i;e[n]=e[n]*s+.5,e[n+1]=e[n+1]*s+.5,e[n+2]=e[n+2]*s+.5}}}};I1.extension={name:"extract",type:V.RendererSystem};let Pk=I1;J.add(Pk);const Sc={build(t){const e=t.points;let r,n,i,s,o,a;if(t.type===ht.CIRC){const g=t.shape;r=g.x,n=g.y,o=a=g.radius,i=s=0}else if(t.type===ht.ELIP){const g=t.shape;r=g.x,n=g.y,o=g.width,a=g.height,i=s=0}else{const g=t.shape,v=g.width/2,_=g.height/2;r=g.x+v,n=g.y+_,o=a=Math.max(0,Math.min(g.radius,Math.min(v,_))),i=v-o,s=_-a}if(!(o>=0&&a>=0&&i>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(i?4:0)+(s?4:0);if(e.length=c,c===0)return;if(l===0){e.length=8,e[0]=e[6]=r+i,e[1]=e[3]=n+s,e[2]=e[4]=r-i,e[5]=e[7]=n-s;return}let h=0,d=l*4+(i?2:0)+2,f=d,p=c;{const g=i+o,v=s,_=r+g,y=r-g,x=n+v;if(e[h++]=_,e[h++]=x,e[--d]=x,e[--d]=y,s){const m=n-v;e[f++]=y,e[f++]=m,e[--p]=m,e[--p]=_}}for(let g=1;g<l;g++){const v=Math.PI/2*(g/l),_=i+Math.cos(v)*o,y=s+Math.sin(v)*a,x=r+_,m=r-_,w=n+y,b=n-y;e[h++]=x,e[h++]=w,e[--d]=w,e[--d]=m,e[f++]=m,e[f++]=b,e[--p]=b,e[--p]=x}{const g=i,v=s+a,_=r+g,y=r-g,x=n+v,m=n-v;e[h++]=_,e[h++]=x,e[--p]=m,e[--p]=_,i&&(e[h++]=y,e[h++]=x,e[--p]=m,e[--p]=y)}},triangulate(t,e){const r=t.points,n=e.points,i=e.indices;if(r.length===0)return;let s=n.length/2;const o=s;let a,l;if(t.type!==ht.RREC){const h=t.shape;a=h.x,l=h.y}else{const h=t.shape;a=h.x+h.width/2,l=h.y+h.height/2}const c=t.matrix;n.push(t.matrix?c.a*a+c.c*l+c.tx:a,t.matrix?c.b*a+c.d*l+c.ty:l),s++,n.push(r[0],r[1]);for(let h=2;h<r.length;h+=2)n.push(r[h],r[h+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function Jy(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let i=0,s=t[r-2],o=t[r-1];i<r;i+=2){const a=t[i],l=t[i+1];n+=(a-s)*(l+o),s=a,o=l}if(!e&&n>0||e&&n<=0){const i=r/2;for(let s=i+i%2;s<r;s+=2){const o=r-s-2,a=r-s-1,l=s,c=s+1;[t[o],t[l]]=[t[l],t[o]],[t[a],t[c]]=[t[c],t[a]]}}}const k1={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const n=t.holes,i=e.points,s=e.indices;if(r.length>=6){Jy(r,!1);const o=[];for(let c=0;c<n.length;c++){const h=n[c];Jy(h.points,!0),o.push(r.length/2),r=r.concat(h.points)}const a=jT(r,o,2);if(!a)return;const l=i.length/2;for(let c=0;c<a.length;c+=3)s.push(a[c]+l),s.push(a[c+1]+l),s.push(a[c+2]+l);for(let c=0;c<r.length;c++)i.push(r[c])}}},Ik={build(t){const e=t.shape,r=e.x,n=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(r,n,r+i,n,r+i,n+s,r,n+s)},triangulate(t,e){const r=t.points,n=e.points;if(r.length===0)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},kk={build(t){Sc.build(t)},triangulate(t,e){Sc.triangulate(t,e)}};var Yt=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Yt||{}),kn=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(kn||{});const Os={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class ex{static curveTo(e,r,n,i,s,o){const a=o[o.length-2],l=o[o.length-1]-r,c=a-e,h=i-r,d=n-e,f=Math.abs(l*d-c*h);if(f<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==r)&&o.push(e,r),null;const p=l*l+c*c,g=h*h+d*d,v=l*h+c*d,_=s*Math.sqrt(p)/f,y=s*Math.sqrt(g)/f,x=_*v/p,m=y*v/g,w=_*d+y*c,b=_*h+y*l,T=c*(y+x),A=l*(y+x),S=d*(_+m),R=h*(_+m),I=Math.atan2(A-b,T-w),L=Math.atan2(R-b,S-w);return{cx:w+e,cy:b+r,radius:s,startAngle:I,endAngle:L,anticlockwise:c*h>d*l}}static arc(e,r,n,i,s,o,a,l,c){const h=a-o,d=Os._segmentsCount(Math.abs(h)*s,Math.ceil(Math.abs(h)/fc)*40),f=h/(d*2),p=f*2,g=Math.cos(f),v=Math.sin(f),_=d-1,y=_%1/_;for(let x=0;x<=_;++x){const m=x+y*x,w=f+o+p*m,b=Math.cos(w),T=-Math.sin(w);c.push((g*b+v*T)*s+n,(g*-T+v*b)*s+i)}}}class Mk{constructor(){this.reset()}begin(e,r,n){this.reset(),this.style=e,this.start=r,this.attribStart=n}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Gp{static curveLength(e,r,n,i,s,o,a,l){let c=0,h=0,d=0,f=0,p=0,g=0,v=0,_=0,y=0,x=0,m=0,w=e,b=r;for(let T=1;T<=10;++T)h=T/10,d=h*h,f=d*h,p=1-h,g=p*p,v=g*p,_=v*e+3*g*h*n+3*p*d*s+f*a,y=v*r+3*g*h*i+3*p*d*o+f*l,x=w-_,m=b-y,w=_,b=y,c+=Math.sqrt(x*x+m*m);return c}static curveTo(e,r,n,i,s,o,a){const l=a[a.length-2],c=a[a.length-1];a.length-=2;const h=Os._segmentsCount(Gp.curveLength(l,c,e,r,n,i,s,o));let d=0,f=0,p=0,g=0,v=0;a.push(l,c);for(let _=1,y=0;_<=h;++_)y=_/h,d=1-y,f=d*d,p=f*d,g=y*y,v=g*y,a.push(p*l+3*f*y*e+3*d*g*n+v*s,p*c+3*f*y*r+3*d*g*i+v*o)}}function tx(t,e,r,n,i,s,o,a){const l=t-r*i,c=e-n*i,h=t+r*s,d=e+n*s;let f,p;o?(f=n,p=-r):(f=-n,p=r);const g=l+f,v=c+p,_=h+f,y=d+p;return a.push(g,v,_,y),2}function ei(t,e,r,n,i,s,o,a){const l=r-t,c=n-e;let h=Math.atan2(l,c),d=Math.atan2(i-t,s-e);a&&h<d?h+=Math.PI*2:!a&&h>d&&(d+=Math.PI*2);let f=h;const p=d-h,g=Math.abs(p),v=Math.sqrt(l*l+c*c),_=(15*g*Math.sqrt(v)/Math.PI>>0)+1,y=p/_;if(f+=y,a){o.push(t,e,r,n);for(let x=1,m=f;x<_;x++,m+=y)o.push(t,e,t+Math.sin(m)*v,e+Math.cos(m)*v);o.push(t,e,i,s)}else{o.push(r,n,t,e);for(let x=1,m=f;x<_;x++,m+=y)o.push(t+Math.sin(m)*v,e+Math.cos(m)*v,t,e);o.push(i,s,t,e)}return _*2}function Bk(t,e){const r=t.shape;let n=t.points||r.points.slice();const i=e.closePointEps;if(n.length===0)return;const s=t.lineStyle,o=new _e(n[0],n[1]),a=new _e(n[n.length-2],n[n.length-1]),l=r.type!==ht.POLY||r.closeStroke,c=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){n=n.slice(),c&&(n.pop(),n.pop(),a.set(n[n.length-2],n[n.length-1]));const j=(o.x+a.x)*.5,M=(a.y+o.y)*.5;n.unshift(j,M),n.push(j,M)}const h=e.points,d=n.length/2;let f=n.length;const p=h.length/2,g=s.width/2,v=g*g,_=s.miterLimit*s.miterLimit;let y=n[0],x=n[1],m=n[2],w=n[3],b=0,T=0,A=-(x-w),S=y-m,R=0,I=0,L=Math.sqrt(A*A+S*S);A/=L,S/=L,A*=g,S*=g;const B=s.alignment,C=(1-B)*2,N=B*2;l||(s.cap===kn.ROUND?f+=ei(y-A*(C-N)*.5,x-S*(C-N)*.5,y-A*C,x-S*C,y+A*N,x+S*N,h,!0)+2:s.cap===kn.SQUARE&&(f+=tx(y,x,A,S,C,N,!0,h))),h.push(y-A*C,x-S*C,y+A*N,x+S*N);for(let j=1;j<d-1;++j){y=n[(j-1)*2],x=n[(j-1)*2+1],m=n[j*2],w=n[j*2+1],b=n[(j+1)*2],T=n[(j+1)*2+1],A=-(x-w),S=y-m,L=Math.sqrt(A*A+S*S),A/=L,S/=L,A*=g,S*=g,R=-(w-T),I=m-b,L=Math.sqrt(R*R+I*I),R/=L,I/=L,R*=g,I*=g;const M=m-y,G=x-w,k=m-b,P=T-w,F=M*k+G*P,q=G*k-P*M,Q=q<0;if(Math.abs(q)<.001*Math.abs(F)){h.push(m-A*C,w-S*C,m+A*N,w+S*N),F>=0&&(s.join===Yt.ROUND?f+=ei(m,w,m-A*C,w-S*C,m-R*C,w-I*C,h,!1)+4:f+=2,h.push(m-R*N,w-I*N,m+R*C,w+I*C));continue}const le=(-A+y)*(-S+w)-(-A+m)*(-S+x),xe=(-R+b)*(-I+w)-(-R+m)*(-I+T),oe=(M*xe-k*le)/q,Pe=(P*le-G*xe)/q,Le=(oe-m)*(oe-m)+(Pe-w)*(Pe-w),Te=m+(oe-m)*C,Se=w+(Pe-w)*C,be=m-(oe-m)*N,Ee=w-(Pe-w)*N,Ye=Math.min(M*M+G*G,k*k+P*P),rt=Q?C:N,Lt=Ye+rt*rt*v,Li=Le<=Lt;let cn=s.join;if(cn===Yt.MITER&&Le/v>_&&(cn=Yt.BEVEL),Li)switch(cn){case Yt.MITER:{h.push(Te,Se,be,Ee);break}case Yt.BEVEL:{Q?h.push(Te,Se,m+A*N,w+S*N,Te,Se,m+R*N,w+I*N):h.push(m-A*C,w-S*C,be,Ee,m-R*C,w-I*C,be,Ee),f+=2;break}case Yt.ROUND:{Q?(h.push(Te,Se,m+A*N,w+S*N),f+=ei(m,w,m+A*N,w+S*N,m+R*N,w+I*N,h,!0)+4,h.push(Te,Se,m+R*N,w+I*N)):(h.push(m-A*C,w-S*C,be,Ee),f+=ei(m,w,m-A*C,w-S*C,m-R*C,w-I*C,h,!1)+4,h.push(m-R*C,w-I*C,be,Ee));break}}else{switch(h.push(m-A*C,w-S*C,m+A*N,w+S*N),cn){case Yt.MITER:{Q?h.push(be,Ee,be,Ee):h.push(Te,Se,Te,Se),f+=2;break}case Yt.ROUND:{Q?f+=ei(m,w,m+A*N,w+S*N,m+R*N,w+I*N,h,!0)+2:f+=ei(m,w,m-A*C,w-S*C,m-R*C,w-I*C,h,!1)+2;break}}h.push(m-R*C,w-I*C,m+R*N,w+I*N),f+=2}}y=n[(d-2)*2],x=n[(d-2)*2+1],m=n[(d-1)*2],w=n[(d-1)*2+1],A=-(x-w),S=y-m,L=Math.sqrt(A*A+S*S),A/=L,S/=L,A*=g,S*=g,h.push(m-A*C,w-S*C,m+A*N,w+S*N),l||(s.cap===kn.ROUND?f+=ei(m-A*(C-N)*.5,w-S*(C-N)*.5,m-A*C,w-S*C,m+A*N,w+S*N,h,!1)+2:s.cap===kn.SQUARE&&(f+=tx(m,w,A,S,C,N,!1,h)));const O=e.indices,D=Os.epsilon*Os.epsilon;for(let j=p;j<f+p-2;++j)y=h[j*2],x=h[j*2+1],m=h[(j+1)*2],w=h[(j+1)*2+1],b=h[(j+2)*2],T=h[(j+2)*2+1],!(Math.abs(y*(w-T)+m*(T-x)+b*(x-w))<D)&&O.push(j,j+1,j+2)}function Nk(t,e){let r=0;const n=t.shape,i=t.points||n.points,s=n.type!==ht.POLY||n.closeStroke;if(i.length===0)return;const o=e.points,a=e.indices,l=i.length/2,c=o.length/2;let h=c;for(o.push(i[0],i[1]),r=1;r<l;r++)o.push(i[r*2],i[r*2+1]),a.push(h,h+1),h++;s&&a.push(h,c)}function rx(t,e){t.lineStyle.native?Nk(t,e):Bk(t,e)}class zp{static curveLength(e,r,n,i,s,o){const a=e-2*n+s,l=r-2*i+o,c=2*n-2*e,h=2*i-2*r,d=4*(a*a+l*l),f=4*(a*c+l*h),p=c*c+h*h,g=2*Math.sqrt(d+f+p),v=Math.sqrt(d),_=2*d*v,y=2*Math.sqrt(p),x=f/v;return(_*g+v*f*(g-y)+(4*p*d-f*f)*Math.log((2*v+x+g)/(x+y)))/(4*_)}static curveTo(e,r,n,i,s){const o=s[s.length-2],a=s[s.length-1],l=Os._segmentsCount(zp.curveLength(o,a,e,r,n,i));let c=0,h=0;for(let d=1;d<=l;++d){const f=d/l;c=o+(e-o)*f,h=a+(r-a)*f,s.push(c+(e+(n-e)*f-c)*f,h+(r+(i-r)*f-h)*f)}}}const Th={[ht.POLY]:k1,[ht.CIRC]:Sc,[ht.ELIP]:Sc,[ht.RECT]:Ik,[ht.RREC]:kk},nx=[],il=[];class bc{constructor(e,r=null,n=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=r,this.matrix=i,this.type=e.type}clone(){return new bc(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Vi=new _e,M1=class B1 extends D_{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new xc,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),il.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r.reset(),nx.push(r)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,r=null,n=null,i=null){const s=new bc(e,r,n,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,r=null){if(!this.graphicsData.length)return null;const n=new bc(e,null,null,r),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const r=this.graphicsData;for(let n=0;n<r.length;++n){const i=r[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,Vi):Vi.copyFrom(e),i.shape.contains(Vi.x,Vi.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Vi.x,Vi.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,r=this.graphicsData;let n=null,i=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],i=n.style);for(let l=this.shapeIndex;l<r.length;l++){this.shapeIndex++;const c=r[l],h=c.fillStyle,d=c.lineStyle;Th[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(h.visible||d.visible)&&this.processHoles(c.holes);for(let f=0;f<2;f++){const p=f===0?h:d;if(!p.visible)continue;const g=p.texture.baseTexture,v=this.indices.length,_=this.points.length/2;g.wrapMode=Gn.REPEAT,f===0?this.processFill(c):this.processLine(c);const y=this.points.length/2-_;y!==0&&(n&&!this._compareStyles(i,p)&&(n.end(v,_),n=null),n||(n=nx.pop()||new Mk,n.begin(p,v,_),this.batches.push(n),i=p),this.addUvs(this.points,e,p.texture,_,y,p.matrix))}}const s=this.indices.length,o=this.points.length/2;if(n&&n.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,r){return!(!e||!r||e.texture.baseTexture!==r.texture.baseTexture||e.color+e.alpha!==r.color+r.alpha||!!e.native!=!!r.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,r=this.graphicsData.length;e<r;e++){const n=this.graphicsData[e],i=n.fillStyle,s=n.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let r=0,n=e.length;r<n;r++){const i=e[r];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<B1.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++he._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),il.push(this.drawCalls[d]);this.drawCalls.length=0;const r=this.colors,n=this.textureIds;let i=il.pop();i||(i=new Zd,i.texArray=new rf),i.texArray.count=0,i.start=0,i.size=0,i.type=Br.TRIANGLES;let s=0,o=null,a=0,l=!1,c=Br.TRIANGLES,h=0;this.drawCalls.push(i);for(let d=0;d<this.batches.length;d++){const f=this.batches[d],p=8,g=f.style,v=g.texture.baseTexture;l!==!!g.native&&(l=!!g.native,c=l?Br.LINES:Br.TRIANGLES,o=null,s=p,e++),o!==v&&(o=v,v._batchEnabled!==e&&(s===p&&(e++,s=0,i.size>0&&(i=il.pop(),i||(i=new Zd,i.texArray=new rf),this.drawCalls.push(i)),i.start=h,i.size=0,i.texArray.count=0,i.type=c),v.touched=1,v._batchEnabled=e,v._batchLocation=s,v.wrapMode=Gn.REPEAT,i.texArray.elements[i.texArray.count++]=v,s++)),i.size+=f.size,h+=f.size,a=v._batchLocation,this.addColors(r,g.color,g.alpha,f.attribSize,f.attribStart),this.addTextureIds(n,a,f.attribSize,f.attribStart)}he._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,r=this.uvs,n=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let c=0;c<e.length/2;c++)o[l++]=e[c*2],o[l++]=e[c*2+1],o[l++]=r[c*2],o[l++]=r[c*2+1],a[l++]=n[c],o[l++]=i[c];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?k1.triangulate(e,this):Th[e.type].triangulate(e,this)}processLine(e){rx(e,this);for(let r=0;r<e.holes.length;r++)rx(e.holes[r],this)}processHoles(e){for(let r=0;r<e.length;r++){const n=e[r];Th[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,r){for(let n=0;n<e.length/2;n++){const i=e[n*2],s=e[n*2+1];e[n*2]=r.a*i+r.c*s+r.tx,e[n*2+1]=r.b*i+r.d*s+r.ty}}addColors(e,r,n,i,s=0){const o=Me.shared.setValue(r).toLittleEndianNumber(),a=Me.shared.setValue(o).toPremultiplied(n);e.length=Math.max(e.length,s+i);for(let l=0;l<i;l++)e[s+l]=a}addTextureIds(e,r,n,i=0){e.length=Math.max(e.length,i+n);for(let s=0;s<n;s++)e[i+s]=r}addUvs(e,r,n,i,s,o=null){let a=0;const l=r.length,c=n.frame;for(;a<s;){let d=e[(i+a)*2],f=e[(i+a)*2+1];if(o){const p=o.a*d+o.c*f+o.tx;f=o.b*d+o.d*f+o.ty,d=p}a++,r.push(d/c.width,f/c.height)}const h=n.baseTexture;(c.width<h.width||c.height<h.height)&&this.adjustUvs(r,n,l,s)}adjustUvs(e,r,n,i){const s=r.baseTexture,o=1e-6,a=n+i*2,l=r.frame,c=l.width/s.width,h=l.height/s.height;let d=l.x/l.width,f=l.y/l.height,p=Math.floor(e[n]+o),g=Math.floor(e[n+1]+o);for(let v=n+2;v<a;v+=2)p=Math.min(p,Math.floor(e[v]+o)),g=Math.min(g,Math.floor(e[v+1]+o));d-=p,f-=g;for(let v=n;v<a;v+=2)e[v]=(e[v]+d)*c,e[v+1]=(e[v+1]+f)*h}};M1.BATCHABLE_SIZE=100;let Lk=M1;class tu{constructor(){this.color=16777215,this.alpha=1,this.texture=Z.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new tu;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Z.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Hp extends tu{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=kn.BUTT,this.join=Yt.MITER,this.miterLimit=10}clone(){const e=new Hp;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=kn.BUTT,this.join=Yt.MITER,this.miterLimit=10}}const Ah={},Sf=class kl extends Nt{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new tu,this._lineStyle=new Hp,this._matrix=null,this._holeMode=!1,this.state=Or.for2d(),this._geometry=e||new Lk,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Me(16777215),this.blendMode=se.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new kl(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,r=0,n,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:r,alpha:n,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const r={width:0,texture:Z.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:kn.BUTT,join:Yt.MITER,miterLimit:10};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new yi,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new yi,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this}lineTo(e,r){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,i=n[n.length-2],s=n[n.length-1];return(i!==e||s!==r)&&n.push(e,r),this}_initCurve(e=0,r=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)}quadraticCurveTo(e,r,n,i){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),zp.curveTo(e,r,n,i,s),this}bezierCurveTo(e,r,n,i,s,o){return this._initCurve(),Gp.curveTo(e,r,n,i,s,o,this.currentPath.points),this}arcTo(e,r,n,i,s){this._initCurve(e,r);const o=this.currentPath.points,a=ex.curveTo(e,r,n,i,s,o);if(a){const{cx:l,cy:c,radius:h,startAngle:d,endAngle:f,anticlockwise:p}=a;this.arc(l,c,h,d,f,p)}return this}arc(e,r,n,i,s,o=!1){if(i===s)return this;if(!o&&s<=i?s+=fc:o&&i<=s&&(i+=fc),s-i===0)return this;const a=e+Math.cos(i)*n,l=r+Math.sin(i)*n,c=this._geometry.closePointEps;let h=this.currentPath?this.currentPath.points:null;if(h){const d=Math.abs(h[h.length-2]-a),f=Math.abs(h[h.length-1]-l);d<c&&f<c||h.push(a,l)}else this.moveTo(a,l),h=this.currentPath.points;return ex.arc(a,l,e,r,n,i,s,o,h),this}beginFill(e=0,r){return this.beginTextureFill({texture:Z.WHITE,color:e,alpha:r})}normalizeColor(e){const r=Me.shared.setValue(e.color??0);e.color=r.toNumber(),e.alpha??(e.alpha=r.alpha)}beginTextureFill(e){const r={texture:Z.WHITE,color:16777215,matrix:null};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,r,n,i){return this.drawShape(new fe(e,r,n,i))}drawRoundedRect(e,r,n,i,s){return this.drawShape(new Zc(e,r,n,i,s))}drawCircle(e,r,n){return this.drawShape(new qc(e,r,n))}drawEllipse(e,r,n,i){return this.drawShape(new Qc(e,r,n,i))}drawPolygon(...e){let r,n=!0;const i=e[0];i.points?(n=i.closeStroke,r=i.points):Array.isArray(e[0])?r=e[0]:r=e;const s=new yi(r);return s.closeStroke=n,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===ht.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,r=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let i=0;i<n;i++){const s=e.batches[i],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),c=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),h={vertexData:a,blendMode:r,indices:c,uvs:l,_batchRGB:Me.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=h}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let r=0,n=this.batches.length;r<n;r++){const i=this.batches[r];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const r=this._resolveDirectShader(e),n=this._geometry,i=this.worldAlpha,s=r.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,Me.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(r),e.geometry.bind(n,r),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,n.drawCalls[a])}_renderDrawCallDirect(e,r){const{texArray:n,type:i,size:s,start:o}=r,a=n.count;for(let l=0;l<a;l++)e.texture.bind(n.elements[l],l);e.geometry.draw(i,s,o)}_resolveDirectShader(e){let r=this.shader;const n=this.pluginName;if(!r){if(!Ah[n]){const{maxTextures:i}=e.plugins[n],s=new Int32Array(i);for(let l=0;l<i;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ne,default:yr.from({uSamplers:s},!0)},a=e.plugins[n]._shader.program;Ah[n]=new Dr(a,o)}r=Ah[n]}return r}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:r,minY:n,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,r,n,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,kl._TEMP_POINT),this._geometry.containsPoint(kl._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r._tintRGB=Me.shared.setValue(this._tintColor).multiply(r._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,c=this._geometry.points,h=this.vertexData;let d=0;for(let f=0;f<c.length;f+=2){const p=c[f],g=c[f+1];h[d++]=n*p+s*g+a,h[d++]=o*g+i*p+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};Sf.curves=Os,Sf._TEMP_POINT=new _e;let Gt=Sf;class Fk{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const Ch=new _e,ix=new yi,N1=class L1 extends Nt{constructor(e,r,n,i=Br.TRIANGLES){super(),this.geometry=e,this.shader=r,this.state=n||Or.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=X.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Br.TRIANGLES&&r.length<L1.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const r=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const e=this.geometry.buffers[0],r=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,c=i.tx,h=i.ty,d=this.vertexData;for(let f=0;f<d.length/2;f++){const p=r[f*2],g=r[f*2+1];d[f*2]=s*p+a*g+c,d[f*2+1]=o*p+l*g+h}if(this._roundPixels){const f=X.RESOLUTION;for(let p=0;p<d.length;++p)d[p]=Math.round(d[p]*f)/f}this.vertexDirty=n}calculateUvs(){const e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Fk(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Ch);const r=this.geometry.getBuffer("aVertexPosition").data,n=ix.points,i=this.geometry.getIndex().data,s=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=i[a]*2,c=i[a+1]*2,h=i[a+2]*2;if(n[0]=r[l],n[1]=r[l+1],n[2]=r[c],n[3]=r[c+1],n[4]=r[h],n[5]=r[h+1],ix.contains(Ch.x,Ch.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};N1.BATCHABLE_SIZE=100;let sx=N1;class Dk extends Vn{constructor(e,r,n){super();const i=new We(e),s=new We(r,!0),o=new We(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,te.FLOAT).addAttribute("aTextureCoord",s,2,!1,te.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var jk=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,Ok=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class ox extends Dr{constructor(e,r){const n={uSampler:e,alpha:1,uTextureMatrix:Ne.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||Zr.from(Ok,jk),n),this._colorDirty=!1,this.uvMatrix=new Q_(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new Me(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Me.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class ax{constructor(e,r,n){this.geometry=new Vn,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||te.FLOAT,offset:s.offset},r[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let r=0;this.indexBuffer=new We(oR(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new We(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new We(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===te.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===te.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,r,n){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,r,n,s.type===te.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,n){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,r,n,s.type===te.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var Uk=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,Gk=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class F1 extends Jc{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Ne,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:te.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Dr.from(Gk,Uk,{}),this.state=Or.for2d()}render(e){const r=e.children,n=e._maxSize,i=e._batchSize,s=this.renderer;let o=r.length;if(o===0)return;o>n&&!e.autoResize&&(o=n);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=r[0]._texture.baseTexture,c=l.alphaMode>0;this.state.blendMode=N_(e.blendMode,c),s.state.set(this.state);const h=s.gl,d=e.worldTransform.copyTo(this.tempMatrix);d.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=Me.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,c).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let f=!1;for(let p=0,g=0;p<o;p+=i,g+=1){let v=o-p;v>i&&(v=i),g>=a.length&&a.push(this._generateOneMoreBuffer(e));const _=a[g];_.uploadDynamic(r,p,v);const y=e._bufferUpdateIDs[g]||0;f=f||_._updateID<y,f&&(_._updateID=e._updateID,_.uploadStatic(r,p,v)),s.geometry.bind(_.geometry),h.drawElements(h.TRIANGLES,v*6,h.UNSIGNED_SHORT,0)}}generateBuffers(e){const r=[],n=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<n;o+=i)r.push(new ax(this.properties,s,i));return r}_generateOneMoreBuffer(e){const r=e._batchSize,n=e._properties;return new ax(this.properties,n,r)}uploadVertices(e,r,n,i,s,o){let a=0,l=0,c=0,h=0;for(let d=0;d<n;++d){const f=e[r+d],p=f._texture,g=f.scale.x,v=f.scale.y,_=p.trim,y=p.orig;_?(l=_.x-f.anchor.x*y.width,a=l+_.width,h=_.y-f.anchor.y*y.height,c=h+_.height):(a=y.width*(1-f.anchor.x),l=y.width*-f.anchor.x,c=y.height*(1-f.anchor.y),h=y.height*-f.anchor.y),i[o]=l*g,i[o+1]=h*v,i[o+s]=a*g,i[o+s+1]=h*v,i[o+s*2]=a*g,i[o+s*2+1]=c*v,i[o+s*3]=l*g,i[o+s*3+1]=c*v,o+=s*4}}uploadPosition(e,r,n,i,s,o){for(let a=0;a<n;a++){const l=e[r+a].position;i[o]=l.x,i[o+1]=l.y,i[o+s]=l.x,i[o+s+1]=l.y,i[o+s*2]=l.x,i[o+s*2+1]=l.y,i[o+s*3]=l.x,i[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,r,n,i,s,o){for(let a=0;a<n;a++){const l=e[r+a].rotation;i[o]=l,i[o+s]=l,i[o+s*2]=l,i[o+s*3]=l,o+=s*4}}uploadUvs(e,r,n,i,s,o){for(let a=0;a<n;++a){const l=e[r+a]._texture._uvs;l?(i[o]=l.x0,i[o+1]=l.y0,i[o+s]=l.x1,i[o+s+1]=l.y1,i[o+s*2]=l.x2,i[o+s*2+1]=l.y2,i[o+s*3]=l.x3,i[o+s*3+1]=l.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}}uploadTint(e,r,n,i,s,o){for(let a=0;a<n;++a){const l=e[r+a],c=Me.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);i[o]=c,i[o+s]=c,i[o+s*2]=c,i[o+s*3]=c,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}F1.extension={name:"particle",type:V.RendererPlugin};J.add(F1);var ru=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(ru||{});const sl={willReadFrequently:!0},Ar=class ee{static get experimentalLetterSpacingSupported(){let e=ee._experimentalLetterSpacingSupported;if(e!==void 0){const r=X.ADAPTER.getCanvasRenderingContext2D().prototype;e=ee._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,i,s,o,a,l,c){this.text=e,this.style=r,this.width=n,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}static measureText(e,r,n,i=ee._canvas){n=n??r.wordWrap;const s=r.toFontString(),o=ee.measureFont(s);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const a=i.getContext("2d",sl);a.font=s;const l=(n?ee.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let h=0;for(let g=0;g<l.length;g++){const v=ee._measureText(l[g],r.letterSpacing,a);c[g]=v,h=Math.max(h,v)}let d=h+r.strokeThickness;r.dropShadow&&(d+=r.dropShadowDistance);const f=r.lineHeight||o.fontSize+r.strokeThickness;let p=Math.max(f,o.fontSize+r.strokeThickness*2)+r.leading+(l.length-1)*(f+r.leading);return r.dropShadow&&(p+=r.dropShadowDistance),new ee(e,r,d,p,l,c,f+r.leading,h,o)}static _measureText(e,r,n){let i=!1;ee.experimentalLetterSpacingSupported&&(ee.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let s=n.measureText(e).width;return s>0&&(i?s-=r:s+=(ee.graphemeSegmenter(e).length-1)*r),s}static wordWrap(e,r,n=ee._canvas){const i=n.getContext("2d",sl);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:c,whiteSpace:h}=r,d=ee.collapseSpaces(h),f=ee.collapseNewlines(h);let p=!d;const g=r.wordWrapWidth+c,v=ee.tokenize(e);for(let _=0;_<v.length;_++){let y=v[_];if(ee.isNewline(y)){if(!f){a+=ee.addLine(o),p=!d,o="",s=0;continue}y=" "}if(d){const m=ee.isBreakingSpace(y),w=ee.isBreakingSpace(o[o.length-1]);if(m&&w)continue}const x=ee.getFromCache(y,c,l,i);if(x>g)if(o!==""&&(a+=ee.addLine(o),o="",s=0),ee.canBreakWords(y,r.breakWords)){const m=ee.wordWrapSplit(y);for(let w=0;w<m.length;w++){let b=m[w],T=b,A=1;for(;m[w+A];){const R=m[w+A];if(!ee.canBreakChars(T,R,y,w,r.breakWords))b+=R;else break;T=R,A++}w+=A-1;const S=ee.getFromCache(b,c,l,i);S+s>g&&(a+=ee.addLine(o),p=!1,o="",s=0),o+=b,s+=S}}else{o.length>0&&(a+=ee.addLine(o),o="",s=0);const m=_===v.length-1;a+=ee.addLine(y,!m),p=!1,o="",s=0}else x+s>g&&(p=!1,a+=ee.addLine(o),o="",s=0),(o.length>0||!ee.isBreakingSpace(y)||p)&&(o+=y,s+=x)}return a+=ee.addLine(o,!1),a}static addLine(e,r=!0){return e=ee.trimRight(e),e=r?`${e}
`:e,e}static getFromCache(e,r,n,i){let s=n[e];return typeof s!="number"&&(s=ee._measureText(e,r,i)+r,n[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!ee.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:ee._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:ee._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(ee.isBreakingSpace(s,o)||ee.isNewline(s)){n!==""&&(r.push(n),n=""),r.push(s);continue}n+=s}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,i,s){return!0}static wordWrapSplit(e){return ee.graphemeSegmenter(e)}static measureFont(e){if(ee._fonts[e])return ee._fonts[e];const r={ascent:0,descent:0,fontSize:0},n=ee._canvas,i=ee._context;i.font=e;const s=ee.METRICS_STRING+ee.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(ee.BASELINE_SYMBOL).width);const l=Math.ceil(ee.HEIGHT_MULTIPLIER*a);if(a=a*ee.BASELINE_MULTIPLIER|0,o===0||l===0)return ee._fonts[e]=r,r;n.width=o,n.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const c=i.getImageData(0,0,o,l).data,h=c.length,d=o*4;let f=0,p=0,g=!1;for(f=0;f<a;++f){for(let v=0;v<d;v+=4)if(c[p+v]!==255){g=!0;break}if(!g)p+=d;else break}for(r.ascent=a-f,p=h-d,g=!1,f=l;f>a;--f){for(let v=0;v<d;v+=4)if(c[p+v]!==255){g=!0;break}if(!g)p-=d;else break}return r.descent=f-a,r.fontSize=r.ascent+r.descent,ee._fonts[e]=r,r}static clearMetrics(e=""){e?delete ee._fonts[e]:ee._fonts={}}static get _canvas(){var e;if(!ee.__canvas){let r;try{const n=new OffscreenCanvas(0,0);if((e=n.getContext("2d",sl))!=null&&e.measureText)return ee.__canvas=n,n;r=X.ADAPTER.createCanvas()}catch{r=X.ADAPTER.createCanvas()}r.width=r.height=10,ee.__canvas=r}return ee.__canvas}static get _context(){return ee.__context||(ee.__context=ee._canvas.getContext("2d",sl)),ee.__context}};Ar.METRICS_STRING="|q",Ar.BASELINE_SYMBOL="M",Ar.BASELINE_MULTIPLIER=1.4,Ar.HEIGHT_MULTIPLIER=2,Ar.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})(),Ar.experimentalLetterSpacing=!1,Ar._fonts={},Ar._newlines=[10,13],Ar._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Sn=Ar;const zk=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],D1=class vo{constructor(e){this.styleID=0,this.reset(),Ph(this,e,e)}clone(){const e={};return Ph(e,this,vo.defaultStyle),new vo(e)}reset(){Ph(this,vo.defaultStyle,vo.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const r=Rh(e);this._dropShadowColor!==r&&(this._dropShadowColor=r,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const r=Rh(e);this._fill!==r&&(this._fill=r,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){Hk(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const r=Rh(e);this._stroke!==r&&(this._stroke=r,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let r=this.fontFamily;Array.isArray(this.fontFamily)||(r=this.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let i=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!zk.includes(i)&&(i=`"${i}"`),r[n]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${r.join(",")}`}};D1.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:ru.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let nr=D1;function Rh(t){const e=Me.shared,r=n=>{const i=e.setValue(n);return i.alpha===1?i.toHex():i.toRgbaString()};return Array.isArray(t)?t.map(r):r(t)}function Hk(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function Ph(t,e,r){for(const n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}const $k={texture:!0,children:!1,baseTexture:!0},j1=class bf extends Wn{constructor(e,r,n){let i=!1;n||(n=X.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const s=Z.from(n);s.orig=new fe,s.trim=new fe,super(s),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=bf.defaultResolution??X.RESOLUTION,this._autoResolution=bf.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return Sn.experimentalLetterSpacing}static set experimentalLetterSpacing(e){ge("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Sn.experimentalLetterSpacing=e}updateText(e){const r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const n=this.context,i=Sn.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,a=i.lines,l=i.lineHeight,c=i.lineWidths,h=i.maxLineWidth,d=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;let f,p;const g=r.dropShadow?2:1;for(let v=0;v<g;++v){const _=r.dropShadow&&v===0,y=_?Math.ceil(Math.max(1,o)+r.padding*2):0,x=y*this._resolution;if(_){n.fillStyle="black",n.strokeStyle="black";const w=r.dropShadowColor,b=r.dropShadowBlur*this._resolution,T=r.dropShadowDistance*this._resolution;n.shadowColor=Me.shared.setValue(w).setAlpha(r.dropShadowAlpha).toRgbaString(),n.shadowBlur=b,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*T,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*T+x}else n.fillStyle=this._generateFillStyle(r,a,i),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let m=(l-d.fontSize)/2;l-d.fontSize<0&&(m=0);for(let w=0;w<a.length;w++)f=r.strokeThickness/2,p=r.strokeThickness/2+w*l+d.ascent+m,r.align==="right"?f+=h-c[w]:r.align==="center"&&(f+=(h-c[w])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(a[w],f+r.padding,p+r.padding-y,!0),r.fill&&this.drawLetterSpacing(a[w],f+r.padding,p+r.padding-y)}this.updateTexture()}drawLetterSpacing(e,r,n,i=!1){const s=this._style.letterSpacing;let o=!1;if(Sn.experimentalLetterSpacingSupported&&(Sn.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(e,r,n):this.context.fillText(e,r,n);return}let a=r;const l=Sn.graphemeSegmenter(e);let c=this.context.measureText(e).width,h=0;for(let d=0;d<l.length;++d){const f=l[d];i?this.context.strokeText(f,a,n):this.context.fillText(f,a,n);let p="";for(let g=d+1;g<l.length;++g)p+=l[g];h=this.context.measureText(p).width,a+=c-h+s,c=h}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=uR(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const r=this._texture,n=this._style,i=n.trim?0:n.padding,s=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-i*2,r.orig.height=r._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,r){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,r)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,r,n){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,c=this.canvas.height/this._resolution-o-a*2,h=i.slice(),d=e.fillGradientStops.slice();if(!d.length){const f=h.length+1;for(let p=1;p<f;++p)d.push(p/f)}if(h.unshift(i[0]),d.unshift(0),h.push(i[i.length-1]),d.push(1),e.fillGradientType===ru.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,c+a);const f=n.fontProperties.fontSize+e.strokeThickness;for(let p=0;p<r.length;p++){const g=n.lineHeight*(p-1)+f,v=n.lineHeight*p;let _=v;p>0&&g>v&&(_=(v+g)/2);const y=v+f,x=n.lineHeight*(p+1);let m=y;p+1<r.length&&x<y&&(m=(y+x)/2);const w=(m-_)/c;for(let b=0;b<h.length;b++){let T=0;typeof d[b]=="number"?T=d[b]:T=b/h.length;let A=Math.min(1,Math.max(0,_/c+T*w));A=Number(A.toFixed(5)),s.addColorStop(A,h[b])}}}else{s=this.context.createLinearGradient(a,c/2,l+a,c/2);const f=h.length+1;let p=1;for(let g=0;g<h.length;g++){let v;typeof d[g]=="number"?v=d[g]:v=p/f,s.addColorStop(v,h[g]),p++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},$k,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const r=In(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const r=In(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof nr?this._style=e:this._style=new nr(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};j1.defaultAutoResolution=!0;let Ci=j1;class Vk{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Wk(t,e){var n;let r=!1;if((n=t==null?void 0:t._textures)!=null&&n.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof Z){const s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),r=!0)}}return r}function Xk(t,e){if(t.baseTexture instanceof he){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function Yk(t,e){if(t._texture&&t._texture instanceof Z){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function Kk(t,e){return e instanceof Ci?(e.updateText(!0),!0):!1}function qk(t,e){if(e instanceof nr){const r=e.toFontString();return Sn.measureFont(r),!0}return!1}function Qk(t,e){if(t instanceof Ci){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function Zk(t,e){return t instanceof nr?(e.includes(t)||e.push(t),!0):!1}const O1=class U1{constructor(e){this.limiter=new Vk(U1.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Qk),this.registerFindHook(Zk),this.registerFindHook(Wk),this.registerFindHook(Xk),this.registerFindHook(Yk),this.registerUploadHook(Kk),this.registerUploadHook(qk)}upload(e){return new Promise(r=>{e&&this.add(e),this.queue.length?(this.completes.push(r),this.ticking||(this.ticking=!0,Ut.system.addOnce(this.tick,this,Ai.UTILITY))):r()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let r=!1;if(e&&!e._destroyed){for(let n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),r=!0;break}}r||this.queue.shift()}if(this.queue.length)Ut.system.addOnce(this.tick,this,Ai.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let r=0,n=e.length;r<n;r++)e[r]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let r=0,n=this.addHooks.length;r<n&&!this.addHooks[r](e,this.queue);r++);if(e instanceof Nt)for(let r=e.children.length-1;r>=0;r--)this.add(e.children[r]);return this}destroy(){this.ticking&&Ut.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};O1.uploadsPerFrame=4;let Ef=O1;Object.defineProperties(X,{UPLOADS_PER_FRAME:{get(){return Ef.uploadsPerFrame},set(t){ge("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Ef.uploadsPerFrame=t}}});function G1(t,e){return e instanceof he?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function Jk(t,e){if(!(e instanceof Gt))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:n}=r;for(let i=0;i<n.length;i++){const{texture:s}=n[i].style;s&&G1(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function eM(t,e){return t instanceof Gt?(e.push(t),!0):!1}class z1 extends Ef{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(eM),this.registerUploadHook(G1),this.registerUploadHook(Jk)}}z1.extension={name:"prepare",type:V.RendererSystem};J.add(z1);var tM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,rM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,nM=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,lx=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,iM=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const ol=new Ne;class H1 extends Jc{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new X_,this.state=Or.for2d()}contextChange(){const e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=Dr.from(lx,iM,r),this.shader=e.context.webGLVersion>1?Dr.from(rM,tM,r):Dr.from(lx,nM,r)}render(e){const r=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=n.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,n.invalidate();const a=e._texture,l=a.baseTexture,c=l.alphaMode>0,h=e.tileTransform.localTransform,d=e.uvMatrix;let f=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;f&&(l._glTextures[r.CONTEXT_UID]?f=l.wrapMode!==Gn.CLAMP:l.wrapMode===Gn.CLAMP&&(l.wrapMode=Gn.REPEAT));const p=f?this.simpleShader:this.shader,g=a.width,v=a.height,_=e._width,y=e._height;ol.set(h.a*g/_,h.b*g/y,h.c*v/_,h.d*v/y,h.tx/_,h.ty/y),ol.invert(),f?ol.prepend(d.mapCoord):(p.uniforms.uMapCoord=d.mapCoord.toArray(!0),p.uniforms.uClampFrame=d.uClampFrame,p.uniforms.uClampOffset=d.uClampOffset),p.uniforms.uTransform=ol.toArray(!0),p.uniforms.uColor=Me.shared.setValue(e.tint).premultiply(e.worldAlpha,c).toArray(p.uniforms.uColor),p.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),p.uniforms.uSampler=a,r.shader.bind(p),r.geometry.bind(n),this.state.blendMode=N_(e.blendMode,c),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}H1.extension={name:"tilingSprite",type:V.RendererPlugin};J.add(H1);const $1=class _o{constructor(e,r,n){this.linkedSheets=[],(e instanceof he||e instanceof Z)&&(e={texture:e,data:r,resolutionFilename:n});const{texture:i,data:s,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=i instanceof Z?i:null,this.baseTexture=i instanceof he?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const l=this.baseTexture.resource;this.resolution=this._updateResolution(o||(l?l.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:r}=this.data.meta;let n=on(e,null);return n===null&&(n=typeof r=="number"?r:parseFloat(r??"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=_o.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=_o.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const i=this._frameKeys[r],s=this._frames[i],o=s.frame;if(o){let a=null,l=null;const c=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,h=new fe(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);s.rotated?a=new fe(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new fe(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new fe(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new Z(this.baseTexture,a,h,l,s.rotated?2:0,s.anchor,s.borders),Z.addToCache(this.textures[i],this.cachePrefix+i.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const i=e[r][n];this.animations[r].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*_o.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*_o.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var r;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((r=this._texture)==null||r.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};$1.BATCH_SIZE=1e3;let cx=$1;const sM=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function V1(t,e,r){const n={};if(t.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[`${e.cachePrefix}${i}`]=e.textures[i]}),!r){const i=lt.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(n,V1([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return n}const oM={extension:V.Asset,cache:{test:t=>t instanceof cx,getCacheableAssets:(t,e)=>V1(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&sM.includes(n)},parse:t=>{var r;const e=t.split(".");return{resolution:parseFloat(((r=X.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:V.LoadParser,priority:vr.Normal},async testParse(t,e){return lt.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){var h,d;const{texture:n,imageFilename:i,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=lt.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(n&&n.baseTexture)a=n;else{const f=vf(o+(i??t.meta.image),e.src);a=(await r.load([f]))[f]}const l=new cx({texture:a.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await l.parse();const c=(h=t==null?void 0:t.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(c)){const f=[];for(const g of c){if(typeof g!="string")continue;let v=o+g;(d=e.data)!=null&&d.ignoreMultiPack||(v=vf(v,e.src),f.push(r.load({src:v,data:{ignoreMultiPack:!0}})))}const p=await Promise.all(f);l.linkedSheets=p,p.forEach(g=>{g.linkedSheets=[l].concat(l.linkedSheets.filter(v=>v!==g))})}return l},unload(t){t.destroy(!0)}}};J.add(oM);class Ec{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Ml{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const r=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in r){const o=r[s].match(/^[a-z]+/gm)[0],a=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const c in a){const h=a[c].split("="),d=h[0],f=h[1].replace(/"/gm,""),p=parseFloat(f),g=isNaN(p)?f:p;l[d]=g}n[o].push(l)}const i=new Ec;return n.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),n.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),n.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),n.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),n.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),n.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class Tf{static test(e){const r=e;return typeof e!="string"&&"getElementsByTagName"in e&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const r=new Ec,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let c=0;c<n.length;c++)r.info.push({face:n[c].getAttribute("face"),size:parseInt(n[c].getAttribute("size"),10)});for(let c=0;c<i.length;c++)r.common.push({lineHeight:parseInt(i[c].getAttribute("lineHeight"),10)});for(let c=0;c<s.length;c++)r.page.push({id:parseInt(s[c].getAttribute("id"),10)||0,file:s[c].getAttribute("file")});for(let c=0;c<o.length;c++){const h=o[c];r.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(let c=0;c<a.length;c++)r.kerning.push({first:parseInt(a[c].getAttribute("first"),10),second:parseInt(a[c].getAttribute("second"),10),amount:parseInt(a[c].getAttribute("amount"),10)});for(let c=0;c<l.length;c++)r.distanceField.push({fieldType:l[c].getAttribute("fieldType"),distanceRange:parseInt(l[c].getAttribute("distanceRange"),10)});return r}}class Af{static test(e){return typeof e=="string"&&e.includes("<font>")?Tf.test(X.ADAPTER.parseXML(e)):!1}static parse(e){return Tf.parse(X.ADAPTER.parseXML(e))}}const Ih=[Ml,Tf,Af];function aM(t){for(let e=0;e<Ih.length;e++)if(Ih[e].test(t))return Ih[e];return null}function lM(t,e,r,n,i,s){const o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=r.dropShadow?r.dropShadowDistance:0,c=r.padding||0,h=t.width/n-l-c*2,d=t.height/n-l-c*2,f=o.slice(),p=r.fillGradientStops.slice();if(!p.length){const g=f.length+1;for(let v=1;v<g;++v)p.push(v/g)}if(f.unshift(o[0]),p.unshift(0),f.push(o[o.length-1]),p.push(1),r.fillGradientType===ru.LINEAR_VERTICAL){a=e.createLinearGradient(h/2,c,h/2,d+c);let g=0;const v=(s.fontProperties.fontSize+r.strokeThickness)/d;for(let _=0;_<i.length;_++){const y=s.lineHeight*_;for(let x=0;x<f.length;x++){let m=0;typeof p[x]=="number"?m=p[x]:m=x/f.length;const w=y/d+m*v;let b=Math.max(g,w);b=Math.min(b,1),a.addColorStop(b,f[x]),g=b}}}else{a=e.createLinearGradient(c,d/2,h+c,d/2);const g=f.length+1;let v=1;for(let _=0;_<f.length;_++){let y;typeof p[_]=="number"?y=p[_]:y=v/g,a.addColorStop(y,f[_]),v++}}return a}function cM(t,e,r,n,i,s,o){const a=r.text,l=r.fontProperties;e.translate(n,i),e.scale(s,s);const c=o.strokeThickness/2,h=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=lM(t,e,o,s,[a],r),e.strokeStyle=o.stroke,o.dropShadow){const d=o.dropShadowColor,f=o.dropShadowBlur*s,p=o.dropShadowDistance*s;e.shadowColor=Me.shared.setValue(d).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=f,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,c,h+r.lineHeight-l.descent),o.fill&&e.fillText(a,c,h+r.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Bl(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function W1(t){return Array.from?Array.from(t):t.split("")}function uM(t){typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...W1(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const xn=class Cr{constructor(e,r,n){var h;const[i]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=on(o.file),c={};this._ownsTextures=n,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=c;for(let d=0;d<e.page.length;d++){const{id:f,file:p}=e.page[d];c[f]=r instanceof Array?r[d]:r[p],a!=null&&a.fieldType&&a.fieldType!=="none"&&(c[f].baseTexture.alphaMode=Pt.NO_PREMULTIPLIED_ALPHA,c[f].baseTexture.mipmap=jr.OFF)}for(let d=0;d<e.char.length;d++){const{id:f,page:p}=e.char[d];let{x:g,y:v,width:_,height:y,xoffset:x,yoffset:m,xadvance:w}=e.char[d];g/=l,v/=l,_/=l,y/=l,x/=l,m/=l,w/=l;const b=new fe(g+c[p].frame.x/l,v+c[p].frame.y/l,_,y);this.chars[f]={xOffset:x,yOffset:m,xAdvance:w,kerning:{},texture:new Z(c[p].baseTexture,b),page:p}}for(let d=0;d<e.kerning.length;d++){let{first:f,second:p,amount:g}=e.kerning[d];f/=l,p/=l,g/=l,this.chars[p]&&(this.chars[p].kerning[f]=g)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((h=a==null?void 0:a.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,r,n){let i;if(e instanceof Ec)i=e;else{const o=aM(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof Z&&(r=[r]);const s=new Cr(i,r,n);return Cr.available[s.font]=s,s}static uninstall(e){const r=Cr.available[e];if(!r)throw new Error(`No font found named '${e}'`);r.destroy(),delete Cr.available[e]}static from(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:l,...c}=Object.assign({},Cr.defaultOptions,n),h=uM(i),d=r instanceof nr?r:new nr(r),f=a,p=new Ec;p.info[0]={face:d.fontFamily,size:d.fontSize},p.common[0]={lineHeight:d.fontSize};let g=0,v=0,_,y,x,m=0;const w=[];for(let T=0;T<h.length;T++){_||(_=X.ADAPTER.createCanvas(),_.width=a,_.height=l,y=_.getContext("2d"),x=new he(_,{resolution:o,...c}),w.push(new Z(x)),p.page.push({id:w.length-1,file:""}));const A=h[T],S=Sn.measureText(A,d,!1,_),R=S.width,I=Math.ceil(S.height),L=Math.ceil((d.fontStyle==="italic"?2:1)*R);if(v>=l-I*o){if(v===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${A}')`);--T,_=null,y=null,x=null,v=0,g=0,m=0;continue}if(m=Math.max(I+S.fontProperties.descent,m),L*o+g>=f){if(g===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${A}')`);--T,v+=m*o,v=Math.ceil(v),g=0,m=0;continue}cM(_,y,S,g,v,o,d);const B=Bl(S.text);p.char.push({id:B,page:w.length-1,x:g/o,y:v/o,width:L,height:I,xoffset:0,yoffset:0,xadvance:R-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),g+=(L+2*s)*o,g=Math.ceil(g)}if(!(n!=null&&n.skipKerning))for(let T=0,A=h.length;T<A;T++){const S=h[T];for(let R=0;R<A;R++){const I=h[R],L=y.measureText(S).width,B=y.measureText(I).width,C=y.measureText(S+I).width-(L+B);C&&p.kerning.push({first:Bl(S),second:Bl(I),amount:C})}}const b=new Cr(p,w,!0);return Cr.available[e]!==void 0&&Cr.uninstall(e),Cr.available[e]=b,b}};xn.ALPHA=[["a","z"],["A","Z"]," "],xn.NUMERIC=[["0","9"]],xn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],xn.ASCII=[[" ","~"]],xn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:xn.ALPHANUMERIC},xn.available={};let vn=xn;var hM=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,dM=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const ux=[],hx=[],dx=[],fM=class X1 extends Nt{constructor(e,r={}){super();const{align:n,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},X1.styleDefaults,r);if(!vn.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new Me(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Qr(()=>{this.dirty=!0},this,0,0),this._roundPixels=X.ROUND_PIXELS,this.dirty=!0,this._resolution=X.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var L;const e=vn.available[this._fontName],r=this.fontSize,n=r/e.size,i=new _e,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=W1(l),h=this._maxWidth*e.size/r,d=e.distanceFieldType==="none"?ux:hx;let f=null,p=0,g=0,v=0,_=-1,y=0,x=0,m=0,w=0;for(let B=0;B<c.length;B++){const C=c[B],N=Bl(C);if(/(?:\s)/.test(C)&&(_=B,y=p,w++),C==="\r"||C===`
`){o.push(p),a.push(-1),g=Math.max(g,p),++v,++x,i.x=0,i.y+=e.lineHeight,f=null,w=0;continue}const O=e.chars[N];if(!O)continue;f&&O.kerning[f]&&(i.x+=O.kerning[f]);const D=dx.pop()||{texture:Z.EMPTY,line:0,charCode:0,prevSpaces:0,position:new _e};D.texture=O.texture,D.line=v,D.charCode=N,D.position.x=Math.round(i.x+O.xOffset+this._letterSpacing/2),D.position.y=Math.round(i.y+O.yOffset),D.prevSpaces=w,s.push(D),p=D.position.x+Math.max(O.xAdvance-O.xOffset,O.texture.orig.width),i.x+=O.xAdvance+this._letterSpacing,m=Math.max(m,O.yOffset+O.texture.height),f=N,_!==-1&&h>0&&i.x>h&&(++x,Ts(s,1+_-x,1+B-_),B=_,_=-1,o.push(y),a.push(s.length>0?s[s.length-1].prevSpaces:0),g=Math.max(g,y),v++,i.x=0,i.y+=e.lineHeight,f=null,w=0)}const b=c[c.length-1];b!=="\r"&&b!==`
`&&(/(?:\s)/.test(b)&&(p=y),o.push(p),g=Math.max(g,p),a.push(-1));const T=[];for(let B=0;B<=v;B++){let C=0;this._align==="right"?C=g-o[B]:this._align==="center"?C=(g-o[B])/2:this._align==="justify"&&(C=a[B]<0?0:(g-o[B])/a[B]),T.push(C)}const A=s.length,S={},R=[],I=this._activePagesMeshData;d.push(...I);for(let B=0;B<A;B++){const C=s[B].texture,N=C.baseTexture.uid;if(!S[N]){let O=d.pop();if(!O){const j=new Dk;let M,G;e.distanceFieldType==="none"?(M=new ox(Z.EMPTY),G=se.NORMAL):(M=new ox(Z.EMPTY,{program:Zr.from(dM,hM),uniforms:{uFWidth:0}}),G=se.NORMAL_NPM);const k=new sx(j,M);k.blendMode=G,O={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:k,vertices:null,uvs:null,indices:null}}O.index=0,O.indexCount=0,O.vertexCount=0,O.uvsCount=0,O.total=0;const{_textureCache:D}=this;D[N]=D[N]||new Z(C.baseTexture),O.mesh.texture=D[N],O.mesh.tint=this._tintColor.value,R.push(O),S[N]=O}S[N].total++}for(let B=0;B<I.length;B++)R.includes(I[B])||this.removeChild(I[B].mesh);for(let B=0;B<R.length;B++)R[B].mesh.parent!==this&&this.addChild(R[B].mesh);this._activePagesMeshData=R;for(const B in S){const C=S[B],N=C.total;if(!(((L=C.indices)==null?void 0:L.length)>6*N)||C.vertices.length<sx.BATCHABLE_SIZE*2)C.vertices=new Float32Array(4*2*N),C.uvs=new Float32Array(4*2*N),C.indices=new Uint16Array(6*N);else{const O=C.total,D=C.vertices;for(let j=O*4*2;j<D.length;j++)D[j]=0}C.mesh.size=6*N}for(let B=0;B<A;B++){const C=s[B];let N=C.position.x+T[C.line]*(this._align==="justify"?C.prevSpaces:1);this._roundPixels&&(N=Math.round(N));const O=N*n,D=C.position.y*n,j=C.texture,M=S[j.baseTexture.uid],G=j.frame,k=j._uvs,P=M.index++;M.indices[P*6+0]=0+P*4,M.indices[P*6+1]=1+P*4,M.indices[P*6+2]=2+P*4,M.indices[P*6+3]=0+P*4,M.indices[P*6+4]=2+P*4,M.indices[P*6+5]=3+P*4,M.vertices[P*8+0]=O,M.vertices[P*8+1]=D,M.vertices[P*8+2]=O+G.width*n,M.vertices[P*8+3]=D,M.vertices[P*8+4]=O+G.width*n,M.vertices[P*8+5]=D+G.height*n,M.vertices[P*8+6]=O,M.vertices[P*8+7]=D+G.height*n,M.uvs[P*8+0]=k.x0,M.uvs[P*8+1]=k.y0,M.uvs[P*8+2]=k.x1,M.uvs[P*8+3]=k.y1,M.uvs[P*8+4]=k.x2,M.uvs[P*8+5]=k.y2,M.uvs[P*8+6]=k.x3,M.uvs[P*8+7]=k.y3}this._textWidth=g*n,this._textHeight=(i.y+e.lineHeight)*n;for(const B in S){const C=S[B];if(this.anchor.x!==0||this.anchor.y!==0){let j=0;const M=this._textWidth*this.anchor.x,G=this._textHeight*this.anchor.y;for(let k=0;k<C.total;k++)C.vertices[j++]-=M,C.vertices[j++]-=G,C.vertices[j++]-=M,C.vertices[j++]-=G,C.vertices[j++]-=M,C.vertices[j++]-=G,C.vertices[j++]-=M,C.vertices[j++]-=G}this._maxLineHeight=m*n;const N=C.mesh.geometry.getBuffer("aVertexPosition"),O=C.mesh.geometry.getBuffer("aTextureCoord"),D=C.mesh.geometry.getIndex();N.data=C.vertices,O.data=C.uvs,D.data=C.indices,N.update(),O.update(),D.update()}for(let B=0;B<s.length;B++)dx.push(s[B]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:r,distanceFieldType:n,size:i}=vn.available[this._fontName];if(n!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,c=Math.sqrt(s*s+o*o),h=Math.sqrt(a*a+l*l),d=(Math.abs(c)+Math.abs(h))/2,f=this.fontSize/i,p=e._view.resolution;for(const g of this._activePagesMeshData)g.mesh.shader.uniforms.uFWidth=d*r*f*p}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=vn.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!vn.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??vn.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:r}=this,n=vn.available[this._fontName].distanceFieldType==="none"?ux:hx;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>r[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=Z.EMPTY});for(const i in r)r[i].destroy(),delete r[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};fM.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const pM=[".xml",".fnt"],mM={extension:{type:V.LoadParser,priority:vr.Normal},name:"loadBitmapFont",test(t){return pM.includes(lt.extname(t).toLowerCase())},async testParse(t){return Ml.test(t)||Af.test(t)},async parse(t,e,r){const n=Ml.test(t)?Ml.parse(t):Af.parse(t),{src:i}=e,{page:s}=n,o=[];for(let c=0;c<s.length;++c){const h=s[c].file;let d=lt.join(lt.dirname(i),h);d=vf(d,i),o.push(d)}const a=await r.load(o),l=o.map(c=>a[c]);return vn.install(n,l,!0)},async load(t,e){return(await X.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};J.add(mM);const Cf=class es extends nr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new es(Object.keys(es.defaultOptions).reduce((r,n)=>({...r,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete es.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,r={}){const{availableFonts:n}=es;if(n[e]){const i=n[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return X.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,o)=>{const a=URL.createObjectURL(i),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(i)})).then(async([i,s])=>{const o=Object.assign({family:lt.basename(e,lt.extname(e)),weight:"normal",style:"normal",display:"auto",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},r);n[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const r=e.filter(n=>!this._overrides.includes(n));r.length>0&&(this._overrides.push(...r),this.styleID++)}removeOverride(...e){const r=e.filter(n=>this._overrides.includes(n));r.length>0&&(this._overrides=this._overrides.filter(n=>!r.includes(n)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,r)=>`${e}
            @font-face {
                font-family: "${r.family}";
                src: url('${r.dataSrc}');
                font-weight: ${r.weight};
                font-style: ${r.style};
                font-display: ${r.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=iR(e)),typeof e=="number"?nR(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const r=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&r<1&&(e+=(r*255|0).toString(16).padStart(2,"0"));const s=`${n}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,es.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(r=>setTimeout(r,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=X.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};Cf.availableFonts={},Cf.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let kh=Cf;const al=class ts extends Wn{constructor(e="",r={}){super(Z.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,i=Z.from(n,{scaleMode:X.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new fe,i.trim=new fe,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),c=document.createElementNS(o,"div"),h=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=ts.defaultMaxWidth,this.maxHeight=ts.defaultMaxHeight,this._domElement=c,this._styleElement=h,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(h),this._foreignObject.appendChild(c),this._image=n,this._loadImage=new Image,this._autoResolution=ts.defaultAutoResolution,this._resolution=ts.defaultResolution??X.RESOLUTION,this.text=e,this.style=r}measureText(e){var h,d;const{text:r,style:n,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:r,style:n.toCSS(i)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),c=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",c.toString()),r!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(h=this._style)==null?void 0:h.toCSS(i)}),this._styleElement.textContent=(d=this._style)==null?void 0:d.toGlobalCSS()),{width:l+n.padding*2,height:c+n.padding*2}}async updateText(e=!0){const{style:r,_image:n,_loadImage:i}=this;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();n.width=i.width=Math.ceil(Math.max(1,s)),n.height=i.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{i.onload=async()=>{if(a<this._updateID){l();return}await r.onBeforeDraw(),n.src=i.src,i.onload=null,i.src="",this.updateTexture(),l()};const c=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(c)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:r,_image:n,resolution:i}=this,{padding:s}=e,{baseTexture:o}=r;r.trim.width=r._frame.width=n.width/i,r.trim.height=r._frame.height=n.height/i,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-s*2,r.orig.height=r._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(n.width,n.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var n,i,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},ts.defaultDestroyOptions,e),super.destroy(e);const r=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=r,(i=this._svgRoot)==null||i.remove(),this._svgRoot=r,(s=this._domElement)==null||s.remove(),this._domElement=r,(o=this._foreignObject)==null||o.remove(),this._foreignObject=r,(a=this._styleElement)==null||a.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const r=In(this.scale.x)||1;this.scale.x=r*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const r=In(this.scale.y)||1;this.scale.y=r*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof kh?(this.ownsStyle=!1,this._style=e):e instanceof nr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=kh.from(e)):(this.ownsStyle=!0,this._style=new kh(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};al.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},al.defaultMaxWidth=2024,al.defaultMaxHeight=2024,al.defaultAutoResolution=!0;const It={background:1710638,surface:2960708,hitZone:16098851,laneLeft:2972199,laneRight:4886745,textMuted:10526896,perfect:5025616,partial:16098851,miss:15037299},gM=.72,Mh=85,Rf=.82,fx=new Map;async function px(t){const e=`/${t}`,r=fx.get(t);if(r)return r;const n=(async()=>{try{console.log(`[Texture] Loading: ${e}`);const i=await yo.load(e);return!i||!i.valid?(console.error(`[Texture] Invalid texture loaded: ${t}`,{fullPath:e,texture:i}),null):(console.log(`[Texture] Success: ${t}`),i)}catch(i){return console.error(`[Texture] Failed to load: ${t}`,{fullPath:e,error:i}),null}})();return fx.set(t,n),n}function yM({width:t,height:e,scheduledEvents:r,activeEvents:n,roundStartTime:i,roundState:s,scrollSpeed:o,currentFeedback:a,onChannelTap:l,trainingMode:c=!1,spectrogramMode:h="full",highContrast:d=!1}){const f=E.useRef(null),p=E.useRef(null),g=E.useRef(new Map),v=E.useRef(null),_=E.useCallback(y=>{var S;if(!l||!f.current)return;let x;"touches"in y?x=((S=y.touches[0])==null?void 0:S.clientX)??0:x=y.clientX;const m=f.current.getBoundingClientRect(),w=x-m.left,b=m.width/2,T=m.width*.1;if(Math.abs(w-b)<T/2)return;const A=w<b?"left":"right";l(A)},[l]);return E.useEffect(()=>{if(!f.current)return;const y=new T1({width:t,height:e,backgroundColor:It.background,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0});f.current.appendChild(y.view),p.current=y,gx(y,t,e),yx(y,t,e),xx(y,t,e);const x=new Nt;return y.stage.addChild(x),v.current=x,()=>{p.current&&(p.current.destroy(!0,{children:!0}),p.current=null),g.current.clear()}},[t,e]),E.useEffect(()=>{if(p.current){p.current.renderer.resize(t,e);const y=p.current;for(;y.stage.children.length>0;)y.stage.removeChildAt(0);gx(y,t,e),yx(y,t,e),xx(y,t,e);const x=new Nt;y.stage.addChild(x),v.current=x,g.current.clear()}},[t,e]),E.useEffect(()=>{const y=v.current;if(!y)return;if(s!=="playing"){y.removeChildren(),g.current.clear();return}if(r.length===0)return;const x=t/2,m=x*gM,w=e*Rf;for(const b of r){if(g.current.has(b.event_id))continue;const T=xM(b,x,m,Mh,w,b.spectrogramPath,c,h,d);T.container.y=-Mh,y.addChild(T.container),g.current.set(b.event_id,T)}},[r,s,t,e,c,h,d]),E.useEffect(()=>{if(s!=="playing"||!p.current)return;const y=e*Rf;let x;const m=()=>{const w=performance.now(),b=w-i;for(const T of g.current.values())if(T.hasBeenScored&&T.feedbackType){const A=w-T.feedbackStartTime;A>500&&(T.container.alpha=Math.max(0,1-(A-500)/200),T.container.alpha<=0&&(T.container.visible=!1))}else{const A=T.scheduledTimeMs-T.enterTimeMs,S=b-T.enterTimeMs,R=Math.max(0,S/A),I=-Mh,L=y;if(T.container.y=I+R*(L-I),h==="fading"){const B=T.container.getChildByName("spectrogram");B&&(R<.3?B.alpha=1:R<.8?B.alpha=1-(R-.3)/.5:B.alpha=0)}T.container.y>y+100&&(T.container.alpha=Math.max(0,1-(T.container.y-y-100)/50))}x=requestAnimationFrame(m)};return x=requestAnimationFrame(m),()=>{cancelAnimationFrame(x)}},[s,i,e,o,h]),E.useEffect(()=>{var y;if(a){for(const x of n)if(x.hasBeenScored&&x.channel===a.channel){const m=g.current.get(x.event_id);m&&!m.feedbackType&&(m.hasBeenScored=!0,m.feedbackType=a.type,m.feedbackStartTime=performance.now(),((y=a.breakdown)==null?void 0:y.speciesCorrect)?(mx(m,a.type,a.score),m.container.scale.set(1.3),setTimeout(()=>{m.container.visible=!1},400)):mx(m,a.type,a.score))}}},[a,n]),u.jsx("div",{ref:f,className:"pixi-game-container",onClick:_,onTouchStart:_,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none"}})}function xM(t,e,r,n,i,s,o=!1,a="full",l=!1){const c=new Nt,h=t.channel==="left"?e/2:e+e/2;c.x=h;const d=t.channel==="left"?It.laneLeft:It.laneRight,f=new Gt,p=l?.7:.4,g=l?4:2,v=l?1:.8;f.beginFill(d,p),f.lineStyle(g,d,v),f.drawRoundedRect(-r/2,-n/2,r,n,8),f.endFill(),c.addChild(f);const _=a!=="none"&&s;if(_&&px(s).then(y=>{if(y&&c.parent){const x=new Wn(y);x.anchor.set(.5),x.position.set(0,0);const m=r-16,w=n-16;x.width=m,x.height=w,x.name="spectrogram",c.addChildAt(x,1),console.log(`[Sprite] Added spectrogram to tile: ${s}`)}else y?c.parent||console.warn(`[Sprite] Container removed before sprite could be added: ${s}`):console.error(`[Sprite] Texture null for: ${s}`)}),!_){const y=new Gt;for(let w=0;w<6;w++){const b=-n/2+10+w*10,T=(Math.random()*.4+.4)*r,A=-T/2+(Math.random()-.5)*20;y.beginFill(16777215,.2+Math.random()*.2),y.drawRect(A,b,T,2),y.endFill()}c.addChild(y);const x=new nr({fontFamily:"Inter, sans-serif",fontSize:18,fill:16777215,fontWeight:"700"}),m=new Ci("?",x);m.anchor.set(.5),m.position.set(0,0),m.alpha=.4,c.addChild(m)}if(o){const y=new nr({fontFamily:"Inter, sans-serif",fontSize:10,fill:16777215,fontWeight:"700"}),x=new Ci(t.species_code,y);x.anchor.set(.5),x.position.set(r/2-20,-n/2+44),x.alpha=.8;const m=new Gt;m.beginFill(0,.7);const w=3,b=x.width+w*2,T=x.height+w*2;m.drawRoundedRect(-b/2,-T/2,b,T,2),m.endFill(),m.position.set(x.position.x,x.position.y),c.addChild(m),c.addChild(x);const A=`data/icons/${t.species_code}.png`;px(A).then(S=>{if(S&&c.parent){const R=new Wn(S);R.anchor.set(.5),R.width=32,R.height=32,R.position.set(r/2-20,-n/2+20),R.alpha=.9,c.addChild(R)}})}return{container:c,eventId:t.event_id,scheduledTimeMs:t.scheduled_time_ms,enterTimeMs:t.scoring_window_start_ms,channel:t.channel,speciesCode:t.species_code,hasBeenScored:!1,feedbackType:null,feedbackStartTime:0,spectrogramPath:s}}function mx(t,e,r){const n=t.container,i=e==="perfect"||e==="good"?It.perfect:e==="partial"?It.partial:It.miss,s=new Gt,o=100,a=70;if(s.beginFill(i,.5),s.drawRoundedRect(-o/2,-a/2,o,a,8),s.endFill(),n.addChildAt(s,1),r>0){const l=new nr({fontFamily:"JetBrains Mono, monospace",fontSize:20,fontWeight:"700",fill:i,stroke:0,strokeThickness:3}),c=new Ci(`+${r}`,l);c.anchor.set(.5),c.position.set(0,-a/2-15),n.addChild(c)}n.scale.set(1.1),setTimeout(()=>{n.scale.set(1)},100)}function gx(t,e,r){const n=e/2,i=new Gt;i.beginFill(It.background,1),i.drawRect(0,0,n-1,r),i.endFill(),t.stage.addChild(i);const s=new Gt;s.beginFill(It.background,1),s.drawRect(n+1,0,n-1,r),s.endFill(),t.stage.addChild(s);const o=new nr({fontFamily:"Inter, sans-serif",fontSize:14,fill:It.textMuted,fontWeight:"600"}),a=new Ci("LEFT",o);a.anchor.set(.5),a.position.set(n/2,30),a.alpha=.5,t.stage.addChild(a);const l=new Ci("RIGHT",o);l.anchor.set(.5),l.position.set(n+n/2,30),l.alpha=.5,t.stage.addChild(l)}function yx(t,e,r){const n=e/2,i=r*Rf,s=4,o=new Gt;o.beginFill(It.hitZone,.8),o.drawRect(20,i,n-40,s),o.endFill(),t.stage.addChild(o);const a=new Gt;a.beginFill(It.hitZone,.8),a.drawRect(n+20,i,n-40,s),a.endFill(),t.stage.addChild(a);const l=new Gt;l.beginFill(It.hitZone,.2),l.drawRect(20,i-2,n-40,s+4),l.endFill(),t.stage.addChild(l);const c=new Gt;c.beginFill(It.hitZone,.2),c.drawRect(n+20,i-2,n-40,s+4),c.endFill(),t.stage.addChild(c)}function xx(t,e,r){const n=e/2,i=new Gt,s=20,o=10;let a=0;for(i.beginFill(It.surface,.5);a<r;)i.drawRect(n-1,a,2,s),a+=s+o;i.endFill(),t.stage.addChild(i)}const vM=E.memo(yM),yn={SPECIES_CORRECT:50,CHANNEL_CORRECT:25,TIMING_PERFECT:25,TIMING_PARTIAL:10};class _M{constructor(e){pn(this,"panner");this.panner=e.createStereoPanner()}get output(){return this.panner}setPan(e){this.panner.pan.value=Math.max(-1,Math.min(1,e))}disconnect(){this.panner.disconnect()}}class vx{constructor(e){pn(this,"ctx");pn(this,"inputGain");pn(this,"leftGain");pn(this,"rightGain");pn(this,"merger");this.ctx=e,this.inputGain=e.createGain(),this.leftGain=e.createGain(),this.rightGain=e.createGain(),this.merger=e.createChannelMerger(2),this.inputGain.connect(this.leftGain),this.inputGain.connect(this.rightGain),this.leftGain.connect(this.merger,0,0),this.rightGain.connect(this.merger,0,1),this.setPan(0)}get output(){return this.inputGain}get destination(){return this.merger}setPan(e){const n=(Math.max(-1,Math.min(1,e))+1)*Math.PI/4,i=Math.cos(n),s=Math.sin(n);this.leftGain.gain.setValueAtTime(i,this.ctx.currentTime),this.rightGain.gain.setValueAtTime(s,this.ctx.currentTime)}disconnect(){this.inputGain.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.merger.disconnect()}}class wM{constructor(){pn(this,"capabilities");this.capabilities=this.detectCapabilities(),console.log("Audio capabilities:",this.capabilities)}detectCapabilities(){const e=navigator.userAgent,r=/iPad|iPhone|iPod/.test(e)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,n=r&&/CriOS/.test(e),i=r&&/FxiOS/.test(e),s=r&&/EdgiOS/.test(e),o=typeof AudioContext<"u"||typeof window.webkitAudioContext<"u",a=o&&typeof StereoPannerNode<"u"&&!n&&!i&&!s;return{supportsStereoPanner:a,supportsWebAudio:o,isIOSChrome:n,isIOS:r,browserInfo:`iOS: ${r}, Chrome: ${n}, StereoPanner: ${a}`}}getCapabilities(){return{...this.capabilities}}supportsStereoPanner(){return this.capabilities.supportsStereoPanner}isIOSChrome(){return this.capabilities.isIOSChrome}createPanner(e){return this.capabilities.supportsStereoPanner?new _M(e):new vx(e)}createChannelPanner(e,r){const n=this.createPanner(e);return n.setPan(r==="left"?-1:1),n}connectPannerToDestination(e,r){e instanceof vx?e.destination.connect(r):e.output.connect(r)}}let Bh=null;function _x(){return Bh||(Bh=new wM),Bh}const wx={low:100,medium:150,high:200},SM={level_id:1,pack_id:"common_se_birds",mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},bM={NOCA:"#E57373",CARW:"#81C784",BLJA:"#4FC3F7",AMCR:"#424242",TUTI:"#FFD54F",BEKI:"#00BCD4",RSHA:"#8D6E63",AMGO:"#FFEB3B",CACH:"#B0BEC5",PIWA:"#AED581",WTSP:"#BCAAA4",HOFI:"#EF9A9A",EABL:"#64B5F6",AMRO:"#FF8A65",HETH:"#D7CCC8",BHNU:"#A1887F",BRCR:"#8D6E63",WBNU:"#80CBC4",YBSA:"#FFF59D",RBWO:"#CE93D8",DOWO:"#90A4AE",HAWO:"#CFD8DC",NOFL:"#FFCC80",PIWO:"#B39DDB",BRTH:"#A1887F",GRCA:"#78909C",MODO:"#BCAAA4"};function EM(t){let e=t;return()=>(e=e*1103515245+12345&2147483647,e/2147483647)}function TM(t=SM){const e=E.useRef(null),r=E.useRef(new Map),n=E.useRef(new Map),i=E.useRef(new Map),s=E.useRef(new Map),o=E.useRef(new Map),a=E.useRef(null),[l,c]=E.useState([]),[h,d]=E.useState([]),[f,p]=E.useState([]);E.useEffect(()=>{console.log("species state changed, now has",f.length,"species:",f.map(H=>H.code))},[f]);const[g,v]=E.useState("idle"),[_,y]=E.useState(0),[x,m]=E.useState(0),[w,b]=E.useState(t.round_duration_sec),[T,A]=E.useState(0),[S,R]=E.useState(0),[I,L]=E.useState(0),[B,C]=E.useState(0),[N,O]=E.useState(0),[D,j]=E.useState([]),[M,G]=E.useState([]),[k,P]=E.useState(0),F=E.useRef(1),q=E.useRef(typeof window<"u"&&localStorage.getItem("soundfield_continuous_play")==="true"),[Q,le]=E.useState(0),xe=5e3,[oe,Pe]=E.useState(()=>{const H=wx[t.event_density]||100,ie=localStorage.getItem("soundfield_scroll_speed"),ce=ie?parseFloat(ie):.5;return F.current=ce,H*ce}),[Le,Te]=E.useState(null),[Se,be]=E.useState(!0),Ee=E.useRef(null),Ye=E.useRef([]),rt=E.useRef(0),Lt=E.useRef([]),Li=E.useRef(new Set),cn=E.useRef(0),nu=E.useRef(0),iu=E.useRef(0),su=E.useRef(0),ou=E.useRef(0),Fi=E.useRef(0),va=E.useRef([]),au=E.useRef([]),_a=E.useRef(0),un=E.useRef(null),Tt=E.useRef(null),hn=E.useRef({left:null,right:null}),pt=E.useRef({left:null,right:null}),$p=E.useCallback(async()=>{var H;console.log("loadClips called with level:",{pack_id:t.pack_id,species_pool_length:(H=t.species_pool)==null?void 0:H.length,species_count:t.species_count});try{const ie=await fetch("/data/clips.json");if(!ie.ok)throw new Error("Failed to load clips.json");const ce=await ie.json();c(ce);const re=t.species_pool,ae=re?new Set(re):null,ne=new Map;for(const de of ce)ae&&!ae.has(de.species_code)||ne.has(de.species_code)||ne.set(de.species_code,{code:de.species_code,name:de.common_name,color:bM[de.species_code]});const pe=Array.from(ne.values());d(pe);const Re=sessionStorage.getItem("roundSpecies");if(Re)try{const de=JSON.parse(Re),ve=pe.filter(De=>de.includes(De.code)).sort((De,z)=>De.code.localeCompare(z.code));if(ve.length>0){console.log("loadClips: Using pre-selected species:",ve.map(De=>De.code)),p(ve);return}}catch(de){console.error("Failed to parse pre-selected species in loadClips:",de)}p(pe)}catch(ie){console.error("Error loading clips:",ie)}},[t.species_pool,t.species_count]),Vp=E.useCallback(async()=>{if(e.current){console.log("initializeAudio: Already initialized, setting isAudioReady"),be(!0);return}try{const H=_x();console.log("initializeAudio: Browser capabilities:",H.getCapabilities());const ie=new AudioContext;e.current=ie,console.log("initializeAudio: AudioContext created, state:",ie.state),ie.state==="suspended"&&(console.log("initializeAudio: AudioContext suspended, attempting resume..."),await ie.resume(),console.log("initializeAudio: AudioContext resumed, state:",ie.state)),be(!0),console.log("initializeAudio: Audio is ready!")}catch(H){console.error("initializeAudio: Failed to initialize audio:",H),be(!0)}},[]),lu=E.useCallback(async H=>{const ie=e.current;if(!ie)throw new Error("Audio context not initialized");const ce=r.current.get(H);if(ce)return console.log("loadAudioBuffer: Using cached buffer for",H),ce;console.log("loadAudioBuffer: Fetching",H);const re=await fetch(`/${H}`);if(!re.ok)throw console.error("loadAudioBuffer: Fetch failed",re.status,re.statusText),new Error(`Failed to load audio: ${H}`);console.log("loadAudioBuffer: Fetch OK, decoding...");const ae=await re.arrayBuffer();try{const ne=await ie.decodeAudioData(ae);return console.log("loadAudioBuffer: Decoded OK, duration:",ne.duration),r.current.set(H,ne),ne}catch(ne){throw console.error(` DECODE FAILED for ${H}:`,ne),console.error("  This file cannot be played in Web Audio API (gameplay)"),console.error("  File size:",ae.byteLength,"bytes"),new Error(`Cannot decode audio file: ${H} - ${ne}`)}},[]),Wp=E.useCallback(async(H,ie,ce,re)=>{const ae=e.current;if(!ae){console.error("playAudio: No AudioContext!");return}console.log("playAudio:",H,"ctx.state:",ae.state);try{ae.state==="suspended"&&(console.log("playAudio: Context suspended, trying to resume..."),await ae.resume());const ne=await lu(H);console.log("playAudio: Buffer loaded, duration:",ne.duration);const pe=_x();console.log("playAudio: Using adapter, capabilities:",pe.getCapabilities());const Re=ae.createBufferSource(),de=ae.createGain(),ve=pe.createChannelPanner(ae,ie);de.gain.value=.05,Re.buffer=ne,Re.connect(de),de.connect(ve.output),pe.connectPannerToDestination(ve,ae.destination),Re.loop=!0,n.current.set(ce,Re),i.current.set(ce,de),s.current.set(ce,ve),o.current.set(ce,re),Re.onended=()=>{n.current.delete(ce),i.current.delete(ce);const De=s.current.get(ce);De&&(De.disconnect(),s.current.delete(ce)),o.current.delete(ce)},Re.start(),console.log("playAudio: Started playing")}catch(ne){console.error(" playAudio FAILED for",H),console.error("   Error:",ne),console.error("   This bird will have no audio during gameplay!")}},[lu]),Xs=E.useCallback(H=>{const ie=n.current.get(H);if(ie)try{ie.stop()}catch{}const ce=s.current.get(H);ce&&ce.disconnect(),n.current.delete(H),i.current.delete(H),s.current.delete(H),o.current.delete(H)},[]),Xp=E.useCallback((H,ie,ce,re)=>{const ae=ie.filter(z=>z.species_code===H&&!z.rejected);if(ae.length===0)return[];const ne=ae.filter(z=>z.canonical),pe=ae.filter(z=>!z.canonical);if(ce==="canonical")return ne.length>0?ne:ae.slice(0,1);if(ce==="all")return ae;const Re=ce,de=[];ne.length>0&&de.push(...ne);const ve=[...pe];for(let z=ve.length-1;z>0;z--){const K=Math.floor(re()*(z+1));[ve[z],ve[K]]=[ve[K],ve[z]]}const De=Re-de.length;return de.push(...ve.slice(0,De)),de},[]),Yp=E.useCallback(H=>{const ie=[],ce=Date.now(),re=EM(ce),ae=t.clip_selection??(t.canonical_only?"canonical":"all");let ne;if(H&&H.length>0)ne=[...H];else if(t.species_pool&&t.species_pool.length>0)ne=[...t.species_pool];else{const z=new Set;for(const ue of l)ue.rejected||z.add(ue.species_code);const K=Array.from(z);for(let ue=K.length-1;ue>0;ue--){const Ce=Math.floor(re()*(ue+1));[K[ue],K[Ce]]=[K[Ce],K[ue]]}ne=K.slice(0,t.species_count)}const pe=new Map;for(const z of ne){const K=Xp(z,l,ae,re);K.length>0&&pe.set(z,K)}if(ne=ne.filter(z=>pe.has(z)),ne.length===0)return console.error("No species with available clips!"),[];console.log("generateEvents:",{clipSelection:ae,selectedSpecies:ne,clipsPerSpecies:Object.fromEntries(Array.from(pe.entries()).map(([z,K])=>[z,K.map(ue=>ue.clip_id)]))});const Re=2,de=new Map,De=localStorage.getItem("soundfield_continuous_play")==="true"?100:Math.ceil(t.round_duration_sec/2)+5;for(let z=0;z<De;z++){const K=ne.filter(Gr=>(pe.get(Gr)||[]).some(mt=>(de.get(mt.clip_id)||0)<Re));let ue;K.length>0?ue=K[Math.floor(re()*K.length)]:ue=ne[Math.floor(re()*ne.length)];const Ce=pe.get(ue)||[],Ur=Ce.filter(Gr=>(de.get(Gr.clip_id)||0)<Re);let At;if(Ur.length>0?At=Ur[Math.floor(re()*Ur.length)]:At=Ce.reduce((Gr,Di)=>{const mt=de.get(Gr.clip_id)||0;return(de.get(Di.clip_id)||0)<mt?Di:Gr},Ce[0]),!At)continue;de.set(At.clip_id,(de.get(At.clip_id)||0)+1);const Zn=re()<.5?"left":"right";ie.push({event_id:`evt_${z}_${ce}`,clip_id:At.clip_id,species_code:ue,channel:Zn,scheduled_time_ms:0,scoring_window_start_ms:0,scoring_window_end_ms:0,duration_ms:At.duration_ms,vocalization_type:At.vocalization_type})}return ie},[l,t,Xp]),Kp=E.useCallback(H=>l.find(ie=>ie.clip_id===H),[l]),ir=E.useCallback(H=>{const ie=au.current,ce=_a.current,re=t.channel_mode||"single",ae=xe/F.current;if(ce>=ie.length){re==="single"?un.current=null:H&&(hn.current[H]=null);return}const ne=performance.now(),pe=rt.current,Re=ne-pe;if(!q.current&&t.round_duration_sec*1e3-Re<2e3){re==="single"?un.current=null:H&&(hn.current[H]=null);return}const de=ie[ce];_a.current=ce+1;let ve;if(re==="offset"&&H?ve=H:ve=de.channel,re==="single")Tt.current!==null&&(clearTimeout(Tt.current),Tt.current=null);else{const mt=pt.current[ve];mt!==null&&(clearTimeout(mt),pt.current[ve]=null)}const De=Re,z=Re+ae,K={...de,channel:ve,scheduled_time_ms:z,scoring_window_start_ms:De,scoring_window_end_ms:z+500};re==="single"?un.current=K.event_id:hn.current[ve]=K.event_id;const ue=Kp(K.clip_id);if(!ue){console.error("spawnNextEvent: clip not found for clip_id:",K.clip_id,"species:",K.species_code),re==="single"?ir():H&&ir(H);return}Lt.current.push(K);const Ce={...K,spectrogramPath:ue.spectrogram_path||null,filePath:ue.file_path};G(mt=>[...mt,Ce]),Wp(ue.file_path,ve,K.event_id,K.scheduled_time_ms),j(mt=>[...mt,{...K,isActive:!0,hasBeenScored:!1}]);const Ur=ae+500,At=K.event_id,Zn=ve,Gr=K.species_code,Di=window.setTimeout(()=>{if(re==="single"){if(un.current!==At)return;Tt.current=null}else{if(hn.current[Zn]!==At)return;pt.current[Zn]=null}Xs(At),j(mt=>mt.map(fn=>fn.event_id===At?{...fn,isActive:!1}:fn)),j(mt=>{const fn=mt.find(Ys=>Ys.event_id===At);if(fn&&!fn.hasBeenScored){O(ji=>ji+1),ou.current+=1,m(0),va.current.push({expectedSpecies:Gr,guessedSpecies:null,channel:Zn});const Ys={id:`miss_${Date.now()}`,type:"miss",score:0,breakdown:{speciesCorrect:!1,channelCorrect:!1,timingAccuracy:"miss",speciesPoints:0,channelPoints:0,timingPoints:0,totalPoints:0},channel:Zn,timestamp:performance.now(),expectedSpecies:Gr};Te(Ys),setTimeout(()=>{Te(ji=>(ji==null?void 0:ji.id)===Ys.id?null:ji)},1500)}return mt}),window.setTimeout(()=>{re==="single"?ir():ir(Zn)},200)},Ur);re==="single"?Tt.current=Di:pt.current[ve]=Di},[Kp,Wp,Xs,t.round_duration_sec,t.channel_mode]),qp=E.useCallback((H,ie)=>{if((t.channel_mode||"single")==="single"){if(un.current!==H)return;Tt.current!==null&&(clearTimeout(Tt.current),Tt.current=null),un.current=null,Xs(H),ir()}else{if(hn.current[ie]!==H)return;const re=pt.current[ie];re!==null&&(clearTimeout(re),pt.current[ie]=null),hn.current[ie]=null,Xs(H),ir(ie)}},[Xs,ir,t.channel_mode]),Qp=E.useCallback(async()=>{console.log("initialize: Starting...");try{await Promise.all([$p().catch(H=>console.error("initialize: loadClips failed:",H)),Vp().catch(H=>console.error("initialize: initializeAudio failed:",H))])}catch(H){console.error("initialize: Failed:",H)}be(!0),console.log("initialize: Complete, isAudioReady forced to true")},[$p,Vp]),Zp=E.useCallback(async()=>{if(console.log("startRound called, roundState:",g,"clips.length:",l.length),g!=="idle"||l.length===0)return;let H=e.current;if(H||(H=new AudioContext,e.current=H,console.log("AudioContext created during tap")),H.state==="suspended")try{await H.resume(),console.log("AudioContext resumed, state:",H.state)}catch(z){console.error("Failed to resume AudioContext:",z)}try{const z="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAYYoRwmHAAAAAAD/+1DEAAAHAAGf9AAAIgAANIAAAARMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7UMQbA8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",K=new Audio(z);K.volume=.01,await K.play(),console.log("HTML5 silent audio played to unlock iOS audio session")}catch(z){console.error("Failed to play HTML5 silent audio:",z)}console.log("AudioContext state:",H.state),be(!0);const ie=wx[t.event_density]||100,ce=localStorage.getItem("soundfield_scroll_speed"),re=ce?parseFloat(ce):.5;F.current=re,Pe(ie*re),y(0),m(0),A(0),R(0),L(0),C(0),O(0),j([]),G([]),Te(null),b(t.round_duration_sec),Li.current.clear(),cn.current=0,nu.current=0,iu.current=0,su.current=0,ou.current=0,Fi.current=0,va.current=[],Lt.current=[];let ae;console.log("startRound: allPoolSpecies.length =",h.length,"species_count =",t.species_count);const ne=sessionStorage.getItem("roundSpecies");if(ne)try{const z=JSON.parse(ne);sessionStorage.removeItem("roundSpecies");const K=z.filter(ue=>h.some(Ce=>Ce.code===ue));if(K.length>0){const ue=h.filter(Ce=>K.includes(Ce.code)).sort((Ce,Ur)=>Ce.code.localeCompare(Ur.code));console.log("Using pre-selected species:",ue.map(Ce=>Ce.code)),p(ue),ae=ue.map(Ce=>Ce.code)}}catch(z){console.error("Failed to parse pre-selected species:",z),sessionStorage.removeItem("roundSpecies")}if(!ae)if(t.species_count&&h.length>t.species_count){const z=[...h];for(let ue=z.length-1;ue>0;ue--){const Ce=Math.floor(Math.random()*(ue+1));[z[ue],z[Ce]]=[z[Ce],z[ue]]}const K=z.slice(0,t.species_count).sort((ue,Ce)=>ue.code.localeCompare(Ce.code));console.log("Random selection: setting species to",K.length,"species:",K.map(ue=>ue.code)),p(K),ae=K.map(ue=>ue.code)}else console.log("Using all pool species:",h.length),p(h),ae=h.map(z=>z.code);const pe=Yp(ae);au.current=pe,_a.current=0;const Re=[...new Set(pe.map(z=>z.clip_id))];console.log("Preloading",Re.length,"audio clips during tap gesture...");const de=Re.map(async z=>{const K=l.find(ue=>ue.clip_id===z);if(K)try{await lu(K.file_path)}catch(ue){console.error("Failed to preload clip:",z,ue)}});await Promise.all(de),console.log("Audio preloading complete"),un.current=null,Tt.current!==null&&(clearTimeout(Tt.current),Tt.current=null),hn.current={left:null,right:null},pt.current.left!==null&&clearTimeout(pt.current.left),pt.current.right!==null&&clearTimeout(pt.current.right),pt.current={left:null,right:null};const ve=performance.now();if(v("playing"),P(ve),rt.current=ve,(t.channel_mode||"single")==="single")ir();else{ir("left");const K=window.setTimeout(()=>{ir("right")},1500);Ye.current.push(K)}if(q.current=localStorage.getItem("soundfield_continuous_play")==="true",q.current)b(0),Ee.current=window.setInterval(()=>{b(z=>z+1)},1e3);else{Ee.current=window.setInterval(()=>{b(K=>K<=1?(dn(),0):K-1)},1e3);const z=window.setTimeout(()=>{dn()},t.round_duration_sec*1e3);Ye.current.push(z)}},[g,l.length,t.round_duration_sec,t.channel_mode,t.species_count,h,Yp,ir]),dn=E.useCallback(()=>{v("ended"),Ee.current&&(clearInterval(Ee.current),Ee.current=null),Tt.current!==null&&(clearTimeout(Tt.current),Tt.current=null),un.current=null,pt.current.left!==null&&clearTimeout(pt.current.left),pt.current.right!==null&&clearTimeout(pt.current.right),pt.current={left:null,right:null},hn.current={left:null,right:null};for(const re of Ye.current)clearTimeout(re);Ye.current=[];for(const re of n.current.values())try{re.stop()}catch{}for(const re of s.current.values())re.disconnect();n.current.clear(),i.current.clear(),s.current.clear(),o.current.clear();const H={};for(const re of Lt.current){const ae=re.species_code;H[ae]||(H[ae]={total:0,correct:0}),H[ae].total++,Li.current.has(re.event_id)&&H[ae].correct++}const ie=Li.current.size,ce={score:nu.current,eventsScored:ie,totalEvents:Lt.current.length,speciesCorrect:iu.current,channelCorrect:su.current,perfectCount:cn.current,missCount:ou.current,maxStreak:Fi.current,speciesResults:H,species:f.map(re=>({code:re.code,name:re.name})),mode:t.mode,packId:t.pack_id,levelId:t.level_id,levelTitle:t.title,confusionData:va.current};localStorage.setItem("soundfield_round_results",JSON.stringify(ce))},[f,t.mode,t.pack_id,t.level_id,t.title]),Jp=E.useCallback((H,ie,ce,re)=>{const ae=ie===H.species_code,ne=ce===H.channel,pe=H.scheduled_time_ms,Re=H.scoring_window_start_ms,de=pe-Re,ve=pe-re,De=Math.max(0,Math.min(1,ve/de));let z;De>=.5?z="perfect":(De>=.25,z="partial");const K=ae?yn.SPECIES_CORRECT:0,ue=ae&&ne?yn.CHANNEL_CORRECT:0;let Ce=0;ae&&ne&&(De>=.75?Ce=yn.TIMING_PERFECT:De>=.5&&(Ce=yn.TIMING_PARTIAL));const Ur=K+ue+Ce;return{speciesPoints:K,channelPoints:ue,timingPoints:Ce,totalPoints:Ur,speciesCorrect:ae,channelCorrect:ne,timingAccuracy:z}},[]),em=E.useCallback((H,ie)=>{if(g!=="playing")return;const ce=performance.now(),re=ce-rt.current,ae=t.channel_mode||"single",ne=D.find(z=>!(z.hasBeenScored||re<z.scoring_window_start_ms||re>z.scoring_window_end_ms||ae==="offset"&&z.channel!==ie));if(!ne)return;const pe=Jp(ne,H,ie,re);va.current.push({expectedSpecies:ne.species_code,guessedSpecies:H,channel:ne.channel}),pe.speciesCorrect&&Li.current.add(ne.event_id),qp(ne.event_id,ne.channel),j(z=>z.map(K=>K.event_id===ne.event_id?{...K,hasBeenScored:!0}:K)),y(z=>z+pe.totalPoints),nu.current+=pe.totalPoints,A(z=>z+1),pe.speciesCorrect&&(R(z=>z+1),iu.current+=1),pe.channelCorrect&&(L(z=>z+1),su.current+=1);const Re=yn.SPECIES_CORRECT+yn.CHANNEL_CORRECT;pe.totalPoints===Re?(C(z=>z+1),cn.current+=1,m(z=>{const K=z+1;return Fi.current=Math.max(Fi.current,K),K})):pe.totalPoints>0?m(z=>{const K=z+1;return Fi.current=Math.max(Fi.current,K),K}):m(0);let de;const ve=yn.SPECIES_CORRECT+yn.CHANNEL_CORRECT;pe.totalPoints===ve?de="perfect":pe.speciesCorrect&&pe.channelCorrect?de="good":pe.speciesCorrect?de="partial":de="miss";const De={id:`feedback_${Date.now()}`,type:de,score:pe.totalPoints,breakdown:pe,channel:ne.channel,timestamp:ce,expectedSpecies:de==="miss"?ne.species_code:void 0};Te(De),setTimeout(()=>{Te(z=>(z==null?void 0:z.id)===De.id?null:z)},de==="miss"?1500:500)},[g,D,Jp,qp,t.channel_mode]),tm=E.useCallback(()=>{dn(),v("idle"),y(0),m(0),A(0),R(0),L(0),C(0),O(0),j([]),G([]),P(0),Te(null),b(t.round_duration_sec)},[dn,t.round_duration_sec]);E.useEffect(()=>{if(g!=="playing"){a.current&&(cancelAnimationFrame(a.current),a.current=null);return}const H=()=>{var re;const ie=performance.now()-rt.current,ce=xe/F.current;for(const[ae,ne]of i.current.entries()){const pe=o.current.get(ae);if(pe===void 0)continue;const Re=pe-ie,ve=.05+Math.max(0,Math.min(1,1-Re/ce))*.95;ne.gain.setValueAtTime(ve,((re=e.current)==null?void 0:re.currentTime)||0)}a.current=requestAnimationFrame(H)};return a.current=requestAnimationFrame(H),()=>{a.current&&cancelAnimationFrame(a.current)}},[g]),E.useEffect(()=>()=>{Ee.current&&clearInterval(Ee.current),a.current&&cancelAnimationFrame(a.current);for(const H of Ye.current)clearTimeout(H);for(const H of n.current.values())try{H.stop()}catch{}},[]),E.useEffect(()=>{if(g!=="playing"||!q.current)return;const H=au.current.length,ie=_a.current;H>0&&ie>=H&&D.length===0&&(console.log("Continuous mode: all events processed, ending round"),dn())},[g,T,N,D.length,dn]);const K1={roundState:g,score:_,streak:x,timeRemaining:w,totalTime:t.round_duration_sec,eventsScored:T,speciesCorrect:S,channelCorrect:I,perfectCount:B,missCount:N,activeEvents:D,scheduledEvents:M,roundStartTime:k,scrollSpeed:oe,currentFeedback:Le,species:f,isAudioReady:Se},q1=E.useMemo(()=>({initialize:Qp,startRound:Zp,endRound:dn,submitInput:em,reset:tm}),[Qp,Zp,dn,em,tm]);return[K1,q1]}function Sx({code:t,size:e=32,color:r}){const[n,i]=E.useState(!0),s=`/data/icons/${t}.png`;return u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[n&&u.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?u.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>i(!1)}):u.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"transparent",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.35,fontWeight:700},children:t})]})}const bx=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F"],AM={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function CM(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function RM(t){return t>=4?"offset":"single"}const Ex={campaign:{mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},practice:{mode:"practice",round_duration_sec:60,species_count:3,event_density:"low",overlap_probability:0,scoring_window_ms:3e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},challenge:{mode:"challenge",round_duration_sec:60,species_count:8,event_density:"medium",overlap_probability:0,scoring_window_ms:1500,spectrogram_mode:"fading",clip_selection:"all",channel_mode:"offset"},random:{mode:"random",round_duration_sec:45,species_count:6,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"all",channel_mode:"single"}};function PM(){const t=Wt(),[e]=Cp(),r=E.useRef(null),[n,i]=E.useState({width:400,height:400}),[s,o]=E.useState(null),[a,l]=E.useState(null),[c,h]=E.useState([]),[d,f]=E.useState(!1),[p,g]=E.useState(()=>localStorage.getItem("soundfield_training_mode")==="true"),v=E.useRef(!1),_=E.useMemo(()=>localStorage.getItem("soundfield_spectrogram_mode")||"full",[]),y=E.useMemo(()=>localStorage.getItem("soundfield_high_contrast")==="true",[]);E.useEffect(()=>{localStorage.setItem("soundfield_training_mode",String(p)),p&&(v.current=!0)},[p]);const x=e.get("mode")||"campaign",m=e.get("pack")||"common_se_birds",w=parseInt(e.get("level")||"1",10);E.useEffect(()=>{console.log("Fetching levels.json..."),fetch("/data/levels.json").then(P=>P.json()).then(P=>{console.log("Loaded",P.length,"levels from levels.json"),h(P)}).catch(P=>{console.error("Failed to load levels.json:",P)})},[]);const b=E.useMemo(()=>{var F;if(console.log("levelConfig useMemo: mode =",x,"packId =",m,"campaignLevels.length =",c.length),m==="custom"){let q=[];try{const Q=sessionStorage.getItem("roundSpecies");if(Q)q=JSON.parse(Q);else{const le=localStorage.getItem("soundfield_custom_pack");le&&(q=JSON.parse(le),sessionStorage.setItem("roundSpecies",le))}}catch(Q){console.error("Failed to parse custom species:",Q)}return console.log("Custom pack: using species:",q,"for level",w),{level_id:w,pack_id:"custom",mode:"campaign",title:AM[w]||`Level ${w}`,round_duration_sec:30,species_count:q.length,species_pool:q,clip_selection:CM(w),channel_mode:RM(w),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:_}}if(x==="campaign"&&c.length>0){const q=c.find(le=>le.pack_id===m&&le.level_id===w);if(q)return console.log("Found level from levels.json:",q.pack_id,q.title,"species_pool:",(F=q.species_pool)==null?void 0:F.length),{...q,spectrogram_mode:_};const Q=c.find(le=>le.pack_id===m);return Q?(console.log("Using first level for pack:",Q.pack_id,Q.title),{...Q,spectrogram_mode:_}):(console.log("Ultimate fallback to first level"),{...c[0],spectrogram_mode:_})}console.log("Using hardcoded MODE_CONFIGS (no campaign levels loaded yet)");const P=Ex[x]||Ex.campaign;return{level_id:1,pack_id:m,...P,spectrogram_mode:_}},[x,m,w,c,_]),[T,A]=TM(b),S=E.useRef(null);E.useEffect(()=>{var q,Q;if(x==="campaign"&&c.length===0&&m!=="custom"){console.log("Waiting for levels.json to load...");return}const P=((q=b.species_pool)==null?void 0:q.length)??"none",F=`${b.pack_id}-${b.level_id}-${P}`;console.log("Init effect: key =",F,"lastKey =",S.current),S.current!==F&&(S.current=F,console.log("Initializing for",F),A.initialize(),jE(b.pack_id,b.level_id,((Q=b.species_pool)==null?void 0:Q.length)??0))},[x,c.length,b.pack_id,b.level_id,b.species_pool,A]),E.useEffect(()=>{const P=()=>{if(r.current){const F=r.current.getBoundingClientRect();i({width:F.width,height:F.height})}};return P(),window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[]);const R=E.useRef(A);R.current=A;const I=E.useRef(T.roundState);I.current=T.roundState,E.useEffect(()=>()=>{I.current==="playing"&&R.current.reset()},[]);const L=E.useMemo(()=>localStorage.getItem("soundfield_continuous_play")==="true",[]),B=T.species.map((P,F)=>({code:P.code,name:P.name,color:P.color||bx[F%bx.length]})),C=E.useCallback(P=>{o(P);const F=document.getElementById(`flash-${P}`);F&&(F.classList.add("active"),setTimeout(()=>F.classList.remove("active"),150)),a&&(A.submitInput(a,P),o(null),l(null))},[a,A]),N=E.useCallback(P=>{l(P),s&&(A.submitInput(P,s),o(null),l(null))},[s,A]);E.useEffect(()=>{const P=F=>{if(T.roundState==="playing"){if(F.key==="a"||F.key==="A"||F.key==="ArrowLeft"||F.key==="1")C("left");else if(F.key==="d"||F.key==="D"||F.key==="ArrowRight"||F.key==="2")C("right");else if(F.key>="3"&&F.key<="9"){const q=parseInt(F.key)-3;q<B.length&&N(B[q].code)}}};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[T.roundState,C,N,B]);const O=E.useCallback(()=>{A.reset(),t("/")},[t,A]),D=E.useCallback(()=>{f(!0)},[]),j=E.useCallback(()=>{A.reset(),t(-1)},[t,A]),M=E.useCallback(()=>{f(!1)},[]),G=E.useCallback(()=>{console.log("handleStart clicked, isAudioReady:",T.isAudioReady,"species.length:",T.species.length),T.isAudioReady&&T.species.length>0?(console.log("Calling startRound..."),v.current=p,A.startRound()):console.log("Not calling startRound - conditions not met")},[T.isAudioReady,T.species.length,A,p]),k=E.useCallback(()=>{A.endRound();try{const P=localStorage.getItem("soundfield_round_results");if(P){const F=JSON.parse(P);F.usedTrainingMode=v.current,localStorage.setItem("soundfield_round_results",JSON.stringify(F))}}catch(P){console.error("Failed to update results with training mode flag:",P)}t("/summary",{replace:!0})},[t,A]);return E.useEffect(()=>{if(T.roundState==="ended"){try{const P=localStorage.getItem("soundfield_round_results");if(P){const F=JSON.parse(P);F.usedTrainingMode=v.current,localStorage.setItem("soundfield_round_results",JSON.stringify(F));const q=F.correctCount&&F.totalEvents?F.correctCount/F.totalEvents*100:0,Q=F.duration??0;OE(b.pack_id,b.level_id,T.score,q,Q)}}catch(P){console.error("Failed to update results with training mode flag:",P)}t("/summary",{replace:!0})}},[T.roundState,T.score,b.pack_id,b.level_id,t]),u.jsxs("div",{className:"gameplay-screen",children:[u.jsx(yT,{score:T.score,streak:T.streak,timeRemaining:T.timeRemaining,mode:x,levelId:b.level_id,levelTitle:b.title}),u.jsx("button",{className:"back-button",onClick:O,"aria-label":"Back to menu",children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}),T.roundState==="playing"&&u.jsx("button",{className:"quit-button",onClick:D,"aria-label":"Quit round",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),u.jsx("button",{className:`training-toggle ${p?"active":""}`,onClick:()=>{const P=!p;g(P),UE(P)},"aria-label":p?"Disable training mode":"Enable training mode",title:p?"Training Mode ON - Icons visible":"Training Mode OFF",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:p?u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]}):u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),u.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]})})}),L&&T.roundState==="playing"&&u.jsx("button",{className:"end-round-button",onClick:k,"aria-label":"End round",children:"End Round"}),u.jsxs("div",{ref:r,className:"game-container",children:[u.jsx(vM,{width:n.width,height:n.height,scheduledEvents:T.scheduledEvents,activeEvents:T.activeEvents,roundStartTime:T.roundStartTime,roundState:T.roundState,scrollSpeed:T.scrollSpeed,currentFeedback:T.currentFeedback,onChannelTap:C,trainingMode:p,spectrogramMode:b.spectrogram_mode,highContrast:y}),u.jsx("div",{id:"flash-left",className:"channel-flash left"}),u.jsx("div",{id:"flash-right",className:"channel-flash right"}),s&&u.jsx("div",{className:`channel-indicator ${s}`,children:s.toUpperCase()}),T.roundState==="idle"&&u.jsx("div",{className:"start-overlay",children:u.jsx("button",{className:"start-button",onClick:G,disabled:!T.isAudioReady||T.species.length===0,children:T.isAudioReady&&T.species.length>0?"Start Round":"Loading..."})}),T.currentFeedback&&u.jsxs("div",{className:`feedback-overlay ${T.currentFeedback.type} ${T.currentFeedback.channel}`,children:[u.jsxs("div",{className:"feedback-score",children:["+",T.currentFeedback.score]}),u.jsx("div",{className:"feedback-type",children:T.currentFeedback.type.toUpperCase()}),T.currentFeedback.type==="miss"&&T.currentFeedback.expectedSpecies&&u.jsxs("div",{className:"feedback-correct",children:["Was: ",T.currentFeedback.expectedSpecies]})]})]}),u.jsxs("div",{className:"dual-input-panel",children:[u.jsxs("div",{className:"input-column left",children:[u.jsx("div",{className:"column-label",children:"LEFT EAR"}),u.jsx("div",{className:"species-buttons",children:B.map(P=>u.jsx("button",{className:`species-btn ${a===P.code?"selected":""}`,style:{backgroundColor:a===P.code?P.color:void 0},onClick:()=>{A.submitInput(P.code,"left");const F=document.getElementById("flash-left");F&&(F.classList.add("active"),setTimeout(()=>F.classList.remove("active"),150))},disabled:T.roundState!=="playing",children:u.jsx(Sx,{code:P.code,size:36,color:P.color})},P.code))})]}),u.jsxs("div",{className:"input-column right",children:[u.jsx("div",{className:"column-label",children:"RIGHT EAR"}),u.jsx("div",{className:"species-buttons",children:B.map(P=>u.jsx("button",{className:`species-btn ${a===P.code?"selected":""}`,style:{backgroundColor:a===P.code?P.color:void 0},onClick:()=>{A.submitInput(P.code,"right");const F=document.getElementById("flash-right");F&&(F.classList.add("active"),setTimeout(()=>F.classList.remove("active"),150))},disabled:T.roundState!=="playing",children:u.jsx(Sx,{code:P.code,size:36,color:P.color})},P.code))})]})]}),d&&u.jsx("div",{className:"quit-modal-overlay",children:u.jsxs("div",{className:"quit-modal",children:[u.jsx("h3",{style:{margin:0,marginBottom:"16px",fontSize:"20px"},children:"Quit Round?"}),u.jsx("p",{style:{margin:0,marginBottom:"24px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Your progress will not be saved."}),u.jsxs("div",{style:{display:"flex",gap:"12px"},children:[u.jsx("button",{className:"btn-secondary",onClick:M,style:{flex:1,padding:"12px"},children:"Cancel"}),u.jsx("button",{className:"btn-primary",onClick:j,style:{flex:1,padding:"12px",background:"var(--color-error)"},children:"Quit"})]})]})}),u.jsx("style",{children:`
        .gameplay-screen {
          display: flex;
          flex-direction: column;
          height: 100%;
          background-color: var(--color-background);
          overflow: hidden;
        }

        .back-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 8px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-text);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .back-button:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .quit-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 8px;
          width: 40px;
          height: 40px;
          background: rgba(229, 115, 115, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-error);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .quit-button:hover {
          background: rgba(229, 115, 115, 0.5);
        }

        .quit-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        .quit-modal {
          background: var(--color-surface);
          border-radius: 16px;
          padding: 24px;
          max-width: 320px;
          width: 90%;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
          animation: slideUp 0.2s ease-out;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

        .training-toggle {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 56px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: 2px solid transparent;
          border-radius: 50%;
          color: var(--color-text-muted);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: all 0.2s;
        }

        .training-toggle:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .training-toggle.active {
          background: rgba(76, 175, 80, 0.3);
          border-color: rgba(76, 175, 80, 0.6);
          color: #81C784;
        }

        .end-round-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 12px;
          padding: 8px 16px;
          background: rgba(229, 115, 115, 0.8);
          border: none;
          border-radius: 20px;
          color: white;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          z-index: 100;
          transition: background 0.2s;
        }

        .end-round-button:hover {
          background: rgba(229, 115, 115, 1);
        }

        .game-container {
          flex: 1;
          position: relative;
          min-height: 0;
          overflow: hidden;
        }

        .channel-flash {
          position: absolute;
          top: 0;
          bottom: 0;
          width: 50%;
          pointer-events: none;
          background: transparent;
          transition: background 0.1s;
        }

        .channel-flash.left {
          left: 0;
        }

        .channel-flash.right {
          right: 0;
        }

        .channel-flash.active {
          background: rgba(255, 255, 255, 0.1);
        }

        .channel-indicator {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 8px 16px;
          background: var(--color-accent);
          color: var(--color-background);
          font-weight: 700;
          font-size: 14px;
          border-radius: 4px;
          pointer-events: none;
          animation: fadeIn 0.15s ease-out;
        }

        .channel-indicator.left {
          left: 20px;
        }

        .channel-indicator.right {
          right: 20px;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-50%) scale(0.9);
          }
          to {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
        }

        .start-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(0, 0, 0, 0.7);
          z-index: 50;
        }

        .start-button {
          padding: 16px 32px;
          font-size: 18px;
          font-weight: 700;
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: transform 0.2s, background 0.2s;
        }

        .start-button:hover:not(:disabled) {
          transform: scale(1.05);
          background: var(--color-accent);
        }

        .start-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .feedback-overlay {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 12px 20px;
          border-radius: 8px;
          pointer-events: none;
          animation: feedbackPop 0.5s ease-out forwards;
          z-index: 60;
        }

        .feedback-overlay.left {
          left: 20%;
        }

        .feedback-overlay.right {
          right: 20%;
        }

        .feedback-overlay.perfect {
          background: var(--color-success);
        }

        .feedback-overlay.good {
          background: #4CAF50;
        }

        .feedback-overlay.partial {
          background: var(--color-accent);
        }

        .feedback-overlay.miss {
          background: var(--color-error);
          animation: feedbackPopMiss 1.5s ease-out forwards;
        }

        .feedback-score {
          font-family: var(--font-mono);
          font-size: 24px;
          font-weight: 700;
          color: white;
          text-align: center;
        }

        .feedback-type {
          font-size: 12px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          text-align: center;
        }

        .feedback-correct {
          font-size: 14px;
          font-weight: 700;
          color: white;
          text-align: center;
          margin-top: 4px;
          padding-top: 4px;
          border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes feedbackPop {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          20% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          40% {
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-80%) scale(1);
          }
        }

        @keyframes feedbackPopMiss {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          5% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          10% {
            transform: translateY(-50%) scale(1);
          }
          85% {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-70%) scale(1);
          }
        }

        .dual-input-panel {
          display: flex;
          justify-content: space-between;
          padding: 8px 12px;
          padding-bottom: calc(12px + var(--safe-area-bottom, 0px));
          background: linear-gradient(0deg, var(--color-surface) 0%, rgba(26, 26, 46, 0.9) 100%);
          gap: 20px;
        }

        .input-column {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }

        .input-column.left {
          align-items: flex-start;
        }

        .input-column.right {
          align-items: flex-end;
        }

        .column-label {
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          padding: 2px 8px;
          border-radius: 4px;
        }

        .input-column.left .column-label {
          color: #81C784;
          background: rgba(129, 199, 132, 0.15);
        }

        .input-column.right .column-label {
          color: #64B5F6;
          background: rgba(100, 181, 246, 0.15);
        }

        .species-buttons {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
        }

        .input-column.left .species-buttons {
          justify-content: flex-start;
        }

        .input-column.right .species-buttons {
          justify-content: flex-end;
        }

        .species-btn {
          padding: 6px;
          border-radius: 12px;
          border: 2px solid var(--color-text-muted);
          background: var(--color-surface);
          color: var(--color-text);
          font-size: 10px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.15s ease-out;
          touch-action: manipulation;
          -webkit-tap-highlight-color: transparent;
        }

        .species-btn:hover:not(:disabled) {
          transform: scale(1.1);
        }

        .species-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .species-btn.selected {
          color: var(--color-background);
          transform: scale(1.05);
        }

        .species-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }
      `})]})}const Y1=E.forwardRef(({score:t,accuracy:e,eventsScored:r,totalEvents:n,maxStreak:i,species:s,packId:o,levelId:a,levelTitle:l,topConfusion:c,usedTrainingMode:h},d)=>{const f=E.useRef(null),[p,g]=E.useState(!1),v=E.useRef(new Map),[_,y]=E.useState(!1),[x,m]=E.useState(!1),w=E.useRef(null);E.useEffect(()=>{(async()=>{const S="/",R=s.map(I=>new Promise((L,B)=>{const C=new Image;C.crossOrigin="anonymous",C.onload=()=>L({code:I.code,img:C}),C.onerror=B,C.src=`${S}data/icons/${I.code}.png`}));try{(await Promise.all(R)).forEach(({code:L,img:B})=>{v.current.set(L,B)}),g(!0)}catch(I){console.error("Failed to load bird icons:",I),g(!0)}})()},[s]),E.useEffect(()=>{(async()=>{const S="/",R=new Image;R.crossOrigin="anonymous",R.onload=()=>{w.current=R,m(!0)},R.onerror=()=>{console.error("Failed to load owl icon"),m(!0)},R.src=`${S}data/icons/OwlHeadphones.png`})()},[]),E.useEffect(()=>{if(!p||!x||!f.current)return;const A=f.current,S=A.getContext("2d");if(!S)return;const R=800,I=800,L=window.devicePixelRatio||1;A.width=R*L,A.height=I*L,A.style.width=`${R}px`,A.style.height=`${I}px`,S.scale(L,L),S.textBaseline="alphabetic";const B=S.createLinearGradient(0,0,0,I);if(B.addColorStop(0,"#f0f4f8"),B.addColorStop(1,"#d9e2ec"),S.fillStyle=B,S.fillRect(0,0,R,I),w.current){S.save(),S.globalAlpha=1;const oe=280,Pe=R-oe-20,Le=20;S.beginPath(),S.arc(Pe+oe/2,Le+oe/2,oe/2,0,Math.PI*2),S.clip(),S.drawImage(w.current,Pe,Le,oe,oe),S.restore()}S.fillStyle="#102a43",S.font="bold 48px -apple-system, system-ui, sans-serif",S.textAlign="center",S.fillText("ChipNotes! ",R/2,80),S.textAlign="left";const C=60;S.font="80px -apple-system, system-ui, sans-serif",S.fillStyle=e>=80?"#6aaa64":e>=60?"#c9b458":"#787c7e",S.fillText("",C,200),S.font="bold 110px -apple-system, system-ui, sans-serif",S.fillText(`${e}%`,C+95,200),S.font="32px -apple-system, system-ui, sans-serif",S.fillStyle="#334e68",S.fillText(`${t} points`,C,245),S.font="22px -apple-system, system-ui, sans-serif",S.fillStyle="#486581",S.fillText(`${r}/${n} birds identified`,C,280),S.textAlign="center",S.font="bold 26px -apple-system, system-ui, sans-serif",S.fillStyle="#d97706",S.fillText(` Best Streak: ${i}`,R/2,320);const O=s.slice(0,4),D=160,j=24,M=O.length*D+(O.length-1)*j,G=(R-M)/2;let k=365;O.forEach((oe,Pe)=>{const Le=G+Pe*(D+j),Te=k,Se=v.current.get(oe.code);if(Se){S.save(),S.beginPath(),S.arc(Le+D/2,Te+D/2,D/2,0,Math.PI*2),S.clip();const be=Se.width/Se.height;let Ee=D,Ye=D,rt=0,Lt=0;be>1?(Ee=D*be,rt=-(Ee-D)/2):be<1&&(Ye=D/be,Lt=-(Ye-D)/2),S.drawImage(Se,Le+rt,Te+Lt,Ee,Ye),S.restore(),S.strokeStyle="#d3d6da",S.lineWidth=3,S.beginPath(),S.arc(Le+D/2,Te+D/2,D/2,0,Math.PI*2),S.stroke(),S.font="22px -apple-system, system-ui, sans-serif",S.fillStyle="#102a43",S.fillText(oe.code,Le+D/2,Te+D+38)}});const P=k+D+100;if(o&&a){const oe=IM(o);S.font="22px -apple-system, system-ui, sans-serif",S.fillStyle="#486581",S.fillText(`${oe}  Level ${a}`,R/2,P)}const F=s.map(oe=>oe.code).join("  ");S.font="18px -apple-system, system-ui, sans-serif",S.fillStyle="#627d98";const q=700,Q=F.split(" ");let le="",xe=P+32;for(let oe=0;oe<Q.length;oe++){const Pe=le+Q[oe]+" ";S.measureText(Pe).width>q&&oe>0?(S.fillText(le.trim(),R/2,xe),le=Q[oe]+" ",xe+=25):le=Pe}if(S.fillText(le.trim(),R/2,xe),h){const oe=xe+35;S.font="18px -apple-system, system-ui, sans-serif",S.fillStyle="#d97706",S.fillText(" Still training. Ready to migrate soon.",R/2,oe)}S.font="bold 26px -apple-system, system-ui, sans-serif",S.fillStyle="#102a43",S.textAlign="center",S.fillText("chipnotes.app",R/2,I-60),S.font="20px -apple-system, system-ui, sans-serif",S.fillStyle="#486581",S.fillText("#chipnotes #birdnerd",R/2,I-30),S.getImageData(0,0,1,1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{y(!0)})})},[p,x,t,e,r,n,i,s,o,a,c,h]);const b=()=>{if(!f.current)return;const A=document.createElement("a");A.download=`chipnotes-${e}pct-${Date.now()}.png`,A.href=f.current.toDataURL("image/png"),A.click()},T=async()=>{if(!f.current||!_)throw new Error("Canvas not ready");const A=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;try{if(A){const S=f.current.toDataURL("image/png"),R=window.open();return R&&(R.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
              <title>ChipNotes Score</title>
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <style>
                body {
                  margin: 0;
                  padding: 20px;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
                  background: #1a1a1a;
                  color: white;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  min-height: 100vh;
                }
                img {
                  max-width: 100%;
                  height: auto;
                  border-radius: 12px;
                  box-shadow: 0 10px 40px rgba(0,0,0,0.5);
                }
                .instructions {
                  margin-top: 20px;
                  padding: 16px;
                  background: rgba(255,255,255,0.1);
                  border-radius: 8px;
                  text-align: center;
                  max-width: 90%;
                }
                .instructions h2 {
                  margin: 0 0 12px 0;
                  font-size: 20px;
                }
                .instructions p {
                  margin: 8px 0;
                  font-size: 16px;
                  opacity: 0.9;
                }
                .highlight {
                  color: #d97706;
                  font-weight: 600;
                }
                .close-btn {
                  position: fixed;
                  top: 20px;
                  left: 20px;
                  width: 48px;
                  height: 48px;
                  border-radius: 50%;
                  background: rgba(255,255,255,0.9);
                  border: 2px solid rgba(0,0,0,0.1);
                  color: #1a1a1a;
                  font-size: 28px;
                  font-weight: bold;
                  cursor: pointer;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  transition: all 0.3s;
                  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                  z-index: 1000;
                }
                .close-btn:hover {
                  background: white;
                  transform: scale(1.1);
                  box-shadow: 0 6px 16px rgba(0,0,0,0.4);
                }
              </style>
            </head>
            <body>
              <button class="close-btn" onclick="window.close(); setTimeout(function() { window.history.back(); }, 100);"></button>
              <img src="${S}" alt="ChipNotes Score">
              <div class="instructions">
                <p><span class="highlight">Press and hold to share or save</span></p>
              </div>
            </body>
            </html>
          `),R.document.close()),"ios-instructions"}else{const S=await new Promise((I,L)=>{f.current.toBlob(B=>{B?I(B):L(new Error("toBlob failed"))},"image/png",1)}),R=new File([S],"chipnotes-score.png",{type:"image/png"});return navigator.share&&navigator.canShare&&navigator.canShare({files:[R]})?(await navigator.share({title:"ChipNotes! Score",text:`Just identified ${r}/${n} birds with ${e}% accuracy! `,files:[R]}),"shared"):(b(),"downloaded")}}catch(S){return console.error("Share failed:",S),b(),"error-downloaded"}};return E.useImperativeHandle(d,()=>({share:T,download:b,isReady:()=>_}),[_]),u.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px"},children:u.jsx("canvas",{ref:f})})});Y1.displayName="ShareCard";function IM(t){return{starter_birds:"Common Backyard",expanded_backyard:"Expanded Backyard",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard"}[t]||t}const Tx=6;function kM(){const t=Wt(),e=E.useRef(null),[r,n]=E.useState(null),[i,s]=E.useState([]),[o,a]=E.useState([]),[l,c]=E.useState(!1),[h,d]=E.useState(!1),[f,p]=E.useState(!1),[g,v]=E.useState(null);E.useEffect(()=>{var B;const L=localStorage.getItem("soundfield_round_results");if(L)try{const C=JSON.parse(L);if(n(C),C.mode==="campaign"&&C.levelId){const O="soundfield_progress",D=JSON.parse(localStorage.getItem(O)||"{}"),j=`level_${C.levelId}`,M=((B=D[j])==null?void 0:B.bestScore)||0;D[j]={completed:!0,bestScore:Math.max(M,C.score),accuracy:C.totalEvents>0?Math.round(C.eventsScored/C.totalEvents*100):0},localStorage.setItem(O,JSON.stringify(D))}const N=[];for(const O of C.species){const D=C.speciesResults[O.code]||{total:0,correct:0};D.total>0&&N.push({code:O.code,name:O.name,total:D.total,correct:D.correct,accuracy:Math.round(D.correct/D.total*100)})}if(N.sort((O,D)=>O.accuracy-D.accuracy),s(N),C.confusionData&&C.confusionData.length>0){const O=new Map;for(const j of C.confusionData){if(j.guessedSpecies===j.expectedSpecies)continue;const M=`${j.expectedSpecies}|${j.guessedSpecies??"MISS"}`;O.set(M,(O.get(M)||0)+1)}const D=[];for(const[j,M]of O.entries()){const[G,k]=j.split("|");D.push({expectedSpecies:G,guessedSpecies:k==="MISS"?null:k,count:M})}D.sort((j,M)=>M.count-j.count),a(D)}}catch(C){console.error("Failed to parse round results:",C)}},[]);const _=r&&r.totalEvents>0?Math.round(r.eventsScored/r.totalEvents*100):0,y=(r==null?void 0:r.mode)==="campaign",x=(r==null?void 0:r.levelId)||1,m=(r==null?void 0:r.packId)||"starter_birds",w=x>1,b=x<Tx,T=L=>{if(r!=null&&r.species){const B=r.species.map(C=>C.code);sessionStorage.setItem("roundSpecies",JSON.stringify(B))}t(`/preview?pack=${m}&level=${L}&keepBirds=true`)},A=()=>{t(`/level-select?pack=${m}`)},S=()=>{t("/pack-select")},R=()=>{t("/")};E.useEffect(()=>{const L=setInterval(()=>{var B;(B=e.current)!=null&&B.isReady()&&(p(!0),clearInterval(L))},100);return()=>clearInterval(L)},[r]);const I=async()=>{if(e.current){d(!0),v(null);try{await e.current.share()==="ios-instructions"&&(v("Follow instructions in new tab to save & share! "),setTimeout(()=>v(null),5e3))}catch(L){console.error("Share failed:",L),v("Share failed. Please try again."),setTimeout(()=>v(null),3e3)}finally{d(!1)}}};return u.jsxs("div",{className:"screen",style:{paddingTop:"32px",paddingBottom:"calc(24px + var(--safe-area-bottom, 0px))"},children:[u.jsx("h1",{style:{textAlign:"center",marginBottom:"8px"},children:"ROUND COMPLETE"}),y&&u.jsxs("p",{className:"text-muted",style:{textAlign:"center",marginBottom:"16px"},children:["Level ",x,": ",(r==null?void 0:r.levelTitle)||"Campaign"]}),u.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto 16px"},children:[u.jsxs("button",{className:"btn-primary",onClick:I,disabled:h||!r||!f,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[u.jsx(NM,{}),h?"Generating...":f?"Share Your Score":"Preparing..."]}),u.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",textAlign:"center",marginTop:"8px",marginBottom:"0",fontStyle:"italic"},children:"Let them Wordle, you already know how to spell."}),g&&u.jsx("p",{style:{fontSize:"14px",color:"var(--color-accent)",textAlign:"center",marginTop:"8px",marginBottom:"0",fontWeight:600,animation:"fadeIn 0.3s ease"},children:g})]}),r&&u.jsx(Y1,{ref:e,score:r.score,accuracy:_,eventsScored:r.eventsScored,totalEvents:r.totalEvents,maxStreak:r.maxStreak,species:r.species,packId:r.packId,levelId:r.levelId,levelTitle:r.levelTitle,usedTrainingMode:r.usedTrainingMode,topConfusion:o.length>0&&o[0].guessedSpecies?{from:o[0].expectedSpecies,to:o[0].guessedSpecies}:null}),u.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[u.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[u.jsx("span",{children:"Score"}),u.jsx("span",{className:"text-accent",style:{fontFamily:"var(--font-mono)",fontSize:"24px"},children:(r==null?void 0:r.score)||0})]}),u.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[u.jsx("span",{children:"Birds Identified"}),u.jsxs("span",{children:[(r==null?void 0:r.eventsScored)||0," / ",(r==null?void 0:r.totalEvents)||0]})]}),u.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[u.jsx("span",{children:"Overall Accuracy"}),u.jsxs("span",{className:_>=70?"text-success":_>=50?"text-accent":"text-error",children:[_,"%"]})]}),u.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[u.jsx("span",{children:"Perfect Hits"}),u.jsx("span",{className:"text-success",children:(r==null?void 0:r.perfectCount)||0})]}),u.jsxs("div",{className:"flex-row justify-between",children:[u.jsx("span",{children:"Best Streak"}),u.jsx("span",{children:(r==null?void 0:r.maxStreak)||0})]}),(r==null?void 0:r.usedTrainingMode)&&u.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid var(--color-surface)",fontSize:"13px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"6px"},children:[u.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"Training Mode was used"]})]}),i.length>0&&u.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Species Breakdown"}),i.map(L=>u.jsxs("div",{style:{marginBottom:"12px"},children:[u.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[u.jsxs("span",{style:{fontSize:"14px"},children:[L.code," ",u.jsxs("span",{className:"text-muted",children:["(",L.name,")"]})]}),u.jsxs("span",{style:{fontSize:"14px"},children:[L.correct,"/",L.total," (",L.accuracy,"%)"]})]}),u.jsx("div",{style:{height:"8px",backgroundColor:"var(--color-background)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${L.accuracy}%`,height:"100%",backgroundColor:L.accuracy>=80?"var(--color-success)":L.accuracy>=50?"var(--color-accent)":"var(--color-error)",borderRadius:"4px",transition:"width 0.3s ease"}})})]},L.code))]}),o.length>0&&u.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Confusion Summary"}),o.map((L,B)=>u.jsx("div",{style:{marginBottom:"8px",fontSize:"14px"},children:L.guessedSpecies===null?u.jsxs("span",{children:["Missed ",u.jsx("span",{className:"text-accent",children:L.expectedSpecies}),": ",L.count,"x"]}):u.jsxs("span",{children:[u.jsx("span",{className:"text-accent",children:L.expectedSpecies}),"  ",u.jsx("span",{className:"text-error",children:L.guessedSpecies}),": ",L.count,"x"]})},B))]}),u.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto"},children:[y&&u.jsxs("div",{className:"flex-row gap-md",style:{marginBottom:"12px"},children:[u.jsxs("button",{className:"btn-secondary",onClick:()=>T(x-1),disabled:!w,style:{flex:1,opacity:w?1:.4},children:[u.jsx(MM,{})," Prev"]}),u.jsxs("button",{className:"btn-secondary",onClick:()=>c(!l),style:{flex:1},children:["Level ",x,"/",Tx]}),u.jsxs("button",{className:"btn-secondary",onClick:()=>T(x+1),disabled:!b,style:{flex:1,opacity:b?1:.4},children:["Next ",u.jsx(BM,{})]})]}),l&&u.jsxs("div",{className:"card",style:{marginBottom:"12px",padding:"12px"},children:[u.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginBottom:"8px"},children:"Jump to level:"}),u.jsx("div",{className:"flex-row",style:{flexWrap:"wrap",gap:"8px"},children:[1,2,3,4,5,6].map(L=>u.jsx("button",{onClick:()=>{c(!1),T(L)},style:{width:"40px",height:"40px",borderRadius:"8px",border:L===x?"2px solid var(--color-accent)":"1px solid var(--color-text-muted)",background:L===x?"var(--color-accent)":"var(--color-surface)",color:L===x?"var(--color-background)":"var(--color-text)",fontWeight:600,cursor:"pointer"},children:L},L))})]}),u.jsxs("div",{className:"flex-col gap-md",children:[u.jsx("button",{className:"btn-primary",onClick:()=>T(x),style:{width:"100%"},children:"Play Again"}),u.jsxs("div",{className:"flex-row gap-md",children:[u.jsx("button",{className:"btn-secondary",onClick:A,style:{flex:1},children:"Levels"}),u.jsx("button",{className:"btn-secondary",onClick:S,style:{flex:1},children:"Packs"}),u.jsx("button",{className:"btn-secondary",onClick:R,style:{flex:1},children:"Home"})]})]})]})]})}function MM(){return u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"4px"},children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}function BM(){return u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"4px"},children:u.jsx("path",{d:"M9 18l6-6-6-6"})})}function NM(){return u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"18",cy:"5",r:"3"}),u.jsx("circle",{cx:"6",cy:"12",r:"3"}),u.jsx("circle",{cx:"18",cy:"19",r:"3"}),u.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),u.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]})}const Sr={SCROLL_SPEED:"soundfield_scroll_speed",SPECTROGRAM_MODE:"soundfield_spectrogram_mode",HIGH_CONTRAST:"soundfield_high_contrast",CONTINUOUS_PLAY:"soundfield_continuous_play",COOKIE_CONSENT:"chipnotes_cookie_consent"};function LM(){const t=Wt(),[e,r]=E.useState(()=>localStorage.getItem(Sr.SPECTROGRAM_MODE)||"full"),[n,i]=E.useState(()=>{const p=localStorage.getItem(Sr.SCROLL_SPEED);return p?parseFloat(p):.5}),[s,o]=E.useState(()=>localStorage.getItem(Sr.HIGH_CONTRAST)==="true"),[a,l]=E.useState(()=>localStorage.getItem(Sr.CONTINUOUS_PLAY)==="true"),[c,h]=E.useState(()=>localStorage.getItem(Sr.COOKIE_CONSENT)==="accepted");E.useEffect(()=>{localStorage.setItem(Sr.SPECTROGRAM_MODE,e)},[e]),E.useEffect(()=>{localStorage.setItem(Sr.SCROLL_SPEED,n.toString())},[n]),E.useEffect(()=>{localStorage.setItem(Sr.HIGH_CONTRAST,s.toString())},[s]),E.useEffect(()=>{localStorage.setItem(Sr.CONTINUOUS_PLAY,a.toString())},[a]);const d=p=>{h(p),localStorage.setItem(Sr.COOKIE_CONSENT,p?"accepted":"declined"),alert(p?"Analytics enabled. Please refresh the page for changes to take effect.":"Analytics disabled. Please refresh the page for changes to take effect.")},f=()=>{confirm("This will delete ALL your progress, settings, and custom packs. This cannot be undone. Are you sure?")&&(localStorage.clear(),"caches"in window&&caches.keys().then(g=>{g.forEach(v=>{caches.delete(v)})}),alert("All data has been deleted. The app will now reload."),window.location.href=window.location.origin+"/")};return u.jsxs("div",{className:"screen",children:[u.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[u.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:u.jsx(FM,{})}),u.jsx("h2",{style:{margin:0},children:"Settings"})]}),u.jsxs("div",{className:"flex-col gap-lg",children:[u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Spectrogram Mode"}),u.jsx("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:"Visual difficulty setting"}),u.jsx("div",{className:"flex-row gap-sm",children:["full","fading","none"].map(p=>u.jsx("button",{className:e===p?"btn-primary":"btn-secondary",onClick:()=>r(p),style:{flex:1,textTransform:"capitalize"},children:p},p))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Scroll Speed"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:["How fast tiles move: ",n.toFixed(1),"x"]}),u.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:n,onChange:p=>i(parseFloat(p.target.value)),style:{width:"100%"}})]}),u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex-row justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h3",{style:{marginBottom:"4px"},children:"High Contrast"}),u.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Enhanced visibility"})]}),u.jsx("button",{className:s?"btn-primary":"btn-secondary",onClick:()=>o(!s),style:{width:"60px"},children:s?"ON":"OFF"})]})}),u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex-row justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h3",{style:{marginBottom:"4px"},children:"Continuous Play"}),u.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"No timer - play until all clips done"})]}),u.jsx("button",{className:a?"btn-primary":"btn-secondary",onClick:()=>l(!a),style:{width:"60px"},children:a?"ON":"OFF"})]})}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"flex-row justify-between items-center",style:{marginBottom:"8px"},children:[u.jsx("div",{children:u.jsx("h3",{style:{marginBottom:"0"},children:"Analytics"})}),u.jsx("button",{className:c?"btn-primary":"btn-secondary",onClick:()=>d(!c),style:{width:"60px"},children:c?"ON":"OFF"})]}),u.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"I know I'm a stranger, but please accept my cookies! Analytics help me understand how many players I have, which birds everyone loves, and what features are most useful. I promise I'm just adding bird nerds to my LIFE LIST, not stalking you. Your IP is anonymized, no personal data collected, full GDPR/CCPA compliance."})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"8px"},children:"Privacy Policy"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["Learn about how your privacy is protected, what data is collected, and your rights."," ",u.jsx("button",{onClick:()=>t("/privacy"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Privacy Policy "})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"8px"},children:"How to Play"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["New to ChipNotes? Learn about gameplay, scoring, packs, and tips."," ",u.jsx("button",{onClick:()=>t("/help"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Help Guide "})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"8px"},children:"Feedback & Bug Reports"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["Found a bug? Have a feature idea? Email me at"," ",u.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]}),u.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:[u.jsx("span",{style:{color:"var(--color-text)"},children:"Have a bird sound on your phone that you think should be in the game?"})," Send it to me! I'll add it and give you credit in the app."]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"8px"},children:"Support This Project"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["ChipNotes is free and ad-free. If it's helped you ID more birds,"," ",u.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"buy me a coffee"})," ","to support development. Every donation helps add new species and features! "]})]}),u.jsx("div",{className:"card",children:u.jsx("button",{className:"btn-secondary",onClick:f,style:{width:"100%",color:"var(--color-error)"},children:"Reset All Progress"})})]})]})}function FM(){return u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}const ll=[{code:"NOCA",name:"Northern Cardinal",accuracy:92,attempts:45},{code:"BLJA",name:"Blue Jay",accuracy:88,attempts:38},{code:"CARW",name:"Carolina Wren",accuracy:76,attempts:29},{code:"AMCR",name:"American Crow",accuracy:95,attempts:22},{code:"TUTI",name:"Tufted Titmouse",accuracy:71,attempts:18}];function DM(){const t=Wt(),e=Math.round(ll.reduce((r,n)=>r+n.accuracy,0)/ll.length);return u.jsxs("div",{className:"screen",children:[u.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[u.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:u.jsx(jM,{})}),u.jsx("h2",{style:{margin:0},children:"Progress"})]}),u.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"linear-gradient(135deg, rgba(245, 166, 35, 0.15) 0%, rgba(245, 166, 35, 0.05) 100%)",border:"2px solid var(--color-accent)",borderRadius:"12px",textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"16px",fontWeight:700,color:"var(--color-accent)",marginBottom:"4px"},children:" Coming Soon! "}),u.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.4},children:"Real stats tracking is in development. The data below is a preview of what's coming!"})]}),u.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[u.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Demo Data"}),u.jsxs("div",{className:"flex-row justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Overall Accuracy"}),u.jsxs("div",{style:{fontSize:"32px",fontWeight:700},className:"text-success",children:[e,"%"]})]}),u.jsxs("div",{style:{textAlign:"right"},children:[u.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Total Attempts"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:600},children:ll.reduce((r,n)=>r+n.attempts,0)})]})]})]}),u.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[u.jsx("h3",{style:{margin:0},children:"This Session"}),u.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),u.jsxs("div",{className:"flex-row justify-between",style:{marginTop:"12px"},children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Rounds"}),u.jsx("div",{style:{fontSize:"20px"},children:"5"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Score"}),u.jsx("div",{style:{fontSize:"20px"},className:"text-accent",children:"12,450"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Best Streak"}),u.jsx("div",{style:{fontSize:"20px"},children:"18"})]})]})]}),u.jsxs("div",{className:"card",style:{opacity:.7},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[u.jsx("h3",{style:{margin:0},children:"Species Accuracy"}),u.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),ll.map(r=>u.jsxs("div",{style:{marginBottom:"12px"},children:[u.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[u.jsxs("span",{style:{fontSize:"14px"},children:[r.code," ",u.jsxs("span",{className:"text-muted",children:["(",r.attempts,")"]})]}),u.jsxs("span",{style:{fontSize:"14px"},className:r.accuracy>=80?"text-success":r.accuracy>=60?"text-accent":"text-error",children:[r.accuracy,"%"]})]}),u.jsx("div",{style:{height:"6px",backgroundColor:"var(--color-background)",borderRadius:"3px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${r.accuracy}%`,height:"100%",backgroundColor:r.accuracy>=80?"var(--color-success)":r.accuracy>=60?"var(--color-accent)":"var(--color-error)",borderRadius:"3px"}})})]},r.code))]}),u.jsx("div",{className:"card",style:{marginTop:"24px",opacity:.7},children:u.jsx("button",{className:"btn-secondary",style:{width:"100%",cursor:"not-allowed"},disabled:!0,children:"View Confusion Matrix (Coming Soon)"})})]})}function jM(){return u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}function OM(){var p;const t=Wt(),e=$s(),r=["Why Learn Bird Song?","The Basics","Scoring"];(p=e.state)!=null&&p.openVersionHistory&&r.push("Version History");const[n,i]=E.useState(new Set(r)),[s,o]=E.useState(!1),a=E.useRef(null),l=E.useRef(null),c=["Why Learn Bird Song?","The Basics","Scoring","The Packs","The Levels","Tips","Training Mode","The 4-Letter Codes","The Spectrograms","About & Credits","Support This Project","Feedback & Bug Reports","Version History"],h=g=>{const v=new Set(n);v.has(g)?v.delete(g):v.add(g),i(v)},d=()=>{n.size===c.length?i(new Set):i(new Set(c))},f=n.size===c.length;return E.useEffect(()=>{const g=()=>{!s&&a.current&&a.current.scrollTop>0&&o(!0)},v=a.current;if(v)return v.addEventListener("scroll",g),()=>v.removeEventListener("scroll",g)},[s]),E.useEffect(()=>{var g;(g=e.state)!=null&&g.openVersionHistory&&l.current&&setTimeout(()=>{var v;(v=l.current)==null||v.scrollIntoView({behavior:"smooth",block:"start"})},100)},[e.state]),u.jsxs("div",{ref:a,className:"screen",style:{paddingBottom:"32px",position:"relative"},children:[u.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[u.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:u.jsx(Ax,{})}),u.jsx("h2",{style:{margin:0},children:"How to Play"})]}),u.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[u.jsxs(Ft,{title:"Why Learn Bird Song?",isExpanded:n.has("Why Learn Bird Song?"),onToggle:()=>h("Why Learn Bird Song?"),children:[u.jsxs("p",{style:{marginBottom:"12px"},children:["Birds are ",u.jsx("em",{children:"heard"})," way more often than they're ",u.jsx("em",{children:"seen"}),". Once you know the songs, you'll know what to look for - and suddenly your backyard becomes way more interesting."]}),u.jsxs("p",{style:{marginBottom:"12px"},children:[u.jsx("strong",{children:"Why the left/right thing?"}),` It feels like a hearing test because that's birding! In the field, you're constantly triangulating: "Cardinal to my left, chickadee to my right, warbler... somewhere up there?" This game mimics that chaos. Plus, training your ears to separate simultaneous sounds - like a pianist controlling both hands independently - dramatically sharpens your birding skills.`]}),u.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsx("strong",{children:"Need real-time ID?"})," Get Cornell's free ",u.jsx("a",{href:"https://merlin.allaboutbirds.org/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"Merlin app"}),` - it's magic for "what bird is that singing `,u.jsx("em",{children:"right now"}),'?"']})]}),u.jsxs(Ft,{title:"The Basics",isExpanded:n.has("The Basics"),onToggle:()=>h("The Basics"),children:[u.jsx("p",{style:{marginBottom:"12px"},children:u.jsx("strong",{children:"Listen. Identify. Tap."})}),u.jsx("p",{style:{marginBottom:"12px"},children:"Bird sounds play through your left or right ear. Identify which bird is singing and tap its circle on the correct side before the tile passes the scoring zone."}),u.jsx("p",{style:{marginBottom:"12px"},children:"Each round is 30 seconds. Use headphones for the best experience - unless you want everyone to know you're a bird nerd!"}),u.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsx("strong",{children:"Mobile tip:"}),' For fullscreen play on iOS, use Safari. On Android Chrome, tap   "Add to Home screen" and launch from the icon.']})]}),u.jsxs(Ft,{title:"Scoring",isExpanded:n.has("Scoring"),onToggle:()=>h("Scoring"),children:[u.jsx(cl,{label:"Perfect",points:100,description:"Right bird + right ear + great timing",color:"var(--color-success)"}),u.jsx(cl,{label:"Good",points:75,description:"Right bird + right ear",color:"var(--color-success)"}),u.jsx(cl,{label:"Partial",points:25,description:"Right bird, wrong ear",color:"var(--color-accent)"}),u.jsx(cl,{label:"Miss",points:0,description:"Wrong bird or no response",color:"var(--color-error)"})]}),u.jsxs(Ft,{title:"The Packs",isExpanded:n.has("The Packs"),onToggle:()=>h("The Packs"),children:[u.jsx(Wi,{name:"Common Eastern US Backyard Birds",description:"Perfect for beginners. Five distinctive birds you'll hear in your own backyard: Cardinal, Carolina Wren, Titmouse, Blue Jay, and Crow."}),u.jsx(Wi,{name:"Expanded Eastern US Birds",description:"39 species from the eastern US. Nine birds are selected randomly, and you can shuffle for a new set anytime from the preview screen."}),u.jsx(Wi,{name:"Sparrows",description:"Master the subtle singers! Eight sparrow species with distinctive patterns: White-throated, Song, Chipping, Swamp, Savannah, Field, Lincoln's, and White-crowned."}),u.jsx(Wi,{name:"Woodpeckers",description:"Drums, rattles, and calls. Learn seven species: Downy, Hairy, Red-bellied, Pileated, Yellow-bellied Sapsucker, Northern Flicker, and Red-headed."}),u.jsx(Wi,{name:"Western Backyard Birds",description:"14 common backyard species from western North America: Steller's Jay, Western Scrub-Jay, Black-capped Chickadee, White-crowned Sparrow, Cassin's Finch, Pine Siskin, Evening Grosbeak, and more."}),u.jsx(Wi,{name:"Warbler Academy",description:"For experts! 33 wood-warbler species with their high-pitched, buzzy songs. Nine warblers are selected randomly - shuffle for a new set anytime."})]}),u.jsxs(Ft,{title:"The Levels",isExpanded:n.has("The Levels"),onToggle:()=>h("The Levels"),children:[u.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Each pack has 6 levels that build your skills:"}),u.jsx(Xi,{level:1,title:"Meet the Birds",description:"One clear recording per bird, single ear. Learn each signature voice."}),u.jsx(Xi,{level:2,title:"Sound Variations",description:"Up to 3 recordings per bird. Same species, different songs."}),u.jsx(Xi,{level:3,title:"Full Repertoire",description:"All recordings in play. Master every variation."}),u.jsx(Xi,{level:4,title:"Both Ears",description:"Sounds from either side. Identify the bird AND the direction."}),u.jsx(Xi,{level:5,title:"Variations + Both Ears",description:"Multiple recordings, either ear. Getting challenging!"}),u.jsx(Xi,{level:6,title:"Master Birder",description:"Everything at once. You're a pro now."})]}),u.jsxs(Ft,{title:"Tips",isExpanded:n.has("Tips"),onToggle:()=>h("Tips"),children:[u.jsx(Yi,{children:"Start with the 5 common birds, even if you're eager for more."}),u.jsx(Yi,{children:"Use Bird Reference on the Pack Select screen to preview all sounds included in the game."}),u.jsx(Yi,{children:"Your birds stay the same between rounds. Hit the shuffle button on the preview screen for a fresh set."}),u.jsx(Yi,{children:"Don't rush. Let the sound register before you tap."}),u.jsx(Yi,{children:"Check the round summary and confusion matrix to see which birds need practice."}),u.jsx(Yi,{children:"Adjust tile speed in Settings if things move too fast (or too slow). Once you're an expert, try playing muted using only spectrograms!"})]}),u.jsxs(Ft,{title:"Training Mode",isExpanded:n.has("Training Mode"),onToggle:()=>h("Training Mode"),children:[u.jsxs("p",{children:["Toggle the ",u.jsx("strong",{children:"eye icon"})," (next to the back button) during gameplay to enable Training Mode."]}),u.jsx("p",{children:"When active, each tile shows its bird icon and species code alongside the spectrogram. Use this to learn which spectrograms belong to which birds, then toggle off to challenge yourself!"}),u.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[u.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(76, 175, 80, 0.3)",border:"2px solid rgba(76, 175, 80, 0.6)",borderRadius:"50%",color:"#81C784"},children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),u.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Eye icon glows green when Training Mode is ON"})]})]}),u.jsxs(Ft,{title:"The 4-Letter Codes",isExpanded:n.has("The 4-Letter Codes"),onToggle:()=>h("The 4-Letter Codes"),children:[u.jsx("p",{children:`Birders use standardized 4-letter codes (called "Alpha codes") as shorthand for species names. They're easy to learn:`}),u.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"8px",fontSize:"14px",lineHeight:1.6},children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Two-word names:"})," First 2 letters of each word"]}),u.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Northern Cardinal  NO + CA  NOCA"}),u.jsxs("div",{style:{marginTop:"8px"},children:[u.jsx("strong",{children:"Three-word names:"})," 1 + 1 + 2 letters"]}),u.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Red-bellied Woodpecker  R + B + WO  RBWO"})]})]}),u.jsxs(Ft,{title:"The Spectrograms",isExpanded:n.has("The Spectrograms"),onToggle:()=>h("The Spectrograms"),children:[u.jsx("p",{children:"The colorful images on tiles are spectrograms - visual pictures of sound. Time flows left to right, pitch goes bottom to top, and brightness shows volume."}),u.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"14px"},children:"With practice, you'll recognize birds by their visual patterns too!"})]}),u.jsxs(Ft,{title:"About & Credits",isExpanded:n.has("About & Credits"),onToggle:()=>h("About & Credits"),children:[u.jsxs("div",{style:{textAlign:"center",marginBottom:"16px"},children:[u.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"   "}),u.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:"Created by Peter Repetti"}),u.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:"Made with love by bird nerds, for bird nerds"})]}),u.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:[u.jsxs("p",{style:{marginBottom:"12px"},children:[u.jsx("strong",{style:{color:"var(--color-accent)"},children:"Bird sounds:"})," Sourced from"," ",u.jsx("a",{href:"https://xeno-canto.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Xeno-Canto"}),", the"," ",u.jsx("a",{href:"https://www.macaulaylibrary.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Cornell Macaulay Library"})," ","and from user contributions. All sound clips have attribution in the Bird Reference."]}),u.jsxs("p",{style:{marginBottom:"12px"},children:[u.jsx("strong",{style:{color:"var(--color-accent)"},children:"The Tech:"})," Built by Claude Code with TypeScript, React, and PixiJS for buttery-smooth scrolling spectrograms. The Web Audio API handles sample-accurate playback with real-time stereo panning - your browser decodes and buffers audio into memory for zero-latency triggering. Vite bundles it all into a PWA (Progressive Web App) that caches sounds as you play them - so load up those birds before your flight to New Zealand takes off ."]}),u.jsxs("p",{style:{marginBottom:"12px"},children:[u.jsx("strong",{style:{color:"var(--color-accent)"},children:"Special thanks:"})," To the global birding community for sharing these recordings."]}),u.jsx("p",{style:{marginTop:"16px",fontSize:"13px",fontStyle:"italic"},children:"Good birding! "})]})]}),u.jsxs(Ft,{title:"Support This Project",isExpanded:n.has("Support This Project"),onToggle:()=>h("Support This Project"),children:[u.jsxs("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:["ChipNotes is free, ad-free, and built as a passion project. If it's helped you level up your birding skills, consider"," ",u.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"supporting development"})," ","- your donations help me add new species packs, build new features, keep my coffee fund stocked - and allow me to go birding. Now, you go build something cool - it might be easier than you think! ;)"]}),u.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"8px",fontWeight:600},children:"Please also consider supporting the organizations that make this possible:"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"var(--color-text-muted)",lineHeight:1.8},children:[u.jsxs("li",{children:[u.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Cornell Macaulay Library"})," ","- Incredible bird sound archive"]}),u.jsxs("li",{children:[u.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Xeno-Canto"})," ","- Community-driven bird recording database"]})]}),u.jsx("p",{style:{marginTop:"16px",fontSize:"14px",fontStyle:"italic",color:"var(--color-text-muted)"},children:"Thank you for learning with me! "})]}),u.jsxs(Ft,{title:"Feedback & Bug Reports",isExpanded:n.has("Feedback & Bug Reports"),onToggle:()=>h("Feedback & Bug Reports"),children:[u.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:"I'd love to hear from you! Found a bug? Have a feature suggestion? Want to share your experience?"}),u.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px",marginBottom:"12px"},children:[u.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" Email"}),u.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"feedback@chipnotes.app"})]}),u.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px"},children:[u.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" GitHub Issues"}),u.jsx("a",{href:"https://github.com/chrysogonum/bird-sound-game/issues",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"github.com/chrysogonum/bird-sound-game/issues"})]})]}),u.jsx("div",{ref:l,children:u.jsxs(Ft,{title:"Version History",isExpanded:n.has("Version History"),onToggle:()=>h("Version History"),children:[u.jsx(nt,{version:"3.26",date:"January 18, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"PWA Home Screen Fix:"})," Fixed 404 error when adding ChipNotes to iPhone home screen - start_url now correctly points to root path"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Manifest Update:"}),' Updated PWA description to match new tagline "Train your ear. Know the birds."']})]})}),u.jsx(nt,{version:"3.25",date:"January 18, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Home Screen Refresh:"}),' New tagline "Train your ear. Know the birds." emphasizes the educational journey and real-world birding payoff']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Enhanced Visual Flow:"}),' Added 3-step "Hear  Match  Train" diagram with brain icon to clearly show the learning process']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Cleaner Layout:"})," Redesigned home screen with tighter spacing and more intuitive visual hierarchy"]})]})}),u.jsx(nt,{version:"3.24",date:"January 18, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Share Card Polish:"})," Refined share card design with circular bird icons and owl mascot, cleaner font hierarchy (removed monospace, reduced bold usage), and improved spacing for better visual balance"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Icon Improvements:"})," Bird icons and owl now display as perfect circles with proper aspect ratio scaling - no more white backgrounds or distortion"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Layout Refinement:"})," Moved Best Streak above bird icons, tightened spacing between pack/level and bird codes, centered text better in available space"]})]})}),u.jsx(nt,{version:"3.23",date:"January 17, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Share Score Card:"})," New shareable score card feature - download or share your round results with fun bird icons, stats, and confusion matrix highlights"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Custom Domain:"})," ChipNotes now available at ",u.jsx("a",{href:"https://chipnotes.app",style:{color:"var(--color-accent)"},children:"chipnotes.app"})," - easier to remember and share!"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Training Mode indicator:"})," Share cards now show when Training Mode was used during the round"]})]})}),u.jsx(nt,{version:"3.22",date:"January 17, 2026",children:u.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:u.jsxs("li",{children:[u.jsx("strong",{children:"Version chronology fix:"})," Moved v3.02 and v3.03 to correct position in version history (after v3.13, before v2.0) - no more time-traveling versions!"]})})}),u.jsx(nt,{version:"3.21",date:"January 17, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"All Birds pack race condition fix:"})," Fixed state management bug where pack JSON loading overwrote the All Birds pack, causing it to disappear - now merges state correctly to preserve all packs"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Clickable version number:"})," Main menu version now links to Version History - auto-expands and scrolls to changelog"]})]})}),u.jsx(nt,{version:"3.20",date:"January 17, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Service worker cache fix:"}),' Fixed "Twilight Zone" bug where All Birds pack appeared on first load but disappeared after refresh - hashed JS bundles no longer cached, ensuring fresh code always loads']}),u.jsxs("li",{children:[u.jsx("strong",{children:"PWA stability:"})," Installed PWAs now properly update to show latest changes without requiring reinstall"]})]})}),u.jsx(nt,{version:"3.19",date:"January 17, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Version numbering fix:"})," Renamed v3.4 to v3.19 to maintain sequential ordering - fixes Apple-style confusion where 3.4 appeared after 3.18"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Help page UX:"})," Collapsible sections with floating Expand All button - less scrolling, more scanning"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"All Birds reference:"})," Fixed missing bird icons in Bird Reference pack"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Navigation improvements:"})," Added Back button at bottom of Help page, Help link in Settings for easy cross-navigation"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Support link:"})," Ko-fi donation link added to Settings - buy me a coffee if ChipNotes helps you ID more birds"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Tech description restored:"})," Brought back the detailed tech paragraph about TypeScript, React, PixiJS, and PWA offline caching"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Privacy language:"}),' Updated Settings privacy text to be more neutral and less "we"-focused, "not stalking you" instead of "them"']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Credits update:"})," Added Cornell Macaulay Library, user contributions, and Bird Reference attribution"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Project timeline:"})," Documented creation timeline (Jan 8-11, 2026) and Claude Code collaboration"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Voice consistency:"}),' Changed "we" to "I" in Feedback section']})]})}),u.jsx(nt,{version:"3.18",date:"January 17, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"UI polish:"})," Streamlined pack selection, tightened layout, less visual clutter"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Custom Pack Builder:"}),' Sticky "Start" button stays visible with iOS keyboard, auto-focus for rapid bird entry, added preview tip']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Help page:"})," Reorganized sections, added creator attribution"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Privacy page:"})," Full privacy policy accessible from Settings"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Analytics fix:"})," Fixed gtag initialization pattern - tracking now works correctly"]})]})}),u.jsx(nt,{version:"3.17",date:"January 16, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Cookie consent:"})," I know I'm a stranger, but please accept my cookies! It really helps me document how many players I have and which birds everyone loves. (GDPR-compliant banner now appears on first visit)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Privacy controls:"}),' Changed your mind? New "Analytics Cookies" toggle in Settings lets you opt in/out anytime']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Your data is safe:"})," IP anonymization enabled, secure cookie flags set, full GDPR/CCPA compliance - I promise I'm just adding bird nerds to my LIFE LIST, not stalking you"]})]})}),u.jsx(nt,{version:"3.16",date:"January 16, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Bird Reference enhancement:"})," Separated display species (39) from gameplay rotation (27) for Expanded Eastern US Birds pack - Bird Reference now shows all available species for preview"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"UI improvements:"})," Streamlined pack selection tips, improved Help page tips with confusion matrix mention"]})]})}),u.jsx(nt,{version:"3.15",date:"January 16, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Xeno-canto attribution:"})," All Xeno-canto recordings now display recordist names for legal compliance (355 recordings attributed to 87+ contributors)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Help page enhancements:"}),' Added "Why Learn Bird Song?" section explaining the educational value of left/right audio training, tech details about PWA offline caching']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Audio curation:"})," Extensive clip review and quality improvements - refined canonical clips, updated vocalization types (call/song/drum), removed low-quality recordings"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"UI improvements:"}),' Moved shuffle button above bird grid for better visibility, added "Coming Soon" banner to Stats screen to clarify demo data']}),u.jsxs("li",{children:[u.jsx("strong",{children:"New bird icons:"})," Added icons for upcoming Macaulay species (ACFL, EAPH, EWPE, WEVI)"]})]})}),u.jsx(nt,{version:"3.14",date:"January 15, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Analytics:"})," Added Google Analytics 4 tracking for usage insights (page views, pack/level selections, Training Mode adoption)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Data fixes:"})," Restored BCCH, MODO, and WBNU clips lost during Cornell CD processing"]})]})}),u.jsx(nt,{version:"3.13",date:"January 15, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Western Backyard Birds pack:"})," 14 new species including Steller's Jay, Western Scrub-Jay, Black-capped Chickadee, and more. Fixed to use 9 random birds per round."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Audio improvements:"})," Restored canonical clips for 71+ species, resolved 202 broken audio references, cleaned up duplicate EATO clips (115)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"UI refinements:"})," Black backgrounds on Training Mode labels for better readability, Warbler Academy icon updated to Blackburnian Warbler, improved loading indicators"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Bird Reference enhancements:"})," Collapsible packs with expand/collapse controls, source badges (Xeno-canto, Cornell, contributors), pack cards with representative bird icons"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Fixed blank spectrograms"})," (async texture loading), added pull-to-refresh on main menu, audio preloading on preview screen"]}),u.jsx("li",{children:"Added White-crowned Sparrow to Sparrows pack (now 8 species)"})]})}),u.jsx(nt,{version:"3.03",date:"January 17, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Quit button:"})," Added X button during gameplay to quit rounds early with confirmation"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Support section:"})," Added Ko-fi donation link and encouragement to support Cornell Macaulay Library and Xeno-Canto"]})]})}),u.jsx(nt,{version:"3.02",date:"January 17, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Mobile navigation fix:"})," Bottom menu icons now properly visible on both Safari and Chrome mobile browsers"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Fullscreen tip:"})," Added browser guidance for best mobile experience"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"PWA improvements:"})," Enhanced Apple mobile web app support"]})]})}),u.jsx(nt,{version:"2.0",date:"January 12, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsx("li",{children:"Rebranded to ChipNotes! with Owl Professor mascot"}),u.jsx("li",{children:"Training Mode: Toggle eye icon to show bird labels on tiles"}),u.jsx("li",{children:"Warbler Academy pack: 33 wood-warbler species for experts"}),u.jsx("li",{children:"Complete icon set: Hand-illustrated icons for all 91+ species"}),u.jsx("li",{children:"Added Eastern Towhee to Expanded Backyard pack"}),u.jsx("li",{children:"Birds now persist between rounds by default"}),u.jsx("li",{children:"Fixed scoring to allow full 100 points as documented"}),u.jsx("li",{children:"iOS audio improvements and playback fixes"})]})}),u.jsx(nt,{version:"1.0",date:"January 11, 2026",children:u.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[u.jsx("li",{children:"Initial release with 6 bird packs"}),u.jsx("li",{children:"Pre-round preview screen to hear and see birds before playing"}),u.jsx("li",{children:"Custom pack builder for targeted practice"}),u.jsx("li",{children:"Continuous play mode (untimed, relaxed practice)"}),u.jsx("li",{children:"Enhanced round summary with per-species breakdown"}),u.jsx("li",{children:"Progressive difficulty: 6 levels per pack"}),u.jsx("li",{children:"Real spectrograms for visual learning"}),u.jsx("li",{children:"PWA support for offline play and mobile installation"})]})})]})}),u.jsx("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid var(--color-surface)",display:"flex",justifyContent:"center"},children:u.jsxs("button",{className:"btn-secondary",onClick:()=>t(-1),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 24px"},children:[u.jsx(Ax,{}),"Back"]})})]}),s&&u.jsxs("button",{onClick:d,style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",right:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",zIndex:1e3,display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:g=>{g.currentTarget.style.transform="scale(1.05)",g.currentTarget.style.background="rgba(255, 152, 0, 0.25)",g.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:g=>{g.currentTarget.style.transform="scale(1)",g.currentTarget.style.background="rgba(255, 152, 0, 0.15)",g.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},children:[u.jsx("span",{style:{fontSize:"12px"},children:f?"":""}),f?"Collapse All":"Expand All"]})]})}function Ft({title:t,children:e,isExpanded:r,onToggle:n}){return u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsxs("h3",{onClick:n,style:{fontSize:"16px",fontWeight:600,marginBottom:r?"12px":"0",color:"var(--color-accent)",borderBottom:"1px solid var(--color-surface)",paddingBottom:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"color 0.2s",userSelect:"none"},onMouseEnter:i=>i.currentTarget.style.color="#FFA726",onMouseLeave:i=>i.currentTarget.style.color="var(--color-accent)",children:[u.jsx("span",{style:{fontSize:"14px",width:"14px",textAlign:"center",flexShrink:0},children:r?"":""}),t]}),r&&u.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,color:"var(--color-text)"},children:e})]})}function cl({label:t,points:e,description:r,color:n}){return u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[u.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:n,minWidth:"40px"},children:["+",e]}),u.jsxs("div",{children:[u.jsx("span",{style:{fontWeight:600},children:t}),u.jsx("span",{style:{color:"var(--color-text-muted)",marginLeft:"8px",fontSize:"13px"},children:r})]})]})}function Wi({name:t,description:e}){return u.jsxs("div",{style:{marginBottom:"12px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px"},children:[u.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:t}),u.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:e})]})}function Xi({level:t,title:e,description:r}){return u.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[u.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:"var(--color-accent)",minWidth:"24px"},children:t}),u.jsxs("div",{children:[u.jsx("span",{style:{fontWeight:600},children:e}),u.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:r})]})]})}function Yi({children:t}){return u.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px"},children:[u.jsx("span",{style:{color:"var(--color-accent)"},children:""}),u.jsx("span",{children:t})]})}function nt({version:t,date:e,children:r}){return u.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"8px",marginBottom:"8px"},children:[u.jsxs("span",{style:{fontWeight:700,fontSize:"16px",color:"var(--color-accent)"},children:["v",t]}),u.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:e})]}),r]})}function Ax(){return u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}function UM(){const t=Wt();return u.jsxs("div",{className:"screen",children:[u.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[u.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:u.jsx(GM,{})}),u.jsx("h2",{style:{margin:0},children:"Privacy Policy"})]}),u.jsxs("div",{className:"flex-col gap-lg",style:{maxWidth:"800px"},children:[u.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[u.jsxs("p",{style:{marginBottom:"12px"},children:[u.jsx("strong",{children:"Last Updated:"})," January 17, 2026"]}),u.jsx("p",{style:{marginBottom:"12px"},children:"ChipNotes is committed to protecting your privacy. This policy explains what data is collected, how it is used, and your rights."})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Data Collection"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[u.jsx("p",{style:{marginBottom:"8px"},children:u.jsx("strong",{children:"Local Data (Always Stored on Your Device):"})}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[u.jsx("li",{children:"Game settings (scroll speed, spectrogram mode, high contrast, continuous play)"}),u.jsx("li",{children:"Custom pack selections (bird species you choose)"}),u.jsx("li",{children:"Round results and scores (not linked to your identity)"}),u.jsx("li",{children:"Cookie consent preference"})]}),u.jsx("p",{style:{marginBottom:"8px"},children:u.jsx("strong",{children:"Analytics Data (Only if You Consent):"})}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[u.jsx("li",{children:"Anonymized usage data via Google Analytics (IP addresses are anonymized)"}),u.jsx("li",{children:"Which features are used and which birds are practiced"}),u.jsx("li",{children:"App performance metrics"})]}),u.jsxs("p",{style:{fontSize:"13px",color:"var(--color-accent)"},children:[u.jsx("strong",{children:"Not collected:"})," Names, email addresses, phone numbers, precise location, or any personally identifiable information. Your game data stays on your device."]})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"How Your Data Is Used"}),u.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:u.jsxs("ul",{style:{marginLeft:"20px"},children:[u.jsx("li",{children:"Local data: Saves your preferences and tracks your progress"}),u.jsx("li",{children:"Analytics data: Used to understand how many players use ChipNotes, which features are popular, and how to improve the app"}),u.jsx("li",{children:"Your data is never sold, rented, or shared with third parties (except Google Analytics if you consent)"})]})})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Third-Party Services"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[u.jsxs("p",{style:{marginBottom:"8px"},children:[u.jsx("strong",{children:"Google Analytics"})," (only if you consent)"]}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[u.jsx("li",{children:"Used to collect anonymized usage statistics"}),u.jsx("li",{children:"IP anonymization enabled"}),u.jsx("li",{children:"No ad personalization or cross-device tracking"}),u.jsxs("li",{children:["Learn more: ",u.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Google Privacy Policy"})]})]}),u.jsx("p",{style:{marginBottom:"8px"},children:u.jsx("strong",{children:"Xeno-Canto Audio"})}),u.jsxs("ul",{style:{marginLeft:"20px"},children:[u.jsx("li",{children:"Bird sound recordings are sourced from Xeno-Canto and cached locally on your device"}),u.jsx("li",{children:"No data is sent to Xeno-Canto when you play sounds offline"})]})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Your Rights"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[u.jsx("p",{style:{marginBottom:"8px"},children:"You have the right to:"}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Access your data:"})," All local data is stored in your browser's localStorage (visible in browser dev tools)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Delete your data:"}),' Use the "Reset All Progress" button in Settings to delete all local data and cache']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Withdraw consent:"}),' Toggle "Analytics" in Settings to disable Google Analytics at any time']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Data portability:"})," Local data can be exported via browser dev tools (localStorage)"]})]}),u.jsx("p",{style:{fontSize:"13px"},children:"Since all game data is stored locally on your device, you have full control. Uninstalling the app or clearing browser data will permanently delete all your data."})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Cookies & Local Storage"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[u.jsx("p",{style:{marginBottom:"8px"},children:u.jsx("strong",{children:"Essential (Always Active):"})}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[u.jsxs("li",{children:[u.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"chipnotes_cookie_consent"})," - Stores your cookie consent choice"]}),u.jsxs("li",{children:[u.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"soundfield_*"})," - Game settings and progress (all stored in localStorage)"]})]}),u.jsx("p",{style:{marginBottom:"8px"},children:u.jsx("strong",{children:"Analytics (Only if You Consent):"})}),u.jsx("ul",{style:{marginLeft:"20px"},children:u.jsxs("li",{children:[u.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga"}),", ",u.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga_*"})," - Google Analytics cookies (2-year expiration)"]})})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Data Security"}),u.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:u.jsxs("ul",{style:{marginLeft:"20px"},children:[u.jsx("li",{children:"All data is stored locally on your device (no cloud servers)"}),u.jsx("li",{children:"HTTPS encryption for all web traffic"}),u.jsx("li",{children:"No user accounts or authentication (no password risks)"}),u.jsx("li",{children:"Service Worker caches audio files for offline use (stored locally)"})]})})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Children's Privacy"}),u.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:u.jsx("p",{children:"ChipNotes does not knowingly collect data from children under 13. The app does not require any personal information, and analytics are opt-in. Parents can disable analytics in Settings."})})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"International Users"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[u.jsx("p",{style:{marginBottom:"8px"},children:"ChipNotes complies with:"}),u.jsxs("ul",{style:{marginLeft:"20px"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"GDPR"})," (European Union) - Right to access, deletion, and data portability"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"CCPA"})," (California) - Right to know and delete personal information"]}),u.jsx("li",{children:"Since no personal information is collected, compliance is straightforward"})]})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Changes to This Policy"}),u.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:u.jsx("p",{children:'This Privacy Policy may be updated from time to time. Changes will be posted on this page with an updated "Last Updated" date. Continued use of the app after changes constitutes acceptance of the updated policy.'})})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{style:{marginBottom:"12px"},children:"Contact Us"}),u.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[u.jsx("p",{style:{marginBottom:"8px"},children:"Questions about this Privacy Policy or your data?"}),u.jsxs("p",{children:["Email:"," ",u.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]})]})]})]})]})}function GM(){return u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M15 18l-6-6 6-6"})})}const Nh="chipnotes_cookie_consent";function Cx(){if(typeof window>"u")return;if(window.gtag){console.log("Google Analytics already loaded");return}window.dataLayer=window.dataLayer||[],window.gtag=function(){var e;(e=window.dataLayer)==null||e.push(arguments)},window.gtag("js",new Date),window.gtag("config","G-MJXQZYWWZ0",{anonymize_ip:!0,cookie_flags:"SameSite=Lax;Secure",cookie_expires:63072e3,allow_ad_personalization_signals:!1,allow_google_signals:!1});const t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-MJXQZYWWZ0",document.head.appendChild(t),console.log("Google Analytics loading with user consent")}function zM(){const[t,e]=E.useState(!1);E.useEffect(()=>{const i=localStorage.getItem(Nh);i==="accepted"?Cx():i===null&&e(!0)},[]);const r=()=>{localStorage.setItem(Nh,"accepted"),e(!1),Cx(),setTimeout(()=>{window.location.reload()},100)},n=()=>{localStorage.setItem(Nh,"declined"),e(!1),setTimeout(()=>{window.location.reload()},100)};return t?u.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"rgba(26, 26, 46, 0.98)",backdropFilter:"blur(10px)",borderTop:"1px solid var(--color-primary)",padding:"16px",paddingBottom:"calc(16px + var(--safe-area-bottom, 0px))",zIndex:1e4,boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.3)"},children:u.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"12px"},children:[u.jsxs("div",{style:{fontSize:"14px",lineHeight:1.5,color:"var(--color-text)"},children:[u.jsx("strong",{style:{color:"var(--color-accent)"},children:" Cookies & Privacy"}),u.jsxs("p",{style:{margin:"8px 0 0 0",color:"var(--color-text-muted)"},children:["We use Google Analytics to understand how people use ChipNotes and improve the app. This helps us know which features are useful and which birds people practice most. We anonymize your IP address and don't collect personal information."," ",u.jsx("a",{href:"/bird-sound-game/privacy",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Learn more"})]})]}),u.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[u.jsx("button",{onClick:r,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="#3a7332"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-primary)"},children:"Accept Analytics"}),u.jsx("button",{onClick:n,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-surface)",color:"var(--color-text)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="var(--color-background)"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-surface)"},children:"Decline"})]})]})}):null}function HM(){return u.jsxs(u.Fragment,{children:[u.jsxs(vE,{children:[u.jsx(Xt,{path:"/",element:u.jsx(ME,{})}),u.jsx(Xt,{path:"/pack-select",element:u.jsx(zE,{})}),u.jsx(Xt,{path:"/level-select",element:u.jsx(QE,{})}),u.jsx(Xt,{path:"/preview",element:u.jsx(sT,{})}),u.jsx(Xt,{path:"/custom-pack",element:u.jsx(uT,{})}),u.jsx(Xt,{path:"/gameplay",element:u.jsx(PM,{})}),u.jsx(Xt,{path:"/summary",element:u.jsx(kM,{})}),u.jsx(Xt,{path:"/settings",element:u.jsx(LM,{})}),u.jsx(Xt,{path:"/progress",element:u.jsx(DM,{})}),u.jsx(Xt,{path:"/help",element:u.jsx(OM,{})}),u.jsx(Xt,{path:"/privacy",element:u.jsx(UM,{})})]}),u.jsx(zM,{})]})}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{for(const e of t)e.unregister()});Lh.createRoot(document.getElementById("root")).render(u.jsx(jx.StrictMode,{children:u.jsx(CE,{basename:"/",children:u.jsx(HM,{})})}));
