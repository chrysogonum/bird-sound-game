var G1=Object.defineProperty;var z1=(t,e,r)=>e in t?G1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var dn=(t,e,r)=>z1(t,typeof e!="symbol"?e+"":e,r);function V1(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var _o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function $1(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var xv={exports:{}},bu={},_v={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sa=Symbol.for("react.element"),H1=Symbol.for("react.portal"),W1=Symbol.for("react.fragment"),X1=Symbol.for("react.strict_mode"),Y1=Symbol.for("react.profiler"),K1=Symbol.for("react.provider"),q1=Symbol.for("react.context"),Z1=Symbol.for("react.forward_ref"),Q1=Symbol.for("react.suspense"),J1=Symbol.for("react.memo"),ew=Symbol.for("react.lazy"),Qp=Symbol.iterator;function tw(t){return t===null||typeof t!="object"?null:(t=Qp&&t[Qp]||t["@@iterator"],typeof t=="function"?t:null)}var wv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sv=Object.assign,Ev={};function js(t,e,r){this.props=t,this.context=e,this.refs=Ev,this.updater=r||wv}js.prototype.isReactComponent={};js.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};js.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bv(){}bv.prototype=js.prototype;function Tf(t,e,r){this.props=t,this.context=e,this.refs=Ev,this.updater=r||wv}var Af=Tf.prototype=new bv;Af.constructor=Tf;Sv(Af,js.prototype);Af.isPureReactComponent=!0;var Jp=Array.isArray,Tv=Object.prototype.hasOwnProperty,Cf={current:null},Av={key:!0,ref:!0,__self:!0,__source:!0};function Cv(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Tv.call(e,n)&&!Av.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:sa,type:t,key:s,ref:o,props:i,_owner:Cf.current}}function rw(t,e){return{$$typeof:sa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Rf(t){return typeof t=="object"&&t!==null&&t.$$typeof===sa}function nw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var em=/\/+/g;function lc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nw(""+t.key):e.toString(36)}function ul(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case sa:case H1:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+lc(o,0):n,Jp(i)?(r="",t!=null&&(r=t.replace(em,"$&/")+"/"),ul(i,e,r,"",function(u){return u})):i!=null&&(Rf(i)&&(i=rw(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(em,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",Jp(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+lc(s,a);o+=ul(s,e,r,l,i)}else if(l=tw(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+lc(s,a++),o+=ul(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function _a(t,e,r){if(t==null)return t;var n=[],i=0;return ul(t,n,"","",function(s){return e.call(r,s,i++)}),n}function iw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var St={current:null},cl={transition:null},sw={ReactCurrentDispatcher:St,ReactCurrentBatchConfig:cl,ReactCurrentOwner:Cf};function Rv(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:_a,forEach:function(t,e,r){_a(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return _a(t,function(){e++}),e},toArray:function(t){return _a(t,function(e){return e})||[]},only:function(t){if(!Rf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};me.Component=js;me.Fragment=W1;me.Profiler=Y1;me.PureComponent=Tf;me.StrictMode=X1;me.Suspense=Q1;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sw;me.act=Rv;me.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Sv({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Cf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Tv.call(e,l)&&!Av.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:sa,type:t.type,key:i,ref:s,props:n,_owner:o}};me.createContext=function(t){return t={$$typeof:q1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:K1,_context:t},t.Consumer=t};me.createElement=Cv;me.createFactory=function(t){var e=Cv.bind(null,t);return e.type=t,e};me.createRef=function(){return{current:null}};me.forwardRef=function(t){return{$$typeof:Z1,render:t}};me.isValidElement=Rf;me.lazy=function(t){return{$$typeof:ew,_payload:{_status:-1,_result:t},_init:iw}};me.memo=function(t,e){return{$$typeof:J1,type:t,compare:e===void 0?null:e}};me.startTransition=function(t){var e=cl.transition;cl.transition={};try{t()}finally{cl.transition=e}};me.unstable_act=Rv;me.useCallback=function(t,e){return St.current.useCallback(t,e)};me.useContext=function(t){return St.current.useContext(t)};me.useDebugValue=function(){};me.useDeferredValue=function(t){return St.current.useDeferredValue(t)};me.useEffect=function(t,e){return St.current.useEffect(t,e)};me.useId=function(){return St.current.useId()};me.useImperativeHandle=function(t,e,r){return St.current.useImperativeHandle(t,e,r)};me.useInsertionEffect=function(t,e){return St.current.useInsertionEffect(t,e)};me.useLayoutEffect=function(t,e){return St.current.useLayoutEffect(t,e)};me.useMemo=function(t,e){return St.current.useMemo(t,e)};me.useReducer=function(t,e,r){return St.current.useReducer(t,e,r)};me.useRef=function(t){return St.current.useRef(t)};me.useState=function(t){return St.current.useState(t)};me.useSyncExternalStore=function(t,e,r){return St.current.useSyncExternalStore(t,e,r)};me.useTransition=function(){return St.current.useTransition()};me.version="18.3.1";_v.exports=me;var E=_v.exports;const Pv=bf(E),ow=V1({__proto__:null,default:Pv},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aw=E,lw=Symbol.for("react.element"),uw=Symbol.for("react.fragment"),cw=Object.prototype.hasOwnProperty,hw=aw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dw={key:!0,ref:!0,__self:!0,__source:!0};function Iv(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)cw.call(e,n)&&!dw.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:lw,type:t,key:s,ref:o,props:i,_owner:hw.current}}bu.Fragment=uw;bu.jsx=Iv;bu.jsxs=Iv;xv.exports=bu;var f=xv.exports,Ih={},kv={exports:{}},Gt={},Mv={exports:{}},Bv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(P,D){var R=P.length;P.push(D);e:for(;0<R;){var F=R-1>>>1,Z=P[F];if(0<i(Z,D))P[F]=D,P[R]=Z,R=F;else break e}}function r(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var D=P[0],R=P.pop();if(R!==D){P[0]=R;e:for(var F=0,Z=P.length,he=Z>>>1;F<he;){var ue=2*(F+1)-1,_e=P[ue],xe=ue+1,Re=P[xe];if(0>i(_e,R))xe<Z&&0>i(Re,_e)?(P[F]=Re,P[xe]=R,F=xe):(P[F]=_e,P[ue]=R,F=ue);else if(xe<Z&&0>i(Re,R))P[F]=Re,P[xe]=R,F=xe;else break e}}return D}function i(P,D){var R=P.sortIndex-D.sortIndex;return R!==0?R:P.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,m=!1,g=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(P){for(var D=r(u);D!==null;){if(D.callback===null)n(u);else if(D.startTime<=P)n(u),D.sortIndex=D.expirationTime,e(l,D);else break;D=r(u)}}function _(P){if(x=!1,p(P),!g)if(r(l)!==null)g=!0,B(S);else{var D=r(u);D!==null&&k(_,D.startTime-P)}}function S(P,D){g=!1,x&&(x=!1,y(T),T=-1),m=!0;var R=d;try{for(p(D),h=r(l);h!==null&&(!(h.expirationTime>D)||P&&!W());){var F=h.callback;if(typeof F=="function"){h.callback=null,d=h.priorityLevel;var Z=F(h.expirationTime<=D);D=t.unstable_now(),typeof Z=="function"?h.callback=Z:h===r(l)&&n(l),p(D)}else n(l);h=r(l)}if(h!==null)var he=!0;else{var ue=r(u);ue!==null&&k(_,ue.startTime-D),he=!1}return he}finally{h=null,d=R,m=!1}}var b=!1,A=null,T=-1,M=5,I=-1;function W(){return!(t.unstable_now()-I<M)}function G(){if(A!==null){var P=t.unstable_now();I=P;var D=!0;try{D=A(!0,P)}finally{D?C():(b=!1,A=null)}}else b=!1}var C;if(typeof v=="function")C=function(){v(G)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,z=N.port2;N.port1.onmessage=G,C=function(){z.postMessage(null)}}else C=function(){w(G,0)};function B(P){A=P,b||(b=!0,C())}function k(P,D){T=w(function(){P(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,B(S))},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(P){switch(d){case 1:case 2:case 3:var D=3;break;default:D=d}var R=d;d=D;try{return P()}finally{d=R}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(P,D){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var R=d;d=P;try{return D()}finally{d=R}},t.unstable_scheduleCallback=function(P,D,R){var F=t.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?F+R:F):R=F,P){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=R+Z,P={id:c++,callback:D,priorityLevel:P,startTime:R,expirationTime:Z,sortIndex:-1},R>F?(P.sortIndex=R,e(u,P),r(l)===null&&P===r(u)&&(x?(y(T),T=-1):x=!0,k(_,R-F))):(P.sortIndex=Z,e(l,P),g||m||(g=!0,B(S))),P},t.unstable_shouldYield=W,t.unstable_wrapCallback=function(P){var D=d;return function(){var R=d;d=D;try{return P.apply(this,arguments)}finally{d=R}}}})(Bv);Mv.exports=Bv;var fw=Mv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pw=E,jt=fw;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nv=new Set,Fo={};function Ci(t,e){Is(t,e),Is(t+"Capture",e)}function Is(t,e){for(Fo[t]=e,t=0;t<e.length;t++)Nv.add(e[t])}var Jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kh=Object.prototype.hasOwnProperty,mw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,tm={},rm={};function gw(t){return kh.call(rm,t)?!0:kh.call(tm,t)?!1:mw.test(t)?rm[t]=!0:(tm[t]=!0,!1)}function yw(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vw(t,e,r,n){if(e===null||typeof e>"u"||yw(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Et(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ut={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ut[t]=new Et(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ut[e]=new Et(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ut[t]=new Et(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ut[t]=new Et(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ut[t]=new Et(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ut[t]=new Et(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ut[t]=new Et(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ut[t]=new Et(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ut[t]=new Et(t,5,!1,t.toLowerCase(),null,!1,!1)});var Pf=/[\-:]([a-z])/g;function If(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Pf,If);ut[e]=new Et(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Pf,If);ut[e]=new Et(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Pf,If);ut[e]=new Et(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ut[t]=new Et(t,1,!1,t.toLowerCase(),null,!1,!1)});ut.xlinkHref=new Et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ut[t]=new Et(t,1,!1,t.toLowerCase(),null,!0,!0)});function kf(t,e,r,n){var i=ut.hasOwnProperty(e)?ut[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vw(e,r,i,n)&&(r=null),n||i===null?gw(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var on=pw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wa=Symbol.for("react.element"),rs=Symbol.for("react.portal"),ns=Symbol.for("react.fragment"),Mf=Symbol.for("react.strict_mode"),Mh=Symbol.for("react.profiler"),Fv=Symbol.for("react.provider"),Dv=Symbol.for("react.context"),Bf=Symbol.for("react.forward_ref"),Bh=Symbol.for("react.suspense"),Nh=Symbol.for("react.suspense_list"),Nf=Symbol.for("react.memo"),xn=Symbol.for("react.lazy"),Lv=Symbol.for("react.offscreen"),nm=Symbol.iterator;function Ys(t){return t===null||typeof t!="object"?null:(t=nm&&t[nm]||t["@@iterator"],typeof t=="function"?t:null)}var je=Object.assign,uc;function ao(t){if(uc===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);uc=e&&e[1]||""}return`
`+uc+t}var cc=!1;function hc(t,e){if(!t||cc)return"";cc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{cc=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ao(t):""}function xw(t){switch(t.tag){case 5:return ao(t.type);case 16:return ao("Lazy");case 13:return ao("Suspense");case 19:return ao("SuspenseList");case 0:case 2:case 15:return t=hc(t.type,!1),t;case 11:return t=hc(t.type.render,!1),t;case 1:return t=hc(t.type,!0),t;default:return""}}function Fh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ns:return"Fragment";case rs:return"Portal";case Mh:return"Profiler";case Mf:return"StrictMode";case Bh:return"Suspense";case Nh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Dv:return(t.displayName||"Context")+".Consumer";case Fv:return(t._context.displayName||"Context")+".Provider";case Bf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Nf:return e=t.displayName||null,e!==null?e:Fh(t.type)||"Memo";case xn:e=t._payload,t=t._init;try{return Fh(t(e))}catch{}}return null}function _w(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fh(e);case 8:return e===Mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Gn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ov(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ww(t){var e=Ov(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Sa(t){t._valueTracker||(t._valueTracker=ww(t))}function Uv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Ov(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Bl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dh(t,e){var r=e.checked;return je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function im(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Gn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jv(t,e){e=e.checked,e!=null&&kf(t,"checked",e,!1)}function Lh(t,e){jv(t,e);var r=Gn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Oh(t,e.type,r):e.hasOwnProperty("defaultValue")&&Oh(t,e.type,Gn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function sm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Oh(t,e,r){(e!=="number"||Bl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var lo=Array.isArray;function gs(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Gn(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Uh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function om(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(L(92));if(lo(r)){if(1<r.length)throw Error(L(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Gn(r)}}function Gv(t,e){var r=Gn(e.value),n=Gn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function am(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ea,Vv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ea=Ea||document.createElement("div"),Ea.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ea.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Do(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var wo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sw=["Webkit","ms","Moz","O"];Object.keys(wo).forEach(function(t){Sw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),wo[e]=wo[t]})});function $v(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||wo.hasOwnProperty(t)&&wo[t]?(""+e).trim():e+"px"}function Hv(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=$v(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Ew=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gh(t,e){if(e){if(Ew[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function zh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vh=null;function Ff(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $h=null,ys=null,vs=null;function lm(t){if(t=la(t)){if(typeof $h!="function")throw Error(L(280));var e=t.stateNode;e&&(e=Pu(e),$h(t.stateNode,t.type,e))}}function Wv(t){ys?vs?vs.push(t):vs=[t]:ys=t}function Xv(){if(ys){var t=ys,e=vs;if(vs=ys=null,lm(t),e)for(t=0;t<e.length;t++)lm(e[t])}}function Yv(t,e){return t(e)}function Kv(){}var dc=!1;function qv(t,e,r){if(dc)return t(e,r);dc=!0;try{return Yv(t,e,r)}finally{dc=!1,(ys!==null||vs!==null)&&(Kv(),Xv())}}function Lo(t,e){var r=t.stateNode;if(r===null)return null;var n=Pu(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(L(231,e,typeof r));return r}var Hh=!1;if(Jr)try{var Ks={};Object.defineProperty(Ks,"passive",{get:function(){Hh=!0}}),window.addEventListener("test",Ks,Ks),window.removeEventListener("test",Ks,Ks)}catch{Hh=!1}function bw(t,e,r,n,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(c){this.onError(c)}}var So=!1,Nl=null,Fl=!1,Wh=null,Tw={onError:function(t){So=!0,Nl=t}};function Aw(t,e,r,n,i,s,o,a,l){So=!1,Nl=null,bw.apply(Tw,arguments)}function Cw(t,e,r,n,i,s,o,a,l){if(Aw.apply(this,arguments),So){if(So){var u=Nl;So=!1,Nl=null}else throw Error(L(198));Fl||(Fl=!0,Wh=u)}}function Ri(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Zv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function um(t){if(Ri(t)!==t)throw Error(L(188))}function Rw(t){var e=t.alternate;if(!e){if(e=Ri(t),e===null)throw Error(L(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return um(i),t;if(s===n)return um(i),e;s=s.sibling}throw Error(L(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(L(189))}}if(r.alternate!==n)throw Error(L(190))}if(r.tag!==3)throw Error(L(188));return r.stateNode.current===r?t:e}function Qv(t){return t=Rw(t),t!==null?Jv(t):null}function Jv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Jv(t);if(e!==null)return e;t=t.sibling}return null}var e0=jt.unstable_scheduleCallback,cm=jt.unstable_cancelCallback,Pw=jt.unstable_shouldYield,Iw=jt.unstable_requestPaint,He=jt.unstable_now,kw=jt.unstable_getCurrentPriorityLevel,Df=jt.unstable_ImmediatePriority,t0=jt.unstable_UserBlockingPriority,Dl=jt.unstable_NormalPriority,Mw=jt.unstable_LowPriority,r0=jt.unstable_IdlePriority,Tu=null,Mr=null;function Bw(t){if(Mr&&typeof Mr.onCommitFiberRoot=="function")try{Mr.onCommitFiberRoot(Tu,t,void 0,(t.current.flags&128)===128)}catch{}}var dr=Math.clz32?Math.clz32:Dw,Nw=Math.log,Fw=Math.LN2;function Dw(t){return t>>>=0,t===0?32:31-(Nw(t)/Fw|0)|0}var ba=64,Ta=4194304;function uo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ll(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=uo(a):(s&=o,s!==0&&(n=uo(s)))}else o=r&~i,o!==0?n=uo(o):s!==0&&(n=uo(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-dr(e),i=1<<r,n|=t[r],e&=~i;return n}function Lw(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ow(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-dr(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=Lw(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Xh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function n0(){var t=ba;return ba<<=1,!(ba&4194240)&&(ba=64),t}function fc(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function oa(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-dr(e),t[e]=r}function Uw(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-dr(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Lf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-dr(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var we=0;function i0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var s0,Of,o0,a0,l0,Yh=!1,Aa=[],kn=null,Mn=null,Bn=null,Oo=new Map,Uo=new Map,Sn=[],jw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hm(t,e){switch(t){case"focusin":case"focusout":kn=null;break;case"dragenter":case"dragleave":Mn=null;break;case"mouseover":case"mouseout":Bn=null;break;case"pointerover":case"pointerout":Oo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uo.delete(e.pointerId)}}function qs(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=la(e),e!==null&&Of(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Gw(t,e,r,n,i){switch(e){case"focusin":return kn=qs(kn,t,e,r,n,i),!0;case"dragenter":return Mn=qs(Mn,t,e,r,n,i),!0;case"mouseover":return Bn=qs(Bn,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Oo.set(s,qs(Oo.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Uo.set(s,qs(Uo.get(s)||null,t,e,r,n,i)),!0}return!1}function u0(t){var e=ci(t.target);if(e!==null){var r=Ri(e);if(r!==null){if(e=r.tag,e===13){if(e=Zv(r),e!==null){t.blockedOn=e,l0(t.priority,function(){o0(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function hl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Kh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Vh=n,r.target.dispatchEvent(n),Vh=null}else return e=la(r),e!==null&&Of(e),t.blockedOn=r,!1;e.shift()}return!0}function dm(t,e,r){hl(t)&&r.delete(e)}function zw(){Yh=!1,kn!==null&&hl(kn)&&(kn=null),Mn!==null&&hl(Mn)&&(Mn=null),Bn!==null&&hl(Bn)&&(Bn=null),Oo.forEach(dm),Uo.forEach(dm)}function Zs(t,e){t.blockedOn===e&&(t.blockedOn=null,Yh||(Yh=!0,jt.unstable_scheduleCallback(jt.unstable_NormalPriority,zw)))}function jo(t){function e(i){return Zs(i,t)}if(0<Aa.length){Zs(Aa[0],t);for(var r=1;r<Aa.length;r++){var n=Aa[r];n.blockedOn===t&&(n.blockedOn=null)}}for(kn!==null&&Zs(kn,t),Mn!==null&&Zs(Mn,t),Bn!==null&&Zs(Bn,t),Oo.forEach(e),Uo.forEach(e),r=0;r<Sn.length;r++)n=Sn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Sn.length&&(r=Sn[0],r.blockedOn===null);)u0(r),r.blockedOn===null&&Sn.shift()}var xs=on.ReactCurrentBatchConfig,Ol=!0;function Vw(t,e,r,n){var i=we,s=xs.transition;xs.transition=null;try{we=1,Uf(t,e,r,n)}finally{we=i,xs.transition=s}}function $w(t,e,r,n){var i=we,s=xs.transition;xs.transition=null;try{we=4,Uf(t,e,r,n)}finally{we=i,xs.transition=s}}function Uf(t,e,r,n){if(Ol){var i=Kh(t,e,r,n);if(i===null)Ec(t,e,n,Ul,r),hm(t,n);else if(Gw(i,t,e,r,n))n.stopPropagation();else if(hm(t,n),e&4&&-1<jw.indexOf(t)){for(;i!==null;){var s=la(i);if(s!==null&&s0(s),s=Kh(t,e,r,n),s===null&&Ec(t,e,n,Ul,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Ec(t,e,n,null,r)}}var Ul=null;function Kh(t,e,r,n){if(Ul=null,t=Ff(n),t=ci(t),t!==null)if(e=Ri(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Zv(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ul=t,null}function c0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kw()){case Df:return 1;case t0:return 4;case Dl:case Mw:return 16;case r0:return 536870912;default:return 16}default:return 16}}var Tn=null,jf=null,dl=null;function h0(){if(dl)return dl;var t,e=jf,r=e.length,n,i="value"in Tn?Tn.value:Tn.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return dl=i.slice(t,1<n?1-n:void 0)}function fl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ca(){return!0}function fm(){return!1}function zt(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ca:fm,this.isPropagationStopped=fm,this}return je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ca)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ca)},persist:function(){},isPersistent:Ca}),e}var Gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gf=zt(Gs),aa=je({},Gs,{view:0,detail:0}),Hw=zt(aa),pc,mc,Qs,Au=je({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qs&&(Qs&&t.type==="mousemove"?(pc=t.screenX-Qs.screenX,mc=t.screenY-Qs.screenY):mc=pc=0,Qs=t),pc)},movementY:function(t){return"movementY"in t?t.movementY:mc}}),pm=zt(Au),Ww=je({},Au,{dataTransfer:0}),Xw=zt(Ww),Yw=je({},aa,{relatedTarget:0}),gc=zt(Yw),Kw=je({},Gs,{animationName:0,elapsedTime:0,pseudoElement:0}),qw=zt(Kw),Zw=je({},Gs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Qw=zt(Zw),Jw=je({},Gs,{data:0}),mm=zt(Jw),eS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=rS[t])?!!e[t]:!1}function zf(){return nS}var iS=je({},aa,{key:function(t){if(t.key){var e=eS[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=fl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zf,charCode:function(t){return t.type==="keypress"?fl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?fl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sS=zt(iS),oS=je({},Au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gm=zt(oS),aS=je({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zf}),lS=zt(aS),uS=je({},Gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),cS=zt(uS),hS=je({},Au,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dS=zt(hS),fS=[9,13,27,32],Vf=Jr&&"CompositionEvent"in window,Eo=null;Jr&&"documentMode"in document&&(Eo=document.documentMode);var pS=Jr&&"TextEvent"in window&&!Eo,d0=Jr&&(!Vf||Eo&&8<Eo&&11>=Eo),ym=" ",vm=!1;function f0(t,e){switch(t){case"keyup":return fS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var is=!1;function mS(t,e){switch(t){case"compositionend":return p0(e);case"keypress":return e.which!==32?null:(vm=!0,ym);case"textInput":return t=e.data,t===ym&&vm?null:t;default:return null}}function gS(t,e){if(is)return t==="compositionend"||!Vf&&f0(t,e)?(t=h0(),dl=jf=Tn=null,is=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return d0&&e.locale!=="ko"?null:e.data;default:return null}}var yS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!yS[t.type]:e==="textarea"}function m0(t,e,r,n){Wv(n),e=jl(e,"onChange"),0<e.length&&(r=new Gf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var bo=null,Go=null;function vS(t){A0(t,0)}function Cu(t){var e=as(t);if(Uv(e))return t}function xS(t,e){if(t==="change")return e}var g0=!1;if(Jr){var yc;if(Jr){var vc="oninput"in document;if(!vc){var _m=document.createElement("div");_m.setAttribute("oninput","return;"),vc=typeof _m.oninput=="function"}yc=vc}else yc=!1;g0=yc&&(!document.documentMode||9<document.documentMode)}function wm(){bo&&(bo.detachEvent("onpropertychange",y0),Go=bo=null)}function y0(t){if(t.propertyName==="value"&&Cu(Go)){var e=[];m0(e,Go,t,Ff(t)),qv(vS,e)}}function _S(t,e,r){t==="focusin"?(wm(),bo=e,Go=r,bo.attachEvent("onpropertychange",y0)):t==="focusout"&&wm()}function wS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Cu(Go)}function SS(t,e){if(t==="click")return Cu(e)}function ES(t,e){if(t==="input"||t==="change")return Cu(e)}function bS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gr=typeof Object.is=="function"?Object.is:bS;function zo(t,e){if(gr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!kh.call(e,i)||!gr(t[i],e[i]))return!1}return!0}function Sm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Em(t,e){var r=Sm(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Sm(r)}}function v0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?v0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function x0(){for(var t=window,e=Bl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Bl(t.document)}return e}function $f(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function TS(t){var e=x0(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&v0(r.ownerDocument.documentElement,r)){if(n!==null&&$f(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Em(r,s);var o=Em(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var AS=Jr&&"documentMode"in document&&11>=document.documentMode,ss=null,qh=null,To=null,Zh=!1;function bm(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Zh||ss==null||ss!==Bl(n)||(n=ss,"selectionStart"in n&&$f(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),To&&zo(To,n)||(To=n,n=jl(qh,"onSelect"),0<n.length&&(e=new Gf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ss)))}function Ra(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var os={animationend:Ra("Animation","AnimationEnd"),animationiteration:Ra("Animation","AnimationIteration"),animationstart:Ra("Animation","AnimationStart"),transitionend:Ra("Transition","TransitionEnd")},xc={},_0={};Jr&&(_0=document.createElement("div").style,"AnimationEvent"in window||(delete os.animationend.animation,delete os.animationiteration.animation,delete os.animationstart.animation),"TransitionEvent"in window||delete os.transitionend.transition);function Ru(t){if(xc[t])return xc[t];if(!os[t])return t;var e=os[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in _0)return xc[t]=e[r];return t}var w0=Ru("animationend"),S0=Ru("animationiteration"),E0=Ru("animationstart"),b0=Ru("transitionend"),T0=new Map,Tm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wn(t,e){T0.set(t,e),Ci(e,[t])}for(var _c=0;_c<Tm.length;_c++){var wc=Tm[_c],CS=wc.toLowerCase(),RS=wc[0].toUpperCase()+wc.slice(1);Wn(CS,"on"+RS)}Wn(w0,"onAnimationEnd");Wn(S0,"onAnimationIteration");Wn(E0,"onAnimationStart");Wn("dblclick","onDoubleClick");Wn("focusin","onFocus");Wn("focusout","onBlur");Wn(b0,"onTransitionEnd");Is("onMouseEnter",["mouseout","mouseover"]);Is("onMouseLeave",["mouseout","mouseover"]);Is("onPointerEnter",["pointerout","pointerover"]);Is("onPointerLeave",["pointerout","pointerover"]);Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PS=new Set("cancel close invalid load scroll toggle".split(" ").concat(co));function Am(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Cw(n,e,void 0,t),t.currentTarget=null}function A0(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Am(i,a,u),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Am(i,a,u),s=l}}}if(Fl)throw t=Wh,Fl=!1,Wh=null,t}function Pe(t,e){var r=e[rd];r===void 0&&(r=e[rd]=new Set);var n=t+"__bubble";r.has(n)||(C0(e,t,2,!1),r.add(n))}function Sc(t,e,r){var n=0;e&&(n|=4),C0(r,t,n,e)}var Pa="_reactListening"+Math.random().toString(36).slice(2);function Vo(t){if(!t[Pa]){t[Pa]=!0,Nv.forEach(function(r){r!=="selectionchange"&&(PS.has(r)||Sc(r,!1,t),Sc(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Pa]||(e[Pa]=!0,Sc("selectionchange",!1,e))}}function C0(t,e,r,n){switch(c0(e)){case 1:var i=Vw;break;case 4:i=$w;break;default:i=Uf}r=i.bind(null,e,r,t),i=void 0,!Hh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Ec(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ci(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}qv(function(){var u=s,c=Ff(r),h=[];e:{var d=T0.get(t);if(d!==void 0){var m=Gf,g=t;switch(t){case"keypress":if(fl(r)===0)break e;case"keydown":case"keyup":m=sS;break;case"focusin":g="focus",m=gc;break;case"focusout":g="blur",m=gc;break;case"beforeblur":case"afterblur":m=gc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=pm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Xw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=lS;break;case w0:case S0:case E0:m=qw;break;case b0:m=cS;break;case"scroll":m=Hw;break;case"wheel":m=dS;break;case"copy":case"cut":case"paste":m=Qw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=gm}var x=(e&4)!==0,w=!x&&t==="scroll",y=x?d!==null?d+"Capture":null:d;x=[];for(var v=u,p;v!==null;){p=v;var _=p.stateNode;if(p.tag===5&&_!==null&&(p=_,y!==null&&(_=Lo(v,y),_!=null&&x.push($o(v,_,p)))),w)break;v=v.return}0<x.length&&(d=new m(d,g,null,r,c),h.push({event:d,listeners:x}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==Vh&&(g=r.relatedTarget||r.fromElement)&&(ci(g)||g[en]))break e;if((m||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=u,g=g?ci(g):null,g!==null&&(w=Ri(g),g!==w||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(x=pm,_="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(x=gm,_="onPointerLeave",y="onPointerEnter",v="pointer"),w=m==null?d:as(m),p=g==null?d:as(g),d=new x(_,v+"leave",m,r,c),d.target=w,d.relatedTarget=p,_=null,ci(c)===u&&(x=new x(y,v+"enter",g,r,c),x.target=p,x.relatedTarget=w,_=x),w=_,m&&g)t:{for(x=m,y=g,v=0,p=x;p;p=Oi(p))v++;for(p=0,_=y;_;_=Oi(_))p++;for(;0<v-p;)x=Oi(x),v--;for(;0<p-v;)y=Oi(y),p--;for(;v--;){if(x===y||y!==null&&x===y.alternate)break t;x=Oi(x),y=Oi(y)}x=null}else x=null;m!==null&&Cm(h,d,m,x,!1),g!==null&&w!==null&&Cm(h,w,g,x,!0)}}e:{if(d=u?as(u):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var S=xS;else if(xm(d))if(g0)S=ES;else{S=wS;var b=_S}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=SS);if(S&&(S=S(t,u))){m0(h,S,r,c);break e}b&&b(t,d,u),t==="focusout"&&(b=d._wrapperState)&&b.controlled&&d.type==="number"&&Oh(d,"number",d.value)}switch(b=u?as(u):window,t){case"focusin":(xm(b)||b.contentEditable==="true")&&(ss=b,qh=u,To=null);break;case"focusout":To=qh=ss=null;break;case"mousedown":Zh=!0;break;case"contextmenu":case"mouseup":case"dragend":Zh=!1,bm(h,r,c);break;case"selectionchange":if(AS)break;case"keydown":case"keyup":bm(h,r,c)}var A;if(Vf)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else is?f0(t,r)&&(T="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(d0&&r.locale!=="ko"&&(is||T!=="onCompositionStart"?T==="onCompositionEnd"&&is&&(A=h0()):(Tn=c,jf="value"in Tn?Tn.value:Tn.textContent,is=!0)),b=jl(u,T),0<b.length&&(T=new mm(T,t,null,r,c),h.push({event:T,listeners:b}),A?T.data=A:(A=p0(r),A!==null&&(T.data=A)))),(A=pS?mS(t,r):gS(t,r))&&(u=jl(u,"onBeforeInput"),0<u.length&&(c=new mm("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:u}),c.data=A))}A0(h,e)})}function $o(t,e,r){return{instance:t,listener:e,currentTarget:r}}function jl(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Lo(t,r),s!=null&&n.unshift($o(t,s,i)),s=Lo(t,e),s!=null&&n.push($o(t,s,i))),t=t.return}return n}function Oi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Cm(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,u=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&u!==null&&(a=u,i?(l=Lo(r,s),l!=null&&o.unshift($o(r,l,a))):i||(l=Lo(r,s),l!=null&&o.push($o(r,l,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var IS=/\r\n?/g,kS=/\u0000|\uFFFD/g;function Rm(t){return(typeof t=="string"?t:""+t).replace(IS,`
`).replace(kS,"")}function Ia(t,e,r){if(e=Rm(e),Rm(t)!==e&&r)throw Error(L(425))}function Gl(){}var Qh=null,Jh=null;function ed(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var td=typeof setTimeout=="function"?setTimeout:void 0,MS=typeof clearTimeout=="function"?clearTimeout:void 0,Pm=typeof Promise=="function"?Promise:void 0,BS=typeof queueMicrotask=="function"?queueMicrotask:typeof Pm<"u"?function(t){return Pm.resolve(null).then(t).catch(NS)}:td;function NS(t){setTimeout(function(){throw t})}function bc(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),jo(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);jo(e)}function Nn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Im(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var zs=Math.random().toString(36).slice(2),Ir="__reactFiber$"+zs,Ho="__reactProps$"+zs,en="__reactContainer$"+zs,rd="__reactEvents$"+zs,FS="__reactListeners$"+zs,DS="__reactHandles$"+zs;function ci(t){var e=t[Ir];if(e)return e;for(var r=t.parentNode;r;){if(e=r[en]||r[Ir]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Im(t);t!==null;){if(r=t[Ir])return r;t=Im(t)}return e}t=r,r=t.parentNode}return null}function la(t){return t=t[Ir]||t[en],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function as(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function Pu(t){return t[Ho]||null}var nd=[],ls=-1;function Xn(t){return{current:t}}function ke(t){0>ls||(t.current=nd[ls],nd[ls]=null,ls--)}function Ce(t,e){ls++,nd[ls]=t.current,t.current=e}var zn={},gt=Xn(zn),It=Xn(!1),vi=zn;function ks(t,e){var r=t.type.contextTypes;if(!r)return zn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function kt(t){return t=t.childContextTypes,t!=null}function zl(){ke(It),ke(gt)}function km(t,e,r){if(gt.current!==zn)throw Error(L(168));Ce(gt,e),Ce(It,r)}function R0(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(L(108,_w(t)||"Unknown",i));return je({},r,n)}function Vl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zn,vi=gt.current,Ce(gt,t),Ce(It,It.current),!0}function Mm(t,e,r){var n=t.stateNode;if(!n)throw Error(L(169));r?(t=R0(t,e,vi),n.__reactInternalMemoizedMergedChildContext=t,ke(It),ke(gt),Ce(gt,t)):ke(It),Ce(It,r)}var $r=null,Iu=!1,Tc=!1;function P0(t){$r===null?$r=[t]:$r.push(t)}function LS(t){Iu=!0,P0(t)}function Yn(){if(!Tc&&$r!==null){Tc=!0;var t=0,e=we;try{var r=$r;for(we=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}$r=null,Iu=!1}catch(i){throw $r!==null&&($r=$r.slice(t+1)),e0(Df,Yn),i}finally{we=e,Tc=!1}}return null}var us=[],cs=0,$l=null,Hl=0,Ht=[],Wt=0,xi=null,Hr=1,Wr="";function ei(t,e){us[cs++]=Hl,us[cs++]=$l,$l=t,Hl=e}function I0(t,e,r){Ht[Wt++]=Hr,Ht[Wt++]=Wr,Ht[Wt++]=xi,xi=t;var n=Hr;t=Wr;var i=32-dr(n)-1;n&=~(1<<i),r+=1;var s=32-dr(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Hr=1<<32-dr(e)+i|r<<i|n,Wr=s+t}else Hr=1<<s|r<<i|n,Wr=t}function Hf(t){t.return!==null&&(ei(t,1),I0(t,1,0))}function Wf(t){for(;t===$l;)$l=us[--cs],us[cs]=null,Hl=us[--cs],us[cs]=null;for(;t===xi;)xi=Ht[--Wt],Ht[Wt]=null,Wr=Ht[--Wt],Ht[Wt]=null,Hr=Ht[--Wt],Ht[Wt]=null}var Ut=null,Dt=null,Ne=!1,cr=null;function k0(t,e){var r=Xt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Bm(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ut=t,Dt=Nn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ut=t,Dt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=xi!==null?{id:Hr,overflow:Wr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Xt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Ut=t,Dt=null,!0):!1;default:return!1}}function id(t){return(t.mode&1)!==0&&(t.flags&128)===0}function sd(t){if(Ne){var e=Dt;if(e){var r=e;if(!Bm(t,e)){if(id(t))throw Error(L(418));e=Nn(r.nextSibling);var n=Ut;e&&Bm(t,e)?k0(n,r):(t.flags=t.flags&-4097|2,Ne=!1,Ut=t)}}else{if(id(t))throw Error(L(418));t.flags=t.flags&-4097|2,Ne=!1,Ut=t}}}function Nm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ut=t}function ka(t){if(t!==Ut)return!1;if(!Ne)return Nm(t),Ne=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ed(t.type,t.memoizedProps)),e&&(e=Dt)){if(id(t))throw M0(),Error(L(418));for(;e;)k0(t,e),e=Nn(e.nextSibling)}if(Nm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Dt=Nn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Dt=null}}else Dt=Ut?Nn(t.stateNode.nextSibling):null;return!0}function M0(){for(var t=Dt;t;)t=Nn(t.nextSibling)}function Ms(){Dt=Ut=null,Ne=!1}function Xf(t){cr===null?cr=[t]:cr.push(t)}var OS=on.ReactCurrentBatchConfig;function Js(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(L(309));var n=r.stateNode}if(!n)throw Error(L(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(L(284));if(!r._owner)throw Error(L(290,t))}return t}function Ma(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Fm(t){var e=t._init;return e(t._payload)}function B0(t){function e(y,v){if(t){var p=y.deletions;p===null?(y.deletions=[v],y.flags|=16):p.push(v)}}function r(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function n(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function i(y,v){return y=On(y,v),y.index=0,y.sibling=null,y}function s(y,v,p){return y.index=p,t?(p=y.alternate,p!==null?(p=p.index,p<v?(y.flags|=2,v):p):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,v,p,_){return v===null||v.tag!==6?(v=Mc(p,y.mode,_),v.return=y,v):(v=i(v,p),v.return=y,v)}function l(y,v,p,_){var S=p.type;return S===ns?c(y,v,p.props.children,_,p.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===xn&&Fm(S)===v.type)?(_=i(v,p.props),_.ref=Js(y,v,p),_.return=y,_):(_=_l(p.type,p.key,p.props,null,y.mode,_),_.ref=Js(y,v,p),_.return=y,_)}function u(y,v,p,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==p.containerInfo||v.stateNode.implementation!==p.implementation?(v=Bc(p,y.mode,_),v.return=y,v):(v=i(v,p.children||[]),v.return=y,v)}function c(y,v,p,_,S){return v===null||v.tag!==7?(v=pi(p,y.mode,_,S),v.return=y,v):(v=i(v,p),v.return=y,v)}function h(y,v,p){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Mc(""+v,y.mode,p),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case wa:return p=_l(v.type,v.key,v.props,null,y.mode,p),p.ref=Js(y,null,v),p.return=y,p;case rs:return v=Bc(v,y.mode,p),v.return=y,v;case xn:var _=v._init;return h(y,_(v._payload),p)}if(lo(v)||Ys(v))return v=pi(v,y.mode,p,null),v.return=y,v;Ma(y,v)}return null}function d(y,v,p,_){var S=v!==null?v.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return S!==null?null:a(y,v,""+p,_);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case wa:return p.key===S?l(y,v,p,_):null;case rs:return p.key===S?u(y,v,p,_):null;case xn:return S=p._init,d(y,v,S(p._payload),_)}if(lo(p)||Ys(p))return S!==null?null:c(y,v,p,_,null);Ma(y,p)}return null}function m(y,v,p,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(p)||null,a(v,y,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case wa:return y=y.get(_.key===null?p:_.key)||null,l(v,y,_,S);case rs:return y=y.get(_.key===null?p:_.key)||null,u(v,y,_,S);case xn:var b=_._init;return m(y,v,p,b(_._payload),S)}if(lo(_)||Ys(_))return y=y.get(p)||null,c(v,y,_,S,null);Ma(v,_)}return null}function g(y,v,p,_){for(var S=null,b=null,A=v,T=v=0,M=null;A!==null&&T<p.length;T++){A.index>T?(M=A,A=null):M=A.sibling;var I=d(y,A,p[T],_);if(I===null){A===null&&(A=M);break}t&&A&&I.alternate===null&&e(y,A),v=s(I,v,T),b===null?S=I:b.sibling=I,b=I,A=M}if(T===p.length)return r(y,A),Ne&&ei(y,T),S;if(A===null){for(;T<p.length;T++)A=h(y,p[T],_),A!==null&&(v=s(A,v,T),b===null?S=A:b.sibling=A,b=A);return Ne&&ei(y,T),S}for(A=n(y,A);T<p.length;T++)M=m(A,y,T,p[T],_),M!==null&&(t&&M.alternate!==null&&A.delete(M.key===null?T:M.key),v=s(M,v,T),b===null?S=M:b.sibling=M,b=M);return t&&A.forEach(function(W){return e(y,W)}),Ne&&ei(y,T),S}function x(y,v,p,_){var S=Ys(p);if(typeof S!="function")throw Error(L(150));if(p=S.call(p),p==null)throw Error(L(151));for(var b=S=null,A=v,T=v=0,M=null,I=p.next();A!==null&&!I.done;T++,I=p.next()){A.index>T?(M=A,A=null):M=A.sibling;var W=d(y,A,I.value,_);if(W===null){A===null&&(A=M);break}t&&A&&W.alternate===null&&e(y,A),v=s(W,v,T),b===null?S=W:b.sibling=W,b=W,A=M}if(I.done)return r(y,A),Ne&&ei(y,T),S;if(A===null){for(;!I.done;T++,I=p.next())I=h(y,I.value,_),I!==null&&(v=s(I,v,T),b===null?S=I:b.sibling=I,b=I);return Ne&&ei(y,T),S}for(A=n(y,A);!I.done;T++,I=p.next())I=m(A,y,T,I.value,_),I!==null&&(t&&I.alternate!==null&&A.delete(I.key===null?T:I.key),v=s(I,v,T),b===null?S=I:b.sibling=I,b=I);return t&&A.forEach(function(G){return e(y,G)}),Ne&&ei(y,T),S}function w(y,v,p,_){if(typeof p=="object"&&p!==null&&p.type===ns&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case wa:e:{for(var S=p.key,b=v;b!==null;){if(b.key===S){if(S=p.type,S===ns){if(b.tag===7){r(y,b.sibling),v=i(b,p.props.children),v.return=y,y=v;break e}}else if(b.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===xn&&Fm(S)===b.type){r(y,b.sibling),v=i(b,p.props),v.ref=Js(y,b,p),v.return=y,y=v;break e}r(y,b);break}else e(y,b);b=b.sibling}p.type===ns?(v=pi(p.props.children,y.mode,_,p.key),v.return=y,y=v):(_=_l(p.type,p.key,p.props,null,y.mode,_),_.ref=Js(y,v,p),_.return=y,y=_)}return o(y);case rs:e:{for(b=p.key;v!==null;){if(v.key===b)if(v.tag===4&&v.stateNode.containerInfo===p.containerInfo&&v.stateNode.implementation===p.implementation){r(y,v.sibling),v=i(v,p.children||[]),v.return=y,y=v;break e}else{r(y,v);break}else e(y,v);v=v.sibling}v=Bc(p,y.mode,_),v.return=y,y=v}return o(y);case xn:return b=p._init,w(y,v,b(p._payload),_)}if(lo(p))return g(y,v,p,_);if(Ys(p))return x(y,v,p,_);Ma(y,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,v!==null&&v.tag===6?(r(y,v.sibling),v=i(v,p),v.return=y,y=v):(r(y,v),v=Mc(p,y.mode,_),v.return=y,y=v),o(y)):r(y,v)}return w}var Bs=B0(!0),N0=B0(!1),Wl=Xn(null),Xl=null,hs=null,Yf=null;function Kf(){Yf=hs=Xl=null}function qf(t){var e=Wl.current;ke(Wl),t._currentValue=e}function od(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function _s(t,e){Xl=t,Yf=hs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ct=!0),t.firstContext=null)}function Zt(t){var e=t._currentValue;if(Yf!==t)if(t={context:t,memoizedValue:e,next:null},hs===null){if(Xl===null)throw Error(L(308));hs=t,Xl.dependencies={lanes:0,firstContext:t}}else hs=hs.next=t;return e}var hi=null;function Zf(t){hi===null?hi=[t]:hi.push(t)}function F0(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Zf(e)):(r.next=i.next,i.next=r),e.interleaved=r,tn(t,n)}function tn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var _n=!1;function Qf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function D0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,ve&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,tn(t,r)}return i=n.interleaved,i===null?(e.next=e,Zf(n)):(e.next=i.next,i.next=e),n.interleaved=e,tn(t,r)}function pl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Lf(t,r)}}function Dm(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Yl(t,e,r,n){var i=t.updateQueue;_n=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,c=u=l=null,a=s;do{var d=a.lane,m=a.eventTime;if((n&d)===d){c!==null&&(c=c.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,x=a;switch(d=e,m=r,x.tag){case 1:if(g=x.payload,typeof g=="function"){h=g.call(m,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,d=typeof g=="function"?g.call(m,h,d):g,d==null)break e;h=je({},h,d);break e;case 2:_n=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else m={eventTime:m,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=m,l=h):c=c.next=m,o|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);wi|=o,t.lanes=o,t.memoizedState=h}}function Lm(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(L(191,i));i.call(n)}}}var ua={},Br=Xn(ua),Wo=Xn(ua),Xo=Xn(ua);function di(t){if(t===ua)throw Error(L(174));return t}function Jf(t,e){switch(Ce(Xo,e),Ce(Wo,t),Ce(Br,ua),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:jh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=jh(e,t)}ke(Br),Ce(Br,e)}function Ns(){ke(Br),ke(Wo),ke(Xo)}function L0(t){di(Xo.current);var e=di(Br.current),r=jh(e,t.type);e!==r&&(Ce(Wo,t),Ce(Br,r))}function ep(t){Wo.current===t&&(ke(Br),ke(Wo))}var Le=Xn(0);function Kl(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ac=[];function tp(){for(var t=0;t<Ac.length;t++)Ac[t]._workInProgressVersionPrimary=null;Ac.length=0}var ml=on.ReactCurrentDispatcher,Cc=on.ReactCurrentBatchConfig,_i=0,Ue=null,Ze=null,tt=null,ql=!1,Ao=!1,Yo=0,US=0;function ft(){throw Error(L(321))}function rp(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!gr(t[r],e[r]))return!1;return!0}function np(t,e,r,n,i,s){if(_i=s,Ue=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ml.current=t===null||t.memoizedState===null?VS:$S,t=r(n,i),Ao){s=0;do{if(Ao=!1,Yo=0,25<=s)throw Error(L(301));s+=1,tt=Ze=null,e.updateQueue=null,ml.current=HS,t=r(n,i)}while(Ao)}if(ml.current=Zl,e=Ze!==null&&Ze.next!==null,_i=0,tt=Ze=Ue=null,ql=!1,e)throw Error(L(300));return t}function ip(){var t=Yo!==0;return Yo=0,t}function Ar(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tt===null?Ue.memoizedState=tt=t:tt=tt.next=t,tt}function Qt(){if(Ze===null){var t=Ue.alternate;t=t!==null?t.memoizedState:null}else t=Ze.next;var e=tt===null?Ue.memoizedState:tt.next;if(e!==null)tt=e,Ze=t;else{if(t===null)throw Error(L(310));Ze=t,t={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},tt===null?Ue.memoizedState=tt=t:tt=tt.next=t}return tt}function Ko(t,e){return typeof e=="function"?e(t):e}function Rc(t){var e=Qt(),r=e.queue;if(r===null)throw Error(L(311));r.lastRenderedReducer=t;var n=Ze,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((_i&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,Ue.lanes|=c,wi|=c}u=u.next}while(u!==null&&u!==s);l===null?o=n:l.next=a,gr(n,e.memoizedState)||(Ct=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Ue.lanes|=s,wi|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Pc(t){var e=Qt(),r=e.queue;if(r===null)throw Error(L(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);gr(s,e.memoizedState)||(Ct=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function O0(){}function U0(t,e){var r=Ue,n=Qt(),i=e(),s=!gr(n.memoizedState,i);if(s&&(n.memoizedState=i,Ct=!0),n=n.queue,sp(z0.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||tt!==null&&tt.memoizedState.tag&1){if(r.flags|=2048,qo(9,G0.bind(null,r,n,i,e),void 0,null),nt===null)throw Error(L(349));_i&30||j0(r,e,i)}return i}function j0(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function G0(t,e,r,n){e.value=r,e.getSnapshot=n,V0(e)&&$0(t)}function z0(t,e,r){return r(function(){V0(e)&&$0(t)})}function V0(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!gr(t,r)}catch{return!0}}function $0(t){var e=tn(t,1);e!==null&&fr(e,t,1,-1)}function Om(t){var e=Ar();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ko,lastRenderedState:t},e.queue=t,t=t.dispatch=zS.bind(null,Ue,t),[e.memoizedState,t]}function qo(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function H0(){return Qt().memoizedState}function gl(t,e,r,n){var i=Ar();Ue.flags|=t,i.memoizedState=qo(1|e,r,void 0,n===void 0?null:n)}function ku(t,e,r,n){var i=Qt();n=n===void 0?null:n;var s=void 0;if(Ze!==null){var o=Ze.memoizedState;if(s=o.destroy,n!==null&&rp(n,o.deps)){i.memoizedState=qo(e,r,s,n);return}}Ue.flags|=t,i.memoizedState=qo(1|e,r,s,n)}function Um(t,e){return gl(8390656,8,t,e)}function sp(t,e){return ku(2048,8,t,e)}function W0(t,e){return ku(4,2,t,e)}function X0(t,e){return ku(4,4,t,e)}function Y0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function K0(t,e,r){return r=r!=null?r.concat([t]):null,ku(4,4,Y0.bind(null,e,t),r)}function op(){}function q0(t,e){var r=Qt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&rp(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Z0(t,e){var r=Qt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&rp(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Q0(t,e,r){return _i&21?(gr(r,e)||(r=n0(),Ue.lanes|=r,wi|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ct=!0),t.memoizedState=r)}function jS(t,e){var r=we;we=r!==0&&4>r?r:4,t(!0);var n=Cc.transition;Cc.transition={};try{t(!1),e()}finally{we=r,Cc.transition=n}}function J0(){return Qt().memoizedState}function GS(t,e,r){var n=Ln(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ex(t))tx(e,r);else if(r=F0(t,e,r,n),r!==null){var i=wt();fr(r,t,n,i),rx(r,e,n)}}function zS(t,e,r){var n=Ln(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ex(t))tx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,gr(a,o)){var l=e.interleaved;l===null?(i.next=i,Zf(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=F0(t,e,i,n),r!==null&&(i=wt(),fr(r,t,n,i),rx(r,e,n))}}function ex(t){var e=t.alternate;return t===Ue||e!==null&&e===Ue}function tx(t,e){Ao=ql=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function rx(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Lf(t,r)}}var Zl={readContext:Zt,useCallback:ft,useContext:ft,useEffect:ft,useImperativeHandle:ft,useInsertionEffect:ft,useLayoutEffect:ft,useMemo:ft,useReducer:ft,useRef:ft,useState:ft,useDebugValue:ft,useDeferredValue:ft,useTransition:ft,useMutableSource:ft,useSyncExternalStore:ft,useId:ft,unstable_isNewReconciler:!1},VS={readContext:Zt,useCallback:function(t,e){return Ar().memoizedState=[t,e===void 0?null:e],t},useContext:Zt,useEffect:Um,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,gl(4194308,4,Y0.bind(null,e,t),r)},useLayoutEffect:function(t,e){return gl(4194308,4,t,e)},useInsertionEffect:function(t,e){return gl(4,2,t,e)},useMemo:function(t,e){var r=Ar();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Ar();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=GS.bind(null,Ue,t),[n.memoizedState,t]},useRef:function(t){var e=Ar();return t={current:t},e.memoizedState=t},useState:Om,useDebugValue:op,useDeferredValue:function(t){return Ar().memoizedState=t},useTransition:function(){var t=Om(!1),e=t[0];return t=jS.bind(null,t[1]),Ar().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ue,i=Ar();if(Ne){if(r===void 0)throw Error(L(407));r=r()}else{if(r=e(),nt===null)throw Error(L(349));_i&30||j0(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Um(z0.bind(null,n,s,t),[t]),n.flags|=2048,qo(9,G0.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Ar(),e=nt.identifierPrefix;if(Ne){var r=Wr,n=Hr;r=(n&~(1<<32-dr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Yo++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=US++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$S={readContext:Zt,useCallback:q0,useContext:Zt,useEffect:sp,useImperativeHandle:K0,useInsertionEffect:W0,useLayoutEffect:X0,useMemo:Z0,useReducer:Rc,useRef:H0,useState:function(){return Rc(Ko)},useDebugValue:op,useDeferredValue:function(t){var e=Qt();return Q0(e,Ze.memoizedState,t)},useTransition:function(){var t=Rc(Ko)[0],e=Qt().memoizedState;return[t,e]},useMutableSource:O0,useSyncExternalStore:U0,useId:J0,unstable_isNewReconciler:!1},HS={readContext:Zt,useCallback:q0,useContext:Zt,useEffect:sp,useImperativeHandle:K0,useInsertionEffect:W0,useLayoutEffect:X0,useMemo:Z0,useReducer:Pc,useRef:H0,useState:function(){return Pc(Ko)},useDebugValue:op,useDeferredValue:function(t){var e=Qt();return Ze===null?e.memoizedState=t:Q0(e,Ze.memoizedState,t)},useTransition:function(){var t=Pc(Ko)[0],e=Qt().memoizedState;return[t,e]},useMutableSource:O0,useSyncExternalStore:U0,useId:J0,unstable_isNewReconciler:!1};function lr(t,e){if(t&&t.defaultProps){e=je({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function ad(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:je({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Mu={isMounted:function(t){return(t=t._reactInternals)?Ri(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=wt(),i=Ln(t),s=Zr(n,i);s.payload=e,r!=null&&(s.callback=r),e=Fn(t,s,i),e!==null&&(fr(e,t,i,n),pl(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=wt(),i=Ln(t),s=Zr(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Fn(t,s,i),e!==null&&(fr(e,t,i,n),pl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=wt(),n=Ln(t),i=Zr(r,n);i.tag=2,e!=null&&(i.callback=e),e=Fn(t,i,n),e!==null&&(fr(e,t,n,r),pl(e,t,n))}};function jm(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!zo(r,n)||!zo(i,s):!0}function nx(t,e,r){var n=!1,i=zn,s=e.contextType;return typeof s=="object"&&s!==null?s=Zt(s):(i=kt(e)?vi:gt.current,n=e.contextTypes,s=(n=n!=null)?ks(t,i):zn),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Mu,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Gm(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Mu.enqueueReplaceState(e,e.state,null)}function ld(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Qf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Zt(s):(s=kt(e)?vi:gt.current,i.context=ks(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ad(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Mu.enqueueReplaceState(i,i.state,null),Yl(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Fs(t,e){try{var r="",n=e;do r+=xw(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ic(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function ud(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var WS=typeof WeakMap=="function"?WeakMap:Map;function ix(t,e,r){r=Zr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Jl||(Jl=!0,xd=n),ud(t,e)},r}function sx(t,e,r){r=Zr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){ud(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){ud(t,e),typeof n!="function"&&(Dn===null?Dn=new Set([this]):Dn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function zm(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new WS;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=oE.bind(null,t,e,r),e.then(t,t))}function Vm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function $m(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Zr(-1,1),e.tag=2,Fn(r,e,1))),r.lanes|=1),t)}var XS=on.ReactCurrentOwner,Ct=!1;function xt(t,e,r,n){e.child=t===null?N0(e,null,r,n):Bs(e,t.child,r,n)}function Hm(t,e,r,n,i){r=r.render;var s=e.ref;return _s(e,i),n=np(t,e,r,n,s,i),r=ip(),t!==null&&!Ct?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rn(t,e,i)):(Ne&&r&&Hf(e),e.flags|=1,xt(t,e,n,i),e.child)}function Wm(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!pp(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,ox(t,e,s,n,i)):(t=_l(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:zo,r(o,n)&&t.ref===e.ref)return rn(t,e,i)}return e.flags|=1,t=On(s,n),t.ref=e.ref,t.return=e,e.child=t}function ox(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(zo(s,n)&&t.ref===e.ref)if(Ct=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Ct=!0);else return e.lanes=t.lanes,rn(t,e,i)}return cd(t,e,r,n,i)}function ax(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(fs,Ft),Ft|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ce(fs,Ft),Ft|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Ce(fs,Ft),Ft|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Ce(fs,Ft),Ft|=n;return xt(t,e,i,r),e.child}function lx(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function cd(t,e,r,n,i){var s=kt(r)?vi:gt.current;return s=ks(e,s),_s(e,i),r=np(t,e,r,n,s,i),n=ip(),t!==null&&!Ct?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rn(t,e,i)):(Ne&&n&&Hf(e),e.flags|=1,xt(t,e,r,i),e.child)}function Xm(t,e,r,n,i){if(kt(r)){var s=!0;Vl(e)}else s=!1;if(_s(e,i),e.stateNode===null)yl(t,e),nx(e,r,n),ld(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Zt(u):(u=kt(r)?vi:gt.current,u=ks(e,u));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==u)&&Gm(e,o,n,u),_n=!1;var d=e.memoizedState;o.state=d,Yl(e,n,o,i),l=e.memoizedState,a!==n||d!==l||It.current||_n?(typeof c=="function"&&(ad(e,r,c,n),l=e.memoizedState),(a=_n||jm(e,r,a,n,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,D0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:lr(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=Zt(l):(l=kt(r)?vi:gt.current,l=ks(e,l));var m=r.getDerivedStateFromProps;(c=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&Gm(e,o,n,l),_n=!1,d=e.memoizedState,o.state=d,Yl(e,n,o,i);var g=e.memoizedState;a!==h||d!==g||It.current||_n?(typeof m=="function"&&(ad(e,r,m,n),g=e.memoizedState),(u=_n||jm(e,r,u,n,d,g,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),o.props=n,o.state=g,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return hd(t,e,r,n,s,i)}function hd(t,e,r,n,i,s){lx(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Mm(e,r,!1),rn(t,e,s);n=e.stateNode,XS.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Bs(e,t.child,null,s),e.child=Bs(e,null,a,s)):xt(t,e,a,s),e.memoizedState=n.state,i&&Mm(e,r,!0),e.child}function ux(t){var e=t.stateNode;e.pendingContext?km(t,e.pendingContext,e.pendingContext!==e.context):e.context&&km(t,e.context,!1),Jf(t,e.containerInfo)}function Ym(t,e,r,n,i){return Ms(),Xf(i),e.flags|=256,xt(t,e,r,n),e.child}var dd={dehydrated:null,treeContext:null,retryLane:0};function fd(t){return{baseLanes:t,cachePool:null,transitions:null}}function cx(t,e,r){var n=e.pendingProps,i=Le.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ce(Le,i&1),t===null)return sd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Fu(o,n,0,null),t=pi(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=fd(r),e.memoizedState=dd,t):ap(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return YS(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=On(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=On(a,s):(s=pi(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?fd(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=dd,n}return s=t.child,t=s.sibling,n=On(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function ap(t,e){return e=Fu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ba(t,e,r,n){return n!==null&&Xf(n),Bs(e,t.child,null,r),t=ap(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function YS(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=Ic(Error(L(422))),Ba(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Fu({mode:"visible",children:n.children},i,0,null),s=pi(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Bs(e,t.child,null,o),e.child.memoizedState=fd(o),e.memoizedState=dd,s);if(!(e.mode&1))return Ba(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(L(419)),n=Ic(s,n,void 0),Ba(t,e,o,n)}if(a=(o&t.childLanes)!==0,Ct||a){if(n=nt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,tn(t,i),fr(n,t,i,-1))}return fp(),n=Ic(Error(L(421))),Ba(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=aE.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Dt=Nn(i.nextSibling),Ut=e,Ne=!0,cr=null,t!==null&&(Ht[Wt++]=Hr,Ht[Wt++]=Wr,Ht[Wt++]=xi,Hr=t.id,Wr=t.overflow,xi=e),e=ap(e,n.children),e.flags|=4096,e)}function Km(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),od(t.return,e,r)}function kc(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function hx(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(xt(t,e,n.children,r),n=Le.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Km(t,r,e);else if(t.tag===19)Km(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ce(Le,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Kl(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),kc(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Kl(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}kc(e,!0,r,null,s);break;case"together":kc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function rn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),wi|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,r=On(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=On(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function KS(t,e,r){switch(e.tag){case 3:ux(e),Ms();break;case 5:L0(e);break;case 1:kt(e.type)&&Vl(e);break;case 4:Jf(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Ce(Wl,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ce(Le,Le.current&1),e.flags|=128,null):r&e.child.childLanes?cx(t,e,r):(Ce(Le,Le.current&1),t=rn(t,e,r),t!==null?t.sibling:null);Ce(Le,Le.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return hx(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ce(Le,Le.current),n)break;return null;case 22:case 23:return e.lanes=0,ax(t,e,r)}return rn(t,e,r)}var dx,pd,fx,px;dx=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};pd=function(){};fx=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,di(Br.current);var s=null;switch(r){case"input":i=Dh(t,i),n=Dh(t,n),s=[];break;case"select":i=je({},i,{value:void 0}),n=je({},n,{value:void 0}),s=[];break;case"textarea":i=Uh(t,i),n=Uh(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Gl)}Gh(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Fo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(a=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Fo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Pe("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};px=function(t,e,r,n){r!==n&&(e.flags|=4)};function eo(t,e){if(!Ne)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function pt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function qS(t,e,r){var n=e.pendingProps;switch(Wf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(e),null;case 1:return kt(e.type)&&zl(),pt(e),null;case 3:return n=e.stateNode,Ns(),ke(It),ke(gt),tp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(ka(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cr!==null&&(Sd(cr),cr=null))),pd(t,e),pt(e),null;case 5:ep(e);var i=di(Xo.current);if(r=e.type,t!==null&&e.stateNode!=null)fx(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(L(166));return pt(e),null}if(t=di(Br.current),ka(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Ir]=e,n[Ho]=s,t=(e.mode&1)!==0,r){case"dialog":Pe("cancel",n),Pe("close",n);break;case"iframe":case"object":case"embed":Pe("load",n);break;case"video":case"audio":for(i=0;i<co.length;i++)Pe(co[i],n);break;case"source":Pe("error",n);break;case"img":case"image":case"link":Pe("error",n),Pe("load",n);break;case"details":Pe("toggle",n);break;case"input":im(n,s),Pe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Pe("invalid",n);break;case"textarea":om(n,s),Pe("invalid",n)}Gh(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ia(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ia(n.textContent,a,t),i=["children",""+a]):Fo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Pe("scroll",n)}switch(r){case"input":Sa(n),sm(n,s,!0);break;case"textarea":Sa(n),am(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Gl)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zv(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Ir]=e,t[Ho]=n,dx(t,e,!1,!1),e.stateNode=t;e:{switch(o=zh(r,n),r){case"dialog":Pe("cancel",t),Pe("close",t),i=n;break;case"iframe":case"object":case"embed":Pe("load",t),i=n;break;case"video":case"audio":for(i=0;i<co.length;i++)Pe(co[i],t);i=n;break;case"source":Pe("error",t),i=n;break;case"img":case"image":case"link":Pe("error",t),Pe("load",t),i=n;break;case"details":Pe("toggle",t),i=n;break;case"input":im(t,n),i=Dh(t,n),Pe("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=je({},n,{value:void 0}),Pe("invalid",t);break;case"textarea":om(t,n),i=Uh(t,n),Pe("invalid",t);break;default:i=n}Gh(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Hv(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Vv(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Do(t,l):typeof l=="number"&&Do(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Fo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Pe("scroll",t):l!=null&&kf(t,s,l,o))}switch(r){case"input":Sa(t),sm(t,n,!1);break;case"textarea":Sa(t),am(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Gn(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?gs(t,!!n.multiple,s,!1):n.defaultValue!=null&&gs(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Gl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return pt(e),null;case 6:if(t&&e.stateNode!=null)px(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(L(166));if(r=di(Xo.current),di(Br.current),ka(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ir]=e,(s=n.nodeValue!==r)&&(t=Ut,t!==null))switch(t.tag){case 3:Ia(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ia(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ir]=e,e.stateNode=n}return pt(e),null;case 13:if(ke(Le),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ne&&Dt!==null&&e.mode&1&&!(e.flags&128))M0(),Ms(),e.flags|=98560,s=!1;else if(s=ka(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(L(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(L(317));s[Ir]=e}else Ms(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pt(e),s=!1}else cr!==null&&(Sd(cr),cr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Le.current&1?Qe===0&&(Qe=3):fp())),e.updateQueue!==null&&(e.flags|=4),pt(e),null);case 4:return Ns(),pd(t,e),t===null&&Vo(e.stateNode.containerInfo),pt(e),null;case 10:return qf(e.type._context),pt(e),null;case 17:return kt(e.type)&&zl(),pt(e),null;case 19:if(ke(Le),s=e.memoizedState,s===null)return pt(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)eo(s,!1);else{if(Qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Kl(t),o!==null){for(e.flags|=128,eo(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Ce(Le,Le.current&1|2),e.child}t=t.sibling}s.tail!==null&&He()>Ds&&(e.flags|=128,n=!0,eo(s,!1),e.lanes=4194304)}else{if(!n)if(t=Kl(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),eo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ne)return pt(e),null}else 2*He()-s.renderingStartTime>Ds&&r!==1073741824&&(e.flags|=128,n=!0,eo(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=He(),e.sibling=null,r=Le.current,Ce(Le,n?r&1|2:r&1),e):(pt(e),null);case 22:case 23:return dp(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ft&1073741824&&(pt(e),e.subtreeFlags&6&&(e.flags|=8192)):pt(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function ZS(t,e){switch(Wf(e),e.tag){case 1:return kt(e.type)&&zl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ns(),ke(It),ke(gt),tp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ep(e),null;case 13:if(ke(Le),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));Ms()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ke(Le),null;case 4:return Ns(),null;case 10:return qf(e.type._context),null;case 22:case 23:return dp(),null;case 24:return null;default:return null}}var Na=!1,mt=!1,QS=typeof WeakSet=="function"?WeakSet:Set,X=null;function ds(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ve(t,e,n)}else r.current=null}function md(t,e,r){try{r()}catch(n){Ve(t,e,n)}}var qm=!1;function JS(t,e){if(Qh=Ol,t=x0(),$f(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(a=o+i),h!==s||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++u===i&&(a=o),d===s&&++c===n&&(l=o),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Jh={focusedElem:t,selectionRange:r},Ol=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,w=g.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:lr(e.type,x),w);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var p=e.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(_){Ve(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return g=qm,qm=!1,g}function Co(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&md(e,r,s)}i=i.next}while(i!==n)}}function Bu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function gd(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function mx(t){var e=t.alternate;e!==null&&(t.alternate=null,mx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ir],delete e[Ho],delete e[rd],delete e[FS],delete e[DS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function gx(t){return t.tag===5||t.tag===3||t.tag===4}function Zm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Gl));else if(n!==4&&(t=t.child,t!==null))for(yd(t,e,r),t=t.sibling;t!==null;)yd(t,e,r),t=t.sibling}function vd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(vd(t,e,r),t=t.sibling;t!==null;)vd(t,e,r),t=t.sibling}var ot=null,ur=!1;function fn(t,e,r){for(r=r.child;r!==null;)yx(t,e,r),r=r.sibling}function yx(t,e,r){if(Mr&&typeof Mr.onCommitFiberUnmount=="function")try{Mr.onCommitFiberUnmount(Tu,r)}catch{}switch(r.tag){case 5:mt||ds(r,e);case 6:var n=ot,i=ur;ot=null,fn(t,e,r),ot=n,ur=i,ot!==null&&(ur?(t=ot,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ot.removeChild(r.stateNode));break;case 18:ot!==null&&(ur?(t=ot,r=r.stateNode,t.nodeType===8?bc(t.parentNode,r):t.nodeType===1&&bc(t,r),jo(t)):bc(ot,r.stateNode));break;case 4:n=ot,i=ur,ot=r.stateNode.containerInfo,ur=!0,fn(t,e,r),ot=n,ur=i;break;case 0:case 11:case 14:case 15:if(!mt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&md(r,e,o),i=i.next}while(i!==n)}fn(t,e,r);break;case 1:if(!mt&&(ds(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Ve(r,e,a)}fn(t,e,r);break;case 21:fn(t,e,r);break;case 22:r.mode&1?(mt=(n=mt)||r.memoizedState!==null,fn(t,e,r),mt=n):fn(t,e,r);break;default:fn(t,e,r)}}function Qm(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new QS),e.forEach(function(n){var i=lE.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function rr(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ot=a.stateNode,ur=!1;break e;case 3:ot=a.stateNode.containerInfo,ur=!0;break e;case 4:ot=a.stateNode.containerInfo,ur=!0;break e}a=a.return}if(ot===null)throw Error(L(160));yx(s,o,i),ot=null,ur=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Ve(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vx(e,t),e=e.sibling}function vx(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rr(e,t),xr(t),n&4){try{Co(3,t,t.return),Bu(3,t)}catch(x){Ve(t,t.return,x)}try{Co(5,t,t.return)}catch(x){Ve(t,t.return,x)}}break;case 1:rr(e,t),xr(t),n&512&&r!==null&&ds(r,r.return);break;case 5:if(rr(e,t),xr(t),n&512&&r!==null&&ds(r,r.return),t.flags&32){var i=t.stateNode;try{Do(i,"")}catch(x){Ve(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&jv(i,s),zh(a,o);var u=zh(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?Hv(i,h):c==="dangerouslySetInnerHTML"?Vv(i,h):c==="children"?Do(i,h):kf(i,c,h,u)}switch(a){case"input":Lh(i,s);break;case"textarea":Gv(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?gs(i,!!s.multiple,m,!1):d!==!!s.multiple&&(s.defaultValue!=null?gs(i,!!s.multiple,s.defaultValue,!0):gs(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ho]=s}catch(x){Ve(t,t.return,x)}}break;case 6:if(rr(e,t),xr(t),n&4){if(t.stateNode===null)throw Error(L(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Ve(t,t.return,x)}}break;case 3:if(rr(e,t),xr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{jo(e.containerInfo)}catch(x){Ve(t,t.return,x)}break;case 4:rr(e,t),xr(t);break;case 13:rr(e,t),xr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(cp=He())),n&4&&Qm(t);break;case 22:if(c=r!==null&&r.memoizedState!==null,t.mode&1?(mt=(u=mt)||c,rr(e,t),mt=u):rr(e,t),xr(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(X=t,c=t.child;c!==null;){for(h=X=c;X!==null;){switch(d=X,m=d.child,d.tag){case 0:case 11:case 14:case 15:Co(4,d,d.return);break;case 1:ds(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){Ve(n,r,x)}}break;case 5:ds(d,d.return);break;case 22:if(d.memoizedState!==null){eg(h);continue}}m!==null?(m.return=d,X=m):eg(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=$v("display",o))}catch(x){Ve(t,t.return,x)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Ve(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:rr(e,t),xr(t),n&4&&Qm(t);break;case 21:break;default:rr(e,t),xr(t)}}function xr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(gx(r)){var n=r;break e}r=r.return}throw Error(L(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Do(i,""),n.flags&=-33);var s=Zm(t);vd(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=Zm(t);yd(t,a,o);break;default:throw Error(L(161))}}catch(l){Ve(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function eE(t,e,r){X=t,xx(t)}function xx(t,e,r){for(var n=(t.mode&1)!==0;X!==null;){var i=X,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Na;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||mt;a=Na;var u=mt;if(Na=o,(mt=l)&&!u)for(X=i;X!==null;)o=X,l=o.child,o.tag===22&&o.memoizedState!==null?tg(i):l!==null?(l.return=o,X=l):tg(i);for(;s!==null;)X=s,xx(s),s=s.sibling;X=i,Na=a,mt=u}Jm(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,X=s):Jm(t)}}function Jm(t){for(;X!==null;){var e=X;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:mt||Bu(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!mt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:lr(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Lm(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Lm(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&jo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}mt||e.flags&512&&gd(e)}catch(d){Ve(e,e.return,d)}}if(e===t){X=null;break}if(r=e.sibling,r!==null){r.return=e.return,X=r;break}X=e.return}}function eg(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var r=e.sibling;if(r!==null){r.return=e.return,X=r;break}X=e.return}}function tg(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Bu(4,e)}catch(l){Ve(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Ve(e,i,l)}}var s=e.return;try{gd(e)}catch(l){Ve(e,s,l)}break;case 5:var o=e.return;try{gd(e)}catch(l){Ve(e,o,l)}}}catch(l){Ve(e,e.return,l)}if(e===t){X=null;break}var a=e.sibling;if(a!==null){a.return=e.return,X=a;break}X=e.return}}var tE=Math.ceil,Ql=on.ReactCurrentDispatcher,lp=on.ReactCurrentOwner,qt=on.ReactCurrentBatchConfig,ve=0,nt=null,Xe=null,lt=0,Ft=0,fs=Xn(0),Qe=0,Zo=null,wi=0,Nu=0,up=0,Ro=null,At=null,cp=0,Ds=1/0,zr=null,Jl=!1,xd=null,Dn=null,Fa=!1,An=null,eu=0,Po=0,_d=null,vl=-1,xl=0;function wt(){return ve&6?He():vl!==-1?vl:vl=He()}function Ln(t){return t.mode&1?ve&2&&lt!==0?lt&-lt:OS.transition!==null?(xl===0&&(xl=n0()),xl):(t=we,t!==0||(t=window.event,t=t===void 0?16:c0(t.type)),t):1}function fr(t,e,r,n){if(50<Po)throw Po=0,_d=null,Error(L(185));oa(t,r,n),(!(ve&2)||t!==nt)&&(t===nt&&(!(ve&2)&&(Nu|=r),Qe===4&&En(t,lt)),Mt(t,n),r===1&&ve===0&&!(e.mode&1)&&(Ds=He()+500,Iu&&Yn()))}function Mt(t,e){var r=t.callbackNode;Ow(t,e);var n=Ll(t,t===nt?lt:0);if(n===0)r!==null&&cm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&cm(r),e===1)t.tag===0?LS(rg.bind(null,t)):P0(rg.bind(null,t)),BS(function(){!(ve&6)&&Yn()}),r=null;else{switch(i0(n)){case 1:r=Df;break;case 4:r=t0;break;case 16:r=Dl;break;case 536870912:r=r0;break;default:r=Dl}r=Cx(r,_x.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function _x(t,e){if(vl=-1,xl=0,ve&6)throw Error(L(327));var r=t.callbackNode;if(ws()&&t.callbackNode!==r)return null;var n=Ll(t,t===nt?lt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=tu(t,n);else{e=n;var i=ve;ve|=2;var s=Sx();(nt!==t||lt!==e)&&(zr=null,Ds=He()+500,fi(t,e));do try{iE();break}catch(a){wx(t,a)}while(!0);Kf(),Ql.current=s,ve=i,Xe!==null?e=0:(nt=null,lt=0,e=Qe)}if(e!==0){if(e===2&&(i=Xh(t),i!==0&&(n=i,e=wd(t,i))),e===1)throw r=Zo,fi(t,0),En(t,n),Mt(t,He()),r;if(e===6)En(t,n);else{if(i=t.current.alternate,!(n&30)&&!rE(i)&&(e=tu(t,n),e===2&&(s=Xh(t),s!==0&&(n=s,e=wd(t,s))),e===1))throw r=Zo,fi(t,0),En(t,n),Mt(t,He()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(L(345));case 2:ti(t,At,zr);break;case 3:if(En(t,n),(n&130023424)===n&&(e=cp+500-He(),10<e)){if(Ll(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){wt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=td(ti.bind(null,t,At,zr),e);break}ti(t,At,zr);break;case 4:if(En(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-dr(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=He()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*tE(n/1960))-n,10<n){t.timeoutHandle=td(ti.bind(null,t,At,zr),n);break}ti(t,At,zr);break;case 5:ti(t,At,zr);break;default:throw Error(L(329))}}}return Mt(t,He()),t.callbackNode===r?_x.bind(null,t):null}function wd(t,e){var r=Ro;return t.current.memoizedState.isDehydrated&&(fi(t,e).flags|=256),t=tu(t,e),t!==2&&(e=At,At=r,e!==null&&Sd(e)),t}function Sd(t){At===null?At=t:At.push.apply(At,t)}function rE(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!gr(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function En(t,e){for(e&=~up,e&=~Nu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-dr(e),n=1<<r;t[r]=-1,e&=~n}}function rg(t){if(ve&6)throw Error(L(327));ws();var e=Ll(t,0);if(!(e&1))return Mt(t,He()),null;var r=tu(t,e);if(t.tag!==0&&r===2){var n=Xh(t);n!==0&&(e=n,r=wd(t,n))}if(r===1)throw r=Zo,fi(t,0),En(t,e),Mt(t,He()),r;if(r===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ti(t,At,zr),Mt(t,He()),null}function hp(t,e){var r=ve;ve|=1;try{return t(e)}finally{ve=r,ve===0&&(Ds=He()+500,Iu&&Yn())}}function Si(t){An!==null&&An.tag===0&&!(ve&6)&&ws();var e=ve;ve|=1;var r=qt.transition,n=we;try{if(qt.transition=null,we=1,t)return t()}finally{we=n,qt.transition=r,ve=e,!(ve&6)&&Yn()}}function dp(){Ft=fs.current,ke(fs)}function fi(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,MS(r)),Xe!==null)for(r=Xe.return;r!==null;){var n=r;switch(Wf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&zl();break;case 3:Ns(),ke(It),ke(gt),tp();break;case 5:ep(n);break;case 4:Ns();break;case 13:ke(Le);break;case 19:ke(Le);break;case 10:qf(n.type._context);break;case 22:case 23:dp()}r=r.return}if(nt=t,Xe=t=On(t.current,null),lt=Ft=e,Qe=0,Zo=null,up=Nu=wi=0,At=Ro=null,hi!==null){for(e=0;e<hi.length;e++)if(r=hi[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}hi=null}return t}function wx(t,e){do{var r=Xe;try{if(Kf(),ml.current=Zl,ql){for(var n=Ue.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}ql=!1}if(_i=0,tt=Ze=Ue=null,Ao=!1,Yo=0,lp.current=null,r===null||r.return===null){Qe=1,Zo=e,Xe=null;break}e:{var s=t,o=r.return,a=r,l=e;if(e=lt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=Vm(o);if(m!==null){m.flags&=-257,$m(m,o,a,s,e),m.mode&1&&zm(s,u,e),e=m,l=u;var g=e.updateQueue;if(g===null){var x=new Set;x.add(l),e.updateQueue=x}else g.add(l);break e}else{if(!(e&1)){zm(s,u,e),fp();break e}l=Error(L(426))}}else if(Ne&&a.mode&1){var w=Vm(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),$m(w,o,a,s,e),Xf(Fs(l,a));break e}}s=l=Fs(l,a),Qe!==4&&(Qe=2),Ro===null?Ro=[s]:Ro.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=ix(s,l,e);Dm(s,y);break e;case 1:a=l;var v=s.type,p=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Dn===null||!Dn.has(p)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=sx(s,a,e);Dm(s,_);break e}}s=s.return}while(s!==null)}bx(r)}catch(S){e=S,Xe===r&&r!==null&&(Xe=r=r.return);continue}break}while(!0)}function Sx(){var t=Ql.current;return Ql.current=Zl,t===null?Zl:t}function fp(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),nt===null||!(wi&268435455)&&!(Nu&268435455)||En(nt,lt)}function tu(t,e){var r=ve;ve|=2;var n=Sx();(nt!==t||lt!==e)&&(zr=null,fi(t,e));do try{nE();break}catch(i){wx(t,i)}while(!0);if(Kf(),ve=r,Ql.current=n,Xe!==null)throw Error(L(261));return nt=null,lt=0,Qe}function nE(){for(;Xe!==null;)Ex(Xe)}function iE(){for(;Xe!==null&&!Pw();)Ex(Xe)}function Ex(t){var e=Ax(t.alternate,t,Ft);t.memoizedProps=t.pendingProps,e===null?bx(t):Xe=e,lp.current=null}function bx(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=ZS(r,e),r!==null){r.flags&=32767,Xe=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qe=6,Xe=null;return}}else if(r=qS(r,e,Ft),r!==null){Xe=r;return}if(e=e.sibling,e!==null){Xe=e;return}Xe=e=t}while(e!==null);Qe===0&&(Qe=5)}function ti(t,e,r){var n=we,i=qt.transition;try{qt.transition=null,we=1,sE(t,e,r,n)}finally{qt.transition=i,we=n}return null}function sE(t,e,r,n){do ws();while(An!==null);if(ve&6)throw Error(L(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Uw(t,s),t===nt&&(Xe=nt=null,lt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Fa||(Fa=!0,Cx(Dl,function(){return ws(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=qt.transition,qt.transition=null;var o=we;we=1;var a=ve;ve|=4,lp.current=null,JS(t,r),vx(r,t),TS(Jh),Ol=!!Qh,Jh=Qh=null,t.current=r,eE(r),Iw(),ve=a,we=o,qt.transition=s}else t.current=r;if(Fa&&(Fa=!1,An=t,eu=i),s=t.pendingLanes,s===0&&(Dn=null),Bw(r.stateNode),Mt(t,He()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Jl)throw Jl=!1,t=xd,xd=null,t;return eu&1&&t.tag!==0&&ws(),s=t.pendingLanes,s&1?t===_d?Po++:(Po=0,_d=t):Po=0,Yn(),null}function ws(){if(An!==null){var t=i0(eu),e=qt.transition,r=we;try{if(qt.transition=null,we=16>t?16:t,An===null)var n=!1;else{if(t=An,An=null,eu=0,ve&6)throw Error(L(331));var i=ve;for(ve|=4,X=t.current;X!==null;){var s=X,o=s.child;if(X.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(X=u;X!==null;){var c=X;switch(c.tag){case 0:case 11:case 15:Co(8,c,s)}var h=c.child;if(h!==null)h.return=c,X=h;else for(;X!==null;){c=X;var d=c.sibling,m=c.return;if(mx(c),c===u){X=null;break}if(d!==null){d.return=m,X=d;break}X=m}}}var g=s.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}X=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,X=o;else e:for(;X!==null;){if(s=X,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Co(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,X=y;break e}X=s.return}}var v=t.current;for(X=v;X!==null;){o=X;var p=o.child;if(o.subtreeFlags&2064&&p!==null)p.return=o,X=p;else e:for(o=v;X!==null;){if(a=X,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Bu(9,a)}}catch(S){Ve(a,a.return,S)}if(a===o){X=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,X=_;break e}X=a.return}}if(ve=i,Yn(),Mr&&typeof Mr.onPostCommitFiberRoot=="function")try{Mr.onPostCommitFiberRoot(Tu,t)}catch{}n=!0}return n}finally{we=r,qt.transition=e}}return!1}function ng(t,e,r){e=Fs(r,e),e=ix(t,e,1),t=Fn(t,e,1),e=wt(),t!==null&&(oa(t,1,e),Mt(t,e))}function Ve(t,e,r){if(t.tag===3)ng(t,t,r);else for(;e!==null;){if(e.tag===3){ng(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Dn===null||!Dn.has(n))){t=Fs(r,t),t=sx(e,t,1),e=Fn(e,t,1),t=wt(),e!==null&&(oa(e,1,t),Mt(e,t));break}}e=e.return}}function oE(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=wt(),t.pingedLanes|=t.suspendedLanes&r,nt===t&&(lt&r)===r&&(Qe===4||Qe===3&&(lt&130023424)===lt&&500>He()-cp?fi(t,0):up|=r),Mt(t,e)}function Tx(t,e){e===0&&(t.mode&1?(e=Ta,Ta<<=1,!(Ta&130023424)&&(Ta=4194304)):e=1);var r=wt();t=tn(t,e),t!==null&&(oa(t,e,r),Mt(t,r))}function aE(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Tx(t,r)}function lE(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(L(314))}n!==null&&n.delete(e),Tx(t,r)}var Ax;Ax=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||It.current)Ct=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Ct=!1,KS(t,e,r);Ct=!!(t.flags&131072)}else Ct=!1,Ne&&e.flags&1048576&&I0(e,Hl,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;yl(t,e),t=e.pendingProps;var i=ks(e,gt.current);_s(e,r),i=np(null,e,n,t,i,r);var s=ip();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,kt(n)?(s=!0,Vl(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Qf(e),i.updater=Mu,e.stateNode=i,i._reactInternals=e,ld(e,n,t,r),e=hd(null,e,n,!0,s,r)):(e.tag=0,Ne&&s&&Hf(e),xt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(yl(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=cE(n),t=lr(n,t),i){case 0:e=cd(null,e,n,t,r);break e;case 1:e=Xm(null,e,n,t,r);break e;case 11:e=Hm(null,e,n,t,r);break e;case 14:e=Wm(null,e,n,lr(n.type,t),r);break e}throw Error(L(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:lr(n,i),cd(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:lr(n,i),Xm(t,e,n,i,r);case 3:e:{if(ux(e),t===null)throw Error(L(387));n=e.pendingProps,s=e.memoizedState,i=s.element,D0(t,e),Yl(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Fs(Error(L(423)),e),e=Ym(t,e,n,r,i);break e}else if(n!==i){i=Fs(Error(L(424)),e),e=Ym(t,e,n,r,i);break e}else for(Dt=Nn(e.stateNode.containerInfo.firstChild),Ut=e,Ne=!0,cr=null,r=N0(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ms(),n===i){e=rn(t,e,r);break e}xt(t,e,n,r)}e=e.child}return e;case 5:return L0(e),t===null&&sd(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,ed(n,i)?o=null:s!==null&&ed(n,s)&&(e.flags|=32),lx(t,e),xt(t,e,o,r),e.child;case 6:return t===null&&sd(e),null;case 13:return cx(t,e,r);case 4:return Jf(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Bs(e,null,n,r):xt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:lr(n,i),Hm(t,e,n,i,r);case 7:return xt(t,e,e.pendingProps,r),e.child;case 8:return xt(t,e,e.pendingProps.children,r),e.child;case 12:return xt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ce(Wl,n._currentValue),n._currentValue=o,s!==null)if(gr(s.value,o)){if(s.children===i.children&&!It.current){e=rn(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Zr(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),od(s.return,r,e),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(L(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),od(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}xt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,_s(e,r),i=Zt(i),n=n(i),e.flags|=1,xt(t,e,n,r),e.child;case 14:return n=e.type,i=lr(n,e.pendingProps),i=lr(n.type,i),Wm(t,e,n,i,r);case 15:return ox(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:lr(n,i),yl(t,e),e.tag=1,kt(n)?(t=!0,Vl(e)):t=!1,_s(e,r),nx(e,n,i),ld(e,n,i,r),hd(null,e,n,!0,t,r);case 19:return hx(t,e,r);case 22:return ax(t,e,r)}throw Error(L(156,e.tag))};function Cx(t,e){return e0(t,e)}function uE(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(t,e,r,n){return new uE(t,e,r,n)}function pp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cE(t){if(typeof t=="function")return pp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Bf)return 11;if(t===Nf)return 14}return 2}function On(t,e){var r=t.alternate;return r===null?(r=Xt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function _l(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")pp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ns:return pi(r.children,i,s,e);case Mf:o=8,i|=8;break;case Mh:return t=Xt(12,r,e,i|2),t.elementType=Mh,t.lanes=s,t;case Bh:return t=Xt(13,r,e,i),t.elementType=Bh,t.lanes=s,t;case Nh:return t=Xt(19,r,e,i),t.elementType=Nh,t.lanes=s,t;case Lv:return Fu(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Fv:o=10;break e;case Dv:o=9;break e;case Bf:o=11;break e;case Nf:o=14;break e;case xn:o=16,n=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=Xt(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function pi(t,e,r,n){return t=Xt(7,t,n,e),t.lanes=r,t}function Fu(t,e,r,n){return t=Xt(22,t,n,e),t.elementType=Lv,t.lanes=r,t.stateNode={isHidden:!1},t}function Mc(t,e,r){return t=Xt(6,t,null,e),t.lanes=r,t}function Bc(t,e,r){return e=Xt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hE(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fc(0),this.expirationTimes=fc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fc(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function mp(t,e,r,n,i,s,o,a,l){return t=new hE(t,e,r,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Xt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qf(s),t}function dE(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rs,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Rx(t){if(!t)return zn;t=t._reactInternals;e:{if(Ri(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(kt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var r=t.type;if(kt(r))return R0(t,r,e)}return e}function Px(t,e,r,n,i,s,o,a,l){return t=mp(r,n,!0,t,i,s,o,a,l),t.context=Rx(null),r=t.current,n=wt(),i=Ln(r),s=Zr(n,i),s.callback=e??null,Fn(r,s,i),t.current.lanes=i,oa(t,i,n),Mt(t,n),t}function Du(t,e,r,n){var i=e.current,s=wt(),o=Ln(i);return r=Rx(r),e.context===null?e.context=r:e.pendingContext=r,e=Zr(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Fn(i,e,o),t!==null&&(fr(t,i,o,s),pl(t,i,o)),o}function ru(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ig(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function gp(t,e){ig(t,e),(t=t.alternate)&&ig(t,e)}function fE(){return null}var Ix=typeof reportError=="function"?reportError:function(t){console.error(t)};function yp(t){this._internalRoot=t}Lu.prototype.render=yp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));Du(t,e,null,null)};Lu.prototype.unmount=yp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Si(function(){Du(null,t,null,null)}),e[en]=null}};function Lu(t){this._internalRoot=t}Lu.prototype.unstable_scheduleHydration=function(t){if(t){var e=a0();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Sn.length&&e!==0&&e<Sn[r].priority;r++);Sn.splice(r,0,t),r===0&&u0(t)}};function vp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ou(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function sg(){}function pE(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=ru(o);s.call(u)}}var o=Px(e,n,t,0,null,!1,!1,"",sg);return t._reactRootContainer=o,t[en]=o.current,Vo(t.nodeType===8?t.parentNode:t),Si(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var u=ru(l);a.call(u)}}var l=mp(t,0,!1,null,null,!1,!1,"",sg);return t._reactRootContainer=l,t[en]=l.current,Vo(t.nodeType===8?t.parentNode:t),Si(function(){Du(e,l,r,n)}),l}function Uu(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=ru(o);a.call(l)}}Du(e,o,t,i)}else o=pE(r,e,t,i,n);return ru(o)}s0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=uo(e.pendingLanes);r!==0&&(Lf(e,r|1),Mt(e,He()),!(ve&6)&&(Ds=He()+500,Yn()))}break;case 13:Si(function(){var n=tn(t,1);if(n!==null){var i=wt();fr(n,t,1,i)}}),gp(t,1)}};Of=function(t){if(t.tag===13){var e=tn(t,134217728);if(e!==null){var r=wt();fr(e,t,134217728,r)}gp(t,134217728)}};o0=function(t){if(t.tag===13){var e=Ln(t),r=tn(t,e);if(r!==null){var n=wt();fr(r,t,e,n)}gp(t,e)}};a0=function(){return we};l0=function(t,e){var r=we;try{return we=t,e()}finally{we=r}};$h=function(t,e,r){switch(e){case"input":if(Lh(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Pu(n);if(!i)throw Error(L(90));Uv(n),Lh(n,i)}}}break;case"textarea":Gv(t,r);break;case"select":e=r.value,e!=null&&gs(t,!!r.multiple,e,!1)}};Yv=hp;Kv=Si;var mE={usingClientEntryPoint:!1,Events:[la,as,Pu,Wv,Xv,hp]},to={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gE={bundleType:to.bundleType,version:to.version,rendererPackageName:to.rendererPackageName,rendererConfig:to.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:on.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Qv(t),t===null?null:t.stateNode},findFiberByHostInstance:to.findFiberByHostInstance||fE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Da=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Da.isDisabled&&Da.supportsFiber)try{Tu=Da.inject(gE),Mr=Da}catch{}}Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mE;Gt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vp(e))throw Error(L(200));return dE(t,e,null,r)};Gt.createRoot=function(t,e){if(!vp(t))throw Error(L(299));var r=!1,n="",i=Ix;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=mp(t,1,!1,null,null,r,!1,n,i),t[en]=e.current,Vo(t.nodeType===8?t.parentNode:t),new yp(e)};Gt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=Qv(e),t=t===null?null:t.stateNode,t};Gt.flushSync=function(t){return Si(t)};Gt.hydrate=function(t,e,r){if(!Ou(e))throw Error(L(200));return Uu(null,t,e,!0,r)};Gt.hydrateRoot=function(t,e,r){if(!vp(t))throw Error(L(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=Ix;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Px(e,null,t,1,r??null,i,!1,s,o),t[en]=e.current,Vo(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Lu(e)};Gt.render=function(t,e,r){if(!Ou(e))throw Error(L(200));return Uu(null,t,e,!1,r)};Gt.unmountComponentAtNode=function(t){if(!Ou(t))throw Error(L(40));return t._reactRootContainer?(Si(function(){Uu(null,null,t,!1,function(){t._reactRootContainer=null,t[en]=null})}),!0):!1};Gt.unstable_batchedUpdates=hp;Gt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Ou(r))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return Uu(t,e,r,!1,n)};Gt.version="18.3.1-next-f1338f8080-20240426";function kx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kx)}catch(t){console.error(t)}}kx(),kv.exports=Gt;var yE=kv.exports,og=yE;Ih.createRoot=og.createRoot,Ih.hydrateRoot=og.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qo(){return Qo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qo.apply(this,arguments)}var Cn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Cn||(Cn={}));const ag="popstate";function vE(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return Ed("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:nu(i)}return _E(e,r,null,t)}function Ye(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function xp(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xE(){return Math.random().toString(36).substr(2,8)}function lg(t,e){return{usr:t.state,key:t.key,idx:e}}function Ed(t,e,r,n){return r===void 0&&(r=null),Qo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Vs(e):e,{state:r,key:e&&e.key||n||xE()})}function nu(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Vs(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function _E(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=Cn.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(Qo({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=Cn.Pop;let w=c(),y=w==null?null:w-u;u=w,l&&l({action:a,location:x.location,delta:y})}function d(w,y){a=Cn.Push;let v=Ed(x.location,w,y);u=c()+1;let p=lg(v,u),_=x.createHref(v);try{o.pushState(p,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(_)}s&&l&&l({action:a,location:x.location,delta:1})}function m(w,y){a=Cn.Replace;let v=Ed(x.location,w,y);u=c();let p=lg(v,u),_=x.createHref(v);o.replaceState(p,"",_),s&&l&&l({action:a,location:x.location,delta:0})}function g(w){let y=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof w=="string"?w:nu(w);return v=v.replace(/ $/,"%20"),Ye(y,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,y)}let x={get action(){return a},get location(){return t(i,o)},listen(w){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(ag,h),l=w,()=>{i.removeEventListener(ag,h),l=null}},createHref(w){return e(i,w)},createURL:g,encodeLocation(w){let y=g(w);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:m,go(w){return o.go(w)}};return x}var ug;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ug||(ug={}));function wE(t,e,r){return r===void 0&&(r="/"),SE(t,e,r)}function SE(t,e,r,n){let i=typeof e=="string"?Vs(e):e,s=_p(i.pathname||"/",r);if(s==null)return null;let o=Mx(t);EE(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=FE(s);a=ME(o[l],u)}return a}function Mx(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Ye(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=Un([n,l.relativePath]),c=r.concat(l);s.children&&s.children.length>0&&(Ye(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Mx(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:IE(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of Bx(s.path))i(s,o,l)}),e}function Bx(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=Bx(n.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function EE(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:kE(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const bE=/^:[\w-]+$/,TE=3,AE=2,CE=1,RE=10,PE=-2,cg=t=>t==="*";function IE(t,e){let r=t.split("/"),n=r.length;return r.some(cg)&&(n+=PE),e&&(n+=AE),r.filter(i=>!cg(i)).reduce((i,s)=>i+(bE.test(s)?TE:s===""?CE:RE),n)}function kE(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function ME(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],u=a===n.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=BE({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Un([s,h.pathname]),pathnameBase:jE(Un([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=Un([s,h.pathnameBase]))}return o}function BE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=NE(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((u,c,h)=>{let{paramName:d,isOptional:m}=c;if(d==="*"){let x=a[h]||"";o=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const g=a[h];return m&&!g?u[d]=void 0:u[d]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function NE(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),xp(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function FE(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xp(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function _p(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const DE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LE=t=>DE.test(t);function OE(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Vs(t):t,s;if(r)if(LE(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),xp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=hg(r.substring(1),"/"):s=hg(r,e)}else s=e;return{pathname:s,search:GE(n),hash:zE(i)}}function hg(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Nc(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function UE(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Nx(t,e){let r=UE(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Fx(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Vs(t):(i=Qo({},t),Ye(!i.pathname||!i.pathname.includes("?"),Nc("?","pathname","search",i)),Ye(!i.pathname||!i.pathname.includes("#"),Nc("#","pathname","hash",i)),Ye(!i.search||!i.search.includes("#"),Nc("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=OE(i,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Un=t=>t.join("/").replace(/\/\/+/g,"/"),jE=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),GE=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,zE=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function VE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Dx=["post","put","patch","delete"];new Set(Dx);const $E=["get",...Dx];new Set($E);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jo(){return Jo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jo.apply(this,arguments)}const wp=E.createContext(null),HE=E.createContext(null),Pi=E.createContext(null),ju=E.createContext(null),Ii=E.createContext({outlet:null,matches:[],isDataRoute:!1}),Lx=E.createContext(null);function WE(t,e){let{relative:r}=e===void 0?{}:e;ca()||Ye(!1);let{basename:n,navigator:i}=E.useContext(Pi),{hash:s,pathname:o,search:a}=Ux(t,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:Un([n,o])),i.createHref({pathname:l,search:a,hash:s})}function ca(){return E.useContext(ju)!=null}function ha(){return ca()||Ye(!1),E.useContext(ju).location}function Ox(t){E.useContext(Pi).static||E.useLayoutEffect(t)}function er(){let{isDataRoute:t}=E.useContext(Ii);return t?sb():XE()}function XE(){ca()||Ye(!1);let t=E.useContext(wp),{basename:e,future:r,navigator:n}=E.useContext(Pi),{matches:i}=E.useContext(Ii),{pathname:s}=ha(),o=JSON.stringify(Nx(i,r.v7_relativeSplatPath)),a=E.useRef(!1);return Ox(()=>{a.current=!0}),E.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){n.go(u);return}let h=Fx(u,JSON.parse(o),s,c.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Un([e,h.pathname])),(c.replace?n.replace:n.push)(h,c.state,c)},[e,n,o,s,t])}function Ux(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=E.useContext(Pi),{matches:i}=E.useContext(Ii),{pathname:s}=ha(),o=JSON.stringify(Nx(i,n.v7_relativeSplatPath));return E.useMemo(()=>Fx(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function YE(t,e){return KE(t,e)}function KE(t,e,r,n){ca()||Ye(!1);let{navigator:i}=E.useContext(Pi),{matches:s}=E.useContext(Ii),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=ha(),c;if(e){var h;let w=typeof e=="string"?Vs(e):e;l==="/"||(h=w.pathname)!=null&&h.startsWith(l)||Ye(!1),c=w}else c=u;let d=c.pathname||"/",m=d;if(l!=="/"){let w=l.replace(/^\//,"").split("/");m="/"+d.replace(/^\//,"").split("/").slice(w.length).join("/")}let g=wE(t,{pathname:m}),x=eb(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},a,w.params),pathname:Un([l,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Un([l,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,r,n);return e&&x?E.createElement(ju.Provider,{value:{location:Jo({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Cn.Pop}},x):x}function qE(){let t=ib(),e=VE(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),r?E.createElement("pre",{style:i},r):null,null)}const ZE=E.createElement(qE,null);class QE extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?E.createElement(Ii.Provider,{value:this.props.routeContext},E.createElement(Lx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function JE(t){let{routeContext:e,match:r,children:n}=t,i=E.useContext(wp);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),E.createElement(Ii.Provider,{value:e},n)}function eb(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let c=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);c>=0||Ye(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let c=0;c<o.length;c++){let h=o[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:m}=r,g=h.route.loader&&d[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,h,d)=>{let m,g=!1,x=null,w=null;r&&(m=a&&h.route.id?a[h.route.id]:void 0,x=h.route.errorElement||ZE,l&&(u<0&&d===0?(ob("route-fallback"),g=!0,w=null):u===d&&(g=!0,w=h.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,d+1)),v=()=>{let p;return m?p=x:g?p=w:h.route.Component?p=E.createElement(h.route.Component,null):h.route.element?p=h.route.element:p=c,E.createElement(JE,{match:h,routeContext:{outlet:c,matches:y,isDataRoute:r!=null},children:p})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?E.createElement(QE,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}var jx=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(jx||{}),Gx=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Gx||{});function tb(t){let e=E.useContext(wp);return e||Ye(!1),e}function rb(t){let e=E.useContext(HE);return e||Ye(!1),e}function nb(t){let e=E.useContext(Ii);return e||Ye(!1),e}function zx(t){let e=nb(),r=e.matches[e.matches.length-1];return r.route.id||Ye(!1),r.route.id}function ib(){var t;let e=E.useContext(Lx),r=rb(),n=zx();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function sb(){let{router:t}=tb(jx.UseNavigateStable),e=zx(Gx.UseNavigateStable),r=E.useRef(!1);return Ox(()=>{r.current=!0}),E.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Jo({fromRouteId:e},s)))},[t,e])}const dg={};function ob(t,e,r){dg[t]||(dg[t]=!0)}function ab(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function sr(t){Ye(!1)}function lb(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Cn.Pop,navigator:s,static:o=!1,future:a}=t;ca()&&Ye(!1);let l=e.replace(/^\/*/,"/"),u=E.useMemo(()=>({basename:l,navigator:s,static:o,future:Jo({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof n=="string"&&(n=Vs(n));let{pathname:c="/",search:h="",hash:d="",state:m=null,key:g="default"}=n,x=E.useMemo(()=>{let w=_p(c,l);return w==null?null:{location:{pathname:w,search:h,hash:d,state:m,key:g},navigationType:i}},[l,c,h,d,m,g,i]);return x==null?null:E.createElement(Pi.Provider,{value:u},E.createElement(ju.Provider,{children:r,value:x}))}function ub(t){let{children:e,location:r}=t;return YE(bd(e),r)}new Promise(()=>{});function bd(t,e){e===void 0&&(e=[]);let r=[];return E.Children.forEach(t,(n,i)=>{if(!E.isValidElement(n))return;let s=[...e,i];if(n.type===E.Fragment){r.push.apply(r,bd(n.props.children,s));return}n.type!==sr&&Ye(!1),!n.props.index||!n.props.children||Ye(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=bd(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Td(){return Td=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Td.apply(this,arguments)}function cb(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function hb(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function db(t,e){return t.button===0&&(!e||e==="_self")&&!hb(t)}function Ad(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function fb(t,e){let r=Ad(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(s=>{r.append(i,s)})}),r}const pb=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],mb="6";try{window.__reactRouterVersion=mb}catch{}const gb="startTransition",fg=ow[gb];function yb(t){let{basename:e,children:r,future:n,window:i}=t,s=E.useRef();s.current==null&&(s.current=vE({window:i,v5Compat:!0}));let o=s.current,[a,l]=E.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},c=E.useCallback(h=>{u&&fg?fg(()=>l(h)):l(h)},[l,u]);return E.useLayoutEffect(()=>o.listen(c),[o,c]),E.useEffect(()=>ab(n),[n]),E.createElement(lb,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const vb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",xb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_b=E.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:h}=e,d=cb(e,pb),{basename:m}=E.useContext(Pi),g,x=!1;if(typeof u=="string"&&xb.test(u)&&(g=u,vb))try{let p=new URL(window.location.href),_=u.startsWith("//")?new URL(p.protocol+u):new URL(u),S=_p(_.pathname,m);_.origin===p.origin&&S!=null?u=S+_.search+_.hash:x=!0}catch{}let w=WE(u,{relative:i}),y=wb(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:i,viewTransition:h});function v(p){n&&n(p),p.defaultPrevented||y(p)}return E.createElement("a",Td({},d,{href:g||w,onClick:x||s?n:v,ref:r,target:l}))});var pg;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(pg||(pg={}));var mg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(mg||(mg={}));function wb(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=er(),u=ha(),c=Ux(t,{relative:o});return E.useCallback(h=>{if(db(h,r)){h.preventDefault();let d=n!==void 0?n:nu(u)===nu(c);l(t,{replace:d,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,c,n,i,r,t,s,o,a])}function Sp(t){let e=E.useRef(Ad(t)),r=E.useRef(!1),n=ha(),i=E.useMemo(()=>fb(n.search,r.current?null:e.current),[n.search]),s=er(),o=E.useCallback((a,l)=>{const u=Ad(typeof a=="function"?a(i):a);r.current=!0,s("?"+u,l)},[s,i]);return[i,o]}function Sb(){const t=er(),[e,r]=E.useState(0),[n,i]=E.useState(!1);E.useRef(0);const s=E.useRef(null),o=80;return E.useEffect(()=>{const a=s.current;if(!a)return;let l=0,u=0,c=!1;const h=g=>{a.scrollTop===0&&(l=g.touches[0].clientY,c=!0,console.log("Pull-to-refresh: Touch started"))},d=g=>{if(!c)return;u=g.touches[0].clientY;const x=u-l;if(x>0){g.preventDefault();const w=Math.pow(x,.85);r(Math.min(w,o*1.5)),console.log("Pull distance:",Math.min(w,o*1.5).toFixed(0))}},m=()=>{e>o?(i(!0),r(0),setTimeout(()=>{window.location.reload()},400)):r(0),c=!1};return a.addEventListener("touchstart",h,{passive:!0}),a.addEventListener("touchmove",d,{passive:!1}),a.addEventListener("touchend",m),()=>{a.removeEventListener("touchstart",h),a.removeEventListener("touchmove",d),a.removeEventListener("touchend",m)}},[e]),f.jsxs("div",{ref:s,className:"screen screen-center",style:{position:"relative",overflow:"auto"},children:[f.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:`${e}px`,display:"flex",alignItems:"flex-end",justifyContent:"center",paddingBottom:"8px",opacity:Math.min(e/o,1),transition:e===0?"all 0.3s ease":"none",pointerEvents:"none",zIndex:10},children:n?f.jsx("div",{style:{width:"24px",height:"24px",border:"3px solid var(--color-surface)",borderTop:"3px solid var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}):f.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",fontWeight:600},children:e>o?" Release to refresh":" Pull to refresh"})}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",zIndex:1,transform:`translateY(${e}px)`,transition:e===0?"transform 0.3s ease":"none"},children:[f.jsx("img",{src:"/bird-sound-game/data/icons/OwlHeadphones.png",alt:"ChipNotes Owl Professor",style:{width:"180px",height:"180px",borderRadius:"50%",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",marginBottom:"4px"}}),f.jsx("h1",{style:{margin:0,fontSize:"44px",fontWeight:800,letterSpacing:"-1px",background:"linear-gradient(135deg, #FFD54F 0%, #FF8A65 50%, #E57373 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"ChipNotes!"}),f.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"15px",maxWidth:"280px",textAlign:"center",lineHeight:1.5,marginTop:"0px"},children:"Your gamified study guide to bird sounds"}),f.jsx("button",{onClick:()=>t("/pack-select"),style:{marginTop:"16px",padding:"18px 64px",fontSize:"20px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"16px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.4)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:a=>{a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow="0 6px 20px rgba(45, 90, 39, 0.5)"},onMouseLeave:a=>{a.currentTarget.style.transform="translateY(0)",a.currentTarget.style.boxShadow="0 4px 16px rgba(45, 90, 39, 0.4)"},children:"Play"}),f.jsx("div",{style:{marginTop:"16px",padding:"12px 16px",background:"var(--color-surface)",borderRadius:"16px",maxWidth:"340px"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px"},children:[f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{width:"88px",height:"56px",background:"linear-gradient(180deg, #1a1a2e 0%, #0d1520 100%)",borderRadius:"10px",padding:"6px",display:"flex",alignItems:"flex-end",justifyContent:"center",gap:"2px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.3)"},children:f.jsx(Eb,{})}),f.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginTop:"8px"},children:"Hear a sound"})]}),f.jsx("div",{style:{color:"var(--color-accent)",fontSize:"28px",marginTop:"-20px"},children:""}),f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"6px"},children:["NOCA","BLJA","TUTI","CAWR"].map((a,l)=>f.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",overflow:"hidden",border:l===0?"2px solid var(--color-accent)":"2px solid transparent",boxShadow:l===0?"0 0 10px rgba(255, 152, 0, 0.4)":"none"},children:f.jsx("img",{src:`/bird-sound-game/data/icons/${a}.png`,alt:a,style:{width:"100%",height:"100%",objectFit:"cover"}})},a))}),f.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginTop:"8px"},children:"Match the bird!"})]})]})})]}),f.jsxs("div",{style:{position:"absolute",bottom:"calc(40px + var(--safe-area-bottom, 0px))",left:0,right:0,display:"flex",justifyContent:"center",gap:"40px"},children:[f.jsxs("button",{className:"btn-icon",onClick:()=>t("/help"),"aria-label":"How to Play",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px"},children:[f.jsx(bb,{}),f.jsx("span",{style:{fontSize:"12px",opacity:.7},children:"Help"})]}),f.jsxs("button",{className:"btn-icon",onClick:()=>t("/settings"),"aria-label":"Settings",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px"},children:[f.jsx(Tb,{}),f.jsx("span",{style:{fontSize:"12px",opacity:.7},children:"Settings"})]}),f.jsxs("button",{className:"btn-icon",onClick:()=>t("/progress"),"aria-label":"Progress",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px"},children:[f.jsx(Ab,{}),f.jsx("span",{style:{fontSize:"12px",opacity:.7},children:"Stats"})]})]}),f.jsx("div",{style:{position:"absolute",bottom:"calc(4px + var(--safe-area-bottom, 0px))",left:0,right:0,textAlign:"center",fontSize:"11px",color:"var(--color-text-muted)",opacity:.85},children:"v3.16 | Made with    and "})]})}function Eb(){const t=[8,16,24,32,26,34,28,36,20,12,26,32];return f.jsx("svg",{width:"76",height:"40",viewBox:"0 0 76 40",children:t.map((e,r)=>f.jsx("rect",{x:r*6+2,y:40-e,width:"4",height:e,rx:"1.5",fill:`hsl(${30+r*8}, 80%, ${50+r*2}%)`,opacity:.8+r*.015},r))})}function bb(){return f.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[f.jsx("circle",{cx:"12",cy:"12",r:"10"}),f.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),f.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}function Tb(){return f.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[f.jsx("circle",{cx:"12",cy:"12",r:"3"}),f.jsx("path",{d:"M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"})]})}function Ab(){return f.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[f.jsx("path",{d:"M3 3v18h18"}),f.jsx("path",{d:"M7 16l4-4 4 4 6-6"})]})}function Ep(t,e){typeof window.gtag=="function"&&window.gtag("event",t,e)}function Cb(t,e){Ep("pack_select",{pack_id:t,pack_name:e})}function Rb(t){Ep("training_mode_toggle",{enabled:t})}function Pb(t,e,r){Ep("level_select",{pack_id:t,level_id:e,level_title:r})}const Fc=[{id:"starter_birds",name:"Common Eastern US Backyard Birds",speciesCount:5,isUnlocked:!0,description:"Start here! Five distinctive birds with bold, recognizable voices."},{id:"expanded_backyard",name:"Expanded Eastern US Birds",speciesCount:39,isUnlocked:!0,description:"Ready for more? 9 random birds per round from 39 eastern US species."},{id:"sparrows",name:"Sparrows",speciesCount:8,isUnlocked:!0,description:"Master the subtle songs of eight sparrow species."},{id:"woodpeckers",name:"Woodpeckers",speciesCount:7,isUnlocked:!0,description:"Learn the drums, calls, and rattles of seven woodpecker species."},{id:"western_birds",name:"Western Backyard Birds",speciesCount:14,isUnlocked:!0,description:"Common backyard birds of western North America, from the Pacific coast to the Rockies."},{id:"spring_warblers",name:"Warbler Academy",speciesCount:33,isUnlocked:!0,description:"33 wood-warblers  9 random per round. Use Custom Pack for focused warbler brain training!"}];function Ib(){const t=er(),[e,r]=E.useState([]),[n,i]=E.useState({}),[s,o]=E.useState({}),[a,l]=E.useState(null),[u,c]=E.useState(null),[h,d]=E.useState(new Set),[m,g]=E.useState(!1),x=E.useRef(null);E.useEffect(()=>{fetch("/bird-sound-game/data/clips.json").then(p=>p.json()).then(p=>r(p)).catch(p=>console.error("Failed to load clips:",p))},[]),E.useEffect(()=>{const p=["starter_birds","expanded_backyard","sparrows","woodpeckers","spring_warblers","western_birds"];Promise.all(p.map(_=>fetch(`/bird-sound-game/data/packs/${_}.json`).then(S=>S.json()).catch(S=>(console.error(`Failed to load pack ${_}:`,S),null)))).then(_=>{const S={},b={};_.forEach((A,T)=>{A&&A.species&&(S[p[T]]=A.species,b[p[T]]=A.display_species||A.species)}),i(S),o(b)})},[]);const w=p=>(s[p]||[]).map(S=>{const b=e.filter(I=>I.species_code===S&&!I.rejected&&(!I.spectrogram_path||!I.spectrogram_path.includes("spectrograms-rejected"))),T=b.find(I=>I.canonical)||b[0],M=b.sort((I,W)=>I.canonical&&!W.canonical?-1:!I.canonical&&W.canonical?1:I.clip_id.localeCompare(W.clip_id)).map(I=>({id:I.clip_id,path:`/bird-sound-game/data/clips/${I.file_path.split("/").pop()}`,isCanonical:!!I.canonical,vocalizationType:I.vocalization_type,source:I.source,sourceId:I.source_id,recordist:I.recordist}));return{code:S,name:(T==null?void 0:T.common_name)||S,canonicalClipPath:T?`/bird-sound-game/data/clips/${T.file_path.split("/").pop()}`:null,clipCount:b.length,allClips:M}}).sort((S,b)=>S.code.localeCompare(b.code)),y=p=>{p.isUnlocked&&(Cb(p.id,p.name),t(`/level-select?pack=${p.id}`))},v=(p,_)=>{if(x.current&&(x.current.pause(),x.current=null),a===_){l(null);return}const S=new Audio(p);x.current=S,l(_),S.play().catch(b=>console.error("Failed to play audio:",b)),S.onended=()=>{l(null),x.current=null}};return E.useEffect(()=>()=>{x.current&&x.current.pause()},[]),f.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[f.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[f.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",children:f.jsx(kb,{})}),f.jsx("h2",{style:{margin:0},children:"Select a Bird Pack"})]}),f.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.6},children:f.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[f.jsx("li",{children:"Each pack has 6 levels - from signature sounds to full repertoires. Start at level 1 and repeat when ready for a challenge."}),f.jsxs("li",{children:['Pro tip: Enable "training" mode () to kick-start your learning. See ',f.jsx(_b,{to:"/help",style:{color:"var(--color-accent)"},children:"How to Play"})," for full instructions"]}),f.jsx("li",{style:{fontWeight:600},children:"Phone ringer  ON (unmute) and  for best experience!"})]})}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"32px"},children:Fc.map(p=>{const _={starter_birds:"linear-gradient(135deg, #2d5a3d 0%, #1a3d2a 100%)",expanded_backyard:"linear-gradient(135deg, #3d5a6e 0%, #2a3d4a 100%)",sparrows:"linear-gradient(135deg, #6b5344 0%, #4a3a2e 100%)",woodpeckers:"linear-gradient(135deg, #6e3d3d 0%, #4a2a2a 100%)",spring_warblers:"linear-gradient(135deg, #7a6b2d 0%, #5a4a1a 100%)",western_birds:"linear-gradient(135deg, #5a4a7a 0%, #3a2a5a 100%)"},S={starter_birds:"NOCA",expanded_backyard:"AMGO",sparrows:"WTSP",woodpeckers:"PIWO",spring_warblers:"BLBW",western_birds:"STJA"};return f.jsxs("button",{onClick:()=>y(p),style:{position:"relative",overflow:"hidden",textAlign:"left",padding:"20px 16px",borderRadius:"16px",border:"none",background:_[p.id]||_.starter_birds,boxShadow:p.isUnlocked?"0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"none",opacity:p.isUnlocked?1:.5,cursor:p.isUnlocked?"pointer":"not-allowed",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:b=>{p.isUnlocked&&(b.currentTarget.style.transform="translateY(-2px)",b.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1)")},onMouseLeave:b=>{b.currentTarget.style.transform="translateY(0)",b.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[f.jsx("img",{src:`/bird-sound-game/data/icons/${S[p.id]}.png`,alt:"",style:{position:"absolute",right:"-10px",bottom:"-10px",width:"80px",height:"80px",opacity:.5,transform:"rotate(-15deg)",objectFit:"cover"}}),f.jsxs("div",{style:{position:"relative",zIndex:1},children:[f.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#f5f0e6",lineHeight:1.3,marginBottom:"6px"},children:p.name}),f.jsx("div",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.6)",lineHeight:1.4,marginBottom:"10px"},children:p.description}),f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[f.jsxs("span",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.7)",fontWeight:500},children:[p.speciesCount," species"]}),p.isUnlocked&&f.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#a8d5a2",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Play ",f.jsx(Mb,{})]})]})]})]},p.id)})}),f.jsxs("div",{style:{marginBottom:"32px",background:"var(--color-surface)",border:"2px solid var(--color-accent)",borderRadius:"16px",padding:"20px"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[f.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"var(--color-accent)",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:f.jsx(Bb,{})}),f.jsxs("div",{children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)"},children:"Create Custom Pack"}),f.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:"Build your own training session"})]})]}),f.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:[f.jsxs("div",{style:{marginBottom:"8px"},children:[f.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Got a nemesis bird? Queue it up and drill all its variations."]}),f.jsxs("div",{style:{marginBottom:"8px"},children:[f.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Constantly confuse Kinglets, Creepers and Waxwings? Put them head-to-head."]}),f.jsxs("div",{style:{marginBottom:"8px"},children:[f.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Warbler Wizard Wannabe? Training starts here!"]}),f.jsxs("div",{style:{marginBottom:"8px"},children:[f.jsx("span",{style:{color:"var(--color-accent)"},children:""})," You think you know your woodpeckers? Try the Pileated vs. Northern Flicker on Level 5."]}),f.jsxs("div",{children:[f.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Mix species from any pack  your rules, your practice."]})]}),f.jsx("button",{onClick:()=>t("/custom-pack"),style:{width:"100%",padding:"12px",background:"var(--color-accent)",border:"none",borderRadius:"8px",color:"#000",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Build Your Pack"})]}),f.jsxs("div",{style:{marginTop:"16px"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[f.jsx("h3",{style:{fontSize:"16px",margin:0,color:"var(--color-text-muted)"},children:"Bird Reference"}),f.jsx("button",{onClick:()=>{if(m)d(new Set),g(!1);else{const p=Fc.filter(_=>_.isUnlocked).map(_=>_.id);d(new Set(p)),g(!0)}},style:{fontSize:"12px",padding:"6px 12px",background:m?"var(--color-accent)":"var(--color-surface)",color:m?"#000":"var(--color-text)",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:600},children:m?"Collapse All":"Expand All"})]}),f.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"20px",paddingLeft:"12px",borderLeft:"3px solid var(--color-accent)"},children:"Preview signature sounds for each bird before you play. Click pack names to expand and see all birds, or click individual birds to explore their full library of recordings."}),Fc.filter(p=>p.isUnlocked).map(p=>{var S;const _=m||h.has(p.id);return f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsxs("div",{onClick:()=>{const b=new Set(h);b.has(p.id)?b.delete(p.id):b.add(p.id),d(b)},style:{fontSize:"14px",marginBottom:_?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:b=>b.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:b=>b.currentTarget.style.background="var(--color-surface)",children:[f.jsx("span",{style:{fontSize:"14px"},children:_?"":""}),f.jsx("span",{style:{fontWeight:600},children:p.name}),f.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((S=s[p.id])==null?void 0:S.length)||0," species"]})]}),_&&f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:w(p.id).map(b=>{const A=u===b.code;return f.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:b.clipCount>1?"pointer":"default"},onClick:()=>{b.clipCount>1&&c(A?null:b.code)},children:[f.jsx(Fb,{code:b.code,size:36}),f.jsxs("div",{style:{minWidth:0,flex:1},children:[f.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:b.code}),f.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:b.name}),f.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)"},children:[b.clipCount," clip",b.clipCount!==1?"s":"",b.clipCount>1&&f.jsx("span",{style:{marginLeft:"4px",color:"var(--color-accent)"},children:A?"":""})]})]}),f.jsx("button",{onClick:T=>{T.stopPropagation(),b.canonicalClipPath&&v(b.canonicalClipPath,b.code)},disabled:!b.canonicalClipPath,style:{width:"28px",height:"28px",borderRadius:"50%",border:"none",background:a===b.code?"var(--color-accent)":"var(--color-primary)",color:"white",cursor:b.canonicalClipPath?"pointer":"not-allowed",opacity:b.canonicalClipPath?1:.3,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play ${b.name}`,children:a===b.code?f.jsx(yg,{}):f.jsx(gg,{})})]}),A&&b.allClips.length>0&&f.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"8px 12px",background:"rgba(0,0,0,0.2)"},children:[f.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"8px"},children:["All ",b.clipCount," clips:"]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:b.allClips.map((T,M)=>f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx("button",{onClick:()=>v(T.path,T.id),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===T.id?"var(--color-accent)":"rgba(255,255,255,0.15)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play clip ${M+1}`,children:a===T.id?f.jsx(yg,{size:8}):f.jsx(gg,{size:8})}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px",flex:1},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[f.jsx("span",{style:{fontSize:"11px",color:"var(--color-text)"},children:T.sourceId||`Clip ${M+1}`}),T.isCanonical&&f.jsx("span",{style:{fontSize:"9px",color:"#000",background:"var(--color-accent)",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:" SIGNATURE"}),T.vocalizationType&&f.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px",textTransform:"capitalize"},children:T.vocalizationType}),T.source&&f.jsxs("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:[T.source==="xenocanto"?"Xeno-canto":T.source==="cornell"?"Cornell":"Peter Repetti",T.recordist&&` - ${T.recordist}`]})]})})]},T.id))})]})]},b.code)})})]},p.id)})]})]})}function kb(){return f.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[f.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),f.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function gg({size:t=14}){return f.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M8 5v14l11-7z"})})}function yg({size:t=12}){return f.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function Mb(){return f.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:f.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}function Bb(){return f.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:f.jsx("path",{d:"M12 5v14M5 12h14"})})}function Nb({size:t=80}){return f.jsx("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"currentColor",children:f.jsx("path",{d:"M85 35c-5-3-12-2-18 1-3-8-10-14-19-16 2-3 3-7 2-11-1-5-5-8-9-7s-7 5-6 10c0 2 1 4 2 5-10 3-18 11-21 21-8-1-16 2-21 8-2 2-1 5 1 6s5 0 7-2c3-4 8-5 13-4 0 12 7 23 18 28l-8 12c-2 2-1 5 1 7 2 1 5 1 6-2l10-14c3 1 6 1 9 1 4 0 7-1 10-2l10 14c2 2 5 3 7 1s2-5 0-7l-8-12c11-5 18-16 18-28 5-1 10 0 13 4 2 2 5 3 7 2s3-4 1-6c-5-6-13-9-21-8z"})})}function Fb({code:t,size:e=36}){const[r,n]=E.useState(!0),i=`/bird-sound-game/data/icons/${t}.png`;return r?f.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",flexShrink:0},onError:()=>n(!1)}):f.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-primary)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.4,flexShrink:0},children:f.jsx(Nb,{size:e*.7})})}const Db={starter_birds:"Common Eastern US Backyard Birds",expanded_backyard:"Expanded Eastern US Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard Birds",custom:"Custom Pack"};function Lb(t){return[{level_id:1,pack_id:"custom",mode:"campaign",title:"Meet Your Birds",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:2,pack_id:"custom",mode:"campaign",title:"Sound Variations",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:3,pack_id:"custom",mode:"campaign",title:"Full Repertoire",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:4,pack_id:"custom",mode:"campaign",title:"Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:5,pack_id:"custom",mode:"campaign",title:"Variations + Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:6,pack_id:"custom",mode:"campaign",title:"Master Birder",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"}]}function Ob(t){const e=[];return t.clip_selection==="canonical"?e.push("Signature sounds only"):t.clip_selection==="all"?e.push("Full repertoire"):typeof t.clip_selection=="number"&&e.push(`${t.clip_selection} variations per bird`),t.channel_mode==="offset"?e.push("both ears"):e.push("one ear"),e.join("  ")}function Ub(t){const e=t.level_id;return e<=2?{label:"Easy",color:"#4CAF50"}:e<=4?{label:"Medium",color:"#FFC107"}:{label:"Hard",color:"#FF5722"}}function jb(){const t=er(),[e]=Sp(),r=e.get("pack")||"starter_birds",[n,i]=E.useState([]),[s,o]=E.useState(!0);E.useEffect(()=>{if(r==="custom"){try{const u=localStorage.getItem("soundfield_custom_pack");if(u){const c=JSON.parse(u);if(Array.isArray(c)&&c.length>0){i(Lb(c.length)),o(!1);return}}t("/custom-pack",{replace:!0})}catch(u){console.error("Failed to load custom pack:",u),t("/custom-pack",{replace:!0})}return}fetch("/bird-sound-game/data/levels.json").then(u=>u.json()).then(u=>{const c=u.filter(h=>h.pack_id===r);i(c.sort((h,d)=>h.level_id-d.level_id)),o(!1)}).catch(u=>{console.error("Failed to load levels:",u),o(!1)})},[r,t]);const a=u=>{Pb(r,u.level_id,u.title||`Level ${u.level_id}`),t(`/preview?pack=${r}&level=${u.level_id}`)},l=Db[r]||r;return f.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[f.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"8px"},children:[f.jsx("button",{className:"btn-icon",onClick:()=>t(r==="custom"?"/custom-pack":"/pack-select"),"aria-label":"Back",children:f.jsx(Gb,{})}),f.jsxs("div",{children:[f.jsx("h2",{style:{margin:0,fontSize:"20px"},children:l}),f.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:"Select a level"})]})]}),s?f.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--color-text-muted)"},children:"Loading levels..."}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:n.map(u=>{const c=Ub(u);return f.jsxs("button",{onClick:()=>a(u),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"var(--color-surface)",border:"none",borderRadius:"12px",cursor:"pointer",textAlign:"left",transition:"transform 0.15s, background 0.15s"},onMouseEnter:h=>{h.currentTarget.style.transform="translateX(4px)",h.currentTarget.style.background="rgba(45, 45, 68, 1)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateX(0)",h.currentTarget.style.background="var(--color-surface)"},children:[f.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:`linear-gradient(135deg, ${c.color}33, ${c.color}11)`,border:`2px solid ${c.color}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"20px",color:c.color,flexShrink:0},children:u.level_id}),f.jsxs("div",{style:{flex:1,minWidth:0},children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:u.title}),f.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:Ob(u)})]}),f.jsx("div",{style:{color:"var(--color-text-muted)",flexShrink:0},children:f.jsx(zb,{})})]},u.level_id)})}),f.jsx("div",{style:{marginTop:"24px",padding:"12px 16px",background:"rgba(245, 166, 35, 0.1)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:f.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:[f.jsx("strong",{style:{color:"var(--color-accent)"},children:"Tip:"})," Start with Level 1 to learn each bird's signature sound, then progress to variations and both-ear challenges."]})})]})}function Gb(){return f.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{d:"M15 18l-6-6 6-6"})})}function zb(){return f.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{d:"M9 18l6-6-6-6"})})}const La=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"],Vb={starter_birds:"5 Common Eastern US Backyard Birds",expanded_backyard:"Expanded Eastern US Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard Birds",custom:"Custom Pack"},$b={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function Hb(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function Wb(t){return t>=4?"offset":"single"}function Xb({code:t,size:e=56,color:r}){const[n,i]=E.useState(!0),s=`/bird-sound-game/data/icons/${t}.png`;return f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",WebkitTapHighlightColor:"transparent"},children:[n&&f.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?f.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",WebkitTapHighlightColor:"transparent"},onError:()=>i(!1)}):f.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"var(--color-surface)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.25,fontWeight:700,color:"#1A1A2E"},children:t})]})}function Yb(){const t=er(),[e]=Sp(),r=e.get("pack")||"starter_birds",n=parseInt(e.get("level")||"1",10),i=e.get("keepBirds")==="true",[s,o]=E.useState(null),[a,l]=E.useState([]),[u,c]=E.useState([]),[h,d]=E.useState(null),[m,g]=E.useState(!0),[x,w]=E.useState("idle"),[y,v]=E.useState({loaded:0,total:0}),[p,_]=E.useState(()=>{try{return localStorage.getItem("soundfield_training_mode")==="true"}catch{return!1}}),S=E.useRef(null),b=()=>{const C=!p;_(C);try{localStorage.setItem("soundfield_training_mode",String(C))}catch(N){console.error("Failed to save training mode:",N)}},A=E.useCallback((C,N)=>C.sort().map((z,B)=>{const k=N.find(R=>R.species_code===z&&R.canonical&&!R.rejected),P=N.find(R=>R.species_code===z&&!R.rejected),D=k||P;return{code:z,name:(D==null?void 0:D.common_name)||z,color:La[B%La.length],clipPath:D?`/bird-sound-game/data/clips/${D.file_path.split("/").pop()}`:null}}),[]),T=E.useCallback((C,N)=>{const z=C.species_pool||[],B=C.species_count||z.length,D=[...z].sort(()=>Math.random()-.5).slice(0,B).sort().map((R,F)=>{const Z=N.find(_e=>_e.species_code===R&&_e.canonical&&!_e.rejected),he=N.find(_e=>_e.species_code===R&&!_e.rejected),ue=Z||he;return{code:R,name:(ue==null?void 0:ue.common_name)||R,color:La[F%La.length],clipPath:ue?`/bird-sound-game/data/clips/${ue.file_path.split("/").pop()}`:null}});c(D)},[]);E.useEffect(()=>{Promise.all([fetch("/bird-sound-game/data/levels.json").then(C=>C.json()),fetch("/bird-sound-game/data/clips.json").then(C=>C.json())]).then(([C,N])=>{if(l(N),r==="custom"){const B=localStorage.getItem("soundfield_custom_pack");if(B)try{const k=JSON.parse(B),P={level_id:n,pack_id:"custom",mode:"campaign",title:$b[n]||`Level ${n}`,round_duration_sec:30,species_count:k.length,species_pool:k,clip_selection:Hb(n),channel_mode:Wb(n),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"};o(P),c(A(k,N))}catch(k){console.error("Failed to parse custom pack:",k)}g(!1);return}const z=C.find(B=>B.pack_id===r&&B.level_id===n);if(z){if(o(z),i){const B=sessionStorage.getItem("roundSpecies");if(B)try{const k=JSON.parse(B),P=z.species_pool||[],D=k.filter(R=>P.includes(R));if(D.length===k.length){c(A(D,N)),g(!1);return}}catch(k){console.error("Failed to parse saved species:",k)}}T(z,N)}g(!1)}).catch(C=>{console.error("Failed to load data:",C),g(!1)})},[r,n,i,A,T]),E.useEffect(()=>{if(u.length===0||a.length===0){w("idle");return}const C=u.map(k=>k.code),N=a.filter(k=>C.includes(k.species_code)&&!k.rejected);if(N.length===0){w("ready"),v({loaded:0,total:0});return}w("loading"),v({loaded:0,total:N.length}),console.log(`Preloading ${N.length} clips for ${C.length} species...`);let z=0;const B=N.map(async k=>{const P=`/bird-sound-game/${k.file_path}`;try{const D=await fetch(P);D.ok&&await D.arrayBuffer()}catch(D){console.warn("Failed to preload:",k.file_path,D)}finally{z++,v({loaded:z,total:N.length})}});Promise.all(B).then(()=>{console.log("Preloading complete!"),w("ready")})},[u,a]);const M=()=>{s&&a.length>0&&(S.current&&(S.current.pause(),S.current=null,d(null)),w("idle"),T(s,a))},I=C=>{if(console.log(`[Preview] Attempting to play: ${C.code}`),console.log(`[Preview] Clip path: ${C.clipPath}`),S.current&&(S.current.pause(),S.current=null),h===C.code){d(null);return}if(!C.clipPath){console.error(`[Preview] No clip path for ${C.code}!`);return}const N=new Audio(C.clipPath);S.current=N,d(C.code),N.play().then(()=>console.log(`[Preview] Playing ${C.code} successfully`)).catch(z=>{console.error(`[Preview] Failed to play ${C.code}:`,z),console.error(`[Preview] Clip path was: ${C.clipPath}`)}),N.onended=()=>{console.log(`[Preview] ${C.code} finished playing`),d(null),S.current=null}},W=()=>{S.current&&S.current.pause();const C=u.map(N=>N.code);sessionStorage.setItem("roundSpecies",JSON.stringify(C)),t(`/gameplay?mode=campaign&pack=${r}&level=${n}&preview=true`)};if(E.useEffect(()=>()=>{S.current&&S.current.pause()},[]),m)return f.jsx("div",{className:"screen screen-center",children:f.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading..."})});if(!s)return f.jsxs("div",{className:"screen screen-center",children:[f.jsx("div",{style:{color:"var(--color-error)"},children:"Level not found"}),f.jsx("button",{onClick:()=>t(-1),style:{marginTop:"16px",padding:"8px 16px",background:"var(--color-surface)",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"Go Back"})]});const G=Vb[r]||r;return f.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column"},children:[f.jsxs("div",{style:{marginBottom:"12px"},children:[f.jsxs("div",{className:"flex-row items-center",style:{marginBottom:"8px"},children:[f.jsx("button",{className:"btn-icon",onClick:()=>t(`/level-select?pack=${r}`),"aria-label":"Back",children:f.jsx(Kb,{})}),f.jsxs("div",{style:{flex:1,marginLeft:"8px"},children:[f.jsx("h2",{style:{margin:0,fontSize:"16px"},children:G}),f.jsxs("div",{style:{fontSize:"13px",color:"var(--color-accent)"},children:["Level ",s.level_id,": ",s.title]})]})]}),f.jsxs("button",{onClick:W,style:{width:"100%",padding:"14px",fontSize:"16px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",boxShadow:"0 4px 12px rgba(45, 90, 39, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:["Ready to Play ",f.jsx(Zb,{})]}),x==="loading"&&f.jsxs("div",{style:{marginTop:"8px",textAlign:"center"},children:[f.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"6px"},children:["Loading sounds ",y.loaded,"/",y.total]}),f.jsx("div",{style:{width:"100%",height:"4px",background:"var(--color-surface)",borderRadius:"2px",overflow:"hidden"},children:f.jsx("div",{style:{width:`${y.loaded/y.total*100}%`,height:"100%",background:"var(--color-accent)",transition:"width 0.2s ease"}})})]}),x==="ready"&&f.jsxs("div",{style:{marginTop:"6px",fontSize:"11px",color:"var(--color-success)",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[f.jsx("span",{children:""})," Sounds ready"]}),f.jsxs("button",{onClick:b,style:{width:"100%",marginTop:"8px",padding:"10px 14px",background:p?"rgba(245, 166, 35, 0.15)":"var(--color-surface)",border:p?"1px solid var(--color-accent)":"1px solid transparent",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.15s"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Qb,{filled:p}),f.jsx("span",{style:{fontSize:"14px",color:"var(--color-text)"},children:"Training Mode"})]}),f.jsx("div",{style:{width:"40px",height:"22px",borderRadius:"11px",background:p?"var(--color-accent)":"var(--color-text-muted)",position:"relative",transition:"background 0.15s"},children:f.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:p?"20px":"2px",transition:"left 0.15s"}})})]}),p&&f.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"4px",paddingLeft:"4px"},children:"Bird icons appear on spectrograms. Toggle on mid-round? Icons show up on the next new bird."})]}),f.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"16px 0"},children:[f.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"12px",textAlign:"center",maxWidth:"280px"},children:s.level_id===1?"Tap to preview each bird's signature sound":f.jsxs(f.Fragment,{children:["Tap to preview signature sounds.",f.jsx("br",{}),f.jsx("span",{style:{fontSize:"12px",opacity:.8},children:"You'll hear variations during play!"})]})}),s.species_pool&&s.species_pool.length>(s.species_count||0)&&f.jsxs("button",{onClick:M,style:{marginBottom:"16px",padding:"8px 16px",background:"transparent",border:"1px solid var(--color-accent)",borderRadius:"8px",color:"var(--color-accent)",fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.15s"},onMouseEnter:C=>{C.currentTarget.style.background="rgba(245, 166, 35, 0.1)"},onMouseLeave:C=>{C.currentTarget.style.background="transparent"},children:[f.jsx(qb,{}),"Shuffle Birds"]}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",maxWidth:"320px",width:"100%"},children:u.map(C=>f.jsxs("button",{onClick:()=>I(C),disabled:!C.clipPath,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"12px 8px",background:h===C.code?`${C.color}33`:"var(--color-surface)",border:`2px solid ${C.color}`,borderRadius:"12px",cursor:C.clipPath?"pointer":"not-allowed",opacity:C.clipPath?1:.5,transition:"transform 0.15s, background 0.15s",WebkitTapHighlightColor:"transparent"},children:[f.jsx("div",{style:{position:"relative",WebkitTapHighlightColor:"transparent"},children:f.jsx(Xb,{code:C.code,size:56,color:C.color})}),f.jsx("div",{style:{fontSize:"11px",color:"var(--color-text)",textAlign:"center",lineHeight:1.2,maxWidth:"80px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:C.name})]},C.code))})]}),f.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.7; }
        }
        * {
          -webkit-tap-highlight-color: transparent;
        }
      `})]})}function Kb(){return f.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{d:"M15 18l-6-6 6-6"})})}function qb(){return f.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[f.jsx("path",{d:"M16 3h5v5"}),f.jsx("path",{d:"M4 20L21 3"}),f.jsx("path",{d:"M21 16v5h-5"}),f.jsx("path",{d:"M15 15l6 6"}),f.jsx("path",{d:"M4 4l5 5"})]})}function Zb(){return f.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M8 5v14l11-7z"})})}function Qb({filled:t}){return f.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:t?"var(--color-accent)":"var(--color-text-muted)",strokeWidth:"2",children:[f.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:t?"var(--color-accent)":"none"})]})}const Ui=9,vg="soundfield_custom_pack",xg=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"];function Jb(){const t=er(),[e,r]=E.useState([]),[n,i]=E.useState([]),[s,o]=E.useState(""),[a,l]=E.useState(null),[u,c]=E.useState(!0),h=E.useRef(null);E.useEffect(()=>{fetch("/bird-sound-game/data/clips.json").then(y=>y.json()).then(y=>{const v=new Map;for(const _ of y)if(!_.rejected&&!v.has(_.species_code)){const b=y.find(A=>A.species_code===_.species_code&&A.canonical&&!A.rejected)||_;v.set(_.species_code,{code:_.species_code,name:_.common_name,clipPath:`/bird-sound-game/data/clips/${b.file_path.split("/").pop()}`})}const p=Array.from(v.values()).sort((_,S)=>_.name.localeCompare(S.name));r(p),c(!1)}).catch(y=>{console.error("Failed to load clips:",y),c(!1)});try{const y=localStorage.getItem(vg);if(y){const v=JSON.parse(y);Array.isArray(v)&&v.length>0&&i(v)}}catch(y){console.error("Failed to load saved pack:",y)}},[]);const d=E.useCallback(y=>{i(v=>v.includes(y)?v.filter(p=>p!==y):v.length>=Ui?v:[...v,y])},[]),m=(y,v)=>{if(v.stopPropagation(),h.current&&(h.current.pause(),h.current=null),a===y.code){l(null);return}if(!y.clipPath)return;const p=new Audio(y.clipPath);h.current=p,l(y.code),p.play().catch(_=>console.error("Failed to play:",_)),p.onended=()=>{l(null),h.current=null}},g=()=>{n.length!==0&&(localStorage.setItem(vg,JSON.stringify(n)),t("/level-select?pack=custom"))},x=()=>{i([])},w=s?e.filter(y=>y.name.toLowerCase().includes(s.toLowerCase())||y.code.toLowerCase().includes(s.toLowerCase())):e;return E.useEffect(()=>()=>{h.current&&h.current.pause()},[]),u?f.jsx("div",{className:"screen screen-center",children:f.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading species..."})}):f.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",overflow:"hidden"},children:[f.jsx("div",{style:{flexShrink:0,marginBottom:"12px"},children:f.jsxs("div",{className:"flex-row items-center gap-md",children:[f.jsx("button",{className:"btn-icon",onClick:()=>t("/pack-select"),"aria-label":"Back",children:f.jsx(eT,{})}),f.jsxs("div",{children:[f.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Custom Pack Builder"}),f.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:["Select up to ",Ui," birds"]})]})]})}),f.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",position:"relative"},children:[f.jsx("input",{type:"text",placeholder:"Search birds...",value:s,onChange:y=>o(y.target.value),style:{width:"100%",padding:"10px 12px",paddingRight:s?"36px":"12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px"}}),s&&f.jsx("button",{onClick:()=>o(""),style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"var(--color-text-muted)",border:"none",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:0},"aria-label":"Clear search",children:f.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-background)",strokeWidth:"3",children:f.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),f.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",padding:"8px 12px",background:n.length>0?"rgba(45, 90, 39, 0.2)":"var(--color-surface)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("span",{style:{fontSize:"14px"},children:[f.jsx("span",{style:{fontWeight:700,color:"var(--color-accent)"},children:n.length}),"/",Ui," selected"]}),n.length>0&&f.jsx("button",{onClick:x,style:{background:"none",border:"none",color:"var(--color-text-muted)",fontSize:"12px",cursor:"pointer",textDecoration:"underline"},children:"Clear all"})]}),f.jsx("div",{style:{flex:1,overflowY:"auto",marginBottom:"12px"},children:f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"8px"},children:w.map(y=>{const v=n.includes(y.code),p=n.indexOf(y.code),_=v?xg[p%xg.length]:void 0;return f.jsxs("button",{onClick:()=>d(y.code),disabled:!v&&n.length>=Ui,style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px",background:v?`${_}22`:"var(--color-surface)",border:v?`2px solid ${_}`:"1px solid transparent",borderRadius:"8px",cursor:v||n.length<Ui?"pointer":"not-allowed",opacity:v||n.length<Ui?1:.5,textAlign:"left",transition:"all 0.15s"},children:[f.jsx("div",{onClick:S=>m(y,S),style:{width:"32px",height:"32px",borderRadius:"50%",background:v?_:"var(--color-background)",border:v?"none":"1px solid var(--color-text-muted)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,cursor:"pointer"},children:a===y.code?f.jsx(rT,{color:v?"#1A1A2E":"var(--color-text)"}):v?f.jsx(nT,{}):f.jsx(tT,{})}),f.jsxs("div",{style:{minWidth:0,flex:1},children:[f.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:v?_:"var(--color-accent)"},children:y.code}),f.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.name})]})]},y.code)})})}),f.jsx("div",{style:{flexShrink:0,paddingBottom:"var(--safe-area-bottom, 0px)"},children:f.jsx("button",{onClick:g,disabled:n.length===0,style:{width:"100%",padding:"16px",fontSize:"18px",fontWeight:700,background:n.length>0?"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)":"var(--color-surface)",color:n.length>0?"white":"var(--color-text-muted)",border:"none",borderRadius:"12px",cursor:n.length>0?"pointer":"not-allowed",boxShadow:n.length>0?"0 4px 12px rgba(45, 90, 39, 0.3)":"none"},children:n.length>0?`Choose Level (${n.length} Bird${n.length>1?"s":""})`:"Select birds to play"})})]})}function eT(){return f.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{d:"M15 18l-6-6 6-6"})})}function tT(){return f.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-text-muted)",children:f.jsx("path",{d:"M8 5v14l11-7z"})})}function rT({color:t="currentColor"}){return f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:t,children:f.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function nT(){return f.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#1A1A2E",strokeWidth:"3",children:f.jsx("path",{d:"M20 6L9 17l-5-5"})})}const iT={campaign:"Learn",practice:"Practice",challenge:"Challenge",random:"Random"};function sT({score:t,streak:e,timeRemaining:r,mode:n,levelId:i,levelTitle:s}){const o=Math.floor(r/60),a=r%60,l=`${o}:${a.toString().padStart(2,"0")}`;return f.jsxs("div",{className:"hud",children:[f.jsxs("div",{className:"hud-score",children:[f.jsx("span",{className:"hud-label",children:"Score"}),f.jsx("span",{className:"hud-value",children:t.toLocaleString()})]}),f.jsxs("div",{className:"hud-center",children:[n==="campaign"&&i?f.jsxs("span",{className:"hud-mode",children:["Level ",i,s?`: ${s}`:""]}):n?f.jsx("span",{className:"hud-mode",children:iT[n]||n}):null,f.jsx("div",{className:"hud-streak",children:e===0?f.jsx("span",{className:"streak-dot",children:""}):Array.from({length:e}).map((u,c)=>f.jsx("span",{className:"streak-dot active",children:""},c))})]}),f.jsxs("div",{className:"hud-timer",children:[f.jsx("span",{className:"hud-label",children:"Time"}),f.jsx("span",{className:"hud-value",children:l})]}),f.jsx("style",{children:`
        .hud {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          padding-top: calc(12px + var(--safe-area-top, 0px));
          background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.3) 100%);
          border-bottom: 1px solid var(--color-surface);
        }

        .hud-score, .hud-timer {
          display: flex;
          flex-direction: column;
          align-items: center;
          min-width: 80px;
        }

        .hud-label {
          font-size: 10px;
          text-transform: uppercase;
          color: var(--color-text-muted);
          letter-spacing: 0.5px;
        }

        .hud-value {
          font-family: var(--font-mono);
          font-size: 20px;
          font-weight: 600;
          color: var(--color-accent);
        }

        .hud-center {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 4px;
        }

        .hud-mode {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1px;
          color: var(--color-text-muted);
          padding: 2px 8px;
          border-radius: 4px;
          background: rgba(255, 255, 255, 0.1);
        }

        .hud-streak {
          display: flex;
          gap: 4px;
          font-size: 12px;
        }

        .streak-dot {
          color: var(--color-text-muted);
          transition: color 0.2s, transform 0.2s;
        }

        .streak-dot.active {
          color: var(--color-accent);
          transform: scale(1.2);
        }
      `})]})}const oT=E.memo(sT);var ki=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(ki||{}),Vx=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(Vx||{}),Cd=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Cd||{}),ne=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(ne||{}),kr=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(kr||{}),j=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(j||{}),Ss=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Ss||{}),J=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(J||{}),$=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))($||{}),Xr=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(Xr||{}),jn=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(jn||{}),Dr=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Dr||{}),Rt=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Rt||{}),Rr=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Rr||{}),bp=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(bp||{}),Yt=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(Yt||{}),qe=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(qe||{}),We=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(We||{}),Nr=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(Nr||{});const aT={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},H={ADAPTER:aT,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Dc=/iPhone/i,_g=/iPod/i,wg=/iPad/i,Sg=/\biOS-universal(?:.+)Mac\b/i,Lc=/\bAndroid(?:.+)Mobile\b/i,Eg=/Android/i,ji=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Oa=/Silk/i,jr=/Windows Phone/i,bg=/\bWindows(?:.+)ARM\b/i,Tg=/BlackBerry/i,Ag=/BB10/i,Cg=/Opera Mini/i,Rg=/\b(CriOS|Chrome)(?:.+)Mobile/i,Pg=/Mobile(?:.+)Firefox\b/i,Ig=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function lT(t){return function(e){return e.test(t)}}function kg(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,n=r.split("[FBAN");typeof n[1]<"u"&&(r=n[0]),n=r.split("Twitter"),typeof n[1]<"u"&&(r=n[0]);var i=lT(r),s={apple:{phone:i(Dc)&&!i(jr),ipod:i(_g),tablet:!i(Dc)&&(i(wg)||Ig(e))&&!i(jr),universal:i(Sg),device:(i(Dc)||i(_g)||i(wg)||i(Sg)||Ig(e))&&!i(jr)},amazon:{phone:i(ji),tablet:!i(ji)&&i(Oa),device:i(ji)||i(Oa)},android:{phone:!i(jr)&&i(ji)||!i(jr)&&i(Lc),tablet:!i(jr)&&!i(ji)&&!i(Lc)&&(i(Oa)||i(Eg)),device:!i(jr)&&(i(ji)||i(Oa)||i(Lc)||i(Eg))||i(/\bokhttp\b/i)},windows:{phone:i(jr),tablet:i(bg),device:i(jr)||i(bg)},other:{blackberry:i(Tg),blackberry10:i(Ag),opera:i(Cg),firefox:i(Pg),chrome:i(Rg),device:i(Tg)||i(Ag)||i(Cg)||i(Pg)||i(Rg)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const uT=kg.default??kg,Yr=uT(globalThis.navigator);H.RETINA_PREFIX=/@([0-9\.]+)x/;H.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var $x={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var m=new i(c,h||l,d),g=r?r+u:u;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],m]:l._events[g].push(m):(l._events[g]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=r?r+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,m=h.length,g=new Array(m);d<m;d++)g[d]=h[d].fn;return g},a.prototype.listenerCount=function(u){var c=r?r+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,d,m,g){var x=r?r+u:u;if(!this._events[x])return!1;var w=this._events[x],y=arguments.length,v,p;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),y){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,c),!0;case 3:return w.fn.call(w.context,c,h),!0;case 4:return w.fn.call(w.context,c,h,d),!0;case 5:return w.fn.call(w.context,c,h,d,m),!0;case 6:return w.fn.call(w.context,c,h,d,m,g),!0}for(p=1,v=new Array(y-1);p<y;p++)v[p-1]=arguments[p];w.fn.apply(w.context,v)}else{var _=w.length,S;for(p=0;p<_;p++)switch(w[p].once&&this.removeListener(u,w[p].fn,void 0,!0),y){case 1:w[p].fn.call(w[p].context);break;case 2:w[p].fn.call(w[p].context,c);break;case 3:w[p].fn.call(w[p].context,c,h);break;case 4:w[p].fn.call(w[p].context,c,h,d);break;default:if(!v)for(S=1,v=new Array(y-1);S<y;S++)v[S-1]=arguments[S];w[p].fn.apply(w[p].context,v)}}return!0},a.prototype.on=function(u,c,h){return s(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return s(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,d){var m=r?r+u:u;if(!this._events[m])return this;if(!c)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===c&&(!d||g.once)&&(!h||g.context===h)&&o(this,m);else{for(var x=0,w=[],y=g.length;x<y;x++)(g[x].fn!==c||d&&!g[x].once||h&&g[x].context!==h)&&w.push(g[x]);w.length?this._events[m]=w.length===1?w[0]:w:o(this,m)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=r?r+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})($x);var cT=$x.exports;const da=bf(cT);var Tp={exports:{}};Tp.exports=Gu;Tp.exports.default=Gu;function Gu(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=Hx(t,0,i,r,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,c,h,d,m;if(n&&(s=mT(t,e,s,r)),t.length>80*r){a=u=t[0],l=c=t[1];for(var g=r;g<i;g+=r)h=t[g],d=t[g+1],h<a&&(a=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);m=Math.max(u-a,c-l),m=m!==0?32767/m:0}return ea(s,o,r,a,l,m,0),o}function Hx(t,e,r,n,i){var s,o;if(i===Id(t,e,r,n)>0)for(s=e;s<r;s+=n)o=Mg(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=Mg(s,t[s],t[s+1],o);return o&&zu(o,o.next)&&(ra(o),o=o.next),o}function Ei(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(zu(r,r.next)||Oe(r.prev,r,r.next)===0)){if(ra(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function ea(t,e,r,n,i,s,o){if(t){!o&&s&&_T(t,n,i,s);for(var a=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,s?dT(t,n,i,s):hT(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),ra(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=fT(Ei(t),e,r),ea(t,e,r,n,i,s,2)):o===2&&pT(t,e,r,n,i,s):ea(Ei(t),e,r,n,i,s,1);break}}}}function hT(t){var e=t.prev,r=t,n=t.next;if(Oe(e,r,n)>=0)return!1;for(var i=e.x,s=r.x,o=n.x,a=e.y,l=r.y,u=n.y,c=i<s?i<o?i:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,d=i>s?i>o?i:o:s>o?s:o,m=a>l?a>u?a:u:l>u?l:u,g=n.next;g!==e;){if(g.x>=c&&g.x<=d&&g.y>=h&&g.y<=m&&ps(i,a,s,l,o,u,g.x,g.y)&&Oe(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function dT(t,e,r,n){var i=t.prev,s=t,o=t.next;if(Oe(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,u=o.x,c=i.y,h=s.y,d=o.y,m=a<l?a<u?a:u:l<u?l:u,g=c<h?c<d?c:d:h<d?h:d,x=a>l?a>u?a:u:l>u?l:u,w=c>h?c>d?c:d:h>d?h:d,y=Rd(m,g,e,r,n),v=Rd(x,w,e,r,n),p=t.prevZ,_=t.nextZ;p&&p.z>=y&&_&&_.z<=v;){if(p.x>=m&&p.x<=x&&p.y>=g&&p.y<=w&&p!==i&&p!==o&&ps(a,c,l,h,u,d,p.x,p.y)&&Oe(p.prev,p,p.next)>=0||(p=p.prevZ,_.x>=m&&_.x<=x&&_.y>=g&&_.y<=w&&_!==i&&_!==o&&ps(a,c,l,h,u,d,_.x,_.y)&&Oe(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;p&&p.z>=y;){if(p.x>=m&&p.x<=x&&p.y>=g&&p.y<=w&&p!==i&&p!==o&&ps(a,c,l,h,u,d,p.x,p.y)&&Oe(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;_&&_.z<=v;){if(_.x>=m&&_.x<=x&&_.y>=g&&_.y<=w&&_!==i&&_!==o&&ps(a,c,l,h,u,d,_.x,_.y)&&Oe(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function fT(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!zu(i,s)&&Wx(i,n,n.next,s)&&ta(i,s)&&ta(s,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(s.i/r|0),ra(n),ra(n.next),n=t=s),n=n.next}while(n!==t);return Ei(n)}function pT(t,e,r,n,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&ET(o,a)){var l=Xx(o,a);o=Ei(o,o.next),l=Ei(l,l.next),ea(o,e,r,n,i,s,0),ea(l,e,r,n,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function mT(t,e,r,n){var i=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:t.length,u=Hx(t,a,l,n,!1),u===u.next&&(u.steiner=!0),i.push(ST(u));for(i.sort(gT),s=0;s<i.length;s++)r=yT(i[s],r);return r}function gT(t,e){return t.x-e.x}function yT(t,e){var r=vT(t,e);if(!r)return e;var n=Xx(r,t);return Ei(n,n.next),Ei(r,r.next)}function vT(t,e){var r=e,n=t.x,i=t.y,s=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s&&(s=a,o=r.x<r.next.x?r:r.next,a===n))return o}r=r.next}while(r!==e);if(!o)return null;var l=o,u=o.x,c=o.y,h=1/0,d;r=o;do n>=r.x&&r.x>=u&&n!==r.x&&ps(i<c?n:s,i,u,c,i<c?s:n,i,r.x,r.y)&&(d=Math.abs(i-r.y)/(n-r.x),ta(r,t)&&(d<h||d===h&&(r.x>o.x||r.x===o.x&&xT(o,r)))&&(o=r,h=d)),r=r.next;while(r!==l);return o}function xT(t,e){return Oe(t.prev,t,e.prev)<0&&Oe(e.next,t,t.next)<0}function _T(t,e,r,n){var i=t;do i.z===0&&(i.z=Rd(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,wT(i)}function wT(t){var e,r,n,i,s,o,a,l,u=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,n=r,a=0,e=0;e<u&&(a++,n=n.nextZ,!!n);e++);for(l=u;a>0||l>0&&n;)a!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n}s.nextZ=null,u*=2}while(o>1);return t}function Rd(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function ST(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function ps(t,e,r,n,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(r-o)*(e-a)&&(r-o)*(s-a)>=(i-o)*(n-a)}function ET(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!bT(t,e)&&(ta(t,e)&&ta(e,t)&&TT(t,e)&&(Oe(t.prev,t,e.prev)||Oe(t,e.prev,e))||zu(t,e)&&Oe(t.prev,t,t.next)>0&&Oe(e.prev,e,e.next)>0)}function Oe(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function zu(t,e){return t.x===e.x&&t.y===e.y}function Wx(t,e,r,n){var i=ja(Oe(t,e,r)),s=ja(Oe(t,e,n)),o=ja(Oe(r,n,t)),a=ja(Oe(r,n,e));return!!(i!==s&&o!==a||i===0&&Ua(t,r,e)||s===0&&Ua(t,n,e)||o===0&&Ua(r,t,n)||a===0&&Ua(r,e,n))}function Ua(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function ja(t){return t>0?1:t<0?-1:0}function bT(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Wx(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function ta(t,e){return Oe(t.prev,t,t.next)<0?Oe(t,e,t.next)>=0&&Oe(t,t.prev,e)>=0:Oe(t,e,t.prev)<0||Oe(t,t.next,e)<0}function TT(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function Xx(t,e){var r=new Pd(t.i,t.x,t.y),n=new Pd(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function Mg(t,e,r,n){var i=new Pd(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ra(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Pd(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Gu.deviation=function(t,e,r,n){var i=e&&e.length,s=i?e[0]*r:t.length,o=Math.abs(Id(t,0,s,r));if(i)for(var a=0,l=e.length;a<l;a++){var u=e[a]*r,c=a<l-1?e[a+1]*r:t.length;o-=Math.abs(Id(t,u,c,r))}var h=0;for(a=0;a<n.length;a+=3){var d=n[a]*r,m=n[a+1]*r,g=n[a+2]*r;h+=Math.abs((t[d]-t[g])*(t[m+1]-t[d+1])-(t[d]-t[m])*(t[g+1]-t[d+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function Id(t,e,r,n){for(var i=0,s=e,o=r-n;s<r;s+=n)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}Gu.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[i][s][o]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var AT=Tp.exports;const CT=bf(AT);var iu={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */iu.exports;(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof _o=="object"&&_o;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a=2147483647,l=36,u=1,c=26,h=38,d=700,m=72,g=128,x="-",w=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=l-u,S=Math.floor,b=String.fromCharCode,A;function T(R){throw new RangeError(p[R])}function M(R,F){for(var Z=R.length,he=[];Z--;)he[Z]=F(R[Z]);return he}function I(R,F){var Z=R.split("@"),he="";Z.length>1&&(he=Z[0]+"@",R=Z[1]),R=R.replace(v,".");var ue=R.split("."),_e=M(ue,F).join(".");return he+_e}function W(R){for(var F=[],Z=0,he=R.length,ue,_e;Z<he;)ue=R.charCodeAt(Z++),ue>=55296&&ue<=56319&&Z<he?(_e=R.charCodeAt(Z++),(_e&64512)==56320?F.push(((ue&1023)<<10)+(_e&1023)+65536):(F.push(ue),Z--)):F.push(ue);return F}function G(R){return M(R,function(F){var Z="";return F>65535&&(F-=65536,Z+=b(F>>>10&1023|55296),F=56320|F&1023),Z+=b(F),Z}).join("")}function C(R){return R-48<10?R-22:R-65<26?R-65:R-97<26?R-97:l}function N(R,F){return R+22+75*(R<26)-((F!=0)<<5)}function z(R,F,Z){var he=0;for(R=Z?S(R/d):R>>1,R+=S(R/F);R>_*c>>1;he+=l)R=S(R/_);return S(he+(_+1)*R/(R+h))}function B(R){var F=[],Z=R.length,he,ue=0,_e=g,xe=m,Re,Je,yt,Be,Te,Ae,Ee,ct,vt;for(Re=R.lastIndexOf(x),Re<0&&(Re=0),Je=0;Je<Re;++Je)R.charCodeAt(Je)>=128&&T("not-basic"),F.push(R.charCodeAt(Je));for(yt=Re>0?Re+1:0;yt<Z;){for(Be=ue,Te=1,Ae=l;yt>=Z&&T("invalid-input"),Ee=C(R.charCodeAt(yt++)),(Ee>=l||Ee>S((a-ue)/Te))&&T("overflow"),ue+=Ee*Te,ct=Ae<=xe?u:Ae>=xe+c?c:Ae-xe,!(Ee<ct);Ae+=l)vt=l-ct,Te>S(a/vt)&&T("overflow"),Te*=vt;he=F.length+1,xe=z(ue-Be,he,Be==0),S(ue/he)>a-_e&&T("overflow"),_e+=S(ue/he),ue%=he,F.splice(ue++,0,_e)}return G(F)}function k(R){var F,Z,he,ue,_e,xe,Re,Je,yt,Be,Te,Ae=[],Ee,ct,vt,vr;for(R=W(R),Ee=R.length,F=g,Z=0,_e=m,xe=0;xe<Ee;++xe)Te=R[xe],Te<128&&Ae.push(b(Te));for(he=ue=Ae.length,ue&&Ae.push(x);he<Ee;){for(Re=a,xe=0;xe<Ee;++xe)Te=R[xe],Te>=F&&Te<Re&&(Re=Te);for(ct=he+1,Re-F>S((a-Z)/ct)&&T("overflow"),Z+=(Re-F)*ct,F=Re,xe=0;xe<Ee;++xe)if(Te=R[xe],Te<F&&++Z>a&&T("overflow"),Te==F){for(Je=Z,yt=l;Be=yt<=_e?u:yt>=_e+c?c:yt-_e,!(Je<Be);yt+=l)vr=Je-Be,vt=l-Be,Ae.push(b(N(Be+vr%vt,0))),Je=S(vr/vt);Ae.push(b(N(Je,0))),_e=z(Z,ct,he==ue),Z=0,++he}++Z,++F}return Ae.join("")}function P(R){return I(R,function(F){return w.test(F)?B(F.slice(4).toLowerCase()):F})}function D(R){return I(R,function(F){return y.test(F)?"xn--"+k(F):F})}if(o={version:"1.4.1",ucs2:{decode:W,encode:G},decode:B,encode:k,toASCII:D,toUnicode:P},n&&i)if(t.exports==n)i.exports=o;else for(A in o)o.hasOwnProperty(A)&&(n[A]=o[A]);else r.punycode=o})(_o)})(iu,iu.exports);var RT=iu.exports,$s=TypeError;const PT={},IT=Object.freeze(Object.defineProperty({__proto__:null,default:PT},Symbol.toStringTag,{value:"Module"})),kT=$1(IT);var Ap=typeof Map=="function"&&Map.prototype,Oc=Object.getOwnPropertyDescriptor&&Ap?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,su=Ap&&Oc&&typeof Oc.get=="function"?Oc.get:null,Bg=Ap&&Map.prototype.forEach,Cp=typeof Set=="function"&&Set.prototype,Uc=Object.getOwnPropertyDescriptor&&Cp?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ou=Cp&&Uc&&typeof Uc.get=="function"?Uc.get:null,Ng=Cp&&Set.prototype.forEach,MT=typeof WeakMap=="function"&&WeakMap.prototype,Io=MT?WeakMap.prototype.has:null,BT=typeof WeakSet=="function"&&WeakSet.prototype,ko=BT?WeakSet.prototype.has:null,NT=typeof WeakRef=="function"&&WeakRef.prototype,Fg=NT?WeakRef.prototype.deref:null,FT=Boolean.prototype.valueOf,DT=Object.prototype.toString,LT=Function.prototype.toString,OT=String.prototype.match,Rp=String.prototype.slice,Rn=String.prototype.replace,UT=String.prototype.toUpperCase,Dg=String.prototype.toLowerCase,Yx=RegExp.prototype.test,Lg=Array.prototype.concat,Pr=Array.prototype.join,jT=Array.prototype.slice,Og=Math.floor,kd=typeof BigInt=="function"?BigInt.prototype.valueOf:null,jc=Object.getOwnPropertySymbols,Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Mo=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ls||!0)?Symbol.toStringTag:null,Kx=Object.prototype.propertyIsEnumerable,Ug=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function jg(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||Yx.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-Og(-t):Og(t);if(n!==t){var i=String(n),s=Rp.call(e,i.length+1);return Rn.call(i,r,"$&_")+"."+Rn.call(Rn.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Rn.call(e,r,"$&_")}var Bd=kT,Gg=Bd.custom,zg=Qx(Gg)?Gg:null,qx={__proto__:null,double:'"',single:"'"},GT={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},Vu=function t(e,r,n,i){var s=r||{};if(Vr(s,"quoteStyle")&&!Vr(qx,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Vr(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Vr(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Vr(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Vr(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return e_(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?jg(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return a?jg(e,u):u}var c=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=c&&c>0&&typeof e=="object")return Nd(e)?"[Array]":"[Object]";var h=sA(s,n);if(typeof i>"u")i=[];else if(Jx(i,e)>=0)return"[Circular]";function d(C,N,z){if(N&&(i=jT.call(i),i.push(N)),z){var B={depth:s.depth};return Vr(s,"quoteStyle")&&(B.quoteStyle=s.quoteStyle),t(C,B,n+1,i)}return t(C,s,n+1,i)}if(typeof e=="function"&&!Vg(e)){var m=qT(e),g=Ga(e,d);return"[Function"+(m?": "+m:" (anonymous)")+"]"+(g.length>0?" { "+Pr.call(g,", ")+" }":"")}if(Qx(e)){var x=Ls?Rn.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Md.call(e);return typeof e=="object"&&!Ls?ro(x):x}if(rA(e)){for(var w="<"+Dg.call(String(e.nodeName)),y=e.attributes||[],v=0;v<y.length;v++)w+=" "+y[v].name+"="+Zx(zT(y[v].value),"double",s);return w+=">",e.childNodes&&e.childNodes.length&&(w+="..."),w+="</"+Dg.call(String(e.nodeName))+">",w}if(Nd(e)){if(e.length===0)return"[]";var p=Ga(e,d);return h&&!iA(p)?"["+Fd(p,h)+"]":"[ "+Pr.call(p,", ")+" ]"}if($T(e)){var _=Ga(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!Kx.call(e,"cause")?"{ ["+String(e)+"] "+Pr.call(Lg.call("[cause]: "+d(e.cause),_),", ")+" }":_.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Pr.call(_,", ")+" }"}if(typeof e=="object"&&o){if(zg&&typeof e[zg]=="function"&&Bd)return Bd(e,{depth:c-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(ZT(e)){var S=[];return Bg&&Bg.call(e,function(C,N){S.push(d(N,e,!0)+" => "+d(C,e))}),$g("Map",su.call(e),S,h)}if(eA(e)){var b=[];return Ng&&Ng.call(e,function(C){b.push(d(C,e))}),$g("Set",ou.call(e),b,h)}if(QT(e))return Gc("WeakMap");if(tA(e))return Gc("WeakSet");if(JT(e))return Gc("WeakRef");if(WT(e))return ro(d(Number(e)));if(YT(e))return ro(d(kd.call(e)));if(XT(e))return ro(FT.call(e));if(HT(e))return ro(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof _o<"u"&&e===_o)return"{ [object globalThis] }";if(!VT(e)&&!Vg(e)){var A=Ga(e,d),T=Ug?Ug(e)===Object.prototype:e instanceof Object||e.constructor===Object,M=e instanceof Object?"":"null prototype",I=!T&&Mo&&Object(e)===e&&Mo in e?Rp.call(Kn(e),8,-1):M?"Object":"",W=T||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",G=W+(I||M?"["+Pr.call(Lg.call([],I||[],M||[]),": ")+"] ":"");return A.length===0?G+"{}":h?G+"{"+Fd(A,h)+"}":G+"{ "+Pr.call(A,", ")+" }"}return String(e)};function Zx(t,e,r){var n=r.quoteStyle||e,i=qx[n];return i+t+i}function zT(t){return Rn.call(String(t),/"/g,"&quot;")}function Mi(t){return!Mo||!(typeof t=="object"&&(Mo in t||typeof t[Mo]<"u"))}function Nd(t){return Kn(t)==="[object Array]"&&Mi(t)}function VT(t){return Kn(t)==="[object Date]"&&Mi(t)}function Vg(t){return Kn(t)==="[object RegExp]"&&Mi(t)}function $T(t){return Kn(t)==="[object Error]"&&Mi(t)}function HT(t){return Kn(t)==="[object String]"&&Mi(t)}function WT(t){return Kn(t)==="[object Number]"&&Mi(t)}function XT(t){return Kn(t)==="[object Boolean]"&&Mi(t)}function Qx(t){if(Ls)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Md)return!1;try{return Md.call(t),!0}catch{}return!1}function YT(t){if(!t||typeof t!="object"||!kd)return!1;try{return kd.call(t),!0}catch{}return!1}var KT=Object.prototype.hasOwnProperty||function(t){return t in this};function Vr(t,e){return KT.call(t,e)}function Kn(t){return DT.call(t)}function qT(t){if(t.name)return t.name;var e=OT.call(LT.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function Jx(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function ZT(t){if(!su||!t||typeof t!="object")return!1;try{su.call(t);try{ou.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function QT(t){if(!Io||!t||typeof t!="object")return!1;try{Io.call(t,Io);try{ko.call(t,ko)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function JT(t){if(!Fg||!t||typeof t!="object")return!1;try{return Fg.call(t),!0}catch{}return!1}function eA(t){if(!ou||!t||typeof t!="object")return!1;try{ou.call(t);try{su.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function tA(t){if(!ko||!t||typeof t!="object")return!1;try{ko.call(t,ko);try{Io.call(t,Io)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function rA(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function e_(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return e_(Rp.call(t,0,e.maxStringLength),e)+n}var i=GT[e.quoteStyle||"single"];i.lastIndex=0;var s=Rn.call(Rn.call(t,i,"\\$1"),/[\x00-\x1f]/g,nA);return Zx(s,"single",e)}function nA(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+UT.call(e.toString(16))}function ro(t){return"Object("+t+")"}function Gc(t){return t+" { ? }"}function $g(t,e,r,n){var i=n?Fd(r,n):Pr.call(r,", ");return t+" ("+e+") {"+i+"}"}function iA(t){for(var e=0;e<t.length;e++)if(Jx(t[e],`
`)>=0)return!1;return!0}function sA(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=Pr.call(Array(t.indent+1)," ");else return null;return{base:r,prev:Pr.call(Array(e+1),r)}}function Fd(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+Pr.call(t,","+r)+`
`+e.prev}function Ga(t,e){var r=Nd(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=Vr(t,i)?e(t[i],t):""}var s=typeof jc=="function"?jc(t):[],o;if(Ls){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in t)Vr(t,l)&&(r&&String(Number(l))===l&&l<t.length||Ls&&o["$"+l]instanceof Symbol||(Yx.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if(typeof jc=="function")for(var u=0;u<s.length;u++)Kx.call(t,s[u])&&n.push("["+e(s[u])+"]: "+e(t[s[u]],t));return n}var oA=Vu,aA=$s,$u=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},lA=function(t,e){if(t){var r=$u(t,e);return r&&r.value}},uA=function(t,e,r){var n=$u(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},cA=function(t,e){return t?!!$u(t,e):!1},hA=function(t,e){if(t)return $u(t,e,!0)},dA=function(){var e,r={assert:function(n){if(!r.has(n))throw new aA("Side channel does not contain "+oA(n))},delete:function(n){var i=e&&e.next,s=hA(e,n);return s&&i&&i===s&&(e=void 0),!!s},get:function(n){return lA(e,n)},has:function(n){return cA(e,n)},set:function(n,i){e||(e={next:void 0}),uA(e,n,i)}};return r},t_=Object,fA=Error,pA=EvalError,mA=RangeError,gA=ReferenceError,yA=SyntaxError,vA=URIError,xA=Math.abs,_A=Math.floor,wA=Math.max,SA=Math.min,EA=Math.pow,bA=Math.round,TA=Number.isNaN||function(e){return e!==e},AA=TA,CA=function(e){return AA(e)||e===0?e:e<0?-1:1},RA=Object.getOwnPropertyDescriptor,wl=RA;if(wl)try{wl([],"length")}catch{wl=null}var r_=wl,Sl=Object.defineProperty||!1;if(Sl)try{Sl({},"a",{value:1})}catch{Sl=!1}var PA=Sl,zc,Hg;function IA(){return Hg||(Hg=1,zc=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),zc}var Vc,Wg;function kA(){if(Wg)return Vc;Wg=1;var t=typeof Symbol<"u"&&Symbol,e=IA();return Vc=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Vc}var $c,Xg;function n_(){return Xg||(Xg=1,$c=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),$c}var Hc,Yg;function i_(){if(Yg)return Hc;Yg=1;var t=t_;return Hc=t.getPrototypeOf||null,Hc}var MA="Function.prototype.bind called on incompatible ",BA=Object.prototype.toString,NA=Math.max,FA="[object Function]",Kg=function(e,r){for(var n=[],i=0;i<e.length;i+=1)n[i]=e[i];for(var s=0;s<r.length;s+=1)n[s+e.length]=r[s];return n},DA=function(e,r){for(var n=[],i=r,s=0;i<e.length;i+=1,s+=1)n[s]=e[i];return n},LA=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},OA=function(e){var r=this;if(typeof r!="function"||BA.apply(r)!==FA)throw new TypeError(MA+r);for(var n=DA(arguments,1),i,s=function(){if(this instanceof i){var c=r.apply(this,Kg(n,arguments));return Object(c)===c?c:this}return r.apply(e,Kg(n,arguments))},o=NA(0,r.length-n.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+LA(a,",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var u=function(){};u.prototype=r.prototype,i.prototype=new u,u.prototype=null}return i},UA=OA,Hu=Function.prototype.bind||UA,Pp=Function.prototype.call,Wc,qg;function s_(){return qg||(qg=1,Wc=Function.prototype.apply),Wc}var jA=typeof Reflect<"u"&&Reflect&&Reflect.apply,GA=Hu,zA=s_(),VA=Pp,$A=jA,HA=$A||GA.call(VA,zA),WA=Hu,XA=$s,YA=Pp,KA=HA,o_=function(e){if(e.length<1||typeof e[0]!="function")throw new XA("a function is required");return KA(WA,YA,e)},Xc,Zg;function qA(){if(Zg)return Xc;Zg=1;var t=o_,e=r_,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return Xc=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,Xc}var Yc,Qg;function ZA(){if(Qg)return Yc;Qg=1;var t=n_(),e=i_(),r=qA();return Yc=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,Yc}var Kc,Jg;function QA(){if(Jg)return Kc;Jg=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=Hu;return Kc=r.call(t,e),Kc}var fe,JA=t_,eC=fA,tC=pA,rC=mA,nC=gA,Os=yA,Es=$s,iC=vA,sC=xA,oC=_A,aC=wA,lC=SA,uC=EA,cC=bA,hC=CA,a_=Function,qc=function(t){try{return a_('"use strict"; return ('+t+").constructor;")()}catch{}},na=r_,dC=PA,Zc=function(){throw new Es},fC=na?function(){try{return arguments.callee,Zc}catch{try{return na(arguments,"callee").get}catch{return Zc}}}():Zc,Gi=kA()(),et=ZA(),pC=i_(),mC=n_(),l_=s_(),fa=Pp,Ki={},gC=typeof Uint8Array>"u"||!et?fe:et(Uint8Array),mi={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?fe:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?fe:ArrayBuffer,"%ArrayIteratorPrototype%":Gi&&et?et([][Symbol.iterator]()):fe,"%AsyncFromSyncIteratorPrototype%":fe,"%AsyncFunction%":Ki,"%AsyncGenerator%":Ki,"%AsyncGeneratorFunction%":Ki,"%AsyncIteratorPrototype%":Ki,"%Atomics%":typeof Atomics>"u"?fe:Atomics,"%BigInt%":typeof BigInt>"u"?fe:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?fe:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?fe:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?fe:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":eC,"%eval%":eval,"%EvalError%":tC,"%Float16Array%":typeof Float16Array>"u"?fe:Float16Array,"%Float32Array%":typeof Float32Array>"u"?fe:Float32Array,"%Float64Array%":typeof Float64Array>"u"?fe:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?fe:FinalizationRegistry,"%Function%":a_,"%GeneratorFunction%":Ki,"%Int8Array%":typeof Int8Array>"u"?fe:Int8Array,"%Int16Array%":typeof Int16Array>"u"?fe:Int16Array,"%Int32Array%":typeof Int32Array>"u"?fe:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Gi&&et?et(et([][Symbol.iterator]())):fe,"%JSON%":typeof JSON=="object"?JSON:fe,"%Map%":typeof Map>"u"?fe:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Gi||!et?fe:et(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":JA,"%Object.getOwnPropertyDescriptor%":na,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?fe:Promise,"%Proxy%":typeof Proxy>"u"?fe:Proxy,"%RangeError%":rC,"%ReferenceError%":nC,"%Reflect%":typeof Reflect>"u"?fe:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?fe:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Gi||!et?fe:et(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?fe:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Gi&&et?et(""[Symbol.iterator]()):fe,"%Symbol%":Gi?Symbol:fe,"%SyntaxError%":Os,"%ThrowTypeError%":fC,"%TypedArray%":gC,"%TypeError%":Es,"%Uint8Array%":typeof Uint8Array>"u"?fe:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?fe:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?fe:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?fe:Uint32Array,"%URIError%":iC,"%WeakMap%":typeof WeakMap>"u"?fe:WeakMap,"%WeakRef%":typeof WeakRef>"u"?fe:WeakRef,"%WeakSet%":typeof WeakSet>"u"?fe:WeakSet,"%Function.prototype.call%":fa,"%Function.prototype.apply%":l_,"%Object.defineProperty%":dC,"%Object.getPrototypeOf%":pC,"%Math.abs%":sC,"%Math.floor%":oC,"%Math.max%":aC,"%Math.min%":lC,"%Math.pow%":uC,"%Math.round%":cC,"%Math.sign%":hC,"%Reflect.getPrototypeOf%":mC};if(et)try{null.error}catch(t){var yC=et(et(t));mi["%Error.prototype%"]=yC}var vC=function t(e){var r;if(e==="%AsyncFunction%")r=qc("async function () {}");else if(e==="%GeneratorFunction%")r=qc("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=qc("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&et&&(r=et(i.prototype))}return mi[e]=r,r},ey={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},pa=Hu,au=QA(),xC=pa.call(fa,Array.prototype.concat),_C=pa.call(l_,Array.prototype.splice),ty=pa.call(fa,String.prototype.replace),lu=pa.call(fa,String.prototype.slice),wC=pa.call(fa,RegExp.prototype.exec),SC=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,EC=/\\(\\)?/g,bC=function(e){var r=lu(e,0,1),n=lu(e,-1);if(r==="%"&&n!=="%")throw new Os("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Os("invalid intrinsic syntax, expected opening `%`");var i=[];return ty(e,SC,function(s,o,a,l){i[i.length]=a?ty(l,EC,"$1"):o||s}),i},TC=function(e,r){var n=e,i;if(au(ey,n)&&(i=ey[n],n="%"+i[0]+"%"),au(mi,n)){var s=mi[n];if(s===Ki&&(s=vC(n)),typeof s>"u"&&!r)throw new Es("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Os("intrinsic "+e+" does not exist!")},Ip=function(e,r){if(typeof e!="string"||e.length===0)throw new Es("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Es('"allowMissing" argument must be a boolean');if(wC(/^%?[^%]*%?$/,e)===null)throw new Os("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=bC(e),i=n.length>0?n[0]:"",s=TC("%"+i+"%",r),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],_C(n,xC([0,1],u)));for(var c=1,h=!0;c<n.length;c+=1){var d=n[c],m=lu(d,0,1),g=lu(d,-1);if((m==='"'||m==="'"||m==="`"||g==='"'||g==="'"||g==="`")&&m!==g)throw new Os("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(l=!0),i+="."+d,o="%"+i+"%",au(mi,o))a=mi[o];else if(a!=null){if(!(d in a)){if(!r)throw new Es("base intrinsic for "+e+" exists, but the property is not available.");return}if(na&&c+1>=n.length){var x=na(a,d);h=!!x,h&&"get"in x&&!("originalValue"in x.get)?a=x.get:a=a[d]}else h=au(a,d),a=a[d];h&&!l&&(mi[o]=a)}}return a},u_=Ip,c_=o_,AC=c_([u_("%String.prototype.indexOf%")]),h_=function(e,r){var n=u_(e,!!r);return typeof n=="function"&&AC(e,".prototype.")>-1?c_([n]):n},CC=Ip,ma=h_,RC=Vu,PC=$s,ry=CC("%Map%",!0),IC=ma("Map.prototype.get",!0),kC=ma("Map.prototype.set",!0),MC=ma("Map.prototype.has",!0),BC=ma("Map.prototype.delete",!0),NC=ma("Map.prototype.size",!0),d_=!!ry&&function(){var e,r={assert:function(n){if(!r.has(n))throw new PC("Side channel does not contain "+RC(n))},delete:function(n){if(e){var i=BC(e,n);return NC(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return IC(e,n)},has:function(n){return e?MC(e,n):!1},set:function(n,i){e||(e=new ry),kC(e,n,i)}};return r},FC=Ip,Wu=h_,DC=Vu,za=d_,LC=$s,zi=FC("%WeakMap%",!0),OC=Wu("WeakMap.prototype.get",!0),UC=Wu("WeakMap.prototype.set",!0),jC=Wu("WeakMap.prototype.has",!0),GC=Wu("WeakMap.prototype.delete",!0),zC=zi?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new LC("Side channel does not contain "+DC(i))},delete:function(i){if(zi&&i&&(typeof i=="object"||typeof i=="function")){if(e)return GC(e,i)}else if(za&&r)return r.delete(i);return!1},get:function(i){return zi&&i&&(typeof i=="object"||typeof i=="function")&&e?OC(e,i):r&&r.get(i)},has:function(i){return zi&&i&&(typeof i=="object"||typeof i=="function")&&e?jC(e,i):!!r&&r.has(i)},set:function(i,s){zi&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new zi),UC(e,i,s)):za&&(r||(r=za()),r.set(i,s))}};return n}:za,VC=$s,$C=Vu,HC=dA,WC=d_,XC=zC,YC=XC||WC||HC,f_=function(){var e,r={assert:function(n){if(!r.has(n))throw new VC("Side channel does not contain "+$C(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=YC()),e.set(n,i)}};return r},KC=String.prototype.replace,qC=/%20/g,Qc={RFC1738:"RFC1738",RFC3986:"RFC3986"},kp={default:Qc.RFC3986,formatters:{RFC1738:function(t){return KC.call(t,qC,"+")},RFC3986:function(t){return String(t)}},RFC1738:Qc.RFC1738,RFC3986:Qc.RFC3986},ZC=kp,QC=f_,Jc=Object.prototype.hasOwnProperty,li=Array.isArray,Xu=QC(),p_=function(e,r){return Xu.set(e,r),e},uu=function(e){return Xu.has(e)},Dd=function(e){return Xu.get(e)},m_=function(e,r){Xu.set(e,r)},_r=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),JC=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(li(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]<"u"&&i.push(n[s]);r.obj[r.prop]=i}}},Mp=function(e,r){for(var n=r&&r.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},eR=function t(e,r,n){if(!r)return e;if(typeof r!="object"&&typeof r!="function"){if(li(e))e.push(r);else if(e&&typeof e=="object")if(uu(e)){var i=Dd(e)+1;e[i]=r,m_(e,i)}else(n&&(n.plainObjects||n.allowPrototypes)||!Jc.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object"){if(uu(r)){for(var s=Object.keys(r),o=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},a=0;a<s.length;a++){var l=parseInt(s[a],10);o[l+1]=r[s[a]]}return p_(o,Dd(r)+1)}return[e].concat(r)}var u=e;return li(e)&&!li(r)&&(u=Mp(e,n)),li(e)&&li(r)?(r.forEach(function(c,h){if(Jc.call(e,h)){var d=e[h];d&&typeof d=="object"&&c&&typeof c=="object"?e[h]=t(d,c,n):e.push(c)}else e[h]=c}),e):Object.keys(r).reduce(function(c,h){var d=r[h];return Jc.call(c,h)?c[h]=t(c[h],d,n):c[h]=d,c},u)},tR=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},rR=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},eh=1024,nR=function(e,r,n,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(m){return"%26%23"+parseInt(m.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;l+=eh){for(var u=o.length>=eh?o.slice(l,l+eh):o,c=[],h=0;h<u.length;++h){var d=u.charCodeAt(h);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===ZC.RFC1738&&(d===40||d===41)){c[c.length]=u.charAt(h);continue}if(d<128){c[c.length]=_r[d];continue}if(d<2048){c[c.length]=_r[192|d>>6]+_r[128|d&63];continue}if(d<55296||d>=57344){c[c.length]=_r[224|d>>12]+_r[128|d>>6&63]+_r[128|d&63];continue}h+=1,d=65536+((d&1023)<<10|u.charCodeAt(h)&1023),c[c.length]=_r[240|d>>18]+_r[128|d>>12&63]+_r[128|d>>6&63]+_r[128|d&63]}a+=c.join("")}return a},iR=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var u=a[l],c=o[u];typeof c=="object"&&c!==null&&n.indexOf(c)===-1&&(r.push({obj:o,prop:u}),n.push(c))}return JC(r),e},sR=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},oR=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},aR=function(e,r,n,i){if(uu(e)){var s=Dd(e)+1;return e[s]=r,m_(e,s),e}var o=[].concat(e,r);return o.length>n?p_(Mp(o,{plainObjects:i}),o.length-1):o},lR=function(e,r){if(li(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},g_={arrayToObject:Mp,assign:tR,combine:aR,compact:iR,decode:rR,encode:nR,isBuffer:oR,isOverflow:uu,isRegExp:sR,maybeMap:lR,merge:eR},y_=f_,El=g_,Bo=kp,uR=Object.prototype.hasOwnProperty,v_={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Cr=Array.isArray,cR=Array.prototype.push,x_=function(t,e){cR.apply(t,Cr(e)?e:[e])},hR=Date.prototype.toISOString,ny=Bo.default,Ke={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:El.encode,encodeValuesOnly:!1,filter:void 0,format:ny,formatter:Bo.formatters[ny],indices:!1,serializeDate:function(e){return hR.call(e)},skipNulls:!1,strictNullHandling:!1},dR=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},th={},fR=function t(e,r,n,i,s,o,a,l,u,c,h,d,m,g,x,w,y,v){for(var p=e,_=v,S=0,b=!1;(_=_.get(th))!==void 0&&!b;){var A=_.get(e);if(S+=1,typeof A<"u"){if(A===S)throw new RangeError("Cyclic object value");b=!0}typeof _.get(th)>"u"&&(S=0)}if(typeof c=="function"?p=c(r,p):p instanceof Date?p=m(p):n==="comma"&&Cr(p)&&(p=El.maybeMap(p,function(R){return R instanceof Date?m(R):R})),p===null){if(o)return u&&!w?u(r,Ke.encoder,y,"key",g):r;p=""}if(dR(p)||El.isBuffer(p)){if(u){var T=w?r:u(r,Ke.encoder,y,"key",g);return[x(T)+"="+x(u(p,Ke.encoder,y,"value",g))]}return[x(r)+"="+x(String(p))]}var M=[];if(typeof p>"u")return M;var I;if(n==="comma"&&Cr(p))w&&u&&(p=El.maybeMap(p,u)),I=[{value:p.length>0?p.join(",")||null:void 0}];else if(Cr(c))I=c;else{var W=Object.keys(p);I=h?W.sort(h):W}var G=l?String(r).replace(/\./g,"%2E"):String(r),C=i&&Cr(p)&&p.length===1?G+"[]":G;if(s&&Cr(p)&&p.length===0)return C+"[]";for(var N=0;N<I.length;++N){var z=I[N],B=typeof z=="object"&&z&&typeof z.value<"u"?z.value:p[z];if(!(a&&B===null)){var k=d&&l?String(z).replace(/\./g,"%2E"):String(z),P=Cr(p)?typeof n=="function"?n(C,k):C:C+(d?"."+k:"["+k+"]");v.set(e,S);var D=y_();D.set(th,v),x_(M,t(B,P,n,i,s,o,a,l,n==="comma"&&w&&Cr(p)?null:u,c,h,d,m,g,x,w,y,D))}}return M},pR=function(e){if(!e)return Ke;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||Ke.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Bo.default;if(typeof e.format<"u"){if(!uR.call(Bo.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=Bo.formatters[n],s=Ke.filter;(typeof e.filter=="function"||Cr(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in v_?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=Ke.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Ke.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ke.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ke.allowEmptyArrays,arrayFormat:o,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ke.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Ke.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ke.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Ke.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Ke.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ke.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ke.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ke.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ke.strictNullHandling}},mR=function(t,e){var r=t,n=pR(e),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):Cr(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var a=v_[n.arrayFormat],l=a==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var u=y_(),c=0;c<i.length;++c){var h=i[c],d=r[h];n.skipNulls&&d===null||x_(o,fR(d,h,a,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var m=o.join(n.delimiter),g=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?g+="utf8=%26%2310003%3B&":g+="utf8=%E2%9C%93&"),m.length>0?g+m:""},Vn=g_,bl=Object.prototype.hasOwnProperty,iy=Array.isArray,ze={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Vn.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},gR=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},__=function(t,e,r){if(t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&r>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return t},yR="utf8=%26%2310003%3B",vR="utf8=%E2%9C%93",xR=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,r.throwOnLimitExceeded?s+1:s);if(r.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,l,u=r.charset;if(r.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===vR?u="utf-8":o[l]===yR&&(u="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var c=o[l],h=c.indexOf("]="),d=h===-1?c.indexOf("="):h+1,m,g;if(d===-1?(m=r.decoder(c,ze.decoder,u,"key"),g=r.strictNullHandling?null:""):(m=r.decoder(c.slice(0,d),ze.decoder,u,"key"),m!==null&&(g=Vn.maybeMap(__(c.slice(d+1),r,iy(n[m])?n[m].length:0),function(w){return r.decoder(w,ze.decoder,u,"value")}))),g&&r.interpretNumericEntities&&u==="iso-8859-1"&&(g=gR(String(g))),c.indexOf("[]=")>-1&&(g=iy(g)?[g]:g),m!==null){var x=bl.call(n,m);x&&r.duplicates==="combine"?n[m]=Vn.combine(n[m],g,r.arrayLimit,r.plainObjects):(!x||r.duplicates==="last")&&(n[m]=g)}}return n},_R=function(t,e,r,n){var i=0;if(t.length>0&&t[t.length-1]==="[]"){var s=t.slice(0,-1).join("");i=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=n?e:__(e,r,i),a=t.length-1;a>=0;--a){var l,u=t[a];if(u==="[]"&&r.parseArrays)Vn.isOverflow(o)?l=o:l=r.allowEmptyArrays&&(o===""||r.strictNullHandling&&o===null)?[]:Vn.combine([],o,r.arrayLimit,r.plainObjects);else{l=r.plainObjects?{__proto__:null}:{};var c=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,h=r.decodeDotInKeys?c.replace(/%2E/g,"."):c,d=parseInt(h,10);!r.parseArrays&&h===""?l={0:o}:!isNaN(d)&&u!==h&&String(d)===h&&d>=0&&r.parseArrays&&d<=r.arrayLimit?(l=[],l[d]=o):h!=="__proto__"&&(l[h]=o)}o=l}return o},wR=function(e,r){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e;if(r.depth<=0)return!r.plainObjects&&bl.call(Object.prototype,n)&&!r.allowPrototypes?void 0:[n];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(n),a=o?n.slice(0,o.index):n,l=[];if(a){if(!r.plainObjects&&bl.call(Object.prototype,a)&&!r.allowPrototypes)return;l.push(a)}for(var u=0;(o=s.exec(n))!==null&&u<r.depth;){u+=1;var c=o[1].slice(1,-1);if(!r.plainObjects&&bl.call(Object.prototype,c)&&!r.allowPrototypes)return;l.push(o[1])}if(o){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");l.push("["+n.slice(o.index)+"]")}return l},SR=function(e,r,n,i){if(e){var s=wR(e,n);if(s)return _R(s,r,n,i)}},ER=function(e){if(!e)return ze;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=typeof e.charset>"u"?ze.charset:e.charset,n=typeof e.duplicates>"u"?ze.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:ze.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:ze.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:ze.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:ze.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:ze.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ze.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:ze.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:ze.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:ze.decoder,delimiter:typeof e.delimiter=="string"||Vn.isRegExp(e.delimiter)?e.delimiter:ze.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:ze.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:ze.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:ze.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:ze.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:ze.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ze.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},bR=function(t,e){var r=ER(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?{__proto__:null}:{};for(var n=typeof t=="string"?xR(t,r):t,i=r.plainObjects?{__proto__:null}:{},s=Object.keys(n),o=0;o<s.length;++o){var a=s[o],l=SR(a,n[a],r,typeof t=="string");i=Vn.merge(i,l,r)}return r.allowSparse===!0?i:Vn.compact(i)},TR=mR,AR=bR,CR=kp,RR={formats:CR,parse:AR,stringify:TR},PR=RT;function Qr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var IR=/^([a-z0-9.+-]+:)/i,kR=/:[0-9]*$/,MR=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,BR=["<",">",'"',"`"," ","\r",`
`,"	"],NR=["{","}","|","\\","^","`"].concat(BR),Ld=["'"].concat(NR),sy=["%","/","?",";","#"].concat(Ld),oy=["/","?","#"],FR=255,ay=/^[+a-z0-9A-Z_-]{0,63}$/,DR=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,LR={javascript:!0,"javascript:":!0},Od={javascript:!0,"javascript:":!0},bs={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Ud=RR;function OR(t,e,r){if(t&&typeof t=="object"&&t instanceof Qr)return t;var n=new Qr;return n.parse(t,e,r),n}Qr.prototype.parse=function(t,e,r){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var a=t;if(a=a.trim(),!r&&t.split("#").length===1){var l=MR.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=Ud.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=IR.exec(a);if(u){u=u[0];var c=u.toLowerCase();this.protocol=c,a=a.substr(u.length)}if(r||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var h=a.substr(0,2)==="//";h&&!(u&&Od[u])&&(a=a.substr(2),this.slashes=!0)}if(!Od[u]&&(h||u&&!bs[u])){for(var d=-1,m=0;m<oy.length;m++){var g=a.indexOf(oy[m]);g!==-1&&(d===-1||g<d)&&(d=g)}var x,w;d===-1?w=a.lastIndexOf("@"):w=a.lastIndexOf("@",d),w!==-1&&(x=a.slice(0,w),a=a.slice(w+1),this.auth=decodeURIComponent(x)),d=-1;for(var m=0;m<sy.length;m++){var g=a.indexOf(sy[m]);g!==-1&&(d===-1||g<d)&&(d=g)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var v=this.hostname.split(/\./),m=0,p=v.length;m<p;m++){var _=v[m];if(_&&!_.match(ay)){for(var S="",b=0,A=_.length;b<A;b++)_.charCodeAt(b)>127?S+="x":S+=_[b];if(!S.match(ay)){var T=v.slice(0,m),M=v.slice(m+1),I=_.match(DR);I&&(T.push(I[1]),M.unshift(I[2])),M.length&&(a="/"+M.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>FR?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=PR.toASCII(this.hostname));var W=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+W,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!LR[c])for(var m=0,p=Ld.length;m<p;m++){var C=Ld[m];if(a.indexOf(C)!==-1){var N=encodeURIComponent(C);N===C&&(N=escape(C)),a=a.split(C).join(N)}}var z=a.indexOf("#");z!==-1&&(this.hash=a.substr(z),a=a.slice(0,z));var B=a.indexOf("?");if(B!==-1?(this.search=a.substr(B),this.query=a.substr(B+1),e&&(this.query=Ud.parse(this.query)),a=a.slice(0,B)):e&&(this.search="",this.query={}),a&&(this.pathname=a),bs[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var W=this.pathname||"",k=this.search||"";this.path=W+k}return this.href=this.format(),this};Qr.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Ud.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||bs[e])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+r+o+n};Qr.prototype.resolve=function(t){return this.resolveObject(OR(t,!1,!0)).format()};Qr.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new Qr;e.parse(t,!1,!0),t=e}for(var r=new Qr,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(r[l]=t[l])}return bs[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!bs[t.protocol]){for(var u=Object.keys(t),c=0;c<u.length;c++){var h=u[c];r[h]=t[h]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!Od[t.protocol]){for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),p[0]!==""&&p.unshift(""),p.length<2&&p.unshift(""),r.pathname=p.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var d=r.pathname||"",m=r.search||"";r.path=d+m}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var g=r.pathname&&r.pathname.charAt(0)==="/",x=t.host||t.pathname&&t.pathname.charAt(0)==="/",w=x||g||r.host&&t.pathname,y=w,v=r.pathname&&r.pathname.split("/")||[],p=t.pathname&&t.pathname.split("/")||[],_=r.protocol&&!bs[r.protocol];if(_&&(r.hostname="",r.port=null,r.host&&(v[0]===""?v[0]=r.host:v.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(p[0]===""?p[0]=t.host:p.unshift(t.host)),t.host=null),w=w&&(p[0]===""||v[0]==="")),x)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,v=p;else if(p.length)v||(v=[]),v.pop(),v=v.concat(p),r.search=t.search,r.query=t.query;else if(t.search!=null){if(_){r.host=v.shift(),r.hostname=r.host;var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return r.search=t.search,r.query=t.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!v.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var b=v.slice(-1)[0],A=(r.host||t.host||v.length>1)&&(b==="."||b==="..")||b==="",T=0,M=v.length;M>=0;M--)b=v[M],b==="."?v.splice(M,1):b===".."?(v.splice(M,1),T++):T&&(v.splice(M,1),T--);if(!w&&!y)for(;T--;T)v.unshift("..");w&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),A&&v.join("/").substr(-1)!=="/"&&v.push("");var I=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(_){r.hostname=I?"":v.length?v.shift():"",r.host=r.hostname;var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return w=w||r.host&&v.length,w&&!I&&v.unshift(""),v.length>0?r.pathname=v.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};Qr.prototype.parseHost=function(){var t=this.host,e=kR.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const ly={};function pe(t,e,r=3){if(ly[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),ly[e]=!0}function nr(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function no(t){return t.split("?")[0].split("#")[0]}function UR(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function jR(t,e,r){return t.replace(new RegExp(UR(e),"g"),r)}function GR(t,e){let r="",n=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),i=a,s=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=a,s=0;continue}}}else r.length>0?r+=`/${t.slice(i+1,a)}`:r=t.slice(i+1,a),n=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return r}const it={toPosix(t){return jR(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){nr(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(nr(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=no(this.toPosix(e??H.ADAPTER.getBaseUrl())),i=no(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?it.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(nr(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=GR(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return nr(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(nr(n),n.length>0)if(e===void 0)e=n;else{const i=t[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(nr(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){n=a;break}}else i=!1;return n===-1?r?"/":this.isUrl(o)?s+t:s:r&&n===1?"//":s+t.slice(0,n)},rootname(t){nr(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){nr(t),e&&nr(e),t=no(this.toPosix(t));let r=0,n=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const l=t.charCodeAt(s);if(l===47){if(!i){r=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return r===n?n=a:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){r=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){nr(t),t=no(this.toPosix(t));let e=-1,r=0,n=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){r=o+1;break}continue}n===-1&&(i=!1,n=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){nr(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=no(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let i;e.root=this.rootname(t),n||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,a=-1,l=!0,u=t.length-1,c=0;for(;u>=i;--u){if(r=t.charCodeAt(u),r===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),r===46?s===-1?s=u:c!==1&&(c=1):s!==-1&&(c=-1)}return s===-1||a===-1||c===0||c===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&n?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&n?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let rh;async function zR(){return rh??(rh=(async()=>{var s;const t=document.createElement("canvas").getContext("webgl");if(!t)return Rt.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return Rt.UNPACK;const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(s=t.getExtension("WEBGL_lose_context"))==null||s.loseContext(),i[0]<=i[3]?Rt.PMA:Rt.UNPACK})()),rh}let nh;function VR(){return typeof nh>"u"&&(nh=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:H.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!H.ADAPTER.getWebGLRenderingContext())return!1;const r=H.ADAPTER.createCanvas();let n=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,i}catch{return!1}}()),nh}var $R={grad:.9,turn:360,rad:360/(2*Math.PI)},Gr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},rt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Kt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},w_=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},uy=function(t){return{r:Kt(t.r,0,255),g:Kt(t.g,0,255),b:Kt(t.b,0,255),a:Kt(t.a)}},ih=function(t){return{r:rt(t.r),g:rt(t.g),b:rt(t.b),a:rt(t.a,3)}},HR=/^#([0-9a-f]{3,8})$/i,Va=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},S_=function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=Math.max(e,r,n),o=s-Math.min(e,r,n),a=o?s===e?(r-n)/o:s===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},E_=function(t){var e=t.h,r=t.s,n=t.v,i=t.a;e=e/360*6,r/=100,n/=100;var s=Math.floor(e),o=n*(1-r),a=n*(1-(e-s)*r),l=n*(1-(1-e+s)*r),u=s%6;return{r:255*[n,a,o,o,l,n][u],g:255*[l,n,n,a,o,o][u],b:255*[o,o,l,n,n,a][u],a:i}},cy=function(t){return{h:w_(t.h),s:Kt(t.s,0,100),l:Kt(t.l,0,100),a:Kt(t.a)}},hy=function(t){return{h:rt(t.h),s:rt(t.s),l:rt(t.l),a:rt(t.a,3)}},dy=function(t){return E_((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},No=function(t){return{h:(e=S_(t)).h,s:(i=(200-(r=e.s))*(n=e.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,r,n,i},WR=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,XR=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,YR=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,KR=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,jd={string:[[function(t){var e=HR.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?rt(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?rt(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=YR.exec(t)||KR.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:uy({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=WR.exec(t)||XR.exec(t);if(!e)return null;var r,n,i=cy({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*($R[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return dy(i)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=i===void 0?1:i;return Gr(e)&&Gr(r)&&Gr(n)?uy({r:Number(e),g:Number(r),b:Number(n),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,i=t.a,s=i===void 0?1:i;if(!Gr(e)||!Gr(r)||!Gr(n))return null;var o=cy({h:Number(e),s:Number(r),l:Number(n),a:Number(s)});return dy(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,i=t.a,s=i===void 0?1:i;if(!Gr(e)||!Gr(r)||!Gr(n))return null;var o=function(a){return{h:w_(a.h),s:Kt(a.s,0,100),v:Kt(a.v,0,100),a:Kt(a.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(s)});return E_(o)},"hsv"]]},fy=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},qR=function(t){return typeof t=="string"?fy(t.trim(),jd.string):typeof t=="object"&&t!==null?fy(t,jd.object):[null,void 0]},sh=function(t,e){var r=No(t);return{h:r.h,s:Kt(r.s+100*e,0,100),l:r.l,a:r.a}},oh=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},py=function(t,e){var r=No(t);return{h:r.h,s:r.s,l:Kt(r.l+100*e,0,100),a:r.a}},Gd=function(){function t(e){this.parsed=qR(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return rt(oh(this.rgba),2)},t.prototype.isDark=function(){return oh(this.rgba)<.5},t.prototype.isLight=function(){return oh(this.rgba)>=.5},t.prototype.toHex=function(){return e=ih(this.rgba),r=e.r,n=e.g,i=e.b,o=(s=e.a)<1?Va(rt(255*s)):"","#"+Va(r)+Va(n)+Va(i)+o;var e,r,n,i,s,o},t.prototype.toRgb=function(){return ih(this.rgba)},t.prototype.toRgbString=function(){return e=ih(this.rgba),r=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+r+", "+n+", "+i+", "+s+")":"rgb("+r+", "+n+", "+i+")";var e,r,n,i,s},t.prototype.toHsl=function(){return hy(No(this.rgba))},t.prototype.toHslString=function(){return e=hy(No(this.rgba)),r=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+r+", "+n+"%, "+i+"%, "+s+")":"hsl("+r+", "+n+"%, "+i+"%)";var e,r,n,i,s},t.prototype.toHsv=function(){return e=S_(this.rgba),{h:rt(e.h),s:rt(e.s),v:rt(e.v),a:rt(e.a,3)};var e},t.prototype.invert=function(){return wr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),wr(sh(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),wr(sh(this.rgba,-e))},t.prototype.grayscale=function(){return wr(sh(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),wr(py(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),wr(py(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?wr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):rt(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=No(this.rgba);return typeof e=="number"?wr({h:e,s:r.s,l:r.l,a:r.a}):rt(r.h)},t.prototype.isEqual=function(e){return this.toHex()===wr(e).toHex()},t}(),wr=function(t){return t instanceof Gd?t:new Gd(t)},my=[],ZR=function(t){t.forEach(function(e){my.indexOf(e)<0&&(e(Gd,jd),my.push(e))})};function QR(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=n[this.toHex()];if(u)return u;if(o!=null&&o.closest){var c=this.toRgb(),h=1/0,d="black";if(!s.length)for(var m in r)s[m]=new t(r[m]).toRgb();for(var g in r){var x=(a=c,l=s[g],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));x<h&&(h=x,d=g)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}ZR([QR]);const qi=class Tl{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Tl)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,s)=>i===r[s]);if(e!==null&&r!==null){const i=Object.keys(e),s=Object.keys(r);return i.length!==s.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,n,i]=this._components;return{r:e,g:r,b:n,a:i}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,i]=this._components;return e=e??[],e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[r,n,i]=this._components;return e[0]=r,e[1]=n,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,i,s]=Tl.temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return r&&(n=n*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[r,n,i]=this._components;return this._components[0]=Math.round(r*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[r,n,i,s]=this._components;return e[0]=r,e[1]=n,e[2]=i,e[3]=s,e}normalize(e){let r,n,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,i,s=255]=e,r/=255,n/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Tl.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=wr(e);o.isValid()&&({r,g:n,b:i,a:s}=o.rgba,r/=255,n/=255,i/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,r),n)}),e)}};qi.shared=new qi,qi.temp=new qi,qi.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Ie=qi;function JR(t){return pe("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Ie.shared.setValue(t).toHex()}function eP(t){return pe("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Ie.shared.setValue(t).toNumber()}function tP(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[ne.NORMAL_NPM]=ne.NORMAL,t[ne.ADD_NPM]=ne.ADD,t[ne.SCREEN_NPM]=ne.SCREEN,e[ne.NORMAL]=ne.NORMAL_NPM,e[ne.ADD]=ne.ADD_NPM,e[ne.SCREEN]=ne.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}const b_=tP();function T_(t,e){return b_[e?1:0][t]}function rP(t,e=null){const r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let n=0,i=0;n<r;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function A_(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function cu(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function gy(t){return!(t&t-1)&&!!t}function yy(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function Ts(t,e,r){const n=t.length;let i;if(e>=n||r===0)return;r=e+r>n?n-e:r;const s=n-r;for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}function Pn(t){return t===0?0:t<0?-1:1}let nP=0;function bi(){return++nP}const zd=class{constructor(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};zd.EMPTY=new zd(0,0,0,0);let vy=zd;const xy={},Sr=Object.create(null),pn=Object.create(null);class iP{constructor(e,r,n){this._canvas=H.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||H.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function _y(t,e,r){for(let n=0,i=4*r*e;n<e;++n,i+=4)if(t[i+3]!==0)return!1;return!0}function wy(t,e,r,n,i){const s=4*e;for(let o=n,a=n*s+4*r;o<=i;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function sP(t){const{width:e,height:r}=t,n=t.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,e,r).data;let s=0,o=0,a=e-1,l=r-1;for(;o<r&&_y(i,e,o);)++o;if(o===r)return vy.EMPTY;for(;_y(i,e,l);)--l;for(;wy(i,e,s,o,l);)++s;for(;wy(i,e,a,o,l);)--a;return++a,++l,new vy(s,o,a,l)}function oP(t){const e=sP(t),{width:r,height:n}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,r,n)}return{width:r,height:n,data:i}}function aP(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}function nn(t,e=1){var n;const r=(n=H.RETINA_PREFIX)==null?void 0:n.exec(t);return r?parseFloat(r[1]):e}var V=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(V||{});const Vd=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Sy=(t,e)=>Vd(t).priority??e,q={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Vd).forEach(e=>{e.type.forEach(r=>{var n,i;return(i=(n=this._removeHandlers)[r])==null?void 0:i.call(n,e)})}),this},add(...t){return t.map(Vd).forEach(e=>{e.type.forEach(r=>{var s,o;const n=this._addHandlers,i=this._queue;n[r]?(s=n[r])==null||s.call(n,e):(i[r]=i[r]||[],(o=i[r])==null||o.push(e))})}),this},handle(t,e,r){var o;const n=this._addHandlers,i=this._removeHandlers;if(n[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,i[t]=r;const s=this._queue;return s[t]&&((o=s[t])==null||o.forEach(a=>e(a)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,s)=>Sy(s,r)-Sy(i,r)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}};class $d{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const lP=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function uP(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function cP(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=lP.replace(/%forloop%/gi,uP(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}const ah=0,lh=1,uh=2,ch=3,hh=4,dh=5;class Lr{constructor(){this.data=0,this.blendMode=ne.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<ah)}set blend(e){!!(this.data&1<<ah)!==e&&(this.data^=1<<ah)}get offsets(){return!!(this.data&1<<lh)}set offsets(e){!!(this.data&1<<lh)!==e&&(this.data^=1<<lh)}get culling(){return!!(this.data&1<<uh)}set culling(e){!!(this.data&1<<uh)!==e&&(this.data^=1<<uh)}get depthTest(){return!!(this.data&1<<ch)}set depthTest(e){!!(this.data&1<<ch)!==e&&(this.data^=1<<ch)}get depthMask(){return!!(this.data&1<<dh)}set depthMask(e){!!(this.data&1<<dh)!==e&&(this.data^=1<<dh)}get clockwiseFrontFace(){return!!(this.data&1<<hh)}set clockwiseFrontFace(e){!!(this.data&1<<hh)!==e&&(this.data^=1<<hh)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==ne.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Lr;return e.depthTest=!1,e.blend=!0,e}}Lr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Hd=[];function C_(t,e){if(!t)return null;let r="";if(typeof t=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(let n=Hd.length-1;n>=0;--n){const i=Hd[n];if(i.test&&i.test(t,r))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class pr{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,n,i,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:c}=this;this._aliasCount++;for(let h=0,d=c.length;h<d;h++)c[h][u](e,r,n,i,s,o,a,l);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(pr.prototype,{dispatch:{value:pr.prototype.emit},run:{value:pr.prototype.emit}});class ia{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new pr("setRealSize"),this.onUpdate=new pr("update"),this.onError=new pr("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}}class Yu extends ia{constructor(e,r){const{width:n,height:i}=r||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=e,this.unpackAlignment=r.unpackAlignment??4}upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Rt.UNPACK);const s=r.realWidth,o=r.realHeight;return n.width===s&&n.height===o?i.texSubImage2D(r.target,0,0,0,s,o,r.format,n.type,this.data):(n.width=s,n.height=o,i.texImage2D(r.target,0,n.internalFormat,s,o,0,r.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const hP={scaleMode:Xr.NEAREST,alphaMode:Rt.NPM},Wd=class Zi extends da{constructor(e=null,r=null){super(),r=Object.assign({},Zi.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:u,format:c,type:h,target:d,resolution:m,resourceOptions:g}=r;e&&!(e instanceof ia)&&(e=C_(e,g),e.internal=!0),this.resolution=m||H.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=u,this._scaleMode=o,this.format=c,this.type=h,this.target=d,this.alphaMode=n,this.uid=bi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,r){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,n=!0),n&&this.dirtyStyleId++,this}setSize(e,r,n){return n=n||this.resolution,this.setRealSize(e*n,r*n,n)}setRealSize(e,r,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(r)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=gy(this.realWidth)&&gy(this.realHeight)}setResolution(e){const r=this.resolution;return r===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*r)/e,this.height=Math.round(this.height*r)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete pn[this.cacheId],delete Sr[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Zi.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,r,n=H.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${bi()}`}s=e._pixiId}let o=pn[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new Zi(e,r),o.cacheId=s,Zi.addToCache(o,s)),o}static fromBuffer(e,r,n,i){e=e||new Float32Array(r*n*4);const s=new Yu(e,{width:r,height:n,...i==null?void 0:i.resourceOptions});let o,a;return e instanceof Float32Array?(o=j.RGBA,a=J.FLOAT):e instanceof Int32Array?(o=j.RGBA_INTEGER,a=J.INT):e instanceof Uint32Array?(o=j.RGBA_INTEGER,a=J.UNSIGNED_INT):e instanceof Int16Array?(o=j.RGBA_INTEGER,a=J.SHORT):e instanceof Uint16Array?(o=j.RGBA_INTEGER,a=J.UNSIGNED_SHORT):e instanceof Int8Array?(o=j.RGBA,a=J.BYTE):(o=j.RGBA,a=J.UNSIGNED_BYTE),s.internal=!0,new Zi(s,Object.assign({},hP,{type:a,format:o},i))}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),pn[r]&&pn[r]!==e&&console.warn(`BaseTexture added to the cache with an id [${r}] that already had an entry`),pn[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=pn[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete pn[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)delete pn[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}};Wd.defaultOptions={mipmap:Dr.POW2,anisotropicLevel:0,scaleMode:Xr.LINEAR,wrapMode:jn.CLAMP,alphaMode:Rt.UNPACK,target:Ss.TEXTURE_2D,format:j.RGBA,type:J.UNSIGNED_BYTE},Wd._globalBatch=0;let ae=Wd;class Xd{constructor(){this.texArray=null,this.blend=0,this.type=kr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let dP=0;class $e{constructor(e,r=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=r,this.id=dP++,this.disposeRunner=new pr("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Nr.ELEMENT_ARRAY_BUFFER:Nr.ARRAY_BUFFER}get index(){return this.type===Nr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new $e(e)}}class hu{constructor(e,r=0,n=!1,i=J.FLOAT,s,o,a,l=1){this.buffer=e,this.size=r,this.normalized=n,this.type=i,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,r,n,i,s){return new hu(e,r,n,i,s)}}const fP={Float32Array,Uint32Array,Int32Array,Uint8Array};function pP(t,e){let r=0,n=0;const i={};for(let l=0;l<t.length;l++)n+=e[l],r+=t[l].length;const s=new ArrayBuffer(r*4);let o=null,a=0;for(let l=0;l<t.length;l++){const u=e[l],c=t[l],h=A_(c);i[h]||(i[h]=new fP[h](s)),o=i[h];for(let d=0;d<c.length;d++){const m=(d/u|0)*n+a,g=d%u;o[m+g]=c[d]}a+=u}return new Float32Array(s)}const Ey={5126:4,5123:2,5121:1};let mP=0;const gP={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class $n{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=mP++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new pr("disposeGeometry"),this.refCount=0}addAttribute(e,r,n=0,i=!1,s,o,a,l=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof $e||(r instanceof Array&&(r=new Float32Array(r)),r=new $e(r));const u=e.split("|");if(u.length>1){for(let h=0;h<u.length;h++)this.addAttribute(u[h],r,n,i,s);return this}let c=this.buffers.indexOf(r);return c===-1&&(this.buffers.push(r),c=this.buffers.length-1),this.attributes[e]=new hu(c,n,i,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof $e||(e instanceof Array&&(e=new Uint16Array(e)),e=new $e(e)),e.type=Nr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],r=[],n=new $e;let i;for(i in this.attributes){const s=this.attributes[i],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*Ey[s.type]/4),s.buffer=0}for(n.data=pP(e,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new $n;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new $e(this.buffers[r].data.slice(0));for(const r in this.attributes){const n=this.attributes[r];e.attributes[r]=new hu(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Nr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const r=new $n,n=[],i=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l]=i[l]||0,i[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)n[a]=new gP[A_(o.buffers[a].data)](i[a]),r.buffers[a]=new $e(n[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)n[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=Nr.ELEMENT_ARRAY_BUFFER;let a=0,l=0,u=0,c=0;for(let h=0;h<o.buffers.length;h++)if(o.buffers[h]!==o.indexBuffer){c=h;break}for(const h in o.attributes){const d=o.attributes[h];(d.buffer|0)===c&&(l+=d.size*Ey[d.type]/4)}for(let h=0;h<e.length;h++){const d=e[h].indexBuffer.data;for(let m=0;m<d.length;m++)r.indexBuffer.data[m+u]+=a;a+=e[h].buffers[c].data.length/l,u+=d.length}}return r}}class R_ extends $n{constructor(e=!1){super(),this._buffer=new $e(null,e,!1),this._indexBuffer=new $e(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,J.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,J.FLOAT).addAttribute("aColor",this._buffer,4,!0,J.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,J.FLOAT).addIndex(this._indexBuffer)}}const du=Math.PI*2,yP=180/Math.PI,vP=Math.PI/180;var at=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(at||{});class ye{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new ye(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}}ye.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const $a=[new ye,new ye,new ye,new ye];class ce{constructor(e=0,r=0,n=0,i=0){this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(i),this.type=at.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ce(0,0,0,0)}clone(){return new ce(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){const T=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=T)return!1;const M=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>M}const n=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=n||o<=s)return!1;const a=$a[0].set(e.left,e.top),l=$a[1].set(e.left,e.bottom),u=$a[2].set(e.right,e.top),c=$a[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(l,l),r.apply(u,u),r.apply(c,c),Math.max(a.x,l.x,u.x,c.x)<=n||Math.min(a.x,l.x,u.x,c.x)>=i||Math.max(a.y,l.y,u.y,c.y)<=s||Math.min(a.y,l.y,u.y,c.y)>=o))return!1;const d=h*(l.y-a.y),m=h*(a.x-l.x),g=d*n+m*s,x=d*i+m*s,w=d*n+m*o,y=d*i+m*o;if(Math.max(g,x,w,y)<=d*a.x+m*a.y||Math.min(g,x,w,y)>=d*c.x+m*c.y)return!1;const v=h*(a.y-u.y),p=h*(u.x-a.x),_=v*n+p*s,S=v*i+p*s,b=v*n+p*o,A=v*i+p*o;return!(Math.max(_,S,b,A)<=v*a.x+p*a.y||Math.min(_,S,b,A)>=v*c.x+p*c.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,i=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=i,this.height=s-i,this}}ce.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Ku{constructor(e=0,r=0,n=0){this.x=e,this.y=r,this.radius=n,this.type=at.CIRC}clone(){return new Ku(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,s=this.y-r;return i*=i,s*=s,i+s<=n}getBounds(){return new ce(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Ku.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class qu{constructor(e=0,r=0,n=0,i=0){this.x=e,this.y=r,this.width=n,this.height=i,this.type=at.ELIP}clone(){return new qu(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,i=(r-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new ce(this.x-this.width,this.y-this.height,this.width,this.height)}}qu.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class gi{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let i=0,s=r.length;i<s;i++)n.push(r[i].x,r[i].y);r=n}this.points=r,this.type=at.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),r=new gi(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let n=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],c=this.points[o*2+1];l>r!=c>r&&e<(u-a)*((r-l)/(c-l))+a&&(n=!n)}return n}}gi.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class Zu{constructor(e=0,r=0,n=0,i=0,s=20){this.x=e,this.y=r,this.width=n,this.height=i,this.radius=s,this.type=at.RREC}clone(){return new Zu(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),s=r-(this.y+n);const o=n*n;if(i*i+s*s<=o||(i=e-(this.x+this.width-n),i*i+s*s<=o)||(s=r-(this.y+this.height-n),i*i+s*s<=o)||(i=e-(this.x+n),i*i+s*s<=o))return!0}return!1}}Zu.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Me{constructor(e=1,r=0,n=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,i,s,o){return this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new ye;const n=e.x,i=e.y;return r.x=this.a*n+this.c*i+this.tx,r.y=this.b*n+this.d*i+this.ty,r}applyInverse(e,r){r=r||new ye;const n=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return r.x=this.d*n*i+-this.c*n*s+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*s+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*r-this.b*n,this.b=i*n+this.b*r,this.c=s*r-this.d*n,this.d=s*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,i=this.c,s=this.d;return this.a=e.a*r+e.b*i,this.b=e.a*n+e.b*s,this.c=e.c*r+e.d*i,this.d=e.c*n+e.d*s,this.tx=e.tx*r+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}setTransform(e,r,n,i,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(n*this.a+i*this.c),this.ty=r-(n*this.b+i*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),l=Math.atan2(n,r),u=Math.abs(a+l);return u<1e-5||Math.abs(du-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*r+o.y*i),e.position.y=this.ty+(o.x*n+o.y*s),e}invert(){const e=this.a,r=this.b,n=this.c,i=this.d,s=this.tx,o=e*i-r*n;return this.a=i/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-i*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Me;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Me}static get TEMP_MATRIX(){return new Me}}Me.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const ri=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ni=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ii=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],si=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Yd=[],P_=[],Ha=Math.sign;function xP(){for(let t=0;t<16;t++){const e=[];Yd.push(e);for(let r=0;r<16;r++){const n=Ha(ri[t]*ri[r]+ii[t]*ni[r]),i=Ha(ni[t]*ri[r]+si[t]*ni[r]),s=Ha(ri[t]*ii[r]+ii[t]*si[r]),o=Ha(ni[t]*ii[r]+si[t]*si[r]);for(let a=0;a<16;a++)if(ri[a]===n&&ni[a]===i&&ii[a]===s&&si[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Me;e.set(ri[t],ni[t],ii[t],si[t],0,0),P_.push(e)}}xP();const De={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>ri[t],uY:t=>ni[t],vX:t=>ii[t],vY:t=>si[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Yd[t][e],sub:(t,e)=>Yd[t][De.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?De.S:De.N:Math.abs(e)*2<=Math.abs(t)?t>0?De.E:De.W:e>0?t>0?De.SE:De.SW:t>0?De.NE:De.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const i=P_[De.inv(e)];i.tx=r,i.ty=n,t.append(i)}};class Kr{constructor(e,r,n=0,i=0){this._x=n,this._y=i,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new Kr(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Kr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Kd=class{constructor(){this.worldTransform=new Me,this.localTransform=new Me,this.position=new Kr(this.onChange,this,0,0),this.scale=new Kr(this.onChange,this,1,1),this.pivot=new Kr(this.onChange,this,0,0),this.skew=new Kr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};Kd.IDENTITY=new Kd;let Bp=Kd;Bp.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var _P=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,wP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function by(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function fh(t){const e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function I_(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return fh(2*e);case"bvec3":return fh(3*e);case"bvec4":return fh(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const As=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],SP={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},EP={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function bP(t,e){var n;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const s=e[i];if(!s){((n=t.uniforms[i])==null?void 0:n.group)===!0&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let a=!1;for(let l=0;l<As.length;l++)if(As[l].test(s,o)){r.push(As[l].code(i,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?SP:EP)[s.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const k_={};let Vi=k_;function TP(){if(Vi===k_||Vi!=null&&Vi.isContextLost()){const t=H.ADAPTER.createCanvas();let e;H.PREFER_ENV>=ki.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Vi=e}return Vi}let Wa;function AP(){if(!Wa){Wa=Yt.MEDIUM;const t=TP();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(Wa=e.precision?Yt.HIGH:Yt.MEDIUM)}}return Wa}function Ty(t,e){const r=t.getShaderSource(e).split(`
`).map((u,c)=>`${c}: ${u}`),n=t.getShaderInfoLog(e),i=n.split(`
`),s={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{r[u-1]=`%c${r[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=r.join(`
`);a[0]=l,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function CP(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||Ty(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||Ty(t,n),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const RP={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function M_(t){return RP[t]}let Xa=null;const Ay={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function B_(t,e){if(!Xa){const r=Object.keys(Ay);Xa={};for(let n=0;n<r.length;++n){const i=r[n];Xa[t[i]]=Ay[i]}}return Xa[e]}function Cy(t,e,r){if(t.substring(0,9)!=="precision"){let n=e;return e===Yt.HIGH&&r!==Yt.HIGH&&(n=Yt.MEDIUM),`precision ${n} float;
${t}`}else if(r!==Yt.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let io;function PP(){if(typeof io=="boolean")return io;try{io=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{io=!1}return io}let IP=0;const Ya={},qd=class Qi{constructor(e,r,n="pixi-shader",i={}){this.extra={},this.id=IP++,this.vertexSrc=e||Qi.defaultVertexSrc,this.fragmentSrc=r||Qi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),Ya[n]?(Ya[n]++,n+=`-${Ya[n]}`):Ya[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=Cy(this.vertexSrc,Qi.defaultVertexPrecision,Yt.HIGH),this.fragmentSrc=Cy(this.fragmentSrc,Qi.defaultFragmentPrecision,AP())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return wP}static get defaultFragmentSrc(){return _P}static from(e,r,n){const i=e+r;let s=xy[i];return s||(xy[i]=s=new Qi(e,r,n)),s}};qd.defaultVertexPrecision=Yt.HIGH,qd.defaultFragmentPrecision=Yr.apple.device?Yt.HIGH:Yt.MEDIUM;let qr=qd,kP=0;class mr{constructor(e,r,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=kP++,this.static=!!r,this.ubo=!!n,e instanceof $e?(this.buffer=e,this.buffer.type=Nr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new $e(new Float32Array(1)),this.buffer.type=Nr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,n){if(!this.ubo)this.uniforms[e]=new mr(r,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,n){return new mr(e,r,n)}static uboFrom(e,r){return new mr(e,r??!0,!0)}}class Fr{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof mr?this.uniformGroup=r:this.uniformGroup=new mr(r):this.uniformGroup=new mr({}),this.disposeRunner=new pr("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(const n in r.uniforms){const i=r.uniforms[n];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,n){const i=qr.from(e,r);return new Fr(i,n)}}class MP{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let s=0;s<e;s++)n[s]=s;this.defaultGroupCache[e]=mr.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new qr(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Me,default:this.defaultGroupCache[e]};return new Fr(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let n=0;n<e;n++)n>0&&(r+=`
else `),n<e-1&&(r+=`if(vTextureId < ${n}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class Zd{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function BP(){return!Yr.apple.device}function NP(t){let e=!0;const r=H.ADAPTER.getNavigator();if(Yr.tablet||Yr.phone){if(Yr.apple.device){const n=r.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(Yr.android.device){const n=r.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?t:4}class Qu{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var FP=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,DP=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ho=class or extends Qu{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=R_,this.vertexSize=6,this.state=Lr.for2d(),this.size=or.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??NP(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??BP(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return pe("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return DP}static get defaultFragmentTemplate(){return FP}setShaderGenerator({vertex:e=or.defaultVertexSrc,fragment:r=or.defaultFragmentTemplate}={}){this.shaderGenerator=new MP(e,r)}contextChange(){const e=this.renderer.gl;H.PREFER_ENV===ki.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),or.defaultMaxTextures),this.maxTextures=cP(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:r}=or,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;e.length<n;)e.push(new Xd);for(;r.length<i;)r.push(new Zd);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:r}=this,n=or._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++ae._globalBatch,l=0,u=n[0],c=0;i.copyBoundTextures(s,r);for(let h=0;h<this._bufferSize;++h){const d=e[h];e[h]=null,d._batchEnabled!==a&&(u.count>=r&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,c,h),c=h,u=n[++l],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,c,this._bufferSize),++l,++a);for(let h=0;h<s.length;h++)s[h]=null;ae._globalBatch=a}buildDrawCalls(e,r,n){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=or._drawCallPool;let u=this._dcIndex,c=this._aIndex,h=this._iIndex,d=l[u];d.start=this._iIndex,d.texArray=e;for(let m=r;m<n;++m){const g=i[m],x=g._texture.baseTexture,w=b_[x.alphaMode?1:0][g.blendMode];i[m]=null,r<m&&d.blend!==w&&(d.size=h-d.start,r=m,d=l[++u],d.texArray=e,d.start=h),this.packInterleavedGeometry(g,s,o,c,h),c+=g.vertexData.length/2*a,h+=g.indices.length,d.blend=w}r<n&&(d.size=h-d.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=h}bindAndClearTexArray(e){const r=this.renderer.texture;for(let n=0;n<e.count;n++)r.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:r,_indexBuffer:n}=this;or.canUploadSameBuffer?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:r,state:n}=this.renderer,i=or._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:u,start:c,blend:h}=i[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=h,n.set(this.state),r.drawElements(l,u,r.UNSIGNED_SHORT,c*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),or.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const r=cu(Math.ceil(e/8)),n=yy(r),i=r*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new $d(i*this.vertexSize*4)),s}getIndexBuffer(e){const r=cu(Math.ceil(e/12)),n=yy(r),i=r*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._iBuffers[n];return s||(this._iBuffers[n]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,r,n,i,s){const{uint32View:o,float32View:a}=r,l=i/this.vertexSize,u=e.uvs,c=e.indices,h=e.vertexData,d=e._texture.baseTexture._batchLocation,m=Math.min(e.worldAlpha,1),g=Ie.shared.setValue(e._tintRGB).toPremultiplied(m,e._texture.baseTexture.alphaMode>0);for(let x=0;x<h.length;x+=2)a[i++]=h[x],a[i++]=h[x+1],a[i++]=u[x],a[i++]=u[x+1],o[i++]=g,a[i++]=d;for(let x=0;x<c.length;x++)n[s++]=l+c[x]}};ho.defaultBatchSize=4096,ho.extension={name:"batch",type:V.RendererPlugin},ho._drawCallPool=[],ho._textureArrayPool=[];let oi=ho;q.add(oi);var LP=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,OP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Qd=class fo extends Fr{constructor(e,r,n){const i=qr.from(e||fo.defaultVertexSrc,r||fo.defaultFragmentSrc);super(i,n),this.padding=0,this.resolution=fo.defaultResolution,this.multisample=fo.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Lr}apply(e,r,n,i,s){e.applyFilter(this,r,n,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return OP}static get defaultFragmentSrc(){return LP}};Qd.defaultResolution=1,Qd.defaultMultisample=We.NONE;let _t=Qd;class fu{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Ie(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:r,background:n,backgroundAlpha:i}=e,s=n??r;s!==void 0&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}fu.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},fu.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"background"};q.add(fu);class N_{constructor(e){this.renderer=e,this.emptyRenderer=new Qu(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){const{boundTextures:n}=this.renderer.texture;for(let i=r-1;i>=0;--i)e[i]=n[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,r,n,i){const{elements:s,ids:o,count:a}=e;let l=0;for(let u=0;u<a;u++){const c=s[u],h=c._batchLocation;if(h>=0&&h<i&&r[h]===c){o[u]=h;continue}for(;l<i;){const d=r[l];if(d&&d._batchEnabled===n&&d._batchLocation===l){l++;continue}o[u]=l,c._batchLocation=l,r[l]=c;break}}}destroy(){this.renderer=null}}N_.extension={type:V.RendererSystem,name:"batch"};q.add(N_);let Ry=0;class pu{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Ry++}init(e){if(e.context)this.initFromContext(e.context);else{const r=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Ry++,this.renderer.runners.contextChange.emit(e);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let n;if(H.PREFER_ENV>=ki.WEBGL2&&(n=e.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const r=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}pu.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},pu.extension={type:V.RendererSystem,name:"context"};q.add(pu);class Jd{constructor(e,r){if(this.width=Math.round(e),this.height=Math.round(r),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new pr("disposeFramebuffer"),this.multisample=We.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new ae(null,{scaleMode:Xr.NEAREST,resolution:1,mipmap:Dr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new ae(null,{scaleMode:Xr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Dr.OFF,format:j.DEPTH_COMPONENT,type:J.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!e||!r)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],s=i.resolution;i.setSize(e/s,r/s)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,r/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class F_ extends ae{constructor(e={}){if(typeof e=="number"){const r=arguments[0],n=arguments[1],i=arguments[2],s=arguments[3];e={width:r,height:n,scaleMode:i,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=We.NONE),super(null,e),this.mipmap=Dr.OFF,this.valid=!0,this._clear=new Ie([0,0,0,0]),this.framebuffer=new Jd(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class sn extends ia{constructor(e){const r=e,n=r.naturalWidth||r.videoWidth||r.displayWidth||r.width,i=r.naturalHeight||r.videoHeight||r.displayHeight||r.height;super(n,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,n){n===void 0&&!r.startsWith("data:")?e.crossOrigin=aP(r):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,r,n,i){const s=e.gl,o=r.realWidth,a=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Rt.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&n.width===o&&n.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,n.type,i):(n.width=o,n.height=a,s.texImage2D(r.target,0,n.internalFormat,r.format,n.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),super.update()}dispose(){this.source=null}}class D_ extends sn{constructor(e,r){if(r=r||{},typeof e=="string"){const n=new Image;sn.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??H.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,n)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{n(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Rt.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,n,this.bitmap),!this.preserveBitmap){let i=!0;const s=r._glTextures;for(const o in s){const a=s[o];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class Np{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,n){const i=r.width,s=r.height;if(n){const o=e.width/2/i,a=e.height/2/s,l=e.x/i+o,u=e.y/s+a;n=De.add(n,De.NW),this.x0=l+o*De.uX(n),this.y0=u+a*De.uY(n),n=De.add(n,2),this.x1=l+o*De.uX(n),this.y1=u+a*De.uY(n),n=De.add(n,2),this.x2=l+o*De.uX(n),this.y2=u+a*De.uY(n),n=De.add(n,2),this.x3=l+o*De.uX(n),this.y3=u+a*De.uY(n)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Np.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Py=new Np;function Ka(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class K extends da{constructor(e,r,n,i,s,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new ce(0,0,1,1)),e instanceof K&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=Py,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new ye(o.x,o.y):new ye(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:r}=this.baseTexture;r!=null&&r.url&&Sr[r.url]&&K.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,K.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new K(this.baseTexture,!this.noFrame&&e,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===Py&&(this._uvs=new Np),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},n=H.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else if(e instanceof ae){if(!e.cacheId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${bi()}`,ae.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${bi()}`}s=e._pixiId}let o=Sr[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof ae)?(r.resolution||(r.resolution=nn(e)),o=new K(new ae(e,r)),o.baseTexture.cacheId=s,ae.addToCache(o.baseTexture,s),K.addToCache(o,s)):!o&&e instanceof ae&&(o=new K(e),K.addToCache(o,s)),o}static fromURL(e,r){const n=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=K.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,r,n,i){return new K(ae.fromBuffer(e,r,n,i))}static fromLoader(e,r,n,i){const s=new ae(e,Object.assign({scaleMode:ae.defaultOptions.scaleMode,resolution:nn(r)},i)),{resource:o}=s;o instanceof D_&&(o.url=r);const a=new K(s);return n||(n=r),ae.addToCache(a.baseTexture,n),K.addToCache(a,n),n!==r&&(ae.addToCache(a.baseTexture,r),K.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),Sr[r]&&Sr[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Sr[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=Sr[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete Sr[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)Sr[e.textureCacheIds[r]]===e&&delete Sr[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:r,y:n,width:i,height:s}=e,o=r+i>this.baseTexture.width,a=n+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",u=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,c=`Y: ${n} + ${s} = ${n+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${l} ${c}`)}this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return K._EMPTY||(K._EMPTY=new K(new ae),Ka(K._EMPTY),Ka(K._EMPTY.baseTexture)),K._EMPTY}static get WHITE(){if(!K._WHITE){const e=H.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),K._WHITE=new K(ae.from(e)),Ka(K._WHITE),Ka(K._WHITE.baseTexture)}return K._WHITE}}class Bi extends K{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,n=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(r*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new Bi(new F_(e))}}class L_{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,n=We.NONE){const i=new F_(Object.assign({width:e,height:r,resolution:1,multisample:n},this.textureOptions));return new Bi(i)}getOptimalTexture(e,r,n=1,i=We.NONE){let s;e=Math.max(Math.ceil(e*n-1e-6),1),r=Math.max(Math.ceil(r*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=cu(e),r=cu(r),s=((e&65535)<<16|r&65535)>>>0,i>1&&(s+=i*4294967296)):s=i>1?-i:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,i)),o.filterPoolKey=s,o.setResolution(n),o}getFilterTexture(e,r,n){const i=this.getOptimalTexture(e.width,e.height,r||e.resolution,n||We.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const r in this.texturePool){const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}L_.SCREEN_KEY=-1;class UP extends $n{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class O_ extends $n{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new $e(this.vertices),this.uvBuffer=new $e(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+r.width/e.width,this.uvs[3]=i,this.uvs[4]=n+r.width/e.width,this.uvs[5]=i+r.height/e.height,this.uvs[6]=n,this.uvs[7]=i+r.height/e.height,n=r.x,i=r.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+r.width,this.vertices[3]=i,this.vertices[4]=n+r.width,this.vertices[5]=i+r.height,this.vertices[6]=n,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class jP{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=We.NONE,this.sourceFrame=new ce,this.destinationFrame=new ce,this.bindingSourceFrame=new ce,this.bindingDestinationFrame=new ce,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const qa=[new ye,new ye,new ye,new ye],ph=new Me;class U_{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new L_,this.statePool=[],this.quad=new UP,this.quadUv=new O_,this.tempRect=new ce,this.activeState={},this.globalUniforms=new mr({outputFrame:new ce,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){const n=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new jP,o=n.renderTexture;let a,l;if(o.current){const w=o.current;a=w.resolution,l=w.multisample}else a=n.resolution,l=n.multisample;let u=r[0].resolution||a,c=r[0].multisample??l,h=r[0].padding,d=r[0].autoFit,m=r[0].legacy??!0;for(let w=1;w<r.length;w++){const y=r[w];u=Math.min(u,y.resolution||a),c=Math.min(c,y.multisample??l),h=this.useMaxPadding?Math.max(h,y.padding):h+y.padding,d=d&&y.autoFit,m=m||(y.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=u,s.multisample=c,s.legacy=m,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(h);const g=this.tempRect.copyFrom(o.sourceFrame);n.projection.transform&&this.transformAABB(ph.copyFrom(n.projection.transform).invert(),g),d?(s.sourceFrame.fit(g),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(g)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:n.resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,u,c),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const x=this.tempRect;x.x=0,x.y=0,x.width=s.sourceFrame.width,x.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=n.projection.transform,n.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,x),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,r=e.pop(),n=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const s=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*s[2]-.5*o[2],a[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){const u=i.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,l.renderTexture,Rr.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let u=r.renderTexture,c=this.getOptimalFilterTexture(u.width,u.height,r.resolution);c.filterFrame=u.filterFrame;let h=0;for(h=0;h<n.length-1;++h){h===1&&r.multisample>1&&(c=this.getOptimalFilterTexture(u.width,u.height,r.resolution),c.filterFrame=u.filterFrame),n[h].apply(this,u,c,Rr.CLEAR,r);const d=u;u=c,c=d}n[h].apply(this,u,l.renderTexture,Rr.BLEND,r),h>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(c)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=Rr.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,n.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=i.stateId&1||this.forceClear;(r===Rr.CLEAR||r===Rr.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,n,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(n,i),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(kr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(kr.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:s}=r._texture,o=e.set(i.width,0,0,i.height,n.x,n.y),a=r.worldTransform.copyTo(Me.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,n=1,i=We.NONE){return this.texturePool.getOptimalTexture(e,r,n,i)}getFilterTexture(e,r,n){if(typeof e=="number"){const s=e;e=r,r=s}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,n||We.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){const n=qa[0],i=qa[1],s=qa[2],o=qa[3];n.set(r.left,r.top),i.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(n,n),e.apply(i,i),e.apply(s,s),e.apply(o,o);const a=Math.min(n.x,i.x,s.x,o.x),l=Math.min(n.y,i.y,s.y,o.y),u=Math.max(n.x,i.x,s.x,o.x),c=Math.max(n.y,i.y,s.y,o.y);r.x=a,r.y=l,r.width=u-a,r.height=c-l}roundFrame(e,r,n,i,s){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(s){const{a:o,b:a,c:l,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?ph.copyFrom(s):ph.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}}U_.extension={type:V.RendererSystem,name:"filter"};q.add(U_);class GP{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=We.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const zP=new ce;class j_{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Jd(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ce,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;H.PREFER_ENV===ki.WEBGL_LEGACY&&(r=null,n=null),r?e.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,n=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=n),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){const o=r.width>>n,a=r.height>>n,l=o/r.width;this.setViewport(r.x*l,r.y*l,o,a)}else{const o=e.width>>n,a=e.height>>n;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,n,i){const s=this.viewport;e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),(s.width!==n||s.height!==i||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=n,s.height=i,this.gl.viewport(e,r,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,n,i,s=Cd.COLOR|Cd.DEPTH){const{gl:o}=this;o.clearColor(e,r,n,i),o.clear(s)}initFramebuffer(e){const{gl:r}=this,n=new GP(r.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){r.bindRenderbuffer(r.RENDERBUFFER,n.stencil);let o;this.renderer.context.webGLVersion===1?o=r.DEPTH_STENCIL:e.depth&&e.stencil?o=r.DEPTH24_STENCIL8:e.depth?o=r.DEPTH_COMPONENT24:o=r.STENCIL_INDEX8,n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,o,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let s=i.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=i[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&n.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const u=s[l],c=u.parentTextureArray||u;this.renderer.texture.bind(c,0),l===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+l,u.target,c._glTextures[this.CONTEXT_UID].texture,r),a.push(n.COLOR_ATTACHMENT0+l))}if(a.length>1&&n.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,r)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||n.createRenderbuffer();let l,u;this.renderer.context.webGLVersion===1?(l=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH_STENCIL):e.depth&&e.stencil?(l=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH24_STENCIL8):e.depth?(l=n.DEPTH_ATTACHMENT,u=n.DEPTH_COMPONENT24):(l=n.STENCIL_ATTACHMENT,u=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,u,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,u,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,l,n.RENDERBUFFER,i.stencil)}else i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:r}=this;let n=We.NONE;if(e<=1||r===null)return n;for(let i=0;i<r.length;i++)if(r[i]<=e){n=r[i];break}return n===1&&(n=We.NONE),n}blit(e,r,n){const{current:i,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!i)return;const l=i.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const c=i.colorTextures[0];if(!c)return;l.blitFramebuffer||(l.blitFramebuffer=new Jd(i.width,i.height),l.blitFramebuffer.addColorTexture(0,c)),e=l.blitFramebuffer,e.colorTextures[0]!==c&&(e.colorTextures[0]=c,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}r||(r=zP,r.width=i.width,r.height=i.height),n||(n=r);const u=r.width===n.width&&r.height===n.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,r){const n=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,r)}disposeAll(e){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<r.length;n++)this.disposeFramebuffer(r[n],e)}forceStencil(){const e=this.current;if(!e)return;const r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil&&e.stencil)return;e.stencil=!0;const n=e.width,i=e.height,s=this.gl,o=r.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,l,n,i):s.renderbufferStorage(s.RENDERBUFFER,l,n,i),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ce}destroy(){this.renderer=null}}j_.extension={type:V.RendererSystem,name:"framebuffer"};q.add(j_);const mh={5126:4,5123:2,5121:1};class G_{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;H.PREFER_ENV===ki.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(i,s)=>n.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,a,l)=>n.drawElementsInstancedANGLE(i,s,o,a,l),e.drawArraysInstanced=(i,s,o,a)=>n.drawArraysInstancedANGLE(i,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;const{gl:n}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,r=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];r.update(i)}}checkCompatibility(e,r){const n=e.attributes,i=r.attributeData;for(const s in i)if(!n[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){const n=e.attributes,i=r.attributeData,s=["g",e.id];for(const o in n)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,r,n=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,a);const l=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let c=u[l];if(c)return u[a.id]=c,c;const h=e.buffers,d=e.attributes,m={},g={};for(const x in h)m[x]=0,g[x]=0;for(const x in d)!d[x].size&&a.attributeData[x]?d[x].size=a.attributeData[x].size:d[x].size||console.warn(`PIXI Geometry attribute '${x}' size cannot be determined (likely the bound shader does not have the attribute)`),m[d[x].buffer]+=d[x].size*mh[d[x].type];for(const x in d){const w=d[x],y=w.size;w.stride===void 0&&(m[w.buffer]===y*mh[w.type]?w.stride=0:w.stride=m[w.buffer]),w.start===void 0&&(w.start=g[w.buffer],g[w.buffer]+=y*mh[w.type])}c=i.createVertexArray(),i.bindVertexArray(c);for(let x=0;x<h.length;x++){const w=h[x];o.bind(w),n&&w._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=c,u[l]=c,i.bindVertexArray(null),o.unbind(Nr.ARRAY_BUFFER),c}disposeGeometry(e,r){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!n){if(o)for(let l=0;l<s.length;l++){const u=s[l]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!r&&o.dispose(s[l],r))}if(!r){for(const l in n)if(l[0]==="g"){const u=n[l];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const r=Object.keys(this.managedGeometries);for(let n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],e)}activateVao(e,r){const n=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const u in a){const c=a[u],h=o[c.buffer],d=h._glBuffers[i];if(r.attributeData[u]){l!==d&&(s.bind(h),l=d);const m=r.attributeData[u].location;if(n.enableVertexAttribArray(m),n.vertexAttribPointer(m,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)n.vertexAttribDivisor(m,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,n,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,l,(n||0)*a,i||1):s.drawElements(e,r||o.indexBuffer.data.length,l,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,n,r||o.getSize(),i||1):s.drawArrays(e,n,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}G_.extension={type:V.RendererSystem,name:"geometry"};q.add(G_);const Iy=new Me;class z_{constructor(e,r){this._texture=e,this.mapCoord=new Me,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];r[i]=s*n.a+o*n.c+n.tx,r[i+1]=s*n.b+o*n.d+n.ty}return r}update(e){const r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const n=r._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=r.orig,s=r.trim;s&&(Iy.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Iy));const o=r.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(r._frame.x+l+u)/o.width,a[1]=(r._frame.y+l+u)/o.height,a[2]=(r._frame.x+r._frame.width-l+u)/o.width,a[3]=(r._frame.y+r._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}}var VP=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,$P=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class HP extends _t{constructor(e,r,n){let i=null;typeof e!="string"&&r===void 0&&n===void 0&&(i=e,e=void 0,r=void 0,n=void 0),super(e||$P,r||VP,n),this.maskSprite=i,this.maskMatrix=new Me}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,n,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new z_(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,n,i))}}class WP{constructor(e=null){this.type=qe.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=_t.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=qe.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class V_{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let n=r;if(!n.isMaskData){const s=this.maskDataPool.pop()||new WP;s.pooled=!0,s.maskObject=r,n=s}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==qe.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case qe.SCISSOR:this.renderer.scissor.push(n);break;case qe.STENCIL:this.renderer.stencil.push(n);break;case qe.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case qe.COLOR:this.pushColorMask(n);break}n.type===qe.SPRITE&&this.maskStack.push(n)}pop(e){const r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case qe.SCISSOR:this.renderer.scissor.pop(r);break;case qe.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case qe.SPRITE:this.popSpriteMask(r);break;case qe.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===qe.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const r=e.maskObject;r?r.isSprite?e.type=qe.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=qe.SCISSOR:e.type=qe.STENCIL:e.type=qe.COLOR}pushSpriteMask(e){const{maskObject:r}=e,n=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new HP])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=r;const s=n.filterArea;n.filterArea=r.getBounds(!0),this.renderer.filter.push(n,i),n.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const r=e._colorMask,n=e._colorMask=r&e.colorMask;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const r=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}V_.extension={type:V.RendererSystem,name:"mask"};q.add(V_);class $_{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:r}=this.renderer,n=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==n&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const ky=new Me,My=[],H_=class Al extends $_{constructor(e){super(e),this.glConst=H.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const r=e._scissorRect,{maskObject:n}=e,{renderer:i}=this,s=i.renderTexture,o=n.getBounds(!0,My.pop()??new ce);this.roundFrameToPixels(o,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),r&&o.fit(r),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:r,b:n,c:i,d:s}=e;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(r)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:r}=e;if(!r.isFastRect||!r.isFastRect()||Al.isMatrixRotated(r.worldTransform)||Al.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const n=e._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(e,r,n,i,s){Al.isMatrixRotated(s)||(s=s?ky.copyFrom(s):ky.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*r),e.y=Math.round(e.y*r),e.width=Math.round(e.width*r),e.height=Math.round(e.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:r}=this.renderer;e._scissorRect||r.enable(r.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:r}=this.renderer;e&&My.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():r.disable(r.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let r;this.renderer.renderTexture.current?r=e.y:r=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,r,e.width,e.height)}};H_.extension={type:V.RendererSystem,name:"scissor"};let XP=H_;q.add(XP);class W_ extends $_{constructor(e){super(e),this.glConst=H.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const r=e.maskObject,{gl:n}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,n.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(n._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}W_.extension={type:V.RendererSystem,name:"stencil"};q.add(W_);class X_{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return pe("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return pe("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return pe("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}X_.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"_plugin"};q.add(X_);class Y_{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Me,this.transform=null}update(e,r,n,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,n,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}}Y_.extension={type:V.RendererSystem,name:"projection"};q.add(Y_);const YP=new Bp,By=new ce;class K_{constructor(e){this.renderer=e,this._tempMatrix=new Me}generateTexture(e,r){const{region:n,...i}=r||{},s=(n==null?void 0:n.copyTo(By))||e.getLocalBounds(By,!0),o=i.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),i.width=s.width,i.height=s.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const a=Bi.create(i);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=YP,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}K_.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"textureGenerator"};q.add(K_);const Qn=new ce,so=new ce;class q_{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ce,this.destinationFrame=new ce,this.viewportFrame=new ce}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,r,n){const i=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,r||(Qn.width=e.frame.width,Qn.height=e.frame.height,r=Qn),n||(so.x=e.frame.x,so.y=e.frame.y,so.width=r.width,so.height=r.height,n=so),o=s.framebuffer):(a=i.resolution,r||(Qn.width=i._view.screen.width,Qn.height=i._view.screen.height,r=Qn),n||(n=Qn,n.width=r.width,n.height=r.height));const l=this.viewportFrame;l.x=n.x*a,l.y=n.y*a,l.width=n.width*a,l.height=n.height*a,e||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(n,r,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)}clear(e,r){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=Ie.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:u,width:c,height:h}=this.viewportFrame;l=Math.round(l),u=Math.round(u),c=Math.round(c),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,u,c,h)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}q_.extension={type:V.RendererSystem,name:"renderTexture"};q.add(q_);class KP{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function qP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=B_(e,s.type),a={type:o,name:s.name,size:M_(o),location:e.getAttribLocation(t,s.name)};r[s.name]=a}return r}function ZP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=B_(e,s.type);r[o]={name:o,index:i,type:l,size:s.size,isArray:a,value:I_(l,s.size)}}return r}function QP(t,e){var a;const r=by(t,t.VERTEX_SHADER,e.vertexSrc),n=by(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||CP(t,i,r,n),e.attributeData=qP(i,t),e.uniformData=ZP(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((u,c)=>u>c?1:-1);for(let u=0;u<l.length;u++)e.attributeData[l[u]].location=u,t.bindAttribLocation(i,u,l[u]);t.linkProgram(i)}t.deleteShader(r),t.deleteShader(n);const o={};for(const l in e.uniformData){const u=e.uniformData[l];o[l]={location:t.getUniformLocation(i,l),value:I_(u.type,u.size)}}return new KP(i,o)}function JP(t,e,r,n,i){r.buffer.update(i)}const eI={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Z_={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function tI(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let r=0,n=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(r=Z_[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!==0&&n<16){const a=n%r%16;n+=a,i+=a}n+r>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function rI(t,e){const r=[];for(const n in t)e[n]&&r.push(e[n]);return r.sort((n,i)=>n.index-i.index),r}function nI(t,e){if(!t.autoManage)return{size:0,syncFunc:JP};const r=rI(t.uniforms,e),{uboElements:n,size:i}=tI(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<n.length;o++){const a=n[o],l=t.uniforms[a.data.name],u=a.data.name;let c=!1;for(let h=0;h<As.length;h++){const d=As[h];if(d.codeUbo&&d.test(a.data,l)){s.push(`offset = ${a.offset/4};`,As[h].codeUbo(a.data.name,l)),c=!0;break}}if(!c)if(a.data.size>1){const h=M_(a.data.type),d=Math.max(Z_[a.data.type]/16,1),m=h/d,g=(4-m%4)%4;s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${m}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${g};
                }

                `)}else{const h=eI[a.data.type];s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${h};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let iI=0;const Za={textureCount:0,uboCount:0};class Q_{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=iI++}systemCheck(){if(!PP())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),r||(Za.textureCount=0,Za.uboCount=0,this.syncUniformGroup(e.uniformGroup,Za)),i}setUniforms(e){const r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,r){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,r))}syncUniforms(e,r,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=bP(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const i=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,r);e.buffer.update(),i(n.uniformData,e.uniforms,this.renderer,Za,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[r])}createSyncBufferGroup(e,r,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(r.program,n);r.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=nI(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return r.uniformGroups[e.id]=a.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,n){const i=e.uniforms,s=[`${n}-`];for(const o in i)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=this.gl,n=e.program,i=QP(r,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Q_.extension={type:V.RendererSystem,name:"shader"};q.add(Q_);class mu{constructor(e){this.renderer=e}run(e){const{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.4.3 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}}mu.defaultOptions={hello:!1},mu.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"startup"};q.add(mu);function sI(t,e=[]){return e[ne.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.ADD]=[t.ONE,t.ONE],e[ne.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.NONE]=[0,0],e[ne.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[ne.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ne.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[ne.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[ne.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ne.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[ne.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[ne.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[ne.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[ne.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ne.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const oI=0,aI=1,lI=2,uI=3,cI=4,hI=5,J_=class ef{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ne.NONE,this._blendEq=!1,this.map=[],this.map[oI]=this.setBlend,this.map[aI]=this.setOffset,this.map[lI]=this.setCullFace,this.map[uI]=this.setDepthTest,this.map[cI]=this.setFrontFace,this.map[hI]=this.setDepthMask,this.checks=[],this.defaultState=new Lr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=sI(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let r=this.stateId^e.data,n=0;for(;r;)r&1&&this.map[n].call(this,!!(e.data&1<<n)),r=r>>1,n++;this.stateId=e.data}for(let r=0;r<this.checks.length;r++)this.checks[r](this,e)}forceState(e){e=e||this.defaultState;for(let r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(let r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(ef.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(ef.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const r=this.blendModes[e],n=this.gl;r.length===2?n.blendFunc(r[0],r[1]):n.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,n.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,r){this.gl.polygonOffset(e,r)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,r){const n=this.checks.indexOf(e);r&&n===-1?this.checks.push(e):!r&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,r){e.setBlendMode(r.blendMode)}static checkPolygonOffset(e,r){e.setPolygonOffset(1,r.polygonOffset)}destroy(){this.gl=null}};J_.extension={type:V.RendererSystem,name:"state"};let dI=J_;q.add(dI);class fI extends da{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const r=(e.priority??[]).filter(i=>e.systems[i]),n=[...r,...Object.keys(e.systems).filter(i=>!r.includes(i))];for(const i of n)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(r=>{this.runners[r]=new pr(r)})}addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(e,r){const n=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=n.find(o=>this._systemsHash[o]===i);i[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const po=class Cl{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Cl.defaultMaxIdle,this.checkCountMax=Cl.defaultCheckCountMax,this.mode=Cl.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==bp.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,r=e.managedTextures;let n=!1;for(let i=0;i<r.length;i++){const s=r[i];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),r[i]=null,n=!0)}if(n){let i=0;for(let s=0;s<r.length;s++)r[s]!==null&&(r[i++]=r[s]);r.length=i}}unload(e){const r=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&r.destroyTexture(n);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};po.defaultMode=bp.AUTO,po.defaultMaxIdle=60*60,po.defaultCheckCountMax=60*10,po.extension={type:V.RendererSystem,name:"textureGC"};let ai=po;q.add(ai);class gh{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=J.UNSIGNED_BYTE,this.internalFormat=j.RGBA,this.samplerType=0}}function pI(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:$.FLOAT,[t.RGBA]:$.FLOAT,[t.ALPHA]:$.FLOAT,[t.LUMINANCE]:$.FLOAT,[t.LUMINANCE_ALPHA]:$.FLOAT,[t.R8]:$.FLOAT,[t.R8_SNORM]:$.FLOAT,[t.RG8]:$.FLOAT,[t.RG8_SNORM]:$.FLOAT,[t.RGB8]:$.FLOAT,[t.RGB8_SNORM]:$.FLOAT,[t.RGB565]:$.FLOAT,[t.RGBA4]:$.FLOAT,[t.RGB5_A1]:$.FLOAT,[t.RGBA8]:$.FLOAT,[t.RGBA8_SNORM]:$.FLOAT,[t.RGB10_A2]:$.FLOAT,[t.RGB10_A2UI]:$.FLOAT,[t.SRGB8]:$.FLOAT,[t.SRGB8_ALPHA8]:$.FLOAT,[t.R16F]:$.FLOAT,[t.RG16F]:$.FLOAT,[t.RGB16F]:$.FLOAT,[t.RGBA16F]:$.FLOAT,[t.R32F]:$.FLOAT,[t.RG32F]:$.FLOAT,[t.RGB32F]:$.FLOAT,[t.RGBA32F]:$.FLOAT,[t.R11F_G11F_B10F]:$.FLOAT,[t.RGB9_E5]:$.FLOAT,[t.R8I]:$.INT,[t.R8UI]:$.UINT,[t.R16I]:$.INT,[t.R16UI]:$.UINT,[t.R32I]:$.INT,[t.R32UI]:$.UINT,[t.RG8I]:$.INT,[t.RG8UI]:$.UINT,[t.RG16I]:$.INT,[t.RG16UI]:$.UINT,[t.RG32I]:$.INT,[t.RG32UI]:$.UINT,[t.RGB8I]:$.INT,[t.RGB8UI]:$.UINT,[t.RGB16I]:$.INT,[t.RGB16UI]:$.UINT,[t.RGB32I]:$.INT,[t.RGB32UI]:$.UINT,[t.RGBA8I]:$.INT,[t.RGBA8UI]:$.UINT,[t.RGBA16I]:$.INT,[t.RGBA16UI]:$.UINT,[t.RGBA32I]:$.INT,[t.RGBA32UI]:$.UINT,[t.DEPTH_COMPONENT16]:$.FLOAT,[t.DEPTH_COMPONENT24]:$.FLOAT,[t.DEPTH_COMPONENT32F]:$.FLOAT,[t.DEPTH_STENCIL]:$.FLOAT,[t.DEPTH24_STENCIL8]:$.FLOAT,[t.DEPTH32F_STENCIL8]:$.FLOAT}:e={[t.RGB]:$.FLOAT,[t.RGBA]:$.FLOAT,[t.ALPHA]:$.FLOAT,[t.LUMINANCE]:$.FLOAT,[t.LUMINANCE_ALPHA]:$.FLOAT,[t.DEPTH_STENCIL]:$.FLOAT},e}function mI(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[J.UNSIGNED_BYTE]:{[j.RGBA]:t.RGBA8,[j.RGB]:t.RGB8,[j.RG]:t.RG8,[j.RED]:t.R8,[j.RGBA_INTEGER]:t.RGBA8UI,[j.RGB_INTEGER]:t.RGB8UI,[j.RG_INTEGER]:t.RG8UI,[j.RED_INTEGER]:t.R8UI,[j.ALPHA]:t.ALPHA,[j.LUMINANCE]:t.LUMINANCE,[j.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[J.BYTE]:{[j.RGBA]:t.RGBA8_SNORM,[j.RGB]:t.RGB8_SNORM,[j.RG]:t.RG8_SNORM,[j.RED]:t.R8_SNORM,[j.RGBA_INTEGER]:t.RGBA8I,[j.RGB_INTEGER]:t.RGB8I,[j.RG_INTEGER]:t.RG8I,[j.RED_INTEGER]:t.R8I},[J.UNSIGNED_SHORT]:{[j.RGBA_INTEGER]:t.RGBA16UI,[j.RGB_INTEGER]:t.RGB16UI,[j.RG_INTEGER]:t.RG16UI,[j.RED_INTEGER]:t.R16UI,[j.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[J.SHORT]:{[j.RGBA_INTEGER]:t.RGBA16I,[j.RGB_INTEGER]:t.RGB16I,[j.RG_INTEGER]:t.RG16I,[j.RED_INTEGER]:t.R16I},[J.UNSIGNED_INT]:{[j.RGBA_INTEGER]:t.RGBA32UI,[j.RGB_INTEGER]:t.RGB32UI,[j.RG_INTEGER]:t.RG32UI,[j.RED_INTEGER]:t.R32UI,[j.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[J.INT]:{[j.RGBA_INTEGER]:t.RGBA32I,[j.RGB_INTEGER]:t.RGB32I,[j.RG_INTEGER]:t.RG32I,[j.RED_INTEGER]:t.R32I},[J.FLOAT]:{[j.RGBA]:t.RGBA32F,[j.RGB]:t.RGB32F,[j.RG]:t.RG32F,[j.RED]:t.R32F,[j.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[J.HALF_FLOAT]:{[j.RGBA]:t.RGBA16F,[j.RGB]:t.RGB16F,[j.RG]:t.RG16F,[j.RED]:t.R16F},[J.UNSIGNED_SHORT_5_6_5]:{[j.RGB]:t.RGB565},[J.UNSIGNED_SHORT_4_4_4_4]:{[j.RGBA]:t.RGBA4},[J.UNSIGNED_SHORT_5_5_5_1]:{[j.RGBA]:t.RGB5_A1},[J.UNSIGNED_INT_2_10_10_10_REV]:{[j.RGBA]:t.RGB10_A2,[j.RGBA_INTEGER]:t.RGB10_A2UI},[J.UNSIGNED_INT_10F_11F_11F_REV]:{[j.RGB]:t.R11F_G11F_B10F},[J.UNSIGNED_INT_5_9_9_9_REV]:{[j.RGB]:t.RGB9_E5},[J.UNSIGNED_INT_24_8]:{[j.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[J.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[j.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[J.UNSIGNED_BYTE]:{[j.RGBA]:t.RGBA,[j.RGB]:t.RGB,[j.ALPHA]:t.ALPHA,[j.LUMINANCE]:t.LUMINANCE,[j.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[J.UNSIGNED_SHORT_5_6_5]:{[j.RGB]:t.RGB},[J.UNSIGNED_SHORT_4_4_4_4]:{[j.RGBA]:t.RGBA},[J.UNSIGNED_SHORT_5_5_5_1]:{[j.RGBA]:t.RGBA}},e}class e1{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ae,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mI(e),this.samplerTypes=pI(e);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new gh(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new gh(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,r=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:r,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}ensureSamplerType(e){const{boundTextures:r,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let s=e-1;s>=0;--s){const o=r[s];o&&o._glTextures[i].samplerType!==$.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const r=new gh(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){var n;r.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,r.samplerType=this.samplerTypes[r.internalFormat]??$.FLOAT,this.webGLVersion===2&&e.type===J.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){var i;const r=e._glTextures[this.CONTEXT_UID];if(!r)return;const n=this.renderer;if(this.initTextureType(e,r),(i=e.resource)==null?void 0:i.upload(n,e,r))r.samplerType!==$.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=n.gl;(r.width!==s||r.height!==o||r.dirtyId<0)&&(r.width=s,r.height=o,a.texImage2D(e.target,0,r.internalFormat,s,o,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(e);i!==-1&&Ts(this.managedTextures,i,1)}}updateTextureStyle(e){var n;const r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===Dr.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=jn.CLAMP:r.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){const n=this.gl;if(r.mipmap&&e.mipmap!==Dr.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Xr.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===Xr.LINEAR){const s=Math.min(e.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Xr.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===Xr.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}e1.extension={type:V.RendererSystem,name:"texture"};q.add(e1);class t1{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){const{gl:n,renderer:i}=this;r&&i.shader.bind(r),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:r,renderer:n,CONTEXT_UID:i}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[i]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(n.buffer.update(a),a._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){const n=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&s.dispose(a,r))}n&&(r||i.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}t1.extension={type:V.RendererSystem,name:"transformFeedback"};q.add(t1);class gu{constructor(e){this.renderer=e}init(e){this.screen=new ce(0,0,e.width,e.height),this.element=e.view||H.ADAPTER.createCanvas(),this.resolution=e.resolution||H.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var r;e&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}gu.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},gu.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"_view"};q.add(gu);H.PREFER_ENV=ki.WEBGL2;H.STRICT_TEXTURE_CACHE=!1;H.RENDER_OPTIONS={...pu.defaultOptions,...fu.defaultOptions,...gu.defaultOptions,...mu.defaultOptions};Object.defineProperties(H,{WRAP_MODE:{get(){return ae.defaultOptions.wrapMode},set(t){pe("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),ae.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return ae.defaultOptions.scaleMode},set(t){pe("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),ae.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return ae.defaultOptions.mipmap},set(t){pe("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),ae.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return ae.defaultOptions.anisotropicLevel},set(t){pe("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),ae.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return pe("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),_t.defaultResolution},set(t){_t.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return pe("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),_t.defaultMultisample},set(t){_t.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return oi.defaultMaxTextures},set(t){pe("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),oi.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return oi.defaultBatchSize},set(t){pe("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),oi.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return oi.canUploadSameBuffer},set(t){pe("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),oi.canUploadSameBuffer=t}},GC_MODE:{get(){return ai.defaultMode},set(t){pe("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ai.defaultMode=t}},GC_MAX_IDLE:{get(){return ai.defaultMaxIdle},set(t){pe("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ai.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return ai.defaultCheckCountMax},set(t){pe("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ai.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return qr.defaultVertexPrecision},set(t){pe("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),qr.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return qr.defaultFragmentPrecision},set(t){pe("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),qr.defaultFragmentPrecision=t}}});var Ti=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Ti||{});class yh{constructor(e,r=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=n,this.once=i}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const r1=class Nt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new yh(null,null,1/0),this.deltaMS=1/Nt.targetFPMS,this.elapsedMS=1/Nt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=Ti.NORMAL){return this._addListener(new yh(e,r,n))}addOnce(e,r,n=Ti.NORMAL){return this._addListener(new yh(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*Nt.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,Nt.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!Nt._shared){const e=Nt._shared=new Nt;e.autoStart=!0,e._protected=!0}return Nt._shared}static get system(){if(!Nt._system){const e=Nt._system=new Nt;e.autoStart=!0,e._protected=!0}return Nt._system}};r1.targetFPMS=.06;let Lt=r1;Object.defineProperties(H,{TARGET_FPMS:{get(){return Lt.targetFPMS},set(t){pe("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Lt.targetFPMS=t}}});class n1{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Ti.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Lt.shared:new Lt,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}n1.extension=V.Application;q.add(n1);const i1=[];q.handleByList(V.Renderer,i1);function gI(t){for(const e of i1)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var yI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,vI=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const xI=yI,s1=vI;class o1{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}r>=We.HIGH?this.multisample=We.HIGH:r>=We.MEDIUM?this.multisample=We.MEDIUM:r>=We.LOW?this.multisample=We.LOW:this.multisample=We.NONE}destroy(){}}o1.extension={type:V.RendererSystem,name:"_multisample"};q.add(o1);class _I{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class a1{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);r.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[r]=e,n.bindBufferBase(n.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,n){const{gl:i,CONTEXT_UID:s}=this;n=n||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,o.buffer,n*256,256)}update(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{const s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),n&&(r||i.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const r=Object.keys(this.managedBuffers);for(let n=0;n<r.length;n++)this.dispose(this.managedBuffers[r[n]],e)}createGLBuffer(e){const{CONTEXT_UID:r,gl:n}=this;return e._glBuffers[r]=new _I(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}}a1.extension={type:V.RendererSystem,name:"buffer"};q.add(a1);class l1{constructor(e){this.renderer=e}render(e,r){const n=this.renderer;let i,s,o,a;if(r&&(i=r.renderTexture,s=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=o,!n.context.isLost){if(i||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(s??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),i&&(r.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}l1.extension={type:V.RendererSystem,name:"objectRenderer"};q.add(l1);const Rl=class tf extends fI{constructor(e){super(),this.type=Vx.WEBGL,e=Object.assign({},H.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new mr({projectionMatrix:new Me},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:tf.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in e&&(pe("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=tf.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:VR()}render(e,r){this.objectRenderer.render(e,r)}resize(e,r){this._view.resizeView(e,r)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return pe("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return pe("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return pe("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return pe("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){pe("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return pe("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){pe("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return pe("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,r){return this.textureGenerator.generateTexture(e,r)}};Rl.extension={type:V.Renderer,priority:1},Rl.__plugins={},Rl.__systems={};let Fp=Rl;q.handleByMap(V.RendererPlugin,Fp.__plugins);q.handleByMap(V.RendererSystem,Fp.__systems);q.add(Fp);class u1 extends ia{constructor(e,r){const{width:n,height:i}=r||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new ae;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof ia?this.addResourceAt(e[n],n):this.addResourceAt(C_(e[n],r),n))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(e).then(()=>{const{realWidth:r,realHeight:n}=this.items[0];return this.resize(r,n),this.update(),Promise.resolve(this)}),this._load}}class wI extends u1{constructor(e,r){const{width:n,height:i}=r||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:n,height:i}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Ss.TEXTURE_2D_ARRAY}upload(e,r,n){const{length:i,itemDirtyIds:s,items:o}=this,{gl:a}=e;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,r.format,n.type,null);for(let l=0;l<i;l++){const u=o[l];s[l]<u.dirtyId&&(s[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,r.format,n.type,u.resource.source))}return!0}}class SI extends sn{constructor(e){super(e)}static test(e){const{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const c1=class mo extends u1{constructor(e,r){const{width:n,height:i,autoLoad:s,linkBaseTexture:o}=r||{};if(e&&e.length!==mo.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:n,height:i});for(let a=0;a<mo.SIDES;a++)this.items[a].target=Ss.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,r),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Ss.TEXTURE_CUBE_MAP}addBaseTextureAt(e,r,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[r])throw new Error(`Index ${r} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Ss.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this}upload(e,r,n){const i=this.itemDirtyIds;for(let s=0;s<mo.SIDES;s++){const o=this.items[s];(i[s]<o.dirtyId||n.dirtyId<r.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===mo.SIDES}};c1.SIDES=6;let EI=c1;class ms extends sn{constructor(e,r){r=r||{};let n,i,s;typeof e=="string"?(n=ms.EMPTY,i=e,s=!0):(n=e,i=null,s=!1),super(n),this.url=i,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.ownsImageBitmap=r.ownsImageBitmap??s,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{const n=await H.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Rt.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(n){if(this.destroyed)return;r(n),this.onError.emit(n)}}),this._load)}upload(e,r,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return ms._EMPTY=ms._EMPTY??H.ADAPTER.createCanvas(0,0),ms._EMPTY}}const rf=class Pl extends sn{constructor(e,r){r=r||{},super(H.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},Pl.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;sn.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=r=>{this._resolve&&(e.onerror=null,this.onError.emit(r))},e.onload=()=>{if(!this._resolve)return;const r=e.width,n=e.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=r*this.scale,s=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/n*r,s=this._overrideHeight||this._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);const o=this.source;o.width=i,o.height=s,o._pixiId=`canvas_${bi()}`,o.getContext("2d").drawImage(e,0,0,r,n,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){const r=Pl.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,r){return r==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Pl.SVG_XML.test(e)}};rf.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,rf.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let nf=rf;class bI extends sn{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const sf=class of extends sn{constructor(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){const n=document.createElement("video");r.autoLoad!==!1&&n.setAttribute("preload","auto"),r.playsinline!==!1&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),r.muted===!0&&(n.setAttribute("muted",""),n.muted=!0),r.loop===!0&&n.setAttribute("loop",""),r.autoPlay!==!1&&n.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];sn.crossOrigin(n,i,r.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const u=a.split("?").shift().toLowerCase(),c=u.slice(u.lastIndexOf(".")+1);l=l||of.MIME_TYPES[c]||`video/${c}`}o.src=a,l&&(o.type=l),n.appendChild(o)}e=n}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=r.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),r.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const r=Lt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((r,n)=>{this.valid?r(this):(this._resolve=r,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const r=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!r&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Lt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Lt.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Lt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,r){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||of.TYPES.includes(r)}};sf.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],sf.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let h1=sf;Hd.push(ms,D_,SI,h1,bI,nf,Yu,EI,wI);class yu{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?ce.EMPTY:(e=e||new ce(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){const{a:n,b:i,c:s,d:o,tx:a,ty:l}=e,u=n*r.x+s*r.y+a,c=i*r.x+o*r.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(e){let r=this.minX,n=this.minY,i=this.maxX,s=this.maxY,o=e[0],a=e[1];r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[2],a=e[3],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[4],a=e[5],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[6],a=e[7],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,this.minX=r,this.minY=n,this.maxX=i,this.maxY=s}addFrame(e,r,n,i,s){this.addFrameMatrix(e.worldTransform,r,n,i,s)}addFrameMatrix(e,r,n,i,s){const o=e.a,a=e.b,l=e.c,u=e.d,c=e.tx,h=e.ty;let d=this.minX,m=this.minY,g=this.maxX,x=this.maxY,w=o*r+l*n+c,y=a*r+u*n+h;d=w<d?w:d,m=y<m?y:m,g=w>g?w:g,x=y>x?y:x,w=o*i+l*n+c,y=a*i+u*n+h,d=w<d?w:d,m=y<m?y:m,g=w>g?w:g,x=y>x?y:x,w=o*r+l*s+c,y=a*r+u*s+h,d=w<d?w:d,m=y<m?y:m,g=w>g?w:g,x=y>x?y:x,w=o*i+l*s+c,y=a*i+u*s+h,d=w<d?w:d,m=y<m?y:m,g=w>g?w:g,x=y>x?y:x,this.minX=d,this.minY=m,this.maxX=g,this.maxY=x}addVertexData(e,r,n){let i=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=r;l<n;l+=2){const u=e[l],c=e[l+1];i=u<i?u:i,s=c<s?c:s,o=u>o?u:o,a=c>a?c:a}this.minX=i,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,r,n,i){this.addVerticesMatrix(e.worldTransform,r,n,i)}addVerticesMatrix(e,r,n,i,s=0,o=s){const a=e.a,l=e.b,u=e.c,c=e.d,h=e.tx,d=e.ty;let m=this.minX,g=this.minY,x=this.maxX,w=this.maxY;for(let y=n;y<i;y+=2){const v=r[y],p=r[y+1],_=a*v+u*p+h,S=c*p+l*v+d;m=Math.min(m,_-s),x=Math.max(x,_+s),g=Math.min(g,S-o),w=Math.max(w,S+o)}this.minX=m,this.minY=g,this.maxX=x,this.maxY=w}addBounds(e){const r=this.minX,n=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,r){const n=e.minX>r.minX?e.minX:r.minX,i=e.minY>r.minY?e.minY:r.minY,s=e.maxX<r.maxX?e.maxX:r.maxX,o=e.maxY<r.maxY?e.maxY:r.maxY;if(n<=s&&i<=o){const a=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=n<a?n:a,this.minY=i<l?i:l,this.maxX=s>u?s:u,this.maxY=o>c?o:c}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){const n=e.minX>r.x?e.minX:r.x,i=e.minY>r.y?e.minY:r.y,s=e.maxX<r.x+r.width?e.maxX:r.x+r.width,o=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(n<=s&&i<=o){const a=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=n<a?n:a,this.minY=i<l?i:l,this.maxX=s>u?s:u,this.maxY=o>c?o:c}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,n,i,s,o){e-=s,r-=o,n+=s,i+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class Ge extends da{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Bp,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new yu,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.defineProperty(Ge.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new ce),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new ce),e=this._localBoundsRect),this._localBounds||(this._localBounds=new yu);const r=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(n==null?void 0:n.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=n,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,n,i){return r&&(e=r.toGlobal(e,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,r=0,n=1,i=1,s=0,o=0,a=0,l=0,u=0){return this.position.x=e,this.position.y=r,this.scale.x=n||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new TI),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*yP}set angle(e){this.transform.rotation=e*vP}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class TI extends Ge{constructor(){super(...arguments),this.sortDirty=null}}Ge.prototype.displayObjectUpdateTransform=Ge.prototype.updateTransform;const AI=new Me;function CI(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const d1=class af extends Ge{constructor(){super(),this.children=[],this.sortableChildren=af.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.addChild(e[r]);else{const r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]}addChildAt(e,r){if(r<0||r>this.children.length)throw new Error(`${e}addChildAt: The index ${r} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e}swapChildren(e,r){if(e===r)return;const n=this.getChildIndex(e),i=this.getChildIndex(r);this.children[n]=r,this.children[i]=e,this.onChildrenChange(n<i?n:i)}getChildIndex(e){const r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r}setChildIndex(e,r){if(r<0||r>=this.children.length)throw new Error(`The index ${r} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(e);Ts(this.children,n,1),this.children.splice(r,0,e),this.onChildrenChange(r)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.removeChild(e[r]);else{const r=e[0],n=this.children.indexOf(r);if(n===-1)return null;r.parent=null,r.transform._parentID=-1,Ts(this.children,n,1),this._boundsID++,this.onChildrenChange(n),r.emit("removed",this),this.emit("childRemoved",r,this,n)}return e[0]}removeChildAt(e){const r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,Ts(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r}removeChildren(e=0,r=this.children.length){const n=e,i=r,s=i-n;let o;if(s>0&&s<=i){o=this.children.splice(n,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let r=0,n=this.children.length;r<n;++r){const i=this.children[r];i._lastSortedIndex=r,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(CI),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,r=this.children.length;e<r;++e){const n=this.children[e];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const r=this.children[e];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){const n=r._mask.isMaskData?r._mask.maskObject:r._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,r=!1){const n=super.getLocalBounds(e);if(!r)for(let i=0,s=this.children.length;i<s;++i){const o=this.children[i];o.visible&&o.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const r=e.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==af.prototype._render&&(n=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=AI.copyFrom(i),i.prepend(s)):i=s),n&&r.intersects(n,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],u=l.cullable;l.cullable=u||!this.cullArea,l.render(e),l.cullable=u}}render(e){var r;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(r=this.filters)!=null&&r.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,i=this.children.length;n<i;++n)this.children[n].render(e)}}renderAdvanced(e){var s,o,a;const r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<r.length;l++)r[l].enabled&&this._enabledFilters.push(r[l])}const i=r&&((s=this._enabledFilters)==null?void 0:s.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==qe.NONE));if(i&&e.batch.flush(),r&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,u=this.children.length;l<u;++l)this.children[l].render(e)}i&&e.batch.flush(),n&&e.mask.pop(this),r&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const r=typeof e=="boolean"?e:e==null?void 0:e.children,n=this.removeChildren(0,this.children.length);if(r)for(let i=0;i<n.length;++i)n[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const r=this.getLocalBounds().width;r!==0?this.scale.x=e/r:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const r=this.getLocalBounds().height;r!==0?this.scale.y=e/r:this.scale.y=1,this._height=e}};d1.defaultSortableChildren=!1;let Bt=d1;Bt.prototype.containerUpdateTransform=Bt.prototype.updateTransform;Object.defineProperties(H,{SORTABLE_CHILDREN:{get(){return Bt.defaultSortableChildren},set(t){pe("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Bt.defaultSortableChildren=t}}});const oo=new ye,RI=new Uint16Array([0,1,2,0,2,3]);class Hn extends Bt{constructor(e){super(),this._anchor=new Kr(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Ie(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=ne.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||K.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=RI,this.pluginName="batch",this.isSprite=!0,this._roundPixels=H.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Pn(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Pn(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,u=this.vertexData,c=e.trim,h=e.orig,d=this._anchor;let m=0,g=0,x=0,w=0;if(c?(g=c.x-d._x*h.width,m=g+c.width,w=c.y-d._y*h.height,x=w+c.height):(g=-d._x*h.width,m=g+h.width,w=-d._y*h.height,x=w+h.height),u[0]=n*g+s*w+a,u[1]=o*w+i*g+l,u[2]=n*m+s*w+a,u[3]=o*w+i*m+l,u[4]=n*m+s*x+a,u[5]=o*x+i*m+l,u[6]=n*g+s*x+a,u[7]=o*x+i*g+l,this._roundPixels){const y=H.RESOLUTION;for(let v=0;v<u.length;++v)u[v]=Math.round(u[v]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,r=this.vertexTrimmedData,n=e.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,u=s.d,c=s.tx,h=s.ty,d=-i._x*n.width,m=d+n.width,g=-i._y*n.height,x=g+n.height;if(r[0]=o*d+l*g+c,r[1]=u*g+a*d+h,r[2]=o*m+l*g+c,r[3]=u*g+a*m+h,r[4]=o*m+l*x+c,r[5]=u*x+a*m+h,r[6]=o*d+l*x+c,r[7]=u*x+a*d+h,this._roundPixels){const w=H.RESOLUTION;for(let y=0;y<r.length;++y)r[y]=Math.round(r[y]*w)/w}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new yu),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new ce),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,oo);const r=this._texture.orig.width,n=this._texture.orig.height,i=-r*this.anchor.x;let s=0;return oo.x>=i&&oo.x<i+r&&(s=-n*this.anchor.y,oo.y>=s&&oo.y<s+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const r=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(e,r){const n=e instanceof K?e:K.from(e,r);return new Hn(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const r=Pn(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const r=Pn(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||K.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const f1=new Me;Ge.prototype._cacheAsBitmap=!1;Ge.prototype._cacheData=null;Ge.prototype._cacheAsBitmapResolution=null;Ge.prototype._cacheAsBitmapMultisample=null;class PI{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Ge.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new PI),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});Ge.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Ge.prototype._initCachedDisplayObject=function(t){var d,m;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(new ce,!0);if((m=this.filters)!=null&&m.length){const g=this.filters[0].padding;r.pad(g)}const n=this.cacheAsBitmapResolution||t.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=Bi.create({width:r.width,height:r.height,resolution:n,multisample:this.cacheAsBitmapMultisample??t.multisample}),u=`cacheAsBitmap_${bi()}`;this._cacheData.textureCacheId=u,ae.addToCache(l.baseTexture,u),K.addToCache(l,u);const c=this.transform.localTransform.copyTo(f1).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const h=new Hn(l);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(r.x/r.width),h.anchor.y=-(r.y/r.height),h.alpha=e,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h)};Ge.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Ge.prototype._initCachedDisplayObjectCanvas=function(t){var c;if((c=this._cacheData)!=null&&c.sprite)return;const e=this.getLocalBounds(new ce,!0),r=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Bi.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${bi()}`;this._cacheData.textureCacheId=a,ae.addToCache(o.baseTexture,a),K.addToCache(o,a);const l=f1;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const u=new Hn(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};Ge.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Ge.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Ge.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ae.removeFromCache(this._cacheData.textureCacheId),K.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Ge.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Ge.prototype.name=null;Bt.prototype.getChildByName=function(t,e){for(let r=0,n=this.children.length;r<n;r++)if(this.children[r].name===t)return this.children[r];if(e)for(let r=0,n=this.children.length;r<n;r++){const i=this.children[r];if(!i.getChildByName)continue;const s=i.getChildByName(t,!0);if(s)return s}return null};Ge.prototype.getGlobalPosition=function(t=new ye,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var II=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class kI extends _t{constructor(e=1){super(xI,II,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const MI={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},BI=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function NI(t){const e=MI[t],r=e.length;let n=BI,i="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let l=s.replace("%index%",a.toString());o=a,a>=r&&(o=t-a-1),l=l.replace("%value%",e[o].toString()),i+=l,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}const FI=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function DI(t,e){const r=Math.ceil(t/2);let n=FI,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),i+=a,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}class lf extends _t{constructor(e,r=8,n=4,i=_t.defaultResolution,s=5){const o=DI(s,e),a=NI(s);super(o,a),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=n,this.blur=r}apply(e,r,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,n,i);else{const s=e.getFilterTexture(),o=e.renderer;let a=r,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Rr.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,Rr.BLIT),this.uniforms.uSampler=l;const c=l;l=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,n,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class LI extends _t{constructor(e=8,r=4,n=_t.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new lf(!0,e,r,n,i),this.blurYFilter=new lf(!1,e,r,n,i),this.resolution=n,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,n,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,r,a,Rr.CLEAR),this.blurYFilter.apply(e,a,n,i),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,r,n,i):this.blurXFilter.apply(e,r,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var OI=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class uf extends _t{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(s1,OI,e),this.alpha=1}_loadMatrix(e,r=!1){let n=e;r&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,r,n){return e[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],e[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],e[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],e[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],e[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],e[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],e[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],e[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],e[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],e[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],e[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],e[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],e[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],e[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],e[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],e[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],e[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],e[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],e[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],e[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],e}_colorMatrix(e){const r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(e,r){const[n,i,s]=Ie.shared.setValue(e).toArray(),o=[n,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(e,r){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(e){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;const n=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=n+(1-n)*o,u=o*(1-n)-a*i,c=o*(1-n)+a*i,h=o*(1-n)+a*i,d=n+o*(1-n),m=o*(1-n)-a*i,g=o*(1-n)-a*i,x=o*(1-n)+a*i,w=n+o*(1-n),y=[l,u,c,0,0,h,d,m,0,0,g,x,w,0,0,0,0,0,1,0];this._loadMatrix(y,r)}contrast(e,r){const n=(e||0)+1,i=-.5*(n-1),s=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(s,r)}saturate(e=0,r){const n=e*2/3+1,i=(n-1)*-.5,s=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(e){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,n,i,s){e=e||.2,r=r||.15,n=n||16770432,i=i||3375104;const o=Ie.shared,[a,l,u]=o.setValue(n).toArray(),[c,h,d]=o.setValue(i).toArray(),m=[.3,.59,.11,0,0,a,l,u,e,0,c,h,d,r,0,a-c,l-h,u-d,0,0];this._loadMatrix(m,s)}night(e,r){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(e,r){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,r)}lsd(e){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}uf.prototype.grayscale=uf.prototype.greyscale;var UI=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,jI=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class GI extends _t{constructor(e,r){const n=new Me;e.renderable=!1,super(jI,UI,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,r==null&&(r=20),this.scale=new ye(r,r)}apply(e,r,n,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,r,n,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var zI=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,VI=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class $I extends _t{constructor(){super(VI,zI)}}var HI=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class WI extends _t{constructor(e=.5,r=Math.random()){super(s1,HI,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const Ny={AlphaFilter:kI,BlurFilter:LI,BlurFilterPass:lf,ColorMatrixFilter:uf,DisplacementFilter:GI,FXAAFilter:$I,NoiseFilter:WI};Object.entries(Ny).forEach(([t,e])=>{Object.defineProperty(Ny,t,{get(){return pe("7.1.0",`filters.${t} has moved to ${t}`),e}})});class XI{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(Lt.system.add(this.tickerUpdate,this,Ti.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Lt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const bn=new XI;class ga{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ga.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ye,this.page=new ye,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,n,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class vu extends ga{constructor(){super(...arguments),this.client=new ye,this.movement=new ye,this.offset=new ye,this.global=new ye,this.screen=new ye}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,r,n){return e.worldTransform.applyInverse(n||this.global,r)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,n,i,s,o,a,l,u,c,h,d,m,g,x){throw new Error("Method not implemented.")}}class ar extends vu{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Cs extends vu{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Cs.DOM_DELTA_PIXEL=0,Cs.DOM_DELTA_LINE=1,Cs.DOM_DELTA_PAGE=2;const YI=2048,KI=new ye,vh=new ye;class qI{constructor(e){this.dispatch=new da,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const r=this.mappingTable[e.type];if(r)for(let n=0,i=r.length;n<i;n++)r[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){bn.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[n](this.rootTarget,this.rootTarget.eventMode,KI.set(e,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,r){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=n.length-1;i<s;i++)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(r)?r:[r];for(let s=n.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=n[s],this.notifyTarget(e,o)})}propagationPath(e){const r=[e];for(let n=0;n<YI&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestMoveRecursive(e,r,n,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(bn.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let h=c.length-1;h>=0;h--){const d=c[h],m=this.hitTestMoveRecursive(d,this._isInteractive(r)?r:d.eventMode,n,i,s,o||s(e,n));if(m){if(m.length>0&&!m[m.length-1].parent)continue;const g=e.isInteractive();(m.length>0||g)&&(g&&this._allInteractiveElements.push(e),m.push(e)),this._hitElements.length===0&&(this._hitElements=m),a=!0}}}const l=this._isInteractive(r),u=e.isInteractive();return l&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,n)&&i(e,n)?u?[e]:[]:null}hitTestRecursive(e,r,n,i,s){if(this._interactivePrune(e)||s(e,n))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(bn.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let u=l.length-1;u>=0;u--){const c=l[u],h=this.hitTestRecursive(c,this._isInteractive(r)?r:c.eventMode,n,i,s);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const d=e.isInteractive();return(h.length>0||d)&&h.push(e),h}}}const o=this._isInteractive(r),a=e.isInteractive();return o&&i(e,n)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,r){var n;if(e.hitArea&&(e.worldTransform.applyInverse(r,vh),!e.hitArea.contains(vh.x,vh.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,r)))return!0}return!1}hitTestFn(e,r){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){var s,o;r=r??e.type;const n=`on${r}`;(o=(s=e.currentTarget)[n])==null||o.call(s,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){var l,u;if(!(e instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(((l=i.overTargets)==null?void 0:l.length)>0&&s!==r.target){const c=e.type==="mousemove"?"mouseout":"pointerout",h=this.createPointerEvent(e,c,s);if(this.dispatchEvent(h,"pointerout"),n&&this.dispatchEvent(h,"mouseout"),!r.composedPath().includes(s)){const d=this.createPointerEvent(e,"pointerleave",s);for(d.eventPhase=d.AT_TARGET;d.target&&!r.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),n&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(h)}if(s!==r.target){const c=e.type==="mousemove"?"mouseover":"pointerover",h=this.clonePointerEvent(r,c);this.dispatchEvent(h,"pointerover"),n&&this.dispatchEvent(h,"mouseover");let d=s==null?void 0:s.parent;for(;d&&d!==this.rootTarget.parent&&d!==r.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const m=this.clonePointerEvent(r,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==s&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),n&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(h)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),n&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=r.target)==null?void 0:u.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){var o;if(!(e instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(o=n.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(n,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId);if(r.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),n&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const a=n.button===2;this.dispatchEvent(n,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!n.composedPath().includes(s)){let a=s;for(;a&&!n.composedPath().includes(a);){if(n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.notifyTarget(n,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(n,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:r});const l=i.clicksByButton[e.button];if(l.target===a.target&&r-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=r,a.detail=l.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let s=n;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof Cs)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let n=1;n<e.length&&e[n].parent===r;n++)r=e[n];return r}createPointerEvent(e,r,n){const i=this.allocateEvent(ar);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof r=="string"&&(i.type=r),i}createWheelEvent(e){const r=this.allocateEvent(Cs);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){const n=this.allocateEvent(ar);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=r??n.type,n}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof ar&&r instanceof ar&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof vu&&r instanceof vu&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.shiftKey=e.shiftKey,r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){const n=e.currentTarget._events[r];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(r,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let i=0,s=n.length;i<s&&!e.propagationImmediatelyStopped;i++)n[i].once&&e.currentTarget.removeListener(r,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,e)}}const ZI=1,QI={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},cf=class hf{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new qI(null),bn.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ar(null),this.rootWheelEvent=new Cs(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...hf.defaultEventFeatures},{set:(r,n,i)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),r[n]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,hf._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=r.length;n<i;n++){const s=r[n],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,bn.pointerMoved();const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let r=e.target;e.composedPath&&e.composedPath().length>0&&(r=e.composedPath()[0]);const n=r!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,i[s]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const r=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(e){this.removeEvents(),this.domElement=e,bn.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;bn.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;bn.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,r,n){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(r-i.left)*(this.domElement.width/i.width)*s,e.y=(n-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){const r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const s=e.changedTouches[n];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,r.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=ZI),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(e);return r}normalizeWheelEvent(e){const r=this.rootWheelEvent;return this.transferMouseData(r,e),r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ,r.deltaMode=e.deltaMode,this.mapPositionToPoint(r.screen,e.clientX,e.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=e,r.type=e.type,r}bootstrapEvent(e,r){return e.originalEvent=null,e.nativeEvent=r,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r),this.mapPositionToPoint(e.screen,r.clientX,r.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=r.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=QI[e.type]||e.type),e}transferMouseData(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=performance.now(),e.type=r.type,e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.relatedTarget=null,e.shiftKey=r.shiftKey}};cf.extension={name:"events",type:[V.RendererSystem,V.CanvasRendererSystem]},cf.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let df=cf;q.add(df);function Fy(t){return t==="dynamic"||t==="static"}const JI={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Fy(df.defaultEventMode)},set interactive(t){pe("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??df.defaultEventMode},set eventMode(t){this._internalInteractive=Fy(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof r=="object"?r.signal:void 0,s=typeof r=="object"?r.once===!0:!1,o=typeof e=="function"?void 0:e;t=n?`${t}capture`:t;const a=typeof e=="function"?e:e.handleEvent,l=this;i&&i.addEventListener("abort",()=>{l.off(t,a,o)}),s?l.once(t,a,o):l.on(t,a,o)},removeEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof ga))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};Ge.mixin(JI);const e2={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Ge.mixin(e2);const t2=9,Qa=100,r2=0,n2=0,Dy=2,Ly=1,i2=-1e3,s2=-1e3,o2=2;class p1{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Yr.tablet||Yr.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${Qa}px`,r.style.height=`${Qa}px`,r.style.position="absolute",r.style.top=`${r2}px`,r.style.left=`${n2}px`,r.style.zIndex=Dy.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${Ly}px`,e.style.height=`${Ly}px`,e.style.position="absolute",e.style.top=`${i2}px`,e.style.left=`${s2}px`,e.style.zIndex=o2.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const r=e.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const e=performance.now();if(Yr.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,u=i/o*l,c=s/a*l;let h=this.div;h.style.left=`${r}px`,h.style.top=`${n}px`,h.style.width=`${o}px`,h.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const m=this.children[d];if(m.renderId!==this.renderId)m._accessibleActive=!1,Ts(this.children,d,1),this.div.removeChild(m._accessibleDiv),this.pool.push(m._accessibleDiv),m._accessibleDiv=null,d--;else{h=m._accessibleDiv;let g=m.hitArea;const x=m.worldTransform;m.hitArea?(h.style.left=`${(x.tx+g.x*x.a)*u}px`,h.style.top=`${(x.ty+g.y*x.d)*c}px`,h.style.width=`${g.width*x.a*u}px`,h.style.height=`${g.height*x.d*c}px`):(g=m.getBounds(),this.capHitArea(g),h.style.left=`${g.x*u}px`,h.style.top=`${g.y*c}px`,h.style.width=`${g.width*u}px`,h.style.height=`${g.height*c}px`,h.title!==m.accessibleTitle&&m.accessibleTitle!==null&&(h.title=m.accessibleTitle),h.getAttribute("aria-label")!==m.accessibleHint&&m.accessibleHint!==null&&h.setAttribute("aria-label",m.accessibleHint)),(m.accessibleTitle!==h.title||m.tabIndex!==h.tabIndex)&&(h.title=m.accessibleTitle,h.tabIndex=m.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:r,height:n}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${Qa}px`,r.style.height=`${Qa}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=Dy.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){const{displayObject:n}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new ga(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===t2&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}p1.extension={name:"accessibility",type:[V.RendererPlugin,V.CanvasRendererPlugin]};q.add(p1);const m1=class ff{constructor(e){this.stage=new Bt,e=Object.assign({forceCanvas:!1},e),this.renderer=gI(e),ff._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,r){const n=ff._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};m1._plugins=[];let g1=m1;q.handleByList(V.Application,g1._plugins);class y1{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;r=i,n=s}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}y1.extension=V.Application;q.add(y1);const Oy={loader:V.LoadParser,resolver:V.ResolveParser,cache:V.CacheParser,detection:V.DetectionParser};q.handle(V.Asset,t=>{const e=t.ref;Object.entries(Oy).filter(([r])=>!!e[r]).forEach(([r,n])=>q.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(Oy).filter(r=>!!e[r]).forEach(r=>q.remove(e[r]))});class a2{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Hs(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function qn(t,e){const r=t.split("?")[0],n=it.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const hr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t),pf=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t};function v1(t,e,r,n,i){const s=e[r];for(let o=0;o<s.length;o++){const a=s[o];r<e.length-1?v1(t.replace(n[r],a),e,r+1,n,i):i.push(t.replace(n[r],a))}}function l2(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const i=[];r.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),v1(t,i,0,r,n)}else n.push(t);return n}const xu=t=>!Array.isArray(t);class u2{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=hr(e);let i;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(r)){i=l.getCacheableAssets(n,r);break}}i||(i={},n.forEach(a=>{i[a]=r}));const s=Object.keys(i),o={cacheKeys:s,keys:n};if(n.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{const l=i?i[a]:r;this._cache.has(a)&&this._cache.get(a)!==l&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),r instanceof K){const a=r;n.forEach(l=>{a.baseTexture!==K.EMPTY.baseTexture&&ae.addToCache(a.baseTexture,l),K.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const ui=new u2;class c2{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{var o,a;let i=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.load&&((o=u.test)!=null&&o.call(u,e,r,this))){s=u;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,r,this),n.parser=s;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,i,r,this))&&(i=await u.parse(i,r,this)||i,n.parser=u)}return i})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const i={},s=xu(e),o=hr(e,u=>({alias:[u],src:u})),a=o.length,l=o.map(async u=>{const c=it.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,u)),i[u.src]=await this.promiseCache[c].promise,r&&r(++n/a)}catch(h){throw delete this.promiseCache[c],delete i[u.src],new Error(`[Loader.load] Failed to load ${c}.
${h}`)}});return await Promise.all(l),s?i[o[0].src]:i}async unload(e){const r=hr(e,n=>({alias:[n],src:n})).map(async n=>{var o,a;const i=it.toAbsolute(n.src),s=this.promiseCache[i];if(s){const l=await s.promise;delete this.promiseCache[i],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,n,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(e[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...e,[r.name]:r}),{})}}var yr=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(yr||{});const h2=".json",d2="application/json",f2={extension:{type:V.LoadParser,priority:yr.Low},name:"loadJson",test(t){return Hs(t,d2)||qn(t,h2)},async load(t){return await(await H.ADAPTER.fetch(t)).json()}};q.add(f2);const p2=".txt",m2="text/plain",g2={name:"loadTxt",extension:{type:V.LoadParser,priority:yr.Low},test(t){return Hs(t,m2)||qn(t,p2)},async load(t){return await(await H.ADAPTER.fetch(t)).text()}};q.add(g2);const y2=["normal","bold","100","200","300","400","500","600","700","800","900"],v2=[".ttf",".otf",".woff",".woff2"],x2=["font/ttf","font/otf","font/woff","font/woff2"],_2=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function w2(t){const e=it.extname(t),r=it.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let n=r.length>0;for(const s of r)if(!s.match(_2)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const S2=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function E2(t){return S2.test(t)?t:encodeURI(t)}const b2={extension:{type:V.LoadParser,priority:yr.Low},name:"loadWebFont",test(t){return Hs(t,x2)||qn(t,v2)},async load(t,e){var n,i,s;const r=H.ADAPTER.getFontFaceSet();if(r){const o=[],a=((n=e.data)==null?void 0:n.family)??w2(t),l=((s=(i=e.data)==null?void 0:i.weights)==null?void 0:s.filter(c=>y2.includes(c)))??["normal"],u=e.data??{};for(let c=0;c<l.length;c++){const h=l[c],d=new FontFace(a,`url(${E2(t)})`,{...u,weight:h});await d.load(),r.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>H.ADAPTER.getFontFaceSet().delete(e))}};q.add(b2);const T2=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Rs=null,mf=class{constructor(){Rs||(Rs=URL.createObjectURL(new Blob([T2],{type:"application/javascript"}))),this.worker=new Worker(Rs)}};mf.revokeObjectURL=function(){Rs&&(URL.revokeObjectURL(Rs),Rs=null)};const A2=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Ps=null;class x1{constructor(){Ps||(Ps=URL.createObjectURL(new Blob([A2],{type:"application/javascript"}))),this.worker=new Worker(Ps)}}x1.revokeObjectURL=function(){Ps&&(URL.revokeObjectURL(Ps),Ps=null)};let Uy=0,xh;class C2{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new mf;r.addEventListener("message",n=>{r.terminate(),mf.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){xh===void 0&&(xh=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<xh&&(this._createdWorkers++,e=new x1().worker,e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((i,s)=>{this.queue.push({id:e,arguments:r,resolve:i,reject:s})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const r=this.queue.pop(),n=r.id;this.resolveHash[Uy]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:Uy++,id:n})}}const jy=new C2;function ya(t,e,r){t.resource.internal=!0;const n=new K(t),i=()=>{delete e.promiseCache[r],ui.has(r)&&ui.remove(r)};return n.baseTexture.once("destroyed",()=>{r in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),n.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const R2=[".jpeg",".jpg",".png",".webp",".avif"],P2=["image/jpeg","image/png","image/webp","image/avif"];async function I2(t){const e=await H.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}const Ju={name:"loadTextures",extension:{type:V.LoadParser,priority:yr.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Hs(t,P2)||qn(t,R2)},async load(t,e,r){var a;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;n?this.config.preferWorkers&&await jy.isImageBitmapSupported()?i=await jy.loadImageBitmap(t):i=await I2(t):i=await new Promise((l,u)=>{const c=new Image;c.crossOrigin=this.config.crossOrigin,c.src=t,c.complete?l(c):(c.onload=()=>l(c),c.onerror=h=>u(h))});const s={...e.data};s.resolution??(s.resolution=nn(t)),n&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new ae(i,s);return o.resource.src=t,ya(o,r,t)},unload(t){t.destroy(!0)}};q.add(Ju);const k2=".svg",M2="image/svg+xml",B2={extension:{type:V.LoadParser,priority:yr.High},name:"loadSVG",test(t){return Hs(t,M2)||qn(t,k2)},async testParse(t){return nf.test(t)},async parse(t,e,r){var s;const n=new nf(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await n.load();const i=new ae(n,{resolution:nn(t),...e==null?void 0:e.data});return i.resource.src=e.src,ya(i,r,e.src)},async load(t,e){return(await H.ADAPTER.fetch(t)).text()},unload:Ju.unload};q.add(B2);const N2=[".mp4",".m4v",".webm",".ogv"],F2=["video/mp4","video/webm","video/ogg"],D2={name:"loadVideo",extension:{type:V.LoadParser,priority:yr.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return Hs(t,F2)||qn(t,N2)},async load(t,e,r){var o;let n;const i=await(await H.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},l=new h1(s,a);await l.load();const u=new ae(l,{alphaMode:await zR(),resolution:nn(t),...e==null?void 0:e.data});u.resource.src=t,n=ya(u,r,t),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return n},unload(t){t.destroy(!0)}};q.add(D2);class L2{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,name:n,src:i,srcs:s}=e;return hr(r||n||i||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];Array.isArray(r)?r.forEach(i=>{const s=i.src??i.srcs,o=i.alias??i.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);n.push(l),a=[o,l]}else{const l=o.map(u=>this._createBundleAssetId(e,u));n.push(...l),a=[...o,...l]}this.add({...i,alias:a,src:s})}):Object.keys(r).forEach(i=>{const s=[i,this._createBundleAssetId(e,i)];if(typeof r[i]=="string")this.add({alias:s,src:r[i]});else if(Array.isArray(r[i]))this.add({alias:s,src:r[i]});else{const o=r[i],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}n.push(...s)}),this._bundles[e]=n}add(e,r,n,i,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(pe("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:r,data:n,format:i,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},hr(o).forEach(l=>{const{src:u,srcs:c}=l;let{data:h,format:d,loadParser:m}=l;const g=hr(u||c).map(y=>typeof y=="string"?l2(y):Array.isArray(y)?y:[y]),x=this.getAlias(l);Array.isArray(x)?x.forEach(a):a(x);const w=[];g.forEach(y=>{y.forEach(v=>{let p={};if(typeof v!="object"){p.src=v;for(let _=0;_<this._parsers.length;_++){const S=this._parsers[_];if(S.test(v)){p=S.parse(v);break}}}else h=v.data??h,d=v.format??d,m=v.loadParser??m,p={...p,...v};if(!x)throw new Error(`[Resolver] alias is undefined for this asset: ${p.src}`);p=this.buildResolvedAsset(p,{aliases:x,data:h,format:d,loadParser:m}),w.push(p)})}),x.forEach(y=>{this._assetMap[y]=w})})}resolveBundle(e){const r=xu(e);e=hr(e);const n={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(i,l)]=u}n[i]=a}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const i in r)n[i]=r[i].src;return n}return r.src}resolve(e){const r=xu(e);e=hr(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(u=>{const c=s.filter(h=>h[l]?h[l]===u:!1);c.length&&(s=c)})}),this._resolverHash[i]=s[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}buildResolvedAsset(e,r){const{aliases:n,data:i,loadParser:s,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=it.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??it.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class O2{constructor(){this._detections=[],this._initialized=!1,this.resolver=new L2,this.loader=new c2,this.cache=ui,this._backgroundLoader=new a2(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const r=((s=e.texturePreference)==null?void 0:s.resolution)??1,n=typeof r=="number"?[r]:r,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e,r,n,i,s){this.resolver.add(e,r,n,i,s)}async load(e,r){this._initialized||await this.init();const n=xu(e),i=hr(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,r);return n?o[i[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,l=0;const u=()=>{r==null||r(++a/l)},c=o.map(h=>{const d=i[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,u).then(m=>{s[h]=m})});return await Promise.all(c),n?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return ui.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=ui.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const o={};return n.forEach((a,l)=>{const u=s[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[i[l]]=u,ui.set(c,u)}),o}async unload(e){this._initialized||await this.init();const r=hr(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=hr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{ui.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,i)=>r.indexOf(n)===i),r}get detections(){return this._detections}get preferWorkers(){return Ju.config.preferWorkers}set preferWorkers(e){pe("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const go=new O2;q.handleByList(V.LoadParser,go.loader.parsers).handleByList(V.ResolveParser,go.resolver.parsers).handleByList(V.CacheParser,go.cache.parsers).handleByList(V.DetectionParser,go.detections);const U2={extension:V.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof K),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((i,s)=>{r[n+(s===0?"":s+1)]=i})}),r}};q.add(U2);async function _1(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const j2={extension:{type:V.DetectionParser,priority:1},test:async()=>_1("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};q.add(j2);const G2={extension:{type:V.DetectionParser,priority:0},test:async()=>_1("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};q.add(G2);const Gy=["png","jpg","jpeg"],z2={extension:{type:V.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...Gy],remove:async t=>t.filter(e=>!Gy.includes(e))};q.add(z2);const V2="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Dp(t){return V2?!1:document.createElement("video").canPlayType(t)!==""}const $2={extension:{type:V.DetectionParser,priority:0},test:async()=>Dp("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};q.add($2);const H2={extension:{type:V.DetectionParser,priority:0},test:async()=>Dp("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};q.add(H2);const W2={extension:{type:V.DetectionParser,priority:0},test:async()=>Dp("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};q.add(W2);const X2={extension:V.ResolveParser,test:Ju.test,parse:t=>{var e;return{resolution:parseFloat(((e=H.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:it.extname(t).slice(1),src:t}}};q.add(X2);var st=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(st||{});const _u={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Er,Ji;function zy(){Ji={bptc:Er.getExtension("EXT_texture_compression_bptc"),astc:Er.getExtension("WEBGL_compressed_texture_astc"),etc:Er.getExtension("WEBGL_compressed_texture_etc"),s3tc:Er.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Er.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Er.getExtension("WEBGL_compressed_texture_pvrtc")||Er.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Er.getExtension("WEBGL_compressed_texture_etc1"),atc:Er.getExtension("WEBGL_compressed_texture_atc")}}const Y2={extension:{type:V.DetectionParser,priority:2},test:async()=>{const t=H.ADAPTER.createCanvas().getContext("webgl");return t?(Er=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{Ji||zy();const e=[];for(const r in Ji)Ji[r]&&e.push(r);return[...e,...t]},remove:async t=>(Ji||zy(),t.filter(e=>!(e in Ji)))};q.add(Y2);class K2 extends Yu{constructor(e,r={width:1,height:1,autoLoad:!0}){let n,i;typeof e=="string"?(n=e,i=new Uint8Array):(n=null,i=e),super(i,r),this.origin=n,this.buffer=i?new $d(i):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new $d(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class yi extends K2{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=yi._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||yi._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,n){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:u,levelBuffer:c}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,l,u,0,c)}return!0}onBlobLoaded(){this._levelBuffers=yi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,r,n,i,s,o,a){const l=new Array(n);let u=e.byteOffset,c=o,h=a,d=c+i-1&~(i-1),m=h+s-1&~(s-1),g=d*m*_u[r];for(let x=0;x<n;x++)l[x]={levelID:x,levelWidth:n>1?c:d,levelHeight:n>1?h:m,levelBuffer:new Uint8Array(e.buffer,u,g)},u+=g,c=c>>1||1,h=h>>1||1,d=c+i-1&~(i-1),m=h+s-1&~(s-1),g=d*m*_u[r];return l}}const _h=4,Ja=124,q2=32,Vy=20,Z2=542327876,el={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Q2={FOURCC:2},tl={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},J2=1,ek=2,tk=4,rk=64,nk=512,ik=131072,sk=827611204,ok=861165636,ak=894720068,lk=808540228,uk=4,ck={[sk]:st.COMPRESSED_RGBA_S3TC_DXT1_EXT,[ok]:st.COMPRESSED_RGBA_S3TC_DXT3_EXT,[ak]:st.COMPRESSED_RGBA_S3TC_DXT5_EXT},hk={70:st.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:st.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:st.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:st.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:st.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:st.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:st.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:st.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:st.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:st.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:st.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:st.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:st.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function dk(t){const e=new Uint32Array(t);if(e[0]!==Z2)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,Ja/Uint32Array.BYTES_PER_ELEMENT),n=r[el.HEIGHT],i=r[el.WIDTH],s=r[el.MIPMAP_COUNT],o=new Uint32Array(t,el.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,q2/Uint32Array.BYTES_PER_ELEMENT),a=o[J2];if(a&tk){const l=o[Q2.FOURCC];if(l!==lk){const v=ck[l],p=_h+Ja,_=new Uint8Array(t,p);return[new yi(_,{format:v,width:i,height:n,levels:s})]}const u=_h+Ja,c=new Uint32Array(e.buffer,u,Vy/Uint32Array.BYTES_PER_ELEMENT),h=c[tl.DXGI_FORMAT],d=c[tl.RESOURCE_DIMENSION],m=c[tl.MISC_FLAG],g=c[tl.ARRAY_SIZE],x=hk[h];if(x===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(m===uk)throw new Error("DDSParser does not support cubemap textures");if(d===6)throw new Error("DDSParser does not supported 3D texture data");const w=new Array,y=_h+Ja+Vy;if(g===1)w.push(new Uint8Array(t,y));else{const v=_u[x];let p=0,_=i,S=n;for(let A=0;A<s;A++){const T=Math.max(1,_+3&-4),M=Math.max(1,S+3&-4),I=T*M*v;p+=I,_=_>>>1,S=S>>>1}let b=y;for(let A=0;A<g;A++)w.push(new Uint8Array(t,b,p)),b+=p}return w.map(v=>new yi(v,{format:x,width:i,height:n,levels:s}))}throw a&rk?new Error("DDSParser does not support uncompressed texture data."):a&nk?new Error("DDSParser does not supported YUV uncompressed texture data."):a&ik?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&ek?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const $y=[171,75,84,88,32,49,49,187,13,10,26,10],fk=67305985,ir={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},gf=64,Hy={[J.UNSIGNED_BYTE]:1,[J.UNSIGNED_SHORT]:2,[J.INT]:4,[J.UNSIGNED_INT]:4,[J.FLOAT]:4,[J.HALF_FLOAT]:8},pk={[j.RGBA]:4,[j.RGB]:3,[j.RG]:2,[j.RED]:1,[j.LUMINANCE]:1,[j.LUMINANCE_ALPHA]:2,[j.ALPHA]:1},mk={[J.UNSIGNED_SHORT_4_4_4_4]:2,[J.UNSIGNED_SHORT_5_5_5_1]:2,[J.UNSIGNED_SHORT_5_6_5]:2};function gk(t,e,r=!1){const n=new DataView(e);if(!yk(t,n))return null;const i=n.getUint32(ir.ENDIANNESS,!0)===fk,s=n.getUint32(ir.GL_TYPE,i),o=n.getUint32(ir.GL_FORMAT,i),a=n.getUint32(ir.GL_INTERNAL_FORMAT,i),l=n.getUint32(ir.PIXEL_WIDTH,i),u=n.getUint32(ir.PIXEL_HEIGHT,i)||1,c=n.getUint32(ir.PIXEL_DEPTH,i)||1,h=n.getUint32(ir.NUMBER_OF_ARRAY_ELEMENTS,i)||1,d=n.getUint32(ir.NUMBER_OF_FACES,i),m=n.getUint32(ir.NUMBER_OF_MIPMAP_LEVELS,i),g=n.getUint32(ir.BYTES_OF_KEY_VALUE_DATA,i);if(u===0||c!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");const x=4,w=4,y=l+3&-4,v=u+3&-4,p=new Array(h);let _=l*u;s===0&&(_=y*v);let S;if(s!==0?Hy[s]?S=Hy[s]*pk[o]:S=mk[s]:S=_u[a],S===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const b=r?xk(n,g,i):null;let A=_*S,T=l,M=u,I=y,W=v,G=gf+g;for(let C=0;C<m;C++){const N=n.getUint32(G,i);let z=G+4;for(let B=0;B<h;B++){let k=p[B];k||(k=p[B]=new Array(m)),k[C]={levelID:C,levelWidth:m>1||s!==0?T:I,levelHeight:m>1||s!==0?M:W,levelBuffer:new Uint8Array(e,z,A)},z+=A}G+=N+4,G=G%4!==0?G+4-G%4:G,T=T>>1||1,M=M>>1||1,I=T+x-1&-4,W=M+w-1&-4,A=I*W*S}return s!==0?{uncompressed:p.map(C=>{let N=C[0].levelBuffer,z=!1;return s===J.FLOAT?N=new Float32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4):s===J.UNSIGNED_INT?(z=!0,N=new Uint32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4)):s===J.INT&&(z=!0,N=new Int32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4)),{resource:new Yu(N,{width:C[0].levelWidth,height:C[0].levelHeight}),type:s,format:z?vk(o):o}}),kvData:b}:{compressed:p.map(C=>new yi(null,{format:a,width:l,height:u,levels:m,levelBuffers:C})),kvData:b}}function yk(t,e){for(let r=0;r<$y.length;r++)if(e.getUint8(r)!==$y[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function vk(t){switch(t){case j.RGBA:return j.RGBA_INTEGER;case j.RGB:return j.RGB_INTEGER;case j.RG:return j.RG_INTEGER;case j.RED:return j.RED_INTEGER;default:return t}}function xk(t,e,r){const n=new Map;let i=0;for(;i<e;){const s=t.getUint32(gf+i,r),o=gf+i+4,a=3-(s+3)%4;if(s===0||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&t.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(t.buffer,o,l)),c=new DataView(t.buffer,o+l+1,s-l-1);n.set(u,c),i+=4+s+a}return n}const _k={extension:{type:V.LoadParser,priority:yr.High},name:"loadDDS",test(t){return qn(t,".dds")},async load(t,e,r){const n=await(await H.ADAPTER.fetch(t)).arrayBuffer(),i=dk(n).map(s=>{const o=new ae(s,{mipmap:Dr.OFF,alphaMode:Rt.NO_PREMULTIPLIED_ALPHA,resolution:nn(t),...e.data});return ya(o,r,t)});return i.length===1?i[0]:i},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};q.add(_k);const wk={extension:{type:V.LoadParser,priority:yr.High},name:"loadKTX",test(t){return qn(t,".ktx")},async load(t,e,r){const n=await(await H.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=gk(t,n),a=i??s,l={mipmap:Dr.OFF,alphaMode:Rt.NO_PREMULTIPLIED_ALPHA,resolution:nn(t),...e.data},u=a.map(c=>{a===s&&Object.assign(l,{type:c.type,format:c.format});const h=c.resource??c,d=new ae(h,l);return d.ktxKeyValueData=o,ya(d,r,t)});return u.length===1?u[0]:u},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};q.add(wk);const Sk=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],Ek={extension:V.ResolveParser,test:t=>{const e=it.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var n,i;const e=t.split("."),r=e.pop();if(["ktx","dds"].includes(r)){const s=e.pop();if(Sk.includes(s))return{resolution:parseFloat(((n=H.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:s,src:t}}return{resolution:parseFloat(((i=H.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:r,src:t}}};q.add(Ek);const rl=new ce,bk=4,w1=class yo{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,r,n,i){const s=new Image;return s.src=await this.base64(e,r,n,i),s}async base64(e,r,n,i){const s=this.canvas(e,i);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>o(u.result),u.onerror=a,u.readAsDataURL(l)},r,n)});if(s.toDataURL!==void 0)return s.toDataURL(r,n);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:r,quality:n});return new Promise((a,l)=>{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=l,u.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);o&&yo._flipY(n,i,s),a&&yo._unpremultiplyAlpha(n);const l=new iP(i,s,1),u=new ImageData(new Uint8ClampedArray(n.buffer),i,s);return l.context.putImageData(u,0,0),l.canvas}pixels(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);return o&&yo._flipY(n,i,s),a&&yo._unpremultiplyAlpha(n),n}_rawPixels(e,r){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let i,s=!1,o=!1,a,l=!1;e&&(e instanceof Bi?a=e:(a=n.generateTexture(e,{region:r,resolution:n.resolution,multisample:n.multisample}),l=!0,r&&(rl.width=r.width,rl.height=r.height,r=rl)));const u=n.gl;if(a){if(i=a.baseTexture.resolution,r=r??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===j.RGBA,!l){n.renderTexture.bind(a);const m=a.framebuffer.glFramebuffers[n.CONTEXT_UID];m.blitFramebuffer&&n.framebuffer.bind(m.blitFramebuffer)}}else i=n.resolution,r||(r=rl,r.width=n.width/i,r.height=n.height/i),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const c=Math.max(Math.round(r.width*i),1),h=Math.max(Math.round(r.height*i),1),d=new Uint8Array(bk*c*h);return u.readPixels(Math.round(r.x*i),Math.round(r.y*i),c,h,u.RGBA,u.UNSIGNED_BYTE,d),l&&(a==null||a.destroy(!0)),{pixels:d,width:c,height:h,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,r,n){const i=r<<2,s=n>>1,o=new Uint8Array(i);for(let a=0;a<s;a++){const l=a*i,u=(n-a-1)*i;o.set(e.subarray(l,l+i)),e.copyWithin(l,u,u+i),e.set(o,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const r=e.length;for(let n=0;n<r;n+=4){const i=e[n+3];if(i!==0){const s=255.001/i;e[n]=e[n]*s+.5,e[n+1]=e[n+1]*s+.5,e[n+2]=e[n+2]*s+.5}}}};w1.extension={name:"extract",type:V.RendererSystem};let Tk=w1;q.add(Tk);const wu={build(t){const e=t.points;let r,n,i,s,o,a;if(t.type===at.CIRC){const g=t.shape;r=g.x,n=g.y,o=a=g.radius,i=s=0}else if(t.type===at.ELIP){const g=t.shape;r=g.x,n=g.y,o=g.width,a=g.height,i=s=0}else{const g=t.shape,x=g.width/2,w=g.height/2;r=g.x+x,n=g.y+w,o=a=Math.max(0,Math.min(g.radius,Math.min(x,w))),i=x-o,s=w-a}if(!(o>=0&&a>=0&&i>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(i?4:0)+(s?4:0);if(e.length=u,u===0)return;if(l===0){e.length=8,e[0]=e[6]=r+i,e[1]=e[3]=n+s,e[2]=e[4]=r-i,e[5]=e[7]=n-s;return}let c=0,h=l*4+(i?2:0)+2,d=h,m=u;{const g=i+o,x=s,w=r+g,y=r-g,v=n+x;if(e[c++]=w,e[c++]=v,e[--h]=v,e[--h]=y,s){const p=n-x;e[d++]=y,e[d++]=p,e[--m]=p,e[--m]=w}}for(let g=1;g<l;g++){const x=Math.PI/2*(g/l),w=i+Math.cos(x)*o,y=s+Math.sin(x)*a,v=r+w,p=r-w,_=n+y,S=n-y;e[c++]=v,e[c++]=_,e[--h]=_,e[--h]=p,e[d++]=p,e[d++]=S,e[--m]=S,e[--m]=v}{const g=i,x=s+a,w=r+g,y=r-g,v=n+x,p=n-x;e[c++]=w,e[c++]=v,e[--m]=p,e[--m]=w,i&&(e[c++]=y,e[c++]=v,e[--m]=p,e[--m]=y)}},triangulate(t,e){const r=t.points,n=e.points,i=e.indices;if(r.length===0)return;let s=n.length/2;const o=s;let a,l;if(t.type!==at.RREC){const c=t.shape;a=c.x,l=c.y}else{const c=t.shape;a=c.x+c.width/2,l=c.y+c.height/2}const u=t.matrix;n.push(t.matrix?u.a*a+u.c*l+u.tx:a,t.matrix?u.b*a+u.d*l+u.ty:l),s++,n.push(r[0],r[1]);for(let c=2;c<r.length;c+=2)n.push(r[c],r[c+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function Wy(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let i=0,s=t[r-2],o=t[r-1];i<r;i+=2){const a=t[i],l=t[i+1];n+=(a-s)*(l+o),s=a,o=l}if(!e&&n>0||e&&n<=0){const i=r/2;for(let s=i+i%2;s<r;s+=2){const o=r-s-2,a=r-s-1,l=s,u=s+1;[t[o],t[l]]=[t[l],t[o]],[t[a],t[u]]=[t[u],t[a]]}}}const S1={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const n=t.holes,i=e.points,s=e.indices;if(r.length>=6){Wy(r,!1);const o=[];for(let u=0;u<n.length;u++){const c=n[u];Wy(c.points,!0),o.push(r.length/2),r=r.concat(c.points)}const a=CT(r,o,2);if(!a)return;const l=i.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+l),s.push(a[u+1]+l),s.push(a[u+2]+l);for(let u=0;u<r.length;u++)i.push(r[u])}}},Ak={build(t){const e=t.shape,r=e.x,n=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(r,n,r+i,n,r+i,n+s,r,n+s)},triangulate(t,e){const r=t.points,n=e.points;if(r.length===0)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Ck={build(t){wu.build(t)},triangulate(t,e){wu.triangulate(t,e)}};var $t=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))($t||{}),In=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(In||{});const Us={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class Xy{static curveTo(e,r,n,i,s,o){const a=o[o.length-2],l=o[o.length-1]-r,u=a-e,c=i-r,h=n-e,d=Math.abs(l*h-u*c);if(d<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==r)&&o.push(e,r),null;const m=l*l+u*u,g=c*c+h*h,x=l*c+u*h,w=s*Math.sqrt(m)/d,y=s*Math.sqrt(g)/d,v=w*x/m,p=y*x/g,_=w*h+y*u,S=w*c+y*l,b=u*(y+v),A=l*(y+v),T=h*(w+p),M=c*(w+p),I=Math.atan2(A-S,b-_),W=Math.atan2(M-S,T-_);return{cx:_+e,cy:S+r,radius:s,startAngle:I,endAngle:W,anticlockwise:u*c>h*l}}static arc(e,r,n,i,s,o,a,l,u){const c=a-o,h=Us._segmentsCount(Math.abs(c)*s,Math.ceil(Math.abs(c)/du)*40),d=c/(h*2),m=d*2,g=Math.cos(d),x=Math.sin(d),w=h-1,y=w%1/w;for(let v=0;v<=w;++v){const p=v+y*v,_=d+o+m*p,S=Math.cos(_),b=-Math.sin(_);u.push((g*S+x*b)*s+n,(g*-b+x*S)*s+i)}}}class Rk{constructor(){this.reset()}begin(e,r,n){this.reset(),this.style=e,this.start=r,this.attribStart=n}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Lp{static curveLength(e,r,n,i,s,o,a,l){let u=0,c=0,h=0,d=0,m=0,g=0,x=0,w=0,y=0,v=0,p=0,_=e,S=r;for(let b=1;b<=10;++b)c=b/10,h=c*c,d=h*c,m=1-c,g=m*m,x=g*m,w=x*e+3*g*c*n+3*m*h*s+d*a,y=x*r+3*g*c*i+3*m*h*o+d*l,v=_-w,p=S-y,_=w,S=y,u+=Math.sqrt(v*v+p*p);return u}static curveTo(e,r,n,i,s,o,a){const l=a[a.length-2],u=a[a.length-1];a.length-=2;const c=Us._segmentsCount(Lp.curveLength(l,u,e,r,n,i,s,o));let h=0,d=0,m=0,g=0,x=0;a.push(l,u);for(let w=1,y=0;w<=c;++w)y=w/c,h=1-y,d=h*h,m=d*h,g=y*y,x=g*y,a.push(m*l+3*d*y*e+3*h*g*n+x*s,m*u+3*d*y*r+3*h*g*i+x*o)}}function Yy(t,e,r,n,i,s,o,a){const l=t-r*i,u=e-n*i,c=t+r*s,h=e+n*s;let d,m;o?(d=n,m=-r):(d=-n,m=r);const g=l+d,x=u+m,w=c+d,y=h+m;return a.push(g,x,w,y),2}function Jn(t,e,r,n,i,s,o,a){const l=r-t,u=n-e;let c=Math.atan2(l,u),h=Math.atan2(i-t,s-e);a&&c<h?c+=Math.PI*2:!a&&c>h&&(h+=Math.PI*2);let d=c;const m=h-c,g=Math.abs(m),x=Math.sqrt(l*l+u*u),w=(15*g*Math.sqrt(x)/Math.PI>>0)+1,y=m/w;if(d+=y,a){o.push(t,e,r,n);for(let v=1,p=d;v<w;v++,p+=y)o.push(t,e,t+Math.sin(p)*x,e+Math.cos(p)*x);o.push(t,e,i,s)}else{o.push(r,n,t,e);for(let v=1,p=d;v<w;v++,p+=y)o.push(t+Math.sin(p)*x,e+Math.cos(p)*x,t,e);o.push(i,s,t,e)}return w*2}function Pk(t,e){const r=t.shape;let n=t.points||r.points.slice();const i=e.closePointEps;if(n.length===0)return;const s=t.lineStyle,o=new ye(n[0],n[1]),a=new ye(n[n.length-2],n[n.length-1]),l=r.type!==at.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){n=n.slice(),u&&(n.pop(),n.pop(),a.set(n[n.length-2],n[n.length-1]));const k=(o.x+a.x)*.5,P=(a.y+o.y)*.5;n.unshift(k,P),n.push(k,P)}const c=e.points,h=n.length/2;let d=n.length;const m=c.length/2,g=s.width/2,x=g*g,w=s.miterLimit*s.miterLimit;let y=n[0],v=n[1],p=n[2],_=n[3],S=0,b=0,A=-(v-_),T=y-p,M=0,I=0,W=Math.sqrt(A*A+T*T);A/=W,T/=W,A*=g,T*=g;const G=s.alignment,C=(1-G)*2,N=G*2;l||(s.cap===In.ROUND?d+=Jn(y-A*(C-N)*.5,v-T*(C-N)*.5,y-A*C,v-T*C,y+A*N,v+T*N,c,!0)+2:s.cap===In.SQUARE&&(d+=Yy(y,v,A,T,C,N,!0,c))),c.push(y-A*C,v-T*C,y+A*N,v+T*N);for(let k=1;k<h-1;++k){y=n[(k-1)*2],v=n[(k-1)*2+1],p=n[k*2],_=n[k*2+1],S=n[(k+1)*2],b=n[(k+1)*2+1],A=-(v-_),T=y-p,W=Math.sqrt(A*A+T*T),A/=W,T/=W,A*=g,T*=g,M=-(_-b),I=p-S,W=Math.sqrt(M*M+I*I),M/=W,I/=W,M*=g,I*=g;const P=p-y,D=v-_,R=p-S,F=b-_,Z=P*R+D*F,he=D*R-F*P,ue=he<0;if(Math.abs(he)<.001*Math.abs(Z)){c.push(p-A*C,_-T*C,p+A*N,_+T*N),Z>=0&&(s.join===$t.ROUND?d+=Jn(p,_,p-A*C,_-T*C,p-M*C,_-I*C,c,!1)+4:d+=2,c.push(p-M*N,_-I*N,p+M*C,_+I*C));continue}const _e=(-A+y)*(-T+_)-(-A+p)*(-T+v),xe=(-M+S)*(-I+_)-(-M+p)*(-I+b),Re=(P*xe-R*_e)/he,Je=(F*_e-D*xe)/he,yt=(Re-p)*(Re-p)+(Je-_)*(Je-_),Be=p+(Re-p)*C,Te=_+(Je-_)*C,Ae=p-(Re-p)*N,Ee=_-(Je-_)*N,ct=Math.min(P*P+D*D,R*R+F*F),vt=ue?C:N,vr=ct+vt*vt*x,Ni=yt<=vr;let an=s.join;if(an===$t.MITER&&yt/x>w&&(an=$t.BEVEL),Ni)switch(an){case $t.MITER:{c.push(Be,Te,Ae,Ee);break}case $t.BEVEL:{ue?c.push(Be,Te,p+A*N,_+T*N,Be,Te,p+M*N,_+I*N):c.push(p-A*C,_-T*C,Ae,Ee,p-M*C,_-I*C,Ae,Ee),d+=2;break}case $t.ROUND:{ue?(c.push(Be,Te,p+A*N,_+T*N),d+=Jn(p,_,p+A*N,_+T*N,p+M*N,_+I*N,c,!0)+4,c.push(Be,Te,p+M*N,_+I*N)):(c.push(p-A*C,_-T*C,Ae,Ee),d+=Jn(p,_,p-A*C,_-T*C,p-M*C,_-I*C,c,!1)+4,c.push(p-M*C,_-I*C,Ae,Ee));break}}else{switch(c.push(p-A*C,_-T*C,p+A*N,_+T*N),an){case $t.MITER:{ue?c.push(Ae,Ee,Ae,Ee):c.push(Be,Te,Be,Te),d+=2;break}case $t.ROUND:{ue?d+=Jn(p,_,p+A*N,_+T*N,p+M*N,_+I*N,c,!0)+2:d+=Jn(p,_,p-A*C,_-T*C,p-M*C,_-I*C,c,!1)+2;break}}c.push(p-M*C,_-I*C,p+M*N,_+I*N),d+=2}}y=n[(h-2)*2],v=n[(h-2)*2+1],p=n[(h-1)*2],_=n[(h-1)*2+1],A=-(v-_),T=y-p,W=Math.sqrt(A*A+T*T),A/=W,T/=W,A*=g,T*=g,c.push(p-A*C,_-T*C,p+A*N,_+T*N),l||(s.cap===In.ROUND?d+=Jn(p-A*(C-N)*.5,_-T*(C-N)*.5,p-A*C,_-T*C,p+A*N,_+T*N,c,!1)+2:s.cap===In.SQUARE&&(d+=Yy(p,_,A,T,C,N,!1,c)));const z=e.indices,B=Us.epsilon*Us.epsilon;for(let k=m;k<d+m-2;++k)y=c[k*2],v=c[k*2+1],p=c[(k+1)*2],_=c[(k+1)*2+1],S=c[(k+2)*2],b=c[(k+2)*2+1],!(Math.abs(y*(_-b)+p*(b-v)+S*(v-_))<B)&&z.push(k,k+1,k+2)}function Ik(t,e){let r=0;const n=t.shape,i=t.points||n.points,s=n.type!==at.POLY||n.closeStroke;if(i.length===0)return;const o=e.points,a=e.indices,l=i.length/2,u=o.length/2;let c=u;for(o.push(i[0],i[1]),r=1;r<l;r++)o.push(i[r*2],i[r*2+1]),a.push(c,c+1),c++;s&&a.push(c,u)}function Ky(t,e){t.lineStyle.native?Ik(t,e):Pk(t,e)}class Op{static curveLength(e,r,n,i,s,o){const a=e-2*n+s,l=r-2*i+o,u=2*n-2*e,c=2*i-2*r,h=4*(a*a+l*l),d=4*(a*u+l*c),m=u*u+c*c,g=2*Math.sqrt(h+d+m),x=Math.sqrt(h),w=2*h*x,y=2*Math.sqrt(m),v=d/x;return(w*g+x*d*(g-y)+(4*m*h-d*d)*Math.log((2*x+v+g)/(v+y)))/(4*w)}static curveTo(e,r,n,i,s){const o=s[s.length-2],a=s[s.length-1],l=Us._segmentsCount(Op.curveLength(o,a,e,r,n,i));let u=0,c=0;for(let h=1;h<=l;++h){const d=h/l;u=o+(e-o)*d,c=a+(r-a)*d,s.push(u+(e+(n-e)*d-u)*d,c+(r+(i-r)*d-c)*d)}}}const wh={[at.POLY]:S1,[at.CIRC]:wu,[at.ELIP]:wu,[at.RECT]:Ak,[at.RREC]:Ck},qy=[],nl=[];class Su{constructor(e,r=null,n=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=r,this.matrix=i,this.type=e.type}clone(){return new Su(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const $i=new ye,E1=class b1 extends R_{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new yu,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),nl.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r.reset(),qy.push(r)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,r=null,n=null,i=null){const s=new Su(e,r,n,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,r=null){if(!this.graphicsData.length)return null;const n=new Su(e,null,null,r),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const r=this.graphicsData;for(let n=0;n<r.length;++n){const i=r[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,$i):$i.copyFrom(e),i.shape.contains($i.x,$i.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains($i.x,$i.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,r=this.graphicsData;let n=null,i=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],i=n.style);for(let l=this.shapeIndex;l<r.length;l++){this.shapeIndex++;const u=r[l],c=u.fillStyle,h=u.lineStyle;wh[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(c.visible||h.visible)&&this.processHoles(u.holes);for(let d=0;d<2;d++){const m=d===0?c:h;if(!m.visible)continue;const g=m.texture.baseTexture,x=this.indices.length,w=this.points.length/2;g.wrapMode=jn.REPEAT,d===0?this.processFill(u):this.processLine(u);const y=this.points.length/2-w;y!==0&&(n&&!this._compareStyles(i,m)&&(n.end(x,w),n=null),n||(n=qy.pop()||new Rk,n.begin(m,x,w),this.batches.push(n),i=m),this.addUvs(this.points,e,m.texture,w,y,m.matrix))}}const s=this.indices.length,o=this.points.length/2;if(n&&n.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,r){return!(!e||!r||e.texture.baseTexture!==r.texture.baseTexture||e.color+e.alpha!==r.color+r.alpha||!!e.native!=!!r.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,r=this.graphicsData.length;e<r;e++){const n=this.graphicsData[e],i=n.fillStyle,s=n.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let r=0,n=e.length;r<n;r++){const i=e[r];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<b1.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++ae._globalBatch;for(let h=0;h<this.drawCalls.length;h++)this.drawCalls[h].texArray.clear(),nl.push(this.drawCalls[h]);this.drawCalls.length=0;const r=this.colors,n=this.textureIds;let i=nl.pop();i||(i=new Xd,i.texArray=new Zd),i.texArray.count=0,i.start=0,i.size=0,i.type=kr.TRIANGLES;let s=0,o=null,a=0,l=!1,u=kr.TRIANGLES,c=0;this.drawCalls.push(i);for(let h=0;h<this.batches.length;h++){const d=this.batches[h],m=8,g=d.style,x=g.texture.baseTexture;l!==!!g.native&&(l=!!g.native,u=l?kr.LINES:kr.TRIANGLES,o=null,s=m,e++),o!==x&&(o=x,x._batchEnabled!==e&&(s===m&&(e++,s=0,i.size>0&&(i=nl.pop(),i||(i=new Xd,i.texArray=new Zd),this.drawCalls.push(i)),i.start=c,i.size=0,i.texArray.count=0,i.type=u),x.touched=1,x._batchEnabled=e,x._batchLocation=s,x.wrapMode=jn.REPEAT,i.texArray.elements[i.texArray.count++]=x,s++)),i.size+=d.size,c+=d.size,a=x._batchLocation,this.addColors(r,g.color,g.alpha,d.attribSize,d.attribStart),this.addTextureIds(n,a,d.attribSize,d.attribStart)}ae._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,r=this.uvs,n=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let u=0;u<e.length/2;u++)o[l++]=e[u*2],o[l++]=e[u*2+1],o[l++]=r[u*2],o[l++]=r[u*2+1],a[l++]=n[u],o[l++]=i[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?S1.triangulate(e,this):wh[e.type].triangulate(e,this)}processLine(e){Ky(e,this);for(let r=0;r<e.holes.length;r++)Ky(e.holes[r],this)}processHoles(e){for(let r=0;r<e.length;r++){const n=e[r];wh[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,r){for(let n=0;n<e.length/2;n++){const i=e[n*2],s=e[n*2+1];e[n*2]=r.a*i+r.c*s+r.tx,e[n*2+1]=r.b*i+r.d*s+r.ty}}addColors(e,r,n,i,s=0){const o=Ie.shared.setValue(r).toLittleEndianNumber(),a=Ie.shared.setValue(o).toPremultiplied(n);e.length=Math.max(e.length,s+i);for(let l=0;l<i;l++)e[s+l]=a}addTextureIds(e,r,n,i=0){e.length=Math.max(e.length,i+n);for(let s=0;s<n;s++)e[i+s]=r}addUvs(e,r,n,i,s,o=null){let a=0;const l=r.length,u=n.frame;for(;a<s;){let h=e[(i+a)*2],d=e[(i+a)*2+1];if(o){const m=o.a*h+o.c*d+o.tx;d=o.b*h+o.d*d+o.ty,h=m}a++,r.push(h/u.width,d/u.height)}const c=n.baseTexture;(u.width<c.width||u.height<c.height)&&this.adjustUvs(r,n,l,s)}adjustUvs(e,r,n,i){const s=r.baseTexture,o=1e-6,a=n+i*2,l=r.frame,u=l.width/s.width,c=l.height/s.height;let h=l.x/l.width,d=l.y/l.height,m=Math.floor(e[n]+o),g=Math.floor(e[n+1]+o);for(let x=n+2;x<a;x+=2)m=Math.min(m,Math.floor(e[x]+o)),g=Math.min(g,Math.floor(e[x+1]+o));h-=m,d-=g;for(let x=n;x<a;x+=2)e[x]=(e[x]+h)*u,e[x+1]=(e[x+1]+d)*c}};E1.BATCHABLE_SIZE=100;let kk=E1;class ec{constructor(){this.color=16777215,this.alpha=1,this.texture=K.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new ec;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=K.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Up extends ec{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=In.BUTT,this.join=$t.MITER,this.miterLimit=10}clone(){const e=new Up;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=In.BUTT,this.join=$t.MITER,this.miterLimit=10}}const Sh={},yf=class Il extends Bt{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new ec,this._lineStyle=new Up,this._matrix=null,this._holeMode=!1,this.state=Lr.for2d(),this._geometry=e||new kk,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Ie(16777215),this.blendMode=ne.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Il(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,r=0,n,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:r,alpha:n,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const r={width:0,texture:K.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:In.BUTT,join:$t.MITER,miterLimit:10};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new gi,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new gi,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this}lineTo(e,r){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,i=n[n.length-2],s=n[n.length-1];return(i!==e||s!==r)&&n.push(e,r),this}_initCurve(e=0,r=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)}quadraticCurveTo(e,r,n,i){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),Op.curveTo(e,r,n,i,s),this}bezierCurveTo(e,r,n,i,s,o){return this._initCurve(),Lp.curveTo(e,r,n,i,s,o,this.currentPath.points),this}arcTo(e,r,n,i,s){this._initCurve(e,r);const o=this.currentPath.points,a=Xy.curveTo(e,r,n,i,s,o);if(a){const{cx:l,cy:u,radius:c,startAngle:h,endAngle:d,anticlockwise:m}=a;this.arc(l,u,c,h,d,m)}return this}arc(e,r,n,i,s,o=!1){if(i===s)return this;if(!o&&s<=i?s+=du:o&&i<=s&&(i+=du),s-i===0)return this;const a=e+Math.cos(i)*n,l=r+Math.sin(i)*n,u=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const h=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-l);h<u&&d<u||c.push(a,l)}else this.moveTo(a,l),c=this.currentPath.points;return Xy.arc(a,l,e,r,n,i,s,o,c),this}beginFill(e=0,r){return this.beginTextureFill({texture:K.WHITE,color:e,alpha:r})}normalizeColor(e){const r=Ie.shared.setValue(e.color??0);e.color=r.toNumber(),e.alpha??(e.alpha=r.alpha)}beginTextureFill(e){const r={texture:K.WHITE,color:16777215,matrix:null};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,r,n,i){return this.drawShape(new ce(e,r,n,i))}drawRoundedRect(e,r,n,i,s){return this.drawShape(new Zu(e,r,n,i,s))}drawCircle(e,r,n){return this.drawShape(new Ku(e,r,n))}drawEllipse(e,r,n,i){return this.drawShape(new qu(e,r,n,i))}drawPolygon(...e){let r,n=!0;const i=e[0];i.points?(n=i.closeStroke,r=i.points):Array.isArray(e[0])?r=e[0]:r=e;const s=new gi(r);return s.closeStroke=n,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===at.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,r=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let i=0;i<n;i++){const s=e.batches[i],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),c={vertexData:a,blendMode:r,indices:u,uvs:l,_batchRGB:Ie.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=c}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let r=0,n=this.batches.length;r<n;r++){const i=this.batches[r];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const r=this._resolveDirectShader(e),n=this._geometry,i=this.worldAlpha,s=r.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,Ie.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(r),e.geometry.bind(n,r),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,n.drawCalls[a])}_renderDrawCallDirect(e,r){const{texArray:n,type:i,size:s,start:o}=r,a=n.count;for(let l=0;l<a;l++)e.texture.bind(n.elements[l],l);e.geometry.draw(i,s,o)}_resolveDirectShader(e){let r=this.shader;const n=this.pluginName;if(!r){if(!Sh[n]){const{maxTextures:i}=e.plugins[n],s=new Int32Array(i);for(let l=0;l<i;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Me,default:mr.from({uSamplers:s},!0)},a=e.plugins[n]._shader.program;Sh[n]=new Fr(a,o)}r=Sh[n]}return r}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:r,minY:n,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,r,n,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,Il._TEMP_POINT),this._geometry.containsPoint(Il._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r._tintRGB=Ie.shared.setValue(this._tintColor).multiply(r._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,u=this._geometry.points,c=this.vertexData;let h=0;for(let d=0;d<u.length;d+=2){const m=u[d],g=u[d+1];c[h++]=n*m+s*g+a,c[h++]=o*g+i*m+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};yf.curves=Us,yf._TEMP_POINT=new ye;let Ot=yf;class Mk{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const Eh=new ye,Zy=new gi,T1=class A1 extends Bt{constructor(e,r,n,i=kr.TRIANGLES){super(),this.geometry=e,this.shader=r,this.state=n||Lr.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=H.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===kr.TRIANGLES&&r.length<A1.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const r=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const e=this.geometry.buffers[0],r=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,u=i.tx,c=i.ty,h=this.vertexData;for(let d=0;d<h.length/2;d++){const m=r[d*2],g=r[d*2+1];h[d*2]=s*m+a*g+u,h[d*2+1]=o*m+l*g+c}if(this._roundPixels){const d=H.RESOLUTION;for(let m=0;m<h.length;++m)h[m]=Math.round(h[m]*d)/d}this.vertexDirty=n}calculateUvs(){const e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Mk(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Eh);const r=this.geometry.getBuffer("aVertexPosition").data,n=Zy.points,i=this.geometry.getIndex().data,s=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=i[a]*2,u=i[a+1]*2,c=i[a+2]*2;if(n[0]=r[l],n[1]=r[l+1],n[2]=r[u],n[3]=r[u+1],n[4]=r[c],n[5]=r[c+1],Zy.contains(Eh.x,Eh.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};T1.BATCHABLE_SIZE=100;let Qy=T1;class Bk extends $n{constructor(e,r,n){super();const i=new $e(e),s=new $e(r,!0),o=new $e(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,J.FLOAT).addAttribute("aTextureCoord",s,2,!1,J.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var Nk=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,Fk=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Jy extends Fr{constructor(e,r){const n={uSampler:e,alpha:1,uTextureMatrix:Me.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||qr.from(Fk,Nk),n),this._colorDirty=!1,this.uvMatrix=new z_(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new Ie(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Ie.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class ev{constructor(e,r,n){this.geometry=new $n,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||J.FLOAT,offset:s.offset},r[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let r=0;this.indexBuffer=new $e(rP(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new $e(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new $e(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===J.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===J.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,r,n){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,r,n,s.type===J.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,n){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,r,n,s.type===J.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var Dk=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,Lk=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class C1 extends Qu{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Me,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:J.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Fr.from(Lk,Dk,{}),this.state=Lr.for2d()}render(e){const r=e.children,n=e._maxSize,i=e._batchSize,s=this.renderer;let o=r.length;if(o===0)return;o>n&&!e.autoResize&&(o=n);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=r[0]._texture.baseTexture,u=l.alphaMode>0;this.state.blendMode=T_(e.blendMode,u),s.state.set(this.state);const c=s.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=Ie.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let d=!1;for(let m=0,g=0;m<o;m+=i,g+=1){let x=o-m;x>i&&(x=i),g>=a.length&&a.push(this._generateOneMoreBuffer(e));const w=a[g];w.uploadDynamic(r,m,x);const y=e._bufferUpdateIDs[g]||0;d=d||w._updateID<y,d&&(w._updateID=e._updateID,w.uploadStatic(r,m,x)),s.geometry.bind(w.geometry),c.drawElements(c.TRIANGLES,x*6,c.UNSIGNED_SHORT,0)}}generateBuffers(e){const r=[],n=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<n;o+=i)r.push(new ev(this.properties,s,i));return r}_generateOneMoreBuffer(e){const r=e._batchSize,n=e._properties;return new ev(this.properties,n,r)}uploadVertices(e,r,n,i,s,o){let a=0,l=0,u=0,c=0;for(let h=0;h<n;++h){const d=e[r+h],m=d._texture,g=d.scale.x,x=d.scale.y,w=m.trim,y=m.orig;w?(l=w.x-d.anchor.x*y.width,a=l+w.width,c=w.y-d.anchor.y*y.height,u=c+w.height):(a=y.width*(1-d.anchor.x),l=y.width*-d.anchor.x,u=y.height*(1-d.anchor.y),c=y.height*-d.anchor.y),i[o]=l*g,i[o+1]=c*x,i[o+s]=a*g,i[o+s+1]=c*x,i[o+s*2]=a*g,i[o+s*2+1]=u*x,i[o+s*3]=l*g,i[o+s*3+1]=u*x,o+=s*4}}uploadPosition(e,r,n,i,s,o){for(let a=0;a<n;a++){const l=e[r+a].position;i[o]=l.x,i[o+1]=l.y,i[o+s]=l.x,i[o+s+1]=l.y,i[o+s*2]=l.x,i[o+s*2+1]=l.y,i[o+s*3]=l.x,i[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,r,n,i,s,o){for(let a=0;a<n;a++){const l=e[r+a].rotation;i[o]=l,i[o+s]=l,i[o+s*2]=l,i[o+s*3]=l,o+=s*4}}uploadUvs(e,r,n,i,s,o){for(let a=0;a<n;++a){const l=e[r+a]._texture._uvs;l?(i[o]=l.x0,i[o+1]=l.y0,i[o+s]=l.x1,i[o+s+1]=l.y1,i[o+s*2]=l.x2,i[o+s*2+1]=l.y2,i[o+s*3]=l.x3,i[o+s*3+1]=l.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}}uploadTint(e,r,n,i,s,o){for(let a=0;a<n;++a){const l=e[r+a],u=Ie.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);i[o]=u,i[o+s]=u,i[o+s*2]=u,i[o+s*3]=u,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}C1.extension={name:"particle",type:V.RendererPlugin};q.add(C1);var tc=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(tc||{});const il={willReadFrequently:!0},br=class Q{static get experimentalLetterSpacingSupported(){let e=Q._experimentalLetterSpacingSupported;if(e!==void 0){const r=H.ADAPTER.getCanvasRenderingContext2D().prototype;e=Q._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,i,s,o,a,l,u){this.text=e,this.style=r,this.width=n,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e,r,n,i=Q._canvas){n=n??r.wordWrap;const s=r.toFontString(),o=Q.measureFont(s);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const a=i.getContext("2d",il);a.font=s;const l=(n?Q.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let c=0;for(let g=0;g<l.length;g++){const x=Q._measureText(l[g],r.letterSpacing,a);u[g]=x,c=Math.max(c,x)}let h=c+r.strokeThickness;r.dropShadow&&(h+=r.dropShadowDistance);const d=r.lineHeight||o.fontSize+r.strokeThickness;let m=Math.max(d,o.fontSize+r.strokeThickness*2)+r.leading+(l.length-1)*(d+r.leading);return r.dropShadow&&(m+=r.dropShadowDistance),new Q(e,r,h,m,l,u,d+r.leading,c,o)}static _measureText(e,r,n){let i=!1;Q.experimentalLetterSpacingSupported&&(Q.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let s=n.measureText(e).width;return s>0&&(i?s-=r:s+=(Q.graphemeSegmenter(e).length-1)*r),s}static wordWrap(e,r,n=Q._canvas){const i=n.getContext("2d",il);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:c}=r,h=Q.collapseSpaces(c),d=Q.collapseNewlines(c);let m=!h;const g=r.wordWrapWidth+u,x=Q.tokenize(e);for(let w=0;w<x.length;w++){let y=x[w];if(Q.isNewline(y)){if(!d){a+=Q.addLine(o),m=!h,o="",s=0;continue}y=" "}if(h){const p=Q.isBreakingSpace(y),_=Q.isBreakingSpace(o[o.length-1]);if(p&&_)continue}const v=Q.getFromCache(y,u,l,i);if(v>g)if(o!==""&&(a+=Q.addLine(o),o="",s=0),Q.canBreakWords(y,r.breakWords)){const p=Q.wordWrapSplit(y);for(let _=0;_<p.length;_++){let S=p[_],b=S,A=1;for(;p[_+A];){const M=p[_+A];if(!Q.canBreakChars(b,M,y,_,r.breakWords))S+=M;else break;b=M,A++}_+=A-1;const T=Q.getFromCache(S,u,l,i);T+s>g&&(a+=Q.addLine(o),m=!1,o="",s=0),o+=S,s+=T}}else{o.length>0&&(a+=Q.addLine(o),o="",s=0);const p=w===x.length-1;a+=Q.addLine(y,!p),m=!1,o="",s=0}else v+s>g&&(m=!1,a+=Q.addLine(o),o="",s=0),(o.length>0||!Q.isBreakingSpace(y)||m)&&(o+=y,s+=v)}return a+=Q.addLine(o,!1),a}static addLine(e,r=!0){return e=Q.trimRight(e),e=r?`${e}
`:e,e}static getFromCache(e,r,n,i){let s=n[e];return typeof s!="number"&&(s=Q._measureText(e,r,i)+r,n[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!Q.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:Q._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:Q._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(Q.isBreakingSpace(s,o)||Q.isNewline(s)){n!==""&&(r.push(n),n=""),r.push(s);continue}n+=s}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,i,s){return!0}static wordWrapSplit(e){return Q.graphemeSegmenter(e)}static measureFont(e){if(Q._fonts[e])return Q._fonts[e];const r={ascent:0,descent:0,fontSize:0},n=Q._canvas,i=Q._context;i.font=e;const s=Q.METRICS_STRING+Q.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(Q.BASELINE_SYMBOL).width);const l=Math.ceil(Q.HEIGHT_MULTIPLIER*a);if(a=a*Q.BASELINE_MULTIPLIER|0,o===0||l===0)return Q._fonts[e]=r,r;n.width=o,n.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const u=i.getImageData(0,0,o,l).data,c=u.length,h=o*4;let d=0,m=0,g=!1;for(d=0;d<a;++d){for(let x=0;x<h;x+=4)if(u[m+x]!==255){g=!0;break}if(!g)m+=h;else break}for(r.ascent=a-d,m=c-h,g=!1,d=l;d>a;--d){for(let x=0;x<h;x+=4)if(u[m+x]!==255){g=!0;break}if(!g)m-=h;else break}return r.descent=d-a,r.fontSize=r.ascent+r.descent,Q._fonts[e]=r,r}static clearMetrics(e=""){e?delete Q._fonts[e]:Q._fonts={}}static get _canvas(){var e;if(!Q.__canvas){let r;try{const n=new OffscreenCanvas(0,0);if((e=n.getContext("2d",il))!=null&&e.measureText)return Q.__canvas=n,n;r=H.ADAPTER.createCanvas()}catch{r=H.ADAPTER.createCanvas()}r.width=r.height=10,Q.__canvas=r}return Q.__canvas}static get _context(){return Q.__context||(Q.__context=Q._canvas.getContext("2d",il)),Q.__context}};br.METRICS_STRING="|q",br.BASELINE_SYMBOL="M",br.BASELINE_MULTIPLIER=1.4,br.HEIGHT_MULTIPLIER=2,br.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})(),br.experimentalLetterSpacing=!1,br._fonts={},br._newlines=[10,13],br._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let wn=br;const Ok=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],R1=class vo{constructor(e){this.styleID=0,this.reset(),Th(this,e,e)}clone(){const e={};return Th(e,this,vo.defaultStyle),new vo(e)}reset(){Th(this,vo.defaultStyle,vo.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const r=bh(e);this._dropShadowColor!==r&&(this._dropShadowColor=r,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const r=bh(e);this._fill!==r&&(this._fill=r,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){Uk(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const r=bh(e);this._stroke!==r&&(this._stroke=r,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let r=this.fontFamily;Array.isArray(this.fontFamily)||(r=this.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let i=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!Ok.includes(i)&&(i=`"${i}"`),r[n]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${r.join(",")}`}};R1.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:tc.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Jt=R1;function bh(t){const e=Ie.shared,r=n=>{const i=e.setValue(n);return i.alpha===1?i.toHex():i.toRgbaString()};return Array.isArray(t)?t.map(r):r(t)}function Uk(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function Th(t,e,r){for(const n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}const jk={texture:!0,children:!1,baseTexture:!0},P1=class vf extends Hn{constructor(e,r,n){let i=!1;n||(n=H.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const s=K.from(n);s.orig=new ce,s.trim=new ce,super(s),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=vf.defaultResolution??H.RESOLUTION,this._autoResolution=vf.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return wn.experimentalLetterSpacing}static set experimentalLetterSpacing(e){pe("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),wn.experimentalLetterSpacing=e}updateText(e){const r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const n=this.context,i=wn.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,a=i.lines,l=i.lineHeight,u=i.lineWidths,c=i.maxLineWidth,h=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;let d,m;const g=r.dropShadow?2:1;for(let x=0;x<g;++x){const w=r.dropShadow&&x===0,y=w?Math.ceil(Math.max(1,o)+r.padding*2):0,v=y*this._resolution;if(w){n.fillStyle="black",n.strokeStyle="black";const _=r.dropShadowColor,S=r.dropShadowBlur*this._resolution,b=r.dropShadowDistance*this._resolution;n.shadowColor=Ie.shared.setValue(_).setAlpha(r.dropShadowAlpha).toRgbaString(),n.shadowBlur=S,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*b,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*b+v}else n.fillStyle=this._generateFillStyle(r,a,i),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let p=(l-h.fontSize)/2;l-h.fontSize<0&&(p=0);for(let _=0;_<a.length;_++)d=r.strokeThickness/2,m=r.strokeThickness/2+_*l+h.ascent+p,r.align==="right"?d+=c-u[_]:r.align==="center"&&(d+=(c-u[_])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(a[_],d+r.padding,m+r.padding-y,!0),r.fill&&this.drawLetterSpacing(a[_],d+r.padding,m+r.padding-y)}this.updateTexture()}drawLetterSpacing(e,r,n,i=!1){const s=this._style.letterSpacing;let o=!1;if(wn.experimentalLetterSpacingSupported&&(wn.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(e,r,n):this.context.fillText(e,r,n);return}let a=r;const l=wn.graphemeSegmenter(e);let u=this.context.measureText(e).width,c=0;for(let h=0;h<l.length;++h){const d=l[h];i?this.context.strokeText(d,a,n):this.context.fillText(d,a,n);let m="";for(let g=h+1;g<l.length;++g)m+=l[g];c=this.context.measureText(m).width,a+=u-c+s,u=c}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=oP(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const r=this._texture,n=this._style,i=n.trim?0:n.padding,s=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-i*2,r.orig.height=r._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,r){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,r)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,r,n){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,u=this.canvas.height/this._resolution-o-a*2,c=i.slice(),h=e.fillGradientStops.slice();if(!h.length){const d=c.length+1;for(let m=1;m<d;++m)h.push(m/d)}if(c.unshift(i[0]),h.unshift(0),c.push(i[i.length-1]),h.push(1),e.fillGradientType===tc.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,u+a);const d=n.fontProperties.fontSize+e.strokeThickness;for(let m=0;m<r.length;m++){const g=n.lineHeight*(m-1)+d,x=n.lineHeight*m;let w=x;m>0&&g>x&&(w=(x+g)/2);const y=x+d,v=n.lineHeight*(m+1);let p=y;m+1<r.length&&v<y&&(p=(y+v)/2);const _=(p-w)/u;for(let S=0;S<c.length;S++){let b=0;typeof h[S]=="number"?b=h[S]:b=S/c.length;let A=Math.min(1,Math.max(0,w/u+b*_));A=Number(A.toFixed(5)),s.addColorStop(A,c[S])}}}else{s=this.context.createLinearGradient(a,u/2,l+a,u/2);const d=c.length+1;let m=1;for(let g=0;g<c.length;g++){let x;typeof h[g]=="number"?x=h[g]:x=m/d,s.addColorStop(x,c[g]),m++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},jk,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const r=Pn(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const r=Pn(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Jt?this._style=e:this._style=new Jt(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};P1.defaultAutoResolution=!0;let Ai=P1;class Gk{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function zk(t,e){var n;let r=!1;if((n=t==null?void 0:t._textures)!=null&&n.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof K){const s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),r=!0)}}return r}function Vk(t,e){if(t.baseTexture instanceof ae){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function $k(t,e){if(t._texture&&t._texture instanceof K){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function Hk(t,e){return e instanceof Ai?(e.updateText(!0),!0):!1}function Wk(t,e){if(e instanceof Jt){const r=e.toFontString();return wn.measureFont(r),!0}return!1}function Xk(t,e){if(t instanceof Ai){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function Yk(t,e){return t instanceof Jt?(e.includes(t)||e.push(t),!0):!1}const I1=class k1{constructor(e){this.limiter=new Gk(k1.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Xk),this.registerFindHook(Yk),this.registerFindHook(zk),this.registerFindHook(Vk),this.registerFindHook($k),this.registerUploadHook(Hk),this.registerUploadHook(Wk)}upload(e){return new Promise(r=>{e&&this.add(e),this.queue.length?(this.completes.push(r),this.ticking||(this.ticking=!0,Lt.system.addOnce(this.tick,this,Ti.UTILITY))):r()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let r=!1;if(e&&!e._destroyed){for(let n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),r=!0;break}}r||this.queue.shift()}if(this.queue.length)Lt.system.addOnce(this.tick,this,Ti.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let r=0,n=e.length;r<n;r++)e[r]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let r=0,n=this.addHooks.length;r<n&&!this.addHooks[r](e,this.queue);r++);if(e instanceof Bt)for(let r=e.children.length-1;r>=0;r--)this.add(e.children[r]);return this}destroy(){this.ticking&&Lt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};I1.uploadsPerFrame=4;let xf=I1;Object.defineProperties(H,{UPLOADS_PER_FRAME:{get(){return xf.uploadsPerFrame},set(t){pe("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),xf.uploadsPerFrame=t}}});function M1(t,e){return e instanceof ae?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function Kk(t,e){if(!(e instanceof Ot))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:n}=r;for(let i=0;i<n.length;i++){const{texture:s}=n[i].style;s&&M1(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function qk(t,e){return t instanceof Ot?(e.push(t),!0):!1}class B1 extends xf{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(qk),this.registerUploadHook(M1),this.registerUploadHook(Kk)}}B1.extension={name:"prepare",type:V.RendererSystem};q.add(B1);var Zk=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,Qk=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Jk=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,tv=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,eM=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const sl=new Me;class N1 extends Qu{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new O_,this.state=Lr.for2d()}contextChange(){const e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=Fr.from(tv,eM,r),this.shader=e.context.webGLVersion>1?Fr.from(Qk,Zk,r):Fr.from(tv,Jk,r)}render(e){const r=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=n.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,n.invalidate();const a=e._texture,l=a.baseTexture,u=l.alphaMode>0,c=e.tileTransform.localTransform,h=e.uvMatrix;let d=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;d&&(l._glTextures[r.CONTEXT_UID]?d=l.wrapMode!==jn.CLAMP:l.wrapMode===jn.CLAMP&&(l.wrapMode=jn.REPEAT));const m=d?this.simpleShader:this.shader,g=a.width,x=a.height,w=e._width,y=e._height;sl.set(c.a*g/w,c.b*g/y,c.c*x/w,c.d*x/y,c.tx/w,c.ty/y),sl.invert(),d?sl.prepend(h.mapCoord):(m.uniforms.uMapCoord=h.mapCoord.toArray(!0),m.uniforms.uClampFrame=h.uClampFrame,m.uniforms.uClampOffset=h.uClampOffset),m.uniforms.uTransform=sl.toArray(!0),m.uniforms.uColor=Ie.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(m.uniforms.uColor),m.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),m.uniforms.uSampler=a,r.shader.bind(m),r.geometry.bind(n),this.state.blendMode=T_(e.blendMode,u),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}N1.extension={name:"tilingSprite",type:V.RendererPlugin};q.add(N1);const F1=class xo{constructor(e,r,n){this.linkedSheets=[],(e instanceof ae||e instanceof K)&&(e={texture:e,data:r,resolutionFilename:n});const{texture:i,data:s,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=i instanceof K?i:null,this.baseTexture=i instanceof ae?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const l=this.baseTexture.resource;this.resolution=this._updateResolution(o||(l?l.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:r}=this.data.meta;let n=nn(e,null);return n===null&&(n=typeof r=="number"?r:parseFloat(r??"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=xo.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=xo.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const i=this._frameKeys[r],s=this._frames[i],o=s.frame;if(o){let a=null,l=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,c=new ce(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new ce(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new ce(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new ce(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new K(this.baseTexture,a,c,l,s.rotated?2:0,s.anchor,s.borders),K.addToCache(this.textures[i],this.cachePrefix+i.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const i=e[r][n];this.animations[r].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*xo.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*xo.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var r;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((r=this._texture)==null||r.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};F1.BATCH_SIZE=1e3;let rv=F1;const tM=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function D1(t,e,r){const n={};if(t.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[`${e.cachePrefix}${i}`]=e.textures[i]}),!r){const i=it.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(n,D1([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return n}const rM={extension:V.Asset,cache:{test:t=>t instanceof rv,getCacheableAssets:(t,e)=>D1(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&tM.includes(n)},parse:t=>{var r;const e=t.split(".");return{resolution:parseFloat(((r=H.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:V.LoadParser,priority:yr.Normal},async testParse(t,e){return it.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){var c,h;const{texture:n,imageFilename:i,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=it.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(n&&n.baseTexture)a=n;else{const d=pf(o+(i??t.meta.image),e.src);a=(await r.load([d]))[d]}const l=new rv({texture:a.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await l.parse();const u=(c=t==null?void 0:t.meta)==null?void 0:c.related_multi_packs;if(Array.isArray(u)){const d=[];for(const g of u){if(typeof g!="string")continue;let x=o+g;(h=e.data)!=null&&h.ignoreMultiPack||(x=pf(x,e.src),d.push(r.load({src:x,data:{ignoreMultiPack:!0}})))}const m=await Promise.all(d);l.linkedSheets=m,m.forEach(g=>{g.linkedSheets=[l].concat(l.linkedSheets.filter(x=>x!==g))})}return l},unload(t){t.destroy(!0)}}};q.add(rM);class Eu{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class kl{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const r=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in r){const o=r[s].match(/^[a-z]+/gm)[0],a=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const u in a){const c=a[u].split("="),h=c[0],d=c[1].replace(/"/gm,""),m=parseFloat(d),g=isNaN(m)?d:m;l[h]=g}n[o].push(l)}const i=new Eu;return n.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),n.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),n.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),n.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),n.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),n.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class _f{static test(e){const r=e;return typeof e!="string"&&"getElementsByTagName"in e&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const r=new Eu,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let u=0;u<n.length;u++)r.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(let u=0;u<i.length;u++)r.common.push({lineHeight:parseInt(i[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)r.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const c=o[u];r.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)r.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<l.length;u++)r.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return r}}class wf{static test(e){return typeof e=="string"&&e.includes("<font>")?_f.test(H.ADAPTER.parseXML(e)):!1}static parse(e){return _f.parse(H.ADAPTER.parseXML(e))}}const Ah=[kl,_f,wf];function nM(t){for(let e=0;e<Ah.length;e++)if(Ah[e].test(t))return Ah[e];return null}function iM(t,e,r,n,i,s){const o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,c=t.width/n-l-u*2,h=t.height/n-l-u*2,d=o.slice(),m=r.fillGradientStops.slice();if(!m.length){const g=d.length+1;for(let x=1;x<g;++x)m.push(x/g)}if(d.unshift(o[0]),m.unshift(0),d.push(o[o.length-1]),m.push(1),r.fillGradientType===tc.LINEAR_VERTICAL){a=e.createLinearGradient(c/2,u,c/2,h+u);let g=0;const x=(s.fontProperties.fontSize+r.strokeThickness)/h;for(let w=0;w<i.length;w++){const y=s.lineHeight*w;for(let v=0;v<d.length;v++){let p=0;typeof m[v]=="number"?p=m[v]:p=v/d.length;const _=y/h+p*x;let S=Math.max(g,_);S=Math.min(S,1),a.addColorStop(S,d[v]),g=S}}}else{a=e.createLinearGradient(u,h/2,c+u,h/2);const g=d.length+1;let x=1;for(let w=0;w<d.length;w++){let y;typeof m[w]=="number"?y=m[w]:y=x/g,a.addColorStop(y,d[w]),x++}}return a}function sM(t,e,r,n,i,s,o){const a=r.text,l=r.fontProperties;e.translate(n,i),e.scale(s,s);const u=o.strokeThickness/2,c=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=iM(t,e,o,s,[a],r),e.strokeStyle=o.stroke,o.dropShadow){const h=o.dropShadowColor,d=o.dropShadowBlur*s,m=o.dropShadowDistance*s;e.shadowColor=Ie.shared.setValue(h).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=d,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*m,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*m}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,c+r.lineHeight-l.descent),o.fill&&e.fillText(a,u,c+r.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Ml(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function L1(t){return Array.from?Array.from(t):t.split("")}function oM(t){typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...L1(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const yn=class Tr{constructor(e,r,n){var c;const[i]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=nn(o.file),u={};this._ownsTextures=n,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=u;for(let h=0;h<e.page.length;h++){const{id:d,file:m}=e.page[h];u[d]=r instanceof Array?r[h]:r[m],a!=null&&a.fieldType&&a.fieldType!=="none"&&(u[d].baseTexture.alphaMode=Rt.NO_PREMULTIPLIED_ALPHA,u[d].baseTexture.mipmap=Dr.OFF)}for(let h=0;h<e.char.length;h++){const{id:d,page:m}=e.char[h];let{x:g,y:x,width:w,height:y,xoffset:v,yoffset:p,xadvance:_}=e.char[h];g/=l,x/=l,w/=l,y/=l,v/=l,p/=l,_/=l;const S=new ce(g+u[m].frame.x/l,x+u[m].frame.y/l,w,y);this.chars[d]={xOffset:v,yOffset:p,xAdvance:_,kerning:{},texture:new K(u[m].baseTexture,S),page:m}}for(let h=0;h<e.kerning.length;h++){let{first:d,second:m,amount:g}=e.kerning[h];d/=l,m/=l,g/=l,this.chars[m]&&(this.chars[m].kerning[d]=g)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((c=a==null?void 0:a.fieldType)==null?void 0:c.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,r,n){let i;if(e instanceof Eu)i=e;else{const o=nM(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof K&&(r=[r]);const s=new Tr(i,r,n);return Tr.available[s.font]=s,s}static uninstall(e){const r=Tr.available[e];if(!r)throw new Error(`No font found named '${e}'`);r.destroy(),delete Tr.available[e]}static from(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:l,...u}=Object.assign({},Tr.defaultOptions,n),c=oM(i),h=r instanceof Jt?r:new Jt(r),d=a,m=new Eu;m.info[0]={face:h.fontFamily,size:h.fontSize},m.common[0]={lineHeight:h.fontSize};let g=0,x=0,w,y,v,p=0;const _=[];for(let b=0;b<c.length;b++){w||(w=H.ADAPTER.createCanvas(),w.width=a,w.height=l,y=w.getContext("2d"),v=new ae(w,{resolution:o,...u}),_.push(new K(v)),m.page.push({id:_.length-1,file:""}));const A=c[b],T=wn.measureText(A,h,!1,w),M=T.width,I=Math.ceil(T.height),W=Math.ceil((h.fontStyle==="italic"?2:1)*M);if(x>=l-I*o){if(x===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${A}')`);--b,w=null,y=null,v=null,x=0,g=0,p=0;continue}if(p=Math.max(I+T.fontProperties.descent,p),W*o+g>=d){if(g===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${A}')`);--b,x+=p*o,x=Math.ceil(x),g=0,p=0;continue}sM(w,y,T,g,x,o,h);const G=Ml(T.text);m.char.push({id:G,page:_.length-1,x:g/o,y:x/o,width:W,height:I,xoffset:0,yoffset:0,xadvance:M-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0)}),g+=(W+2*s)*o,g=Math.ceil(g)}if(!(n!=null&&n.skipKerning))for(let b=0,A=c.length;b<A;b++){const T=c[b];for(let M=0;M<A;M++){const I=c[M],W=y.measureText(T).width,G=y.measureText(I).width,C=y.measureText(T+I).width-(W+G);C&&m.kerning.push({first:Ml(T),second:Ml(I),amount:C})}}const S=new Tr(m,_,!0);return Tr.available[e]!==void 0&&Tr.uninstall(e),Tr.available[e]=S,S}};yn.ALPHA=[["a","z"],["A","Z"]," "],yn.NUMERIC=[["0","9"]],yn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],yn.ASCII=[[" ","~"]],yn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:yn.ALPHANUMERIC},yn.available={};let vn=yn;var aM=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,lM=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const nv=[],iv=[],sv=[],uM=class O1 extends Bt{constructor(e,r={}){super();const{align:n,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},O1.styleDefaults,r);if(!vn.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new Ie(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Kr(()=>{this.dirty=!0},this,0,0),this._roundPixels=H.ROUND_PIXELS,this.dirty=!0,this._resolution=H.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var W;const e=vn.available[this._fontName],r=this.fontSize,n=r/e.size,i=new ye,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=L1(l),c=this._maxWidth*e.size/r,h=e.distanceFieldType==="none"?nv:iv;let d=null,m=0,g=0,x=0,w=-1,y=0,v=0,p=0,_=0;for(let G=0;G<u.length;G++){const C=u[G],N=Ml(C);if(/(?:\s)/.test(C)&&(w=G,y=m,_++),C==="\r"||C===`
`){o.push(m),a.push(-1),g=Math.max(g,m),++x,++v,i.x=0,i.y+=e.lineHeight,d=null,_=0;continue}const z=e.chars[N];if(!z)continue;d&&z.kerning[d]&&(i.x+=z.kerning[d]);const B=sv.pop()||{texture:K.EMPTY,line:0,charCode:0,prevSpaces:0,position:new ye};B.texture=z.texture,B.line=x,B.charCode=N,B.position.x=Math.round(i.x+z.xOffset+this._letterSpacing/2),B.position.y=Math.round(i.y+z.yOffset),B.prevSpaces=_,s.push(B),m=B.position.x+Math.max(z.xAdvance-z.xOffset,z.texture.orig.width),i.x+=z.xAdvance+this._letterSpacing,p=Math.max(p,z.yOffset+z.texture.height),d=N,w!==-1&&c>0&&i.x>c&&(++v,Ts(s,1+w-v,1+G-w),G=w,w=-1,o.push(y),a.push(s.length>0?s[s.length-1].prevSpaces:0),g=Math.max(g,y),x++,i.x=0,i.y+=e.lineHeight,d=null,_=0)}const S=u[u.length-1];S!=="\r"&&S!==`
`&&(/(?:\s)/.test(S)&&(m=y),o.push(m),g=Math.max(g,m),a.push(-1));const b=[];for(let G=0;G<=x;G++){let C=0;this._align==="right"?C=g-o[G]:this._align==="center"?C=(g-o[G])/2:this._align==="justify"&&(C=a[G]<0?0:(g-o[G])/a[G]),b.push(C)}const A=s.length,T={},M=[],I=this._activePagesMeshData;h.push(...I);for(let G=0;G<A;G++){const C=s[G].texture,N=C.baseTexture.uid;if(!T[N]){let z=h.pop();if(!z){const k=new Bk;let P,D;e.distanceFieldType==="none"?(P=new Jy(K.EMPTY),D=ne.NORMAL):(P=new Jy(K.EMPTY,{program:qr.from(lM,aM),uniforms:{uFWidth:0}}),D=ne.NORMAL_NPM);const R=new Qy(k,P);R.blendMode=D,z={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:R,vertices:null,uvs:null,indices:null}}z.index=0,z.indexCount=0,z.vertexCount=0,z.uvsCount=0,z.total=0;const{_textureCache:B}=this;B[N]=B[N]||new K(C.baseTexture),z.mesh.texture=B[N],z.mesh.tint=this._tintColor.value,M.push(z),T[N]=z}T[N].total++}for(let G=0;G<I.length;G++)M.includes(I[G])||this.removeChild(I[G].mesh);for(let G=0;G<M.length;G++)M[G].mesh.parent!==this&&this.addChild(M[G].mesh);this._activePagesMeshData=M;for(const G in T){const C=T[G],N=C.total;if(!(((W=C.indices)==null?void 0:W.length)>6*N)||C.vertices.length<Qy.BATCHABLE_SIZE*2)C.vertices=new Float32Array(4*2*N),C.uvs=new Float32Array(4*2*N),C.indices=new Uint16Array(6*N);else{const z=C.total,B=C.vertices;for(let k=z*4*2;k<B.length;k++)B[k]=0}C.mesh.size=6*N}for(let G=0;G<A;G++){const C=s[G];let N=C.position.x+b[C.line]*(this._align==="justify"?C.prevSpaces:1);this._roundPixels&&(N=Math.round(N));const z=N*n,B=C.position.y*n,k=C.texture,P=T[k.baseTexture.uid],D=k.frame,R=k._uvs,F=P.index++;P.indices[F*6+0]=0+F*4,P.indices[F*6+1]=1+F*4,P.indices[F*6+2]=2+F*4,P.indices[F*6+3]=0+F*4,P.indices[F*6+4]=2+F*4,P.indices[F*6+5]=3+F*4,P.vertices[F*8+0]=z,P.vertices[F*8+1]=B,P.vertices[F*8+2]=z+D.width*n,P.vertices[F*8+3]=B,P.vertices[F*8+4]=z+D.width*n,P.vertices[F*8+5]=B+D.height*n,P.vertices[F*8+6]=z,P.vertices[F*8+7]=B+D.height*n,P.uvs[F*8+0]=R.x0,P.uvs[F*8+1]=R.y0,P.uvs[F*8+2]=R.x1,P.uvs[F*8+3]=R.y1,P.uvs[F*8+4]=R.x2,P.uvs[F*8+5]=R.y2,P.uvs[F*8+6]=R.x3,P.uvs[F*8+7]=R.y3}this._textWidth=g*n,this._textHeight=(i.y+e.lineHeight)*n;for(const G in T){const C=T[G];if(this.anchor.x!==0||this.anchor.y!==0){let k=0;const P=this._textWidth*this.anchor.x,D=this._textHeight*this.anchor.y;for(let R=0;R<C.total;R++)C.vertices[k++]-=P,C.vertices[k++]-=D,C.vertices[k++]-=P,C.vertices[k++]-=D,C.vertices[k++]-=P,C.vertices[k++]-=D,C.vertices[k++]-=P,C.vertices[k++]-=D}this._maxLineHeight=p*n;const N=C.mesh.geometry.getBuffer("aVertexPosition"),z=C.mesh.geometry.getBuffer("aTextureCoord"),B=C.mesh.geometry.getIndex();N.data=C.vertices,z.data=C.uvs,B.data=C.indices,N.update(),z.update(),B.update()}for(let G=0;G<s.length;G++)sv.push(s[G]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:r,distanceFieldType:n,size:i}=vn.available[this._fontName];if(n!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,u=Math.sqrt(s*s+o*o),c=Math.sqrt(a*a+l*l),h=(Math.abs(u)+Math.abs(c))/2,d=this.fontSize/i,m=e._view.resolution;for(const g of this._activePagesMeshData)g.mesh.shader.uniforms.uFWidth=h*r*d*m}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=vn.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!vn.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??vn.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:r}=this,n=vn.available[this._fontName].distanceFieldType==="none"?nv:iv;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>r[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=K.EMPTY});for(const i in r)r[i].destroy(),delete r[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};uM.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const cM=[".xml",".fnt"],hM={extension:{type:V.LoadParser,priority:yr.Normal},name:"loadBitmapFont",test(t){return cM.includes(it.extname(t).toLowerCase())},async testParse(t){return kl.test(t)||wf.test(t)},async parse(t,e,r){const n=kl.test(t)?kl.parse(t):wf.parse(t),{src:i}=e,{page:s}=n,o=[];for(let u=0;u<s.length;++u){const c=s[u].file;let h=it.join(it.dirname(i),c);h=pf(h,i),o.push(h)}const a=await r.load(o),l=o.map(u=>a[u]);return vn.install(n,l,!0)},async load(t,e){return(await H.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};q.add(hM);const Sf=class es extends Jt{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new es(Object.keys(es.defaultOptions).reduce((r,n)=>({...r,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete es.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,r={}){const{availableFonts:n}=es;if(n[e]){const i=n[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return H.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,o)=>{const a=URL.createObjectURL(i),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(i)})).then(async([i,s])=>{const o=Object.assign({family:it.basename(e,it.extname(e)),weight:"normal",style:"normal",display:"auto",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},r);n[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const r=e.filter(n=>!this._overrides.includes(n));r.length>0&&(this._overrides.push(...r),this.styleID++)}removeOverride(...e){const r=e.filter(n=>this._overrides.includes(n));r.length>0&&(this._overrides=this._overrides.filter(n=>!r.includes(n)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,r)=>`${e}
            @font-face {
                font-family: "${r.family}";
                src: url('${r.dataSrc}');
                font-weight: ${r.weight};
                font-style: ${r.style};
                font-display: ${r.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=eP(e)),typeof e=="number"?JR(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const r=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&r<1&&(e+=(r*255|0).toString(16).padStart(2,"0"));const s=`${n}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,es.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(r=>setTimeout(r,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=H.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};Sf.availableFonts={},Sf.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Ch=Sf;const ol=class ts extends Hn{constructor(e="",r={}){super(K.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,i=K.from(n,{scaleMode:H.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new ce,i.trim=new ce,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),u=document.createElementNS(o,"div"),c=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=ts.defaultMaxWidth,this.maxHeight=ts.defaultMaxHeight,this._domElement=u,this._styleElement=c,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(c),this._foreignObject.appendChild(u),this._image=n,this._loadImage=new Image,this._autoResolution=ts.defaultAutoResolution,this._resolution=ts.defaultResolution??H.RESOLUTION,this.text=e,this.style=r}measureText(e){var c,h;const{text:r,style:n,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:r,style:n.toCSS(i)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",u.toString()),r!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(c=this._style)==null?void 0:c.toCSS(i)}),this._styleElement.textContent=(h=this._style)==null?void 0:h.toGlobalCSS()),{width:l+n.padding*2,height:u+n.padding*2}}async updateText(e=!0){const{style:r,_image:n,_loadImage:i}=this;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();n.width=i.width=Math.ceil(Math.max(1,s)),n.height=i.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{i.onload=async()=>{if(a<this._updateID){l();return}await r.onBeforeDraw(),n.src=i.src,i.onload=null,i.src="",this.updateTexture(),l()};const u=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:r,_image:n,resolution:i}=this,{padding:s}=e,{baseTexture:o}=r;r.trim.width=r._frame.width=n.width/i,r.trim.height=r._frame.height=n.height/i,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-s*2,r.orig.height=r._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(n.width,n.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var n,i,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},ts.defaultDestroyOptions,e),super.destroy(e);const r=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=r,(i=this._svgRoot)==null||i.remove(),this._svgRoot=r,(s=this._domElement)==null||s.remove(),this._domElement=r,(o=this._foreignObject)==null||o.remove(),this._foreignObject=r,(a=this._styleElement)==null||a.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const r=Pn(this.scale.x)||1;this.scale.x=r*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const r=Pn(this.scale.y)||1;this.scale.y=r*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Ch?(this.ownsStyle=!1,this._style=e):e instanceof Jt?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ch.from(e)):(this.ownsStyle=!0,this._style=new Ch(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};ol.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},ol.defaultMaxWidth=2024,ol.defaultMaxHeight=2024,ol.defaultAutoResolution=!0;const Pt={background:1710638,surface:2960708,hitZone:16098851,laneLeft:2972199,laneRight:4886745,textMuted:10526896,perfect:5025616,partial:16098851,miss:15037299},dM=.72,Rh=85,Ef=.82,ov=new Map;async function av(t){const e=`/bird-sound-game/${t}`,r=ov.get(t);if(r)return r;const n=(async()=>{try{console.log(`[Texture] Loading: ${e}`);const i=await go.load(e);return!i||!i.valid?(console.error(`[Texture] Invalid texture loaded: ${t}`,{fullPath:e,texture:i}),null):(console.log(`[Texture] Success: ${t}`),i)}catch(i){return console.error(`[Texture] Failed to load: ${t}`,{fullPath:e,error:i}),null}})();return ov.set(t,n),n}function fM({width:t,height:e,scheduledEvents:r,activeEvents:n,roundStartTime:i,roundState:s,scrollSpeed:o,currentFeedback:a,onChannelTap:l,trainingMode:u=!1,spectrogramMode:c="full",highContrast:h=!1}){const d=E.useRef(null),m=E.useRef(null),g=E.useRef(new Map),x=E.useRef(null),w=E.useCallback(y=>{var T;if(!l||!d.current)return;let v;"touches"in y?v=((T=y.touches[0])==null?void 0:T.clientX)??0:v=y.clientX;const p=d.current.getBoundingClientRect(),_=v-p.left,S=p.width/2,b=p.width*.1;if(Math.abs(_-S)<b/2)return;const A=_<S?"left":"right";l(A)},[l]);return E.useEffect(()=>{if(!d.current)return;const y=new g1({width:t,height:e,backgroundColor:Pt.background,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0});d.current.appendChild(y.view),m.current=y,uv(y,t,e),cv(y,t,e),hv(y,t,e);const v=new Bt;return y.stage.addChild(v),x.current=v,()=>{m.current&&(m.current.destroy(!0,{children:!0}),m.current=null),g.current.clear()}},[t,e]),E.useEffect(()=>{if(m.current){m.current.renderer.resize(t,e);const y=m.current;for(;y.stage.children.length>0;)y.stage.removeChildAt(0);uv(y,t,e),cv(y,t,e),hv(y,t,e);const v=new Bt;y.stage.addChild(v),x.current=v,g.current.clear()}},[t,e]),E.useEffect(()=>{const y=x.current;if(!y)return;if(s!=="playing"){y.removeChildren(),g.current.clear();return}if(r.length===0)return;const v=t/2,p=v*dM,_=e*Ef;for(const S of r){if(g.current.has(S.event_id))continue;const b=pM(S,v,p,Rh,_,S.spectrogramPath,u,c,h);b.container.y=-Rh,y.addChild(b.container),g.current.set(S.event_id,b)}},[r,s,t,e,u,c,h]),E.useEffect(()=>{if(s!=="playing"||!m.current)return;const y=e*Ef;let v;const p=()=>{const _=performance.now(),S=_-i;for(const b of g.current.values())if(b.hasBeenScored&&b.feedbackType){const A=_-b.feedbackStartTime;A>500&&(b.container.alpha=Math.max(0,1-(A-500)/200),b.container.alpha<=0&&(b.container.visible=!1))}else{const A=b.scheduledTimeMs-b.enterTimeMs,T=S-b.enterTimeMs,M=Math.max(0,T/A),I=-Rh,W=y;if(b.container.y=I+M*(W-I),c==="fading"){const G=b.container.getChildByName("spectrogram");G&&(M<.3?G.alpha=1:M<.8?G.alpha=1-(M-.3)/.5:G.alpha=0)}b.container.y>y+100&&(b.container.alpha=Math.max(0,1-(b.container.y-y-100)/50))}v=requestAnimationFrame(p)};return v=requestAnimationFrame(p),()=>{cancelAnimationFrame(v)}},[s,i,e,o,c]),E.useEffect(()=>{var y;if(a){for(const v of n)if(v.hasBeenScored&&v.channel===a.channel){const p=g.current.get(v.event_id);p&&!p.feedbackType&&(p.hasBeenScored=!0,p.feedbackType=a.type,p.feedbackStartTime=performance.now(),((y=a.breakdown)==null?void 0:y.speciesCorrect)?(lv(p,a.type,a.score),p.container.scale.set(1.3),setTimeout(()=>{p.container.visible=!1},400)):lv(p,a.type,a.score))}}},[a,n]),f.jsx("div",{ref:d,className:"pixi-game-container",onClick:w,onTouchStart:w,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none"}})}function pM(t,e,r,n,i,s,o=!1,a="full",l=!1){const u=new Bt,c=t.channel==="left"?e/2:e+e/2;u.x=c;const h=t.channel==="left"?Pt.laneLeft:Pt.laneRight,d=new Ot,m=l?.7:.4,g=l?4:2,x=l?1:.8;d.beginFill(h,m),d.lineStyle(g,h,x),d.drawRoundedRect(-r/2,-n/2,r,n,8),d.endFill(),u.addChild(d);const w=a!=="none"&&s;if(w&&av(s).then(y=>{if(y&&u.parent){const v=new Hn(y);v.anchor.set(.5),v.position.set(0,0);const p=r-16,_=n-16;v.width=p,v.height=_,v.name="spectrogram",u.addChildAt(v,1),console.log(`[Sprite] Added spectrogram to tile: ${s}`)}else y?u.parent||console.warn(`[Sprite] Container removed before sprite could be added: ${s}`):console.error(`[Sprite] Texture null for: ${s}`)}),!w){const y=new Ot;for(let _=0;_<6;_++){const S=-n/2+10+_*10,b=(Math.random()*.4+.4)*r,A=-b/2+(Math.random()-.5)*20;y.beginFill(16777215,.2+Math.random()*.2),y.drawRect(A,S,b,2),y.endFill()}u.addChild(y);const v=new Jt({fontFamily:"Inter, sans-serif",fontSize:18,fill:16777215,fontWeight:"700"}),p=new Ai("?",v);p.anchor.set(.5),p.position.set(0,0),p.alpha=.4,u.addChild(p)}if(o){const y=new Jt({fontFamily:"Inter, sans-serif",fontSize:10,fill:16777215,fontWeight:"700"}),v=new Ai(t.species_code,y);v.anchor.set(.5),v.position.set(r/2-20,-n/2+44),v.alpha=.8;const p=new Ot;p.beginFill(0,.7);const _=3,S=v.width+_*2,b=v.height+_*2;p.drawRoundedRect(-S/2,-b/2,S,b,2),p.endFill(),p.position.set(v.position.x,v.position.y),u.addChild(p),u.addChild(v);const A=`data/icons/${t.species_code}.png`;av(A).then(T=>{if(T&&u.parent){const M=new Hn(T);M.anchor.set(.5),M.width=32,M.height=32,M.position.set(r/2-20,-n/2+20),M.alpha=.9,u.addChild(M)}})}return{container:u,eventId:t.event_id,scheduledTimeMs:t.scheduled_time_ms,enterTimeMs:t.scoring_window_start_ms,channel:t.channel,speciesCode:t.species_code,hasBeenScored:!1,feedbackType:null,feedbackStartTime:0,spectrogramPath:s}}function lv(t,e,r){const n=t.container,i=e==="perfect"||e==="good"?Pt.perfect:e==="partial"?Pt.partial:Pt.miss,s=new Ot,o=100,a=70;if(s.beginFill(i,.5),s.drawRoundedRect(-o/2,-a/2,o,a,8),s.endFill(),n.addChildAt(s,1),r>0){const l=new Jt({fontFamily:"JetBrains Mono, monospace",fontSize:20,fontWeight:"700",fill:i,stroke:0,strokeThickness:3}),u=new Ai(`+${r}`,l);u.anchor.set(.5),u.position.set(0,-a/2-15),n.addChild(u)}n.scale.set(1.1),setTimeout(()=>{n.scale.set(1)},100)}function uv(t,e,r){const n=e/2,i=new Ot;i.beginFill(Pt.background,1),i.drawRect(0,0,n-1,r),i.endFill(),t.stage.addChild(i);const s=new Ot;s.beginFill(Pt.background,1),s.drawRect(n+1,0,n-1,r),s.endFill(),t.stage.addChild(s);const o=new Jt({fontFamily:"Inter, sans-serif",fontSize:14,fill:Pt.textMuted,fontWeight:"600"}),a=new Ai("LEFT",o);a.anchor.set(.5),a.position.set(n/2,30),a.alpha=.5,t.stage.addChild(a);const l=new Ai("RIGHT",o);l.anchor.set(.5),l.position.set(n+n/2,30),l.alpha=.5,t.stage.addChild(l)}function cv(t,e,r){const n=e/2,i=r*Ef,s=4,o=new Ot;o.beginFill(Pt.hitZone,.8),o.drawRect(20,i,n-40,s),o.endFill(),t.stage.addChild(o);const a=new Ot;a.beginFill(Pt.hitZone,.8),a.drawRect(n+20,i,n-40,s),a.endFill(),t.stage.addChild(a);const l=new Ot;l.beginFill(Pt.hitZone,.2),l.drawRect(20,i-2,n-40,s+4),l.endFill(),t.stage.addChild(l);const u=new Ot;u.beginFill(Pt.hitZone,.2),u.drawRect(n+20,i-2,n-40,s+4),u.endFill(),t.stage.addChild(u)}function hv(t,e,r){const n=e/2,i=new Ot,s=20,o=10;let a=0;for(i.beginFill(Pt.surface,.5);a<r;)i.drawRect(n-1,a,2,s),a+=s+o;i.endFill(),t.stage.addChild(i)}const mM=E.memo(fM),mn={SPECIES_CORRECT:50,CHANNEL_CORRECT:25,TIMING_PERFECT:25,TIMING_PARTIAL:10};class gM{constructor(e){dn(this,"panner");this.panner=e.createStereoPanner()}get output(){return this.panner}setPan(e){this.panner.pan.value=Math.max(-1,Math.min(1,e))}disconnect(){this.panner.disconnect()}}class dv{constructor(e){dn(this,"ctx");dn(this,"inputGain");dn(this,"leftGain");dn(this,"rightGain");dn(this,"merger");this.ctx=e,this.inputGain=e.createGain(),this.leftGain=e.createGain(),this.rightGain=e.createGain(),this.merger=e.createChannelMerger(2),this.inputGain.connect(this.leftGain),this.inputGain.connect(this.rightGain),this.leftGain.connect(this.merger,0,0),this.rightGain.connect(this.merger,0,1),this.setPan(0)}get output(){return this.inputGain}get destination(){return this.merger}setPan(e){const n=(Math.max(-1,Math.min(1,e))+1)*Math.PI/4,i=Math.cos(n),s=Math.sin(n);this.leftGain.gain.setValueAtTime(i,this.ctx.currentTime),this.rightGain.gain.setValueAtTime(s,this.ctx.currentTime)}disconnect(){this.inputGain.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.merger.disconnect()}}class yM{constructor(){dn(this,"capabilities");this.capabilities=this.detectCapabilities(),console.log("Audio capabilities:",this.capabilities)}detectCapabilities(){const e=navigator.userAgent,r=/iPad|iPhone|iPod/.test(e)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,n=r&&/CriOS/.test(e),i=r&&/FxiOS/.test(e),s=r&&/EdgiOS/.test(e),o=typeof AudioContext<"u"||typeof window.webkitAudioContext<"u",a=o&&typeof StereoPannerNode<"u"&&!n&&!i&&!s;return{supportsStereoPanner:a,supportsWebAudio:o,isIOSChrome:n,isIOS:r,browserInfo:`iOS: ${r}, Chrome: ${n}, StereoPanner: ${a}`}}getCapabilities(){return{...this.capabilities}}supportsStereoPanner(){return this.capabilities.supportsStereoPanner}isIOSChrome(){return this.capabilities.isIOSChrome}createPanner(e){return this.capabilities.supportsStereoPanner?new gM(e):new dv(e)}createChannelPanner(e,r){const n=this.createPanner(e);return n.setPan(r==="left"?-1:1),n}connectPannerToDestination(e,r){e instanceof dv?e.destination.connect(r):e.output.connect(r)}}let Ph=null;function fv(){return Ph||(Ph=new yM),Ph}const pv={low:100,medium:150,high:200},vM={level_id:1,pack_id:"common_se_birds",mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},xM={NOCA:"#E57373",CARW:"#81C784",BLJA:"#4FC3F7",AMCR:"#424242",TUTI:"#FFD54F",BEKI:"#00BCD4",RSHA:"#8D6E63",AMGO:"#FFEB3B",CACH:"#B0BEC5",PIWA:"#AED581",WTSP:"#BCAAA4",HOFI:"#EF9A9A",EABL:"#64B5F6",AMRO:"#FF8A65",HETH:"#D7CCC8",BHNU:"#A1887F",BRCR:"#8D6E63",WBNU:"#80CBC4",YBSA:"#FFF59D",RBWO:"#CE93D8",DOWO:"#90A4AE",HAWO:"#CFD8DC",NOFL:"#FFCC80",PIWO:"#B39DDB",BRTH:"#A1887F",GRCA:"#78909C",MODO:"#BCAAA4"};function _M(t){let e=t;return()=>(e=e*1103515245+12345&2147483647,e/2147483647)}function wM(t=vM){const e=E.useRef(null),r=E.useRef(new Map),n=E.useRef(new Map),i=E.useRef(new Map),s=E.useRef(new Map),o=E.useRef(new Map),a=E.useRef(null),[l,u]=E.useState([]),[c,h]=E.useState([]),[d,m]=E.useState([]);E.useEffect(()=>{console.log("species state changed, now has",d.length,"species:",d.map(U=>U.code))},[d]);const[g,x]=E.useState("idle"),[w,y]=E.useState(0),[v,p]=E.useState(0),[_,S]=E.useState(t.round_duration_sec),[b,A]=E.useState(0),[T,M]=E.useState(0),[I,W]=E.useState(0),[G,C]=E.useState(0),[N,z]=E.useState(0),[B,k]=E.useState([]),[P,D]=E.useState([]),[R,F]=E.useState(0),Z=E.useRef(1),he=E.useRef(typeof window<"u"&&localStorage.getItem("soundfield_continuous_play")==="true"),[ue,_e]=E.useState(0),xe=5e3,[Re,Je]=E.useState(()=>{const U=pv[t.event_density]||100,re=localStorage.getItem("soundfield_scroll_speed"),se=re?parseFloat(re):.5;return Z.current=se,U*se}),[yt,Be]=E.useState(null),[Te,Ae]=E.useState(!0),Ee=E.useRef(null),ct=E.useRef([]),vt=E.useRef(0),vr=E.useRef([]),Ni=E.useRef(new Set),an=E.useRef(0),rc=E.useRef(0),nc=E.useRef(0),ic=E.useRef(0),sc=E.useRef(0),Fi=E.useRef(0),va=E.useRef([]),oc=E.useRef([]),xa=E.useRef(0),ln=E.useRef(null),bt=E.useRef(null),un=E.useRef({left:null,right:null}),ht=E.useRef({left:null,right:null}),jp=E.useCallback(async()=>{var U;console.log("loadClips called with level:",{pack_id:t.pack_id,species_pool_length:(U=t.species_pool)==null?void 0:U.length,species_count:t.species_count});try{const re=await fetch("/bird-sound-game/data/clips.json");if(!re.ok)throw new Error("Failed to load clips.json");const se=await re.json();u(se);const ee=t.species_pool,ie=ee?new Set(ee):null,te=new Map;for(const le of se)ie&&!ie.has(le.species_code)||te.has(le.species_code)||te.set(le.species_code,{code:le.species_code,name:le.common_name,color:xM[le.species_code]});const de=Array.from(te.values());h(de);const be=sessionStorage.getItem("roundSpecies");if(be)try{const le=JSON.parse(be),ge=de.filter(Fe=>le.includes(Fe.code)).sort((Fe,O)=>Fe.code.localeCompare(O.code));if(ge.length>0){console.log("loadClips: Using pre-selected species:",ge.map(Fe=>Fe.code)),m(ge);return}}catch(le){console.error("Failed to parse pre-selected species in loadClips:",le)}m(de)}catch(re){console.error("Error loading clips:",re)}},[t.species_pool,t.species_count]),Gp=E.useCallback(async()=>{if(e.current){console.log("initializeAudio: Already initialized, setting isAudioReady"),Ae(!0);return}try{const U=fv();console.log("initializeAudio: Browser capabilities:",U.getCapabilities());const re=new AudioContext;e.current=re,console.log("initializeAudio: AudioContext created, state:",re.state),re.state==="suspended"&&(console.log("initializeAudio: AudioContext suspended, attempting resume..."),await re.resume(),console.log("initializeAudio: AudioContext resumed, state:",re.state)),Ae(!0),console.log("initializeAudio: Audio is ready!")}catch(U){console.error("initializeAudio: Failed to initialize audio:",U),Ae(!0)}},[]),ac=E.useCallback(async U=>{const re=e.current;if(!re)throw new Error("Audio context not initialized");const se=r.current.get(U);if(se)return console.log("loadAudioBuffer: Using cached buffer for",U),se;console.log("loadAudioBuffer: Fetching",U);const ee=await fetch(`/bird-sound-game/${U}`);if(!ee.ok)throw console.error("loadAudioBuffer: Fetch failed",ee.status,ee.statusText),new Error(`Failed to load audio: ${U}`);console.log("loadAudioBuffer: Fetch OK, decoding...");const ie=await ee.arrayBuffer();try{const te=await re.decodeAudioData(ie);return console.log("loadAudioBuffer: Decoded OK, duration:",te.duration),r.current.set(U,te),te}catch(te){throw console.error(` DECODE FAILED for ${U}:`,te),console.error("  This file cannot be played in Web Audio API (gameplay)"),console.error("  File size:",ie.byteLength,"bytes"),new Error(`Cannot decode audio file: ${U} - ${te}`)}},[]),zp=E.useCallback(async(U,re,se,ee)=>{const ie=e.current;if(!ie){console.error("playAudio: No AudioContext!");return}console.log("playAudio:",U,"ctx.state:",ie.state);try{ie.state==="suspended"&&(console.log("playAudio: Context suspended, trying to resume..."),await ie.resume());const te=await ac(U);console.log("playAudio: Buffer loaded, duration:",te.duration);const de=fv();console.log("playAudio: Using adapter, capabilities:",de.getCapabilities());const be=ie.createBufferSource(),le=ie.createGain(),ge=de.createChannelPanner(ie,re);le.gain.value=.05,be.buffer=te,be.connect(le),le.connect(ge.output),de.connectPannerToDestination(ge,ie.destination),be.loop=!0,n.current.set(se,be),i.current.set(se,le),s.current.set(se,ge),o.current.set(se,ee),be.onended=()=>{n.current.delete(se),i.current.delete(se);const Fe=s.current.get(se);Fe&&(Fe.disconnect(),s.current.delete(se)),o.current.delete(se)},be.start(),console.log("playAudio: Started playing")}catch(te){console.error(" playAudio FAILED for",U),console.error("   Error:",te),console.error("   This bird will have no audio during gameplay!")}},[ac]),Ws=E.useCallback(U=>{const re=n.current.get(U);if(re)try{re.stop()}catch{}const se=s.current.get(U);se&&se.disconnect(),n.current.delete(U),i.current.delete(U),s.current.delete(U),o.current.delete(U)},[]),Vp=E.useCallback((U,re,se,ee)=>{const ie=re.filter(O=>O.species_code===U&&!O.rejected);if(ie.length===0)return[];const te=ie.filter(O=>O.canonical),de=ie.filter(O=>!O.canonical);if(se==="canonical")return te.length>0?te:ie.slice(0,1);if(se==="all")return ie;const be=se,le=[];te.length>0&&le.push(...te);const ge=[...de];for(let O=ge.length-1;O>0;O--){const Y=Math.floor(ee()*(O+1));[ge[O],ge[Y]]=[ge[Y],ge[O]]}const Fe=be-le.length;return le.push(...ge.slice(0,Fe)),le},[]),$p=E.useCallback(U=>{const re=[],se=Date.now(),ee=_M(se),ie=t.clip_selection??(t.canonical_only?"canonical":"all");let te;if(U&&U.length>0)te=[...U];else if(t.species_pool&&t.species_pool.length>0)te=[...t.species_pool];else{const O=new Set;for(const oe of l)oe.rejected||O.add(oe.species_code);const Y=Array.from(O);for(let oe=Y.length-1;oe>0;oe--){const Se=Math.floor(ee()*(oe+1));[Y[oe],Y[Se]]=[Y[Se],Y[oe]]}te=Y.slice(0,t.species_count)}const de=new Map;for(const O of te){const Y=Vp(O,l,ie,ee);Y.length>0&&de.set(O,Y)}if(te=te.filter(O=>de.has(O)),te.length===0)return console.error("No species with available clips!"),[];console.log("generateEvents:",{clipSelection:ie,selectedSpecies:te,clipsPerSpecies:Object.fromEntries(Array.from(de.entries()).map(([O,Y])=>[O,Y.map(oe=>oe.clip_id)]))});const be=2,le=new Map,Fe=localStorage.getItem("soundfield_continuous_play")==="true"?100:Math.ceil(t.round_duration_sec/2)+5;for(let O=0;O<Fe;O++){const Y=te.filter(Ur=>(de.get(Ur)||[]).some(dt=>(le.get(dt.clip_id)||0)<be));let oe;Y.length>0?oe=Y[Math.floor(ee()*Y.length)]:oe=te[Math.floor(ee()*te.length)];const Se=de.get(oe)||[],Or=Se.filter(Ur=>(le.get(Ur.clip_id)||0)<be);let Tt;if(Or.length>0?Tt=Or[Math.floor(ee()*Or.length)]:Tt=Se.reduce((Ur,Di)=>{const dt=le.get(Ur.clip_id)||0;return(le.get(Di.clip_id)||0)<dt?Di:Ur},Se[0]),!Tt)continue;le.set(Tt.clip_id,(le.get(Tt.clip_id)||0)+1);const Zn=ee()<.5?"left":"right";re.push({event_id:`evt_${O}_${se}`,clip_id:Tt.clip_id,species_code:oe,channel:Zn,scheduled_time_ms:0,scoring_window_start_ms:0,scoring_window_end_ms:0,duration_ms:Tt.duration_ms,vocalization_type:Tt.vocalization_type})}return re},[l,t,Vp]),Hp=E.useCallback(U=>l.find(re=>re.clip_id===U),[l]),tr=E.useCallback(U=>{const re=oc.current,se=xa.current,ee=t.channel_mode||"single",ie=xe/Z.current;if(se>=re.length){ee==="single"?ln.current=null:U&&(un.current[U]=null);return}const te=performance.now(),de=vt.current,be=te-de;if(!he.current&&t.round_duration_sec*1e3-be<2e3){ee==="single"?ln.current=null:U&&(un.current[U]=null);return}const le=re[se];xa.current=se+1;let ge;if(ee==="offset"&&U?ge=U:ge=le.channel,ee==="single")bt.current!==null&&(clearTimeout(bt.current),bt.current=null);else{const dt=ht.current[ge];dt!==null&&(clearTimeout(dt),ht.current[ge]=null)}const Fe=be,O=be+ie,Y={...le,channel:ge,scheduled_time_ms:O,scoring_window_start_ms:Fe,scoring_window_end_ms:O+500};ee==="single"?ln.current=Y.event_id:un.current[ge]=Y.event_id;const oe=Hp(Y.clip_id);if(!oe){console.error("spawnNextEvent: clip not found for clip_id:",Y.clip_id,"species:",Y.species_code),ee==="single"?tr():U&&tr(U);return}vr.current.push(Y);const Se={...Y,spectrogramPath:oe.spectrogram_path||null,filePath:oe.file_path};D(dt=>[...dt,Se]),zp(oe.file_path,ge,Y.event_id,Y.scheduled_time_ms),k(dt=>[...dt,{...Y,isActive:!0,hasBeenScored:!1}]);const Or=ie+500,Tt=Y.event_id,Zn=ge,Ur=Y.species_code,Di=window.setTimeout(()=>{if(ee==="single"){if(ln.current!==Tt)return;bt.current=null}else{if(un.current[Zn]!==Tt)return;ht.current[Zn]=null}Ws(Tt),k(dt=>dt.map(hn=>hn.event_id===Tt?{...hn,isActive:!1}:hn)),k(dt=>{const hn=dt.find(Xs=>Xs.event_id===Tt);if(hn&&!hn.hasBeenScored){z(Li=>Li+1),sc.current+=1,p(0),va.current.push({expectedSpecies:Ur,guessedSpecies:null,channel:Zn});const Xs={id:`miss_${Date.now()}`,type:"miss",score:0,breakdown:{speciesCorrect:!1,channelCorrect:!1,timingAccuracy:"miss",speciesPoints:0,channelPoints:0,timingPoints:0,totalPoints:0},channel:Zn,timestamp:performance.now(),expectedSpecies:Ur};Be(Xs),setTimeout(()=>{Be(Li=>(Li==null?void 0:Li.id)===Xs.id?null:Li)},1500)}return dt}),window.setTimeout(()=>{ee==="single"?tr():tr(Zn)},200)},Or);ee==="single"?bt.current=Di:ht.current[ge]=Di},[Hp,zp,Ws,t.round_duration_sec,t.channel_mode]),Wp=E.useCallback((U,re)=>{if((t.channel_mode||"single")==="single"){if(ln.current!==U)return;bt.current!==null&&(clearTimeout(bt.current),bt.current=null),ln.current=null,Ws(U),tr()}else{if(un.current[re]!==U)return;const ee=ht.current[re];ee!==null&&(clearTimeout(ee),ht.current[re]=null),un.current[re]=null,Ws(U),tr(re)}},[Ws,tr,t.channel_mode]),Xp=E.useCallback(async()=>{console.log("initialize: Starting...");try{await Promise.all([jp().catch(U=>console.error("initialize: loadClips failed:",U)),Gp().catch(U=>console.error("initialize: initializeAudio failed:",U))])}catch(U){console.error("initialize: Failed:",U)}Ae(!0),console.log("initialize: Complete, isAudioReady forced to true")},[jp,Gp]),Yp=E.useCallback(async()=>{if(console.log("startRound called, roundState:",g,"clips.length:",l.length),g!=="idle"||l.length===0)return;let U=e.current;if(U||(U=new AudioContext,e.current=U,console.log("AudioContext created during tap")),U.state==="suspended")try{await U.resume(),console.log("AudioContext resumed, state:",U.state)}catch(O){console.error("Failed to resume AudioContext:",O)}try{const O="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAYYoRwmHAAAAAAD/+1DEAAAHAAGf9AAAIgAANIAAAARMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7UMQbA8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",Y=new Audio(O);Y.volume=.01,await Y.play(),console.log("HTML5 silent audio played to unlock iOS audio session")}catch(O){console.error("Failed to play HTML5 silent audio:",O)}console.log("AudioContext state:",U.state),Ae(!0);const re=pv[t.event_density]||100,se=localStorage.getItem("soundfield_scroll_speed"),ee=se?parseFloat(se):.5;Z.current=ee,Je(re*ee),y(0),p(0),A(0),M(0),W(0),C(0),z(0),k([]),D([]),Be(null),S(t.round_duration_sec),Ni.current.clear(),an.current=0,rc.current=0,nc.current=0,ic.current=0,sc.current=0,Fi.current=0,va.current=[],vr.current=[];let ie;console.log("startRound: allPoolSpecies.length =",c.length,"species_count =",t.species_count);const te=sessionStorage.getItem("roundSpecies");if(te)try{const O=JSON.parse(te);sessionStorage.removeItem("roundSpecies");const Y=O.filter(oe=>c.some(Se=>Se.code===oe));if(Y.length>0){const oe=c.filter(Se=>Y.includes(Se.code)).sort((Se,Or)=>Se.code.localeCompare(Or.code));console.log("Using pre-selected species:",oe.map(Se=>Se.code)),m(oe),ie=oe.map(Se=>Se.code)}}catch(O){console.error("Failed to parse pre-selected species:",O),sessionStorage.removeItem("roundSpecies")}if(!ie)if(t.species_count&&c.length>t.species_count){const O=[...c];for(let oe=O.length-1;oe>0;oe--){const Se=Math.floor(Math.random()*(oe+1));[O[oe],O[Se]]=[O[Se],O[oe]]}const Y=O.slice(0,t.species_count).sort((oe,Se)=>oe.code.localeCompare(Se.code));console.log("Random selection: setting species to",Y.length,"species:",Y.map(oe=>oe.code)),m(Y),ie=Y.map(oe=>oe.code)}else console.log("Using all pool species:",c.length),m(c),ie=c.map(O=>O.code);const de=$p(ie);oc.current=de,xa.current=0;const be=[...new Set(de.map(O=>O.clip_id))];console.log("Preloading",be.length,"audio clips during tap gesture...");const le=be.map(async O=>{const Y=l.find(oe=>oe.clip_id===O);if(Y)try{await ac(Y.file_path)}catch(oe){console.error("Failed to preload clip:",O,oe)}});await Promise.all(le),console.log("Audio preloading complete"),ln.current=null,bt.current!==null&&(clearTimeout(bt.current),bt.current=null),un.current={left:null,right:null},ht.current.left!==null&&clearTimeout(ht.current.left),ht.current.right!==null&&clearTimeout(ht.current.right),ht.current={left:null,right:null};const ge=performance.now();if(x("playing"),F(ge),vt.current=ge,(t.channel_mode||"single")==="single")tr();else{tr("left");const Y=window.setTimeout(()=>{tr("right")},1500);ct.current.push(Y)}if(he.current=localStorage.getItem("soundfield_continuous_play")==="true",he.current)S(0),Ee.current=window.setInterval(()=>{S(O=>O+1)},1e3);else{Ee.current=window.setInterval(()=>{S(Y=>Y<=1?(cn(),0):Y-1)},1e3);const O=window.setTimeout(()=>{cn()},t.round_duration_sec*1e3);ct.current.push(O)}},[g,l.length,t.round_duration_sec,t.channel_mode,t.species_count,c,$p,tr]),cn=E.useCallback(()=>{x("ended"),Ee.current&&(clearInterval(Ee.current),Ee.current=null),bt.current!==null&&(clearTimeout(bt.current),bt.current=null),ln.current=null,ht.current.left!==null&&clearTimeout(ht.current.left),ht.current.right!==null&&clearTimeout(ht.current.right),ht.current={left:null,right:null},un.current={left:null,right:null};for(const ee of ct.current)clearTimeout(ee);ct.current=[];for(const ee of n.current.values())try{ee.stop()}catch{}for(const ee of s.current.values())ee.disconnect();n.current.clear(),i.current.clear(),s.current.clear(),o.current.clear();const U={};for(const ee of vr.current){const ie=ee.species_code;U[ie]||(U[ie]={total:0,correct:0}),U[ie].total++,Ni.current.has(ee.event_id)&&U[ie].correct++}const re=Ni.current.size,se={score:rc.current,eventsScored:re,totalEvents:vr.current.length,speciesCorrect:nc.current,channelCorrect:ic.current,perfectCount:an.current,missCount:sc.current,maxStreak:Fi.current,speciesResults:U,species:d.map(ee=>({code:ee.code,name:ee.name})),mode:t.mode,packId:t.pack_id,levelId:t.level_id,levelTitle:t.title,confusionData:va.current};localStorage.setItem("soundfield_round_results",JSON.stringify(se))},[d,t.mode,t.pack_id,t.level_id,t.title]),Kp=E.useCallback((U,re,se,ee)=>{const ie=re===U.species_code,te=se===U.channel,de=U.scheduled_time_ms,be=U.scoring_window_start_ms,le=de-be,ge=de-ee,Fe=Math.max(0,Math.min(1,ge/le));let O;Fe>=.5?O="perfect":(Fe>=.25,O="partial");const Y=ie?mn.SPECIES_CORRECT:0,oe=ie&&te?mn.CHANNEL_CORRECT:0;let Se=0;ie&&te&&(Fe>=.75?Se=mn.TIMING_PERFECT:Fe>=.5&&(Se=mn.TIMING_PARTIAL));const Or=Y+oe+Se;return{speciesPoints:Y,channelPoints:oe,timingPoints:Se,totalPoints:Or,speciesCorrect:ie,channelCorrect:te,timingAccuracy:O}},[]),qp=E.useCallback((U,re)=>{if(g!=="playing")return;const se=performance.now(),ee=se-vt.current,ie=t.channel_mode||"single",te=B.find(O=>!(O.hasBeenScored||ee<O.scoring_window_start_ms||ee>O.scoring_window_end_ms||ie==="offset"&&O.channel!==re));if(!te)return;const de=Kp(te,U,re,ee);va.current.push({expectedSpecies:te.species_code,guessedSpecies:U,channel:te.channel}),de.speciesCorrect&&Ni.current.add(te.event_id),Wp(te.event_id,te.channel),k(O=>O.map(Y=>Y.event_id===te.event_id?{...Y,hasBeenScored:!0}:Y)),y(O=>O+de.totalPoints),rc.current+=de.totalPoints,A(O=>O+1),de.speciesCorrect&&(M(O=>O+1),nc.current+=1),de.channelCorrect&&(W(O=>O+1),ic.current+=1);const be=mn.SPECIES_CORRECT+mn.CHANNEL_CORRECT;de.totalPoints===be?(C(O=>O+1),an.current+=1,p(O=>{const Y=O+1;return Fi.current=Math.max(Fi.current,Y),Y})):de.totalPoints>0?p(O=>{const Y=O+1;return Fi.current=Math.max(Fi.current,Y),Y}):p(0);let le;const ge=mn.SPECIES_CORRECT+mn.CHANNEL_CORRECT;de.totalPoints===ge?le="perfect":de.speciesCorrect&&de.channelCorrect?le="good":de.speciesCorrect?le="partial":le="miss";const Fe={id:`feedback_${Date.now()}`,type:le,score:de.totalPoints,breakdown:de,channel:te.channel,timestamp:se,expectedSpecies:le==="miss"?te.species_code:void 0};Be(Fe),setTimeout(()=>{Be(O=>(O==null?void 0:O.id)===Fe.id?null:O)},le==="miss"?1500:500)},[g,B,Kp,Wp,t.channel_mode]),Zp=E.useCallback(()=>{cn(),x("idle"),y(0),p(0),A(0),M(0),W(0),C(0),z(0),k([]),D([]),F(0),Be(null),S(t.round_duration_sec)},[cn,t.round_duration_sec]);E.useEffect(()=>{if(g!=="playing"){a.current&&(cancelAnimationFrame(a.current),a.current=null);return}const U=()=>{var ee;const re=performance.now()-vt.current,se=xe/Z.current;for(const[ie,te]of i.current.entries()){const de=o.current.get(ie);if(de===void 0)continue;const be=de-re,ge=.05+Math.max(0,Math.min(1,1-be/se))*.95;te.gain.setValueAtTime(ge,((ee=e.current)==null?void 0:ee.currentTime)||0)}a.current=requestAnimationFrame(U)};return a.current=requestAnimationFrame(U),()=>{a.current&&cancelAnimationFrame(a.current)}},[g]),E.useEffect(()=>()=>{Ee.current&&clearInterval(Ee.current),a.current&&cancelAnimationFrame(a.current);for(const U of ct.current)clearTimeout(U);for(const U of n.current.values())try{U.stop()}catch{}},[]),E.useEffect(()=>{if(g!=="playing"||!he.current)return;const U=oc.current.length,re=xa.current;U>0&&re>=U&&B.length===0&&(console.log("Continuous mode: all events processed, ending round"),cn())},[g,b,N,B.length,cn]);const U1={roundState:g,score:w,streak:v,timeRemaining:_,totalTime:t.round_duration_sec,eventsScored:b,speciesCorrect:T,channelCorrect:I,perfectCount:G,missCount:N,activeEvents:B,scheduledEvents:P,roundStartTime:R,scrollSpeed:Re,currentFeedback:yt,species:d,isAudioReady:Te},j1=E.useMemo(()=>({initialize:Xp,startRound:Yp,endRound:cn,submitInput:qp,reset:Zp}),[Xp,Yp,cn,qp,Zp]);return[U1,j1]}function mv({code:t,size:e=32,color:r}){const[n,i]=E.useState(!0),s=`/bird-sound-game/data/icons/${t}.png`;return f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[n&&f.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?f.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>i(!1)}):f.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"transparent",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.35,fontWeight:700},children:t})]})}const gv=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F"],SM={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function EM(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function bM(t){return t>=4?"offset":"single"}const yv={campaign:{mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},practice:{mode:"practice",round_duration_sec:60,species_count:3,event_density:"low",overlap_probability:0,scoring_window_ms:3e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},challenge:{mode:"challenge",round_duration_sec:60,species_count:8,event_density:"medium",overlap_probability:0,scoring_window_ms:1500,spectrogram_mode:"fading",clip_selection:"all",channel_mode:"offset"},random:{mode:"random",round_duration_sec:45,species_count:6,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"all",channel_mode:"single"}};function TM(){const t=er(),[e]=Sp(),r=E.useRef(null),[n,i]=E.useState({width:400,height:400}),[s,o]=E.useState(null),[a,l]=E.useState(null),[u,c]=E.useState([]),[h,d]=E.useState(()=>localStorage.getItem("soundfield_training_mode")==="true"),m=E.useRef(!1),g=E.useMemo(()=>localStorage.getItem("soundfield_spectrogram_mode")||"full",[]),x=E.useMemo(()=>localStorage.getItem("soundfield_high_contrast")==="true",[]);E.useEffect(()=>{localStorage.setItem("soundfield_training_mode",String(h)),h&&(m.current=!0)},[h]);const w=e.get("mode")||"campaign",y=e.get("pack")||"common_se_birds",v=parseInt(e.get("level")||"1",10);E.useEffect(()=>{console.log("Fetching levels.json..."),fetch("/bird-sound-game/data/levels.json").then(B=>B.json()).then(B=>{console.log("Loaded",B.length,"levels from levels.json"),c(B)}).catch(B=>{console.error("Failed to load levels.json:",B)})},[]);const p=E.useMemo(()=>{var k;if(console.log("levelConfig useMemo: mode =",w,"packId =",y,"campaignLevels.length =",u.length),y==="custom"){let P=[];try{const D=sessionStorage.getItem("roundSpecies");if(D)P=JSON.parse(D);else{const R=localStorage.getItem("soundfield_custom_pack");R&&(P=JSON.parse(R),sessionStorage.setItem("roundSpecies",R))}}catch(D){console.error("Failed to parse custom species:",D)}return console.log("Custom pack: using species:",P,"for level",v),{level_id:v,pack_id:"custom",mode:"campaign",title:SM[v]||`Level ${v}`,round_duration_sec:30,species_count:P.length,species_pool:P,clip_selection:EM(v),channel_mode:bM(v),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:g}}if(w==="campaign"&&u.length>0){const P=u.find(R=>R.pack_id===y&&R.level_id===v);if(P)return console.log("Found level from levels.json:",P.pack_id,P.title,"species_pool:",(k=P.species_pool)==null?void 0:k.length),{...P,spectrogram_mode:g};const D=u.find(R=>R.pack_id===y);return D?(console.log("Using first level for pack:",D.pack_id,D.title),{...D,spectrogram_mode:g}):(console.log("Ultimate fallback to first level"),{...u[0],spectrogram_mode:g})}console.log("Using hardcoded MODE_CONFIGS (no campaign levels loaded yet)");const B=yv[w]||yv.campaign;return{level_id:1,pack_id:y,...B,spectrogram_mode:g}},[w,y,v,u,g]),[_,S]=wM(p),b=E.useRef(null);E.useEffect(()=>{var P;if(w==="campaign"&&u.length===0&&y!=="custom"){console.log("Waiting for levels.json to load...");return}const B=((P=p.species_pool)==null?void 0:P.length)??"none",k=`${p.pack_id}-${p.level_id}-${B}`;console.log("Init effect: key =",k,"lastKey =",b.current),b.current!==k&&(b.current=k,console.log("Initializing for",k),S.initialize())},[w,u.length,p.pack_id,p.level_id,p.species_pool,S]),E.useEffect(()=>{const B=()=>{if(r.current){const k=r.current.getBoundingClientRect();i({width:k.width,height:k.height})}};return B(),window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]);const A=E.useRef(S);A.current=S;const T=E.useRef(_.roundState);T.current=_.roundState,E.useEffect(()=>()=>{T.current==="playing"&&A.current.reset()},[]);const M=E.useMemo(()=>localStorage.getItem("soundfield_continuous_play")==="true",[]),I=_.species.map((B,k)=>({code:B.code,name:B.name,color:B.color||gv[k%gv.length]})),W=E.useCallback(B=>{o(B);const k=document.getElementById(`flash-${B}`);k&&(k.classList.add("active"),setTimeout(()=>k.classList.remove("active"),150)),a&&(S.submitInput(a,B),o(null),l(null))},[a,S]),G=E.useCallback(B=>{l(B),s&&(S.submitInput(B,s),o(null),l(null))},[s,S]);E.useEffect(()=>{const B=k=>{if(_.roundState==="playing"){if(k.key==="a"||k.key==="A"||k.key==="ArrowLeft"||k.key==="1")W("left");else if(k.key==="d"||k.key==="D"||k.key==="ArrowRight"||k.key==="2")W("right");else if(k.key>="3"&&k.key<="9"){const P=parseInt(k.key)-3;P<I.length&&G(I[P].code)}}};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[_.roundState,W,G,I]);const C=E.useCallback(()=>{S.reset(),t("/")},[t,S]),N=E.useCallback(()=>{console.log("handleStart clicked, isAudioReady:",_.isAudioReady,"species.length:",_.species.length),_.isAudioReady&&_.species.length>0?(console.log("Calling startRound..."),m.current=h,S.startRound()):console.log("Not calling startRound - conditions not met")},[_.isAudioReady,_.species.length,S,h]),z=E.useCallback(()=>{S.endRound();try{const B=localStorage.getItem("soundfield_round_results");if(B){const k=JSON.parse(B);k.usedTrainingMode=m.current,localStorage.setItem("soundfield_round_results",JSON.stringify(k))}}catch(B){console.error("Failed to update results with training mode flag:",B)}t("/summary",{replace:!0})},[t,S]);return E.useEffect(()=>{if(_.roundState==="ended"){try{const B=localStorage.getItem("soundfield_round_results");if(B){const k=JSON.parse(B);k.usedTrainingMode=m.current,localStorage.setItem("soundfield_round_results",JSON.stringify(k))}}catch(B){console.error("Failed to update results with training mode flag:",B)}t("/summary",{replace:!0})}},[_.roundState,t]),f.jsxs("div",{className:"gameplay-screen",children:[f.jsx(oT,{score:_.score,streak:_.streak,timeRemaining:_.timeRemaining,mode:w,levelId:p.level_id,levelTitle:p.title}),f.jsx("button",{className:"back-button",onClick:C,"aria-label":"Back to menu",children:f.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{d:"M15 18l-6-6 6-6"})})}),f.jsx("button",{className:`training-toggle ${h?"active":""}`,onClick:()=>{const B=!h;d(B),Rb(B)},"aria-label":h?"Disable training mode":"Enable training mode",title:h?"Training Mode ON - Icons visible":"Training Mode OFF",children:f.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:h?f.jsxs(f.Fragment,{children:[f.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),f.jsx("circle",{cx:"12",cy:"12",r:"3"})]}):f.jsxs(f.Fragment,{children:[f.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),f.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]})})}),M&&_.roundState==="playing"&&f.jsx("button",{className:"end-round-button",onClick:z,"aria-label":"End round",children:"End Round"}),f.jsxs("div",{ref:r,className:"game-container",children:[f.jsx(mM,{width:n.width,height:n.height,scheduledEvents:_.scheduledEvents,activeEvents:_.activeEvents,roundStartTime:_.roundStartTime,roundState:_.roundState,scrollSpeed:_.scrollSpeed,currentFeedback:_.currentFeedback,onChannelTap:W,trainingMode:h,spectrogramMode:p.spectrogram_mode,highContrast:x}),f.jsx("div",{id:"flash-left",className:"channel-flash left"}),f.jsx("div",{id:"flash-right",className:"channel-flash right"}),s&&f.jsx("div",{className:`channel-indicator ${s}`,children:s.toUpperCase()}),_.roundState==="idle"&&f.jsx("div",{className:"start-overlay",children:f.jsx("button",{className:"start-button",onClick:N,disabled:!_.isAudioReady||_.species.length===0,children:_.isAudioReady&&_.species.length>0?"Start Round":"Loading..."})}),_.currentFeedback&&f.jsxs("div",{className:`feedback-overlay ${_.currentFeedback.type} ${_.currentFeedback.channel}`,children:[f.jsxs("div",{className:"feedback-score",children:["+",_.currentFeedback.score]}),f.jsx("div",{className:"feedback-type",children:_.currentFeedback.type.toUpperCase()}),_.currentFeedback.type==="miss"&&_.currentFeedback.expectedSpecies&&f.jsxs("div",{className:"feedback-correct",children:["Was: ",_.currentFeedback.expectedSpecies]})]})]}),f.jsxs("div",{className:"dual-input-panel",children:[f.jsxs("div",{className:"input-column left",children:[f.jsx("div",{className:"column-label",children:"LEFT EAR"}),f.jsx("div",{className:"species-buttons",children:I.map(B=>f.jsx("button",{className:`species-btn ${a===B.code?"selected":""}`,style:{backgroundColor:a===B.code?B.color:void 0},onClick:()=>{S.submitInput(B.code,"left");const k=document.getElementById("flash-left");k&&(k.classList.add("active"),setTimeout(()=>k.classList.remove("active"),150))},disabled:_.roundState!=="playing",children:f.jsx(mv,{code:B.code,size:36,color:B.color})},B.code))})]}),f.jsxs("div",{className:"input-column right",children:[f.jsx("div",{className:"column-label",children:"RIGHT EAR"}),f.jsx("div",{className:"species-buttons",children:I.map(B=>f.jsx("button",{className:`species-btn ${a===B.code?"selected":""}`,style:{backgroundColor:a===B.code?B.color:void 0},onClick:()=>{S.submitInput(B.code,"right");const k=document.getElementById("flash-right");k&&(k.classList.add("active"),setTimeout(()=>k.classList.remove("active"),150))},disabled:_.roundState!=="playing",children:f.jsx(mv,{code:B.code,size:36,color:B.color})},B.code))})]})]}),f.jsx("style",{children:`
        .gameplay-screen {
          display: flex;
          flex-direction: column;
          height: 100%;
          background-color: var(--color-background);
          overflow: hidden;
        }

        .back-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 8px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-text);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .back-button:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .training-toggle {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 56px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: 2px solid transparent;
          border-radius: 50%;
          color: var(--color-text-muted);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: all 0.2s;
        }

        .training-toggle:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .training-toggle.active {
          background: rgba(76, 175, 80, 0.3);
          border-color: rgba(76, 175, 80, 0.6);
          color: #81C784;
        }

        .end-round-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 12px;
          padding: 8px 16px;
          background: rgba(229, 115, 115, 0.8);
          border: none;
          border-radius: 20px;
          color: white;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          z-index: 100;
          transition: background 0.2s;
        }

        .end-round-button:hover {
          background: rgba(229, 115, 115, 1);
        }

        .game-container {
          flex: 1;
          position: relative;
          min-height: 0;
          overflow: hidden;
        }

        .channel-flash {
          position: absolute;
          top: 0;
          bottom: 0;
          width: 50%;
          pointer-events: none;
          background: transparent;
          transition: background 0.1s;
        }

        .channel-flash.left {
          left: 0;
        }

        .channel-flash.right {
          right: 0;
        }

        .channel-flash.active {
          background: rgba(255, 255, 255, 0.1);
        }

        .channel-indicator {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 8px 16px;
          background: var(--color-accent);
          color: var(--color-background);
          font-weight: 700;
          font-size: 14px;
          border-radius: 4px;
          pointer-events: none;
          animation: fadeIn 0.15s ease-out;
        }

        .channel-indicator.left {
          left: 20px;
        }

        .channel-indicator.right {
          right: 20px;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-50%) scale(0.9);
          }
          to {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
        }

        .start-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(0, 0, 0, 0.7);
          z-index: 50;
        }

        .start-button {
          padding: 16px 32px;
          font-size: 18px;
          font-weight: 700;
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: transform 0.2s, background 0.2s;
        }

        .start-button:hover:not(:disabled) {
          transform: scale(1.05);
          background: var(--color-accent);
        }

        .start-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .feedback-overlay {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 12px 20px;
          border-radius: 8px;
          pointer-events: none;
          animation: feedbackPop 0.5s ease-out forwards;
          z-index: 60;
        }

        .feedback-overlay.left {
          left: 20%;
        }

        .feedback-overlay.right {
          right: 20%;
        }

        .feedback-overlay.perfect {
          background: var(--color-success);
        }

        .feedback-overlay.good {
          background: #4CAF50;
        }

        .feedback-overlay.partial {
          background: var(--color-accent);
        }

        .feedback-overlay.miss {
          background: var(--color-error);
          animation: feedbackPopMiss 1.5s ease-out forwards;
        }

        .feedback-score {
          font-family: var(--font-mono);
          font-size: 24px;
          font-weight: 700;
          color: white;
          text-align: center;
        }

        .feedback-type {
          font-size: 12px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          text-align: center;
        }

        .feedback-correct {
          font-size: 14px;
          font-weight: 700;
          color: white;
          text-align: center;
          margin-top: 4px;
          padding-top: 4px;
          border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes feedbackPop {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          20% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          40% {
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-80%) scale(1);
          }
        }

        @keyframes feedbackPopMiss {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          5% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          10% {
            transform: translateY(-50%) scale(1);
          }
          85% {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-70%) scale(1);
          }
        }

        .dual-input-panel {
          display: flex;
          justify-content: space-between;
          padding: 8px 12px;
          padding-bottom: calc(12px + var(--safe-area-bottom, 0px));
          background: linear-gradient(0deg, var(--color-surface) 0%, rgba(26, 26, 46, 0.9) 100%);
          gap: 20px;
        }

        .input-column {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }

        .input-column.left {
          align-items: flex-start;
        }

        .input-column.right {
          align-items: flex-end;
        }

        .column-label {
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          padding: 2px 8px;
          border-radius: 4px;
        }

        .input-column.left .column-label {
          color: #81C784;
          background: rgba(129, 199, 132, 0.15);
        }

        .input-column.right .column-label {
          color: #64B5F6;
          background: rgba(100, 181, 246, 0.15);
        }

        .species-buttons {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
        }

        .input-column.left .species-buttons {
          justify-content: flex-start;
        }

        .input-column.right .species-buttons {
          justify-content: flex-end;
        }

        .species-btn {
          padding: 6px;
          border-radius: 12px;
          border: 2px solid var(--color-text-muted);
          background: var(--color-surface);
          color: var(--color-text);
          font-size: 10px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.15s ease-out;
          touch-action: manipulation;
          -webkit-tap-highlight-color: transparent;
        }

        .species-btn:hover:not(:disabled) {
          transform: scale(1.1);
        }

        .species-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .species-btn.selected {
          color: var(--color-background);
          transform: scale(1.05);
        }

        .species-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }
      `})]})}const vv=6;function AM(){const t=er(),[e,r]=E.useState(null),[n,i]=E.useState([]),[s,o]=E.useState([]),[a,l]=E.useState(!1);E.useEffect(()=>{var _;const p=localStorage.getItem("soundfield_round_results");if(p)try{const S=JSON.parse(p);if(r(S),S.mode==="campaign"&&S.levelId){const A="soundfield_progress",T=JSON.parse(localStorage.getItem(A)||"{}"),M=`level_${S.levelId}`,I=((_=T[M])==null?void 0:_.bestScore)||0;T[M]={completed:!0,bestScore:Math.max(I,S.score),accuracy:S.totalEvents>0?Math.round(S.eventsScored/S.totalEvents*100):0},localStorage.setItem(A,JSON.stringify(T))}const b=[];for(const A of S.species){const T=S.speciesResults[A.code]||{total:0,correct:0};T.total>0&&b.push({code:A.code,name:A.name,total:T.total,correct:T.correct,accuracy:Math.round(T.correct/T.total*100)})}if(b.sort((A,T)=>A.accuracy-T.accuracy),i(b),S.confusionData&&S.confusionData.length>0){const A=new Map;for(const M of S.confusionData){if(M.guessedSpecies===M.expectedSpecies)continue;const I=`${M.expectedSpecies}|${M.guessedSpecies??"MISS"}`;A.set(I,(A.get(I)||0)+1)}const T=[];for(const[M,I]of A.entries()){const[W,G]=M.split("|");T.push({expectedSpecies:W,guessedSpecies:G==="MISS"?null:G,count:I})}T.sort((M,I)=>I.count-M.count),o(T)}}catch(S){console.error("Failed to parse round results:",S)}},[]);const u=e&&e.totalEvents>0?Math.round(e.eventsScored/e.totalEvents*100):0,c=(e==null?void 0:e.mode)==="campaign",h=(e==null?void 0:e.levelId)||1,d=(e==null?void 0:e.packId)||"starter_birds",m=h>1,g=h<vv,x=p=>{if(e!=null&&e.species){const _=e.species.map(S=>S.code);sessionStorage.setItem("roundSpecies",JSON.stringify(_))}t(`/preview?pack=${d}&level=${p}&keepBirds=true`)},w=()=>{t(`/level-select?pack=${d}`)},y=()=>{t("/pack-select")},v=()=>{t("/")};return f.jsxs("div",{className:"screen",style:{paddingTop:"32px",paddingBottom:"calc(24px + var(--safe-area-bottom, 0px))"},children:[f.jsx("h1",{style:{textAlign:"center",marginBottom:"8px"},children:"ROUND COMPLETE"}),c&&f.jsxs("p",{className:"text-muted",style:{textAlign:"center",marginBottom:"16px"},children:["Level ",h,": ",(e==null?void 0:e.levelTitle)||"Campaign"]}),f.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[f.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[f.jsx("span",{children:"Score"}),f.jsx("span",{className:"text-accent",style:{fontFamily:"var(--font-mono)",fontSize:"24px"},children:(e==null?void 0:e.score)||0})]}),f.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[f.jsx("span",{children:"Birds Identified"}),f.jsxs("span",{children:[(e==null?void 0:e.eventsScored)||0," / ",(e==null?void 0:e.totalEvents)||0]})]}),f.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[f.jsx("span",{children:"Overall Accuracy"}),f.jsxs("span",{className:u>=70?"text-success":u>=50?"text-accent":"text-error",children:[u,"%"]})]}),f.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[f.jsx("span",{children:"Perfect Hits"}),f.jsx("span",{className:"text-success",children:(e==null?void 0:e.perfectCount)||0})]}),f.jsxs("div",{className:"flex-row justify-between",children:[f.jsx("span",{children:"Best Streak"}),f.jsx("span",{children:(e==null?void 0:e.maxStreak)||0})]}),(e==null?void 0:e.usedTrainingMode)&&f.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid var(--color-surface)",fontSize:"13px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[f.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),f.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"Training Mode was used"]})]}),n.length>0&&f.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[f.jsx("h3",{style:{marginBottom:"12px"},children:"Species Breakdown"}),n.map(p=>f.jsxs("div",{style:{marginBottom:"12px"},children:[f.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[f.jsxs("span",{style:{fontSize:"14px"},children:[p.code," ",f.jsxs("span",{className:"text-muted",children:["(",p.name,")"]})]}),f.jsxs("span",{style:{fontSize:"14px"},children:[p.correct,"/",p.total," (",p.accuracy,"%)"]})]}),f.jsx("div",{style:{height:"8px",backgroundColor:"var(--color-background)",borderRadius:"4px",overflow:"hidden"},children:f.jsx("div",{style:{width:`${p.accuracy}%`,height:"100%",backgroundColor:p.accuracy>=80?"var(--color-success)":p.accuracy>=50?"var(--color-accent)":"var(--color-error)",borderRadius:"4px",transition:"width 0.3s ease"}})})]},p.code))]}),s.length>0&&f.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[f.jsx("h3",{style:{marginBottom:"12px"},children:"Confusion Summary"}),s.map((p,_)=>f.jsx("div",{style:{marginBottom:"8px",fontSize:"14px"},children:p.guessedSpecies===null?f.jsxs("span",{children:["Missed ",f.jsx("span",{className:"text-accent",children:p.expectedSpecies}),": ",p.count,"x"]}):f.jsxs("span",{children:[f.jsx("span",{className:"text-accent",children:p.expectedSpecies}),"  ",f.jsx("span",{className:"text-error",children:p.guessedSpecies}),": ",p.count,"x"]})},_))]}),f.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto"},children:[c&&f.jsxs("div",{className:"flex-row gap-md",style:{marginBottom:"12px"},children:[f.jsxs("button",{className:"btn-secondary",onClick:()=>x(h-1),disabled:!m,style:{flex:1,opacity:m?1:.4},children:[f.jsx(CM,{})," Prev"]}),f.jsxs("button",{className:"btn-secondary",onClick:()=>l(!a),style:{flex:1},children:["Level ",h,"/",vv]}),f.jsxs("button",{className:"btn-secondary",onClick:()=>x(h+1),disabled:!g,style:{flex:1,opacity:g?1:.4},children:["Next ",f.jsx(RM,{})]})]}),a&&f.jsxs("div",{className:"card",style:{marginBottom:"12px",padding:"12px"},children:[f.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginBottom:"8px"},children:"Jump to level:"}),f.jsx("div",{className:"flex-row",style:{flexWrap:"wrap",gap:"8px"},children:[1,2,3,4,5,6].map(p=>f.jsx("button",{onClick:()=>{l(!1),x(p)},style:{width:"40px",height:"40px",borderRadius:"8px",border:p===h?"2px solid var(--color-accent)":"1px solid var(--color-text-muted)",background:p===h?"var(--color-accent)":"var(--color-surface)",color:p===h?"var(--color-background)":"var(--color-text)",fontWeight:600,cursor:"pointer"},children:p},p))})]}),f.jsxs("div",{className:"flex-col gap-md",children:[f.jsx("button",{className:"btn-primary",onClick:()=>x(h),style:{width:"100%"},children:"Play Again"}),f.jsxs("div",{className:"flex-row gap-md",children:[f.jsx("button",{className:"btn-secondary",onClick:w,style:{flex:1},children:"Levels"}),f.jsx("button",{className:"btn-secondary",onClick:y,style:{flex:1},children:"Packs"}),f.jsx("button",{className:"btn-secondary",onClick:v,style:{flex:1},children:"Home"})]})]})]})]})}function CM(){return f.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"4px"},children:f.jsx("path",{d:"M15 18l-6-6 6-6"})})}function RM(){return f.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"4px"},children:f.jsx("path",{d:"M9 18l6-6-6-6"})})}const gn={SCROLL_SPEED:"soundfield_scroll_speed",SPECTROGRAM_MODE:"soundfield_spectrogram_mode",HIGH_CONTRAST:"soundfield_high_contrast",CONTINUOUS_PLAY:"soundfield_continuous_play"};function PM(){const t=er(),[e,r]=E.useState(()=>localStorage.getItem(gn.SPECTROGRAM_MODE)||"full"),[n,i]=E.useState(()=>{const u=localStorage.getItem(gn.SCROLL_SPEED);return u?parseFloat(u):.5}),[s,o]=E.useState(()=>localStorage.getItem(gn.HIGH_CONTRAST)==="true"),[a,l]=E.useState(()=>localStorage.getItem(gn.CONTINUOUS_PLAY)==="true");return E.useEffect(()=>{localStorage.setItem(gn.SPECTROGRAM_MODE,e)},[e]),E.useEffect(()=>{localStorage.setItem(gn.SCROLL_SPEED,n.toString())},[n]),E.useEffect(()=>{localStorage.setItem(gn.HIGH_CONTRAST,s.toString())},[s]),E.useEffect(()=>{localStorage.setItem(gn.CONTINUOUS_PLAY,a.toString())},[a]),f.jsxs("div",{className:"screen",children:[f.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[f.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:f.jsx(IM,{})}),f.jsx("h2",{style:{margin:0},children:"Settings"})]}),f.jsxs("div",{className:"flex-col gap-lg",children:[f.jsxs("div",{className:"card",children:[f.jsx("h3",{children:"Spectrogram Mode"}),f.jsx("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:"Visual difficulty setting"}),f.jsx("div",{className:"flex-row gap-sm",children:["full","fading","none"].map(u=>f.jsx("button",{className:e===u?"btn-primary":"btn-secondary",onClick:()=>r(u),style:{flex:1,textTransform:"capitalize"},children:u},u))})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{children:"Scroll Speed"}),f.jsxs("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:["How fast tiles move: ",n.toFixed(1),"x"]}),f.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:n,onChange:u=>i(parseFloat(u.target.value)),style:{width:"100%"}})]}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex-row justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h3",{style:{marginBottom:"4px"},children:"High Contrast"}),f.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Enhanced visibility"})]}),f.jsx("button",{className:s?"btn-primary":"btn-secondary",onClick:()=>o(!s),style:{width:"60px"},children:s?"ON":"OFF"})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex-row justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h3",{style:{marginBottom:"4px"},children:"Continuous Play"}),f.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"No timer - play until all clips done"})]}),f.jsx("button",{className:a?"btn-primary":"btn-secondary",onClick:()=>l(!a),style:{width:"60px"},children:a?"ON":"OFF"})]})}),f.jsx("div",{className:"card",children:f.jsx("button",{className:"btn-secondary",style:{width:"100%",color:"var(--color-error)"},children:"Reset All Progress"})})]})]})}function IM(){return f.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{d:"M15 18l-6-6 6-6"})})}const al=[{code:"NOCA",name:"Northern Cardinal",accuracy:92,attempts:45},{code:"BLJA",name:"Blue Jay",accuracy:88,attempts:38},{code:"CARW",name:"Carolina Wren",accuracy:76,attempts:29},{code:"AMCR",name:"American Crow",accuracy:95,attempts:22},{code:"TUTI",name:"Tufted Titmouse",accuracy:71,attempts:18}];function kM(){const t=er(),e=Math.round(al.reduce((r,n)=>r+n.accuracy,0)/al.length);return f.jsxs("div",{className:"screen",children:[f.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[f.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:f.jsx(MM,{})}),f.jsx("h2",{style:{margin:0},children:"Progress"})]}),f.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"linear-gradient(135deg, rgba(245, 166, 35, 0.15) 0%, rgba(245, 166, 35, 0.05) 100%)",border:"2px solid var(--color-accent)",borderRadius:"12px",textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:700,color:"var(--color-accent)",marginBottom:"4px"},children:" Coming Soon! "}),f.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.4},children:"Real stats tracking is in development. The data below is a preview of what's coming!"})]}),f.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[f.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Demo Data"}),f.jsxs("div",{className:"flex-row justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Overall Accuracy"}),f.jsxs("div",{style:{fontSize:"32px",fontWeight:700},className:"text-success",children:[e,"%"]})]}),f.jsxs("div",{style:{textAlign:"right"},children:[f.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Total Attempts"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:600},children:al.reduce((r,n)=>r+n.attempts,0)})]})]})]}),f.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[f.jsx("h3",{style:{margin:0},children:"This Session"}),f.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),f.jsxs("div",{className:"flex-row justify-between",style:{marginTop:"12px"},children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Rounds"}),f.jsx("div",{style:{fontSize:"20px"},children:"5"})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Score"}),f.jsx("div",{style:{fontSize:"20px"},className:"text-accent",children:"12,450"})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Best Streak"}),f.jsx("div",{style:{fontSize:"20px"},children:"18"})]})]})]}),f.jsxs("div",{className:"card",style:{opacity:.7},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h3",{style:{margin:0},children:"Species Accuracy"}),f.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),al.map(r=>f.jsxs("div",{style:{marginBottom:"12px"},children:[f.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[f.jsxs("span",{style:{fontSize:"14px"},children:[r.code," ",f.jsxs("span",{className:"text-muted",children:["(",r.attempts,")"]})]}),f.jsxs("span",{style:{fontSize:"14px"},className:r.accuracy>=80?"text-success":r.accuracy>=60?"text-accent":"text-error",children:[r.accuracy,"%"]})]}),f.jsx("div",{style:{height:"6px",backgroundColor:"var(--color-background)",borderRadius:"3px",overflow:"hidden"},children:f.jsx("div",{style:{width:`${r.accuracy}%`,height:"100%",backgroundColor:r.accuracy>=80?"var(--color-success)":r.accuracy>=60?"var(--color-accent)":"var(--color-error)",borderRadius:"3px"}})})]},r.code))]}),f.jsx("div",{className:"card",style:{marginTop:"24px",opacity:.7},children:f.jsx("button",{className:"btn-secondary",style:{width:"100%",cursor:"not-allowed"},disabled:!0,children:"View Confusion Matrix (Coming Soon)"})})]})}function MM(){return f.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{d:"M15 18l-6-6 6-6"})})}function BM(){const t=er();return f.jsxs("div",{className:"screen",style:{paddingBottom:"32px"},children:[f.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[f.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:f.jsx(NM,{})}),f.jsx("h2",{style:{margin:0},children:"How to Play"})]}),f.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[f.jsxs(Vt,{title:"Why Learn Bird Song?",children:[f.jsxs("p",{style:{marginBottom:"12px"},children:["Birds are ",f.jsx("em",{children:"heard"})," way more often than they're ",f.jsx("em",{children:"seen"}),". Once you know the songs, you'll know what to look for - and suddenly your backyard becomes way more interesting."]}),f.jsxs("p",{style:{marginBottom:"12px"},children:[f.jsx("strong",{children:"Why the left/right thing?"}),` It feels like a hearing test because that's birding! In the field, you're constantly triangulating: "Cardinal to my left, chickadee to my right, warbler... somewhere up there?" This game mimics that chaos. Plus, training your ears to separate simultaneous sounds - like a pianist controlling both hands independently - dramatically sharpens your birding skills.`]}),f.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[f.jsx("strong",{children:"Need real-time ID?"})," Get Cornell's free ",f.jsx("a",{href:"https://merlin.allaboutbirds.org/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"Merlin app"}),` - it's magic for "what bird is that singing `,f.jsx("em",{children:"right now"}),'?"']})]}),f.jsxs(Vt,{title:"The Basics",children:[f.jsx("p",{style:{marginBottom:"12px"},children:f.jsx("strong",{children:"Listen. Identify. Tap."})}),f.jsx("p",{style:{marginBottom:"12px"},children:"Bird sounds play through your left or right ear. Identify which bird is singing and tap its circle on the correct side before the tile passes the scoring zone."}),f.jsx("p",{children:"Each round is 30 seconds. Use headphones for the best experience - unless you want everyone to know you're a bird nerd!"})]}),f.jsxs(Vt,{title:"Scoring",children:[f.jsx(ll,{label:"Perfect",points:100,description:"Right bird + right ear + great timing",color:"var(--color-success)"}),f.jsx(ll,{label:"Good",points:75,description:"Right bird + right ear",color:"var(--color-success)"}),f.jsx(ll,{label:"Partial",points:25,description:"Right bird, wrong ear",color:"var(--color-accent)"}),f.jsx(ll,{label:"Miss",points:0,description:"Wrong bird or no response",color:"var(--color-error)"})]}),f.jsxs(Vt,{title:"The Packs",children:[f.jsx(Hi,{name:"Common Eastern US Backyard Birds",description:"Perfect for beginners. Five distinctive birds you'll hear in your own backyard: Cardinal, Carolina Wren, Titmouse, Blue Jay, and Crow."}),f.jsx(Hi,{name:"Expanded Eastern US Birds",description:"39 species from the eastern US. Nine birds are selected randomly, and you can shuffle for a new set anytime from the preview screen."}),f.jsx(Hi,{name:"Sparrows",description:"Master the subtle singers! Eight sparrow species with distinctive patterns: White-throated, Song, Chipping, Swamp, Savannah, Field, Lincoln's, and White-crowned."}),f.jsx(Hi,{name:"Woodpeckers",description:"Drums, rattles, and calls. Learn seven species: Downy, Hairy, Red-bellied, Pileated, Yellow-bellied Sapsucker, Northern Flicker, and Red-headed."}),f.jsx(Hi,{name:"Western Backyard Birds",description:"14 common backyard species from western North America: Steller's Jay, Western Scrub-Jay, Black-capped Chickadee, White-crowned Sparrow, Cassin's Finch, Pine Siskin, Evening Grosbeak, and more."}),f.jsx(Hi,{name:"Warbler Academy",description:"For experts! 33 wood-warbler species with their high-pitched, buzzy songs. Nine warblers are selected randomly - shuffle for a new set anytime."})]}),f.jsxs(Vt,{title:"The Levels",children:[f.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Each pack has 6 levels that build your skills:"}),f.jsx(Wi,{level:1,title:"Meet the Birds",description:"One clear recording per bird, single ear. Learn each signature voice."}),f.jsx(Wi,{level:2,title:"Sound Variations",description:"Up to 3 recordings per bird. Same species, different songs."}),f.jsx(Wi,{level:3,title:"Full Repertoire",description:"All recordings in play. Master every variation."}),f.jsx(Wi,{level:4,title:"Both Ears",description:"Sounds from either side. Identify the bird AND the direction."}),f.jsx(Wi,{level:5,title:"Variations + Both Ears",description:"Multiple recordings, either ear. Getting challenging!"}),f.jsx(Wi,{level:6,title:"Master Birder",description:"Everything at once. You're a pro now."})]}),f.jsxs(Vt,{title:"Tips",children:[f.jsx(Xi,{children:"Start with the 5 common birds, even if you're eager for more."}),f.jsx(Xi,{children:"Use Bird Reference on the Pack Select screen to preview all sounds included in the game."}),f.jsx(Xi,{children:"Your birds stay the same between rounds. Hit the shuffle button on the preview screen for a fresh set."}),f.jsx(Xi,{children:"Don't rush. Let the sound register before you tap."}),f.jsx(Xi,{children:"Check the round summary and confusion matrix to see which birds need practice."}),f.jsx(Xi,{children:"Adjust tile speed in Settings if things move too fast (or too slow). Once you're an expert, try playing muted using only spectrograms!"})]}),f.jsxs(Vt,{title:"Training Mode",children:[f.jsxs("p",{children:["Toggle the ",f.jsx("strong",{children:"eye icon"})," (next to the back button) during gameplay to enable Training Mode."]}),f.jsx("p",{children:"When active, each tile shows its bird icon and species code alongside the spectrogram. Use this to learn which spectrograms belong to which birds, then toggle off to challenge yourself!"}),f.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[f.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(76, 175, 80, 0.3)",border:"2px solid rgba(76, 175, 80, 0.6)",borderRadius:"50%",color:"#81C784"},children:f.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[f.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),f.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),f.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Eye icon glows green when Training Mode is ON"})]})]}),f.jsxs(Vt,{title:"The 4-Letter Codes",children:[f.jsx("p",{children:`Birders use standardized 4-letter codes (called "Alpha codes") as shorthand for species names. They're easy to learn:`}),f.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"8px",fontSize:"14px",lineHeight:1.6},children:[f.jsxs("div",{children:[f.jsx("strong",{children:"Two-word names:"})," First 2 letters of each word"]}),f.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Northern Cardinal  NO + CA  NOCA"}),f.jsxs("div",{style:{marginTop:"8px"},children:[f.jsx("strong",{children:"Three-word names:"})," 1 + 1 + 2 letters"]}),f.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Red-bellied Woodpecker  R + B + WO  RBWO"})]})]}),f.jsxs(Vt,{title:"The Spectrograms",children:[f.jsx("p",{children:"The colorful images on tiles are spectrograms - visual pictures of sound. Time flows left to right, pitch goes bottom to top, and brightness shows volume."}),f.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"14px"},children:"With practice, you'll recognize birds by their visual patterns too!"})]}),f.jsx(Vt,{title:"Sound Credits",children:f.jsxs("p",{style:{fontSize:"14px"},children:["Recordings sourced from ",f.jsx("a",{href:"https://xeno-canto.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"Xeno-canto"}),", ",f.jsx("a",{href:"https://www.birds.cornell.edu/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"Cornell Lab of Ornithology"}),", and user contributed recordings. All sounds have been curated for quality and educational value."]})}),f.jsxs(Vt,{title:"About",children:[f.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:["Made with  and  by Peter Repetti",f.jsx("br",{}),"AI pair programming by Claude",f.jsx("br",{}),"Icon design by Peter Repetti, Claude and ChatGPT"]}),f.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginTop:"12px"},children:[f.jsx("strong",{children:"The Tech:"})," Built by Claude Code with TypeScript, React, and PixiJS for buttery-smooth scrolling spectrograms. The Web Audio API handles sample-accurate playback with real-time stereo panning - your browser decodes and buffers audio into memory for zero-latency triggering. Vite bundles it all into a PWA (Progressive Web App) that caches sounds as you play them - so load up those birds before your flight to New Zealand takes off ."]})]}),f.jsxs(Vt,{title:"Version History",children:[f.jsx(Yi,{version:"3.16",date:"January 16, 2026",children:f.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Bird Reference enhancement:"})," Separated display species (39) from gameplay rotation (27) for Expanded Eastern US Birds pack - Bird Reference now shows all available species for preview"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UI improvements:"})," Streamlined pack selection tips, improved Help page tips with confusion matrix mention"]})]})}),f.jsx(Yi,{version:"3.15",date:"January 16, 2026",children:f.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Xeno-canto attribution:"})," All Xeno-canto recordings now display recordist names for legal compliance (355 recordings attributed to 87+ contributors)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Help page enhancements:"}),' Added "Why Learn Bird Song?" section explaining the educational value of left/right audio training, tech details about PWA offline caching']}),f.jsxs("li",{children:[f.jsx("strong",{children:"Audio curation:"})," Extensive clip review and quality improvements - refined canonical clips, updated vocalization types (call/song/drum), removed low-quality recordings"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UI improvements:"}),' Moved shuffle button above bird grid for better visibility, added "Coming Soon" banner to Stats screen to clarify demo data']}),f.jsxs("li",{children:[f.jsx("strong",{children:"New bird icons:"})," Added icons for upcoming Macaulay species (ACFL, EAPH, EWPE, WEVI)"]})]})}),f.jsx(Yi,{version:"3.14",date:"January 15, 2026",children:f.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Analytics:"})," Added Google Analytics 4 tracking for usage insights (page views, pack/level selections, Training Mode adoption)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Data fixes:"})," Restored BCCH, MODO, and WBNU clips lost during Cornell CD processing"]})]})}),f.jsx(Yi,{version:"3.13",date:"January 15, 2026",children:f.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Western Backyard Birds pack:"})," 14 new species including Steller's Jay, Western Scrub-Jay, Black-capped Chickadee, and more. Fixed to use 9 random birds per round."]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Audio improvements:"})," Restored canonical clips for 71+ species, resolved 202 broken audio references, cleaned up duplicate EATO clips (115)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UI refinements:"})," Black backgrounds on Training Mode labels for better readability, Warbler Academy icon updated to Blackburnian Warbler, improved loading indicators"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Bird Reference enhancements:"})," Collapsible packs with expand/collapse controls, source badges (Xeno-canto, Cornell, contributors), pack cards with representative bird icons"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Fixed blank spectrograms"})," (async texture loading), added pull-to-refresh on main menu, audio preloading on preview screen"]}),f.jsx("li",{children:"Added White-crowned Sparrow to Sparrows pack (now 8 species)"})]})}),f.jsx(Yi,{version:"2.0",date:"January 12, 2026",children:f.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[f.jsx("li",{children:"Rebranded to ChipNotes! with Owl Professor mascot"}),f.jsx("li",{children:"Training Mode: Toggle eye icon to show bird labels on tiles"}),f.jsx("li",{children:"Warbler Academy pack: 33 wood-warbler species for experts"}),f.jsx("li",{children:"Complete icon set: Hand-illustrated icons for all 91+ species"}),f.jsx("li",{children:"Added Eastern Towhee to Expanded Backyard pack"}),f.jsx("li",{children:"Birds now persist between rounds by default"}),f.jsx("li",{children:"Fixed scoring to allow full 100 points as documented"}),f.jsx("li",{children:"iOS audio improvements and playback fixes"})]})}),f.jsx(Yi,{version:"1.0",date:"January 11, 2026",children:f.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[f.jsx("li",{children:"Initial release with 6 bird packs"}),f.jsx("li",{children:"Pre-round preview screen to hear and see birds before playing"}),f.jsx("li",{children:"Custom pack builder for targeted practice"}),f.jsx("li",{children:"Continuous play mode (untimed, relaxed practice)"}),f.jsx("li",{children:"Enhanced round summary with per-species breakdown"}),f.jsx("li",{children:"Progressive difficulty: 6 levels per pack"}),f.jsx("li",{children:"Real spectrograms for visual learning"}),f.jsx("li",{children:"PWA support for offline play and mobile installation"})]})})]})]})]})}function Vt({title:t,children:e}){return f.jsxs("div",{style:{marginBottom:"28px"},children:[f.jsx("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"12px",color:"var(--color-accent)",borderBottom:"1px solid var(--color-surface)",paddingBottom:"8px"},children:t}),f.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,color:"var(--color-text)"},children:e})]})}function ll({label:t,points:e,description:r,color:n}){return f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[f.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:n,minWidth:"40px"},children:["+",e]}),f.jsxs("div",{children:[f.jsx("span",{style:{fontWeight:600},children:t}),f.jsx("span",{style:{color:"var(--color-text-muted)",marginLeft:"8px",fontSize:"13px"},children:r})]})]})}function Hi({name:t,description:e}){return f.jsxs("div",{style:{marginBottom:"12px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px"},children:[f.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:t}),f.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:e})]})}function Wi({level:t,title:e,description:r}){return f.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[f.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:"var(--color-accent)",minWidth:"24px"},children:t}),f.jsxs("div",{children:[f.jsx("span",{style:{fontWeight:600},children:e}),f.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:r})]})]})}function Xi({children:t}){return f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px"},children:[f.jsx("span",{style:{color:"var(--color-accent)"},children:""}),f.jsx("span",{children:t})]})}function Yi({version:t,date:e,children:r}){return f.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"8px",marginBottom:"8px"},children:[f.jsxs("span",{style:{fontWeight:700,fontSize:"16px",color:"var(--color-accent)"},children:["v",t]}),f.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:e})]}),r]})}function NM(){return f.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{d:"M15 18l-6-6 6-6"})})}function FM(){return f.jsxs(ub,{children:[f.jsx(sr,{path:"/",element:f.jsx(Sb,{})}),f.jsx(sr,{path:"/pack-select",element:f.jsx(Ib,{})}),f.jsx(sr,{path:"/level-select",element:f.jsx(jb,{})}),f.jsx(sr,{path:"/preview",element:f.jsx(Yb,{})}),f.jsx(sr,{path:"/custom-pack",element:f.jsx(Jb,{})}),f.jsx(sr,{path:"/gameplay",element:f.jsx(TM,{})}),f.jsx(sr,{path:"/summary",element:f.jsx(AM,{})}),f.jsx(sr,{path:"/settings",element:f.jsx(PM,{})}),f.jsx(sr,{path:"/progress",element:f.jsx(kM,{})}),f.jsx(sr,{path:"/help",element:f.jsx(BM,{})})]})}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{for(const e of t)e.unregister()});Ih.createRoot(document.getElementById("root")).render(f.jsx(Pv.StrictMode,{children:f.jsx(yb,{basename:"/bird-sound-game/",children:f.jsx(FM,{})})}));
