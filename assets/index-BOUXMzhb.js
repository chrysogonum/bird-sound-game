var JT=Object.defineProperty;var QT=(t,e,r)=>e in t?JT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Zn=(t,e,r)=>QT(t,typeof e!="symbol"?e+"":e,r);function eC(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function tC(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var E1={exports:{}},vu={},T1={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pl=Symbol.for("react.element"),rC=Symbol.for("react.portal"),nC=Symbol.for("react.fragment"),iC=Symbol.for("react.strict_mode"),sC=Symbol.for("react.profiler"),oC=Symbol.for("react.provider"),aC=Symbol.for("react.context"),lC=Symbol.for("react.forward_ref"),cC=Symbol.for("react.suspense"),dC=Symbol.for("react.memo"),uC=Symbol.for("react.lazy"),Wx=Symbol.iterator;function hC(t){return t===null||typeof t!="object"?null:(t=Wx&&t[Wx]||t["@@iterator"],typeof t=="function"?t:null)}var C1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A1=Object.assign,k1={};function Wo(t,e,r){this.props=t,this.context=e,this.refs=k1,this.updater=r||C1}Wo.prototype.isReactComponent={};Wo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function I1(){}I1.prototype=Wo.prototype;function Jm(t,e,r){this.props=t,this.context=e,this.refs=k1,this.updater=r||C1}var Qm=Jm.prototype=new I1;Qm.constructor=Jm;A1(Qm,Wo.prototype);Qm.isPureReactComponent=!0;var Vx=Array.isArray,R1=Object.prototype.hasOwnProperty,eg={current:null},P1={key:!0,ref:!0,__self:!0,__source:!0};function j1(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)R1.call(e,n)&&!P1.hasOwnProperty(n)&&(i[n]=e[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:Pl,type:t,key:s,ref:o,props:i,_owner:eg.current}}function pC(t,e){return{$$typeof:Pl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function tg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Pl}function fC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Xx=/\/+/g;function lh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fC(""+t.key):e.toString(36)}function Kc(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Pl:case rC:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+lh(o,0):n,Vx(i)?(r="",t!=null&&(r=t.replace(Xx,"$&/")+"/"),Kc(i,e,r,"",function(d){return d})):i!=null&&(tg(i)&&(i=pC(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Xx,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",Vx(t))for(var l=0;l<t.length;l++){s=t[l];var c=n+lh(s,l);o+=Kc(s,e,r,c,i)}else if(c=hC(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=n+lh(s,l++),o+=Kc(s,e,r,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ql(t,e,r){if(t==null)return t;var n=[],i=0;return Kc(t,n,"","",function(s){return e.call(r,s,i++)}),n}function mC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Qt={current:null},qc={transition:null},gC={ReactCurrentDispatcher:Qt,ReactCurrentBatchConfig:qc,ReactCurrentOwner:eg};function M1(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:ql,forEach:function(t,e,r){ql(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return ql(t,function(){e++}),e},toArray:function(t){return ql(t,function(e){return e})||[]},only:function(t){if(!tg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fe.Component=Wo;Fe.Fragment=nC;Fe.Profiler=sC;Fe.PureComponent=Jm;Fe.StrictMode=iC;Fe.Suspense=cC;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gC;Fe.act=M1;Fe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=A1({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=eg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)R1.call(e,c)&&!P1.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:Pl,type:t.type,key:i,ref:s,props:n,_owner:o}};Fe.createContext=function(t){return t={$$typeof:aC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:oC,_context:t},t.Consumer=t};Fe.createElement=j1;Fe.createFactory=function(t){var e=j1.bind(null,t);return e.type=t,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(t){return{$$typeof:lC,render:t}};Fe.isValidElement=tg;Fe.lazy=function(t){return{$$typeof:uC,_payload:{_status:-1,_result:t},_init:mC}};Fe.memo=function(t,e){return{$$typeof:dC,type:t,compare:e===void 0?null:e}};Fe.startTransition=function(t){var e=qc.transition;qc.transition={};try{t()}finally{qc.transition=e}};Fe.unstable_act=M1;Fe.useCallback=function(t,e){return Qt.current.useCallback(t,e)};Fe.useContext=function(t){return Qt.current.useContext(t)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(t){return Qt.current.useDeferredValue(t)};Fe.useEffect=function(t,e){return Qt.current.useEffect(t,e)};Fe.useId=function(){return Qt.current.useId()};Fe.useImperativeHandle=function(t,e,r){return Qt.current.useImperativeHandle(t,e,r)};Fe.useInsertionEffect=function(t,e){return Qt.current.useInsertionEffect(t,e)};Fe.useLayoutEffect=function(t,e){return Qt.current.useLayoutEffect(t,e)};Fe.useMemo=function(t,e){return Qt.current.useMemo(t,e)};Fe.useReducer=function(t,e,r){return Qt.current.useReducer(t,e,r)};Fe.useRef=function(t){return Qt.current.useRef(t)};Fe.useState=function(t){return Qt.current.useState(t)};Fe.useSyncExternalStore=function(t,e,r){return Qt.current.useSyncExternalStore(t,e,r)};Fe.useTransition=function(){return Qt.current.useTransition()};Fe.version="18.3.1";T1.exports=Fe;var w=T1.exports;const N1=Zm(w),xC=eC({__proto__:null,default:N1},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yC=w,vC=Symbol.for("react.element"),_C=Symbol.for("react.fragment"),bC=Object.prototype.hasOwnProperty,wC=yC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SC={key:!0,ref:!0,__self:!0,__source:!0};function B1(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)bC.call(e,n)&&!SC.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:vC,type:t,key:s,ref:o,props:i,_owner:wC.current}}vu.Fragment=_C;vu.jsx=B1;vu.jsxs=B1;E1.exports=vu;var a=E1.exports,$p={},D1={exports:{}},_r={},L1={exports:{}},F1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,I){var D=L.length;L.push(I);e:for(;0<D;){var C=D-1>>>1,A=L[C];if(0<i(A,I))L[C]=I,L[D]=A,D=C;else break e}}function r(L){return L.length===0?null:L[0]}function n(L){if(L.length===0)return null;var I=L[0],D=L.pop();if(D!==I){L[0]=D;e:for(var C=0,A=L.length,O=A>>>1;C<O;){var H=2*(C+1)-1,pe=L[H],ie=H+1,V=L[ie];if(0>i(pe,D))ie<A&&0>i(V,pe)?(L[C]=V,L[ie]=D,C=ie):(L[C]=pe,L[H]=D,C=H);else if(ie<A&&0>i(V,D))L[C]=V,L[ie]=D,C=ie;else break e}}return I}function i(L,I){var D=L.sortIndex-I.sortIndex;return D!==0?D:L.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,f=!1,m=!1,_=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(L){for(var I=r(d);I!==null;){if(I.callback===null)n(d);else if(I.startTime<=L)n(d),I.sortIndex=I.expirationTime,e(c,I);else break;I=r(d)}}function b(L){if(_=!1,g(L),!m)if(r(c)!==null)m=!0,N(S);else{var I=r(d);I!==null&&P(b,I.startTime-L)}}function S(L,I){m=!1,_&&(_=!1,x(T),T=-1),f=!0;var D=p;try{for(g(I),h=r(c);h!==null&&(!(h.expirationTime>I)||L&&!F());){var C=h.callback;if(typeof C=="function"){h.callback=null,p=h.priorityLevel;var A=C(h.expirationTime<=I);I=t.unstable_now(),typeof A=="function"?h.callback=A:h===r(c)&&n(c),g(I)}else n(c);h=r(c)}if(h!==null)var O=!0;else{var H=r(d);H!==null&&P(b,H.startTime-I),O=!1}return O}finally{h=null,p=D,f=!1}}var j=!1,E=null,T=-1,B=5,M=-1;function F(){return!(t.unstable_now()-M<B)}function U(){if(E!==null){var L=t.unstable_now();M=L;var I=!0;try{I=E(!0,L)}finally{I?k():(j=!1,E=null)}}else j=!1}var k;if(typeof v=="function")k=function(){v(U)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,z=R.port2;R.port1.onmessage=U,k=function(){z.postMessage(null)}}else k=function(){y(U,0)};function N(L){E=L,j||(j=!0,k())}function P(L,I){T=y(function(){L(t.unstable_now())},I)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,N(S))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(L){switch(p){case 1:case 2:case 3:var I=3;break;default:I=p}var D=p;p=I;try{return L()}finally{p=D}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,I){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var D=p;p=L;try{return I()}finally{p=D}},t.unstable_scheduleCallback=function(L,I,D){var C=t.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?C+D:C):D=C,L){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=D+A,L={id:u++,callback:I,priorityLevel:L,startTime:D,expirationTime:A,sortIndex:-1},D>C?(L.sortIndex=D,e(d,L),r(c)===null&&L===r(d)&&(_?(x(T),T=-1):_=!0,P(b,D-C))):(L.sortIndex=A,e(c,L),m||f||(m=!0,N(S))),L},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(L){var I=p;return function(){var D=p;p=I;try{return L.apply(this,arguments)}finally{p=D}}}})(F1);L1.exports=F1;var EC=L1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TC=w,vr=EC;function Y(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var O1=new Set,nl={};function Es(t,e){Io(t,e),Io(t+"Capture",e)}function Io(t,e){for(nl[t]=e,t=0;t<e.length;t++)O1.add(e[t])}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gp=Object.prototype.hasOwnProperty,CC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yx={},Kx={};function AC(t){return Gp.call(Kx,t)?!0:Gp.call(Yx,t)?!1:CC.test(t)?Kx[t]=!0:(Yx[t]=!0,!1)}function kC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function IC(t,e,r,n){if(e===null||typeof e>"u"||kC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function er(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ot[t]=new er(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ot[e]=new er(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ot[t]=new er(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ot[t]=new er(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ot[t]=new er(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ot[t]=new er(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ot[t]=new er(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ot[t]=new er(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ot[t]=new er(t,5,!1,t.toLowerCase(),null,!1,!1)});var rg=/[\-:]([a-z])/g;function ng(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rg,ng);Ot[e]=new er(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rg,ng);Ot[e]=new er(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rg,ng);Ot[e]=new er(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ot[t]=new er(t,1,!1,t.toLowerCase(),null,!1,!1)});Ot.xlinkHref=new er("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ot[t]=new er(t,1,!1,t.toLowerCase(),null,!0,!0)});function ig(t,e,r,n){var i=Ot.hasOwnProperty(e)?Ot[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(IC(e,r,i,n)&&(r=null),n||i===null?AC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Kn=TC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zl=Symbol.for("react.element"),Js=Symbol.for("react.portal"),Qs=Symbol.for("react.fragment"),sg=Symbol.for("react.strict_mode"),Hp=Symbol.for("react.profiler"),U1=Symbol.for("react.provider"),z1=Symbol.for("react.context"),og=Symbol.for("react.forward_ref"),Wp=Symbol.for("react.suspense"),Vp=Symbol.for("react.suspense_list"),ag=Symbol.for("react.memo"),si=Symbol.for("react.lazy"),$1=Symbol.for("react.offscreen"),qx=Symbol.iterator;function da(t){return t===null||typeof t!="object"?null:(t=qx&&t[qx]||t["@@iterator"],typeof t=="function"?t:null)}var at=Object.assign,ch;function Aa(t){if(ch===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);ch=e&&e[1]||""}return`
`+ch+t}var dh=!1;function uh(t,e){if(!t||dh)return"";dh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{dh=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Aa(t):""}function RC(t){switch(t.tag){case 5:return Aa(t.type);case 16:return Aa("Lazy");case 13:return Aa("Suspense");case 19:return Aa("SuspenseList");case 0:case 2:case 15:return t=uh(t.type,!1),t;case 11:return t=uh(t.type.render,!1),t;case 1:return t=uh(t.type,!0),t;default:return""}}function Xp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qs:return"Fragment";case Js:return"Portal";case Hp:return"Profiler";case sg:return"StrictMode";case Wp:return"Suspense";case Vp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case z1:return(t.displayName||"Context")+".Consumer";case U1:return(t._context.displayName||"Context")+".Provider";case og:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ag:return e=t.displayName||null,e!==null?e:Xp(t.type)||"Memo";case si:e=t._payload,t=t._init;try{return Xp(t(e))}catch{}}return null}function PC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xp(e);case 8:return e===sg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ki(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function G1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function jC(t){var e=G1(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Jl(t){t._valueTracker||(t._valueTracker=jC(t))}function H1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=G1(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ed(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yp(t,e){var r=e.checked;return at({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Zx(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ki(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function W1(t,e){e=e.checked,e!=null&&ig(t,"checked",e,!1)}function Kp(t,e){W1(t,e);var r=ki(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?qp(t,e.type,r):e.hasOwnProperty("defaultValue")&&qp(t,e.type,ki(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Jx(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function qp(t,e,r){(e!=="number"||Ed(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ka=Array.isArray;function po(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ki(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Zp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Y(91));return at({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Qx(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Y(92));if(ka(r)){if(1<r.length)throw Error(Y(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ki(r)}}function V1(t,e){var r=ki(e.value),n=ki(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function ey(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function X1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?X1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ql,Y1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ql=Ql||document.createElement("div"),Ql.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ql.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function il(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var $a={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MC=["Webkit","ms","Moz","O"];Object.keys($a).forEach(function(t){MC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$a[e]=$a[t]})});function K1(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||$a.hasOwnProperty(t)&&$a[t]?(""+e).trim():e+"px"}function q1(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=K1(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var NC=at({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qp(t,e){if(e){if(NC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Y(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Y(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Y(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Y(62))}}function ef(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tf=null;function lg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var rf=null,fo=null,mo=null;function ty(t){if(t=Nl(t)){if(typeof rf!="function")throw Error(Y(280));var e=t.stateNode;e&&(e=Eu(e),rf(t.stateNode,t.type,e))}}function Z1(t){fo?mo?mo.push(t):mo=[t]:fo=t}function J1(){if(fo){var t=fo,e=mo;if(mo=fo=null,ty(t),e)for(t=0;t<e.length;t++)ty(e[t])}}function Q1(t,e){return t(e)}function eb(){}var hh=!1;function tb(t,e,r){if(hh)return t(e,r);hh=!0;try{return Q1(t,e,r)}finally{hh=!1,(fo!==null||mo!==null)&&(eb(),J1())}}function sl(t,e){var r=t.stateNode;if(r===null)return null;var n=Eu(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Y(231,e,typeof r));return r}var nf=!1;if(Gn)try{var ua={};Object.defineProperty(ua,"passive",{get:function(){nf=!0}}),window.addEventListener("test",ua,ua),window.removeEventListener("test",ua,ua)}catch{nf=!1}function BC(t,e,r,n,i,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(u){this.onError(u)}}var Ga=!1,Td=null,Cd=!1,sf=null,DC={onError:function(t){Ga=!0,Td=t}};function LC(t,e,r,n,i,s,o,l,c){Ga=!1,Td=null,BC.apply(DC,arguments)}function FC(t,e,r,n,i,s,o,l,c){if(LC.apply(this,arguments),Ga){if(Ga){var d=Td;Ga=!1,Td=null}else throw Error(Y(198));Cd||(Cd=!0,sf=d)}}function Ts(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function rb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ry(t){if(Ts(t)!==t)throw Error(Y(188))}function OC(t){var e=t.alternate;if(!e){if(e=Ts(t),e===null)throw Error(Y(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return ry(i),t;if(s===n)return ry(i),e;s=s.sibling}throw Error(Y(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(Y(189))}}if(r.alternate!==n)throw Error(Y(190))}if(r.tag!==3)throw Error(Y(188));return r.stateNode.current===r?t:e}function nb(t){return t=OC(t),t!==null?ib(t):null}function ib(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ib(t);if(e!==null)return e;t=t.sibling}return null}var sb=vr.unstable_scheduleCallback,ny=vr.unstable_cancelCallback,UC=vr.unstable_shouldYield,zC=vr.unstable_requestPaint,mt=vr.unstable_now,$C=vr.unstable_getCurrentPriorityLevel,cg=vr.unstable_ImmediatePriority,ob=vr.unstable_UserBlockingPriority,Ad=vr.unstable_NormalPriority,GC=vr.unstable_LowPriority,ab=vr.unstable_IdlePriority,_u=null,xn=null;function HC(t){if(xn&&typeof xn.onCommitFiberRoot=="function")try{xn.onCommitFiberRoot(_u,t,void 0,(t.current.flags&128)===128)}catch{}}var Kr=Math.clz32?Math.clz32:XC,WC=Math.log,VC=Math.LN2;function XC(t){return t>>>=0,t===0?32:31-(WC(t)/VC|0)|0}var ec=64,tc=4194304;function Ia(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function kd(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=Ia(l):(s&=o,s!==0&&(n=Ia(s)))}else o=r&~i,o!==0?n=Ia(o):s!==0&&(n=Ia(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Kr(e),i=1<<r,n|=t[r],e&=~i;return n}function YC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Kr(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=YC(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function of(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function lb(){var t=ec;return ec<<=1,!(ec&4194240)&&(ec=64),t}function ph(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function jl(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kr(e),t[e]=r}function qC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Kr(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function dg(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Kr(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var He=0;function cb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var db,ug,ub,hb,pb,af=!1,rc=[],yi=null,vi=null,_i=null,ol=new Map,al=new Map,li=[],ZC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function iy(t,e){switch(t){case"focusin":case"focusout":yi=null;break;case"dragenter":case"dragleave":vi=null;break;case"mouseover":case"mouseout":_i=null;break;case"pointerover":case"pointerout":ol.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":al.delete(e.pointerId)}}function ha(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Nl(e),e!==null&&ug(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function JC(t,e,r,n,i){switch(e){case"focusin":return yi=ha(yi,t,e,r,n,i),!0;case"dragenter":return vi=ha(vi,t,e,r,n,i),!0;case"mouseover":return _i=ha(_i,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return ol.set(s,ha(ol.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,al.set(s,ha(al.get(s)||null,t,e,r,n,i)),!0}return!1}function fb(t){var e=ss(t.target);if(e!==null){var r=Ts(e);if(r!==null){if(e=r.tag,e===13){if(e=rb(r),e!==null){t.blockedOn=e,pb(t.priority,function(){ub(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=lf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);tf=n,r.target.dispatchEvent(n),tf=null}else return e=Nl(r),e!==null&&ug(e),t.blockedOn=r,!1;e.shift()}return!0}function sy(t,e,r){Zc(t)&&r.delete(e)}function QC(){af=!1,yi!==null&&Zc(yi)&&(yi=null),vi!==null&&Zc(vi)&&(vi=null),_i!==null&&Zc(_i)&&(_i=null),ol.forEach(sy),al.forEach(sy)}function pa(t,e){t.blockedOn===e&&(t.blockedOn=null,af||(af=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,QC)))}function ll(t){function e(i){return pa(i,t)}if(0<rc.length){pa(rc[0],t);for(var r=1;r<rc.length;r++){var n=rc[r];n.blockedOn===t&&(n.blockedOn=null)}}for(yi!==null&&pa(yi,t),vi!==null&&pa(vi,t),_i!==null&&pa(_i,t),ol.forEach(e),al.forEach(e),r=0;r<li.length;r++)n=li[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<li.length&&(r=li[0],r.blockedOn===null);)fb(r),r.blockedOn===null&&li.shift()}var go=Kn.ReactCurrentBatchConfig,Id=!0;function e2(t,e,r,n){var i=He,s=go.transition;go.transition=null;try{He=1,hg(t,e,r,n)}finally{He=i,go.transition=s}}function t2(t,e,r,n){var i=He,s=go.transition;go.transition=null;try{He=4,hg(t,e,r,n)}finally{He=i,go.transition=s}}function hg(t,e,r,n){if(Id){var i=lf(t,e,r,n);if(i===null)Sh(t,e,n,Rd,r),iy(t,n);else if(JC(i,t,e,r,n))n.stopPropagation();else if(iy(t,n),e&4&&-1<ZC.indexOf(t)){for(;i!==null;){var s=Nl(i);if(s!==null&&db(s),s=lf(t,e,r,n),s===null&&Sh(t,e,n,Rd,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Sh(t,e,n,null,r)}}var Rd=null;function lf(t,e,r,n){if(Rd=null,t=lg(n),t=ss(t),t!==null)if(e=Ts(t),e===null)t=null;else if(r=e.tag,r===13){if(t=rb(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Rd=t,null}function mb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($C()){case cg:return 1;case ob:return 4;case Ad:case GC:return 16;case ab:return 536870912;default:return 16}default:return 16}}var hi=null,pg=null,Jc=null;function gb(){if(Jc)return Jc;var t,e=pg,r=e.length,n,i="value"in hi?hi.value:hi.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return Jc=i.slice(t,1<n?1-n:void 0)}function Qc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function nc(){return!0}function oy(){return!1}function br(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?nc:oy,this.isPropagationStopped=oy,this}return at(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=nc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=nc)},persist:function(){},isPersistent:nc}),e}var Vo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fg=br(Vo),Ml=at({},Vo,{view:0,detail:0}),r2=br(Ml),fh,mh,fa,bu=at({},Ml,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fa&&(fa&&t.type==="mousemove"?(fh=t.screenX-fa.screenX,mh=t.screenY-fa.screenY):mh=fh=0,fa=t),fh)},movementY:function(t){return"movementY"in t?t.movementY:mh}}),ay=br(bu),n2=at({},bu,{dataTransfer:0}),i2=br(n2),s2=at({},Ml,{relatedTarget:0}),gh=br(s2),o2=at({},Vo,{animationName:0,elapsedTime:0,pseudoElement:0}),a2=br(o2),l2=at({},Vo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),c2=br(l2),d2=at({},Vo,{data:0}),ly=br(d2),u2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function f2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=p2[t])?!!e[t]:!1}function mg(){return f2}var m2=at({},Ml,{key:function(t){if(t.key){var e=u2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Qc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?h2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mg,charCode:function(t){return t.type==="keypress"?Qc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),g2=br(m2),x2=at({},bu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cy=br(x2),y2=at({},Ml,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mg}),v2=br(y2),_2=at({},Vo,{propertyName:0,elapsedTime:0,pseudoElement:0}),b2=br(_2),w2=at({},bu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),S2=br(w2),E2=[9,13,27,32],gg=Gn&&"CompositionEvent"in window,Ha=null;Gn&&"documentMode"in document&&(Ha=document.documentMode);var T2=Gn&&"TextEvent"in window&&!Ha,xb=Gn&&(!gg||Ha&&8<Ha&&11>=Ha),dy=" ",uy=!1;function yb(t,e){switch(t){case"keyup":return E2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var eo=!1;function C2(t,e){switch(t){case"compositionend":return vb(e);case"keypress":return e.which!==32?null:(uy=!0,dy);case"textInput":return t=e.data,t===dy&&uy?null:t;default:return null}}function A2(t,e){if(eo)return t==="compositionend"||!gg&&yb(t,e)?(t=gb(),Jc=pg=hi=null,eo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return xb&&e.locale!=="ko"?null:e.data;default:return null}}var k2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!k2[t.type]:e==="textarea"}function _b(t,e,r,n){Z1(n),e=Pd(e,"onChange"),0<e.length&&(r=new fg("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Wa=null,cl=null;function I2(t){Pb(t,0)}function wu(t){var e=no(t);if(H1(e))return t}function R2(t,e){if(t==="change")return e}var bb=!1;if(Gn){var xh;if(Gn){var yh="oninput"in document;if(!yh){var py=document.createElement("div");py.setAttribute("oninput","return;"),yh=typeof py.oninput=="function"}xh=yh}else xh=!1;bb=xh&&(!document.documentMode||9<document.documentMode)}function fy(){Wa&&(Wa.detachEvent("onpropertychange",wb),cl=Wa=null)}function wb(t){if(t.propertyName==="value"&&wu(cl)){var e=[];_b(e,cl,t,lg(t)),tb(I2,e)}}function P2(t,e,r){t==="focusin"?(fy(),Wa=e,cl=r,Wa.attachEvent("onpropertychange",wb)):t==="focusout"&&fy()}function j2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wu(cl)}function M2(t,e){if(t==="click")return wu(e)}function N2(t,e){if(t==="input"||t==="change")return wu(e)}function B2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var en=typeof Object.is=="function"?Object.is:B2;function dl(t,e){if(en(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Gp.call(e,i)||!en(t[i],e[i]))return!1}return!0}function my(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function gy(t,e){var r=my(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=my(r)}}function Sb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Sb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Eb(){for(var t=window,e=Ed();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ed(t.document)}return e}function xg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function D2(t){var e=Eb(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Sb(r.ownerDocument.documentElement,r)){if(n!==null&&xg(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=gy(r,s);var o=gy(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var L2=Gn&&"documentMode"in document&&11>=document.documentMode,to=null,cf=null,Va=null,df=!1;function xy(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;df||to==null||to!==Ed(n)||(n=to,"selectionStart"in n&&xg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Va&&dl(Va,n)||(Va=n,n=Pd(cf,"onSelect"),0<n.length&&(e=new fg("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=to)))}function ic(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ro={animationend:ic("Animation","AnimationEnd"),animationiteration:ic("Animation","AnimationIteration"),animationstart:ic("Animation","AnimationStart"),transitionend:ic("Transition","TransitionEnd")},vh={},Tb={};Gn&&(Tb=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function Su(t){if(vh[t])return vh[t];if(!ro[t])return t;var e=ro[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Tb)return vh[t]=e[r];return t}var Cb=Su("animationend"),Ab=Su("animationiteration"),kb=Su("animationstart"),Ib=Su("transitionend"),Rb=new Map,yy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Di(t,e){Rb.set(t,e),Es(e,[t])}for(var _h=0;_h<yy.length;_h++){var bh=yy[_h],F2=bh.toLowerCase(),O2=bh[0].toUpperCase()+bh.slice(1);Di(F2,"on"+O2)}Di(Cb,"onAnimationEnd");Di(Ab,"onAnimationIteration");Di(kb,"onAnimationStart");Di("dblclick","onDoubleClick");Di("focusin","onFocus");Di("focusout","onBlur");Di(Ib,"onTransitionEnd");Io("onMouseEnter",["mouseout","mouseover"]);Io("onMouseLeave",["mouseout","mouseover"]);Io("onPointerEnter",["pointerout","pointerover"]);Io("onPointerLeave",["pointerout","pointerover"]);Es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Es("onBeforeInput",["compositionend","keypress","textInput","paste"]);Es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),U2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ra));function vy(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,FC(n,e,void 0,t),t.currentTarget=null}function Pb(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;vy(i,l,d),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;vy(i,l,d),s=c}}}if(Cd)throw t=sf,Cd=!1,sf=null,t}function Ke(t,e){var r=e[mf];r===void 0&&(r=e[mf]=new Set);var n=t+"__bubble";r.has(n)||(jb(e,t,2,!1),r.add(n))}function wh(t,e,r){var n=0;e&&(n|=4),jb(r,t,n,e)}var sc="_reactListening"+Math.random().toString(36).slice(2);function ul(t){if(!t[sc]){t[sc]=!0,O1.forEach(function(r){r!=="selectionchange"&&(U2.has(r)||wh(r,!1,t),wh(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[sc]||(e[sc]=!0,wh("selectionchange",!1,e))}}function jb(t,e,r,n){switch(mb(e)){case 1:var i=e2;break;case 4:i=t2;break;default:i=hg}r=i.bind(null,e,r,t),i=void 0,!nf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Sh(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ss(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}tb(function(){var d=s,u=lg(r),h=[];e:{var p=Rb.get(t);if(p!==void 0){var f=fg,m=t;switch(t){case"keypress":if(Qc(r)===0)break e;case"keydown":case"keyup":f=g2;break;case"focusin":m="focus",f=gh;break;case"focusout":m="blur",f=gh;break;case"beforeblur":case"afterblur":f=gh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=ay;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=i2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=v2;break;case Cb:case Ab:case kb:f=a2;break;case Ib:f=b2;break;case"scroll":f=r2;break;case"wheel":f=S2;break;case"copy":case"cut":case"paste":f=c2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=cy}var _=(e&4)!==0,y=!_&&t==="scroll",x=_?p!==null?p+"Capture":null:p;_=[];for(var v=d,g;v!==null;){g=v;var b=g.stateNode;if(g.tag===5&&b!==null&&(g=b,x!==null&&(b=sl(v,x),b!=null&&_.push(hl(v,b,g)))),y)break;v=v.return}0<_.length&&(p=new f(p,m,null,r,u),h.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",p&&r!==tf&&(m=r.relatedTarget||r.fromElement)&&(ss(m)||m[Hn]))break e;if((f||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,f?(m=r.relatedTarget||r.toElement,f=d,m=m?ss(m):null,m!==null&&(y=Ts(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=d),f!==m)){if(_=ay,b="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(_=cy,b="onPointerLeave",x="onPointerEnter",v="pointer"),y=f==null?p:no(f),g=m==null?p:no(m),p=new _(b,v+"leave",f,r,u),p.target=y,p.relatedTarget=g,b=null,ss(u)===d&&(_=new _(x,v+"enter",m,r,u),_.target=g,_.relatedTarget=y,b=_),y=b,f&&m)t:{for(_=f,x=m,v=0,g=_;g;g=Bs(g))v++;for(g=0,b=x;b;b=Bs(b))g++;for(;0<v-g;)_=Bs(_),v--;for(;0<g-v;)x=Bs(x),g--;for(;v--;){if(_===x||x!==null&&_===x.alternate)break t;_=Bs(_),x=Bs(x)}_=null}else _=null;f!==null&&_y(h,p,f,_,!1),m!==null&&y!==null&&_y(h,y,m,_,!0)}}e:{if(p=d?no(d):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var S=R2;else if(hy(p))if(bb)S=N2;else{S=j2;var j=P2}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=M2);if(S&&(S=S(t,d))){_b(h,S,r,u);break e}j&&j(t,p,d),t==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&qp(p,"number",p.value)}switch(j=d?no(d):window,t){case"focusin":(hy(j)||j.contentEditable==="true")&&(to=j,cf=d,Va=null);break;case"focusout":Va=cf=to=null;break;case"mousedown":df=!0;break;case"contextmenu":case"mouseup":case"dragend":df=!1,xy(h,r,u);break;case"selectionchange":if(L2)break;case"keydown":case"keyup":xy(h,r,u)}var E;if(gg)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else eo?yb(t,r)&&(T="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(xb&&r.locale!=="ko"&&(eo||T!=="onCompositionStart"?T==="onCompositionEnd"&&eo&&(E=gb()):(hi=u,pg="value"in hi?hi.value:hi.textContent,eo=!0)),j=Pd(d,T),0<j.length&&(T=new ly(T,t,null,r,u),h.push({event:T,listeners:j}),E?T.data=E:(E=vb(r),E!==null&&(T.data=E)))),(E=T2?C2(t,r):A2(t,r))&&(d=Pd(d,"onBeforeInput"),0<d.length&&(u=new ly("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:d}),u.data=E))}Pb(h,e)})}function hl(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Pd(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=sl(t,r),s!=null&&n.unshift(hl(t,s,i)),s=sl(t,e),s!=null&&n.push(hl(t,s,i))),t=t.return}return n}function Bs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _y(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,i?(c=sl(r,s),c!=null&&o.unshift(hl(r,c,l))):i||(c=sl(r,s),c!=null&&o.push(hl(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var z2=/\r\n?/g,$2=/\u0000|\uFFFD/g;function by(t){return(typeof t=="string"?t:""+t).replace(z2,`
`).replace($2,"")}function oc(t,e,r){if(e=by(e),by(t)!==e&&r)throw Error(Y(425))}function jd(){}var uf=null,hf=null;function pf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ff=typeof setTimeout=="function"?setTimeout:void 0,G2=typeof clearTimeout=="function"?clearTimeout:void 0,wy=typeof Promise=="function"?Promise:void 0,H2=typeof queueMicrotask=="function"?queueMicrotask:typeof wy<"u"?function(t){return wy.resolve(null).then(t).catch(W2)}:ff;function W2(t){setTimeout(function(){throw t})}function Eh(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),ll(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ll(e)}function bi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Sy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Xo=Math.random().toString(36).slice(2),mn="__reactFiber$"+Xo,pl="__reactProps$"+Xo,Hn="__reactContainer$"+Xo,mf="__reactEvents$"+Xo,V2="__reactListeners$"+Xo,X2="__reactHandles$"+Xo;function ss(t){var e=t[mn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Hn]||r[mn]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Sy(t);t!==null;){if(r=t[mn])return r;t=Sy(t)}return e}t=r,r=t.parentNode}return null}function Nl(t){return t=t[mn]||t[Hn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function no(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Y(33))}function Eu(t){return t[pl]||null}var gf=[],io=-1;function Li(t){return{current:t}}function Ze(t){0>io||(t.current=gf[io],gf[io]=null,io--)}function Ye(t,e){io++,gf[io]=t.current,t.current=e}var Ii={},Vt=Li(Ii),sr=Li(!1),fs=Ii;function Ro(t,e){var r=t.type.contextTypes;if(!r)return Ii;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function or(t){return t=t.childContextTypes,t!=null}function Md(){Ze(sr),Ze(Vt)}function Ey(t,e,r){if(Vt.current!==Ii)throw Error(Y(168));Ye(Vt,e),Ye(sr,r)}function Mb(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Y(108,PC(t)||"Unknown",i));return at({},r,n)}function Nd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ii,fs=Vt.current,Ye(Vt,t),Ye(sr,sr.current),!0}function Ty(t,e,r){var n=t.stateNode;if(!n)throw Error(Y(169));r?(t=Mb(t,e,fs),n.__reactInternalMemoizedMergedChildContext=t,Ze(sr),Ze(Vt),Ye(Vt,t)):Ze(sr),Ye(sr,r)}var jn=null,Tu=!1,Th=!1;function Nb(t){jn===null?jn=[t]:jn.push(t)}function Y2(t){Tu=!0,Nb(t)}function Fi(){if(!Th&&jn!==null){Th=!0;var t=0,e=He;try{var r=jn;for(He=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}jn=null,Tu=!1}catch(i){throw jn!==null&&(jn=jn.slice(t+1)),sb(cg,Fi),i}finally{He=e,Th=!1}}return null}var so=[],oo=0,Bd=null,Dd=0,Ar=[],kr=0,ms=null,Mn=1,Nn="";function Yi(t,e){so[oo++]=Dd,so[oo++]=Bd,Bd=t,Dd=e}function Bb(t,e,r){Ar[kr++]=Mn,Ar[kr++]=Nn,Ar[kr++]=ms,ms=t;var n=Mn;t=Nn;var i=32-Kr(n)-1;n&=~(1<<i),r+=1;var s=32-Kr(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Mn=1<<32-Kr(e)+i|r<<i|n,Nn=s+t}else Mn=1<<s|r<<i|n,Nn=t}function yg(t){t.return!==null&&(Yi(t,1),Bb(t,1,0))}function vg(t){for(;t===Bd;)Bd=so[--oo],so[oo]=null,Dd=so[--oo],so[oo]=null;for(;t===ms;)ms=Ar[--kr],Ar[kr]=null,Nn=Ar[--kr],Ar[kr]=null,Mn=Ar[--kr],Ar[kr]=null}var yr=null,fr=null,et=!1,Xr=null;function Db(t,e){var r=Ir(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Cy(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,yr=t,fr=bi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,yr=t,fr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ms!==null?{id:Mn,overflow:Nn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ir(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,yr=t,fr=null,!0):!1;default:return!1}}function xf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function yf(t){if(et){var e=fr;if(e){var r=e;if(!Cy(t,e)){if(xf(t))throw Error(Y(418));e=bi(r.nextSibling);var n=yr;e&&Cy(t,e)?Db(n,r):(t.flags=t.flags&-4097|2,et=!1,yr=t)}}else{if(xf(t))throw Error(Y(418));t.flags=t.flags&-4097|2,et=!1,yr=t}}}function Ay(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;yr=t}function ac(t){if(t!==yr)return!1;if(!et)return Ay(t),et=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!pf(t.type,t.memoizedProps)),e&&(e=fr)){if(xf(t))throw Lb(),Error(Y(418));for(;e;)Db(t,e),e=bi(e.nextSibling)}if(Ay(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Y(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){fr=bi(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}fr=null}}else fr=yr?bi(t.stateNode.nextSibling):null;return!0}function Lb(){for(var t=fr;t;)t=bi(t.nextSibling)}function Po(){fr=yr=null,et=!1}function _g(t){Xr===null?Xr=[t]:Xr.push(t)}var K2=Kn.ReactCurrentBatchConfig;function ma(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Y(309));var n=r.stateNode}if(!n)throw Error(Y(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Y(284));if(!r._owner)throw Error(Y(290,t))}return t}function lc(t,e){throw t=Object.prototype.toString.call(e),Error(Y(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ky(t){var e=t._init;return e(t._payload)}function Fb(t){function e(x,v){if(t){var g=x.deletions;g===null?(x.deletions=[v],x.flags|=16):g.push(v)}}function r(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function n(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function i(x,v){return x=Ti(x,v),x.index=0,x.sibling=null,x}function s(x,v,g){return x.index=g,t?(g=x.alternate,g!==null?(g=g.index,g<v?(x.flags|=2,v):g):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,v,g,b){return v===null||v.tag!==6?(v=jh(g,x.mode,b),v.return=x,v):(v=i(v,g),v.return=x,v)}function c(x,v,g,b){var S=g.type;return S===Qs?u(x,v,g.props.children,b,g.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===si&&ky(S)===v.type)?(b=i(v,g.props),b.ref=ma(x,v,g),b.return=x,b):(b=od(g.type,g.key,g.props,null,x.mode,b),b.ref=ma(x,v,g),b.return=x,b)}function d(x,v,g,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==g.containerInfo||v.stateNode.implementation!==g.implementation?(v=Mh(g,x.mode,b),v.return=x,v):(v=i(v,g.children||[]),v.return=x,v)}function u(x,v,g,b,S){return v===null||v.tag!==7?(v=cs(g,x.mode,b,S),v.return=x,v):(v=i(v,g),v.return=x,v)}function h(x,v,g){if(typeof v=="string"&&v!==""||typeof v=="number")return v=jh(""+v,x.mode,g),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Zl:return g=od(v.type,v.key,v.props,null,x.mode,g),g.ref=ma(x,null,v),g.return=x,g;case Js:return v=Mh(v,x.mode,g),v.return=x,v;case si:var b=v._init;return h(x,b(v._payload),g)}if(ka(v)||da(v))return v=cs(v,x.mode,g,null),v.return=x,v;lc(x,v)}return null}function p(x,v,g,b){var S=v!==null?v.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return S!==null?null:l(x,v,""+g,b);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Zl:return g.key===S?c(x,v,g,b):null;case Js:return g.key===S?d(x,v,g,b):null;case si:return S=g._init,p(x,v,S(g._payload),b)}if(ka(g)||da(g))return S!==null?null:u(x,v,g,b,null);lc(x,g)}return null}function f(x,v,g,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return x=x.get(g)||null,l(v,x,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Zl:return x=x.get(b.key===null?g:b.key)||null,c(v,x,b,S);case Js:return x=x.get(b.key===null?g:b.key)||null,d(v,x,b,S);case si:var j=b._init;return f(x,v,g,j(b._payload),S)}if(ka(b)||da(b))return x=x.get(g)||null,u(v,x,b,S,null);lc(v,b)}return null}function m(x,v,g,b){for(var S=null,j=null,E=v,T=v=0,B=null;E!==null&&T<g.length;T++){E.index>T?(B=E,E=null):B=E.sibling;var M=p(x,E,g[T],b);if(M===null){E===null&&(E=B);break}t&&E&&M.alternate===null&&e(x,E),v=s(M,v,T),j===null?S=M:j.sibling=M,j=M,E=B}if(T===g.length)return r(x,E),et&&Yi(x,T),S;if(E===null){for(;T<g.length;T++)E=h(x,g[T],b),E!==null&&(v=s(E,v,T),j===null?S=E:j.sibling=E,j=E);return et&&Yi(x,T),S}for(E=n(x,E);T<g.length;T++)B=f(E,x,T,g[T],b),B!==null&&(t&&B.alternate!==null&&E.delete(B.key===null?T:B.key),v=s(B,v,T),j===null?S=B:j.sibling=B,j=B);return t&&E.forEach(function(F){return e(x,F)}),et&&Yi(x,T),S}function _(x,v,g,b){var S=da(g);if(typeof S!="function")throw Error(Y(150));if(g=S.call(g),g==null)throw Error(Y(151));for(var j=S=null,E=v,T=v=0,B=null,M=g.next();E!==null&&!M.done;T++,M=g.next()){E.index>T?(B=E,E=null):B=E.sibling;var F=p(x,E,M.value,b);if(F===null){E===null&&(E=B);break}t&&E&&F.alternate===null&&e(x,E),v=s(F,v,T),j===null?S=F:j.sibling=F,j=F,E=B}if(M.done)return r(x,E),et&&Yi(x,T),S;if(E===null){for(;!M.done;T++,M=g.next())M=h(x,M.value,b),M!==null&&(v=s(M,v,T),j===null?S=M:j.sibling=M,j=M);return et&&Yi(x,T),S}for(E=n(x,E);!M.done;T++,M=g.next())M=f(E,x,T,M.value,b),M!==null&&(t&&M.alternate!==null&&E.delete(M.key===null?T:M.key),v=s(M,v,T),j===null?S=M:j.sibling=M,j=M);return t&&E.forEach(function(U){return e(x,U)}),et&&Yi(x,T),S}function y(x,v,g,b){if(typeof g=="object"&&g!==null&&g.type===Qs&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Zl:e:{for(var S=g.key,j=v;j!==null;){if(j.key===S){if(S=g.type,S===Qs){if(j.tag===7){r(x,j.sibling),v=i(j,g.props.children),v.return=x,x=v;break e}}else if(j.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===si&&ky(S)===j.type){r(x,j.sibling),v=i(j,g.props),v.ref=ma(x,j,g),v.return=x,x=v;break e}r(x,j);break}else e(x,j);j=j.sibling}g.type===Qs?(v=cs(g.props.children,x.mode,b,g.key),v.return=x,x=v):(b=od(g.type,g.key,g.props,null,x.mode,b),b.ref=ma(x,v,g),b.return=x,x=b)}return o(x);case Js:e:{for(j=g.key;v!==null;){if(v.key===j)if(v.tag===4&&v.stateNode.containerInfo===g.containerInfo&&v.stateNode.implementation===g.implementation){r(x,v.sibling),v=i(v,g.children||[]),v.return=x,x=v;break e}else{r(x,v);break}else e(x,v);v=v.sibling}v=Mh(g,x.mode,b),v.return=x,x=v}return o(x);case si:return j=g._init,y(x,v,j(g._payload),b)}if(ka(g))return m(x,v,g,b);if(da(g))return _(x,v,g,b);lc(x,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,v!==null&&v.tag===6?(r(x,v.sibling),v=i(v,g),v.return=x,x=v):(r(x,v),v=jh(g,x.mode,b),v.return=x,x=v),o(x)):r(x,v)}return y}var jo=Fb(!0),Ob=Fb(!1),Ld=Li(null),Fd=null,ao=null,bg=null;function wg(){bg=ao=Fd=null}function Sg(t){var e=Ld.current;Ze(Ld),t._currentValue=e}function vf(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function xo(t,e){Fd=t,bg=ao=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rr=!0),t.firstContext=null)}function Nr(t){var e=t._currentValue;if(bg!==t)if(t={context:t,memoizedValue:e,next:null},ao===null){if(Fd===null)throw Error(Y(308));ao=t,Fd.dependencies={lanes:0,firstContext:t}}else ao=ao.next=t;return e}var os=null;function Eg(t){os===null?os=[t]:os.push(t)}function Ub(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Eg(e)):(r.next=i.next,i.next=r),e.interleaved=r,Wn(t,n)}function Wn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var oi=!1;function Tg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function On(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function wi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,$e&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Wn(t,r)}return i=n.interleaved,i===null?(e.next=e,Eg(n)):(e.next=i.next,i.next=e),n.interleaved=e,Wn(t,r)}function ed(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,dg(t,r)}}function Iy(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Od(t,e,r,n){var i=t.updateQueue;oi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var h=i.baseState;o=0,u=d=c=null,l=s;do{var p=l.lane,f=l.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,_=l;switch(p=e,f=r,_.tag){case 1:if(m=_.payload,typeof m=="function"){h=m.call(f,h,p);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=_.payload,p=typeof m=="function"?m.call(f,h,p):m,p==null)break e;h=at({},h,p);break e;case 2:oi=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else f={eventTime:f,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=f,c=h):u=u.next=f,o|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(u===null&&(c=h),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);xs|=o,t.lanes=o,t.memoizedState=h}}function Ry(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Y(191,i));i.call(n)}}}var Bl={},yn=Li(Bl),fl=Li(Bl),ml=Li(Bl);function as(t){if(t===Bl)throw Error(Y(174));return t}function Cg(t,e){switch(Ye(ml,e),Ye(fl,t),Ye(yn,Bl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Jp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Jp(e,t)}Ze(yn),Ye(yn,e)}function Mo(){Ze(yn),Ze(fl),Ze(ml)}function $b(t){as(ml.current);var e=as(yn.current),r=Jp(e,t.type);e!==r&&(Ye(fl,t),Ye(yn,r))}function Ag(t){fl.current===t&&(Ze(yn),Ze(fl))}var it=Li(0);function Ud(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ch=[];function kg(){for(var t=0;t<Ch.length;t++)Ch[t]._workInProgressVersionPrimary=null;Ch.length=0}var td=Kn.ReactCurrentDispatcher,Ah=Kn.ReactCurrentBatchConfig,gs=0,ot=null,Tt=null,It=null,zd=!1,Xa=!1,gl=0,q2=0;function zt(){throw Error(Y(321))}function Ig(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!en(t[r],e[r]))return!1;return!0}function Rg(t,e,r,n,i,s){if(gs=s,ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,td.current=t===null||t.memoizedState===null?eA:tA,t=r(n,i),Xa){s=0;do{if(Xa=!1,gl=0,25<=s)throw Error(Y(301));s+=1,It=Tt=null,e.updateQueue=null,td.current=rA,t=r(n,i)}while(Xa)}if(td.current=$d,e=Tt!==null&&Tt.next!==null,gs=0,It=Tt=ot=null,zd=!1,e)throw Error(Y(300));return t}function Pg(){var t=gl!==0;return gl=0,t}function un(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?ot.memoizedState=It=t:It=It.next=t,It}function Br(){if(Tt===null){var t=ot.alternate;t=t!==null?t.memoizedState:null}else t=Tt.next;var e=It===null?ot.memoizedState:It.next;if(e!==null)It=e,Tt=t;else{if(t===null)throw Error(Y(310));Tt=t,t={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},It===null?ot.memoizedState=It=t:It=It.next=t}return It}function xl(t,e){return typeof e=="function"?e(t):e}function kh(t){var e=Br(),r=e.queue;if(r===null)throw Error(Y(311));r.lastRenderedReducer=t;var n=Tt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((gs&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,ot.lanes|=u,xs|=u}d=d.next}while(d!==null&&d!==s);c===null?o=n:c.next=l,en(n,e.memoizedState)||(rr=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,ot.lanes|=s,xs|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Ih(t){var e=Br(),r=e.queue;if(r===null)throw Error(Y(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);en(s,e.memoizedState)||(rr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Gb(){}function Hb(t,e){var r=ot,n=Br(),i=e(),s=!en(n.memoizedState,i);if(s&&(n.memoizedState=i,rr=!0),n=n.queue,jg(Xb.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||It!==null&&It.memoizedState.tag&1){if(r.flags|=2048,yl(9,Vb.bind(null,r,n,i,e),void 0,null),Pt===null)throw Error(Y(349));gs&30||Wb(r,e,i)}return i}function Wb(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Vb(t,e,r,n){e.value=r,e.getSnapshot=n,Yb(e)&&Kb(t)}function Xb(t,e,r){return r(function(){Yb(e)&&Kb(t)})}function Yb(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!en(t,r)}catch{return!0}}function Kb(t){var e=Wn(t,1);e!==null&&qr(e,t,1,-1)}function Py(t){var e=un();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xl,lastRenderedState:t},e.queue=t,t=t.dispatch=Q2.bind(null,ot,t),[e.memoizedState,t]}function yl(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function qb(){return Br().memoizedState}function rd(t,e,r,n){var i=un();ot.flags|=t,i.memoizedState=yl(1|e,r,void 0,n===void 0?null:n)}function Cu(t,e,r,n){var i=Br();n=n===void 0?null:n;var s=void 0;if(Tt!==null){var o=Tt.memoizedState;if(s=o.destroy,n!==null&&Ig(n,o.deps)){i.memoizedState=yl(e,r,s,n);return}}ot.flags|=t,i.memoizedState=yl(1|e,r,s,n)}function jy(t,e){return rd(8390656,8,t,e)}function jg(t,e){return Cu(2048,8,t,e)}function Zb(t,e){return Cu(4,2,t,e)}function Jb(t,e){return Cu(4,4,t,e)}function Qb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ew(t,e,r){return r=r!=null?r.concat([t]):null,Cu(4,4,Qb.bind(null,e,t),r)}function Mg(){}function tw(t,e){var r=Br();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Ig(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function rw(t,e){var r=Br();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Ig(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function nw(t,e,r){return gs&21?(en(r,e)||(r=lb(),ot.lanes|=r,xs|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rr=!0),t.memoizedState=r)}function Z2(t,e){var r=He;He=r!==0&&4>r?r:4,t(!0);var n=Ah.transition;Ah.transition={};try{t(!1),e()}finally{He=r,Ah.transition=n}}function iw(){return Br().memoizedState}function J2(t,e,r){var n=Ei(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},sw(t))ow(e,r);else if(r=Ub(t,e,r,n),r!==null){var i=Jt();qr(r,t,n,i),aw(r,e,n)}}function Q2(t,e,r){var n=Ei(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(sw(t))ow(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,en(l,o)){var c=e.interleaved;c===null?(i.next=i,Eg(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=Ub(t,e,i,n),r!==null&&(i=Jt(),qr(r,t,n,i),aw(r,e,n))}}function sw(t){var e=t.alternate;return t===ot||e!==null&&e===ot}function ow(t,e){Xa=zd=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function aw(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,dg(t,r)}}var $d={readContext:Nr,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},eA={readContext:Nr,useCallback:function(t,e){return un().memoizedState=[t,e===void 0?null:e],t},useContext:Nr,useEffect:jy,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,rd(4194308,4,Qb.bind(null,e,t),r)},useLayoutEffect:function(t,e){return rd(4194308,4,t,e)},useInsertionEffect:function(t,e){return rd(4,2,t,e)},useMemo:function(t,e){var r=un();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=un();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=J2.bind(null,ot,t),[n.memoizedState,t]},useRef:function(t){var e=un();return t={current:t},e.memoizedState=t},useState:Py,useDebugValue:Mg,useDeferredValue:function(t){return un().memoizedState=t},useTransition:function(){var t=Py(!1),e=t[0];return t=Z2.bind(null,t[1]),un().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ot,i=un();if(et){if(r===void 0)throw Error(Y(407));r=r()}else{if(r=e(),Pt===null)throw Error(Y(349));gs&30||Wb(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,jy(Xb.bind(null,n,s,t),[t]),n.flags|=2048,yl(9,Vb.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=un(),e=Pt.identifierPrefix;if(et){var r=Nn,n=Mn;r=(n&~(1<<32-Kr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=gl++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=q2++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},tA={readContext:Nr,useCallback:tw,useContext:Nr,useEffect:jg,useImperativeHandle:ew,useInsertionEffect:Zb,useLayoutEffect:Jb,useMemo:rw,useReducer:kh,useRef:qb,useState:function(){return kh(xl)},useDebugValue:Mg,useDeferredValue:function(t){var e=Br();return nw(e,Tt.memoizedState,t)},useTransition:function(){var t=kh(xl)[0],e=Br().memoizedState;return[t,e]},useMutableSource:Gb,useSyncExternalStore:Hb,useId:iw,unstable_isNewReconciler:!1},rA={readContext:Nr,useCallback:tw,useContext:Nr,useEffect:jg,useImperativeHandle:ew,useInsertionEffect:Zb,useLayoutEffect:Jb,useMemo:rw,useReducer:Ih,useRef:qb,useState:function(){return Ih(xl)},useDebugValue:Mg,useDeferredValue:function(t){var e=Br();return Tt===null?e.memoizedState=t:nw(e,Tt.memoizedState,t)},useTransition:function(){var t=Ih(xl)[0],e=Br().memoizedState;return[t,e]},useMutableSource:Gb,useSyncExternalStore:Hb,useId:iw,unstable_isNewReconciler:!1};function Wr(t,e){if(t&&t.defaultProps){e=at({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function _f(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:at({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Au={isMounted:function(t){return(t=t._reactInternals)?Ts(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Jt(),i=Ei(t),s=On(n,i);s.payload=e,r!=null&&(s.callback=r),e=wi(t,s,i),e!==null&&(qr(e,t,i,n),ed(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Jt(),i=Ei(t),s=On(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=wi(t,s,i),e!==null&&(qr(e,t,i,n),ed(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Jt(),n=Ei(t),i=On(r,n);i.tag=2,e!=null&&(i.callback=e),e=wi(t,i,n),e!==null&&(qr(e,t,n,r),ed(e,t,n))}};function My(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!dl(r,n)||!dl(i,s):!0}function lw(t,e,r){var n=!1,i=Ii,s=e.contextType;return typeof s=="object"&&s!==null?s=Nr(s):(i=or(e)?fs:Vt.current,n=e.contextTypes,s=(n=n!=null)?Ro(t,i):Ii),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Au,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Ny(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Au.enqueueReplaceState(e,e.state,null)}function bf(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Tg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Nr(s):(s=or(e)?fs:Vt.current,i.context=Ro(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(_f(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Au.enqueueReplaceState(i,i.state,null),Od(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function No(t,e){try{var r="",n=e;do r+=RC(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Rh(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function wf(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var nA=typeof WeakMap=="function"?WeakMap:Map;function cw(t,e,r){r=On(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Hd||(Hd=!0,jf=n),wf(t,e)},r}function dw(t,e,r){r=On(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){wf(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){wf(t,e),typeof n!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function By(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new nA;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=xA.bind(null,t,e,r),e.then(t,t))}function Dy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ly(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=On(-1,1),e.tag=2,wi(r,e,1))),r.lanes|=1),t)}var iA=Kn.ReactCurrentOwner,rr=!1;function Kt(t,e,r,n){e.child=t===null?Ob(e,null,r,n):jo(e,t.child,r,n)}function Fy(t,e,r,n,i){r=r.render;var s=e.ref;return xo(e,i),n=Rg(t,e,r,n,s,i),r=Pg(),t!==null&&!rr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Vn(t,e,i)):(et&&r&&yg(e),e.flags|=1,Kt(t,e,n,i),e.child)}function Oy(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!zg(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,uw(t,e,s,n,i)):(t=od(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:dl,r(o,n)&&t.ref===e.ref)return Vn(t,e,i)}return e.flags|=1,t=Ti(s,n),t.ref=e.ref,t.return=e,e.child=t}function uw(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(dl(s,n)&&t.ref===e.ref)if(rr=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(rr=!0);else return e.lanes=t.lanes,Vn(t,e,i)}return Sf(t,e,r,n,i)}function hw(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(co,pr),pr|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ye(co,pr),pr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Ye(co,pr),pr|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Ye(co,pr),pr|=n;return Kt(t,e,i,r),e.child}function pw(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Sf(t,e,r,n,i){var s=or(r)?fs:Vt.current;return s=Ro(e,s),xo(e,i),r=Rg(t,e,r,n,s,i),n=Pg(),t!==null&&!rr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Vn(t,e,i)):(et&&n&&yg(e),e.flags|=1,Kt(t,e,r,i),e.child)}function Uy(t,e,r,n,i){if(or(r)){var s=!0;Nd(e)}else s=!1;if(xo(e,i),e.stateNode===null)nd(t,e),lw(e,r,n),bf(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Nr(d):(d=or(r)?fs:Vt.current,d=Ro(e,d));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&Ny(e,o,n,d),oi=!1;var p=e.memoizedState;o.state=p,Od(e,n,o,i),c=e.memoizedState,l!==n||p!==c||sr.current||oi?(typeof u=="function"&&(_f(e,r,u,n),c=e.memoizedState),(l=oi||My(e,r,l,n,p,c,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,zb(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Wr(e.type,l),o.props=d,h=e.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Nr(c):(c=or(r)?fs:Vt.current,c=Ro(e,c));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||p!==c)&&Ny(e,o,n,c),oi=!1,p=e.memoizedState,o.state=p,Od(e,n,o,i);var m=e.memoizedState;l!==h||p!==m||sr.current||oi?(typeof f=="function"&&(_f(e,r,f,n),m=e.memoizedState),(d=oi||My(e,r,d,n,p,m,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return Ef(t,e,r,n,s,i)}function Ef(t,e,r,n,i,s){pw(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Ty(e,r,!1),Vn(t,e,s);n=e.stateNode,iA.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=jo(e,t.child,null,s),e.child=jo(e,null,l,s)):Kt(t,e,l,s),e.memoizedState=n.state,i&&Ty(e,r,!0),e.child}function fw(t){var e=t.stateNode;e.pendingContext?Ey(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ey(t,e.context,!1),Cg(t,e.containerInfo)}function zy(t,e,r,n,i){return Po(),_g(i),e.flags|=256,Kt(t,e,r,n),e.child}var Tf={dehydrated:null,treeContext:null,retryLane:0};function Cf(t){return{baseLanes:t,cachePool:null,transitions:null}}function mw(t,e,r){var n=e.pendingProps,i=it.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ye(it,i&1),t===null)return yf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Ru(o,n,0,null),t=cs(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Cf(r),e.memoizedState=Tf,t):Ng(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return sA(t,e,o,n,l,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Ti(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Ti(l,s):(s=cs(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?Cf(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=Tf,n}return s=t.child,t=s.sibling,n=Ti(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Ng(t,e){return e=Ru({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function cc(t,e,r,n){return n!==null&&_g(n),jo(e,t.child,null,r),t=Ng(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sA(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=Rh(Error(Y(422))),cc(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Ru({mode:"visible",children:n.children},i,0,null),s=cs(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&jo(e,t.child,null,o),e.child.memoizedState=Cf(o),e.memoizedState=Tf,s);if(!(e.mode&1))return cc(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Y(419)),n=Rh(s,n,void 0),cc(t,e,o,n)}if(l=(o&t.childLanes)!==0,rr||l){if(n=Pt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Wn(t,i),qr(n,t,i,-1))}return Ug(),n=Rh(Error(Y(421))),cc(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=yA.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,fr=bi(i.nextSibling),yr=e,et=!0,Xr=null,t!==null&&(Ar[kr++]=Mn,Ar[kr++]=Nn,Ar[kr++]=ms,Mn=t.id,Nn=t.overflow,ms=e),e=Ng(e,n.children),e.flags|=4096,e)}function $y(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),vf(t.return,e,r)}function Ph(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function gw(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Kt(t,e,n.children,r),n=it.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$y(t,r,e);else if(t.tag===19)$y(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ye(it,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Ud(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Ph(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ud(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Ph(e,!0,r,null,s);break;case"together":Ph(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Vn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),xs|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Y(153));if(e.child!==null){for(t=e.child,r=Ti(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ti(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function oA(t,e,r){switch(e.tag){case 3:fw(e),Po();break;case 5:$b(e);break;case 1:or(e.type)&&Nd(e);break;case 4:Cg(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Ye(Ld,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ye(it,it.current&1),e.flags|=128,null):r&e.child.childLanes?mw(t,e,r):(Ye(it,it.current&1),t=Vn(t,e,r),t!==null?t.sibling:null);Ye(it,it.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return gw(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ye(it,it.current),n)break;return null;case 22:case 23:return e.lanes=0,hw(t,e,r)}return Vn(t,e,r)}var xw,Af,yw,vw;xw=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Af=function(){};yw=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,as(yn.current);var s=null;switch(r){case"input":i=Yp(t,i),n=Yp(t,n),s=[];break;case"select":i=at({},i,{value:void 0}),n=at({},n,{value:void 0}),s=[];break;case"textarea":i=Zp(t,i),n=Zp(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=jd)}Qp(r,n);var o;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(nl.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var c=n[d];if(l=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(nl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ke("scroll",t),s||l===c||(s=[])):(s=s||[]).push(d,c))}r&&(s=s||[]).push("style",r);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};vw=function(t,e,r,n){r!==n&&(e.flags|=4)};function ga(t,e){if(!et)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function $t(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function aA(t,e,r){var n=e.pendingProps;switch(vg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(e),null;case 1:return or(e.type)&&Md(),$t(e),null;case 3:return n=e.stateNode,Mo(),Ze(sr),Ze(Vt),kg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(ac(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xr!==null&&(Bf(Xr),Xr=null))),Af(t,e),$t(e),null;case 5:Ag(e);var i=as(ml.current);if(r=e.type,t!==null&&e.stateNode!=null)yw(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Y(166));return $t(e),null}if(t=as(yn.current),ac(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[mn]=e,n[pl]=s,t=(e.mode&1)!==0,r){case"dialog":Ke("cancel",n),Ke("close",n);break;case"iframe":case"object":case"embed":Ke("load",n);break;case"video":case"audio":for(i=0;i<Ra.length;i++)Ke(Ra[i],n);break;case"source":Ke("error",n);break;case"img":case"image":case"link":Ke("error",n),Ke("load",n);break;case"details":Ke("toggle",n);break;case"input":Zx(n,s),Ke("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ke("invalid",n);break;case"textarea":Qx(n,s),Ke("invalid",n)}Qp(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&oc(n.textContent,l,t),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&oc(n.textContent,l,t),i=["children",""+l]):nl.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ke("scroll",n)}switch(r){case"input":Jl(n),Jx(n,s,!0);break;case"textarea":Jl(n),ey(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=jd)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=X1(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[mn]=e,t[pl]=n,xw(t,e,!1,!1),e.stateNode=t;e:{switch(o=ef(r,n),r){case"dialog":Ke("cancel",t),Ke("close",t),i=n;break;case"iframe":case"object":case"embed":Ke("load",t),i=n;break;case"video":case"audio":for(i=0;i<Ra.length;i++)Ke(Ra[i],t);i=n;break;case"source":Ke("error",t),i=n;break;case"img":case"image":case"link":Ke("error",t),Ke("load",t),i=n;break;case"details":Ke("toggle",t),i=n;break;case"input":Zx(t,n),i=Yp(t,n),Ke("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=at({},n,{value:void 0}),Ke("invalid",t);break;case"textarea":Qx(t,n),i=Zp(t,n),Ke("invalid",t);break;default:i=n}Qp(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?q1(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Y1(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&il(t,c):typeof c=="number"&&il(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(nl.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ke("scroll",t):c!=null&&ig(t,s,c,o))}switch(r){case"input":Jl(t),Jx(t,n,!1);break;case"textarea":Jl(t),ey(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ki(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?po(t,!!n.multiple,s,!1):n.defaultValue!=null&&po(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=jd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $t(e),null;case 6:if(t&&e.stateNode!=null)vw(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Y(166));if(r=as(ml.current),as(yn.current),ac(e)){if(n=e.stateNode,r=e.memoizedProps,n[mn]=e,(s=n.nodeValue!==r)&&(t=yr,t!==null))switch(t.tag){case 3:oc(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&oc(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[mn]=e,e.stateNode=n}return $t(e),null;case 13:if(Ze(it),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(et&&fr!==null&&e.mode&1&&!(e.flags&128))Lb(),Po(),e.flags|=98560,s=!1;else if(s=ac(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Y(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Y(317));s[mn]=e}else Po(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$t(e),s=!1}else Xr!==null&&(Bf(Xr),Xr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||it.current&1?Ct===0&&(Ct=3):Ug())),e.updateQueue!==null&&(e.flags|=4),$t(e),null);case 4:return Mo(),Af(t,e),t===null&&ul(e.stateNode.containerInfo),$t(e),null;case 10:return Sg(e.type._context),$t(e),null;case 17:return or(e.type)&&Md(),$t(e),null;case 19:if(Ze(it),s=e.memoizedState,s===null)return $t(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)ga(s,!1);else{if(Ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ud(t),o!==null){for(e.flags|=128,ga(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Ye(it,it.current&1|2),e.child}t=t.sibling}s.tail!==null&&mt()>Bo&&(e.flags|=128,n=!0,ga(s,!1),e.lanes=4194304)}else{if(!n)if(t=Ud(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ga(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!et)return $t(e),null}else 2*mt()-s.renderingStartTime>Bo&&r!==1073741824&&(e.flags|=128,n=!0,ga(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=mt(),e.sibling=null,r=it.current,Ye(it,n?r&1|2:r&1),e):($t(e),null);case 22:case 23:return Og(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?pr&1073741824&&($t(e),e.subtreeFlags&6&&(e.flags|=8192)):$t(e),null;case 24:return null;case 25:return null}throw Error(Y(156,e.tag))}function lA(t,e){switch(vg(e),e.tag){case 1:return or(e.type)&&Md(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mo(),Ze(sr),Ze(Vt),kg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ag(e),null;case 13:if(Ze(it),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Y(340));Po()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ze(it),null;case 4:return Mo(),null;case 10:return Sg(e.type._context),null;case 22:case 23:return Og(),null;case 24:return null;default:return null}}var dc=!1,Ht=!1,cA=typeof WeakSet=="function"?WeakSet:Set,se=null;function lo(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ht(t,e,n)}else r.current=null}function kf(t,e,r){try{r()}catch(n){ht(t,e,n)}}var Gy=!1;function dA(t,e){if(uf=Id,t=Eb(),xg(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=t,p=null;t:for(;;){for(var f;h!==r||i!==0&&h.nodeType!==3||(l=o+i),h!==s||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)p=h,h=f;for(;;){if(h===t)break t;if(p===r&&++d===i&&(l=o),p===s&&++u===n&&(c=o),(f=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=f}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(hf={focusedElem:t,selectionRange:r},Id=!1,se=e;se!==null;)if(e=se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,se=t;else for(;se!==null;){e=se;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var _=m.memoizedProps,y=m.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?_:Wr(e.type,_),y);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(b){ht(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}return m=Gy,Gy=!1,m}function Ya(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&kf(e,r,s)}i=i.next}while(i!==n)}}function ku(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function If(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function _w(t){var e=t.alternate;e!==null&&(t.alternate=null,_w(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mn],delete e[pl],delete e[mf],delete e[V2],delete e[X2])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function bw(t){return t.tag===5||t.tag===3||t.tag===4}function Hy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Rf(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=jd));else if(n!==4&&(t=t.child,t!==null))for(Rf(t,e,r),t=t.sibling;t!==null;)Rf(t,e,r),t=t.sibling}function Pf(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Pf(t,e,r),t=t.sibling;t!==null;)Pf(t,e,r),t=t.sibling}var Dt=null,Vr=!1;function Jn(t,e,r){for(r=r.child;r!==null;)ww(t,e,r),r=r.sibling}function ww(t,e,r){if(xn&&typeof xn.onCommitFiberUnmount=="function")try{xn.onCommitFiberUnmount(_u,r)}catch{}switch(r.tag){case 5:Ht||lo(r,e);case 6:var n=Dt,i=Vr;Dt=null,Jn(t,e,r),Dt=n,Vr=i,Dt!==null&&(Vr?(t=Dt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Dt.removeChild(r.stateNode));break;case 18:Dt!==null&&(Vr?(t=Dt,r=r.stateNode,t.nodeType===8?Eh(t.parentNode,r):t.nodeType===1&&Eh(t,r),ll(t)):Eh(Dt,r.stateNode));break;case 4:n=Dt,i=Vr,Dt=r.stateNode.containerInfo,Vr=!0,Jn(t,e,r),Dt=n,Vr=i;break;case 0:case 11:case 14:case 15:if(!Ht&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&kf(r,e,o),i=i.next}while(i!==n)}Jn(t,e,r);break;case 1:if(!Ht&&(lo(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ht(r,e,l)}Jn(t,e,r);break;case 21:Jn(t,e,r);break;case 22:r.mode&1?(Ht=(n=Ht)||r.memoizedState!==null,Jn(t,e,r),Ht=n):Jn(t,e,r);break;default:Jn(t,e,r)}}function Wy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new cA),e.forEach(function(n){var i=vA.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ur(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Dt=l.stateNode,Vr=!1;break e;case 3:Dt=l.stateNode.containerInfo,Vr=!0;break e;case 4:Dt=l.stateNode.containerInfo,Vr=!0;break e}l=l.return}if(Dt===null)throw Error(Y(160));ww(s,o,i),Dt=null,Vr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){ht(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Sw(e,t),e=e.sibling}function Sw(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ur(e,t),nn(t),n&4){try{Ya(3,t,t.return),ku(3,t)}catch(_){ht(t,t.return,_)}try{Ya(5,t,t.return)}catch(_){ht(t,t.return,_)}}break;case 1:Ur(e,t),nn(t),n&512&&r!==null&&lo(r,r.return);break;case 5:if(Ur(e,t),nn(t),n&512&&r!==null&&lo(r,r.return),t.flags&32){var i=t.stateNode;try{il(i,"")}catch(_){ht(t,t.return,_)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&W1(i,s),ef(l,o);var d=ef(l,s);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];u==="style"?q1(i,h):u==="dangerouslySetInnerHTML"?Y1(i,h):u==="children"?il(i,h):ig(i,u,h,d)}switch(l){case"input":Kp(i,s);break;case"textarea":V1(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?po(i,!!s.multiple,f,!1):p!==!!s.multiple&&(s.defaultValue!=null?po(i,!!s.multiple,s.defaultValue,!0):po(i,!!s.multiple,s.multiple?[]:"",!1))}i[pl]=s}catch(_){ht(t,t.return,_)}}break;case 6:if(Ur(e,t),nn(t),n&4){if(t.stateNode===null)throw Error(Y(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(_){ht(t,t.return,_)}}break;case 3:if(Ur(e,t),nn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ll(e.containerInfo)}catch(_){ht(t,t.return,_)}break;case 4:Ur(e,t),nn(t);break;case 13:Ur(e,t),nn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Lg=mt())),n&4&&Wy(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Ht=(d=Ht)||u,Ur(e,t),Ht=d):Ur(e,t),nn(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(se=t,u=t.child;u!==null;){for(h=se=u;se!==null;){switch(p=se,f=p.child,p.tag){case 0:case 11:case 14:case 15:Ya(4,p,p.return);break;case 1:lo(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(_){ht(n,r,_)}}break;case 5:lo(p,p.return);break;case 22:if(p.memoizedState!==null){Xy(h);continue}}f!==null?(f.return=p,se=f):Xy(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=K1("display",o))}catch(_){ht(t,t.return,_)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(_){ht(t,t.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ur(e,t),nn(t),n&4&&Wy(t);break;case 21:break;default:Ur(e,t),nn(t)}}function nn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(bw(r)){var n=r;break e}r=r.return}throw Error(Y(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(il(i,""),n.flags&=-33);var s=Hy(t);Pf(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=Hy(t);Rf(t,l,o);break;default:throw Error(Y(161))}}catch(c){ht(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function uA(t,e,r){se=t,Ew(t)}function Ew(t,e,r){for(var n=(t.mode&1)!==0;se!==null;){var i=se,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||dc;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Ht;l=dc;var d=Ht;if(dc=o,(Ht=c)&&!d)for(se=i;se!==null;)o=se,c=o.child,o.tag===22&&o.memoizedState!==null?Yy(i):c!==null?(c.return=o,se=c):Yy(i);for(;s!==null;)se=s,Ew(s),s=s.sibling;se=i,dc=l,Ht=d}Vy(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,se=s):Vy(t)}}function Vy(t){for(;se!==null;){var e=se;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ht||ku(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ht)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Wr(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Ry(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Ry(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&ll(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}Ht||e.flags&512&&If(e)}catch(p){ht(e,e.return,p)}}if(e===t){se=null;break}if(r=e.sibling,r!==null){r.return=e.return,se=r;break}se=e.return}}function Xy(t){for(;se!==null;){var e=se;if(e===t){se=null;break}var r=e.sibling;if(r!==null){r.return=e.return,se=r;break}se=e.return}}function Yy(t){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ku(4,e)}catch(c){ht(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){ht(e,i,c)}}var s=e.return;try{If(e)}catch(c){ht(e,s,c)}break;case 5:var o=e.return;try{If(e)}catch(c){ht(e,o,c)}}}catch(c){ht(e,e.return,c)}if(e===t){se=null;break}var l=e.sibling;if(l!==null){l.return=e.return,se=l;break}se=e.return}}var hA=Math.ceil,Gd=Kn.ReactCurrentDispatcher,Bg=Kn.ReactCurrentOwner,jr=Kn.ReactCurrentBatchConfig,$e=0,Pt=null,vt=null,Ft=0,pr=0,co=Li(0),Ct=0,vl=null,xs=0,Iu=0,Dg=0,Ka=null,tr=null,Lg=0,Bo=1/0,In=null,Hd=!1,jf=null,Si=null,uc=!1,pi=null,Wd=0,qa=0,Mf=null,id=-1,sd=0;function Jt(){return $e&6?mt():id!==-1?id:id=mt()}function Ei(t){return t.mode&1?$e&2&&Ft!==0?Ft&-Ft:K2.transition!==null?(sd===0&&(sd=lb()),sd):(t=He,t!==0||(t=window.event,t=t===void 0?16:mb(t.type)),t):1}function qr(t,e,r,n){if(50<qa)throw qa=0,Mf=null,Error(Y(185));jl(t,r,n),(!($e&2)||t!==Pt)&&(t===Pt&&(!($e&2)&&(Iu|=r),Ct===4&&ci(t,Ft)),ar(t,n),r===1&&$e===0&&!(e.mode&1)&&(Bo=mt()+500,Tu&&Fi()))}function ar(t,e){var r=t.callbackNode;KC(t,e);var n=kd(t,t===Pt?Ft:0);if(n===0)r!==null&&ny(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&ny(r),e===1)t.tag===0?Y2(Ky.bind(null,t)):Nb(Ky.bind(null,t)),H2(function(){!($e&6)&&Fi()}),r=null;else{switch(cb(n)){case 1:r=cg;break;case 4:r=ob;break;case 16:r=Ad;break;case 536870912:r=ab;break;default:r=Ad}r=jw(r,Tw.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Tw(t,e){if(id=-1,sd=0,$e&6)throw Error(Y(327));var r=t.callbackNode;if(yo()&&t.callbackNode!==r)return null;var n=kd(t,t===Pt?Ft:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Vd(t,n);else{e=n;var i=$e;$e|=2;var s=Aw();(Pt!==t||Ft!==e)&&(In=null,Bo=mt()+500,ls(t,e));do try{mA();break}catch(l){Cw(t,l)}while(!0);wg(),Gd.current=s,$e=i,vt!==null?e=0:(Pt=null,Ft=0,e=Ct)}if(e!==0){if(e===2&&(i=of(t),i!==0&&(n=i,e=Nf(t,i))),e===1)throw r=vl,ls(t,0),ci(t,n),ar(t,mt()),r;if(e===6)ci(t,n);else{if(i=t.current.alternate,!(n&30)&&!pA(i)&&(e=Vd(t,n),e===2&&(s=of(t),s!==0&&(n=s,e=Nf(t,s))),e===1))throw r=vl,ls(t,0),ci(t,n),ar(t,mt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Y(345));case 2:Ki(t,tr,In);break;case 3:if(ci(t,n),(n&130023424)===n&&(e=Lg+500-mt(),10<e)){if(kd(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Jt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ff(Ki.bind(null,t,tr,In),e);break}Ki(t,tr,In);break;case 4:if(ci(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-Kr(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=mt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hA(n/1960))-n,10<n){t.timeoutHandle=ff(Ki.bind(null,t,tr,In),n);break}Ki(t,tr,In);break;case 5:Ki(t,tr,In);break;default:throw Error(Y(329))}}}return ar(t,mt()),t.callbackNode===r?Tw.bind(null,t):null}function Nf(t,e){var r=Ka;return t.current.memoizedState.isDehydrated&&(ls(t,e).flags|=256),t=Vd(t,e),t!==2&&(e=tr,tr=r,e!==null&&Bf(e)),t}function Bf(t){tr===null?tr=t:tr.push.apply(tr,t)}function pA(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!en(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ci(t,e){for(e&=~Dg,e&=~Iu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Kr(e),n=1<<r;t[r]=-1,e&=~n}}function Ky(t){if($e&6)throw Error(Y(327));yo();var e=kd(t,0);if(!(e&1))return ar(t,mt()),null;var r=Vd(t,e);if(t.tag!==0&&r===2){var n=of(t);n!==0&&(e=n,r=Nf(t,n))}if(r===1)throw r=vl,ls(t,0),ci(t,e),ar(t,mt()),r;if(r===6)throw Error(Y(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ki(t,tr,In),ar(t,mt()),null}function Fg(t,e){var r=$e;$e|=1;try{return t(e)}finally{$e=r,$e===0&&(Bo=mt()+500,Tu&&Fi())}}function ys(t){pi!==null&&pi.tag===0&&!($e&6)&&yo();var e=$e;$e|=1;var r=jr.transition,n=He;try{if(jr.transition=null,He=1,t)return t()}finally{He=n,jr.transition=r,$e=e,!($e&6)&&Fi()}}function Og(){pr=co.current,Ze(co)}function ls(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,G2(r)),vt!==null)for(r=vt.return;r!==null;){var n=r;switch(vg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Md();break;case 3:Mo(),Ze(sr),Ze(Vt),kg();break;case 5:Ag(n);break;case 4:Mo();break;case 13:Ze(it);break;case 19:Ze(it);break;case 10:Sg(n.type._context);break;case 22:case 23:Og()}r=r.return}if(Pt=t,vt=t=Ti(t.current,null),Ft=pr=e,Ct=0,vl=null,Dg=Iu=xs=0,tr=Ka=null,os!==null){for(e=0;e<os.length;e++)if(r=os[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}os=null}return t}function Cw(t,e){do{var r=vt;try{if(wg(),td.current=$d,zd){for(var n=ot.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}zd=!1}if(gs=0,It=Tt=ot=null,Xa=!1,gl=0,Bg.current=null,r===null||r.return===null){Ct=1,vl=e,vt=null;break}e:{var s=t,o=r.return,l=r,c=e;if(e=Ft,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Dy(o);if(f!==null){f.flags&=-257,Ly(f,o,l,s,e),f.mode&1&&By(s,d,e),e=f,c=d;var m=e.updateQueue;if(m===null){var _=new Set;_.add(c),e.updateQueue=_}else m.add(c);break e}else{if(!(e&1)){By(s,d,e),Ug();break e}c=Error(Y(426))}}else if(et&&l.mode&1){var y=Dy(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Ly(y,o,l,s,e),_g(No(c,l));break e}}s=c=No(c,l),Ct!==4&&(Ct=2),Ka===null?Ka=[s]:Ka.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=cw(s,c,e);Iy(s,x);break e;case 1:l=c;var v=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Si===null||!Si.has(g)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=dw(s,l,e);Iy(s,b);break e}}s=s.return}while(s!==null)}Iw(r)}catch(S){e=S,vt===r&&r!==null&&(vt=r=r.return);continue}break}while(!0)}function Aw(){var t=Gd.current;return Gd.current=$d,t===null?$d:t}function Ug(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Pt===null||!(xs&268435455)&&!(Iu&268435455)||ci(Pt,Ft)}function Vd(t,e){var r=$e;$e|=2;var n=Aw();(Pt!==t||Ft!==e)&&(In=null,ls(t,e));do try{fA();break}catch(i){Cw(t,i)}while(!0);if(wg(),$e=r,Gd.current=n,vt!==null)throw Error(Y(261));return Pt=null,Ft=0,Ct}function fA(){for(;vt!==null;)kw(vt)}function mA(){for(;vt!==null&&!UC();)kw(vt)}function kw(t){var e=Pw(t.alternate,t,pr);t.memoizedProps=t.pendingProps,e===null?Iw(t):vt=e,Bg.current=null}function Iw(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=lA(r,e),r!==null){r.flags&=32767,vt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ct=6,vt=null;return}}else if(r=aA(r,e,pr),r!==null){vt=r;return}if(e=e.sibling,e!==null){vt=e;return}vt=e=t}while(e!==null);Ct===0&&(Ct=5)}function Ki(t,e,r){var n=He,i=jr.transition;try{jr.transition=null,He=1,gA(t,e,r,n)}finally{jr.transition=i,He=n}return null}function gA(t,e,r,n){do yo();while(pi!==null);if($e&6)throw Error(Y(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Y(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(qC(t,s),t===Pt&&(vt=Pt=null,Ft=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||uc||(uc=!0,jw(Ad,function(){return yo(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=jr.transition,jr.transition=null;var o=He;He=1;var l=$e;$e|=4,Bg.current=null,dA(t,r),Sw(r,t),D2(hf),Id=!!uf,hf=uf=null,t.current=r,uA(r),zC(),$e=l,He=o,jr.transition=s}else t.current=r;if(uc&&(uc=!1,pi=t,Wd=i),s=t.pendingLanes,s===0&&(Si=null),HC(r.stateNode),ar(t,mt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Hd)throw Hd=!1,t=jf,jf=null,t;return Wd&1&&t.tag!==0&&yo(),s=t.pendingLanes,s&1?t===Mf?qa++:(qa=0,Mf=t):qa=0,Fi(),null}function yo(){if(pi!==null){var t=cb(Wd),e=jr.transition,r=He;try{if(jr.transition=null,He=16>t?16:t,pi===null)var n=!1;else{if(t=pi,pi=null,Wd=0,$e&6)throw Error(Y(331));var i=$e;for($e|=4,se=t.current;se!==null;){var s=se,o=s.child;if(se.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(se=d;se!==null;){var u=se;switch(u.tag){case 0:case 11:case 15:Ya(8,u,s)}var h=u.child;if(h!==null)h.return=u,se=h;else for(;se!==null;){u=se;var p=u.sibling,f=u.return;if(_w(u),u===d){se=null;break}if(p!==null){p.return=f,se=p;break}se=f}}}var m=s.alternate;if(m!==null){var _=m.child;if(_!==null){m.child=null;do{var y=_.sibling;_.sibling=null,_=y}while(_!==null)}}se=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,se=o;else e:for(;se!==null;){if(s=se,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ya(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,se=x;break e}se=s.return}}var v=t.current;for(se=v;se!==null;){o=se;var g=o.child;if(o.subtreeFlags&2064&&g!==null)g.return=o,se=g;else e:for(o=v;se!==null;){if(l=se,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ku(9,l)}}catch(S){ht(l,l.return,S)}if(l===o){se=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,se=b;break e}se=l.return}}if($e=i,Fi(),xn&&typeof xn.onPostCommitFiberRoot=="function")try{xn.onPostCommitFiberRoot(_u,t)}catch{}n=!0}return n}finally{He=r,jr.transition=e}}return!1}function qy(t,e,r){e=No(r,e),e=cw(t,e,1),t=wi(t,e,1),e=Jt(),t!==null&&(jl(t,1,e),ar(t,e))}function ht(t,e,r){if(t.tag===3)qy(t,t,r);else for(;e!==null;){if(e.tag===3){qy(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Si===null||!Si.has(n))){t=No(r,t),t=dw(e,t,1),e=wi(e,t,1),t=Jt(),e!==null&&(jl(e,1,t),ar(e,t));break}}e=e.return}}function xA(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Jt(),t.pingedLanes|=t.suspendedLanes&r,Pt===t&&(Ft&r)===r&&(Ct===4||Ct===3&&(Ft&130023424)===Ft&&500>mt()-Lg?ls(t,0):Dg|=r),ar(t,e)}function Rw(t,e){e===0&&(t.mode&1?(e=tc,tc<<=1,!(tc&130023424)&&(tc=4194304)):e=1);var r=Jt();t=Wn(t,e),t!==null&&(jl(t,e,r),ar(t,r))}function yA(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Rw(t,r)}function vA(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Y(314))}n!==null&&n.delete(e),Rw(t,r)}var Pw;Pw=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||sr.current)rr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return rr=!1,oA(t,e,r);rr=!!(t.flags&131072)}else rr=!1,et&&e.flags&1048576&&Bb(e,Dd,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;nd(t,e),t=e.pendingProps;var i=Ro(e,Vt.current);xo(e,r),i=Rg(null,e,n,t,i,r);var s=Pg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,or(n)?(s=!0,Nd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Tg(e),i.updater=Au,e.stateNode=i,i._reactInternals=e,bf(e,n,t,r),e=Ef(null,e,n,!0,s,r)):(e.tag=0,et&&s&&yg(e),Kt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(nd(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=bA(n),t=Wr(n,t),i){case 0:e=Sf(null,e,n,t,r);break e;case 1:e=Uy(null,e,n,t,r);break e;case 11:e=Fy(null,e,n,t,r);break e;case 14:e=Oy(null,e,n,Wr(n.type,t),r);break e}throw Error(Y(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Wr(n,i),Sf(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Wr(n,i),Uy(t,e,n,i,r);case 3:e:{if(fw(e),t===null)throw Error(Y(387));n=e.pendingProps,s=e.memoizedState,i=s.element,zb(t,e),Od(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=No(Error(Y(423)),e),e=zy(t,e,n,r,i);break e}else if(n!==i){i=No(Error(Y(424)),e),e=zy(t,e,n,r,i);break e}else for(fr=bi(e.stateNode.containerInfo.firstChild),yr=e,et=!0,Xr=null,r=Ob(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Po(),n===i){e=Vn(t,e,r);break e}Kt(t,e,n,r)}e=e.child}return e;case 5:return $b(e),t===null&&yf(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,pf(n,i)?o=null:s!==null&&pf(n,s)&&(e.flags|=32),pw(t,e),Kt(t,e,o,r),e.child;case 6:return t===null&&yf(e),null;case 13:return mw(t,e,r);case 4:return Cg(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=jo(e,null,n,r):Kt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Wr(n,i),Fy(t,e,n,i,r);case 7:return Kt(t,e,e.pendingProps,r),e.child;case 8:return Kt(t,e,e.pendingProps.children,r),e.child;case 12:return Kt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ye(Ld,n._currentValue),n._currentValue=o,s!==null)if(en(s.value,o)){if(s.children===i.children&&!sr.current){e=Vn(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=On(-1,r&-r),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),vf(s.return,r,e),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Y(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),vf(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Kt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,xo(e,r),i=Nr(i),n=n(i),e.flags|=1,Kt(t,e,n,r),e.child;case 14:return n=e.type,i=Wr(n,e.pendingProps),i=Wr(n.type,i),Oy(t,e,n,i,r);case 15:return uw(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Wr(n,i),nd(t,e),e.tag=1,or(n)?(t=!0,Nd(e)):t=!1,xo(e,r),lw(e,n,i),bf(e,n,i,r),Ef(null,e,n,!0,t,r);case 19:return gw(t,e,r);case 22:return hw(t,e,r)}throw Error(Y(156,e.tag))};function jw(t,e){return sb(t,e)}function _A(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(t,e,r,n){return new _A(t,e,r,n)}function zg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function bA(t){if(typeof t=="function")return zg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===og)return 11;if(t===ag)return 14}return 2}function Ti(t,e){var r=t.alternate;return r===null?(r=Ir(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function od(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")zg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qs:return cs(r.children,i,s,e);case sg:o=8,i|=8;break;case Hp:return t=Ir(12,r,e,i|2),t.elementType=Hp,t.lanes=s,t;case Wp:return t=Ir(13,r,e,i),t.elementType=Wp,t.lanes=s,t;case Vp:return t=Ir(19,r,e,i),t.elementType=Vp,t.lanes=s,t;case $1:return Ru(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case U1:o=10;break e;case z1:o=9;break e;case og:o=11;break e;case ag:o=14;break e;case si:o=16,n=null;break e}throw Error(Y(130,t==null?t:typeof t,""))}return e=Ir(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function cs(t,e,r,n){return t=Ir(7,t,n,e),t.lanes=r,t}function Ru(t,e,r,n){return t=Ir(22,t,n,e),t.elementType=$1,t.lanes=r,t.stateNode={isHidden:!1},t}function jh(t,e,r){return t=Ir(6,t,null,e),t.lanes=r,t}function Mh(t,e,r){return e=Ir(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function wA(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ph(0),this.expirationTimes=ph(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ph(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function $g(t,e,r,n,i,s,o,l,c){return t=new wA(t,e,r,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ir(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tg(s),t}function SA(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Js,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Mw(t){if(!t)return Ii;t=t._reactInternals;e:{if(Ts(t)!==t||t.tag!==1)throw Error(Y(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(or(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Y(171))}if(t.tag===1){var r=t.type;if(or(r))return Mb(t,r,e)}return e}function Nw(t,e,r,n,i,s,o,l,c){return t=$g(r,n,!0,t,i,s,o,l,c),t.context=Mw(null),r=t.current,n=Jt(),i=Ei(r),s=On(n,i),s.callback=e??null,wi(r,s,i),t.current.lanes=i,jl(t,i,n),ar(t,n),t}function Pu(t,e,r,n){var i=e.current,s=Jt(),o=Ei(i);return r=Mw(r),e.context===null?e.context=r:e.pendingContext=r,e=On(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=wi(i,e,o),t!==null&&(qr(t,i,o,s),ed(t,i,o)),o}function Xd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Zy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Gg(t,e){Zy(t,e),(t=t.alternate)&&Zy(t,e)}function EA(){return null}var Bw=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hg(t){this._internalRoot=t}ju.prototype.render=Hg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Y(409));Pu(t,e,null,null)};ju.prototype.unmount=Hg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ys(function(){Pu(null,t,null,null)}),e[Hn]=null}};function ju(t){this._internalRoot=t}ju.prototype.unstable_scheduleHydration=function(t){if(t){var e=hb();t={blockedOn:null,target:t,priority:e};for(var r=0;r<li.length&&e!==0&&e<li[r].priority;r++);li.splice(r,0,t),r===0&&fb(t)}};function Wg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Mu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Jy(){}function TA(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var d=Xd(o);s.call(d)}}var o=Nw(e,n,t,0,null,!1,!1,"",Jy);return t._reactRootContainer=o,t[Hn]=o.current,ul(t.nodeType===8?t.parentNode:t),ys(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var d=Xd(c);l.call(d)}}var c=$g(t,0,!1,null,null,!1,!1,"",Jy);return t._reactRootContainer=c,t[Hn]=c.current,ul(t.nodeType===8?t.parentNode:t),ys(function(){Pu(e,c,r,n)}),c}function Nu(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Xd(o);l.call(c)}}Pu(e,o,t,i)}else o=TA(r,e,t,i,n);return Xd(o)}db=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ia(e.pendingLanes);r!==0&&(dg(e,r|1),ar(e,mt()),!($e&6)&&(Bo=mt()+500,Fi()))}break;case 13:ys(function(){var n=Wn(t,1);if(n!==null){var i=Jt();qr(n,t,1,i)}}),Gg(t,1)}};ug=function(t){if(t.tag===13){var e=Wn(t,134217728);if(e!==null){var r=Jt();qr(e,t,134217728,r)}Gg(t,134217728)}};ub=function(t){if(t.tag===13){var e=Ei(t),r=Wn(t,e);if(r!==null){var n=Jt();qr(r,t,e,n)}Gg(t,e)}};hb=function(){return He};pb=function(t,e){var r=He;try{return He=t,e()}finally{He=r}};rf=function(t,e,r){switch(e){case"input":if(Kp(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Eu(n);if(!i)throw Error(Y(90));H1(n),Kp(n,i)}}}break;case"textarea":V1(t,r);break;case"select":e=r.value,e!=null&&po(t,!!r.multiple,e,!1)}};Q1=Fg;eb=ys;var CA={usingClientEntryPoint:!1,Events:[Nl,no,Eu,Z1,J1,Fg]},xa={findFiberByHostInstance:ss,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},AA={bundleType:xa.bundleType,version:xa.version,rendererPackageName:xa.rendererPackageName,rendererConfig:xa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Kn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nb(t),t===null?null:t.stateNode},findFiberByHostInstance:xa.findFiberByHostInstance||EA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hc.isDisabled&&hc.supportsFiber)try{_u=hc.inject(AA),xn=hc}catch{}}_r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CA;_r.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wg(e))throw Error(Y(200));return SA(t,e,null,r)};_r.createRoot=function(t,e){if(!Wg(t))throw Error(Y(299));var r=!1,n="",i=Bw;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=$g(t,1,!1,null,null,r,!1,n,i),t[Hn]=e.current,ul(t.nodeType===8?t.parentNode:t),new Hg(e)};_r.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Y(188)):(t=Object.keys(t).join(","),Error(Y(268,t)));return t=nb(e),t=t===null?null:t.stateNode,t};_r.flushSync=function(t){return ys(t)};_r.hydrate=function(t,e,r){if(!Mu(e))throw Error(Y(200));return Nu(null,t,e,!0,r)};_r.hydrateRoot=function(t,e,r){if(!Wg(t))throw Error(Y(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=Bw;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Nw(e,null,t,1,r??null,i,!1,s,o),t[Hn]=e.current,ul(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new ju(e)};_r.render=function(t,e,r){if(!Mu(e))throw Error(Y(200));return Nu(null,t,e,!1,r)};_r.unmountComponentAtNode=function(t){if(!Mu(t))throw Error(Y(40));return t._reactRootContainer?(ys(function(){Nu(null,null,t,!1,function(){t._reactRootContainer=null,t[Hn]=null})}),!0):!1};_r.unstable_batchedUpdates=Fg;_r.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Mu(r))throw Error(Y(200));if(t==null||t._reactInternals===void 0)throw Error(Y(38));return Nu(t,e,r,!1,n)};_r.version="18.3.1-next-f1338f8080-20240426";function Dw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Dw)}catch(t){console.error(t)}}Dw(),D1.exports=_r;var kA=D1.exports,Qy=kA;$p.createRoot=Qy.createRoot,$p.hydrateRoot=Qy.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _l(){return _l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_l.apply(this,arguments)}var fi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(fi||(fi={}));const e0="popstate";function IA(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:l}=n.location;return Df("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Yd(i)}return PA(e,r,null,t)}function bt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Vg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RA(){return Math.random().toString(36).substr(2,8)}function t0(t,e){return{usr:t.state,key:t.key,idx:e}}function Df(t,e,r,n){return r===void 0&&(r=null),_l({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Yo(e):e,{state:r,key:e&&e.key||n||RA()})}function Yd(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Yo(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function PA(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,l=fi.Pop,c=null,d=u();d==null&&(d=0,o.replaceState(_l({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function h(){l=fi.Pop;let y=u(),x=y==null?null:y-d;d=y,c&&c({action:l,location:_.location,delta:x})}function p(y,x){l=fi.Push;let v=Df(_.location,y,x);d=u()+1;let g=t0(v,d),b=_.createHref(v);try{o.pushState(g,"",b)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(b)}s&&c&&c({action:l,location:_.location,delta:1})}function f(y,x){l=fi.Replace;let v=Df(_.location,y,x);d=u();let g=t0(v,d),b=_.createHref(v);o.replaceState(g,"",b),s&&c&&c({action:l,location:_.location,delta:0})}function m(y){let x=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:Yd(y);return v=v.replace(/ $/,"%20"),bt(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let _={get action(){return l},get location(){return t(i,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(e0,h),c=y,()=>{i.removeEventListener(e0,h),c=null}},createHref(y){return e(i,y)},createURL:m,encodeLocation(y){let x=m(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:f,go(y){return o.go(y)}};return _}var r0;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(r0||(r0={}));function jA(t,e,r){return r===void 0&&(r="/"),MA(t,e,r)}function MA(t,e,r,n){let i=typeof e=="string"?Yo(e):e,s=Xg(i.pathname||"/",r);if(s==null)return null;let o=Lw(t);NA(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=VA(s);l=GA(o[c],d)}return l}function Lw(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(bt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Ci([n,c.relativePath]),u=r.concat(c);s.children&&s.children.length>0&&(bt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Lw(s.children,e,u,d)),!(s.path==null&&!s.index)&&e.push({path:d,score:zA(d,s.index),routesMeta:u})};return t.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let c of Fw(s.path))i(s,o,c)}),e}function Fw(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=Fw(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function NA(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:$A(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const BA=/^:[\w-]+$/,DA=3,LA=2,FA=1,OA=10,UA=-2,n0=t=>t==="*";function zA(t,e){let r=t.split("/"),n=r.length;return r.some(n0)&&(n+=UA),e&&(n+=LA),r.filter(i=>!n0(i)).reduce((i,s)=>i+(BA.test(s)?DA:s===""?FA:OA),n)}function $A(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function GA(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",h=HA({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),p=c.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Ci([s,h.pathname]),pathnameBase:ZA(Ci([s,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(s=Ci([s,h.pathnameBase]))}return o}function HA(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=WA(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((d,u,h)=>{let{paramName:p,isOptional:f}=u;if(p==="*"){let _=l[h]||"";o=s.slice(0,s.length-_.length).replace(/(.)\/+$/,"$1")}const m=l[h];return f&&!m?d[p]=void 0:d[p]=(m||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function WA(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Vg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function VA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Vg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Xg(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const XA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,YA=t=>XA.test(t);function KA(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Yo(t):t,s;if(r)if(YA(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Vg(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=i0(r.substring(1),"/"):s=i0(r,e)}else s=e;return{pathname:s,search:JA(n),hash:QA(i)}}function i0(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Nh(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function qA(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Ow(t,e){let r=qA(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Uw(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Yo(t):(i=_l({},t),bt(!i.pathname||!i.pathname.includes("?"),Nh("?","pathname","search",i)),bt(!i.pathname||!i.pathname.includes("#"),Nh("#","pathname","hash",i)),bt(!i.search||!i.search.includes("#"),Nh("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),h-=1;i.pathname=p.join("/")}l=h>=0?e[h]:"/"}let c=KA(i,l),d=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Ci=t=>t.join("/").replace(/\/\/+/g,"/"),ZA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),JA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,QA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function ek(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const zw=["post","put","patch","delete"];new Set(zw);const tk=["get",...zw];new Set(tk);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bl(){return bl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bl.apply(this,arguments)}const Yg=w.createContext(null),rk=w.createContext(null),Cs=w.createContext(null),Bu=w.createContext(null),As=w.createContext({outlet:null,matches:[],isDataRoute:!1}),$w=w.createContext(null);function nk(t,e){let{relative:r}=e===void 0?{}:e;Dl()||bt(!1);let{basename:n,navigator:i}=w.useContext(Cs),{hash:s,pathname:o,search:l}=Hw(t,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:Ci([n,o])),i.createHref({pathname:c,search:l,hash:s})}function Dl(){return w.useContext(Bu)!=null}function Oi(){return Dl()||bt(!1),w.useContext(Bu).location}function Gw(t){w.useContext(Cs).static||w.useLayoutEffect(t)}function cr(){let{isDataRoute:t}=w.useContext(As);return t?gk():ik()}function ik(){Dl()||bt(!1);let t=w.useContext(Yg),{basename:e,future:r,navigator:n}=w.useContext(Cs),{matches:i}=w.useContext(As),{pathname:s}=Oi(),o=JSON.stringify(Ow(i,r.v7_relativeSplatPath)),l=w.useRef(!1);return Gw(()=>{l.current=!0}),w.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let h=Uw(d,JSON.parse(o),s,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ci([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,o,s,t])}function Hw(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=w.useContext(Cs),{matches:i}=w.useContext(As),{pathname:s}=Oi(),o=JSON.stringify(Ow(i,n.v7_relativeSplatPath));return w.useMemo(()=>Uw(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function sk(t,e){return ok(t,e)}function ok(t,e,r,n){Dl()||bt(!1);let{navigator:i}=w.useContext(Cs),{matches:s}=w.useContext(As),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Oi(),u;if(e){var h;let y=typeof e=="string"?Yo(e):e;c==="/"||(h=y.pathname)!=null&&h.startsWith(c)||bt(!1),u=y}else u=d;let p=u.pathname||"/",f=p;if(c!=="/"){let y=c.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=jA(t,{pathname:f}),_=uk(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Ci([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Ci([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&_?w.createElement(Bu.Provider,{value:{location:bl({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:fi.Pop}},_):_}function ak(){let t=mk(),e=ek(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),r?w.createElement("pre",{style:i},r):null,null)}const lk=w.createElement(ak,null);class ck extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?w.createElement(As.Provider,{value:this.props.routeContext},w.createElement($w.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dk(t){let{routeContext:e,match:r,children:n}=t,i=w.useContext(Yg);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(As.Provider,{value:e},n)}function uk(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,l=(i=r)==null?void 0:i.errors;if(l!=null){let u=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||bt(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:p,errors:f}=r,m=h.route.loader&&p[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||m){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,h,p)=>{let f,m=!1,_=null,y=null;r&&(f=l&&h.route.id?l[h.route.id]:void 0,_=h.route.errorElement||lk,c&&(d<0&&p===0?(xk("route-fallback"),m=!0,y=null):d===p&&(m=!0,y=h.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,p+1)),v=()=>{let g;return f?g=_:m?g=y:h.route.Component?g=w.createElement(h.route.Component,null):h.route.element?g=h.route.element:g=u,w.createElement(dk,{match:h,routeContext:{outlet:u,matches:x,isDataRoute:r!=null},children:g})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?w.createElement(ck,{location:r.location,revalidation:r.revalidation,component:_,error:f,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var Ww=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Ww||{}),Vw=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Vw||{});function hk(t){let e=w.useContext(Yg);return e||bt(!1),e}function pk(t){let e=w.useContext(rk);return e||bt(!1),e}function fk(t){let e=w.useContext(As);return e||bt(!1),e}function Xw(t){let e=fk(),r=e.matches[e.matches.length-1];return r.route.id||bt(!1),r.route.id}function mk(){var t;let e=w.useContext($w),r=pk(),n=Xw();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function gk(){let{router:t}=hk(Ww.UseNavigateStable),e=Xw(Vw.UseNavigateStable),r=w.useRef(!1);return Gw(()=>{r.current=!0}),w.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,bl({fromRouteId:e},s)))},[t,e])}const s0={};function xk(t,e,r){s0[t]||(s0[t]=!0)}function yk(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function ur(t){bt(!1)}function vk(t){let{basename:e="/",children:r=null,location:n,navigationType:i=fi.Pop,navigator:s,static:o=!1,future:l}=t;Dl()&&bt(!1);let c=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:c,navigator:s,static:o,future:bl({v7_relativeSplatPath:!1},l)}),[c,l,s,o]);typeof n=="string"&&(n=Yo(n));let{pathname:u="/",search:h="",hash:p="",state:f=null,key:m="default"}=n,_=w.useMemo(()=>{let y=Xg(u,c);return y==null?null:{location:{pathname:y,search:h,hash:p,state:f,key:m},navigationType:i}},[c,u,h,p,f,m,i]);return _==null?null:w.createElement(Cs.Provider,{value:d},w.createElement(Bu.Provider,{children:r,value:_}))}function _k(t){let{children:e,location:r}=t;return sk(Lf(e),r)}new Promise(()=>{});function Lf(t,e){e===void 0&&(e=[]);let r=[];return w.Children.forEach(t,(n,i)=>{if(!w.isValidElement(n))return;let s=[...e,i];if(n.type===w.Fragment){r.push.apply(r,Lf(n.props.children,s));return}n.type!==ur&&bt(!1),!n.props.index||!n.props.children||bt(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Lf(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ff(){return Ff=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ff.apply(this,arguments)}function bk(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function wk(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Sk(t,e){return t.button===0&&(!e||e==="_self")&&!wk(t)}function Of(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function Ek(t,e){let r=Of(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(s=>{r.append(i,s)})}),r}const Tk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ck="6";try{window.__reactRouterVersion=Ck}catch{}const Ak="startTransition",o0=xC[Ak];function kk(t){let{basename:e,children:r,future:n,window:i}=t,s=w.useRef();s.current==null&&(s.current=IA({window:i,v5Compat:!0}));let o=s.current,[l,c]=w.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},u=w.useCallback(h=>{d&&o0?o0(()=>c(h)):c(h)},[c,d]);return w.useLayoutEffect(()=>o.listen(u),[o,u]),w.useEffect(()=>yk(n),[n]),w.createElement(vk,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const Ik=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Rk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,a0=w.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:h}=e,p=bk(e,Tk),{basename:f}=w.useContext(Cs),m,_=!1;if(typeof d=="string"&&Rk.test(d)&&(m=d,Ik))try{let g=new URL(window.location.href),b=d.startsWith("//")?new URL(g.protocol+d):new URL(d),S=Xg(b.pathname,f);b.origin===g.origin&&S!=null?d=S+b.search+b.hash:_=!0}catch{}let y=nk(d,{relative:i}),x=Pk(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:i,viewTransition:h});function v(g){n&&n(g),g.defaultPrevented||x(g)}return w.createElement("a",Ff({},p,{href:m||y,onClick:_||s?n:v,ref:r,target:c}))});var l0;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(l0||(l0={}));var c0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(c0||(c0={}));function Pk(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:l}=e===void 0?{}:e,c=cr(),d=Oi(),u=Hw(t,{relative:o});return w.useCallback(h=>{if(Sk(h,r)){h.preventDefault();let p=n!==void 0?n:Yd(d)===Yd(u);c(t,{replace:p,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[d,c,u,n,i,r,t,s,o,l])}function Ko(t){let e=w.useRef(Of(t)),r=w.useRef(!1),n=Oi(),i=w.useMemo(()=>Ek(n.search,r.current?null:e.current),[n.search]),s=cr(),o=w.useCallback((l,c)=>{const d=Of(typeof l=="function"?l(i):l);r.current=!0,s("?"+d,c)},[s,i]);return[i,o]}function jk(){const t=cr(),[e,r]=w.useState(0),[n,i]=w.useState(!1),s=w.useRef(null),o=80;return w.useEffect(()=>{const l=s.current;if(!l)return;let c=0,d=0,u=!1;const h=m=>{l.scrollTop===0&&(c=m.touches[0].clientY,u=!0,console.log("Pull-to-refresh: Touch started"))},p=m=>{if(!u)return;d=m.touches[0].clientY;const _=d-c;if(_>0){m.preventDefault();const y=Math.pow(_,.85);r(Math.min(y,o*1.5)),console.log("Pull distance:",Math.min(y,o*1.5).toFixed(0))}},f=()=>{e>o?(i(!0),r(0),setTimeout(()=>{window.location.reload()},400)):r(0),u=!1};return l.addEventListener("touchstart",h,{passive:!0}),l.addEventListener("touchmove",p,{passive:!1}),l.addEventListener("touchend",f),()=>{l.removeEventListener("touchstart",h),l.removeEventListener("touchmove",p),l.removeEventListener("touchend",f)}},[e]),a.jsxs("div",{ref:s,className:"screen screen-center",style:{position:"relative",overflow:"auto"},children:[a.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:`${e}px`,display:"flex",alignItems:"flex-end",justifyContent:"center",paddingBottom:"8px",opacity:Math.min(e/o,1),transition:e===0?"all 0.3s ease":"none",pointerEvents:"none",zIndex:10},children:n?a.jsx("div",{style:{width:"24px",height:"24px",border:"3px solid var(--color-surface)",borderTop:"3px solid var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}):a.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",fontWeight:600},children:e>o?" Release to refresh":" Pull to refresh"})}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",zIndex:1,transform:`translateY(${e}px)`,transition:e===0?"transform 0.3s ease":"none",paddingBottom:"120px"},children:[a.jsx("img",{src:"/data/icons/OwlHeadphones.png",alt:"ChipNotes Owl Professor",style:{width:"180px",height:"180px",borderRadius:"50%",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",marginBottom:"4px"}}),a.jsx("h1",{style:{margin:0,fontSize:"44px",fontWeight:800,letterSpacing:"-1px",background:"linear-gradient(135deg, #FFD54F 0%, #FF8A65 50%, #E57373 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"ChipNotes!"}),a.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"16px",maxWidth:"280px",textAlign:"center",lineHeight:1.4,marginTop:"-4px",fontWeight:600},children:"Train your ear. Know the birds."}),a.jsx("button",{onClick:()=>t("/pack-select"),style:{marginTop:"16px",padding:"18px 64px",fontSize:"20px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"16px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.4)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:l=>{l.currentTarget.style.transform="translateY(-2px)",l.currentTarget.style.boxShadow="0 6px 20px rgba(45, 90, 39, 0.5)"},onMouseLeave:l=>{l.currentTarget.style.transform="translateY(0)",l.currentTarget.style.boxShadow="0 4px 16px rgba(45, 90, 39, 0.4)"},children:"Play"}),a.jsx("div",{style:{marginTop:"20px",padding:"16px",background:"var(--color-surface)",borderRadius:"16px",maxWidth:"360px"},children:a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px"},children:[a.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[a.jsx("div",{style:{width:"72px",height:"52px",background:"linear-gradient(180deg, #1a1a2e 0%, #0d1520 100%)",borderRadius:"10px",padding:"6px",display:"flex",alignItems:"flex-end",justifyContent:"center",gap:"2px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.3)"},children:a.jsx(Mk,{})}),a.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Hear"})]}),a.jsx("div",{style:{color:"var(--color-accent)",opacity:.5,fontSize:"24px",marginTop:"-16px"},children:""}),a.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"4px"},children:["NOCA","BLJA","TUTI","CARW"].map((l,c)=>a.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",overflow:"hidden",border:c===0?"2px solid var(--color-accent)":"2px solid transparent",boxShadow:c===0?"0 0 8px rgba(255, 152, 0, 0.4)":"none"},children:a.jsx("img",{src:`/data/icons/${l}.png`,alt:l,style:{width:"100%",height:"100%",objectFit:"cover"}})},l))}),a.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Match"})]}),a.jsx("div",{style:{color:"var(--color-accent)",opacity:.5,fontSize:"24px",marginTop:"-16px"},children:""}),a.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[a.jsx("div",{style:{width:"72px",height:"52px",background:"#2a2a3e",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.4)"},children:a.jsx("div",{style:{fontSize:"32px"},children:""})}),a.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Train"})]})]})})]}),a.jsxs("div",{style:{position:"absolute",bottom:"70px",left:0,right:0,display:"flex",justifyContent:"center",gap:"40px",zIndex:1e3},children:[a.jsxs("button",{className:"btn-icon",onClick:()=>t("/help"),"aria-label":"How to Play",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[a.jsx("div",{style:{transform:"scale(1.1)"},children:a.jsx(Nk,{})}),a.jsx("span",{style:{fontSize:"10px",fontWeight:500,color:"var(--color-text-muted)",whiteSpace:"nowrap"},children:"How To"})]}),a.jsxs("button",{className:"btn-icon",onClick:()=>t("/settings"),"aria-label":"Settings",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[a.jsx("div",{style:{transform:"scale(1.1)"},children:a.jsx(Bk,{})}),a.jsx("span",{style:{fontSize:"10px",fontWeight:500,color:"var(--color-text-muted)"},children:"Settings"})]}),a.jsxs("button",{className:"btn-icon",onClick:()=>t("/progress"),"aria-label":"Progress",style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[a.jsx("div",{style:{transform:"scale(1.1)"},children:a.jsx(Dk,{})}),a.jsx("span",{style:{fontSize:"10px",fontWeight:500,color:"var(--color-text-muted)"},children:"Stats"})]})]}),a.jsx("button",{onClick:()=>t("/help",{state:{openVersionHistory:!0}}),style:{position:"absolute",bottom:"calc(4px + var(--safe-area-bottom, 0px))",left:0,right:0,textAlign:"center",fontSize:"11px",color:"var(--color-accent)",opacity:.6,background:"none",border:"none",cursor:"pointer",padding:"4px",transition:"opacity 0.2s",zIndex:1001},onMouseEnter:l=>l.currentTarget.style.opacity="1",onMouseLeave:l=>l.currentTarget.style.opacity="0.6","aria-label":"View version history",children:"v4.20"})]})}function Mk(){const t=[8,16,24,32,26,34,28,36,20,12,26,32];return a.jsx("svg",{width:"76",height:"40",viewBox:"0 0 76 40",children:t.map((e,r)=>a.jsx("rect",{x:r*6+2,y:40-e,width:"4",height:e,rx:"1.5",fill:`hsl(${30+r*8}, 80%, ${50+r*2}%)`,opacity:.8+r*.015},r))})}function Nk(){return a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}function Bk(){return a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"})]})}function Dk(){return a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 3v18h18"}),a.jsx("path",{d:"M7 16l4-4 4 4 6-6"})]})}function dr(t,e){typeof window.gtag=="function"&&window.gtag("event",t,e)}function Yw(t,e){dr("pack_select",{pack_id:t,pack_name:e})}function Lk(t,e,r){dr("game_start",{pack_id:t,level_id:e,species_count:r})}function Fk(t,e,r,n,i){dr("round_complete",{pack_id:t,level_id:e,score:r,accuracy:n,duration_sec:i})}function Ok(t){dr("training_mode_toggle",{enabled:t})}function Uk(t,e,r){dr("level_select",{pack_id:t,level_id:e,level_title:r})}function Kw(t,e){dr("taxonomic_sort_toggle",{enabled:t,location:e})}function d0(t){dr("custom_pack_create",{species_count:t})}function u0(t,e){dr("custom_pack_save",{pack_name:t,species_count:e})}function zk(t,e){dr("custom_pack_load",{pack_name:t,species_count:e})}function $k(t){dr("custom_pack_delete",{pack_name:t})}function Za(t,e,r){dr("external_link_click",{url:t,link_type:e,location:r})}function vo(t,e){dr("nz_sort_mode_change",{mode:t,location:e})}const h0=[{id:"starter_birds",name:"Backyard Birds",speciesCount:6,isUnlocked:!0,description:"Start here! Distinctive, bold, recognizable voices.",region:"na"},{id:"grassland_birds",name:"Grasslands",speciesCount:10,isUnlocked:!0,description:"From prairies to farmland: meadowlarks, buntings, and field singers.",region:"na"},{id:"expanded_backyard",name:"Eastern Birds",speciesCount:60,isUnlocked:!0,description:`Ready for more feathered friends? 9 random
per round.`,region:"na"},{id:"western_birds",name:"Western Birds",speciesCount:26,isUnlocked:!0,description:"Frequent flyers from the Pacific coast to the Rockies.",region:"na"},{id:"woodpeckers",name:"Woodpeckers",speciesCount:9,isUnlocked:!0,description:"Drums, calls, and rattles.",region:"na"},{id:"sparrows",name:"Sparrows",speciesCount:9,isUnlocked:!0,description:"Master their subtle songs.",region:"na"},{id:"spring_warblers",name:"Warbler Academy",speciesCount:34,isUnlocked:!0,description:`9 random per round. Custom Pack
mode recommended!`,region:"na"}];function Gk(){var F,U,k;const t=cr(),e=Oi(),[r]=Ko(),[n,i]=w.useState([]),[s,o]=w.useState({}),[l,c]=w.useState(null),[d,u]=w.useState(null),[h,p]=w.useState(new Set),[f,m]=w.useState(!1),[_,y]=w.useState(!1),[x,v]=w.useState({}),[g,b]=w.useState({}),[S,j]=w.useState({}),E=w.useRef(null);w.useEffect(()=>{fetch("/data/clips.json").then(R=>R.json()).then(R=>{i(R);const z=Array.from(new Set(R.filter(N=>!N.rejected&&(!N.spectrogram_path||!N.spectrogram_path.includes("spectrograms-rejected"))).map(N=>N.species_code))).sort();o(N=>({...N,all_birds:z}))}).catch(R=>console.error("Failed to load clips:",R))},[]),w.useEffect(()=>{fetch("/data/taxonomic_order.json").then(R=>R.json()).then(R=>{v(R)}).catch(R=>console.error("Failed to load taxonomic order:",R))},[]),w.useEffect(()=>{fetch("/data/species.json").then(R=>R.json()).then(R=>{const z={},N={};R.forEach(P=>{z[P.species_code]=P.scientific_name,N[P.species_code]=P.common_name}),b(z),j(N)}).catch(R=>console.error("Failed to load species metadata:",R))},[]),w.useEffect(()=>{const R=["starter_birds","grassland_birds","expanded_backyard","sparrows","woodpeckers","spring_warblers","western_birds","nz_all_birds","nz_common","nz_north_island","nz_south_island"];Promise.all(R.map(z=>fetch(`/data/packs/${z}.json`).then(N=>N.json()).catch(N=>(console.error(`Failed to load pack ${z}:`,N),null)))).then(z=>{const N={};z.forEach((P,L)=>{P&&P.species&&(N[R[L]]=P.display_species||P.species)}),o(P=>({...P,...N}))})},[]);const T=R=>{const N=(s[R]||[]).map(P=>{const L=n.filter(A=>A.species_code===P&&!A.rejected&&(!A.spectrogram_path||!A.spectrogram_path.includes("spectrograms-rejected"))),D=L.find(A=>A.canonical)||L[0],C=L.sort((A,O)=>A.canonical&&!O.canonical?-1:!A.canonical&&O.canonical?1:A.clip_id.localeCompare(O.clip_id)).map(A=>({id:A.clip_id,path:`/${A.file_path}`,isCanonical:!!A.canonical,vocalizationType:A.vocalization_type,source:A.source,sourceId:A.source_id,sourceUrl:A.source_url,recordist:A.recordist}));return{code:P,name:S[P]||P,canonicalClipPath:D?`/${D.file_path}`:null,clipCount:L.length,allClips:C}});return _&&Object.keys(x).length>0?N.sort((P,L)=>{const I=x[P.code]||9999,D=x[L.code]||9999;return I-D}):N.sort((P,L)=>P.code.localeCompare(L.code))},B=R=>{R.isUnlocked&&(Yw(R.id,R.name),t(`/level-select?pack=${R.id}`))},M=(R,z)=>{if(E.current&&(E.current.pause(),E.current=null),l===z){c(null);return}const N=new Audio(R);E.current=N,c(z),N.play().catch(P=>console.error("Failed to play audio:",P)),N.onended=()=>{c(null),E.current=null}};return w.useEffect(()=>()=>{E.current&&E.current.pause()},[]),w.useEffect(()=>{const R=r.get("expand")||r.get("expandPack");R&&p(new Set([R])),window.location.hash&&setTimeout(()=>{const z=document.querySelector(window.location.hash);z&&z.scrollIntoView({behavior:"smooth",block:"start"})},100)},[r]),a.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[a.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[a.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:a.jsx(Hk,{})}),a.jsx("h2",{style:{margin:0},children:"Select a Bird Pack"})]}),a.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.6,background:"rgba(70, 70, 90, 0.5)",padding:"16px",borderRadius:"12px"},children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[a.jsx("li",{style:{fontWeight:600},children:"Best on a phone/tablet, with "}),a.jsx("li",{children:"No sound? Check if  is on silent "}),a.jsxs("li",{children:["6 levelsstart @ #1, young Grasshopper ",a.jsx("img",{src:"/data/icons/SAVS.png",alt:"",style:{width:"18px",height:"18px",verticalAlign:"middle",marginLeft:"2px",borderRadius:"3px"}})]}),a.jsxs("li",{children:["Try training mode ()"," ",a.jsx(a0,{to:"/help#training-mode",state:{fromPackSelect:!0},style:{color:"var(--color-accent)"},children:"Help "})]}),a.jsxs("li",{children:["Timer anxiety? Use Continuous Play"," ",a.jsx(a0,{to:"/settings",state:{fromPackSelect:!0},style:{color:"var(--color-accent)"},children:" "})]}),a.jsx("li",{children:" Check out the full sound library below"})]})}),a.jsxs("div",{style:{marginBottom:"20px",background:"var(--color-surface)",border:"2px solid rgba(245, 166, 35, 0.7)",borderRadius:"16px",overflow:"visible"},children:[a.jsxs("div",{onClick:()=>t("/custom-pack"),style:{display:"flex",alignItems:"center",gap:"12px",padding:"20px",cursor:"pointer",transition:"all 0.2s",minHeight:"80px"},onMouseEnter:R=>{R.currentTarget.style.background="rgba(45, 90, 39, 0.15)"},onMouseLeave:R=>{R.currentTarget.style.background="transparent"},children:[a.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(245, 166, 35, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",color:"#000",flexShrink:0},children:a.jsx(Vk,{})}),a.jsxs("div",{style:{flex:1,minWidth:0},children:[a.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#f5f0e6"},children:"Create Custom Pack"}),a.jsx("button",{onClick:R=>{R.stopPropagation(),m(!f)},style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"12px",cursor:"pointer",padding:"0",textDecoration:"underline",marginTop:"4px"},children:f?"Hide examples":"See examples"})]})]}),f&&a.jsx("div",{onClick:()=>t("/custom-pack"),style:{padding:"0 16px 16px 16px",cursor:"pointer"},children:a.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6,borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"12px"},children:[a.jsxs("div",{style:{marginBottom:"8px"},children:[a.jsx("span",{style:{color:"var(--color-accent)",opacity:.6},children:""})," Got a nemesis bird? Add it and drill all its variations."]}),a.jsxs("div",{style:{marginBottom:"8px"},children:[a.jsx("span",{style:{color:"var(--color-accent)",opacity:.6},children:""})," A friend's eBird checklist has you jealous? Build their list and practice like you were there."]}),a.jsxs("div",{style:{marginBottom:"8px"},children:[a.jsx("span",{style:{color:"var(--color-accent)",opacity:.6},children:""})," Constantly confuse Kinglets, Creepers and Waxwings? Put them head-to-head."]}),a.jsxs("div",{style:{marginBottom:"8px"},children:[a.jsx("span",{style:{color:"var(--color-accent)",opacity:.6},children:""})," Warbler Wizard Wannabe? Training starts here!"]}),a.jsxs("div",{style:{marginBottom:"8px"},children:[a.jsx("span",{style:{color:"var(--color-accent)",opacity:.6},children:""})," You think you know your woodpeckers? Try the Pileated vs. Northern Flicker on Level 5."]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("span",{style:{color:"var(--color-accent)",opacity:.6},children:""})," Mix species from any pack  your rules, your practice."]}),a.jsx("div",{style:{marginTop:"12px",padding:"10px 16px",background:"rgba(245, 166, 35, 0.5)",borderRadius:"8px",color:"#f5f0e6",fontWeight:600,textAlign:"center"},children:"Click to Get Started "})]})})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"32px"},children:h0.map(R=>{const z={starter_birds:"linear-gradient(135deg, #2d5a3d 0%, #1a3d2a 100%)",grassland_birds:"linear-gradient(135deg, #7a6b2d 0%, #5a4a1a 100%)",expanded_backyard:"linear-gradient(135deg, #3d5a6e 0%, #2a3d4a 100%)",sparrows:"linear-gradient(135deg, #6b5344 0%, #4a3a2e 100%)",woodpeckers:"linear-gradient(135deg, #6e3d3d 0%, #4a2a2a 100%)",western_birds:"linear-gradient(135deg, #5a4a7a 0%, #3a2a5a 100%)",spring_warblers:"linear-gradient(135deg, #c46a28 0%, #8a4a18 100%)"},N={starter_birds:"NOCA",grassland_birds:"EAME",expanded_backyard:"AGOL",sparrows:"WTSP",woodpeckers:"PIWO",western_birds:"STJA",spring_warblers:"BLBW"};return a.jsxs("button",{onClick:()=>B(R),style:{position:"relative",overflow:"hidden",textAlign:"left",padding:"12px 12px 14px 12px",borderRadius:"16px",border:"none",background:z[R.id]||z.starter_birds,boxShadow:R.isUnlocked?"0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"none",opacity:R.isUnlocked?1:.5,cursor:R.isUnlocked?"pointer":"not-allowed",transition:"transform 0.2s, box-shadow 0.2s",gridColumn:R.id==="spring_warblers"?"1 / -1":"auto"},onMouseEnter:P=>{R.isUnlocked&&(P.currentTarget.style.transform="translateY(-2px)",P.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1)")},onMouseLeave:P=>{P.currentTarget.style.transform="translateY(0)",P.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[a.jsx("img",{src:`/data/icons/${N[R.id]}.png`,alt:"",style:{position:"absolute",right:"-10px",bottom:"-10px",width:"80px",height:"80px",opacity:.75,filter:"brightness(1.2)",transform:"rotate(-15deg)",objectFit:"cover"}}),R.isUnlocked&&a.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:2},children:a.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#a8d5a2",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Play ",a.jsx(Wk,{})]})}),a.jsxs("div",{style:{position:"relative",zIndex:1,paddingTop:R.id==="spring_warblers"?0:"8px"},children:[a.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#f5f0e6",lineHeight:1.3,marginBottom:"6px",paddingRight:"50px",textShadow:"0 1px 3px rgba(0, 0, 0, 0.5)"},children:R.name}),a.jsx("div",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.75)",lineHeight:1.4,marginBottom:"10px",whiteSpace:"pre-line",textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:R.description}),a.jsx("div",{children:a.jsxs("span",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.7)",fontWeight:500},children:[R.speciesCount," species"]})})]})]},R.id)})}),a.jsxs("button",{onClick:()=>t("/nz-packs"),style:{width:"100%",display:"flex",alignItems:"center",gap:"12px",marginBottom:"32px",padding:"16px 20px",background:"linear-gradient(135deg, #2a7a6a 0%, #1a5a4a 100%)",borderRadius:"16px",border:"2px solid rgba(100, 200, 180, 0.5)",cursor:"pointer",transition:"all 0.2s",textAlign:"left",position:"relative",overflow:"hidden"},onMouseEnter:R=>{R.currentTarget.style.transform="translateY(-2px)",R.currentTarget.style.boxShadow="0 6px 20px rgba(100, 200, 180, 0.3)",R.currentTarget.style.borderColor="rgba(100, 200, 180, 0.8)"},onMouseLeave:R=>{R.currentTarget.style.transform="translateY(0)",R.currentTarget.style.boxShadow="none",R.currentTarget.style.borderColor="rgba(100, 200, 180, 0.5)"},children:[a.jsx("img",{src:"/data/icons/yeepen1.png",alt:"",style:{position:"absolute",right:"-10px",bottom:"-10px",width:"80px",height:"80px",opacity:.75,filter:"brightness(1.2)",transform:"rotate(-15deg)",objectFit:"cover"}}),a.jsx("span",{style:{fontSize:"32px",position:"relative",zIndex:1},children:""}),a.jsxs("div",{style:{flex:1,position:"relative",zIndex:1},children:[a.jsxs("h3",{style:{margin:0,fontSize:"18px",color:"#a8d5a2",fontWeight:700},children:["New Zealand Birds ",a.jsx("span",{style:{fontSize:"16px"},children:""})]}),a.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:"13px",color:"var(--color-text-muted)"},children:["37 native species from",a.jsx("br",{}),"Aotearoa New Zealand  4 packs"]})]})]}),a.jsxs("div",{id:"bird-reference",style:{marginTop:"16px",scrollMarginTop:"20px"},children:[((F=e.state)==null?void 0:F.fromLevelSelect)&&((U=e.state)==null?void 0:U.packId)&&a.jsx("div",{style:{marginBottom:"16px"},children:a.jsxs("button",{onClick:()=>t(`/level-select?pack=${e.state.packId}`),style:{background:"var(--color-accent)",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Level Select",children:[a.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Level Select"]})}),((k=e.state)==null?void 0:k.fromHelp)&&a.jsx("div",{style:{marginBottom:"16px"},children:a.jsxs("button",{onClick:()=>t("/help"),style:{background:"var(--color-accent)",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Help",children:[a.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Help"]})}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"12px"},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{fontSize:"16px",margin:0,color:"var(--color-text-muted)"},children:"Sound Library"}),a.jsx("div",{style:{fontSize:"14px",marginTop:"2px"},children:""})]}),a.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:a.jsxs("div",{style:{display:"flex",borderRadius:"6px",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.15)"},children:[a.jsx("button",{onClick:()=>y(!1),style:{padding:"6px 10px",background:_?"rgba(255, 255, 255, 0.05)":"rgba(245, 166, 35, 0.3)",border:"none",borderRight:"1px solid rgba(255, 255, 255, 0.15)",cursor:"pointer",fontSize:"11px",color:_?"var(--color-text-muted)":"var(--color-accent)",fontWeight:_?400:600},title:"Sort alphabetically by species code",children:" A-Z"}),a.jsx("button",{onClick:()=>y(!0),style:{padding:"6px 10px",background:_?"rgba(245, 166, 35, 0.3)":"rgba(255, 255, 255, 0.05)",border:"none",cursor:"pointer",fontSize:"11px",color:_?"var(--color-accent)":"var(--color-text-muted)",fontWeight:_?600:400},title:"Sort by taxonomic order",children:" Taxonomy"})]})})]}),a.jsxs("div",{style:{background:"rgba(255, 200, 50, 0.12)",border:"1px solid rgba(255, 200, 50, 0.3)",borderRadius:"8px",padding:"10px 14px",marginBottom:"16px",fontSize:"13px",color:"rgba(255, 255, 255, 0.8)",lineHeight:"1.4"},children:[a.jsx("span",{style:{marginRight:"6px"},children:""}),"Sound library under construction. Sound type labels (song, call, etc.) are being reviewed and corrected  don't rely on them just yet."]}),a.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"20px",paddingLeft:"12px",borderLeft:"3px solid rgba(245, 166, 35, 0.5)"},children:"Preview signature sounds for each bird before you play. Click pack names to expand and see all birds, or click individual birds to explore their full library of recordings."}),s.all_birds&&(()=>{var N;const R="all_birds",z=h.has(R);return a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsxs("div",{onClick:()=>{const P=new Set(h);P.has(R)?P.delete(R):P.add(R),p(P)},style:{fontSize:"14px",marginBottom:z?"12px":"0",color:"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:P=>P.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:P=>P.currentTarget.style.background="var(--color-surface)",children:[a.jsx("span",{style:{fontSize:"14px",color:"var(--color-accent)",opacity:.6},children:z?"":""}),a.jsx("span",{style:{fontWeight:600,color:"var(--color-accent)",opacity:.85},children:"All Birds"}),a.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((N=s[R])==null?void 0:N.length)||0," species"]})]}),z&&a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:T(R).map(P=>{const L=d===P.code;return a.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:P.clipCount>1?"pointer":"default"},onClick:()=>{P.clipCount>1&&u(L?null:P.code)},children:[a.jsx(m0,{code:P.code,size:36}),a.jsxs("div",{style:{minWidth:0,flex:1},children:[a.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:P.code}),a.jsx("div",{style:{fontSize:"13px",fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:P.name}),_&&g[P.code]&&a.jsx("div",{style:{fontSize:"11px",fontStyle:"italic",color:"var(--color-text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:g[P.code]})]}),P.canonicalClipPath&&a.jsx("button",{onClick:I=>{I.stopPropagation(),M(P.canonicalClipPath,P.code)},style:{width:"32px",height:"32px",borderRadius:"50%",border:"none",background:l===P.code?"var(--color-accent)":"rgba(245, 166, 35, 0.3)",color:l===P.code?"#000":"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px"},children:l===P.code?"":""}),P.clipCount>1&&a.jsx("span",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:L?"":""})]}),L&&P.allClips.length>0&&a.jsxs("div",{style:{padding:"0 12px 12px 12px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[a.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"8px",marginBottom:"8px",fontWeight:600},children:["All Recordings (",P.allClips.length,")"]}),P.allClips.map((I,D)=>a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",padding:"6px",background:"rgba(0,0,0,0.2)",borderRadius:"6px"},children:[a.jsx("button",{onClick:()=>M(I.path,`${P.code}_${D}`),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:l===`${P.code}_${D}`?"var(--color-accent)":"rgba(245, 166, 35, 0.3)",color:l===`${P.code}_${D}`?"#000":"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",flexShrink:0},children:l===`${P.code}_${D}`?"":""}),a.jsx("div",{style:{flex:1,fontSize:"11px"},children:a.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",flexWrap:"wrap"},children:[I.isCanonical&&a.jsx("span",{style:{fontSize:"9px",background:"var(--color-accent)",color:"#000",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"SIGNATURE"}),a.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:I.vocalizationType==="song"?"rgba(76, 175, 80, 0.2)":"rgba(245, 166, 35, 0.2)",padding:"2px 6px",borderRadius:"4px",textTransform:"uppercase"},children:I.vocalizationType}),(I.source||I.recordist)&&a.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:I.sourceUrl?a.jsxs("a",{href:I.sourceUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:[I.sourceId,I.recordist?`  ${I.recordist}`:""]}):a.jsxs(a.Fragment,{children:[I.source==="macaulay"?I.sourceId||"Cornell":I.source==="user_recording"?I.recordist||"User":I.sourceId||I.source,I.source!=="user_recording"&&I.recordist&&!I.sourceId&&`  ${I.recordist}`]})})]})})]},I.id))]})]},P.code)})})]},R)})(),h0.filter(R=>R.isUnlocked).map(R=>{var N,P,L;const z=h.has(R.id);return a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsxs("div",{onClick:()=>{const I=new Set(h);I.has(R.id)?I.delete(R.id):I.add(R.id),p(I)},style:{fontSize:"14px",marginBottom:z?"12px":"0",color:"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:I=>I.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:I=>I.currentTarget.style.background="var(--color-surface)",children:[a.jsx("span",{style:{fontSize:"14px",color:"var(--color-accent)",opacity:.6},children:z?"":""}),a.jsx("span",{style:{fontWeight:600,color:"var(--color-accent)",opacity:.85},children:R.name}),a.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((N=s[R.id])==null?void 0:N.length)||0," species"]})]}),z&&((P=e.state)==null?void 0:P.fromPreview)&&((L=e.state)==null?void 0:L.pack)===R.id&&a.jsx("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{onClick:()=>{const{pack:I,level:D}=e.state;t(`/preview?pack=${I}&level=${D}&keepBirds=true`)},style:{padding:"10px 16px",fontSize:"14px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 4px 12px rgba(45, 90, 39, 0.4)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:I=>{I.currentTarget.style.transform="scale(1.05)",I.currentTarget.style.boxShadow="0 6px 16px rgba(45, 90, 39, 0.5)"},onMouseLeave:I=>{I.currentTarget.style.transform="scale(1)",I.currentTarget.style.boxShadow="0 4px 12px rgba(45, 90, 39, 0.4)"},children:"Ready to Play?"})}),z&&a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:T(R.id).map(I=>{const D=d===I.code;return a.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:I.clipCount>1?"pointer":"default"},onClick:()=>{I.clipCount>1&&u(D?null:I.code)},children:[a.jsx(m0,{code:I.code,size:36}),a.jsxs("div",{style:{minWidth:0,flex:1},children:[a.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:I.code}),a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:I.name}),_&&g[I.code]&&a.jsx("div",{style:{fontSize:"10px",fontStyle:"italic",color:"var(--color-text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:g[I.code]}),a.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)"},children:[I.clipCount," clip",I.clipCount!==1?"s":"",I.clipCount>1&&a.jsx("span",{style:{marginLeft:"4px",color:"var(--color-accent)",opacity:.6},children:D?"":""})]})]}),a.jsx("button",{onClick:C=>{C.stopPropagation(),I.canonicalClipPath&&M(I.canonicalClipPath,I.code)},disabled:!I.canonicalClipPath,style:{width:"28px",height:"28px",borderRadius:"50%",border:"none",background:l===I.code?"var(--color-accent)":"rgba(245, 166, 35, 0.3)",color:l===I.code?"#000":"var(--color-accent)",cursor:I.canonicalClipPath?"pointer":"not-allowed",opacity:I.canonicalClipPath?1:.3,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play ${I.name}`,children:l===I.code?a.jsx(f0,{}):a.jsx(p0,{})})]}),D&&I.allClips.length>0&&a.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"8px 12px",background:"rgba(0,0,0,0.2)"},children:[a.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"8px"},children:["All ",I.clipCount," clips:"]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:I.allClips.map((C,A)=>a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("button",{onClick:()=>M(C.path,C.id),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:l===C.id?"var(--color-accent)":"rgba(245, 166, 35, 0.3)",color:l===C.id?"#000":"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play clip ${A+1}`,children:l===C.id?a.jsx(f0,{size:8}):a.jsx(p0,{size:8})}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px",flex:1},children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[a.jsx("span",{style:{fontSize:"11px",color:"var(--color-text)"},children:C.sourceId||`Clip ${A+1}`}),C.isCanonical&&a.jsx("span",{style:{fontSize:"9px",color:"#000",background:"var(--color-accent)",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:" SIGNATURE"}),C.vocalizationType&&a.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px",textTransform:"capitalize"},children:C.vocalizationType}),(C.source||C.recordist)&&a.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:C.sourceUrl?a.jsxs("a",{href:C.sourceUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:[C.sourceId,C.recordist?`  ${C.recordist}`:""]}):a.jsxs(a.Fragment,{children:[C.source==="macaulay"?C.sourceId||"Cornell":C.source==="user_recording"?C.recordist||"User":C.sourceId||C.source,C.source!=="user_recording"&&C.recordist&&!C.sourceId&&`  ${C.recordist}`]})})]})})]},C.id))})]})]},I.code)})})]},R.id)})]})]})}function Hk(){return a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function p0({size:t=14}){return a.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})})}function f0({size:t=12}){return a.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function Wk(){return a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}function Vk(){return a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 5v14M5 12h14"})})}function Xk({size:t=80}){return a.jsx("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"currentColor",children:a.jsx("path",{d:"M85 35c-5-3-12-2-18 1-3-8-10-14-19-16 2-3 3-7 2-11-1-5-5-8-9-7s-7 5-6 10c0 2 1 4 2 5-10 3-18 11-21 21-8-1-16 2-21 8-2 2-1 5 1 6s5 0 7-2c3-4 8-5 13-4 0 12 7 23 18 28l-8 12c-2 2-1 5 1 7 2 1 5 1 6-2l10-14c3 1 6 1 9 1 4 0 7-1 10-2l10 14c2 2 5 3 7 1s2-5 0-7l-8-12c11-5 18-16 18-28 5-1 10 0 13 4 2 2 5 3 7 2s3-4 1-6c-5-6-13-9-21-8z"})})}function m0({code:t,size:e=36}){const[r,n]=w.useState(!0),i=`/data/icons/${t}.png`;return r?a.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",flexShrink:0},onError:()=>n(!1)}):a.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-primary)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.4,flexShrink:0},children:a.jsx(Xk,{size:e*.7})})}const Yk={starter_birds:"Backyard Birds",grassland_birds:"Grasslands",expanded_backyard:"Eastern Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Birds",custom:"Custom Pack",nz_all_birds:"All NZ Birds",nz_common:"Garden & Bush",nz_north_island:"North Island",nz_south_island:"South Island"},Bh=["nz_all_birds","nz_common","nz_north_island","nz_south_island"],pc="soundfield_custom_pack_region";function Kk(t){return[{level_id:1,pack_id:"custom",mode:"campaign",title:"Meet Your Birds",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:2,pack_id:"custom",mode:"campaign",title:"Sound Variations",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:3,pack_id:"custom",mode:"campaign",title:"Full Repertoire",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:4,pack_id:"custom",mode:"campaign",title:"Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:5,pack_id:"custom",mode:"campaign",title:"Variations + Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:6,pack_id:"custom",mode:"campaign",title:"Master Birder",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"}]}function qk(t){const e=[];return t.clip_selection==="canonical"?e.push("Signature sounds only"):t.clip_selection==="all"?e.push("Full repertoire"):typeof t.clip_selection=="number"&&e.push(`${t.clip_selection} variations per bird`),t.channel_mode==="offset"?e.push("both ears"):e.push("one ear"),e.join("  ")}function Zk(t){const e=t.level_id;return e<=2?{label:"Easy",color:"#4CAF50"}:e<=4?{label:"Medium",color:"rgba(245, 166, 35, 0.8)"}:{label:"Hard",color:"#FF5722"}}const Jk="#4db6ac";function Qk(){const t=cr(),[e]=Ko(),r=e.get("pack")||"starter_birds",[n,i]=w.useState([]),[s,o]=w.useState(!0),[l,c]=w.useState(!1),[d,u]=w.useState(!1),[h,p]=w.useState([]),[f,m]=w.useState([]),[_,y]=w.useState(null),x=w.useRef(null),v=Bh.includes(r)||r==="custom"&&localStorage.getItem(pc)==="nz",g=v?Jk:"var(--color-accent)";w.useEffect(()=>{if(r==="custom"){try{const E=localStorage.getItem("soundfield_custom_pack");if(E){const B=JSON.parse(E);if(Array.isArray(B)&&B.length>0){i(Kk(B.length)),o(!1);return}}const T=localStorage.getItem(pc);t(T==="nz"?"/custom-pack?region=nz":"/custom-pack",{replace:!0})}catch(E){console.error("Failed to load custom pack:",E);const T=localStorage.getItem(pc);t(T==="nz"?"/custom-pack?region=nz":"/custom-pack",{replace:!0})}return}fetch("/data/levels.json").then(E=>E.json()).then(E=>{const T=E.filter(B=>B.pack_id===r);i(T.sort((B,M)=>B.level_id-M.level_id)),o(!1)}).catch(E=>{console.error("Failed to load levels:",E),o(!1)})},[r,t]),w.useEffect(()=>{if(!l&&!d||r==="custom")return;const E=Bh.includes(r),T=`/data/packs/${r}.json`,B="/data/species.json",M="/data/clips.json",F="/data/nz_display_codes.json",U=[fetch(T).then(k=>k.json()),fetch(B).then(k=>k.json()),fetch(M).then(k=>k.json())];E&&U.push(fetch(F).then(k=>k.json())),Promise.all(U).then(k=>{const R=k[0],z=k[1],N=k[2],P=E?k[3].codes:null,L=R.species||[],I={};for(const O of z)I[O.species_code]={name:O.common_name,scientificName:O.scientific_name};const D={};for(const O of N)O.canonical&&!O.rejected&&(D[O.species_code]=`/${O.file_path}`);let C=L.map(O=>{var H,pe,ie,V;if(E&&P&&P[O]){const ge=P[O];return{code:O,displayName:ge.tileName,englishName:ge.englishName||((H=I[O])==null?void 0:H.name)||"",scientificName:((pe=I[O])==null?void 0:pe.scientificName)||"",showCode:!1,isNZ:!0,canonicalClipPath:D[O]}}else return{code:O,displayName:((ie=I[O])==null?void 0:ie.name)||O,englishName:"",scientificName:((V=I[O])==null?void 0:V.scientificName)||"",showCode:!0,isNZ:!1,canonicalClipPath:D[O]}});E?C.sort((O,H)=>O.englishName.localeCompare(H.englishName)):C.sort((O,H)=>O.code.localeCompare(H.code)),p(C);const A=N.filter(O=>L.includes(O.species_code)&&!O.rejected);m(A)}).catch(k=>{console.error("Failed to load gallery species:",k)})},[l,d,r]),w.useEffect(()=>(!d&&!l&&x.current&&(x.current.pause(),x.current=null,y(null)),()=>{x.current&&x.current.pause()}),[d,l]);const b=(E,T)=>{if(x.current&&(x.current.pause(),x.current=null),_===T){y(null);return}const B=new Audio(E);x.current=B,y(T),B.play().catch(M=>console.error("Failed to play audio:",M)),B.onended=()=>{y(null),x.current=null}},S=E=>{Uk(r,E.level_id,E.title||`Level ${E.level_id}`),t(`/preview?pack=${r}&level=${E.level_id}`)},j=Yk[r]||r;return a.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[a.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"8px"},children:[a.jsx("button",{className:"btn-icon",onClick:()=>{if(r==="custom"){const E=localStorage.getItem(pc);t(E==="nz"?"/custom-pack?region=nz":"/custom-pack")}else Bh.includes(r)?t("/nz-packs"):t("/pack-select")},"aria-label":"Back",style:{color:g,opacity:.6},children:a.jsx(eI,{})}),a.jsxs("div",{style:{flex:1},children:[r!=="custom"?a.jsxs("button",{onClick:()=>c(!0),style:{background:"none",border:"none",padding:0,margin:0,cursor:"pointer",textAlign:"left",display:"flex",alignItems:"center",gap:"6px",color:g,opacity:.85},"aria-label":`View ${j} bird gallery`,children:[a.jsx("h2",{style:{margin:0,fontSize:"20px",color:"inherit"},children:j}),a.jsx("span",{style:{fontSize:"16px",display:"inline-block",animation:"wiggle 2s ease-in-out infinite"},children:""})]}):a.jsx("h2",{style:{margin:0,fontSize:"20px"},children:j}),a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:a.jsx("span",{children:"Select a level"})})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[r!=="custom"&&a.jsxs("button",{onClick:()=>u(!0),className:"btn-icon",style:{color:g,opacity:.6,background:"none",border:"none",fontSize:"18px",display:"flex",gap:"2px",cursor:"pointer"},"aria-label":"Sound Library",children:[a.jsx("span",{children:""}),a.jsx("span",{children:""})]}),a.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:g},children:a.jsx(rI,{})})]})]}),s?a.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--color-text-muted)"},children:"Loading levels..."}):a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:n.map(E=>{const T=Zk(E);return a.jsxs("button",{onClick:()=>S(E),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"var(--color-surface)",border:"none",borderRadius:"12px",cursor:"pointer",textAlign:"left",transition:"transform 0.15s, background 0.15s"},onMouseEnter:B=>{B.currentTarget.style.transform="translateX(4px)",B.currentTarget.style.background="rgba(45, 45, 68, 1)"},onMouseLeave:B=>{B.currentTarget.style.transform="translateX(0)",B.currentTarget.style.background="var(--color-surface)"},children:[a.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:`linear-gradient(135deg, ${T.color}33, ${T.color}11)`,border:`2px solid ${T.color}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"20px",color:T.color,flexShrink:0},children:E.level_id}),a.jsxs("div",{style:{flex:1,minWidth:0},children:[a.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:E.title}),a.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:qk(E)})]}),a.jsx("div",{style:{color:"var(--color-text-muted)",flexShrink:0},children:a.jsx(tI,{})})]},E.level_id)})}),a.jsx("div",{style:{marginTop:"24px",padding:"12px 16px",background:v?"rgba(77, 182, 172, 0.1)":"rgba(245, 166, 35, 0.1)",borderRadius:"8px",borderLeft:v?"3px solid rgba(77, 182, 172, 0.5)":"3px solid rgba(245, 166, 35, 0.5)"},children:a.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:[a.jsx("strong",{style:{color:g,opacity:.7},children:"Tip:"})," Tap the pack name  to see all birds, or  to explore all sounds."]})}),d&&a.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.85)",zIndex:1e3,display:"flex",flexDirection:"column",overflow:"hidden"},onClick:()=>{x.current&&x.current.pause(),y(null),u(!1)},children:[a.jsxs("div",{style:{padding:"16px 20px",paddingTop:"calc(16px + var(--safe-area-top, 0px))",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0},onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0,fontSize:"18px",color:"white"},children:[" ",j]}),a.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginTop:"2px"},children:[h.length," birds  Tap any clip to play"]})]}),a.jsx("button",{onClick:()=>{x.current&&x.current.pause(),y(null),u(!1)},style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white",fontSize:"20px"},children:""})]}),a.jsxs("div",{style:{flex:1,overflow:"auto",padding:"16px 20px",paddingBottom:"calc(16px + var(--safe-area-bottom, 0px))"},onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{style:{background:"rgba(255, 200, 50, 0.12)",border:"1px solid rgba(255, 200, 50, 0.3)",borderRadius:"8px",padding:"10px 14px",marginBottom:"16px",fontSize:"13px",color:"rgba(255, 255, 255, 0.8)",lineHeight:"1.4"},children:[a.jsx("span",{style:{marginRight:"6px"},children:""}),"Sound library under construction. Sound type labels (song, call, etc.) are being reviewed and corrected  don't rely on them just yet."]}),h.map(E=>{const B=[...f.filter(M=>M.species_code===E.code)].sort((M,F)=>M.canonical&&!F.canonical?-1:!M.canonical&&F.canonical?1:(M.vocalization_type||"").localeCompare(F.vocalization_type||""));return a.jsxs("div",{style:{marginBottom:"20px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"12px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px"},children:[a.jsx("img",{src:`/data/icons/${E.code}.png`,alt:E.displayName,style:{width:"44px",height:"44px",borderRadius:"50%",objectFit:"cover",border:`2px solid ${g}`},onError:M=>{M.target.style.display="none"}}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:700,fontSize:"15px",color:"white"},children:E.displayName}),a.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:[E.isNZ&&E.englishName&&E.englishName!==E.displayName?`${E.englishName}  `:"",E.code,"  ",B.length," clip",B.length!==1?"s":""]})]})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[B.map(M=>{const F=_===M.clip_id;return a.jsxs("button",{onClick:()=>{if(F)x.current&&x.current.pause(),y(null);else{x.current&&x.current.pause();const U=new Audio(`/${M.file_path}`);x.current=U,U.onended=()=>y(null),U.play().catch(console.error),y(M.clip_id)}},style:{padding:"6px 12px",background:F?"rgba(76, 175, 80, 0.3)":M.canonical?"rgba(255, 152, 0, 0.2)":"rgba(255, 255, 255, 0.1)",border:F?"2px solid #4CAF50":M.canonical?"1px solid rgba(255, 152, 0, 0.4)":"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"20px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"white",fontSize:"12px",transition:"all 0.15s ease"},children:[a.jsx("span",{style:{fontSize:"14px"},children:F?"":""}),a.jsx("span",{style:{textTransform:"capitalize"},children:M.vocalization_type||"clip"}),M.canonical&&a.jsx("span",{style:{fontSize:"10px",opacity:.7},children:""})]},M.clip_id)}),B.length===0&&a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",fontStyle:"italic"},children:"No clips available"})]})]},E.code)})]})]}),l&&a.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.85)",zIndex:1e3,display:"flex",flexDirection:"column",animation:"fadeIn 0.2s ease-out"},onClick:()=>c(!1),children:[a.jsxs("div",{style:{padding:"16px 20px",paddingTop:"calc(16px + var(--safe-area-top, 0px))",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[a.jsx("h3",{style:{margin:0,fontSize:"18px",color:"var(--color-text)"},children:j}),a.jsx("button",{onClick:()=>c(!1),style:{background:"none",border:"none",color:"var(--color-text-muted)",fontSize:"28px",cursor:"pointer",padding:"4px",lineHeight:1},"aria-label":"Close gallery",children:""})]}),a.jsx("div",{style:{flex:1,overflow:"auto",padding:"16px",paddingBottom:"calc(16px + var(--safe-area-bottom, 0px))"},onClick:E=>E.stopPropagation(),children:a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"20px",maxWidth:"400px",margin:"0 auto"},children:h.map(E=>a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",padding:"16px",background:"var(--color-surface)",borderRadius:"16px"},children:[a.jsxs("div",{style:{position:"relative",width:"100%"},children:[a.jsx("img",{src:`/data/icons/${E.code}.png`,alt:E.displayName,style:{width:"100%",aspectRatio:"1",borderRadius:"12px",objectFit:"cover"}}),E.canonicalClipPath&&a.jsx("button",{onClick:()=>b(E.canonicalClipPath,E.code),style:{position:"absolute",bottom:"12px",right:"12px",width:"48px",height:"48px",borderRadius:"50%",border:"none",background:_===E.code?"var(--color-accent)":"rgba(0, 0, 0, 0.7)",color:_===E.code?"#000":"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.4)",transition:"all 0.15s"},"aria-label":_===E.code?`Stop ${E.displayName}`:`Play ${E.displayName}`,children:_===E.code?"":""})]}),a.jsx("div",{style:{textAlign:"center"},children:E.isNZ?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:"20px",fontWeight:700,color:"var(--color-text)",marginBottom:"4px"},children:E.displayName}),E.englishName&&E.englishName!==E.displayName&&a.jsx("div",{style:{fontSize:"15px",color:"var(--color-text-muted)",marginBottom:"4px"},children:E.englishName}),E.scientificName&&a.jsx("div",{style:{fontSize:"13px",fontStyle:"italic",color:"rgba(255,255,255,0.4)"},children:E.scientificName})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:"20px",fontWeight:700,color:"var(--color-text)",marginBottom:"4px"},children:E.displayName}),E.scientificName&&a.jsx("div",{style:{fontSize:"15px",fontStyle:"italic",color:"var(--color-text-muted)",marginBottom:E.showCode?"6px":"0"},children:E.scientificName}),E.showCode&&a.jsx("div",{style:{fontSize:"12px",fontWeight:600,color:g,opacity:.7},children:E.code})]})})]},E.code))})})]})]})}function eI(){return a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}function tI(){return a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})}function rI(){return a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}const g0="soundfield_nz_sort_mode",nI="maori";function qw(){const[t,e]=w.useState(()=>{try{const n=localStorage.getItem(g0);if(n==="english"||n==="maori"||n==="taxonomic")return n}catch{}return nI}),r=w.useCallback(n=>{e(n);try{localStorage.setItem(g0,n),dr("nz_sort_mode_change",{mode:n,location:"nz_pack"})}catch(i){console.error("Failed to save NZ sort mode:",i)}},[]);return[t,r]}function iI(t,e,r,n){switch(t){case"english":return{primary:r,secondary:e!==r?e:null};case"maori":return{primary:e,secondary:e!==r?r:null};case"taxonomic":return{primary:e,secondary:n||null};default:return{primary:e,secondary:r!==e?r:null}}}const x0="soundfield_na_display_mode";function sI(){const[t,e]=w.useState(()=>{const n=localStorage.getItem(x0);return n==="code"||n==="name"?n:"code"});return w.useEffect(()=>{localStorage.setItem(x0,t)},[t]),[t,n=>{e(n),dr("na_display_mode_change",{mode:n,location:"na_pack"})}]}let _t=null,fc=null;async function Kg(){return _t||fc||(fc=fetch("/data/nz_subspecies_merge.json").then(t=>t.json()).then(t=>(_t=t,t)).catch(t=>(console.error("Failed to load NZ subspecies merge config:",t),_t={description:"",merges:{}},_t)),fc)}function oI(){return _t}function aI(t){if(!_t)return"";for(const e of Object.values(_t.merges))if(e.subspecies.includes(t))return e.region_labels[t]||"";return""}function Zw(t){if(!_t)return null;for(const e of Object.values(_t.merges))if(e.subspecies.includes(t))return e;return null}function Jw(t){if(!_t)return t;const e=_t.merges[t];if(e)return e.icon;for(const r of Object.values(_t.merges))if(r.subspecies.includes(t))return r.icon;return t}function lI(t,e){if(!_t)return null;const r=_t.merges[t];if(!r)return null;for(const[n,i]of Object.entries(r.region_labels))if(i===e)return n;return null}function cI(t,e){if(t===e)return!0;if(!_t)return!1;let r=null,n=null;for(const[i,s]of Object.entries(_t.merges))s.subspecies.includes(t)&&(r=i),s.subspecies.includes(e)&&(n=i);return r!==null&&r===n}function y0(t){if(!_t)return t;const e=new Set,r=[];for(const n of t){let i=null;for(const[o,l]of Object.entries(_t.merges))if(l.subspecies.includes(n)){i=o;break}const s=i||n;e.has(s)||(e.add(s),i?r.push(_t.merges[i].icon):r.push(n))}return r}const mc=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"],dI={starter_birds:"Backyard Birds",grassland_birds:"Grasslands",expanded_backyard:"Eastern Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Birds",custom:"Custom Pack",drill:"Confusion Drill",nz_all_birds:"All NZ Birds",nz_common:"Garden & Bush",nz_north_island:"North Island",nz_south_island:"South Island"},uI=["nz_all_birds","nz_common","nz_north_island","nz_south_island"],gc="#4db6ac",hI={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function pI(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function fI(t){return t>=4?"offset":"single"}function mI({code:t,tileName:e,size:r=56,color:n}){const[i,s]=w.useState(!0),o=`/data/icons/${t}.png`;return a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",WebkitTapHighlightColor:"transparent"},children:[i&&e&&a.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:e}),i?a.jsx("img",{src:o,alt:e||t,width:r,height:r,style:{borderRadius:"50%",objectFit:"cover",WebkitTapHighlightColor:"transparent"},onError:()=>s(!1)}):a.jsx("div",{style:{width:r,height:r,borderRadius:"50%",background:n||"var(--color-surface)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:r*.25,fontWeight:700,color:"#1A1A2E"},children:e||t})]})}function gI(){const t=cr(),[e]=Ko(),r=e.get("pack")||"starter_birds",n=parseInt(e.get("level")||"1",10),i=e.get("keepBirds")==="true",s=uI.includes(r)||r==="custom"&&localStorage.getItem("soundfield_custom_pack_region")==="nz",o=s?gc:"var(--color-accent)",[l,c]=w.useState(null),[d,u]=w.useState([]),[h,p]=w.useState([]),[f,m]=w.useState(null),[_,y]=w.useState(!0),[x,v]=w.useState("idle"),[g,b]=w.useState({loaded:0,total:0}),[S,j]=w.useState(()=>{try{return localStorage.getItem("soundfield_training_mode")==="true"}catch{return!1}}),[E,T]=w.useState(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}}),[B,M]=w.useState({}),[F,U]=w.useState({}),[k,R]=w.useState({}),[z,N]=w.useState({}),[P,L]=qw(),[I,D]=sI(),[C,A]=w.useState([]),[O,H]=w.useState(!1),[pe,ie]=w.useState(!1),[V,ge]=w.useState(!1),[Re,je]=w.useState(null),Te=w.useRef(null),fe=w.useRef(null),Me=w.useRef(null),ct=()=>{const q=!S;j(q);try{localStorage.setItem("soundfield_training_mode",String(q))}catch(Ie){console.error("Failed to save training mode:",Ie)}},wt=()=>{const q=!E;T(q);try{localStorage.setItem("soundfield_taxonomic_sort",String(q)),Kw(q,"preview_screen")}catch(Ie){console.error("Failed to save taxonomic sort:",Ie)}};w.useEffect(()=>{if(h.length===0)return;let q;if(s)switch(P){case"english":q=[...h].sort((le,oe)=>le.englishName.localeCompare(oe.englishName));break;case"taxonomic":if(Object.keys(B).length===0)return;q=[...h].sort((le,oe)=>{const $=B[le.code]||9999,W=B[oe.code]||9999;return $-W});break;case"maori":default:q=[...h].sort((le,oe)=>le.tileName.localeCompare(oe.tileName));break}else{if(E&&Object.keys(B).length===0)return;q=E?[...h].sort((le,oe)=>{const $=B[le.code]||9999,W=B[oe.code]||9999;return $-W}):[...h].sort((le,oe)=>le.tileName.localeCompare(oe.tileName))}const Ie=q.map((le,oe)=>({...le,color:mc[oe%mc.length]}));Ie.some((le,oe)=>le.code!==h[oe].code)&&p(Ie)},[E,B,P,s]),w.useEffect(()=>{Promise.all([fetch("/data/taxonomic_order.json").then(q=>q.json()),fetch("/data/species.json").then(q=>q.json()),fetch("/data/nz_display_codes.json").then(q=>q.json()).catch(()=>({codes:{}})),Kg()]).then(([q,Ie,We])=>{M(q),N(We.codes||{});const le={},oe={};Ie.forEach($=>{le[$.species_code]=$.scientific_name,oe[$.species_code]=$.common_name}),U(le),R(oe),ie(!0),H(!0)}).catch(q=>console.error("Failed to load taxonomy data:",q))},[]);const pt=w.useCallback((q,Ie)=>{const le=(s?y0(q):q).map($=>{const W=s?Jw($):$,X=s?Zw(W):null,Z=X?X.subspecies:[W],Pe=Ie.find(Yt=>Z.includes(Yt.species_code)&&Yt.canonical&&!Yt.rejected),dt=Ie.find(Yt=>Z.includes(Yt.species_code)&&!Yt.rejected),Ve=Pe||dt,gt=z[W],wr=(gt==null?void 0:gt.englishName)||k[W]||W;let At;return s?At=(gt==null?void 0:gt.tileName)||W:At=I==="name"&&k[W]||W,{code:W,displayCode:(gt==null?void 0:gt.code)||W,tileName:At,englishName:wr,name:k[W]||W,scientificName:F[W],color:"",clipPath:Ve?`/${Ve.file_path}`:null}});let oe;if(s)switch(P){case"english":oe=le.sort(($,W)=>$.englishName.localeCompare(W.englishName));break;case"taxonomic":oe=le.sort(($,W)=>{const X=B[$.code]||9999,Z=B[W.code]||9999;return X-Z});break;case"maori":default:oe=le.sort(($,W)=>$.tileName.localeCompare(W.tileName));break}else oe=E&&Object.keys(B).length>0?le.sort(($,W)=>{const X=B[$.code]||9999,Z=B[W.code]||9999;return X-Z}):le.sort(($,W)=>$.code.localeCompare(W.code));return oe.map(($,W)=>({...$,color:mc[W%mc.length]}))},[k,F,z,E,B,s,P,I,pe]),Lr=w.useCallback((q,Ie)=>{const We=Math.min(9,q.length),oe=[...q].sort(()=>Math.random()-.5).slice(0,We);p(pt(oe,Ie))},[pt]),Xt=w.useCallback((q,Ie)=>{const We=q.species_pool||[],le=q.species_count||We.length,W=[...s?y0(We):We].sort(()=>Math.random()-.5).slice(0,le);p(pt(W,Ie))},[pt,s]);w.useEffect(()=>{if(!O)return;const q=`${r}-${n}`;if(Te.current===q)return;const We=r.startsWith("nz_")||r==="custom"&&localStorage.getItem("soundfield_custom_pack_region")==="nz"?"clips-nz.json":"clips.json";Promise.all([fetch("/data/levels.json").then(le=>le.json()),fetch(`/data/${We}`).then(le=>le.json())]).then(([le,oe])=>{if(u(oe),Te.current=q,r==="drill"){const W=sessionStorage.getItem("drillSpecies");if(W)try{const X=JSON.parse(W),Z={1:{clip_selection:"canonical",channel_mode:"single",spectrogram_mode:"full"},2:{clip_selection:3,channel_mode:"single",spectrogram_mode:"full"},3:{clip_selection:"all",channel_mode:"single",spectrogram_mode:"full"},4:{clip_selection:"canonical",channel_mode:"offset",spectrogram_mode:"full"},5:{clip_selection:3,channel_mode:"offset",spectrogram_mode:"full"},6:{clip_selection:"all",channel_mode:"offset",spectrogram_mode:"full"}},Pe=Z[n]||Z[1],dt={level_id:n,pack_id:"drill",mode:"campaign",title:"Confusion Drill",round_duration_sec:30,species_count:X.length,species_pool:X,clip_selection:Pe.clip_selection,channel_mode:Pe.channel_mode,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:Pe.spectrogram_mode};c(dt),p(pt(X,oe))}catch(X){console.error("Failed to parse drill species:",X)}y(!1);return}if(r==="custom"){const W=localStorage.getItem("soundfield_custom_pack");if(W)try{const X=JSON.parse(W);A(X);let Z;if(i){const dt=sessionStorage.getItem("roundSpecies");if(dt)try{const Ve=JSON.parse(dt),gt=Ve.filter(wr=>X.includes(wr));gt.length===Ve.length?Z=gt:Z=X.length>9?[...X].sort(()=>Math.random()-.5).slice(0,9):X}catch(Ve){console.error("Failed to parse saved species:",Ve),Z=X.length>9?[...X].sort(()=>Math.random()-.5).slice(0,9):X}else Z=X.length>9?[...X].sort(()=>Math.random()-.5).slice(0,9):X}else Z=X.length>9?[...X].sort(()=>Math.random()-.5).slice(0,9):X;const Pe={level_id:n,pack_id:"custom",mode:"campaign",title:hI[n]||`Level ${n}`,round_duration_sec:30,species_count:Z.length,species_pool:Z,clip_selection:pI(n),channel_mode:fI(n),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"};c(Pe),p(pt(Z,oe))}catch(X){console.error("Failed to parse custom pack:",X)}y(!1);return}const $=le.find(W=>W.pack_id===r&&W.level_id===n);if($){if(c($),i){const W=sessionStorage.getItem("roundSpecies");if(W)try{const X=JSON.parse(W),Z=$.species_pool||[],Pe=X.filter(dt=>Z.includes(dt));if(Pe.length===X.length){p(pt(Pe,oe)),y(!1);return}}catch(X){console.error("Failed to parse saved species:",X)}}Xt($,oe)}y(!1)}).catch(le=>{console.error("Failed to load data:",le),y(!1)})},[r,n,i,O]),w.useEffect(()=>{if(h.length===0||d.length===0){v("idle");return}const q=h.map(oe=>oe.code),Ie=d.filter(oe=>q.includes(oe.species_code)&&!oe.rejected);if(Ie.length===0){v("ready"),b({loaded:0,total:0});return}v("loading"),b({loaded:0,total:Ie.length}),console.log(`Preloading ${Ie.length} clips for ${q.length} species...`);let We=0;const le=Ie.map(async oe=>{const $=`/${oe.file_path}`;try{const W=await fetch($);W.ok&&await W.arrayBuffer()}catch(W){console.warn("Failed to preload:",oe.file_path,W)}finally{We++,b({loaded:We,total:Ie.length})}});Promise.all(le).then(()=>{console.log("Preloading complete!"),v("ready")})},[h,d]);const Yl=()=>{l&&d.length>0&&(fe.current&&(fe.current.pause(),fe.current=null,m(null)),v("idle"),Xt(l,d))},Kl=()=>{C.length>0&&d.length>0&&(fe.current&&(fe.current.pause(),fe.current=null,m(null)),v("idle"),Lr(C,d))},Ms=q=>{if(console.log(`[Preview] Attempting to play: ${q.code}`),console.log(`[Preview] Clip path: ${q.clipPath}`),fe.current&&(fe.current.pause(),fe.current=null),f===q.code){m(null);return}if(!q.clipPath){console.error(`[Preview] No clip path for ${q.code}!`);return}const Ie=new Audio(q.clipPath);fe.current=Ie,m(q.code),Ie.play().then(()=>console.log(`[Preview] Playing ${q.code} successfully`)).catch(We=>{console.error(`[Preview] Failed to play ${q.code}:`,We),console.error(`[Preview] Clip path was: ${q.clipPath}`)}),Ie.onended=()=>{console.log(`[Preview] ${q.code} finished playing`),m(null),fe.current=null}},na=()=>{fe.current&&fe.current.pause();const q=h.map(Ie=>Ie.code);sessionStorage.setItem("roundSpecies",JSON.stringify(q)),s?sessionStorage.setItem("nzSortMode",P):sessionStorage.setItem("naDisplayMode",I),t(`/gameplay?mode=campaign&pack=${r}&level=${n}&preview=true`)};if(w.useEffect(()=>()=>{fe.current&&fe.current.pause()},[]),_)return a.jsx("div",{className:"screen screen-center",children:a.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading..."})});if(!l)return a.jsxs("div",{className:"screen screen-center",children:[a.jsx("div",{style:{color:"var(--color-error)"},children:"Level not found"}),a.jsx("button",{onClick:()=>t(-1),style:{marginTop:"16px",padding:"8px 16px",background:"var(--color-surface)",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"Go Back"})]});const qn=dI[r]||r;return a.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",paddingTop:"calc(12px + var(--safe-area-top))",paddingBottom:"calc(12px + var(--safe-area-bottom))",paddingLeft:"16px",paddingRight:"16px",gap:"10px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("button",{className:"btn-icon",onClick:()=>t(`/level-select?pack=${r}`),"aria-label":"Back",style:{flexShrink:0,color:o,opacity:.6},children:a.jsx(xI,{})}),a.jsxs("div",{style:{flex:1,minWidth:0},children:[a.jsx("h2",{style:{margin:0,fontSize:"14px",lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:qn}),a.jsxs("div",{style:{fontSize:"12px",color:o,opacity:.85,lineHeight:1.1},children:["Level ",l.level_id,": ",l.title]})]}),a.jsx("button",{onClick:()=>ge(!0),style:{padding:"6px 10px",background:"transparent",border:"1px solid rgba(100, 181, 246, 0.3)",borderRadius:"6px",color:"#64B5F6",fontSize:"15px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",flexShrink:0,whiteSpace:"nowrap"},title:"Sound Library - hear all clips for these birds",children:""}),(l.species_pool&&l.species_pool.length>(l.species_count||0)||C.length>9)&&a.jsx("button",{onClick:C.length>9?Kl:Yl,style:{padding:"6px 10px",background:"transparent",border:`1px solid ${o}`,borderRadius:"6px",color:o,fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",flexShrink:0,opacity:.6},title:C.length>9?`Re-roll (${C.length} total birds)`:"Shuffle birds",children:a.jsx(yI,{})})]}),a.jsxs("div",{style:{display:"flex",gap:"6px",fontSize:"12px"},children:[a.jsxs("button",{onClick:ct,style:{flex:1,padding:"6px 8px",background:S?"rgba(76, 175, 80, 0.25)":"rgba(255, 255, 255, 0.05)",border:S?"2px solid var(--color-success)":"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[a.jsx(vI,{filled:S,color:S?"var(--color-success)":void 0}),a.jsx("span",{style:{fontSize:"11px"},children:"Training"})]}),s?a.jsxs("div",{style:{flex:1,display:"flex",borderRadius:"6px",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.15)"},children:[a.jsx("button",{onClick:()=>{L("maori"),vo("maori","preview_screen")},style:{flex:1,padding:"6px 4px",background:P==="maori"?"rgba(77, 182, 172, 0.3)":"rgba(255, 255, 255, 0.05)",border:"none",borderRight:"1px solid rgba(255, 255, 255, 0.15)",cursor:"pointer",fontSize:"12px",color:P==="maori"?gc:"var(--color-text-muted)",fontWeight:P==="maori"?600:400},title:"Sort by Maori name",children:"Te Reo"}),a.jsx("button",{onClick:()=>{L("english"),vo("english","preview_screen")},style:{flex:1,padding:"6px 4px",background:P==="english"?"rgba(77, 182, 172, 0.3)":"rgba(255, 255, 255, 0.05)",border:"none",borderRight:"1px solid rgba(255, 255, 255, 0.15)",cursor:"pointer",fontSize:"12px",color:P==="english"?gc:"var(--color-text-muted)",fontWeight:P==="english"?600:400},title:"Sort by English name",children:"English"}),a.jsx("button",{onClick:()=>{L("taxonomic"),vo("taxonomic","preview_screen")},style:{flex:1,padding:"6px 4px",background:P==="taxonomic"?"rgba(77, 182, 172, 0.3)":"rgba(255, 255, 255, 0.05)",border:"none",cursor:"pointer",fontSize:"12px",color:P==="taxonomic"?gc:"var(--color-text-muted)",fontWeight:P==="taxonomic"?600:400},title:"Sort by taxonomic order",children:""})]}):a.jsxs("div",{style:{display:"flex",gap:"6px",flex:1},children:[a.jsx("button",{onClick:()=>D(I==="code"?"name":"code"),style:{flex:1,padding:"6px 8px",background:I==="name"?"rgba(255, 152, 0, 0.25)":"rgba(255, 255, 255, 0.05)",border:I==="name"?"2px solid var(--color-accent)":"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},title:I==="code"?"Show common names":"Show 4-letter codes",children:a.jsx("span",{style:{fontSize:"11px",fontWeight:I==="name"?600:400},children:I==="name"?"Names":"NOCA"})}),a.jsx("button",{onClick:wt,style:{flex:1,padding:"6px 8px",background:E?"rgba(100, 181, 246, 0.25)":"rgba(255, 255, 255, 0.05)",border:E?"2px solid #64B5F6":"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},title:E?"Sort alphabetically":"Sort by taxonomy",children:a.jsx("span",{style:{fontSize:"14px"},children:E?"":""})})]})]}),x==="loading"&&a.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"6px",padding:"6px 10px"},children:[a.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"4px"},children:["Loading sounds ",g.loaded,"/",g.total]}),a.jsx("div",{style:{width:"100%",height:"3px",background:"rgba(0,0,0,0.2)",borderRadius:"2px",overflow:"hidden"},children:a.jsx("div",{style:{width:`${g.loaded/g.total*100}%`,height:"100%",background:o,transition:"width 0.2s ease"}})})]}),a.jsx("div",{style:{background:"rgba(100, 181, 246, 0.1)",border:"1px solid rgba(100, 181, 246, 0.3)",borderRadius:"8px",padding:"10px 12px"},children:a.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text)",lineHeight:1.4,textAlign:"center"},children:[a.jsx("strong",{children:" Study the grid:"})," Each bird keeps its position during play. Tap to hear, hold for a closer look. Use  to shuffle."]})}),a.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:0},children:[C.length>9&&a.jsxs("div",{style:{fontSize:"12px",color:o,opacity:.85,marginBottom:"6px",textAlign:"center",fontWeight:600},children:["Playing 9 of ",C.length," birds"]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px",maxWidth:"320px",width:"100%"},children:h.map(q=>a.jsxs("button",{onClick:()=>Ms(q),disabled:!q.clipPath,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px",padding:"10px 6px",background:f===q.code?`${q.color}33`:"var(--color-surface)",border:`2px solid ${q.color}`,borderRadius:"10px",cursor:q.clipPath?"pointer":"not-allowed",opacity:q.clipPath?1:.5,transition:"transform 0.15s, background 0.15s",WebkitTapHighlightColor:"transparent"},children:[a.jsx("div",{style:{position:"relative",WebkitTapHighlightColor:"transparent"},children:a.jsx(mI,{code:q.code,size:52,color:q.color})}),a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",textAlign:"center",lineHeight:1.2,maxWidth:"80px",overflow:"hidden"},children:(()=>{if(s){const{primary:Ie,secondary:We}=iI(P,q.tileName,q.englishName,q.scientificName);return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:600},children:Ie}),We&&a.jsx("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",fontStyle:P==="taxonomic"?"italic":"normal",marginTop:"2px"},children:We})]})}else return a.jsx("div",{style:{fontWeight:600},children:I==="name"?q.name:q.code})})()})]},q.code))})]}),a.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",textAlign:"center",marginBottom:"8px"},children:s?a.jsxs(a.Fragment,{children:[" Training ",S?"on":"off","  Display: ",P==="maori"?"Te Reo":P==="english"?"English":"Taxonomic","  Sort: ",P==="taxonomic"?"Taxonomic":"A-Z"]}):a.jsxs(a.Fragment,{children:[" Training ",S?"on":"off","  Display: ",I==="name"?"Common names":"4-letter codes","  Sort: ",E?"Taxonomic":"A-Z"]})}),a.jsx("button",{onClick:na,style:{width:"100%",padding:"12px",fontSize:"15px",fontWeight:700,background:x==="ready"?"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)":"linear-gradient(135deg, #555 0%, #444 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 3px 10px rgba(45, 90, 39, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:x==="ready"?a.jsxs(a.Fragment,{children:["Ready to Play ",a.jsx(v0,{})]}):x==="loading"?a.jsx(a.Fragment,{children:"Loading..."}):a.jsxs(a.Fragment,{children:["Ready to Play ",a.jsx(v0,{})]})}),V&&a.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.85)",zIndex:1e3,display:"flex",flexDirection:"column",overflow:"hidden"},onClick:()=>{Me.current&&Me.current.pause(),je(null),ge(!1)},children:[a.jsxs("div",{style:{padding:"16px 20px",paddingTop:"calc(16px + var(--safe-area-top, 0px))",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0},onClick:q=>q.stopPropagation(),children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0,fontSize:"18px",color:"white"},children:" Sound Library"}),a.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginTop:"2px"},children:[h.length," birds  Tap any clip to play"]})]}),a.jsx("button",{onClick:()=>{Me.current&&Me.current.pause(),je(null),ge(!1)},style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white",fontSize:"20px"},children:""})]}),a.jsxs("div",{style:{flex:1,overflow:"auto",padding:"16px 20px",paddingBottom:"calc(16px + var(--safe-area-bottom, 0px))"},onClick:q=>q.stopPropagation(),children:[a.jsxs("div",{style:{background:"rgba(255, 200, 50, 0.12)",border:"1px solid rgba(255, 200, 50, 0.3)",borderRadius:"8px",padding:"10px 14px",marginBottom:"16px",fontSize:"13px",color:"rgba(255, 255, 255, 0.8)",lineHeight:"1.4"},children:[a.jsx("span",{style:{marginRight:"6px"},children:""}),"Sound library under construction. Sound type labels (song, call, etc.) are being reviewed and corrected  don't rely on them just yet."]}),h.map(q=>{const We=[...d.filter(le=>le.species_code===q.code&&!le.rejected)].sort((le,oe)=>le.canonical&&!oe.canonical?-1:!le.canonical&&oe.canonical?1:(le.vocalization_type||"").localeCompare(oe.vocalization_type||""));return a.jsxs("div",{style:{marginBottom:"20px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"12px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px"},children:[a.jsx("img",{src:`/data/icons/${q.code}.png`,alt:q.name,style:{width:"44px",height:"44px",borderRadius:"50%",objectFit:"cover",border:`2px solid ${q.color}`},onError:le=>{le.target.style.display="none"}}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:700,fontSize:"15px",color:"white"},children:q.name}),a.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:[q.code,"  ",We.length," clip",We.length!==1?"s":""]})]})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[We.map(le=>{const oe=Re===le.clip_id;return a.jsxs("button",{onClick:()=>{if(oe)Me.current&&Me.current.pause(),je(null);else{Me.current&&Me.current.pause();const $=new Audio(`/${le.file_path}`);Me.current=$,$.onended=()=>je(null),$.play().catch(console.error),je(le.clip_id)}},style:{padding:"6px 12px",background:oe?"rgba(76, 175, 80, 0.3)":le.canonical?"rgba(255, 152, 0, 0.2)":"rgba(255, 255, 255, 0.1)",border:oe?"2px solid #4CAF50":le.canonical?"1px solid rgba(255, 152, 0, 0.4)":"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"20px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"white",fontSize:"12px",transition:"all 0.15s ease"},children:[a.jsx("span",{style:{fontSize:"14px"},children:oe?"":""}),a.jsx("span",{style:{textTransform:"capitalize"},children:le.vocalization_type||"clip"}),le.canonical&&a.jsx("span",{style:{fontSize:"10px",opacity:.7},children:""})]},le.clip_id)}),We.length===0&&a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",fontStyle:"italic"},children:"No clips available"})]})]},q.code)})]})]}),a.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.7; }
        }
        * {
          -webkit-tap-highlight-color: transparent;
        }
      `})]})}function xI(){return a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}function yI(){return a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M16 3h5v5"}),a.jsx("path",{d:"M4 20L21 3"}),a.jsx("path",{d:"M21 16v5h-5"}),a.jsx("path",{d:"M15 15l6 6"}),a.jsx("path",{d:"M4 4l5 5"})]})}function v0(){return a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})})}function vI({filled:t,color:e}){const r=e||(t?"var(--color-accent)":"var(--color-text-muted)");return a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",children:[a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3",fill:t?r:"none"})]})}const ya=30,va="soundfield_custom_pack",xc="soundfield_custom_pack_region",Ds="soundfield_saved_packs",_a=10,_0=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE","#F06292","#64B5F6","#AED581","#FFB74D","#9575CD","#FF7043","#4DD0E1","#DCE775","#C5A880","#EF5350","#42A5F5","#66BB6A","#FFA726","#AB47BC","#FF6F00","#26C6DA","#D4E157","#8D6E63","#EC407A","#29B6F6","#9CCC65"];function _I(){var oe;const t=cr(),[e]=Ko(),n=e.get("region")==="nz",i=n?"#4db6ac":"var(--color-accent)",s=n?"rgba(45, 122, 122, 0.7)":"rgba(245, 166, 35, 0.6)",o=n?"rgba(45, 122, 122, 0.5)":"rgba(255, 152, 0, 0.3)",[l,c]=w.useState([]),[d,u]=w.useState([]),[h,p]=w.useState(""),[f,m]=w.useState(null),[_,y]=w.useState(!0),x=w.useRef(null),v=w.useRef(null),g=w.useRef(!1),b=w.useRef(null),S=w.useRef(null),[j,E]=w.useState(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}}),[T,B]=w.useState({}),[M,F]=w.useState([]),[U,k]=w.useState(!1),[R,z]=w.useState(""),[N,P]=w.useState(!1),[L,I]=w.useState(!1),[D,C]=w.useState(null),[A,O]=w.useState(null),[H,pe]=w.useState(""),[ie,V]=w.useState(!1),[ge,Re]=w.useState(!1),[je,Te]=w.useState([]),[fe,Me]=w.useState(null);w.useEffect(()=>{const W=(n?["nz_all_birds","nz_common","nz_north_island","nz_south_island"]:["starter_birds","grassland_birds","expanded_backyard","sparrows","woodpeckers","spring_warblers","western_birds"]).map(X=>fetch(`/data/packs/${X}.json`).then(Z=>Z.json()).catch(Z=>(console.error(`Failed to load pack ${X}:`,Z),null)));Promise.all([fetch("/data/clips.json").then(X=>X.json()),fetch("/data/taxonomic_order.json").then(X=>X.json()),fetch("/data/species.json").then(X=>X.json()),Promise.all(W)]).then(([X,Z,Pe,dt])=>{const Ve=n?X.filter(ze=>ze.source==="doc"):X.filter(ze=>ze.source!=="doc"),gt=dt.filter(ze=>ze!==null).map(ze=>({id:ze.pack_id,name:ze.display_name,species:ze.species}));Te(gt);const wr={},At={};for(const ze of Pe)wr[ze.species_code]=ze.scientific_name,At[ze.species_code]=ze.common_name;const Yt=new Map;for(const ze of Ve)if(!ze.rejected&&!Yt.has(ze.species_code)){const Ut=Ve.find(tt=>tt.species_code===ze.species_code&&tt.canonical&&!tt.rejected)||Ve.find(tt=>tt.species_code===ze.species_code&&!tt.rejected)||ze,Fr=At[ze.species_code];if(!Fr){console.warn(`Skipping ${ze.species_code} - not found in species.json`);continue}Yt.set(ze.species_code,{code:ze.species_code,name:Fr,clipPath:`/data/clips/${Ut.file_path.split("/").pop()}`,scientificName:wr[ze.species_code]})}const ia=Array.from(Yt.values()).sort((ze,Sr)=>(ze.name||ze.code).localeCompare(Sr.name||Sr.code));c(ia),B(Z),y(!1)}).catch(X=>{console.error("Failed to load data:",X),y(!1)});try{if(sessionStorage.getItem("customPackWasTemporary")==="true")sessionStorage.removeItem("customPackWasTemporary"),localStorage.removeItem(va),console.log("Cleared temporary custom pack after play session");else{const Z=localStorage.getItem(va);if(Z){const Pe=JSON.parse(Z);Array.isArray(Pe)&&Pe.length>0&&u(Pe)}}}catch(X){console.error("Failed to load saved pack:",X)}try{const X=localStorage.getItem(Ds);if(X){const Z=JSON.parse(X);Array.isArray(Z)&&F(Z)}}catch(X){console.error("Failed to load saved packs:",X)}},[n]),w.useEffect(()=>{if(l.length===0||M.length===0||g.current)return;g.current=!0;const $=new Set(l.map(Z=>Z.code));let W=!1;const X=M.map(Z=>{Z.version||(Z.version=1,W=!0);const Pe=Z.species.filter(dt=>$.has(dt));return Pe.length!==Z.species.length?(W=!0,{...Z,species:Pe}):Z});if(W){F(X);try{localStorage.setItem(Ds,JSON.stringify(X)),console.log("Auto-cleaned saved packs: removed invalid species codes")}catch(Z){console.error("Failed to auto-clean saved packs:",Z)}}},[l,M]);const ct=w.useCallback(($,W)=>{var Pe,dt;const X=((Pe=b.current)==null?void 0:Pe.scrollTop)??0,Z=((dt=S.current)==null?void 0:dt.scrollTop)??0;u(Ve=>{const gt=Ve.includes($),wr=Ve.length>=ya;return gt?Ve.filter(At=>At!==$):wr?Ve:(W===1&&p(""),setTimeout(()=>{var At;(At=v.current)==null||At.focus({preventScroll:!0})},0),[...Ve,$])}),requestAnimationFrame(()=>{b.current&&(b.current.scrollTop=X),S.current&&(S.current.scrollTop=Z)})},[]),wt=($,W)=>{if(W.stopPropagation(),x.current&&(x.current.pause(),x.current=null),f===$.code){m(null);return}if(!$.clipPath)return;const X=new Audio($.clipPath);x.current=X,m($.code),X.play().catch(Z=>console.error("Failed to play:",Z)),X.onended=()=>{m(null),x.current=null}},pt=()=>{if(d.length===0)return;!A||!M.some(W=>W.id===A)?V(!0):Lr()},Lr=()=>{localStorage.setItem(va,JSON.stringify(d)),n?localStorage.setItem(xc,"nz"):localStorage.removeItem(xc),sessionStorage.setItem("customPackWasTemporary","true"),d0(d.length),t("/level-select?pack=custom")},Xt=()=>{V(!1),Re(!0),k(!0)},Yl=()=>{u([]),O(null),pe("");try{localStorage.removeItem(va)}catch($){console.error("Failed to clear custom pack from localStorage:",$)}},Kl=()=>{p(""),setTimeout(()=>{var $;($=v.current)==null||$.focus()},0)},Ms=()=>{const $=!j;E($);try{localStorage.setItem("soundfield_taxonomic_sort",String($)),Kw($,"custom_pack_builder")}catch(W){console.error("Failed to save taxonomic sort:",W)}},na=()=>{if(d.length===0){alert("Please select at least one bird before saving.");return}if(M.length>=_a&&!A){alert(`You can only save up to ${_a} packs. Please delete one first.`);return}A&&H&&z(H),k(!0)},qn=($=!1)=>{const W=R.trim();if(!W){alert("Please enter a name for your pack.");return}if(A&&!$){const X=M.map(Z=>Z.id===A?{...Z,name:W,species:[...d],lastModified:new Date().toISOString()}:Z);F(X);try{localStorage.setItem(Ds,JSON.stringify(X)),u0(W,d.length)}catch(Z){console.error("Failed to update pack:",Z),alert("Failed to update pack. Storage may be full.")}pe(W)}else{if(M.length>=_a){alert(`You can only save up to ${_a} packs. Please delete one first.`);return}const X={id:Date.now().toString(),name:W,species:[...d],created:new Date().toISOString(),version:1},Z=[...M,X];F(Z);try{localStorage.setItem(Ds,JSON.stringify(Z)),u0(W,d.length)}catch(Pe){console.error("Failed to save pack:",Pe),alert("Failed to save pack. Storage may be full.")}O(X.id),pe(X.name)}k(!1),z(""),ge&&(Re(!1),localStorage.setItem(va,JSON.stringify(d)),n?localStorage.setItem(xc,"nz"):localStorage.removeItem(xc),d0(d.length),t("/level-select?pack=custom"))},q=$=>{const W=new Set(l.map(Pe=>Pe.code)),X=$.species.filter(Pe=>W.has(Pe)),Z=$.species.length-X.length;if(Z>0){alert(` ${Z} bird${Z>1?"s":""} in "${$.name}" ${Z>1?"are":"is"} no longer available and ${Z>1?"were":"was"} removed.

This can happen when bird names are updated to match the latest taxonomy.`);const Pe={...$,species:X},dt=M.map(Ve=>Ve.id===$.id?Pe:Ve);F(dt);try{localStorage.setItem(Ds,JSON.stringify(dt))}catch(Ve){console.error("Failed to update pack:",Ve)}}u(X),p(""),O($.id),pe($.name),zk($.name,X.length)},Ie=$=>{C($),I(!0)},We=()=>{var X;if(!D)return;const $=((X=M.find(Z=>Z.id===D))==null?void 0:X.name)||"unknown",W=M.filter(Z=>Z.id!==D);F(W);try{localStorage.setItem(Ds,JSON.stringify(W)),$k($)}catch(Z){console.error("Failed to update saved packs:",Z)}I(!1),C(null)},le=(()=>{let $=l;if(fe){const W=je.find(X=>X.id===fe);if(W){const X=new Set(W.species);$=$.filter(Z=>X.has(Z.code))}}return h&&($=$.filter(W=>W.name.toLowerCase().includes(h.toLowerCase())||W.code.toLowerCase().includes(h.toLowerCase())||W.scientificName&&W.scientificName.toLowerCase().includes(h.toLowerCase()))),j&&Object.keys(T).length>0?[...$].sort((W,X)=>{const Z=T[W.code]||9999,Pe=T[X.code]||9999;return Z-Pe}):$})();return w.useEffect(()=>()=>{x.current&&x.current.pause()},[]),_?a.jsx("div",{className:"screen screen-center",children:a.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading species..."})}):a.jsxs("div",{ref:S,className:"screen",style:{display:"flex",flexDirection:"column",overflow:"hidden"},children:[a.jsx("div",{style:{flexShrink:0,marginBottom:"12px"},children:a.jsxs("div",{className:"flex-row items-center gap-md",children:[a.jsx("button",{className:"btn-icon",onClick:()=>t(n?"/nz-packs":"/pack-select"),"aria-label":"Back",style:{color:i,opacity:.7},children:a.jsx(wI,{})}),a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:"18px"},children:n?"Custom NZ Pack":"Custom Pack Builder"}),a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:A?a.jsxs("span",{children:["Editing: ",a.jsx("strong",{style:{color:i},children:H})]}):`Select up to ${ya} birds`})]})]})}),M.length>0&&a.jsxs("div",{style:{flexShrink:0,marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[a.jsxs("button",{onClick:()=>P(!N),style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",background:"none",border:"none",color:"var(--color-text)",cursor:"pointer",padding:0},children:[a.jsxs("span",{style:{fontSize:"13px",fontWeight:600},children:[" My Saved Packs (",M.length,"/",_a,")"]}),a.jsx("span",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:N?"":""})]}),N&&a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px",marginTop:"8px"},children:M.map($=>a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 8px",background:"rgba(100, 181, 246, 0.05)",borderRadius:"6px",border:"1px solid rgba(100, 181, 246, 0.2)",position:"relative"},children:[a.jsxs("button",{onClick:()=>{q($),P(!1)},style:{flex:1,textAlign:"left",background:"none",border:"none",color:"var(--color-text)",fontSize:"12px",cursor:"pointer",padding:0},children:[a.jsx("div",{style:{fontWeight:600},children:$.name}),a.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:[$.species.length," bird",$.species.length>1?"s":""]})]}),a.jsx("button",{onPointerDown:W=>{W.stopPropagation(),console.log("Delete button pressed!",$.id),setTimeout(()=>{Ie($.id)},0)},style:{background:"rgba(229, 115, 115, 0.1)",border:"1px solid rgba(229, 115, 115, 0.3)",borderRadius:"4px",padding:"8px 12px",fontSize:"11px",color:"var(--color-error)",cursor:"pointer",pointerEvents:"auto",position:"relative",zIndex:100,WebkitTapHighlightColor:"rgba(229, 115, 115, 0.3)",touchAction:"manipulation",WebkitUserSelect:"none",userSelect:"none",minWidth:"60px",minHeight:"32px"},"aria-label":`Delete ${$.name}`,children:"Delete"})]},$.id))})]}),je.length>0&&a.jsxs("div",{style:{flexShrink:0,marginBottom:"8px",display:"flex",flexWrap:"wrap",gap:"6px"},children:[a.jsx("button",{onClick:()=>Me(null),style:{padding:"6px 12px",background:fe===null?n?"rgba(45, 122, 122, 0.2)":"rgba(255, 152, 0, 0.2)":"var(--color-surface)",border:fe===null?`2px solid ${i}`:"1px solid var(--color-text-muted)",borderRadius:"16px",cursor:"pointer",fontSize:"12px",fontWeight:fe===null?600:400,color:fe===null?i:"var(--color-text)",whiteSpace:"nowrap"},children:"All"}),je.map($=>{const W=$.name.replace("Backyard Birds","Backyard").replace("Grassland & Open Country","Grassland").replace("Eastern Birds","Eastern").replace("Western Birds","Western").replace("Warbler Academy","Warblers");return a.jsx("button",{onClick:()=>Me($.id),style:{padding:"6px 12px",background:fe===$.id?n?"rgba(45, 122, 122, 0.2)":"rgba(255, 152, 0, 0.2)":"var(--color-surface)",border:fe===$.id?`2px solid ${i}`:"1px solid var(--color-text-muted)",borderRadius:"16px",cursor:"pointer",fontSize:"12px",fontWeight:fe===$.id?600:400,color:fe===$.id?i:"var(--color-text)",whiteSpace:"nowrap"},children:W},$.id)})]}),a.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",display:"flex",gap:"8px"},children:[a.jsxs("div",{style:{flex:1,position:"relative"},children:[a.jsx("input",{ref:v,type:"text",placeholder:"Search birds...",value:h,onChange:$=>p($.target.value),style:{width:"100%",padding:"10px 12px",paddingRight:h?"36px":"12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px"}}),h&&a.jsx("button",{onClick:Kl,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"var(--color-text-muted)",border:"none",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:0},"aria-label":"Clear search",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-background)",strokeWidth:"3",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsxs("button",{onClick:Ms,style:{padding:"10px 14px",background:j?n?"rgba(45, 122, 122, 0.15)":"rgba(255, 152, 0, 0.15)":"var(--color-surface)",border:j?`1px solid ${s}`:"1px solid var(--color-text-muted)",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"13px",fontWeight:600,whiteSpace:"nowrap",color:"var(--color-text)"},"aria-label":"Toggle taxonomic sort",children:[a.jsx("span",{children:j?"":""}),a.jsx("span",{children:j?"Taxonomic ":"Sort"})]})]}),a.jsxs("div",{style:{flexShrink:0,marginBottom:"8px",padding:"6px 10px",background:"rgba(45, 90, 39, 0.1)",borderRadius:"8px",fontSize:"12px",color:"var(--color-text-muted)",lineHeight:1.3},children:[a.jsx("span",{style:{color:s},children:""})," Tap ",a.jsx("strong",{style:{color:"var(--color-text)"},children:""})," to preview, ",a.jsx("strong",{style:{color:"var(--color-text)"},children:"anywhere else on the card"})," to add/remove.",j&&a.jsxs(a.Fragment,{children:[" ",a.jsx("span",{style:{color:s},children:""})," Taxonomic mode groups related species together."]})]}),a.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",padding:"8px 12px",background:d.length>0?"rgba(45, 90, 39, 0.2)":"var(--color-surface)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("span",{style:{fontSize:"14px"},children:[a.jsx("span",{style:{fontWeight:700,color:i},children:d.length}),"/",ya," selected"]}),d.length>0&&a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("button",{onClick:na,style:{background:"rgba(45, 90, 39, 0.2)",border:"1px solid var(--color-primary)",borderRadius:"6px",padding:"4px 10px",color:"white",fontSize:"12px",cursor:"pointer",fontWeight:600},children:A?" Update / Save As New":" Save Pack"}),a.jsx("button",{onClick:Yl,style:{background:"none",border:"none",color:"var(--color-text-muted)",fontSize:"12px",cursor:"pointer",textDecoration:"underline"},children:"Clear all"})]})]}),a.jsx("div",{ref:b,style:{flex:1,overflowY:"auto",paddingBottom:"80px"},children:a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(110px, 1fr))",gap:"6px"},children:le.map($=>{const W=d.includes($.code),X=d.indexOf($.code),Z=W?_0[X%_0.length]:void 0;return a.jsxs("div",{onClick:()=>ct($.code,le.length),style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px",background:W?`${Z}22`:"var(--color-surface)",border:W?`2px solid ${Z}`:"1px solid transparent",borderRadius:"10px",opacity:W||d.length<ya?1:.5,transition:"all 0.15s",cursor:W||d.length<ya?"pointer":"not-allowed"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[a.jsx("button",{onClick:Pe=>{Pe.stopPropagation(),wt($,Pe)},style:{flex:"0 0 36px",width:"36px",height:"36px",borderRadius:"50%",background:f===$.code?n?"rgba(45, 122, 122, 0.3)":"rgba(255, 152, 0, 0.3)":n?"rgba(45, 122, 122, 0.1)":"rgba(255, 152, 0, 0.1)",border:`2px solid ${f===$.code?i:o}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.15s",padding:0},"aria-label":`Preview ${$.name}`,children:f===$.code?a.jsx(SI,{color:i}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:i,children:a.jsx("path",{d:"M8 5v14l11-7z"})})}),a.jsxs("div",{style:{flex:"1",display:"flex",alignItems:"center",justifyContent:"center",padding:"2px",position:"relative",pointerEvents:"none"},children:[a.jsx(bI,{code:$.code,size:40}),W&&a.jsx("div",{style:{position:"absolute",top:"0",right:"0",width:"20px",height:"20px",borderRadius:"50%",background:Z,display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(EI,{})})]})]}),a.jsxs("div",{style:{width:"100%",textAlign:"center",pointerEvents:"none"},children:[a.jsx("div",{style:{fontSize:"11px",color:"#ffffff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:500,fontStyle:j&&$.scientificName?"italic":"normal"},children:j&&$.scientificName?$.scientificName:$.name}),a.jsx("div",{style:{fontSize:"10px",color:"rgba(255, 255, 255, 0.7)",marginTop:"2px",fontWeight:600},children:$.code})]})]},$.code)})})}),d.length>0&&a.jsxs("button",{onClick:pt,style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",left:"24px",right:"24px",padding:"14px 20px",fontSize:"16px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",zIndex:1e3},children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start with ",d.length," bird",d.length>1?"s":""]}),U&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>k(!1),children:a.jsxs("div",{style:{background:"var(--color-background)",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid var(--color-primary)"},onClick:$=>$.stopPropagation(),children:[a.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px"},children:A?"Update or Rename Pack":"Save Custom Pack"}),a.jsx("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"16px"},children:A?"Edit the name or species list. You can update this pack or save as a new one:":"Give your pack a name so you can load it later:"}),a.jsx("input",{type:"text",value:R,onChange:$=>z($.target.value),onKeyDown:$=>$.key==="Enter"&&qn(!1),placeholder:"e.g., My Backyard, Lake Erie Migrants...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",marginBottom:"16px"}}),A?a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[a.jsxs("button",{onClick:()=>qn(!1),style:{padding:"12px 20px",background:"var(--color-primary)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:[' Update "',H,'"']}),a.jsx("button",{onClick:()=>qn(!0),style:{padding:"12px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Save As New Pack"}),a.jsx("button",{onClick:()=>{k(!1),z("")},style:{padding:"8px 20px",background:"transparent",border:"none",color:"var(--color-text-muted)",fontSize:"13px",cursor:"pointer"},children:"Cancel"})]}):a.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[a.jsx("button",{onClick:()=>{k(!1),z("")},style:{padding:"10px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Cancel"}),a.jsx("button",{onClick:()=>qn(!1),style:{padding:"10px 20px",background:"var(--color-primary)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:" Save Pack"})]})]})}),ie&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>V(!1),children:a.jsxs("div",{style:{background:"var(--color-background)",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"100%",border:`2px solid ${o}`},onClick:$=>$.stopPropagation(),children:[a.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px"},children:"Save this pack?"}),a.jsx("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.5},children:"Would you like to save this pack before playing? If you save it, you can easily reload and edit it later."}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[a.jsx("button",{onClick:Xt,style:{padding:"12px 20px",background:"var(--color-primary)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:" Save & Play"}),a.jsx("button",{onClick:()=>{V(!1),Lr()},style:{padding:"12px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Just Play (Don't Save)"}),a.jsx("button",{onClick:()=>V(!1),style:{padding:"12px 20px",background:"transparent",border:"none",color:"var(--color-text-muted)",fontSize:"13px",cursor:"pointer"},children:"Cancel"})]})]})}),L&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{I(!1),C(null)},children:a.jsxs("div",{style:{background:"var(--color-background)",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid var(--color-error)"},onClick:$=>$.stopPropagation(),children:[a.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"var(--color-error)"},children:"Delete Saved Pack?"}),a.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"16px"},children:['This will permanently delete "',(oe=M.find($=>$.id===D))==null?void 0:oe.name,'". This action cannot be undone.']}),a.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[a.jsx("button",{onClick:()=>{I(!1),C(null)},style:{padding:"10px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Cancel"}),a.jsx("button",{onClick:We,style:{padding:"10px 20px",background:"var(--color-error)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Delete Pack"})]})]})})]})}function bI({code:t,size:e=48}){const[r,n]=w.useState(!0),i=`/data/icons/${t}.png`;return r?a.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>n(!1)}):a.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-text-muted)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:700,color:"#FFFFFF"},children:t})}function wI(){return a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}function SI({color:t="currentColor"}){return a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:t,children:a.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function EI(){return a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1A1A2E",strokeWidth:"3",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})}const TI={campaign:"Learn",practice:"Practice",challenge:"Challenge",random:"Random"};function CI({score:t,streak:e,timeRemaining:r,mode:n,levelId:i,levelTitle:s}){const o=Math.floor(r/60),l=r%60,c=`${o}:${l.toString().padStart(2,"0")}`;return a.jsxs("div",{className:"hud",children:[a.jsxs("div",{className:"hud-score",children:[a.jsx("span",{className:"hud-label",children:"Score"}),a.jsx("span",{className:"hud-value",children:t.toLocaleString()})]}),a.jsxs("div",{className:"hud-center",children:[n==="campaign"&&i?a.jsxs("span",{className:"hud-mode",children:["Level ",i,s?`: ${s}`:""]}):n?a.jsx("span",{className:"hud-mode",children:TI[n]||n}):null,a.jsx("div",{className:"hud-streak",children:e===0?a.jsx("span",{className:"streak-dot",children:""}):Array.from({length:e}).map((d,u)=>a.jsx("span",{className:"streak-dot active",children:""},u))})]}),a.jsxs("div",{className:"hud-timer",children:[a.jsx("span",{className:"hud-label",children:"Time"}),a.jsx("span",{className:"hud-value",children:c})]}),a.jsx("style",{children:`
        .hud {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          padding-top: calc(12px + var(--safe-area-top, 0px));
          background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.3) 100%);
          border-bottom: 1px solid var(--color-surface);
        }

        .hud-score, .hud-timer {
          display: flex;
          flex-direction: column;
          align-items: center;
          min-width: 80px;
        }

        .hud-label {
          font-size: 10px;
          text-transform: uppercase;
          color: var(--color-text-muted);
          letter-spacing: 0.5px;
        }

        .hud-value {
          font-family: var(--font-mono);
          font-size: 20px;
          font-weight: 600;
          color: var(--color-accent);
        }

        .hud-center {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 4px;
        }

        .hud-mode {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1px;
          color: var(--color-text-muted);
          padding: 2px 8px;
          border-radius: 4px;
          background: rgba(255, 255, 255, 0.1);
        }

        .hud-streak {
          display: flex;
          gap: 4px;
          font-size: 12px;
        }

        .streak-dot {
          color: var(--color-text-muted);
          transition: color 0.2s, transform 0.2s;
        }

        .streak-dot.active {
          color: var(--color-accent);
          transform: scale(1.2);
        }
      `})]})}const AI=w.memo(CI);var ks=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(ks||{}),Qw=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(Qw||{}),Uf=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Uf||{}),be=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(be||{}),gn=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(gn||{}),K=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(K||{}),_o=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(_o||{}),me=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(me||{}),te=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(te||{}),Bn=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(Bn||{}),Ai=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Ai||{}),bn=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(bn||{}),nr=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(nr||{}),pn=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(pn||{}),qg=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(qg||{}),Rr=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(Rr||{}),Et=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(Et||{}),yt=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(yt||{}),vn=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(vn||{});const kI={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},re={ADAPTER:kI,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Dh=/iPhone/i,b0=/iPod/i,w0=/iPad/i,S0=/\biOS-universal(?:.+)Mac\b/i,Lh=/\bAndroid(?:.+)Mobile\b/i,E0=/Android/i,Ls=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,yc=/Silk/i,Cn=/Windows Phone/i,T0=/\bWindows(?:.+)ARM\b/i,C0=/BlackBerry/i,A0=/BB10/i,k0=/Opera Mini/i,I0=/\b(CriOS|Chrome)(?:.+)Mobile/i,R0=/Mobile(?:.+)Firefox\b/i,P0=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function II(t){return function(e){return e.test(t)}}function j0(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,n=r.split("[FBAN");typeof n[1]<"u"&&(r=n[0]),n=r.split("Twitter"),typeof n[1]<"u"&&(r=n[0]);var i=II(r),s={apple:{phone:i(Dh)&&!i(Cn),ipod:i(b0),tablet:!i(Dh)&&(i(w0)||P0(e))&&!i(Cn),universal:i(S0),device:(i(Dh)||i(b0)||i(w0)||i(S0)||P0(e))&&!i(Cn)},amazon:{phone:i(Ls),tablet:!i(Ls)&&i(yc),device:i(Ls)||i(yc)},android:{phone:!i(Cn)&&i(Ls)||!i(Cn)&&i(Lh),tablet:!i(Cn)&&!i(Ls)&&!i(Lh)&&(i(yc)||i(E0)),device:!i(Cn)&&(i(Ls)||i(yc)||i(Lh)||i(E0))||i(/\bokhttp\b/i)},windows:{phone:i(Cn),tablet:i(T0),device:i(Cn)||i(T0)},other:{blackberry:i(C0),blackberry10:i(A0),opera:i(k0),firefox:i(R0),chrome:i(I0),device:i(C0)||i(A0)||i(k0)||i(R0)||i(I0)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const RI=j0.default??j0,Dn=RI(globalThis.navigator);re.RETINA_PREFIX=/@([0-9\.]+)x/;re.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var eS={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function s(c,d,u,h,p){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,h||c,p),m=r?r+d:d;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],f]:c._events[m].push(f):(c._events[m]=f,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,h;if(this._eventsCount===0)return d;for(h in u=this._events)e.call(u,h)&&d.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,f=h.length,m=new Array(f);p<f;p++)m[p]=h[p].fn;return m},l.prototype.listenerCount=function(d){var u=r?r+d:d,h=this._events[u];return h?h.fn?1:h.length:0},l.prototype.emit=function(d,u,h,p,f,m){var _=r?r+d:d;if(!this._events[_])return!1;var y=this._events[_],x=arguments.length,v,g;if(y.fn){switch(y.once&&this.removeListener(d,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,h),!0;case 4:return y.fn.call(y.context,u,h,p),!0;case 5:return y.fn.call(y.context,u,h,p,f),!0;case 6:return y.fn.call(y.context,u,h,p,f,m),!0}for(g=1,v=new Array(x-1);g<x;g++)v[g-1]=arguments[g];y.fn.apply(y.context,v)}else{var b=y.length,S;for(g=0;g<b;g++)switch(y[g].once&&this.removeListener(d,y[g].fn,void 0,!0),x){case 1:y[g].fn.call(y[g].context);break;case 2:y[g].fn.call(y[g].context,u);break;case 3:y[g].fn.call(y[g].context,u,h);break;case 4:y[g].fn.call(y[g].context,u,h,p);break;default:if(!v)for(S=1,v=new Array(x-1);S<x;S++)v[S-1]=arguments[S];y[g].fn.apply(y[g].context,v)}}return!0},l.prototype.on=function(d,u,h){return s(this,d,u,h,!1)},l.prototype.once=function(d,u,h){return s(this,d,u,h,!0)},l.prototype.removeListener=function(d,u,h,p){var f=r?r+d:d;if(!this._events[f])return this;if(!u)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!p||m.once)&&(!h||m.context===h)&&o(this,f);else{for(var _=0,y=[],x=m.length;_<x;_++)(m[_].fn!==u||p&&!m[_].once||h&&m[_].context!==h)&&y.push(m[_]);y.length?this._events[f]=y.length===1?y[0]:y:o(this,f)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(eS);var PI=eS.exports;const Ll=Zm(PI);var Zg={exports:{}};Zg.exports=Du;Zg.exports.default=Du;function Du(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=tS(t,0,i,r,!0),o=[];if(!s||s.next===s.prev)return o;var l,c,d,u,h,p,f;if(n&&(s=DI(t,e,s,r)),t.length>80*r){l=d=t[0],c=u=t[1];for(var m=r;m<i;m+=r)h=t[m],p=t[m+1],h<l&&(l=h),p<c&&(c=p),h>d&&(d=h),p>u&&(u=p);f=Math.max(d-l,u-c),f=f!==0?32767/f:0}return wl(s,o,r,l,c,f,0),o}function tS(t,e,r,n,i){var s,o;if(i===Gf(t,e,r,n)>0)for(s=e;s<r;s+=n)o=M0(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=M0(s,t[s],t[s+1],o);return o&&Lu(o,o.next)&&(El(o),o=o.next),o}function vs(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Lu(r,r.next)||st(r.prev,r,r.next)===0)){if(El(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function wl(t,e,r,n,i,s,o){if(t){!o&&s&&zI(t,n,i,s);for(var l=t,c,d;t.prev!==t.next;){if(c=t.prev,d=t.next,s?MI(t,n,i,s):jI(t)){e.push(c.i/r|0),e.push(t.i/r|0),e.push(d.i/r|0),El(t),t=d.next,l=d.next;continue}if(t=d,t===l){o?o===1?(t=NI(vs(t),e,r),wl(t,e,r,n,i,s,2)):o===2&&BI(t,e,r,n,i,s):wl(vs(t),e,r,n,i,s,1);break}}}}function jI(t){var e=t.prev,r=t,n=t.next;if(st(e,r,n)>=0)return!1;for(var i=e.x,s=r.x,o=n.x,l=e.y,c=r.y,d=n.y,u=i<s?i<o?i:o:s<o?s:o,h=l<c?l<d?l:d:c<d?c:d,p=i>s?i>o?i:o:s>o?s:o,f=l>c?l>d?l:d:c>d?c:d,m=n.next;m!==e;){if(m.x>=u&&m.x<=p&&m.y>=h&&m.y<=f&&uo(i,l,s,c,o,d,m.x,m.y)&&st(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function MI(t,e,r,n){var i=t.prev,s=t,o=t.next;if(st(i,s,o)>=0)return!1;for(var l=i.x,c=s.x,d=o.x,u=i.y,h=s.y,p=o.y,f=l<c?l<d?l:d:c<d?c:d,m=u<h?u<p?u:p:h<p?h:p,_=l>c?l>d?l:d:c>d?c:d,y=u>h?u>p?u:p:h>p?h:p,x=zf(f,m,e,r,n),v=zf(_,y,e,r,n),g=t.prevZ,b=t.nextZ;g&&g.z>=x&&b&&b.z<=v;){if(g.x>=f&&g.x<=_&&g.y>=m&&g.y<=y&&g!==i&&g!==o&&uo(l,u,c,h,d,p,g.x,g.y)&&st(g.prev,g,g.next)>=0||(g=g.prevZ,b.x>=f&&b.x<=_&&b.y>=m&&b.y<=y&&b!==i&&b!==o&&uo(l,u,c,h,d,p,b.x,b.y)&&st(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;g&&g.z>=x;){if(g.x>=f&&g.x<=_&&g.y>=m&&g.y<=y&&g!==i&&g!==o&&uo(l,u,c,h,d,p,g.x,g.y)&&st(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;b&&b.z<=v;){if(b.x>=f&&b.x<=_&&b.y>=m&&b.y<=y&&b!==i&&b!==o&&uo(l,u,c,h,d,p,b.x,b.y)&&st(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function NI(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!Lu(i,s)&&rS(i,n,n.next,s)&&Sl(i,s)&&Sl(s,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(s.i/r|0),El(n),El(n.next),n=t=s),n=n.next}while(n!==t);return vs(n)}function BI(t,e,r,n,i,s){var o=t;do{for(var l=o.next.next;l!==o.prev;){if(o.i!==l.i&&HI(o,l)){var c=nS(o,l);o=vs(o,o.next),c=vs(c,c.next),wl(o,e,r,n,i,s,0),wl(c,e,r,n,i,s,0);return}l=l.next}o=o.next}while(o!==t)}function DI(t,e,r,n){var i=[],s,o,l,c,d;for(s=0,o=e.length;s<o;s++)l=e[s]*n,c=s<o-1?e[s+1]*n:t.length,d=tS(t,l,c,n,!1),d===d.next&&(d.steiner=!0),i.push(GI(d));for(i.sort(LI),s=0;s<i.length;s++)r=FI(i[s],r);return r}function LI(t,e){return t.x-e.x}function FI(t,e){var r=OI(t,e);if(!r)return e;var n=nS(r,t);return vs(n,n.next),vs(r,r.next)}function OI(t,e){var r=e,n=t.x,i=t.y,s=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var l=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(l<=n&&l>s&&(s=l,o=r.x<r.next.x?r:r.next,l===n))return o}r=r.next}while(r!==e);if(!o)return null;var c=o,d=o.x,u=o.y,h=1/0,p;r=o;do n>=r.x&&r.x>=d&&n!==r.x&&uo(i<u?n:s,i,d,u,i<u?s:n,i,r.x,r.y)&&(p=Math.abs(i-r.y)/(n-r.x),Sl(r,t)&&(p<h||p===h&&(r.x>o.x||r.x===o.x&&UI(o,r)))&&(o=r,h=p)),r=r.next;while(r!==c);return o}function UI(t,e){return st(t.prev,t,e.prev)<0&&st(e.next,t,t.next)<0}function zI(t,e,r,n){var i=t;do i.z===0&&(i.z=zf(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,$I(i)}function $I(t){var e,r,n,i,s,o,l,c,d=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,n=r,l=0,e=0;e<d&&(l++,n=n.nextZ,!!n);e++);for(c=d;l>0||c>0&&n;)l!==0&&(c===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,l--):(i=n,n=n.nextZ,c--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n}s.nextZ=null,d*=2}while(o>1);return t}function zf(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function GI(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function uo(t,e,r,n,i,s,o,l){return(i-o)*(e-l)>=(t-o)*(s-l)&&(t-o)*(n-l)>=(r-o)*(e-l)&&(r-o)*(s-l)>=(i-o)*(n-l)}function HI(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!WI(t,e)&&(Sl(t,e)&&Sl(e,t)&&VI(t,e)&&(st(t.prev,t,e.prev)||st(t,e.prev,e))||Lu(t,e)&&st(t.prev,t,t.next)>0&&st(e.prev,e,e.next)>0)}function st(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Lu(t,e){return t.x===e.x&&t.y===e.y}function rS(t,e,r,n){var i=_c(st(t,e,r)),s=_c(st(t,e,n)),o=_c(st(r,n,t)),l=_c(st(r,n,e));return!!(i!==s&&o!==l||i===0&&vc(t,r,e)||s===0&&vc(t,n,e)||o===0&&vc(r,t,n)||l===0&&vc(r,e,n))}function vc(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function _c(t){return t>0?1:t<0?-1:0}function WI(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&rS(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Sl(t,e){return st(t.prev,t,t.next)<0?st(t,e,t.next)>=0&&st(t,t.prev,e)>=0:st(t,e,t.prev)<0||st(t,t.next,e)<0}function VI(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function nS(t,e){var r=new $f(t.i,t.x,t.y),n=new $f(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function M0(t,e,r,n){var i=new $f(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function El(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function $f(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Du.deviation=function(t,e,r,n){var i=e&&e.length,s=i?e[0]*r:t.length,o=Math.abs(Gf(t,0,s,r));if(i)for(var l=0,c=e.length;l<c;l++){var d=e[l]*r,u=l<c-1?e[l+1]*r:t.length;o-=Math.abs(Gf(t,d,u,r))}var h=0;for(l=0;l<n.length;l+=3){var p=n[l]*r,f=n[l+1]*r,m=n[l+2]*r;h+=Math.abs((t[p]-t[m])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[m+1]-t[p+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function Gf(t,e,r,n){for(var i=0,s=e,o=r-n;s<r;s+=n)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}Du.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[i][s][o]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var XI=Zg.exports;const YI=Zm(XI);var Kd={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Kd.exports;(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof za=="object"&&za;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,l=2147483647,c=36,d=1,u=26,h=38,p=700,f=72,m=128,_="-",y=/^xn--/,x=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=c-d,S=Math.floor,j=String.fromCharCode,E;function T(D){throw new RangeError(g[D])}function B(D,C){for(var A=D.length,O=[];A--;)O[A]=C(D[A]);return O}function M(D,C){var A=D.split("@"),O="";A.length>1&&(O=A[0]+"@",D=A[1]),D=D.replace(v,".");var H=D.split("."),pe=B(H,C).join(".");return O+pe}function F(D){for(var C=[],A=0,O=D.length,H,pe;A<O;)H=D.charCodeAt(A++),H>=55296&&H<=56319&&A<O?(pe=D.charCodeAt(A++),(pe&64512)==56320?C.push(((H&1023)<<10)+(pe&1023)+65536):(C.push(H),A--)):C.push(H);return C}function U(D){return B(D,function(C){var A="";return C>65535&&(C-=65536,A+=j(C>>>10&1023|55296),C=56320|C&1023),A+=j(C),A}).join("")}function k(D){return D-48<10?D-22:D-65<26?D-65:D-97<26?D-97:c}function R(D,C){return D+22+75*(D<26)-((C!=0)<<5)}function z(D,C,A){var O=0;for(D=A?S(D/p):D>>1,D+=S(D/C);D>b*u>>1;O+=c)D=S(D/b);return S(O+(b+1)*D/(D+h))}function N(D){var C=[],A=D.length,O,H=0,pe=m,ie=f,V,ge,Re,je,Te,fe,Me,ct,wt;for(V=D.lastIndexOf(_),V<0&&(V=0),ge=0;ge<V;++ge)D.charCodeAt(ge)>=128&&T("not-basic"),C.push(D.charCodeAt(ge));for(Re=V>0?V+1:0;Re<A;){for(je=H,Te=1,fe=c;Re>=A&&T("invalid-input"),Me=k(D.charCodeAt(Re++)),(Me>=c||Me>S((l-H)/Te))&&T("overflow"),H+=Me*Te,ct=fe<=ie?d:fe>=ie+u?u:fe-ie,!(Me<ct);fe+=c)wt=c-ct,Te>S(l/wt)&&T("overflow"),Te*=wt;O=C.length+1,ie=z(H-je,O,je==0),S(H/O)>l-pe&&T("overflow"),pe+=S(H/O),H%=O,C.splice(H++,0,pe)}return U(C)}function P(D){var C,A,O,H,pe,ie,V,ge,Re,je,Te,fe=[],Me,ct,wt,pt;for(D=F(D),Me=D.length,C=m,A=0,pe=f,ie=0;ie<Me;++ie)Te=D[ie],Te<128&&fe.push(j(Te));for(O=H=fe.length,H&&fe.push(_);O<Me;){for(V=l,ie=0;ie<Me;++ie)Te=D[ie],Te>=C&&Te<V&&(V=Te);for(ct=O+1,V-C>S((l-A)/ct)&&T("overflow"),A+=(V-C)*ct,C=V,ie=0;ie<Me;++ie)if(Te=D[ie],Te<C&&++A>l&&T("overflow"),Te==C){for(ge=A,Re=c;je=Re<=pe?d:Re>=pe+u?u:Re-pe,!(ge<je);Re+=c)pt=ge-je,wt=c-je,fe.push(j(R(je+pt%wt,0))),ge=S(pt/wt);fe.push(j(R(ge,0))),pe=z(A,ct,O==H),A=0,++O}++A,++C}return fe.join("")}function L(D){return M(D,function(C){return y.test(C)?N(C.slice(4).toLowerCase()):C})}function I(D){return M(D,function(C){return x.test(C)?"xn--"+P(C):C})}if(o={version:"1.4.1",ucs2:{decode:F,encode:U},decode:N,encode:P,toASCII:I,toUnicode:L},n&&i)if(t.exports==n)i.exports=o;else for(E in o)o.hasOwnProperty(E)&&(n[E]=o[E]);else r.punycode=o})(za)})(Kd,Kd.exports);var KI=Kd.exports,qo=TypeError;const qI={},ZI=Object.freeze(Object.defineProperty({__proto__:null,default:qI},Symbol.toStringTag,{value:"Module"})),JI=tC(ZI);var Jg=typeof Map=="function"&&Map.prototype,Fh=Object.getOwnPropertyDescriptor&&Jg?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,qd=Jg&&Fh&&typeof Fh.get=="function"?Fh.get:null,N0=Jg&&Map.prototype.forEach,Qg=typeof Set=="function"&&Set.prototype,Oh=Object.getOwnPropertyDescriptor&&Qg?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Zd=Qg&&Oh&&typeof Oh.get=="function"?Oh.get:null,B0=Qg&&Set.prototype.forEach,QI=typeof WeakMap=="function"&&WeakMap.prototype,Ja=QI?WeakMap.prototype.has:null,eR=typeof WeakSet=="function"&&WeakSet.prototype,Qa=eR?WeakSet.prototype.has:null,tR=typeof WeakRef=="function"&&WeakRef.prototype,D0=tR?WeakRef.prototype.deref:null,rR=Boolean.prototype.valueOf,nR=Object.prototype.toString,iR=Function.prototype.toString,sR=String.prototype.match,ex=String.prototype.slice,mi=String.prototype.replace,oR=String.prototype.toUpperCase,L0=String.prototype.toLowerCase,iS=RegExp.prototype.test,F0=Array.prototype.concat,fn=Array.prototype.join,aR=Array.prototype.slice,O0=Math.floor,Hf=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Uh=Object.getOwnPropertySymbols,Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Do=typeof Symbol=="function"&&typeof Symbol.iterator=="object",el=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Do||!0)?Symbol.toStringTag:null,sS=Object.prototype.propertyIsEnumerable,U0=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function z0(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||iS.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-O0(-t):O0(t);if(n!==t){var i=String(n),s=ex.call(e,i.length+1);return mi.call(i,r,"$&_")+"."+mi.call(mi.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return mi.call(e,r,"$&_")}var Vf=JI,$0=Vf.custom,G0=lS($0)?$0:null,oS={__proto__:null,double:'"',single:"'"},lR={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},Fu=function t(e,r,n,i){var s=r||{};if(Rn(s,"quoteStyle")&&!Rn(oS,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Rn(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Rn(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Rn(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Rn(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var l=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return dS(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return l?z0(e,c):c}if(typeof e=="bigint"){var d=String(e)+"n";return l?z0(e,d):d}var u=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=u&&u>0&&typeof e=="object")return Xf(e)?"[Array]":"[Object]";var h=CR(s,n);if(typeof i>"u")i=[];else if(cS(i,e)>=0)return"[Circular]";function p(k,R,z){if(R&&(i=aR.call(i),i.push(R)),z){var N={depth:s.depth};return Rn(s,"quoteStyle")&&(N.quoteStyle=s.quoteStyle),t(k,N,n+1,i)}return t(k,s,n+1,i)}if(typeof e=="function"&&!H0(e)){var f=xR(e),m=bc(e,p);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(m.length>0?" { "+fn.call(m,", ")+" }":"")}if(lS(e)){var _=Do?mi.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Wf.call(e);return typeof e=="object"&&!Do?ba(_):_}if(SR(e)){for(var y="<"+L0.call(String(e.nodeName)),x=e.attributes||[],v=0;v<x.length;v++)y+=" "+x[v].name+"="+aS(cR(x[v].value),"double",s);return y+=">",e.childNodes&&e.childNodes.length&&(y+="..."),y+="</"+L0.call(String(e.nodeName))+">",y}if(Xf(e)){if(e.length===0)return"[]";var g=bc(e,p);return h&&!TR(g)?"["+Yf(g,h)+"]":"[ "+fn.call(g,", ")+" ]"}if(uR(e)){var b=bc(e,p);return!("cause"in Error.prototype)&&"cause"in e&&!sS.call(e,"cause")?"{ ["+String(e)+"] "+fn.call(F0.call("[cause]: "+p(e.cause),b),", ")+" }":b.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+fn.call(b,", ")+" }"}if(typeof e=="object"&&o){if(G0&&typeof e[G0]=="function"&&Vf)return Vf(e,{depth:u-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(yR(e)){var S=[];return N0&&N0.call(e,function(k,R){S.push(p(R,e,!0)+" => "+p(k,e))}),W0("Map",qd.call(e),S,h)}if(bR(e)){var j=[];return B0&&B0.call(e,function(k){j.push(p(k,e))}),W0("Set",Zd.call(e),j,h)}if(vR(e))return zh("WeakMap");if(wR(e))return zh("WeakSet");if(_R(e))return zh("WeakRef");if(pR(e))return ba(p(Number(e)));if(mR(e))return ba(p(Hf.call(e)));if(fR(e))return ba(rR.call(e));if(hR(e))return ba(p(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof za<"u"&&e===za)return"{ [object globalThis] }";if(!dR(e)&&!H0(e)){var E=bc(e,p),T=U0?U0(e)===Object.prototype:e instanceof Object||e.constructor===Object,B=e instanceof Object?"":"null prototype",M=!T&&el&&Object(e)===e&&el in e?ex.call(Ui(e),8,-1):B?"Object":"",F=T||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",U=F+(M||B?"["+fn.call(F0.call([],M||[],B||[]),": ")+"] ":"");return E.length===0?U+"{}":h?U+"{"+Yf(E,h)+"}":U+"{ "+fn.call(E,", ")+" }"}return String(e)};function aS(t,e,r){var n=r.quoteStyle||e,i=oS[n];return i+t+i}function cR(t){return mi.call(String(t),/"/g,"&quot;")}function Is(t){return!el||!(typeof t=="object"&&(el in t||typeof t[el]<"u"))}function Xf(t){return Ui(t)==="[object Array]"&&Is(t)}function dR(t){return Ui(t)==="[object Date]"&&Is(t)}function H0(t){return Ui(t)==="[object RegExp]"&&Is(t)}function uR(t){return Ui(t)==="[object Error]"&&Is(t)}function hR(t){return Ui(t)==="[object String]"&&Is(t)}function pR(t){return Ui(t)==="[object Number]"&&Is(t)}function fR(t){return Ui(t)==="[object Boolean]"&&Is(t)}function lS(t){if(Do)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Wf)return!1;try{return Wf.call(t),!0}catch{}return!1}function mR(t){if(!t||typeof t!="object"||!Hf)return!1;try{return Hf.call(t),!0}catch{}return!1}var gR=Object.prototype.hasOwnProperty||function(t){return t in this};function Rn(t,e){return gR.call(t,e)}function Ui(t){return nR.call(t)}function xR(t){if(t.name)return t.name;var e=sR.call(iR.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function cS(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function yR(t){if(!qd||!t||typeof t!="object")return!1;try{qd.call(t);try{Zd.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function vR(t){if(!Ja||!t||typeof t!="object")return!1;try{Ja.call(t,Ja);try{Qa.call(t,Qa)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function _R(t){if(!D0||!t||typeof t!="object")return!1;try{return D0.call(t),!0}catch{}return!1}function bR(t){if(!Zd||!t||typeof t!="object")return!1;try{Zd.call(t);try{qd.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function wR(t){if(!Qa||!t||typeof t!="object")return!1;try{Qa.call(t,Qa);try{Ja.call(t,Ja)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function SR(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function dS(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return dS(ex.call(t,0,e.maxStringLength),e)+n}var i=lR[e.quoteStyle||"single"];i.lastIndex=0;var s=mi.call(mi.call(t,i,"\\$1"),/[\x00-\x1f]/g,ER);return aS(s,"single",e)}function ER(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+oR.call(e.toString(16))}function ba(t){return"Object("+t+")"}function zh(t){return t+" { ? }"}function W0(t,e,r,n){var i=n?Yf(r,n):fn.call(r,", ");return t+" ("+e+") {"+i+"}"}function TR(t){for(var e=0;e<t.length;e++)if(cS(t[e],`
`)>=0)return!1;return!0}function CR(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=fn.call(Array(t.indent+1)," ");else return null;return{base:r,prev:fn.call(Array(e+1),r)}}function Yf(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+fn.call(t,","+r)+`
`+e.prev}function bc(t,e){var r=Xf(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=Rn(t,i)?e(t[i],t):""}var s=typeof Uh=="function"?Uh(t):[],o;if(Do){o={};for(var l=0;l<s.length;l++)o["$"+s[l]]=s[l]}for(var c in t)Rn(t,c)&&(r&&String(Number(c))===c&&c<t.length||Do&&o["$"+c]instanceof Symbol||(iS.call(/[^\w$]/,c)?n.push(e(c,t)+": "+e(t[c],t)):n.push(c+": "+e(t[c],t))));if(typeof Uh=="function")for(var d=0;d<s.length;d++)sS.call(t,s[d])&&n.push("["+e(s[d])+"]: "+e(t[s[d]],t));return n}var AR=Fu,kR=qo,Ou=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},IR=function(t,e){if(t){var r=Ou(t,e);return r&&r.value}},RR=function(t,e,r){var n=Ou(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},PR=function(t,e){return t?!!Ou(t,e):!1},jR=function(t,e){if(t)return Ou(t,e,!0)},MR=function(){var e,r={assert:function(n){if(!r.has(n))throw new kR("Side channel does not contain "+AR(n))},delete:function(n){var i=e&&e.next,s=jR(e,n);return s&&i&&i===s&&(e=void 0),!!s},get:function(n){return IR(e,n)},has:function(n){return PR(e,n)},set:function(n,i){e||(e={next:void 0}),RR(e,n,i)}};return r},uS=Object,NR=Error,BR=EvalError,DR=RangeError,LR=ReferenceError,FR=SyntaxError,OR=URIError,UR=Math.abs,zR=Math.floor,$R=Math.max,GR=Math.min,HR=Math.pow,WR=Math.round,VR=Number.isNaN||function(e){return e!==e},XR=VR,YR=function(e){return XR(e)||e===0?e:e<0?-1:1},KR=Object.getOwnPropertyDescriptor,ad=KR;if(ad)try{ad([],"length")}catch{ad=null}var hS=ad,ld=Object.defineProperty||!1;if(ld)try{ld({},"a",{value:1})}catch{ld=!1}var qR=ld,$h,V0;function ZR(){return V0||(V0=1,$h=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(e,r);if(l.value!==i||l.enumerable!==!0)return!1}return!0}),$h}var Gh,X0;function JR(){if(X0)return Gh;X0=1;var t=typeof Symbol<"u"&&Symbol,e=ZR();return Gh=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Gh}var Hh,Y0;function pS(){return Y0||(Y0=1,Hh=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Hh}var Wh,K0;function fS(){if(K0)return Wh;K0=1;var t=uS;return Wh=t.getPrototypeOf||null,Wh}var QR="Function.prototype.bind called on incompatible ",eP=Object.prototype.toString,tP=Math.max,rP="[object Function]",q0=function(e,r){for(var n=[],i=0;i<e.length;i+=1)n[i]=e[i];for(var s=0;s<r.length;s+=1)n[s+e.length]=r[s];return n},nP=function(e,r){for(var n=[],i=r,s=0;i<e.length;i+=1,s+=1)n[s]=e[i];return n},iP=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},sP=function(e){var r=this;if(typeof r!="function"||eP.apply(r)!==rP)throw new TypeError(QR+r);for(var n=nP(arguments,1),i,s=function(){if(this instanceof i){var u=r.apply(this,q0(n,arguments));return Object(u)===u?u:this}return r.apply(e,q0(n,arguments))},o=tP(0,r.length-n.length),l=[],c=0;c<o;c++)l[c]="$"+c;if(i=Function("binder","return function ("+iP(l,",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var d=function(){};d.prototype=r.prototype,i.prototype=new d,d.prototype=null}return i},oP=sP,Uu=Function.prototype.bind||oP,Vh,Z0;function tx(){return Z0||(Z0=1,Vh=Function.prototype.call),Vh}var Xh,J0;function mS(){return J0||(J0=1,Xh=Function.prototype.apply),Xh}var aP=typeof Reflect<"u"&&Reflect&&Reflect.apply,lP=Uu,cP=mS(),dP=tx(),uP=aP,hP=uP||lP.call(dP,cP),pP=Uu,fP=qo,mP=tx(),gP=hP,gS=function(e){if(e.length<1||typeof e[0]!="function")throw new fP("a function is required");return gP(pP,mP,e)},Yh,Q0;function xP(){if(Q0)return Yh;Q0=1;var t=gS,e=hS,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return Yh=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(l){return s(l==null?l:i(l))}:!1,Yh}var Kh,ev;function yP(){if(ev)return Kh;ev=1;var t=pS(),e=fS(),r=xP();return Kh=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,Kh}var qh,tv;function vP(){if(tv)return qh;tv=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=Uu;return qh=r.call(t,e),qh}var De,_P=uS,bP=NR,wP=BR,SP=DR,EP=LR,Lo=FR,bo=qo,TP=OR,CP=UR,AP=zR,kP=$R,IP=GR,RP=HR,PP=WR,jP=YR,xS=Function,Zh=function(t){try{return xS('"use strict"; return ('+t+").constructor;")()}catch{}},Tl=hS,MP=qR,Jh=function(){throw new bo},NP=Tl?function(){try{return arguments.callee,Jh}catch{try{return Tl(arguments,"callee").get}catch{return Jh}}}():Jh,Fs=JR()(),kt=yP(),BP=fS(),DP=pS(),yS=mS(),Fl=tx(),Ws={},LP=typeof Uint8Array>"u"||!kt?De:kt(Uint8Array),ds={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?De:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?De:ArrayBuffer,"%ArrayIteratorPrototype%":Fs&&kt?kt([][Symbol.iterator]()):De,"%AsyncFromSyncIteratorPrototype%":De,"%AsyncFunction%":Ws,"%AsyncGenerator%":Ws,"%AsyncGeneratorFunction%":Ws,"%AsyncIteratorPrototype%":Ws,"%Atomics%":typeof Atomics>"u"?De:Atomics,"%BigInt%":typeof BigInt>"u"?De:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?De:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?De:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?De:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":bP,"%eval%":eval,"%EvalError%":wP,"%Float16Array%":typeof Float16Array>"u"?De:Float16Array,"%Float32Array%":typeof Float32Array>"u"?De:Float32Array,"%Float64Array%":typeof Float64Array>"u"?De:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?De:FinalizationRegistry,"%Function%":xS,"%GeneratorFunction%":Ws,"%Int8Array%":typeof Int8Array>"u"?De:Int8Array,"%Int16Array%":typeof Int16Array>"u"?De:Int16Array,"%Int32Array%":typeof Int32Array>"u"?De:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Fs&&kt?kt(kt([][Symbol.iterator]())):De,"%JSON%":typeof JSON=="object"?JSON:De,"%Map%":typeof Map>"u"?De:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Fs||!kt?De:kt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":_P,"%Object.getOwnPropertyDescriptor%":Tl,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?De:Promise,"%Proxy%":typeof Proxy>"u"?De:Proxy,"%RangeError%":SP,"%ReferenceError%":EP,"%Reflect%":typeof Reflect>"u"?De:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?De:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Fs||!kt?De:kt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?De:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Fs&&kt?kt(""[Symbol.iterator]()):De,"%Symbol%":Fs?Symbol:De,"%SyntaxError%":Lo,"%ThrowTypeError%":NP,"%TypedArray%":LP,"%TypeError%":bo,"%Uint8Array%":typeof Uint8Array>"u"?De:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?De:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?De:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?De:Uint32Array,"%URIError%":TP,"%WeakMap%":typeof WeakMap>"u"?De:WeakMap,"%WeakRef%":typeof WeakRef>"u"?De:WeakRef,"%WeakSet%":typeof WeakSet>"u"?De:WeakSet,"%Function.prototype.call%":Fl,"%Function.prototype.apply%":yS,"%Object.defineProperty%":MP,"%Object.getPrototypeOf%":BP,"%Math.abs%":CP,"%Math.floor%":AP,"%Math.max%":kP,"%Math.min%":IP,"%Math.pow%":RP,"%Math.round%":PP,"%Math.sign%":jP,"%Reflect.getPrototypeOf%":DP};if(kt)try{null.error}catch(t){var FP=kt(kt(t));ds["%Error.prototype%"]=FP}var OP=function t(e){var r;if(e==="%AsyncFunction%")r=Zh("async function () {}");else if(e==="%GeneratorFunction%")r=Zh("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Zh("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&kt&&(r=kt(i.prototype))}return ds[e]=r,r},rv={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ol=Uu,Jd=vP(),UP=Ol.call(Fl,Array.prototype.concat),zP=Ol.call(yS,Array.prototype.splice),nv=Ol.call(Fl,String.prototype.replace),Qd=Ol.call(Fl,String.prototype.slice),$P=Ol.call(Fl,RegExp.prototype.exec),GP=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,HP=/\\(\\)?/g,WP=function(e){var r=Qd(e,0,1),n=Qd(e,-1);if(r==="%"&&n!=="%")throw new Lo("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Lo("invalid intrinsic syntax, expected opening `%`");var i=[];return nv(e,GP,function(s,o,l,c){i[i.length]=l?nv(c,HP,"$1"):o||s}),i},VP=function(e,r){var n=e,i;if(Jd(rv,n)&&(i=rv[n],n="%"+i[0]+"%"),Jd(ds,n)){var s=ds[n];if(s===Ws&&(s=OP(n)),typeof s>"u"&&!r)throw new bo("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Lo("intrinsic "+e+" does not exist!")},rx=function(e,r){if(typeof e!="string"||e.length===0)throw new bo("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new bo('"allowMissing" argument must be a boolean');if($P(/^%?[^%]*%?$/,e)===null)throw new Lo("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=WP(e),i=n.length>0?n[0]:"",s=VP("%"+i+"%",r),o=s.name,l=s.value,c=!1,d=s.alias;d&&(i=d[0],zP(n,UP([0,1],d)));for(var u=1,h=!0;u<n.length;u+=1){var p=n[u],f=Qd(p,0,1),m=Qd(p,-1);if((f==='"'||f==="'"||f==="`"||m==='"'||m==="'"||m==="`")&&f!==m)throw new Lo("property names with quotes must have matching quotes");if((p==="constructor"||!h)&&(c=!0),i+="."+p,o="%"+i+"%",Jd(ds,o))l=ds[o];else if(l!=null){if(!(p in l)){if(!r)throw new bo("base intrinsic for "+e+" exists, but the property is not available.");return}if(Tl&&u+1>=n.length){var _=Tl(l,p);h=!!_,h&&"get"in _&&!("originalValue"in _.get)?l=_.get:l=l[p]}else h=Jd(l,p),l=l[p];h&&!c&&(ds[o]=l)}}return l},vS=rx,_S=gS,XP=_S([vS("%String.prototype.indexOf%")]),bS=function(e,r){var n=vS(e,!!r);return typeof n=="function"&&XP(e,".prototype.")>-1?_S([n]):n},YP=rx,Ul=bS,KP=Fu,qP=qo,iv=YP("%Map%",!0),ZP=Ul("Map.prototype.get",!0),JP=Ul("Map.prototype.set",!0),QP=Ul("Map.prototype.has",!0),ej=Ul("Map.prototype.delete",!0),tj=Ul("Map.prototype.size",!0),wS=!!iv&&function(){var e,r={assert:function(n){if(!r.has(n))throw new qP("Side channel does not contain "+KP(n))},delete:function(n){if(e){var i=ej(e,n);return tj(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return ZP(e,n)},has:function(n){return e?QP(e,n):!1},set:function(n,i){e||(e=new iv),JP(e,n,i)}};return r},rj=rx,zu=bS,nj=Fu,wc=wS,ij=qo,Os=rj("%WeakMap%",!0),sj=zu("WeakMap.prototype.get",!0),oj=zu("WeakMap.prototype.set",!0),aj=zu("WeakMap.prototype.has",!0),lj=zu("WeakMap.prototype.delete",!0),cj=Os?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new ij("Side channel does not contain "+nj(i))},delete:function(i){if(Os&&i&&(typeof i=="object"||typeof i=="function")){if(e)return lj(e,i)}else if(wc&&r)return r.delete(i);return!1},get:function(i){return Os&&i&&(typeof i=="object"||typeof i=="function")&&e?sj(e,i):r&&r.get(i)},has:function(i){return Os&&i&&(typeof i=="object"||typeof i=="function")&&e?aj(e,i):!!r&&r.has(i)},set:function(i,s){Os&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new Os),oj(e,i,s)):wc&&(r||(r=wc()),r.set(i,s))}};return n}:wc,dj=qo,uj=Fu,hj=MR,pj=wS,fj=cj,mj=fj||pj||hj,SS=function(){var e,r={assert:function(n){if(!r.has(n))throw new dj("Side channel does not contain "+uj(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=mj()),e.set(n,i)}};return r},gj=String.prototype.replace,xj=/%20/g,Qh={RFC1738:"RFC1738",RFC3986:"RFC3986"},nx={default:Qh.RFC3986,formatters:{RFC1738:function(t){return gj.call(t,xj,"+")},RFC3986:function(t){return String(t)}},RFC1738:Qh.RFC1738,RFC3986:Qh.RFC3986},yj=nx,vj=SS,ep=Object.prototype.hasOwnProperty,rs=Array.isArray,$u=vj(),ES=function(e,r){return $u.set(e,r),e},eu=function(e){return $u.has(e)},Kf=function(e){return $u.get(e)},TS=function(e,r){$u.set(e,r)},sn=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),_j=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(rs(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]<"u"&&i.push(n[s]);r.obj[r.prop]=i}}},ix=function(e,r){for(var n=r&&r.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},bj=function t(e,r,n){if(!r)return e;if(typeof r!="object"&&typeof r!="function"){if(rs(e))e.push(r);else if(e&&typeof e=="object")if(eu(e)){var i=Kf(e)+1;e[i]=r,TS(e,i)}else(n&&(n.plainObjects||n.allowPrototypes)||!ep.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object"){if(eu(r)){for(var s=Object.keys(r),o=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},l=0;l<s.length;l++){var c=parseInt(s[l],10);o[c+1]=r[s[l]]}return ES(o,Kf(r)+1)}return[e].concat(r)}var d=e;return rs(e)&&!rs(r)&&(d=ix(e,n)),rs(e)&&rs(r)?(r.forEach(function(u,h){if(ep.call(e,h)){var p=e[h];p&&typeof p=="object"&&u&&typeof u=="object"?e[h]=t(p,u,n):e.push(u)}else e[h]=u}),e):Object.keys(r).reduce(function(u,h){var p=r[h];return ep.call(u,h)?u[h]=t(u[h],p,n):u[h]=p,u},d)},wj=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},Sj=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},tp=1024,Ej=function(e,r,n,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var l="",c=0;c<o.length;c+=tp){for(var d=o.length>=tp?o.slice(c,c+tp):o,u=[],h=0;h<d.length;++h){var p=d.charCodeAt(h);if(p===45||p===46||p===95||p===126||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||s===yj.RFC1738&&(p===40||p===41)){u[u.length]=d.charAt(h);continue}if(p<128){u[u.length]=sn[p];continue}if(p<2048){u[u.length]=sn[192|p>>6]+sn[128|p&63];continue}if(p<55296||p>=57344){u[u.length]=sn[224|p>>12]+sn[128|p>>6&63]+sn[128|p&63];continue}h+=1,p=65536+((p&1023)<<10|d.charCodeAt(h)&1023),u[u.length]=sn[240|p>>18]+sn[128|p>>12&63]+sn[128|p>>6&63]+sn[128|p&63]}l+=u.join("")}return l},Tj=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],l=Object.keys(o),c=0;c<l.length;++c){var d=l[c],u=o[d];typeof u=="object"&&u!==null&&n.indexOf(u)===-1&&(r.push({obj:o,prop:d}),n.push(u))}return _j(r),e},Cj=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Aj=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},kj=function(e,r,n,i){if(eu(e)){var s=Kf(e)+1;return e[s]=r,TS(e,s),e}var o=[].concat(e,r);return o.length>n?ES(ix(o,{plainObjects:i}),o.length-1):o},Ij=function(e,r){if(rs(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},CS={arrayToObject:ix,assign:wj,combine:kj,compact:Tj,decode:Sj,encode:Ej,isBuffer:Aj,isOverflow:eu,isRegExp:Cj,maybeMap:Ij,merge:bj},AS=SS,cd=CS,tl=nx,Rj=Object.prototype.hasOwnProperty,kS={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},hn=Array.isArray,Pj=Array.prototype.push,IS=function(t,e){Pj.apply(t,hn(e)?e:[e])},jj=Date.prototype.toISOString,sv=tl.default,St={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:cd.encode,encodeValuesOnly:!1,filter:void 0,format:sv,formatter:tl.formatters[sv],indices:!1,serializeDate:function(e){return jj.call(e)},skipNulls:!1,strictNullHandling:!1},Mj=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},rp={},Nj=function t(e,r,n,i,s,o,l,c,d,u,h,p,f,m,_,y,x,v){for(var g=e,b=v,S=0,j=!1;(b=b.get(rp))!==void 0&&!j;){var E=b.get(e);if(S+=1,typeof E<"u"){if(E===S)throw new RangeError("Cyclic object value");j=!0}typeof b.get(rp)>"u"&&(S=0)}if(typeof u=="function"?g=u(r,g):g instanceof Date?g=f(g):n==="comma"&&hn(g)&&(g=cd.maybeMap(g,function(D){return D instanceof Date?f(D):D})),g===null){if(o)return d&&!y?d(r,St.encoder,x,"key",m):r;g=""}if(Mj(g)||cd.isBuffer(g)){if(d){var T=y?r:d(r,St.encoder,x,"key",m);return[_(T)+"="+_(d(g,St.encoder,x,"value",m))]}return[_(r)+"="+_(String(g))]}var B=[];if(typeof g>"u")return B;var M;if(n==="comma"&&hn(g))y&&d&&(g=cd.maybeMap(g,d)),M=[{value:g.length>0?g.join(",")||null:void 0}];else if(hn(u))M=u;else{var F=Object.keys(g);M=h?F.sort(h):F}var U=c?String(r).replace(/\./g,"%2E"):String(r),k=i&&hn(g)&&g.length===1?U+"[]":U;if(s&&hn(g)&&g.length===0)return k+"[]";for(var R=0;R<M.length;++R){var z=M[R],N=typeof z=="object"&&z&&typeof z.value<"u"?z.value:g[z];if(!(l&&N===null)){var P=p&&c?String(z).replace(/\./g,"%2E"):String(z),L=hn(g)?typeof n=="function"?n(k,P):k:k+(p?"."+P:"["+P+"]");v.set(e,S);var I=AS();I.set(rp,v),IS(B,t(N,L,n,i,s,o,l,c,n==="comma"&&y&&hn(g)?null:d,u,h,p,f,m,_,y,x,I))}}return B},Bj=function(e){if(!e)return St;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||St.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=tl.default;if(typeof e.format<"u"){if(!Rj.call(tl.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=tl.formatters[n],s=St.filter;(typeof e.filter=="function"||hn(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in kS?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=St.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var l=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:St.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:St.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:St.allowEmptyArrays,arrayFormat:o,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:St.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?St.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:St.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:St.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:St.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:St.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:St.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:St.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:St.strictNullHandling}},Dj=function(t,e){var r=t,n=Bj(e),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):hn(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var l=kS[n.arrayFormat],c=l==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var d=AS(),u=0;u<i.length;++u){var h=i[u],p=r[h];n.skipNulls&&p===null||IS(o,Nj(p,h,l,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,d))}var f=o.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),f.length>0?m+f:""},Ri=CS,dd=Object.prototype.hasOwnProperty,ov=Array.isArray,ut={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Ri.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},Lj=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},RS=function(t,e,r){if(t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&r>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return t},Fj="utf8=%26%2310003%3B",Oj="utf8=%E2%9C%93",Uj=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,r.throwOnLimitExceeded?s+1:s);if(r.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var l=-1,c,d=r.charset;if(r.charsetSentinel)for(c=0;c<o.length;++c)o[c].indexOf("utf8=")===0&&(o[c]===Oj?d="utf-8":o[c]===Fj&&(d="iso-8859-1"),l=c,c=o.length);for(c=0;c<o.length;++c)if(c!==l){var u=o[c],h=u.indexOf("]="),p=h===-1?u.indexOf("="):h+1,f,m;if(p===-1?(f=r.decoder(u,ut.decoder,d,"key"),m=r.strictNullHandling?null:""):(f=r.decoder(u.slice(0,p),ut.decoder,d,"key"),f!==null&&(m=Ri.maybeMap(RS(u.slice(p+1),r,ov(n[f])?n[f].length:0),function(y){return r.decoder(y,ut.decoder,d,"value")}))),m&&r.interpretNumericEntities&&d==="iso-8859-1"&&(m=Lj(String(m))),u.indexOf("[]=")>-1&&(m=ov(m)?[m]:m),f!==null){var _=dd.call(n,f);_&&r.duplicates==="combine"?n[f]=Ri.combine(n[f],m,r.arrayLimit,r.plainObjects):(!_||r.duplicates==="last")&&(n[f]=m)}}return n},zj=function(t,e,r,n){var i=0;if(t.length>0&&t[t.length-1]==="[]"){var s=t.slice(0,-1).join("");i=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=n?e:RS(e,r,i),l=t.length-1;l>=0;--l){var c,d=t[l];if(d==="[]"&&r.parseArrays)Ri.isOverflow(o)?c=o:c=r.allowEmptyArrays&&(o===""||r.strictNullHandling&&o===null)?[]:Ri.combine([],o,r.arrayLimit,r.plainObjects);else{c=r.plainObjects?{__proto__:null}:{};var u=d.charAt(0)==="["&&d.charAt(d.length-1)==="]"?d.slice(1,-1):d,h=r.decodeDotInKeys?u.replace(/%2E/g,"."):u,p=parseInt(h,10);!r.parseArrays&&h===""?c={0:o}:!isNaN(p)&&d!==h&&String(p)===h&&p>=0&&r.parseArrays&&p<=r.arrayLimit?(c=[],c[p]=o):h!=="__proto__"&&(c[h]=o)}o=c}return o},$j=function(e,r){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e;if(r.depth<=0)return!r.plainObjects&&dd.call(Object.prototype,n)&&!r.allowPrototypes?void 0:[n];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(n),l=o?n.slice(0,o.index):n,c=[];if(l){if(!r.plainObjects&&dd.call(Object.prototype,l)&&!r.allowPrototypes)return;c.push(l)}for(var d=0;(o=s.exec(n))!==null&&d<r.depth;){d+=1;var u=o[1].slice(1,-1);if(!r.plainObjects&&dd.call(Object.prototype,u)&&!r.allowPrototypes)return;c.push(o[1])}if(o){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");c.push("["+n.slice(o.index)+"]")}return c},Gj=function(e,r,n,i){if(e){var s=$j(e,n);if(s)return zj(s,r,n,i)}},Hj=function(e){if(!e)return ut;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=typeof e.charset>"u"?ut.charset:e.charset,n=typeof e.duplicates>"u"?ut.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:ut.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:ut.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:ut.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:ut.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:ut.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ut.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:ut.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:ut.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:ut.decoder,delimiter:typeof e.delimiter=="string"||Ri.isRegExp(e.delimiter)?e.delimiter:ut.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:ut.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:ut.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:ut.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:ut.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:ut.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ut.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},Wj=function(t,e){var r=Hj(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?{__proto__:null}:{};for(var n=typeof t=="string"?Uj(t,r):t,i=r.plainObjects?{__proto__:null}:{},s=Object.keys(n),o=0;o<s.length;++o){var l=s[o],c=Gj(l,n[l],r,typeof t=="string");i=Ri.merge(i,c,r)}return r.allowSparse===!0?i:Ri.compact(i)},Vj=Dj,Xj=Wj,Yj=nx,Kj={formats:Yj,parse:Xj,stringify:Vj},qj=KI;function Un(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Zj=/^([a-z0-9.+-]+:)/i,Jj=/:[0-9]*$/,Qj=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,eM=["<",">",'"',"`"," ","\r",`
`,"	"],tM=["{","}","|","\\","^","`"].concat(eM),qf=["'"].concat(tM),av=["%","/","?",";","#"].concat(qf),lv=["/","?","#"],rM=255,cv=/^[+a-z0-9A-Z_-]{0,63}$/,nM=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,iM={javascript:!0,"javascript:":!0},Zf={javascript:!0,"javascript:":!0},wo={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Jf=Kj;function sM(t,e,r){if(t&&typeof t=="object"&&t instanceof Un)return t;var n=new Un;return n.parse(t,e,r),n}Un.prototype.parse=function(t,e,r){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var l=t;if(l=l.trim(),!r&&t.split("#").length===1){var c=Qj.exec(l);if(c)return this.path=l,this.href=l,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=Jf.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var d=Zj.exec(l);if(d){d=d[0];var u=d.toLowerCase();this.protocol=u,l=l.substr(d.length)}if(r||d||l.match(/^\/\/[^@/]+@[^@/]+/)){var h=l.substr(0,2)==="//";h&&!(d&&Zf[d])&&(l=l.substr(2),this.slashes=!0)}if(!Zf[d]&&(h||d&&!wo[d])){for(var p=-1,f=0;f<lv.length;f++){var m=l.indexOf(lv[f]);m!==-1&&(p===-1||m<p)&&(p=m)}var _,y;p===-1?y=l.lastIndexOf("@"):y=l.lastIndexOf("@",p),y!==-1&&(_=l.slice(0,y),l=l.slice(y+1),this.auth=decodeURIComponent(_)),p=-1;for(var f=0;f<av.length;f++){var m=l.indexOf(av[f]);m!==-1&&(p===-1||m<p)&&(p=m)}p===-1&&(p=l.length),this.host=l.slice(0,p),l=l.slice(p),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var v=this.hostname.split(/\./),f=0,g=v.length;f<g;f++){var b=v[f];if(b&&!b.match(cv)){for(var S="",j=0,E=b.length;j<E;j++)b.charCodeAt(j)>127?S+="x":S+=b[j];if(!S.match(cv)){var T=v.slice(0,f),B=v.slice(f+1),M=b.match(nM);M&&(T.push(M[1]),B.unshift(M[2])),B.length&&(l="/"+B.join(".")+l),this.hostname=T.join(".");break}}}this.hostname.length>rM?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=qj.toASCII(this.hostname));var F=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+F,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!iM[u])for(var f=0,g=qf.length;f<g;f++){var k=qf[f];if(l.indexOf(k)!==-1){var R=encodeURIComponent(k);R===k&&(R=escape(k)),l=l.split(k).join(R)}}var z=l.indexOf("#");z!==-1&&(this.hash=l.substr(z),l=l.slice(0,z));var N=l.indexOf("?");if(N!==-1?(this.search=l.substr(N),this.query=l.substr(N+1),e&&(this.query=Jf.parse(this.query)),l=l.slice(0,N)):e&&(this.search="",this.query={}),l&&(this.pathname=l),wo[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",P=this.search||"";this.path=F+P}return this.href=this.format(),this};Un.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Jf.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||wo[e])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),o=o.replace("#","%23"),e+i+r+o+n};Un.prototype.resolve=function(t){return this.resolveObject(sM(t,!1,!0)).format()};Un.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new Un;e.parse(t,!1,!0),t=e}for(var r=new Un,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),l=0;l<o.length;l++){var c=o[l];c!=="protocol"&&(r[c]=t[c])}return wo[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!wo[t.protocol]){for(var d=Object.keys(t),u=0;u<d.length;u++){var h=d[u];r[h]=t[h]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!Zf[t.protocol]){for(var g=(t.pathname||"").split("/");g.length&&!(t.host=g.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),r.pathname=g.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var p=r.pathname||"",f=r.search||"";r.path=p+f}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&r.pathname.charAt(0)==="/",_=t.host||t.pathname&&t.pathname.charAt(0)==="/",y=_||m||r.host&&t.pathname,x=y,v=r.pathname&&r.pathname.split("/")||[],g=t.pathname&&t.pathname.split("/")||[],b=r.protocol&&!wo[r.protocol];if(b&&(r.hostname="",r.port=null,r.host&&(v[0]===""?v[0]=r.host:v.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(g[0]===""?g[0]=t.host:g.unshift(t.host)),t.host=null),y=y&&(g[0]===""||v[0]==="")),_)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,v=g;else if(g.length)v||(v=[]),v.pop(),v=v.concat(g),r.search=t.search,r.query=t.query;else if(t.search!=null){if(b){r.host=v.shift(),r.hostname=r.host;var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return r.search=t.search,r.query=t.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!v.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var j=v.slice(-1)[0],E=(r.host||t.host||v.length>1)&&(j==="."||j==="..")||j==="",T=0,B=v.length;B>=0;B--)j=v[B],j==="."?v.splice(B,1):j===".."?(v.splice(B,1),T++):T&&(v.splice(B,1),T--);if(!y&&!x)for(;T--;T)v.unshift("..");y&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),E&&v.join("/").substr(-1)!=="/"&&v.push("");var M=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(b){r.hostname=M?"":v.length?v.shift():"",r.host=r.hostname;var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return y=y||r.host&&v.length,y&&!M&&v.unshift(""),v.length>0?r.pathname=v.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};Un.prototype.parseHost=function(){var t=this.host,e=Jj.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const dv={};function Le(t,e,r=3){if(dv[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),dv[e]=!0}function zr(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function wa(t){return t.split("?")[0].split("#")[0]}function oM(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function aM(t,e,r){return t.replace(new RegExp(oM(e),"g"),r)}function lM(t,e){let r="",n=0,i=-1,s=0,o=-1;for(let l=0;l<=t.length;++l){if(l<t.length)o=t.charCodeAt(l);else{if(o===47)break;o=47}if(o===47){if(!(i===l-1||s===1))if(i!==l-1&&s===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const c=r.lastIndexOf("/");if(c!==r.length-1){c===-1?(r="",n=0):(r=r.slice(0,c),n=r.length-1-r.lastIndexOf("/")),i=l,s=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=l,s=0;continue}}}else r.length>0?r+=`/${t.slice(i+1,l)}`:r=t.slice(i+1,l),n=l-i-1;i=l,s=0}else o===46&&s!==-1?++s:s=-1}return r}const jt={toPosix(t){return aM(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){zr(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(zr(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=wa(this.toPosix(e??re.ADAPTER.getBaseUrl())),i=wa(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?jt.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(zr(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=lM(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return zr(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(zr(n),n.length>0)if(e===void 0)e=n;else{const i=t[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(zr(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let l=t.length-1;l>=1;--l)if(e=t.charCodeAt(l),e===47){if(!i){n=l;break}}else i=!1;return n===-1?r?"/":this.isUrl(o)?s+t:s:r&&n===1?"//":s+t.slice(0,n)},rootname(t){zr(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){zr(t),e&&zr(e),t=wa(this.toPosix(t));let r=0,n=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,l=-1;for(s=t.length-1;s>=0;--s){const c=t.charCodeAt(s);if(c===47){if(!i){r=s+1;break}}else l===-1&&(i=!1,l=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=l))}return r===n?n=l:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){r=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){zr(t),t=wa(this.toPosix(t));let e=-1,r=0,n=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const l=t.charCodeAt(o);if(l===47){if(!i){r=o+1;break}continue}n===-1&&(i=!1,n=o+1),l===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){zr(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=wa(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let i;e.root=this.rootname(t),n||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,l=-1,c=!0,d=t.length-1,u=0;for(;d>=i;--d){if(r=t.charCodeAt(d),r===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),r===46?s===-1?s=d:u!==1&&(u=1):s!==-1&&(u=-1)}return s===-1||l===-1||u===0||u===1&&s===l-1&&s===o+1?l!==-1&&(o===0&&n?e.base=e.name=t.slice(1,l):e.base=e.name=t.slice(o,l)):(o===0&&n?(e.name=t.slice(1,s),e.base=t.slice(1,l)):(e.name=t.slice(o,s),e.base=t.slice(o,l)),e.ext=t.slice(s,l)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let np;async function cM(){return np??(np=(async()=>{var s;const t=document.createElement("canvas").getContext("webgl");if(!t)return nr.UNPACK;const e=await new Promise(o=>{const l=document.createElement("video");l.onloadeddata=()=>o(l),l.onerror=()=>o(null),l.autoplay=!1,l.crossOrigin="anonymous",l.preload="auto",l.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",l.load()});if(!e)return nr.UNPACK;const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(s=t.getExtension("WEBGL_lose_context"))==null||s.loseContext(),i[0]<=i[3]?nr.PMA:nr.UNPACK})()),np}let ip;function dM(){return typeof ip>"u"&&(ip=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:re.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!re.ADAPTER.getWebGLRenderingContext())return!1;const r=re.ADAPTER.createCanvas();let n=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,i}catch{return!1}}()),ip}var uM={grad:.9,turn:360,rad:360/(2*Math.PI)},An=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Rt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},Pr=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},PS=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},uv=function(t){return{r:Pr(t.r,0,255),g:Pr(t.g,0,255),b:Pr(t.b,0,255),a:Pr(t.a)}},sp=function(t){return{r:Rt(t.r),g:Rt(t.g),b:Rt(t.b),a:Rt(t.a,3)}},hM=/^#([0-9a-f]{3,8})$/i,Sc=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},jS=function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=Math.max(e,r,n),o=s-Math.min(e,r,n),l=o?s===e?(r-n)/o:s===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(l<0?l+6:l),s:s?o/s*100:0,v:s/255*100,a:i}},MS=function(t){var e=t.h,r=t.s,n=t.v,i=t.a;e=e/360*6,r/=100,n/=100;var s=Math.floor(e),o=n*(1-r),l=n*(1-(e-s)*r),c=n*(1-(1-e+s)*r),d=s%6;return{r:255*[n,l,o,o,c,n][d],g:255*[c,n,n,l,o,o][d],b:255*[o,o,c,n,n,l][d],a:i}},hv=function(t){return{h:PS(t.h),s:Pr(t.s,0,100),l:Pr(t.l,0,100),a:Pr(t.a)}},pv=function(t){return{h:Rt(t.h),s:Rt(t.s),l:Rt(t.l),a:Rt(t.a,3)}},fv=function(t){return MS((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},rl=function(t){return{h:(e=jS(t)).h,s:(i=(200-(r=e.s))*(n=e.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,r,n,i},pM=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,fM=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,mM=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,gM=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Qf={string:[[function(t){var e=hM.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Rt(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Rt(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=mM.exec(t)||gM.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:uv({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=pM.exec(t)||fM.exec(t);if(!e)return null;var r,n,i=hv({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(uM[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return fv(i)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=i===void 0?1:i;return An(e)&&An(r)&&An(n)?uv({r:Number(e),g:Number(r),b:Number(n),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,i=t.a,s=i===void 0?1:i;if(!An(e)||!An(r)||!An(n))return null;var o=hv({h:Number(e),s:Number(r),l:Number(n),a:Number(s)});return fv(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,i=t.a,s=i===void 0?1:i;if(!An(e)||!An(r)||!An(n))return null;var o=function(l){return{h:PS(l.h),s:Pr(l.s,0,100),v:Pr(l.v,0,100),a:Pr(l.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(s)});return MS(o)},"hsv"]]},mv=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},xM=function(t){return typeof t=="string"?mv(t.trim(),Qf.string):typeof t=="object"&&t!==null?mv(t,Qf.object):[null,void 0]},op=function(t,e){var r=rl(t);return{h:r.h,s:Pr(r.s+100*e,0,100),l:r.l,a:r.a}},ap=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},gv=function(t,e){var r=rl(t);return{h:r.h,s:r.s,l:Pr(r.l+100*e,0,100),a:r.a}},em=function(){function t(e){this.parsed=xM(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Rt(ap(this.rgba),2)},t.prototype.isDark=function(){return ap(this.rgba)<.5},t.prototype.isLight=function(){return ap(this.rgba)>=.5},t.prototype.toHex=function(){return e=sp(this.rgba),r=e.r,n=e.g,i=e.b,o=(s=e.a)<1?Sc(Rt(255*s)):"","#"+Sc(r)+Sc(n)+Sc(i)+o;var e,r,n,i,s,o},t.prototype.toRgb=function(){return sp(this.rgba)},t.prototype.toRgbString=function(){return e=sp(this.rgba),r=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+r+", "+n+", "+i+", "+s+")":"rgb("+r+", "+n+", "+i+")";var e,r,n,i,s},t.prototype.toHsl=function(){return pv(rl(this.rgba))},t.prototype.toHslString=function(){return e=pv(rl(this.rgba)),r=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+r+", "+n+"%, "+i+"%, "+s+")":"hsl("+r+", "+n+"%, "+i+"%)";var e,r,n,i,s},t.prototype.toHsv=function(){return e=jS(this.rgba),{h:Rt(e.h),s:Rt(e.s),v:Rt(e.v),a:Rt(e.a,3)};var e},t.prototype.invert=function(){return on({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),on(op(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),on(op(this.rgba,-e))},t.prototype.grayscale=function(){return on(op(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),on(gv(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),on(gv(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?on({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):Rt(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=rl(this.rgba);return typeof e=="number"?on({h:e,s:r.s,l:r.l,a:r.a}):Rt(r.h)},t.prototype.isEqual=function(e){return this.toHex()===on(e).toHex()},t}(),on=function(t){return t instanceof em?t:new em(t)},xv=[],yM=function(t){t.forEach(function(e){xv.indexOf(e)<0&&(e(em,Qf),xv.push(e))})};function vM(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,c,d=n[this.toHex()];if(d)return d;if(o!=null&&o.closest){var u=this.toRgb(),h=1/0,p="black";if(!s.length)for(var f in r)s[f]=new t(r[f]).toRgb();for(var m in r){var _=(l=u,c=s[m],Math.pow(l.r-c.r,2)+Math.pow(l.g-c.g,2)+Math.pow(l.b-c.b,2));_<h&&(h=_,p=m)}return p}},e.string.push([function(o){var l=o.toLowerCase(),c=l==="transparent"?"#0000":r[l];return c?new t(c).toRgb():null},"name"])}yM([vM]);const Vs=class ud{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof ud)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,s)=>i===r[s]);if(e!==null&&r!==null){const i=Object.keys(e),s=Object.keys(r);return i.length!==s.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,n,i]=this._components;return{r:e,g:r,b:n,a:i}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,i]=this._components;return e=e??[],e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[r,n,i]=this._components;return e[0]=r,e[1]=n,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,i,s]=ud.temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return r&&(n=n*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[r,n,i]=this._components;return this._components[0]=Math.round(r*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[r,n,i,s]=this._components;return e[0]=r,e[1]=n,e[2]=i,e[3]=s,e}normalize(e){let r,n,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,i,s=255]=e,r/=255,n/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const l=ud.HEX_PATTERN.exec(e);l&&(e=`#${l[2]}`)}const o=on(e);o.isValid()&&({r,g:n,b:i,a:s}=o.rgba,r/=255,n/=255,i/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,r),n)}),e)}};Vs.shared=new Vs,Vs.temp=new Vs,Vs.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let qe=Vs;function _M(t){return Le("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),qe.shared.setValue(t).toHex()}function bM(t){return Le("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),qe.shared.setValue(t).toNumber()}function wM(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[be.NORMAL_NPM]=be.NORMAL,t[be.ADD_NPM]=be.ADD,t[be.SCREEN_NPM]=be.SCREEN,e[be.NORMAL]=be.NORMAL_NPM,e[be.ADD]=be.ADD_NPM,e[be.SCREEN]=be.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}const NS=wM();function BS(t,e){return NS[e?1:0][t]}function SM(t,e=null){const r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let n=0,i=0;n<r;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function DS(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function tu(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function yv(t){return!(t&t-1)&&!!t}function vv(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function So(t,e,r){const n=t.length;let i;if(e>=n||r===0)return;r=e+r>n?n-e:r;const s=n-r;for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}function gi(t){return t===0?0:t<0?-1:1}let EM=0;function _s(){return++EM}const tm=class{constructor(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};tm.EMPTY=new tm(0,0,0,0);let _v=tm;const bv={},an=Object.create(null),Qn=Object.create(null);class TM{constructor(e,r,n){this._canvas=re.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||re.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function wv(t,e,r){for(let n=0,i=4*r*e;n<e;++n,i+=4)if(t[i+3]!==0)return!1;return!0}function Sv(t,e,r,n,i){const s=4*e;for(let o=n,l=n*s+4*r;o<=i;++o,l+=s)if(t[l+3]!==0)return!1;return!0}function CM(t){const{width:e,height:r}=t,n=t.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,e,r).data;let s=0,o=0,l=e-1,c=r-1;for(;o<r&&wv(i,e,o);)++o;if(o===r)return _v.EMPTY;for(;wv(i,e,c);)--c;for(;Sv(i,e,s,o,c);)++s;for(;Sv(i,e,l,o,c);)--l;return++l,++c,new _v(s,o,l,c)}function AM(t){const e=CM(t),{width:r,height:n}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,r,n)}return{width:r,height:n,data:i}}function kM(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}function Xn(t,e=1){var n;const r=(n=re.RETINA_PREFIX)==null?void 0:n.exec(t);return r?parseFloat(r[1]):e}var Q=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(Q||{});const rm=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Ev=(t,e)=>rm(t).priority??e,ue={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(rm).forEach(e=>{e.type.forEach(r=>{var n,i;return(i=(n=this._removeHandlers)[r])==null?void 0:i.call(n,e)})}),this},add(...t){return t.map(rm).forEach(e=>{e.type.forEach(r=>{var s,o;const n=this._addHandlers,i=this._queue;n[r]?(s=n[r])==null||s.call(n,e):(i[r]=i[r]||[],(o=i[r])==null||o.push(e))})}),this},handle(t,e,r){var o;const n=this._addHandlers,i=this._removeHandlers;if(n[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,i[t]=r;const s=this._queue;return s[t]&&((o=s[t])==null||o.forEach(l=>e(l)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,s)=>Ev(s,r)-Ev(i,r)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}};class nm{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const IM=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function RM(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function PM(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=IM.replace(/%forloop%/gi,RM(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}const lp=0,cp=1,dp=2,up=3,hp=4,pp=5;class En{constructor(){this.data=0,this.blendMode=be.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<lp)}set blend(e){!!(this.data&1<<lp)!==e&&(this.data^=1<<lp)}get offsets(){return!!(this.data&1<<cp)}set offsets(e){!!(this.data&1<<cp)!==e&&(this.data^=1<<cp)}get culling(){return!!(this.data&1<<dp)}set culling(e){!!(this.data&1<<dp)!==e&&(this.data^=1<<dp)}get depthTest(){return!!(this.data&1<<up)}set depthTest(e){!!(this.data&1<<up)!==e&&(this.data^=1<<up)}get depthMask(){return!!(this.data&1<<pp)}set depthMask(e){!!(this.data&1<<pp)!==e&&(this.data^=1<<pp)}get clockwiseFrontFace(){return!!(this.data&1<<hp)}set clockwiseFrontFace(e){!!(this.data&1<<hp)!==e&&(this.data^=1<<hp)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==be.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new En;return e.depthTest=!1,e.blend=!0,e}}En.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const im=[];function LS(t,e){if(!t)return null;let r="";if(typeof t=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(let n=im.length-1;n>=0;--n){const i=im[n];if(i.test&&i.test(t,r))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class Zr{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,n,i,s,o,l,c){if(arguments.length>8)throw new Error("max arguments reached");const{name:d,items:u}=this;this._aliasCount++;for(let h=0,p=u.length;h<p;h++)u[h][d](e,r,n,i,s,o,l,c);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Zr.prototype,{dispatch:{value:Zr.prototype.emit},run:{value:Zr.prototype.emit}});class Cl{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new Zr("setRealSize"),this.onUpdate=new Zr("update"),this.onError=new Zr("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}}class Gu extends Cl{constructor(e,r){const{width:n,height:i}=r||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=e,this.unpackAlignment=r.unpackAlignment??4}upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===nr.UNPACK);const s=r.realWidth,o=r.realHeight;return n.width===s&&n.height===o?i.texSubImage2D(r.target,0,0,0,s,o,r.format,n.type,this.data):(n.width=s,n.height=o,i.texImage2D(r.target,0,n.internalFormat,s,o,0,r.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const jM={scaleMode:Bn.NEAREST,alphaMode:nr.NPM},sm=class Xs extends Ll{constructor(e=null,r=null){super(),r=Object.assign({},Xs.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:s,scaleMode:o,width:l,height:c,wrapMode:d,format:u,type:h,target:p,resolution:f,resourceOptions:m}=r;e&&!(e instanceof Cl)&&(e=LS(e,m),e.internal=!0),this.resolution=f||re.RESOLUTION,this.width=Math.round((l||0)*this.resolution)/this.resolution,this.height=Math.round((c||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=d,this._scaleMode=o,this.format=u,this.type=h,this.target=p,this.alphaMode=n,this.uid=_s(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=l>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,r){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,n=!0),n&&this.dirtyStyleId++,this}setSize(e,r,n){return n=n||this.resolution,this.setRealSize(e*n,r*n,n)}setRealSize(e,r,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(r)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=yv(this.realWidth)&&yv(this.realHeight)}setResolution(e){const r=this.resolution;return r===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*r)/e,this.height=Math.round(this.height*r)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Qn[this.cacheId],delete an[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Xs.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,r,n=re.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else{if(!e._pixiId){const l=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${l}_${_s()}`}s=e._pixiId}let o=Qn[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new Xs(e,r),o.cacheId=s,Xs.addToCache(o,s)),o}static fromBuffer(e,r,n,i){e=e||new Float32Array(r*n*4);const s=new Gu(e,{width:r,height:n,...i==null?void 0:i.resourceOptions});let o,l;return e instanceof Float32Array?(o=K.RGBA,l=me.FLOAT):e instanceof Int32Array?(o=K.RGBA_INTEGER,l=me.INT):e instanceof Uint32Array?(o=K.RGBA_INTEGER,l=me.UNSIGNED_INT):e instanceof Int16Array?(o=K.RGBA_INTEGER,l=me.SHORT):e instanceof Uint16Array?(o=K.RGBA_INTEGER,l=me.UNSIGNED_SHORT):e instanceof Int8Array?(o=K.RGBA,l=me.BYTE):(o=K.RGBA,l=me.UNSIGNED_BYTE),s.internal=!0,new Xs(s,Object.assign({},jM,{type:l,format:o},i))}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),Qn[r]&&Qn[r]!==e&&console.warn(`BaseTexture added to the cache with an id [${r}] that already had an entry`),Qn[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=Qn[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete Qn[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)delete Qn[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}};sm.defaultOptions={mipmap:bn.POW2,anisotropicLevel:0,scaleMode:Bn.LINEAR,wrapMode:Ai.CLAMP,alphaMode:nr.UNPACK,target:_o.TEXTURE_2D,format:K.RGBA,type:me.UNSIGNED_BYTE},sm._globalBatch=0;let Ee=sm;class om{constructor(){this.texArray=null,this.blend=0,this.type=gn.TRIANGLES,this.start=0,this.size=0,this.data=null}}let MM=0;class ft{constructor(e,r=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=r,this.id=MM++,this.disposeRunner=new Zr("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?vn.ELEMENT_ARRAY_BUFFER:vn.ARRAY_BUFFER}get index(){return this.type===vn.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new ft(e)}}class ru{constructor(e,r=0,n=!1,i=me.FLOAT,s,o,l,c=1){this.buffer=e,this.size=r,this.normalized=n,this.type=i,this.stride=s,this.start=o,this.instance=l,this.divisor=c}destroy(){this.buffer=null}static from(e,r,n,i,s){return new ru(e,r,n,i,s)}}const NM={Float32Array,Uint32Array,Int32Array,Uint8Array};function BM(t,e){let r=0,n=0;const i={};for(let c=0;c<t.length;c++)n+=e[c],r+=t[c].length;const s=new ArrayBuffer(r*4);let o=null,l=0;for(let c=0;c<t.length;c++){const d=e[c],u=t[c],h=DS(u);i[h]||(i[h]=new NM[h](s)),o=i[h];for(let p=0;p<u.length;p++){const f=(p/d|0)*n+l,m=p%d;o[f+m]=u[p]}l+=d}return new Float32Array(s)}const Tv={5126:4,5123:2,5121:1};let DM=0;const LM={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Pi{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=DM++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Zr("disposeGeometry"),this.refCount=0}addAttribute(e,r,n=0,i=!1,s,o,l,c=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof ft||(r instanceof Array&&(r=new Float32Array(r)),r=new ft(r));const d=e.split("|");if(d.length>1){for(let h=0;h<d.length;h++)this.addAttribute(d[h],r,n,i,s);return this}let u=this.buffers.indexOf(r);return u===-1&&(this.buffers.push(r),u=this.buffers.length-1),this.attributes[e]=new ru(u,n,i,s,o,l,c),this.instanced=this.instanced||c,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof ft||(e instanceof Array&&(e=new Uint16Array(e)),e=new ft(e)),e.type=vn.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],r=[],n=new ft;let i;for(i in this.attributes){const s=this.attributes[i],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*Tv[s.type]/4),s.buffer=0}for(n.data=BM(e,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Pi;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new ft(this.buffers[r].data.slice(0));for(const r in this.attributes){const n=this.attributes[r];e.attributes[r]=new ru(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=vn.ELEMENT_ARRAY_BUFFER),e}static merge(e){const r=new Pi,n=[],i=[],s=[];let o;for(let l=0;l<e.length;l++){o=e[l];for(let c=0;c<o.buffers.length;c++)i[c]=i[c]||0,i[c]+=o.buffers[c].data.length,s[c]=0}for(let l=0;l<o.buffers.length;l++)n[l]=new LM[DS(o.buffers[l].data)](i[l]),r.buffers[l]=new ft(n[l]);for(let l=0;l<e.length;l++){o=e[l];for(let c=0;c<o.buffers.length;c++)n[c].set(o.buffers[c].data,s[c]),s[c]+=o.buffers[c].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=vn.ELEMENT_ARRAY_BUFFER;let l=0,c=0,d=0,u=0;for(let h=0;h<o.buffers.length;h++)if(o.buffers[h]!==o.indexBuffer){u=h;break}for(const h in o.attributes){const p=o.attributes[h];(p.buffer|0)===u&&(c+=p.size*Tv[p.type]/4)}for(let h=0;h<e.length;h++){const p=e[h].indexBuffer.data;for(let f=0;f<p.length;f++)r.indexBuffer.data[f+d]+=l;l+=e[h].buffers[u].data.length/c,d+=p.length}}return r}}class FS extends Pi{constructor(e=!1){super(),this._buffer=new ft(null,e,!1),this._indexBuffer=new ft(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,me.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,me.FLOAT).addAttribute("aColor",this._buffer,4,!0,me.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,me.FLOAT).addIndex(this._indexBuffer)}}const nu=Math.PI*2,FM=180/Math.PI,OM=Math.PI/180;var Lt=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(Lt||{});class Ue{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new Ue(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}}Ue.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Ec=[new Ue,new Ue,new Ue,new Ue];class Ae{constructor(e=0,r=0,n=0,i=0){this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(i),this.type=Lt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Ae(0,0,0,0)}clone(){return new Ae(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){const T=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=T)return!1;const B=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>B}const n=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=n||o<=s)return!1;const l=Ec[0].set(e.left,e.top),c=Ec[1].set(e.left,e.bottom),d=Ec[2].set(e.right,e.top),u=Ec[3].set(e.right,e.bottom);if(d.x<=l.x||c.y<=l.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(l,l),r.apply(c,c),r.apply(d,d),r.apply(u,u),Math.max(l.x,c.x,d.x,u.x)<=n||Math.min(l.x,c.x,d.x,u.x)>=i||Math.max(l.y,c.y,d.y,u.y)<=s||Math.min(l.y,c.y,d.y,u.y)>=o))return!1;const p=h*(c.y-l.y),f=h*(l.x-c.x),m=p*n+f*s,_=p*i+f*s,y=p*n+f*o,x=p*i+f*o;if(Math.max(m,_,y,x)<=p*l.x+f*l.y||Math.min(m,_,y,x)>=p*u.x+f*u.y)return!1;const v=h*(l.y-d.y),g=h*(d.x-l.x),b=v*n+g*s,S=v*i+g*s,j=v*n+g*o,E=v*i+g*o;return!(Math.max(b,S,j,E)<=v*l.x+g*l.y||Math.min(b,S,j,E)>=v*u.x+g*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,i=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=i,this.height=s-i,this}}Ae.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Hu{constructor(e=0,r=0,n=0){this.x=e,this.y=r,this.radius=n,this.type=Lt.CIRC}clone(){return new Hu(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,s=this.y-r;return i*=i,s*=s,i+s<=n}getBounds(){return new Ae(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Hu.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Wu{constructor(e=0,r=0,n=0,i=0){this.x=e,this.y=r,this.width=n,this.height=i,this.type=Lt.ELIP}clone(){return new Wu(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,i=(r-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new Ae(this.x-this.width,this.y-this.height,this.width,this.height)}}Wu.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class us{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let i=0,s=r.length;i<s;i++)n.push(r[i].x,r[i].y);r=n}this.points=r,this.type=Lt.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),r=new us(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let n=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const l=this.points[s*2],c=this.points[s*2+1],d=this.points[o*2],u=this.points[o*2+1];c>r!=u>r&&e<(d-l)*((r-c)/(u-c))+l&&(n=!n)}return n}}us.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class Vu{constructor(e=0,r=0,n=0,i=0,s=20){this.x=e,this.y=r,this.width=n,this.height=i,this.radius=s,this.type=Lt.RREC}clone(){return new Vu(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),s=r-(this.y+n);const o=n*n;if(i*i+s*s<=o||(i=e-(this.x+this.width-n),i*i+s*s<=o)||(s=r-(this.y+this.height-n),i*i+s*s<=o)||(i=e-(this.x+n),i*i+s*s<=o))return!0}return!1}}Vu.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Qe{constructor(e=1,r=0,n=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,i,s,o){return this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new Ue;const n=e.x,i=e.y;return r.x=this.a*n+this.c*i+this.tx,r.y=this.b*n+this.d*i+this.ty,r}applyInverse(e,r){r=r||new Ue;const n=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return r.x=this.d*n*i+-this.c*n*s+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*s+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*r-this.b*n,this.b=i*n+this.b*r,this.c=s*r-this.d*n,this.d=s*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,i=this.c,s=this.d;return this.a=e.a*r+e.b*i,this.b=e.a*n+e.b*s,this.c=e.c*r+e.d*i,this.d=e.c*n+e.d*s,this.tx=e.tx*r+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}setTransform(e,r,n,i,s,o,l,c,d){return this.a=Math.cos(l+d)*s,this.b=Math.sin(l+d)*s,this.c=-Math.sin(l-c)*o,this.d=Math.cos(l-c)*o,this.tx=e-(n*this.a+i*this.c),this.ty=r-(n*this.b+i*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,i=this.c,s=this.d,o=e.pivot,l=-Math.atan2(-i,s),c=Math.atan2(n,r),d=Math.abs(l+c);return d<1e-5||Math.abs(nu-d)<1e-5?(e.rotation=c,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=l,e.skew.y=c),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*r+o.y*i),e.position.y=this.ty+(o.x*n+o.y*s),e}invert(){const e=this.a,r=this.b,n=this.c,i=this.d,s=this.tx,o=e*i-r*n;return this.a=i/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-i*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Qe;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Qe}static get TEMP_MATRIX(){return new Qe}}Qe.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const qi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Zi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ji=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Qi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],am=[],OS=[],Tc=Math.sign;function UM(){for(let t=0;t<16;t++){const e=[];am.push(e);for(let r=0;r<16;r++){const n=Tc(qi[t]*qi[r]+Ji[t]*Zi[r]),i=Tc(Zi[t]*qi[r]+Qi[t]*Zi[r]),s=Tc(qi[t]*Ji[r]+Ji[t]*Qi[r]),o=Tc(Zi[t]*Ji[r]+Qi[t]*Qi[r]);for(let l=0;l<16;l++)if(qi[l]===n&&Zi[l]===i&&Ji[l]===s&&Qi[l]===o){e.push(l);break}}}for(let t=0;t<16;t++){const e=new Qe;e.set(qi[t],Zi[t],Ji[t],Qi[t],0,0),OS.push(e)}}UM();const nt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>qi[t],uY:t=>Zi[t],vX:t=>Ji[t],vY:t=>Qi[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>am[t][e],sub:(t,e)=>am[t][nt.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?nt.S:nt.N:Math.abs(e)*2<=Math.abs(t)?t>0?nt.E:nt.W:e>0?t>0?nt.SE:nt.SW:t>0?nt.NE:nt.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const i=OS[nt.inv(e)];i.tx=r,i.ty=n,t.append(i)}};class Ln{constructor(e,r,n=0,i=0){this._x=n,this._y=i,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new Ln(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Ln.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const lm=class{constructor(){this.worldTransform=new Qe,this.localTransform=new Qe,this.position=new Ln(this.onChange,this,0,0),this.scale=new Ln(this.onChange,this,1,1),this.pivot=new Ln(this.onChange,this,0,0),this.skew=new Ln(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};lm.IDENTITY=new lm;let sx=lm;sx.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var zM=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,$M=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Cv(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function fp(t){const e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function US(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return fp(2*e);case"bvec3":return fp(3*e);case"bvec4":return fp(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Eo=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],GM={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},HM={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function WM(t,e){var n;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const s=e[i];if(!s){((n=t.uniforms[i])==null?void 0:n.group)===!0&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let l=!1;for(let c=0;c<Eo.length;c++)if(Eo[c].test(s,o)){r.push(Eo[c].code(i,o)),l=!0;break}if(!l){const c=(s.size===1&&!s.isArray?GM:HM)[s.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${c};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const zS={};let Us=zS;function VM(){if(Us===zS||Us!=null&&Us.isContextLost()){const t=re.ADAPTER.createCanvas();let e;re.PREFER_ENV>=ks.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Us=e}return Us}let Cc;function XM(){if(!Cc){Cc=Rr.MEDIUM;const t=VM();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(Cc=e.precision?Rr.HIGH:Rr.MEDIUM)}}return Cc}function Av(t,e){const r=t.getShaderSource(e).split(`
`).map((d,u)=>`${u}: ${d}`),n=t.getShaderInfoLog(e),i=n.split(`
`),s={},o=i.map(d=>parseFloat(d.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(d=>d&&!s[d]?(s[d]=!0,!0):!1),l=[""];o.forEach(d=>{r[d-1]=`%c${r[d-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=r.join(`
`);l[0]=c,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function YM(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||Av(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||Av(t,n),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const KM={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function $S(t){return KM[t]}let Ac=null;const kv={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function GS(t,e){if(!Ac){const r=Object.keys(kv);Ac={};for(let n=0;n<r.length;++n){const i=r[n];Ac[t[i]]=kv[i]}}return Ac[e]}function Iv(t,e,r){if(t.substring(0,9)!=="precision"){let n=e;return e===Rr.HIGH&&r!==Rr.HIGH&&(n=Rr.MEDIUM),`precision ${n} float;
${t}`}else if(r!==Rr.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let Sa;function qM(){if(typeof Sa=="boolean")return Sa;try{Sa=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Sa=!1}return Sa}let ZM=0;const kc={},cm=class Ys{constructor(e,r,n="pixi-shader",i={}){this.extra={},this.id=ZM++,this.vertexSrc=e||Ys.defaultVertexSrc,this.fragmentSrc=r||Ys.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),kc[n]?(kc[n]++,n+=`-${kc[n]}`):kc[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=Iv(this.vertexSrc,Ys.defaultVertexPrecision,Rr.HIGH),this.fragmentSrc=Iv(this.fragmentSrc,Ys.defaultFragmentPrecision,XM())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return $M}static get defaultFragmentSrc(){return zM}static from(e,r,n){const i=e+r;let s=bv[i];return s||(bv[i]=s=new Ys(e,r,n)),s}};cm.defaultVertexPrecision=Rr.HIGH,cm.defaultFragmentPrecision=Dn.apple.device?Rr.HIGH:Rr.MEDIUM;let Fn=cm,JM=0;class Jr{constructor(e,r,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=JM++,this.static=!!r,this.ubo=!!n,e instanceof ft?(this.buffer=e,this.buffer.type=vn.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new ft(new Float32Array(1)),this.buffer.type=vn.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,n){if(!this.ubo)this.uniforms[e]=new Jr(r,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,n){return new Jr(e,r,n)}static uboFrom(e,r){return new Jr(e,r??!0,!0)}}class _n{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof Jr?this.uniformGroup=r:this.uniformGroup=new Jr(r):this.uniformGroup=new Jr({}),this.disposeRunner=new Zr("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(const n in r.uniforms){const i=r.uniforms[n];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,n){const i=Fn.from(e,r);return new _n(i,n)}}class QM{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let s=0;s<e;s++)n[s]=s;this.defaultGroupCache[e]=Jr.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Fn(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Qe,default:this.defaultGroupCache[e]};return new _n(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let n=0;n<e;n++)n>0&&(r+=`
else `),n<e-1&&(r+=`if(vTextureId < ${n}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class dm{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function eN(){return!Dn.apple.device}function tN(t){let e=!0;const r=re.ADAPTER.getNavigator();if(Dn.tablet||Dn.phone){if(Dn.apple.device){const n=r.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(Dn.android.device){const n=r.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?t:4}class Xu{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var rN=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,nN=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Pa=class Gr extends Xu{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=FS,this.vertexSize=6,this.state=En.for2d(),this.size=Gr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??tN(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??eN(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Le("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return nN}static get defaultFragmentTemplate(){return rN}setShaderGenerator({vertex:e=Gr.defaultVertexSrc,fragment:r=Gr.defaultFragmentTemplate}={}){this.shaderGenerator=new QM(e,r)}contextChange(){const e=this.renderer.gl;re.PREFER_ENV===ks.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Gr.defaultMaxTextures),this.maxTextures=PM(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:r}=Gr,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;e.length<n;)e.push(new om);for(;r.length<i;)r.push(new dm);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:r}=this,n=Gr._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let l=++Ee._globalBatch,c=0,d=n[0],u=0;i.copyBoundTextures(s,r);for(let h=0;h<this._bufferSize;++h){const p=e[h];e[h]=null,p._batchEnabled!==l&&(d.count>=r&&(i.boundArray(d,s,l,r),this.buildDrawCalls(d,u,h),u=h,d=n[++c],++l),p._batchEnabled=l,p.touched=o,d.elements[d.count++]=p)}d.count>0&&(i.boundArray(d,s,l,r),this.buildDrawCalls(d,u,this._bufferSize),++c,++l);for(let h=0;h<s.length;h++)s[h]=null;Ee._globalBatch=l}buildDrawCalls(e,r,n){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:l}=this,c=Gr._drawCallPool;let d=this._dcIndex,u=this._aIndex,h=this._iIndex,p=c[d];p.start=this._iIndex,p.texArray=e;for(let f=r;f<n;++f){const m=i[f],_=m._texture.baseTexture,y=NS[_.alphaMode?1:0][m.blendMode];i[f]=null,r<f&&p.blend!==y&&(p.size=h-p.start,r=f,p=c[++d],p.texArray=e,p.start=h),this.packInterleavedGeometry(m,s,o,u,h),u+=m.vertexData.length/2*l,h+=m.indices.length,p.blend=y}r<n&&(p.size=h-p.start,++d),this._dcIndex=d,this._aIndex=u,this._iIndex=h}bindAndClearTexArray(e){const r=this.renderer.texture;for(let n=0;n<e.count;n++)r.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:r,_indexBuffer:n}=this;Gr.canUploadSameBuffer?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:r,state:n}=this.renderer,i=Gr._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:l,type:c,size:d,start:u,blend:h}=i[o];s!==l&&(s=l,this.bindAndClearTexArray(l)),this.state.blendMode=h,n.set(this.state),r.drawElements(c,d,r.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Gr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const r=tu(Math.ceil(e/8)),n=vv(r),i=r*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new nm(i*this.vertexSize*4)),s}getIndexBuffer(e){const r=tu(Math.ceil(e/12)),n=vv(r),i=r*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._iBuffers[n];return s||(this._iBuffers[n]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,r,n,i,s){const{uint32View:o,float32View:l}=r,c=i/this.vertexSize,d=e.uvs,u=e.indices,h=e.vertexData,p=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),m=qe.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let _=0;_<h.length;_+=2)l[i++]=h[_],l[i++]=h[_+1],l[i++]=d[_],l[i++]=d[_+1],o[i++]=m,l[i++]=p;for(let _=0;_<u.length;_++)n[s++]=c+u[_]}};Pa.defaultBatchSize=4096,Pa.extension={name:"batch",type:Q.RendererPlugin},Pa._drawCallPool=[],Pa._textureArrayPool=[];let es=Pa;ue.add(es);var iN=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,sN=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const um=class ja extends _n{constructor(e,r,n){const i=Fn.from(e||ja.defaultVertexSrc,r||ja.defaultFragmentSrc);super(i,n),this.padding=0,this.resolution=ja.defaultResolution,this.multisample=ja.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new En}apply(e,r,n,i,s){e.applyFilter(this,r,n,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return sN}static get defaultFragmentSrc(){return iN}};um.defaultResolution=1,um.defaultMultisample=yt.NONE;let qt=um;class iu{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new qe(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:r,background:n,backgroundAlpha:i}=e,s=n??r;s!==void 0&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}iu.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},iu.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"background"};ue.add(iu);class HS{constructor(e){this.renderer=e,this.emptyRenderer=new Xu(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){const{boundTextures:n}=this.renderer.texture;for(let i=r-1;i>=0;--i)e[i]=n[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,r,n,i){const{elements:s,ids:o,count:l}=e;let c=0;for(let d=0;d<l;d++){const u=s[d],h=u._batchLocation;if(h>=0&&h<i&&r[h]===u){o[d]=h;continue}for(;c<i;){const p=r[c];if(p&&p._batchEnabled===n&&p._batchLocation===c){c++;continue}o[d]=c,u._batchLocation=c,r[c]=u;break}}}destroy(){this.renderer=null}}HS.extension={type:Q.RendererSystem,name:"batch"};ue.add(HS);let Rv=0;class su{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Rv++}init(e){if(e.context)this.initFromContext(e.context);else{const r=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Rv++,this.renderer.runners.contextChange.emit(e);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let n;if(re.PREFER_ENV>=ks.WEBGL2&&(n=e.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const r=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}su.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},su.extension={type:Q.RendererSystem,name:"context"};ue.add(su);class hm{constructor(e,r){if(this.width=Math.round(e),this.height=Math.round(r),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Zr("disposeFramebuffer"),this.multisample=yt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new Ee(null,{scaleMode:Bn.NEAREST,resolution:1,mipmap:bn.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new Ee(null,{scaleMode:Bn.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:bn.OFF,format:K.DEPTH_COMPONENT,type:me.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!e||!r)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],s=i.resolution;i.setSize(e/s,r/s)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,r/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class WS extends Ee{constructor(e={}){if(typeof e=="number"){const r=arguments[0],n=arguments[1],i=arguments[2],s=arguments[3];e={width:r,height:n,scaleMode:i,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=yt.NONE),super(null,e),this.mipmap=bn.OFF,this.valid=!0,this._clear=new qe([0,0,0,0]),this.framebuffer=new hm(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Yn extends Cl{constructor(e){const r=e,n=r.naturalWidth||r.videoWidth||r.displayWidth||r.width,i=r.naturalHeight||r.videoHeight||r.displayHeight||r.height;super(n,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,n){n===void 0&&!r.startsWith("data:")?e.crossOrigin=kM(r):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,r,n,i){const s=e.gl,o=r.realWidth,l=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===nr.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&n.width===o&&n.height===l?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,n.type,i):(n.width=o,n.height=l,s.texImage2D(r.target,0,n.internalFormat,r.format,n.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),super.update()}dispose(){this.source=null}}class VS extends Yn{constructor(e,r){if(r=r||{},typeof e=="string"){const n=new Image;Yn.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??re.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,n)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{n(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===nr.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,n,this.bitmap),!this.preserveBitmap){let i=!0;const s=r._glTextures;for(const o in s){const l=s[o];if(l!==n&&l.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class ox{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,n){const i=r.width,s=r.height;if(n){const o=e.width/2/i,l=e.height/2/s,c=e.x/i+o,d=e.y/s+l;n=nt.add(n,nt.NW),this.x0=c+o*nt.uX(n),this.y0=d+l*nt.uY(n),n=nt.add(n,2),this.x1=c+o*nt.uX(n),this.y1=d+l*nt.uY(n),n=nt.add(n,2),this.x2=c+o*nt.uX(n),this.y2=d+l*nt.uY(n),n=nt.add(n,2),this.x3=c+o*nt.uX(n),this.y3=d+l*nt.uY(n)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}ox.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Pv=new ox;function Ic(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class de extends Ll{constructor(e,r,n,i,s,o,l){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new Ae(0,0,1,1)),e instanceof de&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=Pv,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Ue(o.x,o.y):new Ue(0,0),this.defaultBorders=l,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:r}=this.baseTexture;r!=null&&r.url&&an[r.url]&&de.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,de.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new de(this.baseTexture,!this.noFrame&&e,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===Pv&&(this._uvs=new ox),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},n=re.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else if(e instanceof Ee){if(!e.cacheId){const l=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e.cacheId=`${l}-${_s()}`,Ee.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const l=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${l}_${_s()}`}s=e._pixiId}let o=an[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof Ee)?(r.resolution||(r.resolution=Xn(e)),o=new de(new Ee(e,r)),o.baseTexture.cacheId=s,Ee.addToCache(o.baseTexture,s),de.addToCache(o,s)):!o&&e instanceof Ee&&(o=new de(e),de.addToCache(o,s)),o}static fromURL(e,r){const n=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=de.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,r,n,i){return new de(Ee.fromBuffer(e,r,n,i))}static fromLoader(e,r,n,i){const s=new Ee(e,Object.assign({scaleMode:Ee.defaultOptions.scaleMode,resolution:Xn(r)},i)),{resource:o}=s;o instanceof VS&&(o.url=r);const l=new de(s);return n||(n=r),Ee.addToCache(l.baseTexture,n),de.addToCache(l,n),n!==r&&(Ee.addToCache(l.baseTexture,r),de.addToCache(l,r)),l.baseTexture.valid?Promise.resolve(l):new Promise(c=>{l.baseTexture.once("loaded",()=>c(l))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),an[r]&&an[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),an[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=an[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete an[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)an[e.textureCacheIds[r]]===e&&delete an[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:r,y:n,width:i,height:s}=e,o=r+i>this.baseTexture.width,l=n+s>this.baseTexture.height;if(o||l){const c=o&&l?"and":"or",d=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,u=`Y: ${n} + ${s} = ${n+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${d} ${c} ${u}`)}this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return de._EMPTY||(de._EMPTY=new de(new Ee),Ic(de._EMPTY),Ic(de._EMPTY.baseTexture)),de._EMPTY}static get WHITE(){if(!de._WHITE){const e=re.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),de._WHITE=new de(Ee.from(e)),Ic(de._WHITE),Ic(de._WHITE.baseTexture)}return de._WHITE}}class Rs extends de{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,n=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(r*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new Rs(new WS(e))}}class XS{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,n=yt.NONE){const i=new WS(Object.assign({width:e,height:r,resolution:1,multisample:n},this.textureOptions));return new Rs(i)}getOptimalTexture(e,r,n=1,i=yt.NONE){let s;e=Math.max(Math.ceil(e*n-1e-6),1),r=Math.max(Math.ceil(r*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=tu(e),r=tu(r),s=((e&65535)<<16|r&65535)>>>0,i>1&&(s+=i*4294967296)):s=i>1?-i:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,i)),o.filterPoolKey=s,o.setResolution(n),o}getFilterTexture(e,r,n){const i=this.getOptimalTexture(e.width,e.height,r||e.resolution,n||yt.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const r in this.texturePool){const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}XS.SCREEN_KEY=-1;class oN extends Pi{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class YS extends Pi{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ft(this.vertices),this.uvBuffer=new ft(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+r.width/e.width,this.uvs[3]=i,this.uvs[4]=n+r.width/e.width,this.uvs[5]=i+r.height/e.height,this.uvs[6]=n,this.uvs[7]=i+r.height/e.height,n=r.x,i=r.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+r.width,this.vertices[3]=i,this.vertices[4]=n+r.width,this.vertices[5]=i+r.height,this.vertices[6]=n,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class aN{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=yt.NONE,this.sourceFrame=new Ae,this.destinationFrame=new Ae,this.bindingSourceFrame=new Ae,this.bindingDestinationFrame=new Ae,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Rc=[new Ue,new Ue,new Ue,new Ue],mp=new Qe;class KS{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new XS,this.statePool=[],this.quad=new oN,this.quadUv=new YS,this.tempRect=new Ae,this.activeState={},this.globalUniforms=new Jr({outputFrame:new Ae,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){const n=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new aN,o=n.renderTexture;let l,c;if(o.current){const y=o.current;l=y.resolution,c=y.multisample}else l=n.resolution,c=n.multisample;let d=r[0].resolution||l,u=r[0].multisample??c,h=r[0].padding,p=r[0].autoFit,f=r[0].legacy??!0;for(let y=1;y<r.length;y++){const x=r[y];d=Math.min(d,x.resolution||l),u=Math.min(u,x.multisample??c),h=this.useMaxPadding?Math.max(h,x.padding):h+x.padding,p=p&&x.autoFit,f=f||(x.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=d,s.multisample=u,s.legacy=f,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(h);const m=this.tempRect.copyFrom(o.sourceFrame);n.projection.transform&&this.transformAABB(mp.copyFrom(n.projection.transform).invert(),m),p?(s.sourceFrame.fit(m),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(m)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:n.resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,d,u),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const _=this.tempRect;_.x=0,_.y=0,_.width=s.sourceFrame.width,_.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=n.projection.transform,n.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,_),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,r=e.pop(),n=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const s=i.inputSize,o=i.inputPixel,l=i.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],l[0]=.5*o[2],l[1]=.5*o[3],l[2]=r.sourceFrame.width*s[2]-.5*o[2],l[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){const d=i.filterArea;d[0]=r.destinationFrame.width,d[1]=r.destinationFrame.height,d[2]=r.sourceFrame.x,d[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const c=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,c.renderTexture,pn.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let d=r.renderTexture,u=this.getOptimalFilterTexture(d.width,d.height,r.resolution);u.filterFrame=d.filterFrame;let h=0;for(h=0;h<n.length-1;++h){h===1&&r.multisample>1&&(u=this.getOptimalFilterTexture(d.width,d.height,r.resolution),u.filterFrame=d.filterFrame),n[h].apply(this,d,u,pn.CLEAR,r);const p=d;d=u,u=p}n[h].apply(this,d,c.renderTexture,pn.BLEND,r),h>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(d),this.returnFilterTexture(u)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=pn.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,n.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=i.stateId&1||this.forceClear;(r===pn.CLEAR||r===pn.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,n,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(n,i),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(gn.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(gn.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:s}=r._texture,o=e.set(i.width,0,0,i.height,n.x,n.y),l=r.worldTransform.copyTo(Qe.TEMP_MATRIX);return l.invert(),o.prepend(l),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,n=1,i=yt.NONE){return this.texturePool.getOptimalTexture(e,r,n,i)}getFilterTexture(e,r,n){if(typeof e=="number"){const s=e;e=r,r=s}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,n||yt.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){const n=Rc[0],i=Rc[1],s=Rc[2],o=Rc[3];n.set(r.left,r.top),i.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(n,n),e.apply(i,i),e.apply(s,s),e.apply(o,o);const l=Math.min(n.x,i.x,s.x,o.x),c=Math.min(n.y,i.y,s.y,o.y),d=Math.max(n.x,i.x,s.x,o.x),u=Math.max(n.y,i.y,s.y,o.y);r.x=l,r.y=c,r.width=d-l,r.height=u-c}roundFrame(e,r,n,i,s){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(s){const{a:o,b:l,c,d}=s;if((Math.abs(l)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(d)>1e-4))return}s=s?mp.copyFrom(s):mp.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}}KS.extension={type:Q.RendererSystem,name:"filter"};ue.add(KS);class lN{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=yt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const cN=new Ae;class qS{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new hm(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Ae,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;re.PREFER_ENV===ks.WEBGL_LEGACY&&(r=null,n=null),r?e.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,n=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=n),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const l=e.colorTextures[o];this.renderer.texture.unbind(l.parentTextureArray||l)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){const o=r.width>>n,l=r.height>>n,c=o/r.width;this.setViewport(r.x*c,r.y*c,o,l)}else{const o=e.width>>n,l=e.height>>n;this.setViewport(0,0,o,l)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,n,i){const s=this.viewport;e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),(s.width!==n||s.height!==i||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=n,s.height=i,this.gl.viewport(e,r,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,n,i,s=Uf.COLOR|Uf.DEPTH){const{gl:o}=this;o.clearColor(e,r,n,i),o.clear(s)}initFramebuffer(e){const{gl:r}=this,n=new lN(r.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){r.bindRenderbuffer(r.RENDERBUFFER,n.stencil);let o;this.renderer.context.webGLVersion===1?o=r.DEPTH_STENCIL:e.depth&&e.stencil?o=r.DEPTH24_STENCIL8:e.depth?o=r.DEPTH_COMPONENT24:o=r.STENCIL_INDEX8,n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,o,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let s=i.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const l=i[o],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),o===0&&n.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const l=[];for(let c=0;c<o;c++){const d=s[c],u=d.parentTextureArray||d;this.renderer.texture.bind(u,0),c===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+c,d.target,u._glTextures[this.CONTEXT_UID].texture,r),l.push(n.COLOR_ATTACHMENT0+c))}if(l.length>1&&n.drawBuffers(l),e.depthTexture&&this.writeDepthTexture){const c=e.depthTexture;this.renderer.texture.bind(c,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,c._glTextures[this.CONTEXT_UID].texture,r)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||n.createRenderbuffer();let c,d;this.renderer.context.webGLVersion===1?(c=n.DEPTH_STENCIL_ATTACHMENT,d=n.DEPTH_STENCIL):e.depth&&e.stencil?(c=n.DEPTH_STENCIL_ATTACHMENT,d=n.DEPTH24_STENCIL8):e.depth?(c=n.DEPTH_ATTACHMENT,d=n.DEPTH_COMPONENT24):(c=n.STENCIL_ATTACHMENT,d=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,d,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,d,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,c,n.RENDERBUFFER,i.stencil)}else i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:r}=this;let n=yt.NONE;if(e<=1||r===null)return n;for(let i=0;i<r.length;i++)if(r[i]<=e){n=r[i];break}return n===1&&(n=yt.NONE),n}blit(e,r,n){const{current:i,renderer:s,gl:o,CONTEXT_UID:l}=this;if(s.context.webGLVersion!==2||!i)return;const c=i.glFramebuffers[l];if(!c)return;if(!e){if(!c.msaaBuffer)return;const u=i.colorTextures[0];if(!u)return;c.blitFramebuffer||(c.blitFramebuffer=new hm(i.width,i.height),c.blitFramebuffer.addColorTexture(0,u)),e=c.blitFramebuffer,e.colorTextures[0]!==u&&(e.colorTextures[0]=u,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}r||(r=cN,r.width=i.width,r.height=i.height),n||(n=r);const d=r.width===n.width&&r.height===n.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,c.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,d?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,r){const n=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,r)}disposeAll(e){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<r.length;n++)this.disposeFramebuffer(r[n],e)}forceStencil(){const e=this.current;if(!e)return;const r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil&&e.stencil)return;e.stencil=!0;const n=e.width,i=e.height,s=this.gl,o=r.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let l,c;this.renderer.context.webGLVersion===1?(l=s.DEPTH_STENCIL_ATTACHMENT,c=s.DEPTH_STENCIL):e.depth?(l=s.DEPTH_STENCIL_ATTACHMENT,c=s.DEPTH24_STENCIL8):(l=s.STENCIL_ATTACHMENT,c=s.STENCIL_INDEX8),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,c,n,i):s.renderbufferStorage(s.RENDERBUFFER,c,n,i),s.framebufferRenderbuffer(s.FRAMEBUFFER,l,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Ae}destroy(){this.renderer=null}}qS.extension={type:Q.RendererSystem,name:"framebuffer"};ue.add(qS);const gp={5126:4,5123:2,5121:1};class ZS{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;re.PREFER_ENV===ks.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(i,s)=>n.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,l,c)=>n.drawElementsInstancedANGLE(i,s,o,l,c),e.drawArraysInstanced=(i,s,o,l)=>n.drawArraysInstancedANGLE(i,s,o,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;const{gl:n}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,r=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];r.update(i)}}checkCompatibility(e,r){const n=e.attributes,i=r.attributeData;for(const s in i)if(!n[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){const n=e.attributes,i=r.attributeData,s=["g",e.id];for(const o in n)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,r,n=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,l=r.program;l.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,l);const c=this.getSignature(e,l),d=e.glVertexArrayObjects[this.CONTEXT_UID];let u=d[c];if(u)return d[l.id]=u,u;const h=e.buffers,p=e.attributes,f={},m={};for(const _ in h)f[_]=0,m[_]=0;for(const _ in p)!p[_].size&&l.attributeData[_]?p[_].size=l.attributeData[_].size:p[_].size||console.warn(`PIXI Geometry attribute '${_}' size cannot be determined (likely the bound shader does not have the attribute)`),f[p[_].buffer]+=p[_].size*gp[p[_].type];for(const _ in p){const y=p[_],x=y.size;y.stride===void 0&&(f[y.buffer]===x*gp[y.type]?y.stride=0:y.stride=f[y.buffer]),y.start===void 0&&(y.start=m[y.buffer],m[y.buffer]+=x*gp[y.type])}u=i.createVertexArray(),i.bindVertexArray(u);for(let _=0;_<h.length;_++){const y=h[_];o.bind(y),n&&y._glBuffers[s].refCount++}return this.activateVao(e,l),d[l.id]=u,d[c]=u,i.bindVertexArray(null),o.unbind(vn.ARRAY_BUFFER),u}disposeGeometry(e,r){var l;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=(l=this.renderer)==null?void 0:l.buffer;if(e.disposeRunner.remove(this),!!n){if(o)for(let c=0;c<s.length;c++){const d=s[c]._glBuffers[this.CONTEXT_UID];d&&(d.refCount--,d.refCount===0&&!r&&o.dispose(s[c],r))}if(!r){for(const c in n)if(c[0]==="g"){const d=n[c];this._activeVao===d&&this.unbind(),i.deleteVertexArray(d)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const r=Object.keys(this.managedGeometries);for(let n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],e)}activateVao(e,r){const n=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,l=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let c=null;for(const d in l){const u=l[d],h=o[u.buffer],p=h._glBuffers[i];if(r.attributeData[d]){c!==p&&(s.bind(h),c=p);const f=r.attributeData[d].location;if(n.enableVertexAttribArray(f),n.vertexAttribPointer(f,u.size,u.type||n.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)n.vertexAttribDivisor(f,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,n,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const l=o.indexBuffer.data.BYTES_PER_ELEMENT,c=l===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,c,(n||0)*l,i||1):s.drawElements(e,r||o.indexBuffer.data.length,c,(n||0)*l):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,n,r||o.getSize(),i||1):s.drawArrays(e,n,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}ZS.extension={type:Q.RendererSystem,name:"geometry"};ue.add(ZS);const jv=new Qe;class JS{constructor(e,r){this._texture=e,this.mapCoord=new Qe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];r[i]=s*n.a+o*n.c+n.tx,r[i+1]=s*n.b+o*n.d+n.ty}return r}update(e){const r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const n=r._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=r.orig,s=r.trim;s&&(jv.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(jv));const o=r.baseTexture,l=this.uClampFrame,c=this.clampMargin/o.resolution,d=this.clampOffset;return l[0]=(r._frame.x+c+d)/o.width,l[1]=(r._frame.y+c+d)/o.height,l[2]=(r._frame.x+r._frame.width-c+d)/o.width,l[3]=(r._frame.y+r._frame.height-c+d)/o.height,this.uClampOffset[0]=d/o.realWidth,this.uClampOffset[1]=d/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}}var dN=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,uN=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class hN extends qt{constructor(e,r,n){let i=null;typeof e!="string"&&r===void 0&&n===void 0&&(i=e,e=void 0,r=void 0,n=void 0),super(e||uN,r||dN,n),this.maskSprite=i,this.maskMatrix=new Qe}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,n,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new JS(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,n,i))}}class pN{constructor(e=null){this.type=Et.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=qt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Et.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class QS{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let n=r;if(!n.isMaskData){const s=this.maskDataPool.pop()||new pN;s.pooled=!0,s.maskObject=r,n=s}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==Et.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case Et.SCISSOR:this.renderer.scissor.push(n);break;case Et.STENCIL:this.renderer.stencil.push(n);break;case Et.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case Et.COLOR:this.pushColorMask(n);break}n.type===Et.SPRITE&&this.maskStack.push(n)}pop(e){const r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case Et.SCISSOR:this.renderer.scissor.pop(r);break;case Et.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case Et.SPRITE:this.popSpriteMask(r);break;case Et.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===Et.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const r=e.maskObject;r?r.isSprite?e.type=Et.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Et.SCISSOR:e.type=Et.STENCIL:e.type=Et.COLOR}pushSpriteMask(e){const{maskObject:r}=e,n=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new hN])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=r;const s=n.filterArea;n.filterArea=r.getBounds(!0),this.renderer.filter.push(n,i),n.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const r=e._colorMask,n=e._colorMask=r&e.colorMask;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const r=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}QS.extension={type:Q.RendererSystem,name:"mask"};ue.add(QS);class eE{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:r}=this.renderer,n=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==n&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Mv=new Qe,Nv=[],tE=class hd extends eE{constructor(e){super(e),this.glConst=re.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const r=e._scissorRect,{maskObject:n}=e,{renderer:i}=this,s=i.renderTexture,o=n.getBounds(!0,Nv.pop()??new Ae);this.roundFrameToPixels(o,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),r&&o.fit(r),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:r,b:n,c:i,d:s}=e;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(r)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:r}=e;if(!r.isFastRect||!r.isFastRect()||hd.isMatrixRotated(r.worldTransform)||hd.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const n=e._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(e,r,n,i,s){hd.isMatrixRotated(s)||(s=s?Mv.copyFrom(s):Mv.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*r),e.y=Math.round(e.y*r),e.width=Math.round(e.width*r),e.height=Math.round(e.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:r}=this.renderer;e._scissorRect||r.enable(r.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:r}=this.renderer;e&&Nv.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():r.disable(r.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let r;this.renderer.renderTexture.current?r=e.y:r=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,r,e.width,e.height)}};tE.extension={type:Q.RendererSystem,name:"scissor"};let fN=tE;ue.add(fN);class rE extends eE{constructor(e){super(e),this.glConst=re.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const r=e.maskObject,{gl:n}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,n.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(n._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}rE.extension={type:Q.RendererSystem,name:"stencil"};ue.add(rE);class nE{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Le("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return Le("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return Le("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}nE.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"_plugin"};ue.add(nE);class iE{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Qe,this.transform=null}update(e,r,n,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,n,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}}iE.extension={type:Q.RendererSystem,name:"projection"};ue.add(iE);const mN=new sx,Bv=new Ae;class sE{constructor(e){this.renderer=e,this._tempMatrix=new Qe}generateTexture(e,r){const{region:n,...i}=r||{},s=(n==null?void 0:n.copyTo(Bv))||e.getLocalBounds(Bv,!0),o=i.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),i.width=s.width,i.height=s.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const l=Rs.create(i);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const c=e.transform;return e.transform=mN,this.renderer.render(e,{renderTexture:l,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=c,l}destroy(){}}sE.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"textureGenerator"};ue.add(sE);const Wi=new Ae,Ea=new Ae;class oE{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Ae,this.destinationFrame=new Ae,this.viewportFrame=new Ae}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,r,n){const i=this.renderer;this.current=e;let s,o,l;e?(s=e.baseTexture,l=s.resolution,r||(Wi.width=e.frame.width,Wi.height=e.frame.height,r=Wi),n||(Ea.x=e.frame.x,Ea.y=e.frame.y,Ea.width=r.width,Ea.height=r.height,n=Ea),o=s.framebuffer):(l=i.resolution,r||(Wi.width=i._view.screen.width,Wi.height=i._view.screen.height,r=Wi),n||(n=Wi,n.width=r.width,n.height=r.height));const c=this.viewportFrame;c.x=n.x*l,c.y=n.y*l,c.width=n.width*l,c.height=n.height*l,e||(c.y=i.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(o,c),this.renderer.projection.update(n,r,l,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)}clear(e,r){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=qe.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,l=s.width!==o.width||s.height!==o.height;if(l){let{x:c,y:d,width:u,height:h}=this.viewportFrame;c=Math.round(c),d=Math.round(d),u=Math.round(u),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(c,d,u,h)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,r),l&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}oE.extension={type:Q.RendererSystem,name:"renderTexture"};ue.add(oE);class gN{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function xN(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=GS(e,s.type),l={type:o,name:s.name,size:$S(o),location:e.getAttribLocation(t,s.name)};r[s.name]=l}return r}function yN(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),l=!!s.name.match(/\[.*?\]$/),c=GS(e,s.type);r[o]={name:o,index:i,type:c,size:s.size,isArray:l,value:US(c,s.size)}}return r}function vN(t,e){var l;const r=Cv(t,t.VERTEX_SHADER,e.vertexSrc),n=Cv(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n);const s=(l=e.extra)==null?void 0:l.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||YM(t,i,r,n),e.attributeData=xN(i,t),e.uniformData=yN(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const c=Object.keys(e.attributeData);c.sort((d,u)=>d>u?1:-1);for(let d=0;d<c.length;d++)e.attributeData[c[d]].location=d,t.bindAttribLocation(i,d,c[d]);t.linkProgram(i)}t.deleteShader(r),t.deleteShader(n);const o={};for(const c in e.uniformData){const d=e.uniformData[c];o[c]={location:t.getUniformLocation(i,c),value:US(d.type,d.size)}}return new gN(i,o)}function _N(t,e,r,n,i){r.buffer.update(i)}const bN={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},aE={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function wN(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let r=0,n=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(r=aE[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!==0&&n<16){const l=n%r%16;n+=l,i+=l}n+r>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function SN(t,e){const r=[];for(const n in t)e[n]&&r.push(e[n]);return r.sort((n,i)=>n.index-i.index),r}function EN(t,e){if(!t.autoManage)return{size:0,syncFunc:_N};const r=SN(t.uniforms,e),{uboElements:n,size:i}=wN(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<n.length;o++){const l=n[o],c=t.uniforms[l.data.name],d=l.data.name;let u=!1;for(let h=0;h<Eo.length;h++){const p=Eo[h];if(p.codeUbo&&p.test(l.data,c)){s.push(`offset = ${l.offset/4};`,Eo[h].codeUbo(l.data.name,c)),u=!0;break}}if(!u)if(l.data.size>1){const h=$S(l.data.type),p=Math.max(aE[l.data.type]/16,1),f=h/p,m=(4-f%4)%4;s.push(`
                cv = ud.${d}.value;
                v = uv.${d};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*p}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const h=bN[l.data.type];s.push(`
                cv = ud.${d}.value;
                v = uv.${d};
                offset = ${l.offset/4};
                ${h};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let TN=0;const Pc={textureCount:0,uboCount:0};class lE{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=TN++}systemCheck(){if(!qM())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),r||(Pc.textureCount=0,Pc.uboCount=0,this.syncUniformGroup(e.uniformGroup,Pc)),i}setUniforms(e){const r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,r){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,r))}syncUniforms(e,r,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=WM(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const i=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,r);e.buffer.update(),i(n.uniformData,e.uniforms,this.renderer,Pc,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[r])}createSyncBufferGroup(e,r,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(r.program,n);r.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let l=this._uboCache[o];if(l||(l=this._uboCache[o]=EN(e,this.shader.program.uniformData)),e.autoManage){const c=new Float32Array(l.size/4);e.buffer.update(c)}return r.uniformGroups[e.id]=l.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,n){const i=e.uniforms,s=[`${n}-`];for(const o in i)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=this.gl,n=e.program,i=vN(r,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}lE.extension={type:Q.RendererSystem,name:"shader"};ue.add(lE);class ou{constructor(e){this.renderer=e}run(e){const{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.4.3 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}}ou.defaultOptions={hello:!1},ou.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"startup"};ue.add(ou);function CN(t,e=[]){return e[be.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.ADD]=[t.ONE,t.ONE],e[be.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.NONE]=[0,0],e[be.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[be.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[be.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[be.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[be.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[be.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[be.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[be.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[be.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[be.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[be.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const AN=0,kN=1,IN=2,RN=3,PN=4,jN=5,cE=class pm{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=be.NONE,this._blendEq=!1,this.map=[],this.map[AN]=this.setBlend,this.map[kN]=this.setOffset,this.map[IN]=this.setCullFace,this.map[RN]=this.setDepthTest,this.map[PN]=this.setFrontFace,this.map[jN]=this.setDepthMask,this.checks=[],this.defaultState=new En,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=CN(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let r=this.stateId^e.data,n=0;for(;r;)r&1&&this.map[n].call(this,!!(e.data&1<<n)),r=r>>1,n++;this.stateId=e.data}for(let r=0;r<this.checks.length;r++)this.checks[r](this,e)}forceState(e){e=e||this.defaultState;for(let r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(let r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(pm.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(pm.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const r=this.blendModes[e],n=this.gl;r.length===2?n.blendFunc(r[0],r[1]):n.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,n.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,r){this.gl.polygonOffset(e,r)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,r){const n=this.checks.indexOf(e);r&&n===-1?this.checks.push(e):!r&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,r){e.setBlendMode(r.blendMode)}static checkPolygonOffset(e,r){e.setPolygonOffset(1,r.polygonOffset)}destroy(){this.gl=null}};cE.extension={type:Q.RendererSystem,name:"state"};let MN=cE;ue.add(MN);class NN extends Ll{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const r=(e.priority??[]).filter(i=>e.systems[i]),n=[...r,...Object.keys(e.systems).filter(i=>!r.includes(i))];for(const i of n)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(r=>{this.runners[r]=new Zr(r)})}addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(e,r){const n=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=n.find(o=>this._systemsHash[o]===i);i[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const Ma=class pd{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=pd.defaultMaxIdle,this.checkCountMax=pd.defaultCheckCountMax,this.mode=pd.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==qg.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,r=e.managedTextures;let n=!1;for(let i=0;i<r.length;i++){const s=r[i];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),r[i]=null,n=!0)}if(n){let i=0;for(let s=0;s<r.length;s++)r[s]!==null&&(r[i++]=r[s]);r.length=i}}unload(e){const r=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&r.destroyTexture(n);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};Ma.defaultMode=qg.AUTO,Ma.defaultMaxIdle=60*60,Ma.defaultCheckCountMax=60*10,Ma.extension={type:Q.RendererSystem,name:"textureGC"};let ts=Ma;ue.add(ts);class xp{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=me.UNSIGNED_BYTE,this.internalFormat=K.RGBA,this.samplerType=0}}function BN(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:te.FLOAT,[t.RGBA]:te.FLOAT,[t.ALPHA]:te.FLOAT,[t.LUMINANCE]:te.FLOAT,[t.LUMINANCE_ALPHA]:te.FLOAT,[t.R8]:te.FLOAT,[t.R8_SNORM]:te.FLOAT,[t.RG8]:te.FLOAT,[t.RG8_SNORM]:te.FLOAT,[t.RGB8]:te.FLOAT,[t.RGB8_SNORM]:te.FLOAT,[t.RGB565]:te.FLOAT,[t.RGBA4]:te.FLOAT,[t.RGB5_A1]:te.FLOAT,[t.RGBA8]:te.FLOAT,[t.RGBA8_SNORM]:te.FLOAT,[t.RGB10_A2]:te.FLOAT,[t.RGB10_A2UI]:te.FLOAT,[t.SRGB8]:te.FLOAT,[t.SRGB8_ALPHA8]:te.FLOAT,[t.R16F]:te.FLOAT,[t.RG16F]:te.FLOAT,[t.RGB16F]:te.FLOAT,[t.RGBA16F]:te.FLOAT,[t.R32F]:te.FLOAT,[t.RG32F]:te.FLOAT,[t.RGB32F]:te.FLOAT,[t.RGBA32F]:te.FLOAT,[t.R11F_G11F_B10F]:te.FLOAT,[t.RGB9_E5]:te.FLOAT,[t.R8I]:te.INT,[t.R8UI]:te.UINT,[t.R16I]:te.INT,[t.R16UI]:te.UINT,[t.R32I]:te.INT,[t.R32UI]:te.UINT,[t.RG8I]:te.INT,[t.RG8UI]:te.UINT,[t.RG16I]:te.INT,[t.RG16UI]:te.UINT,[t.RG32I]:te.INT,[t.RG32UI]:te.UINT,[t.RGB8I]:te.INT,[t.RGB8UI]:te.UINT,[t.RGB16I]:te.INT,[t.RGB16UI]:te.UINT,[t.RGB32I]:te.INT,[t.RGB32UI]:te.UINT,[t.RGBA8I]:te.INT,[t.RGBA8UI]:te.UINT,[t.RGBA16I]:te.INT,[t.RGBA16UI]:te.UINT,[t.RGBA32I]:te.INT,[t.RGBA32UI]:te.UINT,[t.DEPTH_COMPONENT16]:te.FLOAT,[t.DEPTH_COMPONENT24]:te.FLOAT,[t.DEPTH_COMPONENT32F]:te.FLOAT,[t.DEPTH_STENCIL]:te.FLOAT,[t.DEPTH24_STENCIL8]:te.FLOAT,[t.DEPTH32F_STENCIL8]:te.FLOAT}:e={[t.RGB]:te.FLOAT,[t.RGBA]:te.FLOAT,[t.ALPHA]:te.FLOAT,[t.LUMINANCE]:te.FLOAT,[t.LUMINANCE_ALPHA]:te.FLOAT,[t.DEPTH_STENCIL]:te.FLOAT},e}function DN(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[me.UNSIGNED_BYTE]:{[K.RGBA]:t.RGBA8,[K.RGB]:t.RGB8,[K.RG]:t.RG8,[K.RED]:t.R8,[K.RGBA_INTEGER]:t.RGBA8UI,[K.RGB_INTEGER]:t.RGB8UI,[K.RG_INTEGER]:t.RG8UI,[K.RED_INTEGER]:t.R8UI,[K.ALPHA]:t.ALPHA,[K.LUMINANCE]:t.LUMINANCE,[K.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[me.BYTE]:{[K.RGBA]:t.RGBA8_SNORM,[K.RGB]:t.RGB8_SNORM,[K.RG]:t.RG8_SNORM,[K.RED]:t.R8_SNORM,[K.RGBA_INTEGER]:t.RGBA8I,[K.RGB_INTEGER]:t.RGB8I,[K.RG_INTEGER]:t.RG8I,[K.RED_INTEGER]:t.R8I},[me.UNSIGNED_SHORT]:{[K.RGBA_INTEGER]:t.RGBA16UI,[K.RGB_INTEGER]:t.RGB16UI,[K.RG_INTEGER]:t.RG16UI,[K.RED_INTEGER]:t.R16UI,[K.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[me.SHORT]:{[K.RGBA_INTEGER]:t.RGBA16I,[K.RGB_INTEGER]:t.RGB16I,[K.RG_INTEGER]:t.RG16I,[K.RED_INTEGER]:t.R16I},[me.UNSIGNED_INT]:{[K.RGBA_INTEGER]:t.RGBA32UI,[K.RGB_INTEGER]:t.RGB32UI,[K.RG_INTEGER]:t.RG32UI,[K.RED_INTEGER]:t.R32UI,[K.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[me.INT]:{[K.RGBA_INTEGER]:t.RGBA32I,[K.RGB_INTEGER]:t.RGB32I,[K.RG_INTEGER]:t.RG32I,[K.RED_INTEGER]:t.R32I},[me.FLOAT]:{[K.RGBA]:t.RGBA32F,[K.RGB]:t.RGB32F,[K.RG]:t.RG32F,[K.RED]:t.R32F,[K.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[me.HALF_FLOAT]:{[K.RGBA]:t.RGBA16F,[K.RGB]:t.RGB16F,[K.RG]:t.RG16F,[K.RED]:t.R16F},[me.UNSIGNED_SHORT_5_6_5]:{[K.RGB]:t.RGB565},[me.UNSIGNED_SHORT_4_4_4_4]:{[K.RGBA]:t.RGBA4},[me.UNSIGNED_SHORT_5_5_5_1]:{[K.RGBA]:t.RGB5_A1},[me.UNSIGNED_INT_2_10_10_10_REV]:{[K.RGBA]:t.RGB10_A2,[K.RGBA_INTEGER]:t.RGB10_A2UI},[me.UNSIGNED_INT_10F_11F_11F_REV]:{[K.RGB]:t.R11F_G11F_B10F},[me.UNSIGNED_INT_5_9_9_9_REV]:{[K.RGB]:t.RGB9_E5},[me.UNSIGNED_INT_24_8]:{[K.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[me.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[K.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[me.UNSIGNED_BYTE]:{[K.RGBA]:t.RGBA,[K.RGB]:t.RGB,[K.ALPHA]:t.ALPHA,[K.LUMINANCE]:t.LUMINANCE,[K.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[me.UNSIGNED_SHORT_5_6_5]:{[K.RGB]:t.RGB},[me.UNSIGNED_SHORT_4_4_4_4]:{[K.RGBA]:t.RGBA},[me.UNSIGNED_SHORT_5_5_5_1]:{[K.RGBA]:t.RGBA}},e}class dE{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Ee,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=DN(e),this.samplerTypes=BN(e);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new xp(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new xp(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,r=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:r,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}ensureSamplerType(e){const{boundTextures:r,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let s=e-1;s>=0;--s){const o=r[s];o&&o._glTextures[i].samplerType!==te.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const r=new xp(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){var n;r.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,r.samplerType=this.samplerTypes[r.internalFormat]??te.FLOAT,this.webGLVersion===2&&e.type===me.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){var i;const r=e._glTextures[this.CONTEXT_UID];if(!r)return;const n=this.renderer;if(this.initTextureType(e,r),(i=e.resource)==null?void 0:i.upload(n,e,r))r.samplerType!==te.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,l=n.gl;(r.width!==s||r.height!==o||r.dirtyId<0)&&(r.width=s,r.height=o,l.texImage2D(e.target,0,r.internalFormat,s,o,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(e);i!==-1&&So(this.managedTextures,i,1)}}updateTextureStyle(e){var n;const r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===bn.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=Ai.CLAMP:r.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){const n=this.gl;if(r.mipmap&&e.mipmap!==bn.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Bn.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===Bn.LINEAR){const s=Math.min(e.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Bn.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===Bn.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}dE.extension={type:Q.RendererSystem,name:"texture"};ue.add(dE);class uE{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){const{gl:n,renderer:i}=this;r&&i.shader.bind(r),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:r,renderer:n,CONTEXT_UID:i}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[i]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const l=e.buffers[o];l&&(n.buffer.update(l),l._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,l._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){const n=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const l=e.buffers[o];if(!l)continue;const c=l._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!r&&s.dispose(l,r))}n&&(r||i.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}uE.extension={type:Q.RendererSystem,name:"transformFeedback"};ue.add(uE);class au{constructor(e){this.renderer=e}init(e){this.screen=new Ae(0,0,e.width,e.height),this.element=e.view||re.ADAPTER.createCanvas(),this.resolution=e.resolution||re.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var r;e&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}au.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},au.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"_view"};ue.add(au);re.PREFER_ENV=ks.WEBGL2;re.STRICT_TEXTURE_CACHE=!1;re.RENDER_OPTIONS={...su.defaultOptions,...iu.defaultOptions,...au.defaultOptions,...ou.defaultOptions};Object.defineProperties(re,{WRAP_MODE:{get(){return Ee.defaultOptions.wrapMode},set(t){Le("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Ee.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return Ee.defaultOptions.scaleMode},set(t){Le("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Ee.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return Ee.defaultOptions.mipmap},set(t){Le("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Ee.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return Ee.defaultOptions.anisotropicLevel},set(t){Le("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Ee.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return Le("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),qt.defaultResolution},set(t){qt.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return Le("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),qt.defaultMultisample},set(t){qt.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return es.defaultMaxTextures},set(t){Le("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),es.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return es.defaultBatchSize},set(t){Le("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),es.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return es.canUploadSameBuffer},set(t){Le("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),es.canUploadSameBuffer=t}},GC_MODE:{get(){return ts.defaultMode},set(t){Le("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ts.defaultMode=t}},GC_MAX_IDLE:{get(){return ts.defaultMaxIdle},set(t){Le("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ts.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return ts.defaultCheckCountMax},set(t){Le("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ts.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Fn.defaultVertexPrecision},set(t){Le("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Fn.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Fn.defaultFragmentPrecision},set(t){Le("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Fn.defaultFragmentPrecision=t}}});var bs=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(bs||{});class yp{constructor(e,r=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=n,this.once=i}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const hE=class hr{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new yp(null,null,1/0),this.deltaMS=1/hr.targetFPMS,this.elapsedMS=1/hr.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=bs.NORMAL){return this._addListener(new yp(e,r,n))}addOnce(e,r,n=bs.NORMAL){return this._addListener(new yp(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*hr.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,hr.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!hr._shared){const e=hr._shared=new hr;e.autoStart=!0,e._protected=!0}return hr._shared}static get system(){if(!hr._system){const e=hr._system=new hr;e.autoStart=!0,e._protected=!0}return hr._system}};hE.targetFPMS=.06;let mr=hE;Object.defineProperties(re,{TARGET_FPMS:{get(){return mr.targetFPMS},set(t){Le("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),mr.targetFPMS=t}}});class pE{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,bs.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?mr.shared:new mr,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}pE.extension=Q.Application;ue.add(pE);const fE=[];ue.handleByList(Q.Renderer,fE);function LN(t){for(const e of fE)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var FN=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ON=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const UN=FN,mE=ON;class gE{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}r>=yt.HIGH?this.multisample=yt.HIGH:r>=yt.MEDIUM?this.multisample=yt.MEDIUM:r>=yt.LOW?this.multisample=yt.LOW:this.multisample=yt.NONE}destroy(){}}gE.extension={type:Q.RendererSystem,name:"_multisample"};ue.add(gE);class zN{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class xE{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);r.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[r]=e,n.bindBufferBase(n.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,n){const{gl:i,CONTEXT_UID:s}=this;n=n||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,o.buffer,n*256,256)}update(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{const s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),n&&(r||i.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const r=Object.keys(this.managedBuffers);for(let n=0;n<r.length;n++)this.dispose(this.managedBuffers[r[n]],e)}createGLBuffer(e){const{CONTEXT_UID:r,gl:n}=this;return e._glBuffers[r]=new zN(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}}xE.extension={type:Q.RendererSystem,name:"buffer"};ue.add(xE);class yE{constructor(e){this.renderer=e}render(e,r){const n=this.renderer;let i,s,o,l;if(r&&(i=r.renderTexture,s=r.clear,o=r.transform,l=r.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=o,!n.context.isLost){if(i||(this.lastObjectRendered=e),!l){const c=e.enableTempParent();e.updateTransform(),e.disableTempParent(c)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(s??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),i&&(r.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}yE.extension={type:Q.RendererSystem,name:"objectRenderer"};ue.add(yE);const fd=class fm extends NN{constructor(e){super(),this.type=Qw.WEBGL,e=Object.assign({},re.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Jr({projectionMatrix:new Qe},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:fm.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in e&&(Le("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=fm.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:dM()}render(e,r){this.objectRenderer.render(e,r)}resize(e,r){this._view.resizeView(e,r)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Le("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Le("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Le("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Le("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Le("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Le("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Le("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Le("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,r){return this.textureGenerator.generateTexture(e,r)}};fd.extension={type:Q.Renderer,priority:1},fd.__plugins={},fd.__systems={};let ax=fd;ue.handleByMap(Q.RendererPlugin,ax.__plugins);ue.handleByMap(Q.RendererSystem,ax.__systems);ue.add(ax);class vE extends Cl{constructor(e,r){const{width:n,height:i}=r||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new Ee;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof Cl?this.addResourceAt(e[n],n):this.addResourceAt(LS(e[n],r),n))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(e).then(()=>{const{realWidth:r,realHeight:n}=this.items[0];return this.resize(r,n),this.update(),Promise.resolve(this)}),this._load}}class $N extends vE{constructor(e,r){const{width:n,height:i}=r||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:n,height:i}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=_o.TEXTURE_2D_ARRAY}upload(e,r,n){const{length:i,itemDirtyIds:s,items:o}=this,{gl:l}=e;n.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,r.format,n.type,null);for(let c=0;c<i;c++){const d=o[c];s[c]<d.dirtyId&&(s[c]=d.dirtyId,d.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,c,d.resource.width,d.resource.height,1,r.format,n.type,d.resource.source))}return!0}}class GN extends Yn{constructor(e){super(e)}static test(e){const{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const _E=class Na extends vE{constructor(e,r){const{width:n,height:i,autoLoad:s,linkBaseTexture:o}=r||{};if(e&&e.length!==Na.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:n,height:i});for(let l=0;l<Na.SIDES;l++)this.items[l].target=_o.TEXTURE_CUBE_MAP_POSITIVE_X+l;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,r),s!==!1&&this.load()}bind(e){super.bind(e),e.target=_o.TEXTURE_CUBE_MAP}addBaseTextureAt(e,r,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[r])throw new Error(`Index ${r} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=_o.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this}upload(e,r,n){const i=this.itemDirtyIds;for(let s=0;s<Na.SIDES;s++){const o=this.items[s];(i[s]<o.dirtyId||n.dirtyId<r.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Na.SIDES}};_E.SIDES=6;let HN=_E;class ho extends Yn{constructor(e,r){r=r||{};let n,i,s;typeof e=="string"?(n=ho.EMPTY,i=e,s=!0):(n=e,i=null,s=!1),super(n),this.url=i,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.ownsImageBitmap=r.ownsImageBitmap??s,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{const n=await re.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===nr.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(n){if(this.destroyed)return;r(n),this.onError.emit(n)}}),this._load)}upload(e,r,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return ho._EMPTY=ho._EMPTY??re.ADAPTER.createCanvas(0,0),ho._EMPTY}}const mm=class md extends Yn{constructor(e,r){r=r||{},super(re.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},md.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;Yn.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=r=>{this._resolve&&(e.onerror=null,this.onError.emit(r))},e.onload=()=>{if(!this._resolve)return;const r=e.width,n=e.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=r*this.scale,s=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/n*r,s=this._overrideHeight||this._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);const o=this.source;o.width=i,o.height=s,o._pixiId=`canvas_${_s()}`,o.getContext("2d").drawImage(e,0,0,r,n,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){const r=md.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,r){return r==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&md.SVG_XML.test(e)}};mm.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,mm.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let gm=mm;class WN extends Yn{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const xm=class ym extends Yn{constructor(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){const n=document.createElement("video");r.autoLoad!==!1&&n.setAttribute("preload","auto"),r.playsinline!==!1&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),r.muted===!0&&(n.setAttribute("muted",""),n.muted=!0),r.loop===!0&&n.setAttribute("loop",""),r.autoPlay!==!1&&n.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];Yn.crossOrigin(n,i,r.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:l,mime:c}=e[s];if(l=l||e[s],l.startsWith("data:"))c=l.slice(5,l.indexOf(";"));else if(!l.startsWith("blob:")){const d=l.split("?").shift().toLowerCase(),u=d.slice(d.lastIndexOf(".")+1);c=c||ym.MIME_TYPES[u]||`video/${u}`}o.src=l,c&&(o.type=c),n.appendChild(o)}e=n}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=r.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),r.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const r=mr.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((r,n)=>{this.valid?r(this):(this._resolve=r,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const r=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!r&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(mr.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(mr.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(mr.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,r){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||ym.TYPES.includes(r)}};xm.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],xm.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let bE=xm;im.push(ho,VS,GN,bE,WN,gm,Gu,HN,$N);class lu{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Ae.EMPTY:(e=e||new Ae(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){const{a:n,b:i,c:s,d:o,tx:l,ty:c}=e,d=n*r.x+s*r.y+l,u=i*r.x+o*r.y+c;this.minX=Math.min(this.minX,d),this.maxX=Math.max(this.maxX,d),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(e){let r=this.minX,n=this.minY,i=this.maxX,s=this.maxY,o=e[0],l=e[1];r=o<r?o:r,n=l<n?l:n,i=o>i?o:i,s=l>s?l:s,o=e[2],l=e[3],r=o<r?o:r,n=l<n?l:n,i=o>i?o:i,s=l>s?l:s,o=e[4],l=e[5],r=o<r?o:r,n=l<n?l:n,i=o>i?o:i,s=l>s?l:s,o=e[6],l=e[7],r=o<r?o:r,n=l<n?l:n,i=o>i?o:i,s=l>s?l:s,this.minX=r,this.minY=n,this.maxX=i,this.maxY=s}addFrame(e,r,n,i,s){this.addFrameMatrix(e.worldTransform,r,n,i,s)}addFrameMatrix(e,r,n,i,s){const o=e.a,l=e.b,c=e.c,d=e.d,u=e.tx,h=e.ty;let p=this.minX,f=this.minY,m=this.maxX,_=this.maxY,y=o*r+c*n+u,x=l*r+d*n+h;p=y<p?y:p,f=x<f?x:f,m=y>m?y:m,_=x>_?x:_,y=o*i+c*n+u,x=l*i+d*n+h,p=y<p?y:p,f=x<f?x:f,m=y>m?y:m,_=x>_?x:_,y=o*r+c*s+u,x=l*r+d*s+h,p=y<p?y:p,f=x<f?x:f,m=y>m?y:m,_=x>_?x:_,y=o*i+c*s+u,x=l*i+d*s+h,p=y<p?y:p,f=x<f?x:f,m=y>m?y:m,_=x>_?x:_,this.minX=p,this.minY=f,this.maxX=m,this.maxY=_}addVertexData(e,r,n){let i=this.minX,s=this.minY,o=this.maxX,l=this.maxY;for(let c=r;c<n;c+=2){const d=e[c],u=e[c+1];i=d<i?d:i,s=u<s?u:s,o=d>o?d:o,l=u>l?u:l}this.minX=i,this.minY=s,this.maxX=o,this.maxY=l}addVertices(e,r,n,i){this.addVerticesMatrix(e.worldTransform,r,n,i)}addVerticesMatrix(e,r,n,i,s=0,o=s){const l=e.a,c=e.b,d=e.c,u=e.d,h=e.tx,p=e.ty;let f=this.minX,m=this.minY,_=this.maxX,y=this.maxY;for(let x=n;x<i;x+=2){const v=r[x],g=r[x+1],b=l*v+d*g+h,S=u*g+c*v+p;f=Math.min(f,b-s),_=Math.max(_,b+s),m=Math.min(m,S-o),y=Math.max(y,S+o)}this.minX=f,this.minY=m,this.maxX=_,this.maxY=y}addBounds(e){const r=this.minX,n=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,r){const n=e.minX>r.minX?e.minX:r.minX,i=e.minY>r.minY?e.minY:r.minY,s=e.maxX<r.maxX?e.maxX:r.maxX,o=e.maxY<r.maxY?e.maxY:r.maxY;if(n<=s&&i<=o){const l=this.minX,c=this.minY,d=this.maxX,u=this.maxY;this.minX=n<l?n:l,this.minY=i<c?i:c,this.maxX=s>d?s:d,this.maxY=o>u?o:u}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){const n=e.minX>r.x?e.minX:r.x,i=e.minY>r.y?e.minY:r.y,s=e.maxX<r.x+r.width?e.maxX:r.x+r.width,o=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(n<=s&&i<=o){const l=this.minX,c=this.minY,d=this.maxX,u=this.maxY;this.minX=n<l?n:l,this.minY=i<c?i:c,this.maxX=s>d?s:d,this.maxY=o>u?o:u}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,n,i,s,o){e-=s,r-=o,n+=s,i+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class lt extends Ll{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new sx,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new lu,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.defineProperty(lt.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new Ae),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Ae),e=this._localBoundsRect),this._localBounds||(this._localBounds=new lu);const r=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(n==null?void 0:n.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=n,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,n,i){return r&&(e=r.toGlobal(e,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,r=0,n=1,i=1,s=0,o=0,l=0,c=0,d=0){return this.position.x=e,this.position.y=r,this.scale.x=n||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=l,this.pivot.x=c,this.pivot.y=d,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new VN),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*FM}set angle(e){this.transform.rotation=e*OM}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class VN extends lt{constructor(){super(...arguments),this.sortDirty=null}}lt.prototype.displayObjectUpdateTransform=lt.prototype.updateTransform;const XN=new Qe;function YN(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const wE=class vm extends lt{constructor(){super(),this.children=[],this.sortableChildren=vm.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.addChild(e[r]);else{const r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]}addChildAt(e,r){if(r<0||r>this.children.length)throw new Error(`${e}addChildAt: The index ${r} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e}swapChildren(e,r){if(e===r)return;const n=this.getChildIndex(e),i=this.getChildIndex(r);this.children[n]=r,this.children[i]=e,this.onChildrenChange(n<i?n:i)}getChildIndex(e){const r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r}setChildIndex(e,r){if(r<0||r>=this.children.length)throw new Error(`The index ${r} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(e);So(this.children,n,1),this.children.splice(r,0,e),this.onChildrenChange(r)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.removeChild(e[r]);else{const r=e[0],n=this.children.indexOf(r);if(n===-1)return null;r.parent=null,r.transform._parentID=-1,So(this.children,n,1),this._boundsID++,this.onChildrenChange(n),r.emit("removed",this),this.emit("childRemoved",r,this,n)}return e[0]}removeChildAt(e){const r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,So(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r}removeChildren(e=0,r=this.children.length){const n=e,i=r,s=i-n;let o;if(s>0&&s<=i){o=this.children.splice(n,s);for(let l=0;l<o.length;++l)o[l].parent=null,o[l].transform&&(o[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let l=0;l<o.length;++l)o[l].emit("removed",this),this.emit("childRemoved",o[l],this,l);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let r=0,n=this.children.length;r<n;++r){const i=this.children[r];i._lastSortedIndex=r,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(YN),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,r=this.children.length;e<r;++e){const n=this.children[e];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const r=this.children[e];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){const n=r._mask.isMaskData?r._mask.maskObject:r._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,r=!1){const n=super.getLocalBounds(e);if(!r)for(let i=0,s=this.children.length;i<s;++i){const o=this.children[i];o.visible&&o.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const r=e.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==vm.prototype._render&&(n=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=XN.copyFrom(i),i.prepend(s)):i=s),n&&r.intersects(n,i))this._render(e);else if(this.cullArea)return;for(let o=0,l=this.children.length;o<l;++o){const c=this.children[o],d=c.cullable;c.cullable=d||!this.cullArea,c.render(e),c.cullable=d}}render(e){var r;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(r=this.filters)!=null&&r.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,i=this.children.length;n<i;++n)this.children[n].render(e)}}renderAdvanced(e){var s,o,l;const r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let c=0;c<r.length;c++)r[c].enabled&&this._enabledFilters.push(r[c])}const i=r&&((s=this._enabledFilters)==null?void 0:s.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==Et.NONE));if(i&&e.batch.flush(),r&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let c=0,d=this.children.length;c<d;++c)this.children[c].render(e)}i&&e.batch.flush(),n&&e.mask.pop(this),r&&((l=this._enabledFilters)!=null&&l.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const r=typeof e=="boolean"?e:e==null?void 0:e.children,n=this.removeChildren(0,this.children.length);if(r)for(let i=0;i<n.length;++i)n[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const r=this.getLocalBounds().width;r!==0?this.scale.x=e/r:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const r=this.getLocalBounds().height;r!==0?this.scale.y=e/r:this.scale.y=1,this._height=e}};wE.defaultSortableChildren=!1;let lr=wE;lr.prototype.containerUpdateTransform=lr.prototype.updateTransform;Object.defineProperties(re,{SORTABLE_CHILDREN:{get(){return lr.defaultSortableChildren},set(t){Le("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),lr.defaultSortableChildren=t}}});const Ta=new Ue,KN=new Uint16Array([0,1,2,0,2,3]);class ji extends lr{constructor(e){super(),this._anchor=new Ln(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new qe(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=be.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||de.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=KN,this.pluginName="batch",this.isSprite=!0,this._roundPixels=re.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=gi(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=gi(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,l=r.tx,c=r.ty,d=this.vertexData,u=e.trim,h=e.orig,p=this._anchor;let f=0,m=0,_=0,y=0;if(u?(m=u.x-p._x*h.width,f=m+u.width,y=u.y-p._y*h.height,_=y+u.height):(m=-p._x*h.width,f=m+h.width,y=-p._y*h.height,_=y+h.height),d[0]=n*m+s*y+l,d[1]=o*y+i*m+c,d[2]=n*f+s*y+l,d[3]=o*y+i*f+c,d[4]=n*f+s*_+l,d[5]=o*_+i*f+c,d[6]=n*m+s*_+l,d[7]=o*_+i*m+c,this._roundPixels){const x=re.RESOLUTION;for(let v=0;v<d.length;++v)d[v]=Math.round(d[v]*x)/x}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,r=this.vertexTrimmedData,n=e.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,l=s.b,c=s.c,d=s.d,u=s.tx,h=s.ty,p=-i._x*n.width,f=p+n.width,m=-i._y*n.height,_=m+n.height;if(r[0]=o*p+c*m+u,r[1]=d*m+l*p+h,r[2]=o*f+c*m+u,r[3]=d*m+l*f+h,r[4]=o*f+c*_+u,r[5]=d*_+l*f+h,r[6]=o*p+c*_+u,r[7]=d*_+l*p+h,this._roundPixels){const y=re.RESOLUTION;for(let x=0;x<r.length;++x)r[x]=Math.round(r[x]*y)/y}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new lu),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Ae),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Ta);const r=this._texture.orig.width,n=this._texture.orig.height,i=-r*this.anchor.x;let s=0;return Ta.x>=i&&Ta.x<i+r&&(s=-n*this.anchor.y,Ta.y>=s&&Ta.y<s+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const r=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(e,r){const n=e instanceof de?e:de.from(e,r);return new ji(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const r=gi(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const r=gi(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||de.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const SE=new Qe;lt.prototype._cacheAsBitmap=!1;lt.prototype._cacheData=null;lt.prototype._cacheAsBitmapResolution=null;lt.prototype._cacheAsBitmapMultisample=null;class qN{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(lt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new qN),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});lt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};lt.prototype._initCachedDisplayObject=function(t){var p,f;if((p=this._cacheData)!=null&&p.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(new Ae,!0);if((f=this.filters)!=null&&f.length){const m=this.filters[0].padding;r.pad(m)}const n=this.cacheAsBitmapResolution||t.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),l=t.projection.transform,c=Rs.create({width:r.width,height:r.height,resolution:n,multisample:this.cacheAsBitmapMultisample??t.multisample}),d=`cacheAsBitmap_${_s()}`;this._cacheData.textureCacheId=d,Ee.addToCache(c.baseTexture,d),de.addToCache(c,d);const u=this.transform.localTransform.copyTo(SE).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:u,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=l,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const h=new ji(c);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(r.x/r.width),h.anchor.y=-(r.y/r.height),h.alpha=e,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h)};lt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};lt.prototype._initCachedDisplayObjectCanvas=function(t){var u;if((u=this._cacheData)!=null&&u.sprite)return;const e=this.getLocalBounds(new Ae,!0),r=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Rs.create({width:e.width,height:e.height,resolution:s}),l=`cacheAsBitmap_${_s()}`;this._cacheData.textureCacheId=l,Ee.addToCache(o.baseTexture,l),de.addToCache(o,l);const c=SE;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=e.x,c.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:c,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const d=new ji(o);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(e.x/e.width),d.anchor.y=-(e.y/e.height),d.alpha=r,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=d.containsPoint.bind(d)};lt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};lt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};lt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Ee.removeFromCache(this._cacheData.textureCacheId),de.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};lt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};lt.prototype.name=null;lr.prototype.getChildByName=function(t,e){for(let r=0,n=this.children.length;r<n;r++)if(this.children[r].name===t)return this.children[r];if(e)for(let r=0,n=this.children.length;r<n;r++){const i=this.children[r];if(!i.getChildByName)continue;const s=i.getChildByName(t,!0);if(s)return s}return null};lt.prototype.getGlobalPosition=function(t=new Ue,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var ZN=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class JN extends qt{constructor(e=1){super(UN,ZN,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const QN={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},eB=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function tB(t){const e=QN[t],r=e.length;let n=eB,i="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let l=0;l<t;l++){let c=s.replace("%index%",l.toString());o=l,l>=r&&(o=t-l-1),c=c.replace("%value%",e[o].toString()),i+=c,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}const rB=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function nB(t,e){const r=Math.ceil(t/2);let n=rB,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let l=s.replace("%index%",o.toString());l=l.replace("%sampleIndex%",`${o-(r-1)}.0`),i+=l,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}class _m extends qt{constructor(e,r=8,n=4,i=qt.defaultResolution,s=5){const o=nB(s,e),l=tB(s);super(o,l),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=n,this.blur=r}apply(e,r,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,n,i);else{const s=e.getFilterTexture(),o=e.renderer;let l=r,c=s;this.state.blend=!1,e.applyFilter(this,l,c,pn.CLEAR);for(let d=1;d<this.passes-1;d++){e.bindAndClear(l,pn.BLIT),this.uniforms.uSampler=c;const u=c;c=l,l=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,c,n,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class iB extends qt{constructor(e=8,r=4,n=qt.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new _m(!0,e,r,n,i),this.blurYFilter=new _m(!1,e,r,n,i),this.resolution=n,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,n,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const l=e.getFilterTexture();this.blurXFilter.apply(e,r,l,pn.CLEAR),this.blurYFilter.apply(e,l,n,i),e.returnFilterTexture(l)}else o?this.blurYFilter.apply(e,r,n,i):this.blurXFilter.apply(e,r,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var sB=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class bm extends qt{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(mE,sB,e),this.alpha=1}_loadMatrix(e,r=!1){let n=e;r&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,r,n){return e[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],e[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],e[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],e[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],e[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],e[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],e[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],e[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],e[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],e[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],e[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],e[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],e[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],e[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],e[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],e[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],e[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],e[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],e[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],e[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],e}_colorMatrix(e){const r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(e,r){const[n,i,s]=qe.shared.setValue(e).toArray(),o=[n,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(e,r){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(e){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;const n=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,l=s(o),c=n+(1-n)*o,d=o*(1-n)-l*i,u=o*(1-n)+l*i,h=o*(1-n)+l*i,p=n+o*(1-n),f=o*(1-n)-l*i,m=o*(1-n)-l*i,_=o*(1-n)+l*i,y=n+o*(1-n),x=[c,d,u,0,0,h,p,f,0,0,m,_,y,0,0,0,0,0,1,0];this._loadMatrix(x,r)}contrast(e,r){const n=(e||0)+1,i=-.5*(n-1),s=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(s,r)}saturate(e=0,r){const n=e*2/3+1,i=(n-1)*-.5,s=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(e){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,n,i,s){e=e||.2,r=r||.15,n=n||16770432,i=i||3375104;const o=qe.shared,[l,c,d]=o.setValue(n).toArray(),[u,h,p]=o.setValue(i).toArray(),f=[.3,.59,.11,0,0,l,c,d,e,0,u,h,p,r,0,l-u,c-h,d-p,0,0];this._loadMatrix(f,s)}night(e,r){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(e,r){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,r)}lsd(e){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}bm.prototype.grayscale=bm.prototype.greyscale;var oB=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,aB=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class lB extends qt{constructor(e,r){const n=new Qe;e.renderable=!1,super(aB,oB,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,r==null&&(r=20),this.scale=new Ue(r,r)}apply(e,r,n,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),l=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&l!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/l,this.uniforms.rotation[3]=s.d/l),e.applyFilter(this,r,n,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var cB=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,dB=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class uB extends qt{constructor(){super(dB,cB)}}var hB=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class pB extends qt{constructor(e=.5,r=Math.random()){super(mE,hB,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const Dv={AlphaFilter:JN,BlurFilter:iB,BlurFilterPass:_m,ColorMatrixFilter:bm,DisplacementFilter:lB,FXAAFilter:uB,NoiseFilter:pB};Object.entries(Dv).forEach(([t,e])=>{Object.defineProperty(Dv,t,{get(){return Le("7.1.0",`filters.${t} has moved to ${t}`),e}})});class fB{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(mr.system.add(this.tickerUpdate,this,bs.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(mr.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const di=new fB;class zl{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=zl.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Ue,this.page=new Ue,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,n,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class cu extends zl{constructor(){super(...arguments),this.client=new Ue,this.movement=new Ue,this.offset=new Ue,this.global=new Ue,this.screen=new Ue}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,r,n){return e.worldTransform.applyInverse(n||this.global,r)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,n,i,s,o,l,c,d,u,h,p,f,m,_){throw new Error("Method not implemented.")}}class Hr extends cu{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class To extends cu{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}To.DOM_DELTA_PIXEL=0,To.DOM_DELTA_LINE=1,To.DOM_DELTA_PAGE=2;const mB=2048,gB=new Ue,vp=new Ue;class xB{constructor(e){this.dispatch=new Ll,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const r=this.mappingTable[e.type];if(r)for(let n=0,i=r.length;n<i;n++)r[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){di.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[n](this.rootTarget,this.rootTarget.eventMode,gB.set(e,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,r){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=n.length-1;i<s;i++)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(r)?r:[r];for(let s=n.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=n[s],this.notifyTarget(e,o)})}propagationPath(e){const r=[e];for(let n=0;n<mB&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestMoveRecursive(e,r,n,i,s,o=!1){let l=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(di.pauseUpdate=!1),e.interactiveChildren&&e.children){const u=e.children;for(let h=u.length-1;h>=0;h--){const p=u[h],f=this.hitTestMoveRecursive(p,this._isInteractive(r)?r:p.eventMode,n,i,s,o||s(e,n));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const m=e.isInteractive();(f.length>0||m)&&(m&&this._allInteractiveElements.push(e),f.push(e)),this._hitElements.length===0&&(this._hitElements=f),l=!0}}}const c=this._isInteractive(r),d=e.isInteractive();return c&&d&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:l?this._hitElements:c&&!s(e,n)&&i(e,n)?d?[e]:[]:null}hitTestRecursive(e,r,n,i,s){if(this._interactivePrune(e)||s(e,n))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(di.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let d=c.length-1;d>=0;d--){const u=c[d],h=this.hitTestRecursive(u,this._isInteractive(r)?r:u.eventMode,n,i,s);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const p=e.isInteractive();return(h.length>0||p)&&h.push(e),h}}}const o=this._isInteractive(r),l=e.isInteractive();return o&&i(e,n)?l?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,r){var n;if(e.hitArea&&(e.worldTransform.applyInverse(r,vp),!e.hitArea.contains(vp.x,vp.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,r)))return!0}return!1}hitTestFn(e,r){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){var s,o;r=r??e.type;const n=`on${r}`;(o=(s=e.currentTarget)[n])==null||o.call(s,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof Hr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){var c,d;if(!(e instanceof Hr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(((c=i.overTargets)==null?void 0:c.length)>0&&s!==r.target){const u=e.type==="mousemove"?"mouseout":"pointerout",h=this.createPointerEvent(e,u,s);if(this.dispatchEvent(h,"pointerout"),n&&this.dispatchEvent(h,"mouseout"),!r.composedPath().includes(s)){const p=this.createPointerEvent(e,"pointerleave",s);for(p.eventPhase=p.AT_TARGET;p.target&&!r.composedPath().includes(p.target);)p.currentTarget=p.target,this.notifyTarget(p),n&&this.notifyTarget(p,"mouseleave"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(h)}if(s!==r.target){const u=e.type==="mousemove"?"mouseover":"pointerover",h=this.clonePointerEvent(r,u);this.dispatchEvent(h,"pointerover"),n&&this.dispatchEvent(h,"mouseover");let p=s==null?void 0:s.parent;for(;p&&p!==this.rootTarget.parent&&p!==r.target;)p=p.parent;if(!p||p===this.rootTarget.parent){const f=this.clonePointerEvent(r,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==s&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),n&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(h)}const o=[],l=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),l&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),l&&o.push("globaltouchmove")),n&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),l&&o.push("globalmousemove"),this.cursor=(d=r.target)==null?void 0:d.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){var o;if(!(e instanceof Hr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(o=n.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(n,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof Hr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId);if(r.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),n&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Hr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.dispatchEvent(n,l?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!n.composedPath().includes(s)){let l=s;for(;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const c=n.button===2;this.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}l=l.parent}delete i.pressTargetsByButton[e.button],o=l}if(o){const l=this.clonePointerEvent(n,"click");l.target=o,l.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:l.target,timeStamp:r});const c=i.clicksByButton[e.button];if(c.target===l.target&&r-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=l.target,c.timeStamp=r,l.detail=c.clickCount,l.pointerType==="mouse"){const d=l.button===2;this.dispatchEvent(l,d?"rightclick":"click")}else l.pointerType==="touch"&&this.dispatchEvent(l,"tap");this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof Hr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let s=n;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof To)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let n=1;n<e.length&&e[n].parent===r;n++)r=e[n];return r}createPointerEvent(e,r,n){const i=this.allocateEvent(Hr);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof r=="string"&&(i.type=r),i}createWheelEvent(e){const r=this.allocateEvent(To);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){const n=this.allocateEvent(Hr);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=r??n.type,n}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof Hr&&r instanceof Hr&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof cu&&r instanceof cu&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.shiftKey=e.shiftKey,r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){const n=e.currentTarget._events[r];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(r,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let i=0,s=n.length;i<s&&!e.propagationImmediatelyStopped;i++)n[i].once&&e.currentTarget.removeListener(r,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,e)}}const yB=1,vB={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},wm=class Sm{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new xB(null),di.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Hr(null),this.rootWheelEvent=new To(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Sm.defaultEventFeatures},{set:(r,n,i)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),r[n]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,Sm._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=r.length;n<i;n++){const s=r[n],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,di.pointerMoved();const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let r=e.target;e.composedPath&&e.composedPath().length>0&&(r=e.composedPath()[0]);const n=r!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const l=this.bootstrapEvent(this.rootPointerEvent,i[s]);l.type+=n,this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const r=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(e){this.removeEvents(),this.domElement=e,di.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;di.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;di.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,r,n){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(r-i.left)*(this.domElement.width/i.width)*s,e.y=(n-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){const r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const s=e.changedTouches[n];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,r.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=yB),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(e);return r}normalizeWheelEvent(e){const r=this.rootWheelEvent;return this.transferMouseData(r,e),r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ,r.deltaMode=e.deltaMode,this.mapPositionToPoint(r.screen,e.clientX,e.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=e,r.type=e.type,r}bootstrapEvent(e,r){return e.originalEvent=null,e.nativeEvent=r,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r),this.mapPositionToPoint(e.screen,r.clientX,r.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=r.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=vB[e.type]||e.type),e}transferMouseData(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=performance.now(),e.type=r.type,e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.relatedTarget=null,e.shiftKey=r.shiftKey}};wm.extension={name:"events",type:[Q.RendererSystem,Q.CanvasRendererSystem]},wm.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Em=wm;ue.add(Em);function Lv(t){return t==="dynamic"||t==="static"}const _B={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Lv(Em.defaultEventMode)},set interactive(t){Le("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Em.defaultEventMode},set eventMode(t){this._internalInteractive=Lv(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof r=="object"?r.signal:void 0,s=typeof r=="object"?r.once===!0:!1,o=typeof e=="function"?void 0:e;t=n?`${t}capture`:t;const l=typeof e=="function"?e:e.handleEvent,c=this;i&&i.addEventListener("abort",()=>{c.off(t,l,o)}),s?c.once(t,l,o):c.on(t,l,o)},removeEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof zl))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};lt.mixin(_B);const bB={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};lt.mixin(bB);const wB=9,jc=100,SB=0,EB=0,Fv=2,Ov=1,TB=-1e3,CB=-1e3,AB=2;class EE{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Dn.tablet||Dn.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${jc}px`,r.style.height=`${jc}px`,r.style.position="absolute",r.style.top=`${SB}px`,r.style.left=`${EB}px`,r.style.zIndex=Fv.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${Ov}px`,e.style.height=`${Ov}px`,e.style.position="absolute",e.style.top=`${TB}px`,e.style.left=`${CB}px`,e.style.zIndex=AB.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const r=e.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const e=performance.now();if(Dn.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:l,resolution:c}=this.renderer,d=i/o*c,u=s/l*c;let h=this.div;h.style.left=`${r}px`,h.style.top=`${n}px`,h.style.width=`${o}px`,h.style.height=`${l}px`;for(let p=0;p<this.children.length;p++){const f=this.children[p];if(f.renderId!==this.renderId)f._accessibleActive=!1,So(this.children,p,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,p--;else{h=f._accessibleDiv;let m=f.hitArea;const _=f.worldTransform;f.hitArea?(h.style.left=`${(_.tx+m.x*_.a)*d}px`,h.style.top=`${(_.ty+m.y*_.d)*u}px`,h.style.width=`${m.width*_.a*d}px`,h.style.height=`${m.height*_.d*u}px`):(m=f.getBounds(),this.capHitArea(m),h.style.left=`${m.x*d}px`,h.style.top=`${m.y*u}px`,h.style.width=`${m.width*d}px`,h.style.height=`${m.height*u}px`,h.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(h.title=f.accessibleTitle),h.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&h.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==h.title||f.tabIndex!==h.tabIndex)&&(h.title=f.accessibleTitle,h.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:r,height:n}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${jc}px`,r.style.height=`${jc}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=Fv.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){const{displayObject:n}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new zl(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===wB&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}EE.extension={name:"accessibility",type:[Q.RendererPlugin,Q.CanvasRendererPlugin]};ue.add(EE);const TE=class Tm{constructor(e){this.stage=new lr,e=Object.assign({forceCanvas:!1},e),this.renderer=LN(e),Tm._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,r){const n=Tm._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};TE._plugins=[];let CE=TE;ue.handleByList(Q.Application,CE._plugins);class AE{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;r=i,n=s}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}AE.extension=Q.Application;ue.add(AE);const Uv={loader:Q.LoadParser,resolver:Q.ResolveParser,cache:Q.CacheParser,detection:Q.DetectionParser};ue.handle(Q.Asset,t=>{const e=t.ref;Object.entries(Uv).filter(([r])=>!!e[r]).forEach(([r,n])=>ue.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(Uv).filter(r=>!!e[r]).forEach(r=>ue.remove(e[r]))});class kB{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Zo(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function zi(t,e){const r=t.split("?")[0],n=jt.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const Yr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t),Cm=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t};function kE(t,e,r,n,i){const s=e[r];for(let o=0;o<s.length;o++){const l=s[o];r<e.length-1?kE(t.replace(n[r],l),e,r+1,n,i):i.push(t.replace(n[r],l))}}function IB(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const i=[];r.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),kE(t,i,0,r,n)}else n.push(t);return n}const du=t=>!Array.isArray(t);class RB{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=Yr(e);let i;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(r)){i=c.getCacheableAssets(n,r);break}}i||(i={},n.forEach(l=>{i[l]=r}));const s=Object.keys(i),o={cacheKeys:s,keys:n};if(n.forEach(l=>{this._cacheMap.set(l,o)}),s.forEach(l=>{const c=i?i[l]:r;this._cache.has(l)&&this._cache.get(l)!==c&&console.warn("[Cache] already has key:",l),this._cache.set(l,i[l])}),r instanceof de){const l=r;n.forEach(c=>{l.baseTexture!==de.EMPTY.baseTexture&&Ee.addToCache(l.baseTexture,c),de.addToCache(l,c)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const ns=new RB;class PB{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{var o,l;let i=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!s){for(let c=0;c<this.parsers.length;c++){const d=this.parsers[c];if(d.load&&((o=d.test)!=null&&o.call(d,e,r,this))){s=d;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,r,this),n.parser=s;for(let c=0;c<this.parsers.length;c++){const d=this.parsers[c];d.parse&&d.parse&&await((l=d.testParse)==null?void 0:l.call(d,i,r,this))&&(i=await d.parse(i,r,this)||i,n.parser=d)}return i})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const i={},s=du(e),o=Yr(e,d=>({alias:[d],src:d})),l=o.length,c=o.map(async d=>{const u=jt.toAbsolute(d.src);if(!i[d.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,d)),i[d.src]=await this.promiseCache[u].promise,r&&r(++n/l)}catch(h){throw delete this.promiseCache[u],delete i[d.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(c),s?i[o[0].src]:i}async unload(e){const r=Yr(e,n=>({alias:[n],src:n})).map(async n=>{var o,l;const i=jt.toAbsolute(n.src),s=this.promiseCache[i];if(s){const c=await s.promise;delete this.promiseCache[i],(l=(o=s.parser)==null?void 0:o.unload)==null||l.call(o,c,n,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(e[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...e,[r.name]:r}),{})}}var tn=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(tn||{});const jB=".json",MB="application/json",NB={extension:{type:Q.LoadParser,priority:tn.Low},name:"loadJson",test(t){return Zo(t,MB)||zi(t,jB)},async load(t){return await(await re.ADAPTER.fetch(t)).json()}};ue.add(NB);const BB=".txt",DB="text/plain",LB={name:"loadTxt",extension:{type:Q.LoadParser,priority:tn.Low},test(t){return Zo(t,DB)||zi(t,BB)},async load(t){return await(await re.ADAPTER.fetch(t)).text()}};ue.add(LB);const FB=["normal","bold","100","200","300","400","500","600","700","800","900"],OB=[".ttf",".otf",".woff",".woff2"],UB=["font/ttf","font/otf","font/woff","font/woff2"],zB=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function $B(t){const e=jt.extname(t),r=jt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let n=r.length>0;for(const s of r)if(!s.match(zB)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const GB=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function HB(t){return GB.test(t)?t:encodeURI(t)}const WB={extension:{type:Q.LoadParser,priority:tn.Low},name:"loadWebFont",test(t){return Zo(t,UB)||zi(t,OB)},async load(t,e){var n,i,s;const r=re.ADAPTER.getFontFaceSet();if(r){const o=[],l=((n=e.data)==null?void 0:n.family)??$B(t),c=((s=(i=e.data)==null?void 0:i.weights)==null?void 0:s.filter(u=>FB.includes(u)))??["normal"],d=e.data??{};for(let u=0;u<c.length;u++){const h=c[u],p=new FontFace(l,`url(${HB(t)})`,{...d,weight:h});await p.load(),r.add(p),o.push(p)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>re.ADAPTER.getFontFaceSet().delete(e))}};ue.add(WB);const VB=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Co=null,Am=class{constructor(){Co||(Co=URL.createObjectURL(new Blob([VB],{type:"application/javascript"}))),this.worker=new Worker(Co)}};Am.revokeObjectURL=function(){Co&&(URL.revokeObjectURL(Co),Co=null)};const XB=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Ao=null;class IE{constructor(){Ao||(Ao=URL.createObjectURL(new Blob([XB],{type:"application/javascript"}))),this.worker=new Worker(Ao)}}IE.revokeObjectURL=function(){Ao&&(URL.revokeObjectURL(Ao),Ao=null)};let zv=0,_p;class YB{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new Am;r.addEventListener("message",n=>{r.terminate(),Am.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){_p===void 0&&(_p=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<_p&&(this._createdWorkers++,e=new IE().worker,e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((i,s)=>{this.queue.push({id:e,arguments:r,resolve:i,reject:s})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const r=this.queue.pop(),n=r.id;this.resolveHash[zv]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:zv++,id:n})}}const $v=new YB;function $l(t,e,r){t.resource.internal=!0;const n=new de(t),i=()=>{delete e.promiseCache[r],ns.has(r)&&ns.remove(r)};return n.baseTexture.once("destroyed",()=>{r in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),n.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const KB=[".jpeg",".jpg",".png",".webp",".avif"],qB=["image/jpeg","image/png","image/webp","image/avif"];async function ZB(t){const e=await re.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}const Yu={name:"loadTextures",extension:{type:Q.LoadParser,priority:tn.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Zo(t,qB)||zi(t,KB)},async load(t,e,r){var l;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;n?this.config.preferWorkers&&await $v.isImageBitmapSupported()?i=await $v.loadImageBitmap(t):i=await ZB(t):i=await new Promise((c,d)=>{const u=new Image;u.crossOrigin=this.config.crossOrigin,u.src=t,u.complete?c(u):(u.onload=()=>c(u),u.onerror=h=>d(h))});const s={...e.data};s.resolution??(s.resolution=Xn(t)),n&&((l=s.resourceOptions)==null?void 0:l.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new Ee(i,s);return o.resource.src=t,$l(o,r,t)},unload(t){t.destroy(!0)}};ue.add(Yu);const JB=".svg",QB="image/svg+xml",eD={extension:{type:Q.LoadParser,priority:tn.High},name:"loadSVG",test(t){return Zo(t,QB)||zi(t,JB)},async testParse(t){return gm.test(t)},async parse(t,e,r){var s;const n=new gm(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await n.load();const i=new Ee(n,{resolution:Xn(t),...e==null?void 0:e.data});return i.resource.src=e.src,$l(i,r,e.src)},async load(t,e){return(await re.ADAPTER.fetch(t)).text()},unload:Yu.unload};ue.add(eD);const tD=[".mp4",".m4v",".webm",".ogv"],rD=["video/mp4","video/webm","video/ogg"],nD={name:"loadVideo",extension:{type:Q.LoadParser,priority:tn.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return Zo(t,rD)||zi(t,tD)},async load(t,e,r){var o;let n;const i=await(await re.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const l={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},c=new bE(s,l);await c.load();const d=new Ee(c,{alphaMode:await cM(),resolution:Xn(t),...e==null?void 0:e.data});d.resource.src=t,n=$l(d,r,t),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(l){throw URL.revokeObjectURL(s),l}return n},unload(t){t.destroy(!0)}};ue.add(nD);class iD{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,name:n,src:i,srcs:s}=e;return Yr(r||n||i||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(l=>(l==null?void 0:l.src)??(l==null?void 0:l.srcs)??l):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];Array.isArray(r)?r.forEach(i=>{const s=i.src??i.srcs,o=i.alias??i.name;let l;if(typeof o=="string"){const c=this._createBundleAssetId(e,o);n.push(c),l=[o,c]}else{const c=o.map(d=>this._createBundleAssetId(e,d));n.push(...c),l=[...o,...c]}this.add({...i,alias:l,src:s})}):Object.keys(r).forEach(i=>{const s=[i,this._createBundleAssetId(e,i)];if(typeof r[i]=="string")this.add({alias:s,src:r[i]});else if(Array.isArray(r[i]))this.add({alias:s,src:r[i]});else{const o=r[i],l=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(l)?l:[l]})}n.push(...s)}),this._bundles[e]=n}add(e,r,n,i,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(Le("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:r,data:n,format:i,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let l;l=c=>{this.hasKey(c)&&console.warn(`[Resolver] already has key: ${c} overwriting`)},Yr(o).forEach(c=>{const{src:d,srcs:u}=c;let{data:h,format:p,loadParser:f}=c;const m=Yr(d||u).map(x=>typeof x=="string"?IB(x):Array.isArray(x)?x:[x]),_=this.getAlias(c);Array.isArray(_)?_.forEach(l):l(_);const y=[];m.forEach(x=>{x.forEach(v=>{let g={};if(typeof v!="object"){g.src=v;for(let b=0;b<this._parsers.length;b++){const S=this._parsers[b];if(S.test(v)){g=S.parse(v);break}}}else h=v.data??h,p=v.format??p,f=v.loadParser??f,g={...g,...v};if(!_)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this.buildResolvedAsset(g,{aliases:_,data:h,format:p,loadParser:f}),y.push(g)})}),_.forEach(x=>{this._assetMap[x]=y})})}resolveBundle(e){const r=du(e);e=Yr(e);const n={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),l={};for(const c in o){const d=o[c];l[this._extractAssetIdFromBundle(i,c)]=d}n[i]=l}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const i in r)n[i]=r[i].src;return n}return r.src}resolve(e){const r=du(e);e=Yr(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=s[0],l=this._getPreferredOrder(s);l==null||l.priority.forEach(c=>{l.params[c].forEach(d=>{const u=s.filter(h=>h[c]?h[c]===d:!1);u.length&&(s=u)})}),this._resolverHash[i]=s[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}buildResolvedAsset(e,r){const{aliases:n,data:i,loadParser:s,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=jt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??jt.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class sD{constructor(){this._detections=[],this._initialized=!1,this.resolver=new iD,this.loader=new PB,this.cache=ns,this._backgroundLoader=new kB(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let l=e.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const r=((s=e.texturePreference)==null?void 0:s.resolution)??1,n=typeof r=="number"?[r]:r,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e,r,n,i,s){this.resolver.add(e,r,n,i,s)}async load(e,r){this._initialized||await this.init();const n=du(e),i=Yr(e).map(l=>{if(typeof l!="string"){const c=this.resolver.getAlias(l);return c.some(d=>!this.resolver.hasKey(d))&&this.add(l),Array.isArray(c)?c[0]:c}return this.resolver.hasKey(l)||this.add({alias:l,src:l}),l}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,r);return n?o[i[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let l=0,c=0;const d=()=>{r==null||r(++l/c)},u=o.map(h=>{const p=i[h];return c+=Object.keys(p).length,this._mapLoadToResolve(p,d).then(f=>{s[h]=f})});return await Promise.all(u),n?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return ns.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=ns.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const o={};return n.forEach((l,c)=>{const d=s[l.src],u=[l.src];l.alias&&u.push(...l.alias),o[i[c]]=d,ns.set(u,d)}),o}async unload(e){this._initialized||await this.init();const r=Yr(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=Yr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{ns.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,i)=>r.indexOf(n)===i),r}get detections(){return this._detections}get preferWorkers(){return Yu.config.preferWorkers}set preferWorkers(e){Le("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const Ba=new sD;ue.handleByList(Q.LoadParser,Ba.loader.parsers).handleByList(Q.ResolveParser,Ba.resolver.parsers).handleByList(Q.CacheParser,Ba.cache.parsers).handleByList(Q.DetectionParser,Ba.detections);const oD={extension:Q.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof de),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((i,s)=>{r[n+(s===0?"":s+1)]=i})}),r}};ue.add(oD);async function RE(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const aD={extension:{type:Q.DetectionParser,priority:1},test:async()=>RE("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};ue.add(aD);const lD={extension:{type:Q.DetectionParser,priority:0},test:async()=>RE("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};ue.add(lD);const Gv=["png","jpg","jpeg"],cD={extension:{type:Q.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...Gv],remove:async t=>t.filter(e=>!Gv.includes(e))};ue.add(cD);const dD="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function lx(t){return dD?!1:document.createElement("video").canPlayType(t)!==""}const uD={extension:{type:Q.DetectionParser,priority:0},test:async()=>lx("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};ue.add(uD);const hD={extension:{type:Q.DetectionParser,priority:0},test:async()=>lx("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};ue.add(hD);const pD={extension:{type:Q.DetectionParser,priority:0},test:async()=>lx("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};ue.add(pD);const fD={extension:Q.ResolveParser,test:Yu.test,parse:t=>{var e;return{resolution:parseFloat(((e=re.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:jt.extname(t).slice(1),src:t}}};ue.add(fD);var Bt=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(Bt||{});const uu={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let ln,Ks;function Hv(){Ks={bptc:ln.getExtension("EXT_texture_compression_bptc"),astc:ln.getExtension("WEBGL_compressed_texture_astc"),etc:ln.getExtension("WEBGL_compressed_texture_etc"),s3tc:ln.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ln.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:ln.getExtension("WEBGL_compressed_texture_pvrtc")||ln.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:ln.getExtension("WEBGL_compressed_texture_etc1"),atc:ln.getExtension("WEBGL_compressed_texture_atc")}}const mD={extension:{type:Q.DetectionParser,priority:2},test:async()=>{const t=re.ADAPTER.createCanvas().getContext("webgl");return t?(ln=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{Ks||Hv();const e=[];for(const r in Ks)Ks[r]&&e.push(r);return[...e,...t]},remove:async t=>(Ks||Hv(),t.filter(e=>!(e in Ks)))};ue.add(mD);class gD extends Gu{constructor(e,r={width:1,height:1,autoLoad:!0}){let n,i;typeof e=="string"?(n=e,i=new Uint8Array):(n=null,i=e),super(i,r),this.origin=n,this.buffer=i?new nm(i):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new nm(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class hs extends gD{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=hs._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||hs._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,n){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:l,levelWidth:c,levelHeight:d,levelBuffer:u}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,l,this.format,c,d,0,u)}return!0}onBlobLoaded(){this._levelBuffers=hs._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,r,n,i,s,o,l){const c=new Array(n);let d=e.byteOffset,u=o,h=l,p=u+i-1&~(i-1),f=h+s-1&~(s-1),m=p*f*uu[r];for(let _=0;_<n;_++)c[_]={levelID:_,levelWidth:n>1?u:p,levelHeight:n>1?h:f,levelBuffer:new Uint8Array(e.buffer,d,m)},d+=m,u=u>>1||1,h=h>>1||1,p=u+i-1&~(i-1),f=h+s-1&~(s-1),m=p*f*uu[r];return c}}const bp=4,Mc=124,xD=32,Wv=20,yD=542327876,Nc={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},vD={FOURCC:2},Bc={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},_D=1,bD=2,wD=4,SD=64,ED=512,TD=131072,CD=827611204,AD=861165636,kD=894720068,ID=808540228,RD=4,PD={[CD]:Bt.COMPRESSED_RGBA_S3TC_DXT1_EXT,[AD]:Bt.COMPRESSED_RGBA_S3TC_DXT3_EXT,[kD]:Bt.COMPRESSED_RGBA_S3TC_DXT5_EXT},jD={70:Bt.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Bt.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Bt.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Bt.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Bt.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Bt.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Bt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Bt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Bt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Bt.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Bt.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Bt.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Bt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function MD(t){const e=new Uint32Array(t);if(e[0]!==yD)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,Mc/Uint32Array.BYTES_PER_ELEMENT),n=r[Nc.HEIGHT],i=r[Nc.WIDTH],s=r[Nc.MIPMAP_COUNT],o=new Uint32Array(t,Nc.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,xD/Uint32Array.BYTES_PER_ELEMENT),l=o[_D];if(l&wD){const c=o[vD.FOURCC];if(c!==ID){const v=PD[c],g=bp+Mc,b=new Uint8Array(t,g);return[new hs(b,{format:v,width:i,height:n,levels:s})]}const d=bp+Mc,u=new Uint32Array(e.buffer,d,Wv/Uint32Array.BYTES_PER_ELEMENT),h=u[Bc.DXGI_FORMAT],p=u[Bc.RESOURCE_DIMENSION],f=u[Bc.MISC_FLAG],m=u[Bc.ARRAY_SIZE],_=jD[h];if(_===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(f===RD)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");const y=new Array,x=bp+Mc+Wv;if(m===1)y.push(new Uint8Array(t,x));else{const v=uu[_];let g=0,b=i,S=n;for(let E=0;E<s;E++){const T=Math.max(1,b+3&-4),B=Math.max(1,S+3&-4),M=T*B*v;g+=M,b=b>>>1,S=S>>>1}let j=x;for(let E=0;E<m;E++)y.push(new Uint8Array(t,j,g)),j+=g}return y.map(v=>new hs(v,{format:_,width:i,height:n,levels:s}))}throw l&SD?new Error("DDSParser does not support uncompressed texture data."):l&ED?new Error("DDSParser does not supported YUV uncompressed texture data."):l&TD?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&bD?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Vv=[171,75,84,88,32,49,49,187,13,10,26,10],ND=67305985,$r={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},km=64,Xv={[me.UNSIGNED_BYTE]:1,[me.UNSIGNED_SHORT]:2,[me.INT]:4,[me.UNSIGNED_INT]:4,[me.FLOAT]:4,[me.HALF_FLOAT]:8},BD={[K.RGBA]:4,[K.RGB]:3,[K.RG]:2,[K.RED]:1,[K.LUMINANCE]:1,[K.LUMINANCE_ALPHA]:2,[K.ALPHA]:1},DD={[me.UNSIGNED_SHORT_4_4_4_4]:2,[me.UNSIGNED_SHORT_5_5_5_1]:2,[me.UNSIGNED_SHORT_5_6_5]:2};function LD(t,e,r=!1){const n=new DataView(e);if(!FD(t,n))return null;const i=n.getUint32($r.ENDIANNESS,!0)===ND,s=n.getUint32($r.GL_TYPE,i),o=n.getUint32($r.GL_FORMAT,i),l=n.getUint32($r.GL_INTERNAL_FORMAT,i),c=n.getUint32($r.PIXEL_WIDTH,i),d=n.getUint32($r.PIXEL_HEIGHT,i)||1,u=n.getUint32($r.PIXEL_DEPTH,i)||1,h=n.getUint32($r.NUMBER_OF_ARRAY_ELEMENTS,i)||1,p=n.getUint32($r.NUMBER_OF_FACES,i),f=n.getUint32($r.NUMBER_OF_MIPMAP_LEVELS,i),m=n.getUint32($r.BYTES_OF_KEY_VALUE_DATA,i);if(d===0||u!==1)throw new Error("Only 2D textures are supported");if(p!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");const _=4,y=4,x=c+3&-4,v=d+3&-4,g=new Array(h);let b=c*d;s===0&&(b=x*v);let S;if(s!==0?Xv[s]?S=Xv[s]*BD[o]:S=DD[s]:S=uu[l],S===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const j=r?UD(n,m,i):null;let E=b*S,T=c,B=d,M=x,F=v,U=km+m;for(let k=0;k<f;k++){const R=n.getUint32(U,i);let z=U+4;for(let N=0;N<h;N++){let P=g[N];P||(P=g[N]=new Array(f)),P[k]={levelID:k,levelWidth:f>1||s!==0?T:M,levelHeight:f>1||s!==0?B:F,levelBuffer:new Uint8Array(e,z,E)},z+=E}U+=R+4,U=U%4!==0?U+4-U%4:U,T=T>>1||1,B=B>>1||1,M=T+_-1&-4,F=B+y-1&-4,E=M*F*S}return s!==0?{uncompressed:g.map(k=>{let R=k[0].levelBuffer,z=!1;return s===me.FLOAT?R=new Float32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4):s===me.UNSIGNED_INT?(z=!0,R=new Uint32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)):s===me.INT&&(z=!0,R=new Int32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)),{resource:new Gu(R,{width:k[0].levelWidth,height:k[0].levelHeight}),type:s,format:z?OD(o):o}}),kvData:j}:{compressed:g.map(k=>new hs(null,{format:l,width:c,height:d,levels:f,levelBuffers:k})),kvData:j}}function FD(t,e){for(let r=0;r<Vv.length;r++)if(e.getUint8(r)!==Vv[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function OD(t){switch(t){case K.RGBA:return K.RGBA_INTEGER;case K.RGB:return K.RGB_INTEGER;case K.RG:return K.RG_INTEGER;case K.RED:return K.RED_INTEGER;default:return t}}function UD(t,e,r){const n=new Map;let i=0;for(;i<e;){const s=t.getUint32(km+i,r),o=km+i+4,l=3-(s+3)%4;if(s===0||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<s&&t.getUint8(o+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const d=new TextDecoder().decode(new Uint8Array(t.buffer,o,c)),u=new DataView(t.buffer,o+c+1,s-c-1);n.set(d,u),i+=4+s+l}return n}const zD={extension:{type:Q.LoadParser,priority:tn.High},name:"loadDDS",test(t){return zi(t,".dds")},async load(t,e,r){const n=await(await re.ADAPTER.fetch(t)).arrayBuffer(),i=MD(n).map(s=>{const o=new Ee(s,{mipmap:bn.OFF,alphaMode:nr.NO_PREMULTIPLIED_ALPHA,resolution:Xn(t),...e.data});return $l(o,r,t)});return i.length===1?i[0]:i},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};ue.add(zD);const $D={extension:{type:Q.LoadParser,priority:tn.High},name:"loadKTX",test(t){return zi(t,".ktx")},async load(t,e,r){const n=await(await re.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=LD(t,n),l=i??s,c={mipmap:bn.OFF,alphaMode:nr.NO_PREMULTIPLIED_ALPHA,resolution:Xn(t),...e.data},d=l.map(u=>{l===s&&Object.assign(c,{type:u.type,format:u.format});const h=u.resource??u,p=new Ee(h,c);return p.ktxKeyValueData=o,$l(p,r,t)});return d.length===1?d[0]:d},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};ue.add($D);const GD=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],HD={extension:Q.ResolveParser,test:t=>{const e=jt.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var n,i;const e=t.split("."),r=e.pop();if(["ktx","dds"].includes(r)){const s=e.pop();if(GD.includes(s))return{resolution:parseFloat(((n=re.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:s,src:t}}return{resolution:parseFloat(((i=re.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:r,src:t}}};ue.add(HD);const Dc=new Ae,WD=4,PE=class Da{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,r,n,i){const s=new Image;return s.src=await this.base64(e,r,n,i),s}async base64(e,r,n,i){const s=this.canvas(e,i);if(s.toBlob!==void 0)return new Promise((o,l)=>{s.toBlob(c=>{if(!c){l(new Error("ICanvas.toBlob failed!"));return}const d=new FileReader;d.onload=()=>o(d.result),d.onerror=l,d.readAsDataURL(c)},r,n)});if(s.toDataURL!==void 0)return s.toDataURL(r,n);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:r,quality:n});return new Promise((l,c)=>{const d=new FileReader;d.onload=()=>l(d.result),d.onerror=c,d.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:l}=this._rawPixels(e,r);o&&Da._flipY(n,i,s),l&&Da._unpremultiplyAlpha(n);const c=new TM(i,s,1),d=new ImageData(new Uint8ClampedArray(n.buffer),i,s);return c.context.putImageData(d,0,0),c.canvas}pixels(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:l}=this._rawPixels(e,r);return o&&Da._flipY(n,i,s),l&&Da._unpremultiplyAlpha(n),n}_rawPixels(e,r){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let i,s=!1,o=!1,l,c=!1;e&&(e instanceof Rs?l=e:(l=n.generateTexture(e,{region:r,resolution:n.resolution,multisample:n.multisample}),c=!0,r&&(Dc.width=r.width,Dc.height=r.height,r=Dc)));const d=n.gl;if(l){if(i=l.baseTexture.resolution,r=r??l.frame,s=!1,o=l.baseTexture.alphaMode>0&&l.baseTexture.format===K.RGBA,!c){n.renderTexture.bind(l);const f=l.framebuffer.glFramebuffers[n.CONTEXT_UID];f.blitFramebuffer&&n.framebuffer.bind(f.blitFramebuffer)}}else i=n.resolution,r||(r=Dc,r.width=n.width/i,r.height=n.height/i),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const u=Math.max(Math.round(r.width*i),1),h=Math.max(Math.round(r.height*i),1),p=new Uint8Array(WD*u*h);return d.readPixels(Math.round(r.x*i),Math.round(r.y*i),u,h,d.RGBA,d.UNSIGNED_BYTE,p),c&&(l==null||l.destroy(!0)),{pixels:p,width:u,height:h,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,r,n){const i=r<<2,s=n>>1,o=new Uint8Array(i);for(let l=0;l<s;l++){const c=l*i,d=(n-l-1)*i;o.set(e.subarray(c,c+i)),e.copyWithin(c,d,d+i),e.set(o,d)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const r=e.length;for(let n=0;n<r;n+=4){const i=e[n+3];if(i!==0){const s=255.001/i;e[n]=e[n]*s+.5,e[n+1]=e[n+1]*s+.5,e[n+2]=e[n+2]*s+.5}}}};PE.extension={name:"extract",type:Q.RendererSystem};let VD=PE;ue.add(VD);const hu={build(t){const e=t.points;let r,n,i,s,o,l;if(t.type===Lt.CIRC){const m=t.shape;r=m.x,n=m.y,o=l=m.radius,i=s=0}else if(t.type===Lt.ELIP){const m=t.shape;r=m.x,n=m.y,o=m.width,l=m.height,i=s=0}else{const m=t.shape,_=m.width/2,y=m.height/2;r=m.x+_,n=m.y+y,o=l=Math.max(0,Math.min(m.radius,Math.min(_,y))),i=_-o,s=y-l}if(!(o>=0&&l>=0&&i>=0&&s>=0)){e.length=0;return}const c=Math.ceil(2.3*Math.sqrt(o+l)),d=c*8+(i?4:0)+(s?4:0);if(e.length=d,d===0)return;if(c===0){e.length=8,e[0]=e[6]=r+i,e[1]=e[3]=n+s,e[2]=e[4]=r-i,e[5]=e[7]=n-s;return}let u=0,h=c*4+(i?2:0)+2,p=h,f=d;{const m=i+o,_=s,y=r+m,x=r-m,v=n+_;if(e[u++]=y,e[u++]=v,e[--h]=v,e[--h]=x,s){const g=n-_;e[p++]=x,e[p++]=g,e[--f]=g,e[--f]=y}}for(let m=1;m<c;m++){const _=Math.PI/2*(m/c),y=i+Math.cos(_)*o,x=s+Math.sin(_)*l,v=r+y,g=r-y,b=n+x,S=n-x;e[u++]=v,e[u++]=b,e[--h]=b,e[--h]=g,e[p++]=g,e[p++]=S,e[--f]=S,e[--f]=v}{const m=i,_=s+l,y=r+m,x=r-m,v=n+_,g=n-_;e[u++]=y,e[u++]=v,e[--f]=g,e[--f]=y,i&&(e[u++]=x,e[u++]=v,e[--f]=g,e[--f]=x)}},triangulate(t,e){const r=t.points,n=e.points,i=e.indices;if(r.length===0)return;let s=n.length/2;const o=s;let l,c;if(t.type!==Lt.RREC){const u=t.shape;l=u.x,c=u.y}else{const u=t.shape;l=u.x+u.width/2,c=u.y+u.height/2}const d=t.matrix;n.push(t.matrix?d.a*l+d.c*c+d.tx:l,t.matrix?d.b*l+d.d*c+d.ty:c),s++,n.push(r[0],r[1]);for(let u=2;u<r.length;u+=2)n.push(r[u],r[u+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function Yv(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let i=0,s=t[r-2],o=t[r-1];i<r;i+=2){const l=t[i],c=t[i+1];n+=(l-s)*(c+o),s=l,o=c}if(!e&&n>0||e&&n<=0){const i=r/2;for(let s=i+i%2;s<r;s+=2){const o=r-s-2,l=r-s-1,c=s,d=s+1;[t[o],t[c]]=[t[c],t[o]],[t[l],t[d]]=[t[d],t[l]]}}}const jE={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const n=t.holes,i=e.points,s=e.indices;if(r.length>=6){Yv(r,!1);const o=[];for(let d=0;d<n.length;d++){const u=n[d];Yv(u.points,!0),o.push(r.length/2),r=r.concat(u.points)}const l=YI(r,o,2);if(!l)return;const c=i.length/2;for(let d=0;d<l.length;d+=3)s.push(l[d]+c),s.push(l[d+1]+c),s.push(l[d+2]+c);for(let d=0;d<r.length;d++)i.push(r[d])}}},XD={build(t){const e=t.shape,r=e.x,n=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(r,n,r+i,n,r+i,n+s,r,n+s)},triangulate(t,e){const r=t.points,n=e.points;if(r.length===0)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},YD={build(t){hu.build(t)},triangulate(t,e){hu.triangulate(t,e)}};var Cr=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Cr||{}),xi=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(xi||{});const Fo={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class Kv{static curveTo(e,r,n,i,s,o){const l=o[o.length-2],c=o[o.length-1]-r,d=l-e,u=i-r,h=n-e,p=Math.abs(c*h-d*u);if(p<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==r)&&o.push(e,r),null;const f=c*c+d*d,m=u*u+h*h,_=c*u+d*h,y=s*Math.sqrt(f)/p,x=s*Math.sqrt(m)/p,v=y*_/f,g=x*_/m,b=y*h+x*d,S=y*u+x*c,j=d*(x+v),E=c*(x+v),T=h*(y+g),B=u*(y+g),M=Math.atan2(E-S,j-b),F=Math.atan2(B-S,T-b);return{cx:b+e,cy:S+r,radius:s,startAngle:M,endAngle:F,anticlockwise:d*u>h*c}}static arc(e,r,n,i,s,o,l,c,d){const u=l-o,h=Fo._segmentsCount(Math.abs(u)*s,Math.ceil(Math.abs(u)/nu)*40),p=u/(h*2),f=p*2,m=Math.cos(p),_=Math.sin(p),y=h-1,x=y%1/y;for(let v=0;v<=y;++v){const g=v+x*v,b=p+o+f*g,S=Math.cos(b),j=-Math.sin(b);d.push((m*S+_*j)*s+n,(m*-j+_*S)*s+i)}}}class KD{constructor(){this.reset()}begin(e,r,n){this.reset(),this.style=e,this.start=r,this.attribStart=n}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class cx{static curveLength(e,r,n,i,s,o,l,c){let d=0,u=0,h=0,p=0,f=0,m=0,_=0,y=0,x=0,v=0,g=0,b=e,S=r;for(let j=1;j<=10;++j)u=j/10,h=u*u,p=h*u,f=1-u,m=f*f,_=m*f,y=_*e+3*m*u*n+3*f*h*s+p*l,x=_*r+3*m*u*i+3*f*h*o+p*c,v=b-y,g=S-x,b=y,S=x,d+=Math.sqrt(v*v+g*g);return d}static curveTo(e,r,n,i,s,o,l){const c=l[l.length-2],d=l[l.length-1];l.length-=2;const u=Fo._segmentsCount(cx.curveLength(c,d,e,r,n,i,s,o));let h=0,p=0,f=0,m=0,_=0;l.push(c,d);for(let y=1,x=0;y<=u;++y)x=y/u,h=1-x,p=h*h,f=p*h,m=x*x,_=m*x,l.push(f*c+3*p*x*e+3*h*m*n+_*s,f*d+3*p*x*r+3*h*m*i+_*o)}}function qv(t,e,r,n,i,s,o,l){const c=t-r*i,d=e-n*i,u=t+r*s,h=e+n*s;let p,f;o?(p=n,f=-r):(p=-n,f=r);const m=c+p,_=d+f,y=u+p,x=h+f;return l.push(m,_,y,x),2}function Vi(t,e,r,n,i,s,o,l){const c=r-t,d=n-e;let u=Math.atan2(c,d),h=Math.atan2(i-t,s-e);l&&u<h?u+=Math.PI*2:!l&&u>h&&(h+=Math.PI*2);let p=u;const f=h-u,m=Math.abs(f),_=Math.sqrt(c*c+d*d),y=(15*m*Math.sqrt(_)/Math.PI>>0)+1,x=f/y;if(p+=x,l){o.push(t,e,r,n);for(let v=1,g=p;v<y;v++,g+=x)o.push(t,e,t+Math.sin(g)*_,e+Math.cos(g)*_);o.push(t,e,i,s)}else{o.push(r,n,t,e);for(let v=1,g=p;v<y;v++,g+=x)o.push(t+Math.sin(g)*_,e+Math.cos(g)*_,t,e);o.push(i,s,t,e)}return y*2}function qD(t,e){const r=t.shape;let n=t.points||r.points.slice();const i=e.closePointEps;if(n.length===0)return;const s=t.lineStyle,o=new Ue(n[0],n[1]),l=new Ue(n[n.length-2],n[n.length-1]),c=r.type!==Lt.POLY||r.closeStroke,d=Math.abs(o.x-l.x)<i&&Math.abs(o.y-l.y)<i;if(c){n=n.slice(),d&&(n.pop(),n.pop(),l.set(n[n.length-2],n[n.length-1]));const P=(o.x+l.x)*.5,L=(l.y+o.y)*.5;n.unshift(P,L),n.push(P,L)}const u=e.points,h=n.length/2;let p=n.length;const f=u.length/2,m=s.width/2,_=m*m,y=s.miterLimit*s.miterLimit;let x=n[0],v=n[1],g=n[2],b=n[3],S=0,j=0,E=-(v-b),T=x-g,B=0,M=0,F=Math.sqrt(E*E+T*T);E/=F,T/=F,E*=m,T*=m;const U=s.alignment,k=(1-U)*2,R=U*2;c||(s.cap===xi.ROUND?p+=Vi(x-E*(k-R)*.5,v-T*(k-R)*.5,x-E*k,v-T*k,x+E*R,v+T*R,u,!0)+2:s.cap===xi.SQUARE&&(p+=qv(x,v,E,T,k,R,!0,u))),u.push(x-E*k,v-T*k,x+E*R,v+T*R);for(let P=1;P<h-1;++P){x=n[(P-1)*2],v=n[(P-1)*2+1],g=n[P*2],b=n[P*2+1],S=n[(P+1)*2],j=n[(P+1)*2+1],E=-(v-b),T=x-g,F=Math.sqrt(E*E+T*T),E/=F,T/=F,E*=m,T*=m,B=-(b-j),M=g-S,F=Math.sqrt(B*B+M*M),B/=F,M/=F,B*=m,M*=m;const L=g-x,I=v-b,D=g-S,C=j-b,A=L*D+I*C,O=I*D-C*L,H=O<0;if(Math.abs(O)<.001*Math.abs(A)){u.push(g-E*k,b-T*k,g+E*R,b+T*R),A>=0&&(s.join===Cr.ROUND?p+=Vi(g,b,g-E*k,b-T*k,g-B*k,b-M*k,u,!1)+4:p+=2,u.push(g-B*R,b-M*R,g+B*k,b+M*k));continue}const pe=(-E+x)*(-T+b)-(-E+g)*(-T+v),ie=(-B+S)*(-M+b)-(-B+g)*(-M+j),V=(L*ie-D*pe)/O,ge=(C*pe-I*ie)/O,Re=(V-g)*(V-g)+(ge-b)*(ge-b),je=g+(V-g)*k,Te=b+(ge-b)*k,fe=g-(V-g)*R,Me=b-(ge-b)*R,ct=Math.min(L*L+I*I,D*D+C*C),wt=H?k:R,pt=ct+wt*wt*_,Lr=Re<=pt;let Xt=s.join;if(Xt===Cr.MITER&&Re/_>y&&(Xt=Cr.BEVEL),Lr)switch(Xt){case Cr.MITER:{u.push(je,Te,fe,Me);break}case Cr.BEVEL:{H?u.push(je,Te,g+E*R,b+T*R,je,Te,g+B*R,b+M*R):u.push(g-E*k,b-T*k,fe,Me,g-B*k,b-M*k,fe,Me),p+=2;break}case Cr.ROUND:{H?(u.push(je,Te,g+E*R,b+T*R),p+=Vi(g,b,g+E*R,b+T*R,g+B*R,b+M*R,u,!0)+4,u.push(je,Te,g+B*R,b+M*R)):(u.push(g-E*k,b-T*k,fe,Me),p+=Vi(g,b,g-E*k,b-T*k,g-B*k,b-M*k,u,!1)+4,u.push(g-B*k,b-M*k,fe,Me));break}}else{switch(u.push(g-E*k,b-T*k,g+E*R,b+T*R),Xt){case Cr.MITER:{H?u.push(fe,Me,fe,Me):u.push(je,Te,je,Te),p+=2;break}case Cr.ROUND:{H?p+=Vi(g,b,g+E*R,b+T*R,g+B*R,b+M*R,u,!0)+2:p+=Vi(g,b,g-E*k,b-T*k,g-B*k,b-M*k,u,!1)+2;break}}u.push(g-B*k,b-M*k,g+B*R,b+M*R),p+=2}}x=n[(h-2)*2],v=n[(h-2)*2+1],g=n[(h-1)*2],b=n[(h-1)*2+1],E=-(v-b),T=x-g,F=Math.sqrt(E*E+T*T),E/=F,T/=F,E*=m,T*=m,u.push(g-E*k,b-T*k,g+E*R,b+T*R),c||(s.cap===xi.ROUND?p+=Vi(g-E*(k-R)*.5,b-T*(k-R)*.5,g-E*k,b-T*k,g+E*R,b+T*R,u,!1)+2:s.cap===xi.SQUARE&&(p+=qv(g,b,E,T,k,R,!1,u)));const z=e.indices,N=Fo.epsilon*Fo.epsilon;for(let P=f;P<p+f-2;++P)x=u[P*2],v=u[P*2+1],g=u[(P+1)*2],b=u[(P+1)*2+1],S=u[(P+2)*2],j=u[(P+2)*2+1],!(Math.abs(x*(b-j)+g*(j-v)+S*(v-b))<N)&&z.push(P,P+1,P+2)}function ZD(t,e){let r=0;const n=t.shape,i=t.points||n.points,s=n.type!==Lt.POLY||n.closeStroke;if(i.length===0)return;const o=e.points,l=e.indices,c=i.length/2,d=o.length/2;let u=d;for(o.push(i[0],i[1]),r=1;r<c;r++)o.push(i[r*2],i[r*2+1]),l.push(u,u+1),u++;s&&l.push(u,d)}function Zv(t,e){t.lineStyle.native?ZD(t,e):qD(t,e)}class dx{static curveLength(e,r,n,i,s,o){const l=e-2*n+s,c=r-2*i+o,d=2*n-2*e,u=2*i-2*r,h=4*(l*l+c*c),p=4*(l*d+c*u),f=d*d+u*u,m=2*Math.sqrt(h+p+f),_=Math.sqrt(h),y=2*h*_,x=2*Math.sqrt(f),v=p/_;return(y*m+_*p*(m-x)+(4*f*h-p*p)*Math.log((2*_+v+m)/(v+x)))/(4*y)}static curveTo(e,r,n,i,s){const o=s[s.length-2],l=s[s.length-1],c=Fo._segmentsCount(dx.curveLength(o,l,e,r,n,i));let d=0,u=0;for(let h=1;h<=c;++h){const p=h/c;d=o+(e-o)*p,u=l+(r-l)*p,s.push(d+(e+(n-e)*p-d)*p,u+(r+(i-r)*p-u)*p)}}}const wp={[Lt.POLY]:jE,[Lt.CIRC]:hu,[Lt.ELIP]:hu,[Lt.RECT]:XD,[Lt.RREC]:YD},Jv=[],Lc=[];class pu{constructor(e,r=null,n=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=r,this.matrix=i,this.type=e.type}clone(){return new pu(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const zs=new Ue,ME=class NE extends FS{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new lu,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Lc.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r.reset(),Jv.push(r)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,r=null,n=null,i=null){const s=new pu(e,r,n,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,r=null){if(!this.graphicsData.length)return null;const n=new pu(e,null,null,r),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const r=this.graphicsData;for(let n=0;n<r.length;++n){const i=r[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,zs):zs.copyFrom(e),i.shape.contains(zs.x,zs.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(zs.x,zs.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,r=this.graphicsData;let n=null,i=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],i=n.style);for(let c=this.shapeIndex;c<r.length;c++){this.shapeIndex++;const d=r[c],u=d.fillStyle,h=d.lineStyle;wp[d.type].build(d),d.matrix&&this.transformPoints(d.points,d.matrix),(u.visible||h.visible)&&this.processHoles(d.holes);for(let p=0;p<2;p++){const f=p===0?u:h;if(!f.visible)continue;const m=f.texture.baseTexture,_=this.indices.length,y=this.points.length/2;m.wrapMode=Ai.REPEAT,p===0?this.processFill(d):this.processLine(d);const x=this.points.length/2-y;x!==0&&(n&&!this._compareStyles(i,f)&&(n.end(_,y),n=null),n||(n=Jv.pop()||new KD,n.begin(f,_,y),this.batches.push(n),i=f),this.addUvs(this.points,e,f.texture,y,x,f.matrix))}}const s=this.indices.length,o=this.points.length/2;if(n&&n.end(s,o),this.batches.length===0){this.batchable=!0;return}const l=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&l===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=l?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,r){return!(!e||!r||e.texture.baseTexture!==r.texture.baseTexture||e.color+e.alpha!==r.color+r.alpha||!!e.native!=!!r.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,r=this.graphicsData.length;e<r;e++){const n=this.graphicsData[e],i=n.fillStyle,s=n.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let r=0,n=e.length;r<n;r++){const i=e[r];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<NE.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++Ee._globalBatch;for(let h=0;h<this.drawCalls.length;h++)this.drawCalls[h].texArray.clear(),Lc.push(this.drawCalls[h]);this.drawCalls.length=0;const r=this.colors,n=this.textureIds;let i=Lc.pop();i||(i=new om,i.texArray=new dm),i.texArray.count=0,i.start=0,i.size=0,i.type=gn.TRIANGLES;let s=0,o=null,l=0,c=!1,d=gn.TRIANGLES,u=0;this.drawCalls.push(i);for(let h=0;h<this.batches.length;h++){const p=this.batches[h],f=8,m=p.style,_=m.texture.baseTexture;c!==!!m.native&&(c=!!m.native,d=c?gn.LINES:gn.TRIANGLES,o=null,s=f,e++),o!==_&&(o=_,_._batchEnabled!==e&&(s===f&&(e++,s=0,i.size>0&&(i=Lc.pop(),i||(i=new om,i.texArray=new dm),this.drawCalls.push(i)),i.start=u,i.size=0,i.texArray.count=0,i.type=d),_.touched=1,_._batchEnabled=e,_._batchLocation=s,_.wrapMode=Ai.REPEAT,i.texArray.elements[i.texArray.count++]=_,s++)),i.size+=p.size,u+=p.size,l=_._batchLocation,this.addColors(r,m.color,m.alpha,p.attribSize,p.attribStart),this.addTextureIds(n,l,p.attribSize,p.attribStart)}Ee._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,r=this.uvs,n=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),l=new Uint32Array(s);let c=0;for(let d=0;d<e.length/2;d++)o[c++]=e[d*2],o[c++]=e[d*2+1],o[c++]=r[d*2],o[c++]=r[d*2+1],l[c++]=n[d],o[c++]=i[d];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?jE.triangulate(e,this):wp[e.type].triangulate(e,this)}processLine(e){Zv(e,this);for(let r=0;r<e.holes.length;r++)Zv(e.holes[r],this)}processHoles(e){for(let r=0;r<e.length;r++){const n=e[r];wp[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,r){for(let n=0;n<e.length/2;n++){const i=e[n*2],s=e[n*2+1];e[n*2]=r.a*i+r.c*s+r.tx,e[n*2+1]=r.b*i+r.d*s+r.ty}}addColors(e,r,n,i,s=0){const o=qe.shared.setValue(r).toLittleEndianNumber(),l=qe.shared.setValue(o).toPremultiplied(n);e.length=Math.max(e.length,s+i);for(let c=0;c<i;c++)e[s+c]=l}addTextureIds(e,r,n,i=0){e.length=Math.max(e.length,i+n);for(let s=0;s<n;s++)e[i+s]=r}addUvs(e,r,n,i,s,o=null){let l=0;const c=r.length,d=n.frame;for(;l<s;){let h=e[(i+l)*2],p=e[(i+l)*2+1];if(o){const f=o.a*h+o.c*p+o.tx;p=o.b*h+o.d*p+o.ty,h=f}l++,r.push(h/d.width,p/d.height)}const u=n.baseTexture;(d.width<u.width||d.height<u.height)&&this.adjustUvs(r,n,c,s)}adjustUvs(e,r,n,i){const s=r.baseTexture,o=1e-6,l=n+i*2,c=r.frame,d=c.width/s.width,u=c.height/s.height;let h=c.x/c.width,p=c.y/c.height,f=Math.floor(e[n]+o),m=Math.floor(e[n+1]+o);for(let _=n+2;_<l;_+=2)f=Math.min(f,Math.floor(e[_]+o)),m=Math.min(m,Math.floor(e[_+1]+o));h-=f,p-=m;for(let _=n;_<l;_+=2)e[_]=(e[_]+h)*d,e[_+1]=(e[_+1]+p)*u}};ME.BATCHABLE_SIZE=100;let JD=ME;class Ku{constructor(){this.color=16777215,this.alpha=1,this.texture=de.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new Ku;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=de.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class ux extends Ku{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=xi.BUTT,this.join=Cr.MITER,this.miterLimit=10}clone(){const e=new ux;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=xi.BUTT,this.join=Cr.MITER,this.miterLimit=10}}const Sp={},Im=class gd extends lr{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Ku,this._lineStyle=new ux,this._matrix=null,this._holeMode=!1,this.state=En.for2d(),this._geometry=e||new JD,this._geometry.refCount++,this._transformID=-1,this._tintColor=new qe(16777215),this.blendMode=be.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new gd(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,r=0,n,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:r,alpha:n,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const r={width:0,texture:de.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:xi.BUTT,join:Cr.MITER,miterLimit:10};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new us,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new us,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this}lineTo(e,r){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,i=n[n.length-2],s=n[n.length-1];return(i!==e||s!==r)&&n.push(e,r),this}_initCurve(e=0,r=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)}quadraticCurveTo(e,r,n,i){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),dx.curveTo(e,r,n,i,s),this}bezierCurveTo(e,r,n,i,s,o){return this._initCurve(),cx.curveTo(e,r,n,i,s,o,this.currentPath.points),this}arcTo(e,r,n,i,s){this._initCurve(e,r);const o=this.currentPath.points,l=Kv.curveTo(e,r,n,i,s,o);if(l){const{cx:c,cy:d,radius:u,startAngle:h,endAngle:p,anticlockwise:f}=l;this.arc(c,d,u,h,p,f)}return this}arc(e,r,n,i,s,o=!1){if(i===s)return this;if(!o&&s<=i?s+=nu:o&&i<=s&&(i+=nu),s-i===0)return this;const l=e+Math.cos(i)*n,c=r+Math.sin(i)*n,d=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const h=Math.abs(u[u.length-2]-l),p=Math.abs(u[u.length-1]-c);h<d&&p<d||u.push(l,c)}else this.moveTo(l,c),u=this.currentPath.points;return Kv.arc(l,c,e,r,n,i,s,o,u),this}beginFill(e=0,r){return this.beginTextureFill({texture:de.WHITE,color:e,alpha:r})}normalizeColor(e){const r=qe.shared.setValue(e.color??0);e.color=r.toNumber(),e.alpha??(e.alpha=r.alpha)}beginTextureFill(e){const r={texture:de.WHITE,color:16777215,matrix:null};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,r,n,i){return this.drawShape(new Ae(e,r,n,i))}drawRoundedRect(e,r,n,i,s){return this.drawShape(new Vu(e,r,n,i,s))}drawCircle(e,r,n){return this.drawShape(new Hu(e,r,n))}drawEllipse(e,r,n,i){return this.drawShape(new Wu(e,r,n,i))}drawPolygon(...e){let r,n=!0;const i=e[0];i.points?(n=i.closeStroke,r=i.points):Array.isArray(e[0])?r=e[0]:r=e;const s=new us(r);return s.closeStroke=n,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===Lt.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,r=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let i=0;i<n;i++){const s=e.batches[i],o=s.style.color,l=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),c=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),d=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),u={vertexData:l,blendMode:r,indices:d,uvs:c,_batchRGB:qe.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=u}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let r=0,n=this.batches.length;r<n;r++){const i=this.batches[r];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const r=this._resolveDirectShader(e),n=this._geometry,i=this.worldAlpha,s=r.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,qe.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(r),e.geometry.bind(n,r),e.state.set(this.state);for(let l=0,c=o.length;l<c;l++)this._renderDrawCallDirect(e,n.drawCalls[l])}_renderDrawCallDirect(e,r){const{texArray:n,type:i,size:s,start:o}=r,l=n.count;for(let c=0;c<l;c++)e.texture.bind(n.elements[c],c);e.geometry.draw(i,s,o)}_resolveDirectShader(e){let r=this.shader;const n=this.pluginName;if(!r){if(!Sp[n]){const{maxTextures:i}=e.plugins[n],s=new Int32Array(i);for(let c=0;c<i;c++)s[c]=c;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Qe,default:Jr.from({uSamplers:s},!0)},l=e.plugins[n]._shader.program;Sp[n]=new _n(l,o)}r=Sp[n]}return r}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:r,minY:n,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,r,n,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,gd._TEMP_POINT),this._geometry.containsPoint(gd._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r._tintRGB=qe.shared.setValue(this._tintColor).multiply(r._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,l=r.tx,c=r.ty,d=this._geometry.points,u=this.vertexData;let h=0;for(let p=0;p<d.length;p+=2){const f=d[p],m=d[p+1];u[h++]=n*f+s*m+l,u[h++]=o*m+i*f+c}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};Im.curves=Fo,Im._TEMP_POINT=new Ue;let gr=Im;class QD{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const Ep=new Ue,Qv=new us,BE=class DE extends lr{constructor(e,r,n,i=gn.TRIANGLES){super(),this.geometry=e,this.shader=r,this.state=n||En.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=re.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===gn.TRIANGLES&&r.length<DE.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const r=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const e=this.geometry.buffers[0],r=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const i=this.transform.worldTransform,s=i.a,o=i.b,l=i.c,c=i.d,d=i.tx,u=i.ty,h=this.vertexData;for(let p=0;p<h.length/2;p++){const f=r[p*2],m=r[p*2+1];h[p*2]=s*f+l*m+d,h[p*2+1]=o*f+c*m+u}if(this._roundPixels){const p=re.RESOLUTION;for(let f=0;f<h.length;++f)h[f]=Math.round(h[f]*p)/p}this.vertexDirty=n}calculateUvs(){const e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new QD(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Ep);const r=this.geometry.getBuffer("aVertexPosition").data,n=Qv.points,i=this.geometry.getIndex().data,s=i.length,o=this.drawMode===4?3:1;for(let l=0;l+2<s;l+=o){const c=i[l]*2,d=i[l+1]*2,u=i[l+2]*2;if(n[0]=r[c],n[1]=r[c+1],n[2]=r[d],n[3]=r[d+1],n[4]=r[u],n[5]=r[u+1],Qv.contains(Ep.x,Ep.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};BE.BATCHABLE_SIZE=100;let e_=BE;class eL extends Pi{constructor(e,r,n){super();const i=new ft(e),s=new ft(r,!0),o=new ft(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,me.FLOAT).addAttribute("aTextureCoord",s,2,!1,me.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var tL=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,rL=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class t_ extends _n{constructor(e,r){const n={uSampler:e,alpha:1,uTextureMatrix:Qe.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||Fn.from(rL,tL),n),this._colorDirty=!1,this.uvMatrix=new JS(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new qe(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;qe.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class r_{constructor(e,r,n){this.geometry=new Pi,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||me.FLOAT,offset:s.offset},r[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let r=0;this.indexBuffer=new ft(SM(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const l=this.dynamicProperties[o];l.offset=r,r+=l.size,this.dynamicStride+=l.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new ft(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const l=this.staticProperties[o];l.offset=i,i+=l.size,this.staticStride+=l.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new ft(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const l=this.dynamicProperties[o];e.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===me.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const l=this.staticProperties[o];e.addAttribute(l.attributeName,this.staticBuffer,0,l.type===me.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(e,r,n){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,r,n,s.type===me.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,n){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,r,n,s.type===me.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var nL=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,iL=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class LE extends Xu{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Qe,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:me.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=_n.from(iL,nL,{}),this.state=En.for2d()}render(e){const r=e.children,n=e._maxSize,i=e._batchSize,s=this.renderer;let o=r.length;if(o===0)return;o>n&&!e.autoResize&&(o=n);let l=e._buffers;l||(l=e._buffers=this.generateBuffers(e));const c=r[0]._texture.baseTexture,d=c.alphaMode>0;this.state.blendMode=BS(e.blendMode,d),s.state.set(this.state);const u=s.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=qe.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,d).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let p=!1;for(let f=0,m=0;f<o;f+=i,m+=1){let _=o-f;_>i&&(_=i),m>=l.length&&l.push(this._generateOneMoreBuffer(e));const y=l[m];y.uploadDynamic(r,f,_);const x=e._bufferUpdateIDs[m]||0;p=p||y._updateID<x,p&&(y._updateID=e._updateID,y.uploadStatic(r,f,_)),s.geometry.bind(y.geometry),u.drawElements(u.TRIANGLES,_*6,u.UNSIGNED_SHORT,0)}}generateBuffers(e){const r=[],n=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<n;o+=i)r.push(new r_(this.properties,s,i));return r}_generateOneMoreBuffer(e){const r=e._batchSize,n=e._properties;return new r_(this.properties,n,r)}uploadVertices(e,r,n,i,s,o){let l=0,c=0,d=0,u=0;for(let h=0;h<n;++h){const p=e[r+h],f=p._texture,m=p.scale.x,_=p.scale.y,y=f.trim,x=f.orig;y?(c=y.x-p.anchor.x*x.width,l=c+y.width,u=y.y-p.anchor.y*x.height,d=u+y.height):(l=x.width*(1-p.anchor.x),c=x.width*-p.anchor.x,d=x.height*(1-p.anchor.y),u=x.height*-p.anchor.y),i[o]=c*m,i[o+1]=u*_,i[o+s]=l*m,i[o+s+1]=u*_,i[o+s*2]=l*m,i[o+s*2+1]=d*_,i[o+s*3]=c*m,i[o+s*3+1]=d*_,o+=s*4}}uploadPosition(e,r,n,i,s,o){for(let l=0;l<n;l++){const c=e[r+l].position;i[o]=c.x,i[o+1]=c.y,i[o+s]=c.x,i[o+s+1]=c.y,i[o+s*2]=c.x,i[o+s*2+1]=c.y,i[o+s*3]=c.x,i[o+s*3+1]=c.y,o+=s*4}}uploadRotation(e,r,n,i,s,o){for(let l=0;l<n;l++){const c=e[r+l].rotation;i[o]=c,i[o+s]=c,i[o+s*2]=c,i[o+s*3]=c,o+=s*4}}uploadUvs(e,r,n,i,s,o){for(let l=0;l<n;++l){const c=e[r+l]._texture._uvs;c?(i[o]=c.x0,i[o+1]=c.y0,i[o+s]=c.x1,i[o+s+1]=c.y1,i[o+s*2]=c.x2,i[o+s*2+1]=c.y2,i[o+s*3]=c.x3,i[o+s*3+1]=c.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}}uploadTint(e,r,n,i,s,o){for(let l=0;l<n;++l){const c=e[r+l],d=qe.shared.setValue(c._tintRGB).toPremultiplied(c.alpha,c.texture.baseTexture.alphaMode>0);i[o]=d,i[o+s]=d,i[o+s*2]=d,i[o+s*3]=d,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}LE.extension={name:"particle",type:Q.RendererPlugin};ue.add(LE);var qu=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(qu||{});const Fc={willReadFrequently:!0},cn=class he{static get experimentalLetterSpacingSupported(){let e=he._experimentalLetterSpacingSupported;if(e!==void 0){const r=re.ADAPTER.getCanvasRenderingContext2D().prototype;e=he._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,i,s,o,l,c,d){this.text=e,this.style=r,this.width=n,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=l,this.maxLineWidth=c,this.fontProperties=d}static measureText(e,r,n,i=he._canvas){n=n??r.wordWrap;const s=r.toFontString(),o=he.measureFont(s);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const l=i.getContext("2d",Fc);l.font=s;const c=(n?he.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),d=new Array(c.length);let u=0;for(let m=0;m<c.length;m++){const _=he._measureText(c[m],r.letterSpacing,l);d[m]=_,u=Math.max(u,_)}let h=u+r.strokeThickness;r.dropShadow&&(h+=r.dropShadowDistance);const p=r.lineHeight||o.fontSize+r.strokeThickness;let f=Math.max(p,o.fontSize+r.strokeThickness*2)+r.leading+(c.length-1)*(p+r.leading);return r.dropShadow&&(f+=r.dropShadowDistance),new he(e,r,h,f,c,d,p+r.leading,u,o)}static _measureText(e,r,n){let i=!1;he.experimentalLetterSpacingSupported&&(he.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let s=n.measureText(e).width;return s>0&&(i?s-=r:s+=(he.graphemeSegmenter(e).length-1)*r),s}static wordWrap(e,r,n=he._canvas){const i=n.getContext("2d",Fc);let s=0,o="",l="";const c=Object.create(null),{letterSpacing:d,whiteSpace:u}=r,h=he.collapseSpaces(u),p=he.collapseNewlines(u);let f=!h;const m=r.wordWrapWidth+d,_=he.tokenize(e);for(let y=0;y<_.length;y++){let x=_[y];if(he.isNewline(x)){if(!p){l+=he.addLine(o),f=!h,o="",s=0;continue}x=" "}if(h){const g=he.isBreakingSpace(x),b=he.isBreakingSpace(o[o.length-1]);if(g&&b)continue}const v=he.getFromCache(x,d,c,i);if(v>m)if(o!==""&&(l+=he.addLine(o),o="",s=0),he.canBreakWords(x,r.breakWords)){const g=he.wordWrapSplit(x);for(let b=0;b<g.length;b++){let S=g[b],j=S,E=1;for(;g[b+E];){const B=g[b+E];if(!he.canBreakChars(j,B,x,b,r.breakWords))S+=B;else break;j=B,E++}b+=E-1;const T=he.getFromCache(S,d,c,i);T+s>m&&(l+=he.addLine(o),f=!1,o="",s=0),o+=S,s+=T}}else{o.length>0&&(l+=he.addLine(o),o="",s=0);const g=y===_.length-1;l+=he.addLine(x,!g),f=!1,o="",s=0}else v+s>m&&(f=!1,l+=he.addLine(o),o="",s=0),(o.length>0||!he.isBreakingSpace(x)||f)&&(o+=x,s+=v)}return l+=he.addLine(o,!1),l}static addLine(e,r=!0){return e=he.trimRight(e),e=r?`${e}
`:e,e}static getFromCache(e,r,n,i){let s=n[e];return typeof s!="number"&&(s=he._measureText(e,r,i)+r,n[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!he.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:he._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:he._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(he.isBreakingSpace(s,o)||he.isNewline(s)){n!==""&&(r.push(n),n=""),r.push(s);continue}n+=s}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,i,s){return!0}static wordWrapSplit(e){return he.graphemeSegmenter(e)}static measureFont(e){if(he._fonts[e])return he._fonts[e];const r={ascent:0,descent:0,fontSize:0},n=he._canvas,i=he._context;i.font=e;const s=he.METRICS_STRING+he.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let l=Math.ceil(i.measureText(he.BASELINE_SYMBOL).width);const c=Math.ceil(he.HEIGHT_MULTIPLIER*l);if(l=l*he.BASELINE_MULTIPLIER|0,o===0||c===0)return he._fonts[e]=r,r;n.width=o,n.height=c,i.fillStyle="#f00",i.fillRect(0,0,o,c),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,l);const d=i.getImageData(0,0,o,c).data,u=d.length,h=o*4;let p=0,f=0,m=!1;for(p=0;p<l;++p){for(let _=0;_<h;_+=4)if(d[f+_]!==255){m=!0;break}if(!m)f+=h;else break}for(r.ascent=l-p,f=u-h,m=!1,p=c;p>l;--p){for(let _=0;_<h;_+=4)if(d[f+_]!==255){m=!0;break}if(!m)f-=h;else break}return r.descent=p-l,r.fontSize=r.ascent+r.descent,he._fonts[e]=r,r}static clearMetrics(e=""){e?delete he._fonts[e]:he._fonts={}}static get _canvas(){var e;if(!he.__canvas){let r;try{const n=new OffscreenCanvas(0,0);if((e=n.getContext("2d",Fc))!=null&&e.measureText)return he.__canvas=n,n;r=re.ADAPTER.createCanvas()}catch{r=re.ADAPTER.createCanvas()}r.width=r.height=10,he.__canvas=r}return he.__canvas}static get _context(){return he.__context||(he.__context=he._canvas.getContext("2d",Fc)),he.__context}};cn.METRICS_STRING="|q",cn.BASELINE_SYMBOL="M",cn.BASELINE_MULTIPLIER=1.4,cn.HEIGHT_MULTIPLIER=2,cn.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})(),cn.experimentalLetterSpacing=!1,cn._fonts={},cn._newlines=[10,13],cn._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let ai=cn;const sL=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],FE=class La{constructor(e){this.styleID=0,this.reset(),Cp(this,e,e)}clone(){const e={};return Cp(e,this,La.defaultStyle),new La(e)}reset(){Cp(this,La.defaultStyle,La.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const r=Tp(e);this._dropShadowColor!==r&&(this._dropShadowColor=r,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const r=Tp(e);this._fill!==r&&(this._fill=r,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){oL(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const r=Tp(e);this._stroke!==r&&(this._stroke=r,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let r=this.fontFamily;Array.isArray(this.fontFamily)||(r=this.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let i=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!sL.includes(i)&&(i=`"${i}"`),r[n]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${r.join(",")}`}};FE.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:qu.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Dr=FE;function Tp(t){const e=qe.shared,r=n=>{const i=e.setValue(n);return i.alpha===1?i.toHex():i.toRgbaString()};return Array.isArray(t)?t.map(r):r(t)}function oL(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function Cp(t,e,r){for(const n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}const aL={texture:!0,children:!1,baseTexture:!0},OE=class Rm extends ji{constructor(e,r,n){let i=!1;n||(n=re.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const s=de.from(n);s.orig=new Ae,s.trim=new Ae,super(s),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=Rm.defaultResolution??re.RESOLUTION,this._autoResolution=Rm.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return ai.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Le("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ai.experimentalLetterSpacing=e}updateText(e){const r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const n=this.context,i=ai.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,l=i.lines,c=i.lineHeight,d=i.lineWidths,u=i.maxLineWidth,h=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;let p,f;const m=r.dropShadow?2:1;for(let _=0;_<m;++_){const y=r.dropShadow&&_===0,x=y?Math.ceil(Math.max(1,o)+r.padding*2):0,v=x*this._resolution;if(y){n.fillStyle="black",n.strokeStyle="black";const b=r.dropShadowColor,S=r.dropShadowBlur*this._resolution,j=r.dropShadowDistance*this._resolution;n.shadowColor=qe.shared.setValue(b).setAlpha(r.dropShadowAlpha).toRgbaString(),n.shadowBlur=S,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*j,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*j+v}else n.fillStyle=this._generateFillStyle(r,l,i),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let g=(c-h.fontSize)/2;c-h.fontSize<0&&(g=0);for(let b=0;b<l.length;b++)p=r.strokeThickness/2,f=r.strokeThickness/2+b*c+h.ascent+g,r.align==="right"?p+=u-d[b]:r.align==="center"&&(p+=(u-d[b])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(l[b],p+r.padding,f+r.padding-x,!0),r.fill&&this.drawLetterSpacing(l[b],p+r.padding,f+r.padding-x)}this.updateTexture()}drawLetterSpacing(e,r,n,i=!1){const s=this._style.letterSpacing;let o=!1;if(ai.experimentalLetterSpacingSupported&&(ai.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(e,r,n):this.context.fillText(e,r,n);return}let l=r;const c=ai.graphemeSegmenter(e);let d=this.context.measureText(e).width,u=0;for(let h=0;h<c.length;++h){const p=c[h];i?this.context.strokeText(p,l,n):this.context.fillText(p,l,n);let f="";for(let m=h+1;m<c.length;++m)f+=c[m];u=this.context.measureText(f).width,l+=d-u+s,d=u}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=AM(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const r=this._texture,n=this._style,i=n.trim?0:n.padding,s=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-i*2,r.orig.height=r._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,r){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,r)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,r,n){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s;const o=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,c=this.canvas.width/this._resolution-o-l*2,d=this.canvas.height/this._resolution-o-l*2,u=i.slice(),h=e.fillGradientStops.slice();if(!h.length){const p=u.length+1;for(let f=1;f<p;++f)h.push(f/p)}if(u.unshift(i[0]),h.unshift(0),u.push(i[i.length-1]),h.push(1),e.fillGradientType===qu.LINEAR_VERTICAL){s=this.context.createLinearGradient(c/2,l,c/2,d+l);const p=n.fontProperties.fontSize+e.strokeThickness;for(let f=0;f<r.length;f++){const m=n.lineHeight*(f-1)+p,_=n.lineHeight*f;let y=_;f>0&&m>_&&(y=(_+m)/2);const x=_+p,v=n.lineHeight*(f+1);let g=x;f+1<r.length&&v<x&&(g=(x+v)/2);const b=(g-y)/d;for(let S=0;S<u.length;S++){let j=0;typeof h[S]=="number"?j=h[S]:j=S/u.length;let E=Math.min(1,Math.max(0,y/d+j*b));E=Number(E.toFixed(5)),s.addColorStop(E,u[S])}}}else{s=this.context.createLinearGradient(l,d/2,c+l,d/2);const p=u.length+1;let f=1;for(let m=0;m<u.length;m++){let _;typeof h[m]=="number"?_=h[m]:_=f/p,s.addColorStop(_,u[m]),f++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},aL,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const r=gi(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const r=gi(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Dr?this._style=e:this._style=new Dr(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};OE.defaultAutoResolution=!0;let ws=OE;class lL{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function cL(t,e){var n;let r=!1;if((n=t==null?void 0:t._textures)!=null&&n.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof de){const s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),r=!0)}}return r}function dL(t,e){if(t.baseTexture instanceof Ee){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function uL(t,e){if(t._texture&&t._texture instanceof de){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function hL(t,e){return e instanceof ws?(e.updateText(!0),!0):!1}function pL(t,e){if(e instanceof Dr){const r=e.toFontString();return ai.measureFont(r),!0}return!1}function fL(t,e){if(t instanceof ws){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function mL(t,e){return t instanceof Dr?(e.includes(t)||e.push(t),!0):!1}const UE=class zE{constructor(e){this.limiter=new lL(zE.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(fL),this.registerFindHook(mL),this.registerFindHook(cL),this.registerFindHook(dL),this.registerFindHook(uL),this.registerUploadHook(hL),this.registerUploadHook(pL)}upload(e){return new Promise(r=>{e&&this.add(e),this.queue.length?(this.completes.push(r),this.ticking||(this.ticking=!0,mr.system.addOnce(this.tick,this,bs.UTILITY))):r()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let r=!1;if(e&&!e._destroyed){for(let n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),r=!0;break}}r||this.queue.shift()}if(this.queue.length)mr.system.addOnce(this.tick,this,bs.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let r=0,n=e.length;r<n;r++)e[r]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let r=0,n=this.addHooks.length;r<n&&!this.addHooks[r](e,this.queue);r++);if(e instanceof lr)for(let r=e.children.length-1;r>=0;r--)this.add(e.children[r]);return this}destroy(){this.ticking&&mr.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};UE.uploadsPerFrame=4;let Pm=UE;Object.defineProperties(re,{UPLOADS_PER_FRAME:{get(){return Pm.uploadsPerFrame},set(t){Le("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Pm.uploadsPerFrame=t}}});function $E(t,e){return e instanceof Ee?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function gL(t,e){if(!(e instanceof gr))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:n}=r;for(let i=0;i<n.length;i++){const{texture:s}=n[i].style;s&&$E(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function xL(t,e){return t instanceof gr?(e.push(t),!0):!1}class GE extends Pm{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(xL),this.registerUploadHook($E),this.registerUploadHook(gL)}}GE.extension={name:"prepare",type:Q.RendererSystem};ue.add(GE);var yL=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,vL=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,_L=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,n_=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,bL=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Oc=new Qe;class HE extends Xu{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new YS,this.state=En.for2d()}contextChange(){const e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=_n.from(n_,bL,r),this.shader=e.context.webGLVersion>1?_n.from(vL,yL,r):_n.from(n_,_L,r)}render(e){const r=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=n.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,n.invalidate();const l=e._texture,c=l.baseTexture,d=c.alphaMode>0,u=e.tileTransform.localTransform,h=e.uvMatrix;let p=c.isPowerOfTwo&&l.frame.width===c.width&&l.frame.height===c.height;p&&(c._glTextures[r.CONTEXT_UID]?p=c.wrapMode!==Ai.CLAMP:c.wrapMode===Ai.CLAMP&&(c.wrapMode=Ai.REPEAT));const f=p?this.simpleShader:this.shader,m=l.width,_=l.height,y=e._width,x=e._height;Oc.set(u.a*m/y,u.b*m/x,u.c*_/y,u.d*_/x,u.tx/y,u.ty/x),Oc.invert(),p?Oc.prepend(h.mapCoord):(f.uniforms.uMapCoord=h.mapCoord.toArray(!0),f.uniforms.uClampFrame=h.uClampFrame,f.uniforms.uClampOffset=h.uClampOffset),f.uniforms.uTransform=Oc.toArray(!0),f.uniforms.uColor=qe.shared.setValue(e.tint).premultiply(e.worldAlpha,d).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=l,r.shader.bind(f),r.geometry.bind(n),this.state.blendMode=BS(e.blendMode,d),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}HE.extension={name:"tilingSprite",type:Q.RendererPlugin};ue.add(HE);const WE=class Fa{constructor(e,r,n){this.linkedSheets=[],(e instanceof Ee||e instanceof de)&&(e={texture:e,data:r,resolutionFilename:n});const{texture:i,data:s,resolutionFilename:o=null,cachePrefix:l=""}=e;this.cachePrefix=l,this._texture=i instanceof de?i:null,this.baseTexture=i instanceof Ee?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const c=this.baseTexture.resource;this.resolution=this._updateResolution(o||(c?c.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:r}=this.data.meta;let n=Xn(e,null);return n===null&&(n=typeof r=="number"?r:parseFloat(r??"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Fa.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=Fa.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const i=this._frameKeys[r],s=this._frames[i],o=s.frame;if(o){let l=null,c=null;const d=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,u=new Ae(0,0,Math.floor(d.w)/this.resolution,Math.floor(d.h)/this.resolution);s.rotated?l=new Ae(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):l=new Ae(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(c=new Ae(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new de(this.baseTexture,l,u,c,s.rotated?2:0,s.anchor,s.borders),de.addToCache(this.textures[i],this.cachePrefix+i.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const i=e[r][n];this.animations[r].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Fa.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Fa.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var r;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((r=this._texture)==null||r.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};WE.BATCH_SIZE=1e3;let i_=WE;const wL=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function VE(t,e,r){const n={};if(t.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[`${e.cachePrefix}${i}`]=e.textures[i]}),!r){const i=jt.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(n,VE([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return n}const SL={extension:Q.Asset,cache:{test:t=>t instanceof i_,getCacheableAssets:(t,e)=>VE(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&wL.includes(n)},parse:t=>{var r;const e=t.split(".");return{resolution:parseFloat(((r=re.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:Q.LoadParser,priority:tn.Normal},async testParse(t,e){return jt.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){var u,h;const{texture:n,imageFilename:i,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=jt.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let l;if(n&&n.baseTexture)l=n;else{const p=Cm(o+(i??t.meta.image),e.src);l=(await r.load([p]))[p]}const c=new i_({texture:l.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await c.parse();const d=(u=t==null?void 0:t.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(d)){const p=[];for(const m of d){if(typeof m!="string")continue;let _=o+m;(h=e.data)!=null&&h.ignoreMultiPack||(_=Cm(_,e.src),p.push(r.load({src:_,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(p);c.linkedSheets=f,f.forEach(m=>{m.linkedSheets=[c].concat(c.linkedSheets.filter(_=>_!==m))})}return c},unload(t){t.destroy(!0)}}};ue.add(SL);class fu{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class xd{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const r=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in r){const o=r[s].match(/^[a-z]+/gm)[0],l=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(const d in l){const u=l[d].split("="),h=u[0],p=u[1].replace(/"/gm,""),f=parseFloat(p),m=isNaN(f)?p:f;c[h]=m}n[o].push(c)}const i=new fu;return n.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),n.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),n.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),n.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),n.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),n.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class jm{static test(e){const r=e;return typeof e!="string"&&"getElementsByTagName"in e&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const r=new fu,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),l=e.getElementsByTagName("kerning"),c=e.getElementsByTagName("distanceField");for(let d=0;d<n.length;d++)r.info.push({face:n[d].getAttribute("face"),size:parseInt(n[d].getAttribute("size"),10)});for(let d=0;d<i.length;d++)r.common.push({lineHeight:parseInt(i[d].getAttribute("lineHeight"),10)});for(let d=0;d<s.length;d++)r.page.push({id:parseInt(s[d].getAttribute("id"),10)||0,file:s[d].getAttribute("file")});for(let d=0;d<o.length;d++){const u=o[d];r.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let d=0;d<l.length;d++)r.kerning.push({first:parseInt(l[d].getAttribute("first"),10),second:parseInt(l[d].getAttribute("second"),10),amount:parseInt(l[d].getAttribute("amount"),10)});for(let d=0;d<c.length;d++)r.distanceField.push({fieldType:c[d].getAttribute("fieldType"),distanceRange:parseInt(c[d].getAttribute("distanceRange"),10)});return r}}class Mm{static test(e){return typeof e=="string"&&e.includes("<font>")?jm.test(re.ADAPTER.parseXML(e)):!1}static parse(e){return jm.parse(re.ADAPTER.parseXML(e))}}const Ap=[xd,jm,Mm];function EL(t){for(let e=0;e<Ap.length;e++)if(Ap[e].test(t))return Ap[e];return null}function TL(t,e,r,n,i,s){const o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let l;const c=r.dropShadow?r.dropShadowDistance:0,d=r.padding||0,u=t.width/n-c-d*2,h=t.height/n-c-d*2,p=o.slice(),f=r.fillGradientStops.slice();if(!f.length){const m=p.length+1;for(let _=1;_<m;++_)f.push(_/m)}if(p.unshift(o[0]),f.unshift(0),p.push(o[o.length-1]),f.push(1),r.fillGradientType===qu.LINEAR_VERTICAL){l=e.createLinearGradient(u/2,d,u/2,h+d);let m=0;const _=(s.fontProperties.fontSize+r.strokeThickness)/h;for(let y=0;y<i.length;y++){const x=s.lineHeight*y;for(let v=0;v<p.length;v++){let g=0;typeof f[v]=="number"?g=f[v]:g=v/p.length;const b=x/h+g*_;let S=Math.max(m,b);S=Math.min(S,1),l.addColorStop(S,p[v]),m=S}}}else{l=e.createLinearGradient(d,h/2,u+d,h/2);const m=p.length+1;let _=1;for(let y=0;y<p.length;y++){let x;typeof f[y]=="number"?x=f[y]:x=_/m,l.addColorStop(x,p[y]),_++}}return l}function CL(t,e,r,n,i,s,o){const l=r.text,c=r.fontProperties;e.translate(n,i),e.scale(s,s);const d=o.strokeThickness/2,u=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=TL(t,e,o,s,[l],r),e.strokeStyle=o.stroke,o.dropShadow){const h=o.dropShadowColor,p=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor=qe.shared.setValue(h).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=p,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(l,d,u+r.lineHeight-c.descent),o.fill&&e.fillText(l,d,u+r.lineHeight-c.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function yd(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function XE(t){return Array.from?Array.from(t):t.split("")}function AL(t){typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let l=s,c=o;l<=c;l++)e.push(String.fromCharCode(l))}else e.push(...XE(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const ni=class dn{constructor(e,r,n){var u;const[i]=e.info,[s]=e.common,[o]=e.page,[l]=e.distanceField,c=Xn(o.file),d={};this._ownsTextures=n,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/c,this.chars={},this.pageTextures=d;for(let h=0;h<e.page.length;h++){const{id:p,file:f}=e.page[h];d[p]=r instanceof Array?r[h]:r[f],l!=null&&l.fieldType&&l.fieldType!=="none"&&(d[p].baseTexture.alphaMode=nr.NO_PREMULTIPLIED_ALPHA,d[p].baseTexture.mipmap=bn.OFF)}for(let h=0;h<e.char.length;h++){const{id:p,page:f}=e.char[h];let{x:m,y:_,width:y,height:x,xoffset:v,yoffset:g,xadvance:b}=e.char[h];m/=c,_/=c,y/=c,x/=c,v/=c,g/=c,b/=c;const S=new Ae(m+d[f].frame.x/c,_+d[f].frame.y/c,y,x);this.chars[p]={xOffset:v,yOffset:g,xAdvance:b,kerning:{},texture:new de(d[f].baseTexture,S),page:f}}for(let h=0;h<e.kerning.length;h++){let{first:p,second:f,amount:m}=e.kerning[h];p/=c,f/=c,m/=c,this.chars[f]&&(this.chars[f].kerning[p]=m)}this.distanceFieldRange=l==null?void 0:l.distanceRange,this.distanceFieldType=((u=l==null?void 0:l.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,r,n){let i;if(e instanceof fu)i=e;else{const o=EL(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof de&&(r=[r]);const s=new dn(i,r,n);return dn.available[s.font]=s,s}static uninstall(e){const r=dn.available[e];if(!r)throw new Error(`No font found named '${e}'`);r.destroy(),delete dn.available[e]}static from(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:l,textureHeight:c,...d}=Object.assign({},dn.defaultOptions,n),u=AL(i),h=r instanceof Dr?r:new Dr(r),p=l,f=new fu;f.info[0]={face:h.fontFamily,size:h.fontSize},f.common[0]={lineHeight:h.fontSize};let m=0,_=0,y,x,v,g=0;const b=[];for(let j=0;j<u.length;j++){y||(y=re.ADAPTER.createCanvas(),y.width=l,y.height=c,x=y.getContext("2d"),v=new Ee(y,{resolution:o,...d}),b.push(new de(v)),f.page.push({id:b.length-1,file:""}));const E=u[j],T=ai.measureText(E,h,!1,y),B=T.width,M=Math.ceil(T.height),F=Math.ceil((h.fontStyle==="italic"?2:1)*B);if(_>=c-M*o){if(_===0)throw new Error(`[BitmapFont] textureHeight ${c}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${E}')`);--j,y=null,x=null,v=null,_=0,m=0,g=0;continue}if(g=Math.max(M+T.fontProperties.descent,g),F*o+m>=p){if(m===0)throw new Error(`[BitmapFont] textureWidth ${l}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${E}')`);--j,_+=g*o,_=Math.ceil(_),m=0,g=0;continue}CL(y,x,T,m,_,o,h);const U=yd(T.text);f.char.push({id:U,page:b.length-1,x:m/o,y:_/o,width:F,height:M,xoffset:0,yoffset:0,xadvance:B-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0)}),m+=(F+2*s)*o,m=Math.ceil(m)}if(!(n!=null&&n.skipKerning))for(let j=0,E=u.length;j<E;j++){const T=u[j];for(let B=0;B<E;B++){const M=u[B],F=x.measureText(T).width,U=x.measureText(M).width,k=x.measureText(T+M).width-(F+U);k&&f.kerning.push({first:yd(T),second:yd(M),amount:k})}}const S=new dn(f,b,!0);return dn.available[e]!==void 0&&dn.uninstall(e),dn.available[e]=S,S}};ni.ALPHA=[["a","z"],["A","Z"]," "],ni.NUMERIC=[["0","9"]],ni.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],ni.ASCII=[[" ","~"]],ni.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ni.ALPHANUMERIC},ni.available={};let ii=ni;var kL=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,IL=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const s_=[],o_=[],a_=[],RL=class YE extends lr{constructor(e,r={}){super();const{align:n,tint:i,maxWidth:s,letterSpacing:o,fontName:l,fontSize:c}=Object.assign({},YE.styleDefaults,r);if(!ii.available[l])throw new Error(`Missing BitmapFont "${l}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new qe(i),this._font=void 0,this._fontName=l,this._fontSize=c,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Ln(()=>{this.dirty=!0},this,0,0),this._roundPixels=re.ROUND_PIXELS,this.dirty=!0,this._resolution=re.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var F;const e=ii.available[this._fontName],r=this.fontSize,n=r/e.size,i=new Ue,s=[],o=[],l=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",d=XE(c),u=this._maxWidth*e.size/r,h=e.distanceFieldType==="none"?s_:o_;let p=null,f=0,m=0,_=0,y=-1,x=0,v=0,g=0,b=0;for(let U=0;U<d.length;U++){const k=d[U],R=yd(k);if(/(?:\s)/.test(k)&&(y=U,x=f,b++),k==="\r"||k===`
`){o.push(f),l.push(-1),m=Math.max(m,f),++_,++v,i.x=0,i.y+=e.lineHeight,p=null,b=0;continue}const z=e.chars[R];if(!z)continue;p&&z.kerning[p]&&(i.x+=z.kerning[p]);const N=a_.pop()||{texture:de.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ue};N.texture=z.texture,N.line=_,N.charCode=R,N.position.x=Math.round(i.x+z.xOffset+this._letterSpacing/2),N.position.y=Math.round(i.y+z.yOffset),N.prevSpaces=b,s.push(N),f=N.position.x+Math.max(z.xAdvance-z.xOffset,z.texture.orig.width),i.x+=z.xAdvance+this._letterSpacing,g=Math.max(g,z.yOffset+z.texture.height),p=R,y!==-1&&u>0&&i.x>u&&(++v,So(s,1+y-v,1+U-y),U=y,y=-1,o.push(x),l.push(s.length>0?s[s.length-1].prevSpaces:0),m=Math.max(m,x),_++,i.x=0,i.y+=e.lineHeight,p=null,b=0)}const S=d[d.length-1];S!=="\r"&&S!==`
`&&(/(?:\s)/.test(S)&&(f=x),o.push(f),m=Math.max(m,f),l.push(-1));const j=[];for(let U=0;U<=_;U++){let k=0;this._align==="right"?k=m-o[U]:this._align==="center"?k=(m-o[U])/2:this._align==="justify"&&(k=l[U]<0?0:(m-o[U])/l[U]),j.push(k)}const E=s.length,T={},B=[],M=this._activePagesMeshData;h.push(...M);for(let U=0;U<E;U++){const k=s[U].texture,R=k.baseTexture.uid;if(!T[R]){let z=h.pop();if(!z){const P=new eL;let L,I;e.distanceFieldType==="none"?(L=new t_(de.EMPTY),I=be.NORMAL):(L=new t_(de.EMPTY,{program:Fn.from(IL,kL),uniforms:{uFWidth:0}}),I=be.NORMAL_NPM);const D=new e_(P,L);D.blendMode=I,z={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:D,vertices:null,uvs:null,indices:null}}z.index=0,z.indexCount=0,z.vertexCount=0,z.uvsCount=0,z.total=0;const{_textureCache:N}=this;N[R]=N[R]||new de(k.baseTexture),z.mesh.texture=N[R],z.mesh.tint=this._tintColor.value,B.push(z),T[R]=z}T[R].total++}for(let U=0;U<M.length;U++)B.includes(M[U])||this.removeChild(M[U].mesh);for(let U=0;U<B.length;U++)B[U].mesh.parent!==this&&this.addChild(B[U].mesh);this._activePagesMeshData=B;for(const U in T){const k=T[U],R=k.total;if(!(((F=k.indices)==null?void 0:F.length)>6*R)||k.vertices.length<e_.BATCHABLE_SIZE*2)k.vertices=new Float32Array(4*2*R),k.uvs=new Float32Array(4*2*R),k.indices=new Uint16Array(6*R);else{const z=k.total,N=k.vertices;for(let P=z*4*2;P<N.length;P++)N[P]=0}k.mesh.size=6*R}for(let U=0;U<E;U++){const k=s[U];let R=k.position.x+j[k.line]*(this._align==="justify"?k.prevSpaces:1);this._roundPixels&&(R=Math.round(R));const z=R*n,N=k.position.y*n,P=k.texture,L=T[P.baseTexture.uid],I=P.frame,D=P._uvs,C=L.index++;L.indices[C*6+0]=0+C*4,L.indices[C*6+1]=1+C*4,L.indices[C*6+2]=2+C*4,L.indices[C*6+3]=0+C*4,L.indices[C*6+4]=2+C*4,L.indices[C*6+5]=3+C*4,L.vertices[C*8+0]=z,L.vertices[C*8+1]=N,L.vertices[C*8+2]=z+I.width*n,L.vertices[C*8+3]=N,L.vertices[C*8+4]=z+I.width*n,L.vertices[C*8+5]=N+I.height*n,L.vertices[C*8+6]=z,L.vertices[C*8+7]=N+I.height*n,L.uvs[C*8+0]=D.x0,L.uvs[C*8+1]=D.y0,L.uvs[C*8+2]=D.x1,L.uvs[C*8+3]=D.y1,L.uvs[C*8+4]=D.x2,L.uvs[C*8+5]=D.y2,L.uvs[C*8+6]=D.x3,L.uvs[C*8+7]=D.y3}this._textWidth=m*n,this._textHeight=(i.y+e.lineHeight)*n;for(const U in T){const k=T[U];if(this.anchor.x!==0||this.anchor.y!==0){let P=0;const L=this._textWidth*this.anchor.x,I=this._textHeight*this.anchor.y;for(let D=0;D<k.total;D++)k.vertices[P++]-=L,k.vertices[P++]-=I,k.vertices[P++]-=L,k.vertices[P++]-=I,k.vertices[P++]-=L,k.vertices[P++]-=I,k.vertices[P++]-=L,k.vertices[P++]-=I}this._maxLineHeight=g*n;const R=k.mesh.geometry.getBuffer("aVertexPosition"),z=k.mesh.geometry.getBuffer("aTextureCoord"),N=k.mesh.geometry.getIndex();R.data=k.vertices,z.data=k.uvs,N.data=k.indices,R.update(),z.update(),N.update()}for(let U=0;U<s.length;U++)a_.push(s[U]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:r,distanceFieldType:n,size:i}=ii.available[this._fontName];if(n!=="none"){const{a:s,b:o,c:l,d:c}=this.worldTransform,d=Math.sqrt(s*s+o*o),u=Math.sqrt(l*l+c*c),h=(Math.abs(d)+Math.abs(u))/2,p=this.fontSize/i,f=e._view.resolution;for(const m of this._activePagesMeshData)m.mesh.shader.uniforms.uFWidth=h*r*p*f}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=ii.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!ii.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??ii.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:r}=this,n=ii.available[this._fontName].distanceFieldType==="none"?s_:o_;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>r[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=de.EMPTY});for(const i in r)r[i].destroy(),delete r[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};RL.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const PL=[".xml",".fnt"],jL={extension:{type:Q.LoadParser,priority:tn.Normal},name:"loadBitmapFont",test(t){return PL.includes(jt.extname(t).toLowerCase())},async testParse(t){return xd.test(t)||Mm.test(t)},async parse(t,e,r){const n=xd.test(t)?xd.parse(t):Mm.parse(t),{src:i}=e,{page:s}=n,o=[];for(let d=0;d<s.length;++d){const u=s[d].file;let h=jt.join(jt.dirname(i),u);h=Cm(h,i),o.push(h)}const l=await r.load(o),c=o.map(d=>l[d]);return ii.install(n,c,!0)},async load(t,e){return(await re.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};ue.add(jL);const Nm=class qs extends Dr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new qs(Object.keys(qs.defaultOptions).reduce((r,n)=>({...r,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete qs.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,r={}){const{availableFonts:n}=qs;if(n[e]){const i=n[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return re.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,o)=>{const l=URL.createObjectURL(i),c=new FileReader;c.onload=()=>s([l,c.result]),c.onerror=o,c.readAsDataURL(i)})).then(async([i,s])=>{const o=Object.assign({family:jt.basename(e,jt.extname(e)),weight:"normal",style:"normal",display:"auto",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},r);n[e]=o,this._fonts.push(o),this.styleID++;const l=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=l,await l.load(),document.fonts.add(l),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const r=e.filter(n=>!this._overrides.includes(n));r.length>0&&(this._overrides.push(...r),this.styleID++)}removeOverride(...e){const r=e.filter(n=>this._overrides.includes(n));r.length>0&&(this._overrides=this._overrides.filter(n=>!r.includes(n)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,r)=>`${e}
            @font-face {
                font-family: "${r.family}";
                src: url('${r.dataSrc}');
                font-weight: ${r.weight};
                font-style: ${r.style};
                font-display: ${r.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=bM(e)),typeof e=="number"?_M(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const r=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&r<1&&(e+=(r*255|0).toString(16).padStart(2,"0"));const s=`${n}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,qs.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(r=>setTimeout(r,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=re.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};Nm.availableFonts={},Nm.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let kp=Nm;const Uc=class Zs extends ji{constructor(e="",r={}){super(de.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,i=de.from(n,{scaleMode:re.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new Ae,i.trim=new Ae,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",l=document.createElementNS(s,"svg"),c=document.createElementNS(s,"foreignObject"),d=document.createElementNS(o,"div"),u=document.createElementNS(o,"style");c.setAttribute("width","10000"),c.setAttribute("height","10000"),c.style.overflow="hidden",l.appendChild(c),this.maxWidth=Zs.defaultMaxWidth,this.maxHeight=Zs.defaultMaxHeight,this._domElement=d,this._styleElement=u,this._svgRoot=l,this._foreignObject=c,this._foreignObject.appendChild(u),this._foreignObject.appendChild(d),this._image=n,this._loadImage=new Image,this._autoResolution=Zs.defaultAutoResolution,this._resolution=Zs.defaultResolution??re.RESOLUTION,this.text=e,this.style=r}measureText(e){var u,h;const{text:r,style:n,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:r,style:n.toCSS(i)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:l}=s;(o>this.maxWidth||l>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const c=Math.min(this.maxWidth,Math.ceil(o)),d=Math.min(this.maxHeight,Math.ceil(l));return this._svgRoot.setAttribute("width",c.toString()),this._svgRoot.setAttribute("height",d.toString()),r!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(u=this._style)==null?void 0:u.toCSS(i)}),this._styleElement.textContent=(h=this._style)==null?void 0:h.toGlobalCSS()),{width:c+n.padding*2,height:d+n.padding*2}}async updateText(e=!0){const{style:r,_image:n,_loadImage:i}=this;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();n.width=i.width=Math.ceil(Math.max(1,s)),n.height=i.height=Math.ceil(Math.max(1,o)),this._updateID++;const l=this._updateID;await new Promise(c=>{i.onload=async()=>{if(l<this._updateID){c();return}await r.onBeforeDraw(),n.src=i.src,i.onload=null,i.src="",this.updateTexture(),c()};const d=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(d)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:r,_image:n,resolution:i}=this,{padding:s}=e,{baseTexture:o}=r;r.trim.width=r._frame.width=n.width/i,r.trim.height=r._frame.height=n.height/i,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-s*2,r.orig.height=r._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(n.width,n.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var n,i,s,o,l;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Zs.defaultDestroyOptions,e),super.destroy(e);const r=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=r,(i=this._svgRoot)==null||i.remove(),this._svgRoot=r,(s=this._domElement)==null||s.remove(),this._domElement=r,(o=this._foreignObject)==null||o.remove(),this._foreignObject=r,(l=this._styleElement)==null||l.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const r=gi(this.scale.x)||1;this.scale.x=r*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const r=gi(this.scale.y)||1;this.scale.y=r*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof kp?(this.ownsStyle=!1,this._style=e):e instanceof Dr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=kp.from(e)):(this.ownsStyle=!0,this._style=new kp(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};Uc.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Uc.defaultMaxWidth=2024,Uc.defaultMaxHeight=2024,Uc.defaultAutoResolution=!0;const ir={background:1710638,surface:2960708,hitZone:16098851,laneLeft:2972199,laneRight:4886745,textMuted:10526896,perfect:5025616,partial:16098851,miss:15037299},ML=.72,Ip=85,Bm=.82,l_=new Map;async function c_(t){const e=`/${t}`,r=l_.get(t);if(r)return r;const n=(async()=>{try{console.log(`[Texture] Loading: ${e}`);const i=await Ba.load(e);return!i||!i.valid?(console.error(`[Texture] Invalid texture loaded: ${t}`,{fullPath:e,texture:i}),null):(console.log(`[Texture] Success: ${t}`),i)}catch(i){return console.error(`[Texture] Failed to load: ${t}`,{fullPath:e,error:i}),null}})();return l_.set(t,n),n}function NL({width:t,height:e,scheduledEvents:r,activeEvents:n,roundStartTime:i,roundState:s,scrollSpeed:o,currentFeedback:l,onChannelTap:c,trainingMode:d=!1,spectrogramMode:u="full"}){const h=w.useRef(null),p=w.useRef(null),f=w.useRef(new Map),m=w.useRef(null),_=w.useCallback(y=>{var E;if(!c||!h.current)return;let x;"touches"in y?x=((E=y.touches[0])==null?void 0:E.clientX)??0:x=y.clientX;const v=h.current.getBoundingClientRect(),g=x-v.left,b=v.width/2,S=v.width*.1;if(Math.abs(g-b)<S/2)return;const j=g<b?"left":"right";c(j)},[c]);return w.useEffect(()=>{if(!h.current)return;const y=new CE({width:t,height:e,backgroundColor:ir.background,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0});h.current.appendChild(y.view),p.current=y,u_(y,t,e),h_(y,t,e),p_(y,t,e);const x=new lr;return y.stage.addChild(x),m.current=x,()=>{p.current&&(p.current.destroy(!0,{children:!0}),p.current=null),f.current.clear()}},[t,e]),w.useEffect(()=>{if(p.current){p.current.renderer.resize(t,e);const y=p.current;for(;y.stage.children.length>0;)y.stage.removeChildAt(0);u_(y,t,e),h_(y,t,e),p_(y,t,e);const x=new lr;y.stage.addChild(x),m.current=x,f.current.clear()}},[t,e]),w.useEffect(()=>{const y=m.current;if(!y)return;if(s!=="playing"){y.removeChildren(),f.current.clear();return}if(r.length===0)return;const x=t/2,v=x*ML,g=e*Bm;for(const b of r){if(f.current.has(b.event_id))continue;const S=BL(b,x,v,Ip,g,b.spectrogramPath,d,u);S.container.y=-Ip,y.addChild(S.container),f.current.set(b.event_id,S)}},[r,s,t,e,d,u]),w.useEffect(()=>{if(s!=="playing"||!p.current)return;const y=e*Bm;let x;const v=()=>{const g=performance.now(),b=g-i;for(const S of f.current.values())if(S.hasBeenScored&&S.feedbackType){const j=g-S.feedbackStartTime;j>500&&(S.container.alpha=Math.max(0,1-(j-500)/200),S.container.alpha<=0&&(S.container.visible=!1))}else{const j=S.scheduledTimeMs-S.enterTimeMs,E=b-S.enterTimeMs,T=Math.max(0,E/j),B=-Ip,M=y;if(S.container.y=B+T*(M-B),u==="fading"){const F=S.container.getChildByName("spectrogram");F&&(T<.3?F.alpha=1:T<.8?F.alpha=1-(T-.3)/.5:F.alpha=0)}S.container.y>y+100&&(S.container.alpha=Math.max(0,1-(S.container.y-y-100)/50))}x=requestAnimationFrame(v)};return x=requestAnimationFrame(v),()=>{cancelAnimationFrame(x)}},[s,i,e,o,u]),w.useEffect(()=>{var y;if(l){for(const x of n)if(x.hasBeenScored&&x.channel===l.channel){const v=f.current.get(x.event_id);v&&!v.feedbackType&&(v.hasBeenScored=!0,v.feedbackType=l.type,v.feedbackStartTime=performance.now(),((y=l.breakdown)==null?void 0:y.speciesCorrect)?(d_(v,l.type,l.score),v.container.scale.set(1.3),setTimeout(()=>{v.container.visible=!1},400)):d_(v,l.type,l.score))}}},[l,n]),a.jsx("div",{ref:h,className:"pixi-game-container",onClick:_,onTouchStart:_,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none"}})}function BL(t,e,r,n,i,s,o=!1,l="full"){const c=new lr,d=t.channel==="left"?e/2:e+e/2;c.x=d;const u=t.channel==="left"?ir.laneLeft:ir.laneRight,h=new gr;h.beginFill(u,.4),h.lineStyle(2,u,.8),h.drawRoundedRect(-r/2,-n/2,r,n,8),h.endFill(),c.addChild(h);const p=l!=="none"&&s;if(p&&c_(s).then(f=>{if(f&&c.parent){const m=new ji(f);m.anchor.set(.5),m.position.set(0,0);const _=r-16,y=n-16;m.width=_,m.height=y,m.name="spectrogram",c.addChildAt(m,1),console.log(`[Sprite] Added spectrogram to tile: ${s}`)}else f?c.parent||console.warn(`[Sprite] Container removed before sprite could be added: ${s}`):console.error(`[Sprite] Texture null for: ${s}`)}),!p){const f=new gr;for(let y=0;y<6;y++){const x=-n/2+10+y*10,v=(Math.random()*.4+.4)*r,g=-v/2+(Math.random()-.5)*20;f.beginFill(16777215,.2+Math.random()*.2),f.drawRect(g,x,v,2),f.endFill()}c.addChild(f);const m=new Dr({fontFamily:"Inter, sans-serif",fontSize:18,fill:16777215,fontWeight:"700"}),_=new ws("?",m);_.anchor.set(.5),_.position.set(0,0),_.alpha=.4,c.addChild(_)}if(o){const f=new Dr({fontFamily:"Inter, sans-serif",fontSize:10,fill:16777215,fontWeight:"700"}),m=new ws(t.tileName||t.displayCode||t.species_code,f);m.anchor.set(.5),m.position.set(r/2-20,-n/2+44),m.alpha=.8;const _=new gr;_.beginFill(0,.7);const y=3,x=m.width+y*2,v=m.height+y*2;_.drawRoundedRect(-x/2,-v/2,x,v,2),_.endFill(),_.position.set(m.position.x,m.position.y),c.addChild(_),c.addChild(m);const g=`data/icons/${t.species_code}.png`;c_(g).then(b=>{if(b&&c.parent){const S=new ji(b);S.anchor.set(.5),S.width=32,S.height=32,S.position.set(r/2-20,-n/2+20),S.alpha=.9,c.addChild(S)}})}return{container:c,eventId:t.event_id,scheduledTimeMs:t.scheduled_time_ms,enterTimeMs:t.scoring_window_start_ms,channel:t.channel,speciesCode:t.species_code,hasBeenScored:!1,feedbackType:null,feedbackStartTime:0,spectrogramPath:s}}function d_(t,e,r){const n=t.container,i=e==="perfect"||e==="good"?ir.perfect:e==="partial"?ir.partial:ir.miss,s=new gr,o=100,l=70;if(s.beginFill(i,.5),s.drawRoundedRect(-o/2,-l/2,o,l,8),s.endFill(),n.addChildAt(s,1),r>0){const c=new Dr({fontFamily:"JetBrains Mono, monospace",fontSize:20,fontWeight:"700",fill:i,stroke:0,strokeThickness:3}),d=new ws(`+${r}`,c);d.anchor.set(.5),d.position.set(0,-l/2-15),n.addChild(d)}n.scale.set(1.1),setTimeout(()=>{n.scale.set(1)},100)}function u_(t,e,r){const n=e/2,i=new gr;i.beginFill(ir.background,1),i.drawRect(0,0,n-1,r),i.endFill(),t.stage.addChild(i);const s=new gr;s.beginFill(ir.background,1),s.drawRect(n+1,0,n-1,r),s.endFill(),t.stage.addChild(s);const o=new Dr({fontFamily:"Inter, sans-serif",fontSize:14,fill:ir.textMuted,fontWeight:"600"}),l=new ws("LEFT",o);l.anchor.set(.5),l.position.set(n/2,30),l.alpha=.5,t.stage.addChild(l);const c=new ws("RIGHT",o);c.anchor.set(.5),c.position.set(n+n/2,30),c.alpha=.5,t.stage.addChild(c)}function h_(t,e,r){const n=e/2,i=r*Bm,s=4,o=new gr;o.beginFill(ir.hitZone,.8),o.drawRect(20,i,n-40,s),o.endFill(),t.stage.addChild(o);const l=new gr;l.beginFill(ir.hitZone,.8),l.drawRect(n+20,i,n-40,s),l.endFill(),t.stage.addChild(l);const c=new gr;c.beginFill(ir.hitZone,.2),c.drawRect(20,i-2,n-40,s+4),c.endFill(),t.stage.addChild(c);const d=new gr;d.beginFill(ir.hitZone,.2),d.drawRect(n+20,i-2,n-40,s+4),d.endFill(),t.stage.addChild(d)}function p_(t,e,r){const n=e/2,i=new gr,s=20,o=10;let l=0;for(i.beginFill(ir.surface,.5);l<r;)i.drawRect(n-1,l,2,s),l+=s+o;i.endFill(),t.stage.addChild(i)}const DL=w.memo(NL),Ce=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Ge=globalThis,ps="10.38.0";function Zu(){return Ju(Ge),Ge}function Ju(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||ps,e[ps]=e[ps]||{}}function Jo(t,e,r=Ge){const n=r.__SENTRY__=r.__SENTRY__||{},i=n[ps]=n[ps]||{};return i[t]||(i[t]=e())}const LL=["debug","info","warn","error","log","assert","trace"],FL="Sentry Logger ",mu={};function Qo(t){if(!("console"in Ge))return t();const e=Ge.console,r={},n=Object.keys(mu);n.forEach(i=>{const s=mu[i];r[i]=e[i],e[i]=s});try{return t()}finally{n.forEach(i=>{e[i]=r[i]})}}function OL(){px().enabled=!0}function UL(){px().enabled=!1}function KE(){return px().enabled}function zL(...t){hx("log",...t)}function $L(...t){hx("warn",...t)}function GL(...t){hx("error",...t)}function hx(t,...e){Ce&&KE()&&Qo(()=>{Ge.console[t](`${FL}[${t}]:`,...e)})}function px(){return Ce?Jo("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const _e={enable:OL,disable:UL,isEnabled:KE,log:zL,warn:$L,error:GL},qE=50,Ss="?",f_=/\(error: (.*)\)/,m_=/captureMessage|captureException/;function ZE(...t){const e=t.sort((r,n)=>r[0]-n[0]).map(r=>r[1]);return(r,n=0,i=0)=>{const s=[],o=r.split(`
`);for(let l=n;l<o.length;l++){let c=o[l];c.length>1024&&(c=c.slice(0,1024));const d=f_.test(c)?c.replace(f_,"$1"):c;if(!d.match(/\S*Error: /)){for(const u of e){const h=u(d);if(h){s.push(h);break}}if(s.length>=qE+i)break}}return WL(s.slice(i))}}function HL(t){return Array.isArray(t)?ZE(...t):t}function WL(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(zc(e).function||"")&&e.pop(),e.reverse(),m_.test(zc(e).function||"")&&(e.pop(),m_.test(zc(e).function||"")&&e.pop()),e.slice(0,qE).map(r=>({...r,filename:r.filename||zc(e).filename,function:r.function||Ss}))}function zc(t){return t[t.length-1]||{}}const Rp="<anonymous>";function Mi(t){try{return!t||typeof t!="function"?Rp:t.name||Rp}catch{return Rp}}function g_(t){const e=t.exception;if(e){const r=[];try{return e.values.forEach(n=>{n.stacktrace.frames&&r.push(...n.stacktrace.frames)}),r}catch{return}}}function JE(t){return"__v_isVNode"in t&&t.__v_isVNode?"[VueVNode]":"[VueViewModel]"}const vd={},x_={};function Ps(t,e){vd[t]=vd[t]||[],vd[t].push(e)}function js(t,e){if(!x_[t]){x_[t]=!0;try{e()}catch(r){Ce&&_e.error(`Error while instrumenting ${t}`,r)}}}function Qr(t,e){const r=t&&vd[t];if(r)for(const n of r)try{n(e)}catch(i){Ce&&_e.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Mi(n)}
Error:`,i)}}let Pp=null;function VL(t){const e="error";Ps(e,t),js(e,XL)}function XL(){Pp=Ge.onerror,Ge.onerror=function(t,e,r,n,i){return Qr("error",{column:n,error:i,line:r,msg:t,url:e}),Pp?Pp.apply(this,arguments):!1},Ge.onerror.__SENTRY_INSTRUMENTED__=!0}let jp=null;function YL(t){const e="unhandledrejection";Ps(e,t),js(e,KL)}function KL(){jp=Ge.onunhandledrejection,Ge.onunhandledrejection=function(t){return Qr("unhandledrejection",t),jp?jp.apply(this,arguments):!0},Ge.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const QE=Object.prototype.toString;function Gl(t){switch(QE.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Ni(t,Error)}}function ea(t,e){return QE.call(t)===`[object ${e}]`}function eT(t){return ea(t,"ErrorEvent")}function y_(t){return ea(t,"DOMError")}function qL(t){return ea(t,"DOMException")}function zn(t){return ea(t,"String")}function fx(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Qu(t){return t===null||fx(t)||typeof t!="object"&&typeof t!="function"}function Al(t){return ea(t,"Object")}function eh(t){return typeof Event<"u"&&Ni(t,Event)}function ZL(t){return typeof Element<"u"&&Ni(t,Element)}function JL(t){return ea(t,"RegExp")}function Hl(t){return!!(t!=null&&t.then&&typeof t.then=="function")}function QL(t){return Al(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function Ni(t,e){try{return t instanceof e}catch{return!1}}function tT(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue||t.__v_isVNode))}function rT(t){return typeof Request<"u"&&Ni(t,Request)}const mx=Ge,eF=80;function nT(t,e={}){if(!t)return"<unknown>";try{let r=t;const n=5,i=[];let s=0,o=0;const l=" > ",c=l.length;let d;const u=Array.isArray(e)?e:e.keyAttrs,h=!Array.isArray(e)&&e.maxStringLength||eF;for(;r&&s++<n&&(d=tF(r,u),!(d==="html"||s>1&&o+i.length*c+d.length>=h));)i.push(d),o+=d.length,r=r.parentNode;return i.reverse().join(l)}catch{return"<unknown>"}}function tF(t,e){const r=t,n=[];if(!(r!=null&&r.tagName))return"";if(mx.HTMLElement&&r instanceof HTMLElement&&r.dataset){if(r.dataset.sentryComponent)return r.dataset.sentryComponent;if(r.dataset.sentryElement)return r.dataset.sentryElement}n.push(r.tagName.toLowerCase());const i=e!=null&&e.length?e.filter(o=>r.getAttribute(o)).map(o=>[o,r.getAttribute(o)]):null;if(i!=null&&i.length)i.forEach(o=>{n.push(`[${o[0]}="${o[1]}"]`)});else{r.id&&n.push(`#${r.id}`);const o=r.className;if(o&&zn(o)){const l=o.split(/\s+/);for(const c of l)n.push(`.${c}`)}}const s=["aria-label","type","name","title","alt"];for(const o of s){const l=r.getAttribute(o);l&&n.push(`[${o}="${l}"]`)}return n.join("")}function gx(){try{return mx.document.location.href}catch{return""}}function rF(t){if(!mx.HTMLElement)return null;let e=t;const r=5;for(let n=0;n<r;n++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function xr(t,e,r){if(!(e in t))return;const n=t[e];if(typeof n!="function")return;const i=r(n);typeof i=="function"&&iT(i,n);try{t[e]=i}catch{Ce&&_e.log(`Failed to replace method "${e}" in object`,t)}}function Bi(t,e,r){try{Object.defineProperty(t,e,{value:r,writable:!0,configurable:!0})}catch{Ce&&_e.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function iT(t,e){try{const r=e.prototype||{};t.prototype=e.prototype=r,Bi(t,"__sentry_original__",e)}catch{}}function xx(t){return t.__sentry_original__}function sT(t){if(Gl(t))return{message:t.message,name:t.name,stack:t.stack,...__(t)};if(eh(t)){const e={type:t.type,target:v_(t.target),currentTarget:v_(t.currentTarget),...__(t)};return typeof CustomEvent<"u"&&Ni(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function v_(t){try{return ZL(t)?nT(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function __(t){if(typeof t=="object"&&t!==null){const e={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}else return{}}function nF(t){const e=Object.keys(sT(t));return e.sort(),e[0]?e.join(", "):"[object has no keys]"}let $s;function th(t){if($s!==void 0)return $s?$s(t):t();const e=Symbol.for("__SENTRY_SAFE_RANDOM_ID_WRAPPER__"),r=Ge;return e in r&&typeof r[e]=="function"?($s=r[e],$s(t)):($s=null,t())}function gu(){return th(()=>Math.random())}function rh(){return th(()=>Date.now())}function Dm(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function b_(t,e){if(!Array.isArray(t))return"";const r=[];for(let n=0;n<t.length;n++){const i=t[n];try{tT(i)?r.push(JE(i)):r.push(String(i))}catch{r.push("[value cannot be serialized]")}}return r.join(e)}function _d(t,e,r=!1){return zn(t)?JL(e)?e.test(t):zn(e)?r?t===e:t.includes(e):!1:!1}function nh(t,e=[],r=!1){return e.some(n=>_d(t,n,r))}function iF(){const t=Ge;return t.crypto||t.msCrypto}let Mp;function sF(){return gu()*16}function Mr(t=iF()){try{if(t!=null&&t.randomUUID)return th(()=>t.randomUUID()).replace(/-/g,"")}catch{}return Mp||(Mp="10000000100040008000"+1e11),Mp.replace(/[018]/g,e=>(e^(sF()&15)>>e/4).toString(16))}function oT(t){var e,r;return(r=(e=t.exception)==null?void 0:e.values)==null?void 0:r[0]}function is(t){const{message:e,event_id:r}=t;if(e)return e;const n=oT(t);return n?n.type&&n.value?`${n.type}: ${n.value}`:n.type||n.value||r||"<unknown>":r||"<unknown>"}function Lm(t,e,r){const n=t.exception=t.exception||{},i=n.values=n.values||[],s=i[0]=i[0]||{};s.value||(s.value=e||""),s.type||(s.type="Error")}function Oo(t,e){const r=oT(t);if(!r)return;const n={type:"generic",handled:!0},i=r.mechanism;if(r.mechanism={...n,...i,...e},e&&"data"in e){const s={...i==null?void 0:i.data,...e.data};r.mechanism.data=s}}function w_(t){if(oF(t))return!0;try{Bi(t,"__sentry_captured__",!0)}catch{}return!1}function oF(t){try{return t.__sentry_captured__}catch{}}const aT=1e3;function Wl(){return rh()/aT}function aF(){const{performance:t}=Ge;if(!(t!=null&&t.now)||!t.timeOrigin)return Wl;const e=t.timeOrigin;return()=>(e+th(()=>t.now()))/aT}let S_;function $n(){return(S_??(S_=aF()))()}function lF(t){const e=$n(),r={sid:Mr(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>dF(r)};return t&&Uo(r,t),r}function Uo(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||$n(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Mr()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const r=t.timestamp-t.started;t.duration=r>=0?r:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function cF(t,e){let r={};t.status==="ok"&&(r={status:"exited"}),Uo(t,r)}function dF(t){return{sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}}}function Vl(t,e,r=2){if(!e||typeof e!="object"||r<=0)return e;if(t&&Object.keys(e).length===0)return t;const n={...t};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=Vl(n[i],e[i],r-1));return n}function E_(){return Mr()}function lT(){return Mr().substring(16)}const Fm="_sentrySpan";function T_(t,e){e?Bi(t,Fm,e):delete t[Fm]}function C_(t){return t[Fm]}const uF=100;class wn{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:E_(),sampleRand:gu()}}clone(){const e=new wn;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._attributes={...this._attributes},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,e._conversationId=this._conversationId,T_(e,C_(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Uo(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setConversationId(e){return this._conversationId=e||void 0,this._notifyScopeListeners(),this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,r){return this.setTags({[e]:r})}setAttributes(e){return this._attributes={...this._attributes,...e},this._notifyScopeListeners(),this}setAttribute(e,r){return this.setAttributes({[e]:r})}removeAttribute(e){return e in this._attributes&&(delete this._attributes[e],this._notifyScopeListeners()),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,r){return this._extra={...this._extra,[e]:r},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,r){return r===null?delete this._contexts[e]:this._contexts[e]=r,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const r=typeof e=="function"?e(this):e,n=r instanceof wn?r.getScopeData():Al(r)?e:void 0,{tags:i,attributes:s,extra:o,user:l,contexts:c,level:d,fingerprint:u=[],propagationContext:h,conversationId:p}=n||{};return this._tags={...this._tags,...i},this._attributes={...this._attributes,...s},this._extra={...this._extra,...o},this._contexts={...this._contexts,...c},l&&Object.keys(l).length&&(this._user=l),d&&(this._level=d),u.length&&(this._fingerprint=u),h&&(this._propagationContext=h),p&&(this._conversationId=p),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,this._conversationId=void 0,T_(this,void 0),this._attachments=[],this.setPropagationContext({traceId:E_(),sampleRand:gu()}),this._notifyScopeListeners(),this}addBreadcrumb(e,r){var s;const n=typeof r=="number"?r:uF;if(n<=0)return this;const i={timestamp:Wl(),...e,message:e.message?Dm(e.message,2048):e.message};return this._breadcrumbs.push(i),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),(s=this._client)==null||s.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:C_(this),conversationId:this._conversationId}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Vl(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,r){const n=(r==null?void 0:r.event_id)||Mr();if(!this._client)return Ce&&_e.warn("No client configured on scope - will not capture exception!"),n;const i=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...r,event_id:n},this),n}captureMessage(e,r,n){const i=(n==null?void 0:n.event_id)||Mr();if(!this._client)return Ce&&_e.warn("No client configured on scope - will not capture message!"),i;const s=(n==null?void 0:n.syntheticException)??new Error(e);return this._client.captureMessage(e,r,{originalException:e,syntheticException:s,...n,event_id:i},this),i}captureEvent(e,r){const n=(r==null?void 0:r.event_id)||Mr();return this._client?(this._client.captureEvent(e,{...r,event_id:n},this),n):(Ce&&_e.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function hF(){return Jo("defaultCurrentScope",()=>new wn)}function pF(){return Jo("defaultIsolationScope",()=>new wn)}class fF{constructor(e,r){let n;e?n=e:n=new wn;let i;r?i=r:i=new wn,this._stack=[{scope:n}],this._isolationScope=i}withScope(e){const r=this._pushScope();let n;try{n=e(r)}catch(i){throw this._popScope(),i}return Hl(n)?n.then(i=>(this._popScope(),i),i=>{throw this._popScope(),i}):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function zo(){const t=Zu(),e=Ju(t);return e.stack=e.stack||new fF(hF(),pF())}function mF(t){return zo().withScope(t)}function gF(t,e){const r=zo();return r.withScope(()=>(r.getStackTop().scope=t,e(t)))}function A_(t){return zo().withScope(()=>t(zo().getIsolationScope()))}function xF(){return{withIsolationScope:A_,withScope:mF,withSetScope:gF,withSetIsolationScope:(t,e)=>A_(e),getCurrentScope:()=>zo().getScope(),getIsolationScope:()=>zo().getIsolationScope()}}function yx(t){const e=Ju(t);return e.acs?e.acs:xF()}function Tn(){const t=Zu();return yx(t).getCurrentScope()}function $i(){const t=Zu();return yx(t).getIsolationScope()}function yF(){return Jo("globalScope",()=>new wn)}function vx(...t){const e=Zu(),r=yx(e);if(t.length===2){const[n,i]=t;return n?r.withSetScope(n,i):r.withScope(i)}return r.withScope(t[0])}function Mt(){return Tn().getClient()}function vF(t){const e=t.getPropagationContext(),{traceId:r,parentSpanId:n,propagationSpanId:i}=e,s={trace_id:r,span_id:i||lT()};return n&&(s.parent_span_id=n),s}const _F="sentry.source",bF="sentry.sample_rate",wF="sentry.previous_trace_sample_rate",SF="sentry.op",EF="sentry.origin",cT="sentry.profile_id",dT="sentry.exclusive_time",TF="gen_ai.conversation.id",CF=0,AF=1,kF="_sentryScope",IF="_sentryIsolationScope";function RF(t){if(t){if(typeof t=="object"&&"deref"in t&&typeof t.deref=="function")try{return t.deref()}catch{return}return t}}function uT(t){const e=t;return{scope:e[kF],isolationScope:RF(e[IF])}}const PF="sentry-",jF=/^sentry-/;function MF(t){const e=NF(t);if(!e)return;const r=Object.entries(e).reduce((n,[i,s])=>{if(i.match(jF)){const o=i.slice(PF.length);n[o]=s}return n},{});if(Object.keys(r).length>0)return r}function NF(t){if(!(!t||!zn(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,r)=>{const n=k_(r);return Object.entries(n).forEach(([i,s])=>{e[i]=s}),e},{}):k_(t)}function k_(t){return t.split(",").map(e=>{const r=e.indexOf("=");if(r===-1)return[];const n=e.slice(0,r),i=e.slice(r+1);return[n,i].map(s=>{try{return decodeURIComponent(s.trim())}catch{return}})}).reduce((e,[r,n])=>(r&&n&&(e[r]=n),e),{})}const BF=/^o(\d+)\./,DF=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)((?:\[[:.%\w]+\]|[\w.-]+))(?::(\d+))?\/(.+)/;function LF(t){return t==="http"||t==="https"}function ta(t,e=!1){const{host:r,path:n,pass:i,port:s,projectId:o,protocol:l,publicKey:c}=t;return`${l}://${c}${e&&i?`:${i}`:""}@${r}${s?`:${s}`:""}/${n&&`${n}/`}${o}`}function FF(t){const e=DF.exec(t);if(!e){Qo(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[r,n,i="",s="",o="",l=""]=e.slice(1);let c="",d=l;const u=d.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),d=u.pop()),d){const h=d.match(/^\d+/);h&&(d=h[0])}return hT({host:s,pass:i,path:c,projectId:d,port:o,protocol:r,publicKey:n})}function hT(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function OF(t){if(!Ce)return!0;const{port:e,projectId:r,protocol:n}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(_e.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:r.match(/^\d+$/)?LF(n)?e&&isNaN(parseInt(e,10))?(_e.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(_e.error(`Invalid Sentry Dsn: Invalid protocol ${n}`),!1):(_e.error(`Invalid Sentry Dsn: Invalid projectId ${r}`),!1)}function UF(t){const e=t.match(BF);return e==null?void 0:e[1]}function zF(t){const e=t.getOptions(),{host:r}=t.getDsn()||{};let n;return e.orgId?n=String(e.orgId):r&&(n=UF(r)),n}function pT(t){const e=typeof t=="string"?FF(t):hT(t);if(!(!e||!OF(e)))return e}function $F(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const fT=1;let I_=!1;function GF(t){const{spanId:e,traceId:r,isRemote:n}=t.spanContext(),i=n?e:_x(t).parent_span_id,s=uT(t).scope,o=n?(s==null?void 0:s.getPropagationContext().propagationSpanId)||lT():e;return{parent_span_id:i,span_id:o,trace_id:r}}function HF(t){if(t&&t.length>0)return t.map(({context:{spanId:e,traceId:r,traceFlags:n,...i},attributes:s})=>({span_id:e,trace_id:r,sampled:n===fT,attributes:s,...i}))}function R_(t){return typeof t=="number"?P_(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?P_(t.getTime()):$n()}function P_(t){return t>9999999999?t/1e3:t}function _x(t){var n;if(VF(t))return t.getSpanJSON();const{spanId:e,traceId:r}=t.spanContext();if(WF(t)){const{attributes:i,startTime:s,name:o,endTime:l,status:c,links:d}=t,u="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(n=t.parentSpanContext)==null?void 0:n.spanId:void 0;return{span_id:e,trace_id:r,data:i,description:o,parent_span_id:u,start_timestamp:R_(s),timestamp:R_(l)||void 0,status:YF(c),op:i[SF],origin:i[EF],links:HF(d)}}return{span_id:e,trace_id:r,start_timestamp:0,data:{}}}function WF(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function VF(t){return typeof t.getSpanJSON=="function"}function XF(t){const{traceFlags:e}=t.spanContext();return e===fT}function YF(t){if(!(!t||t.code===CF))return t.code===AF?"ok":t.message||"internal_error"}const KF="_sentryRootSpan";function mT(t){return t[KF]||t}function j_(){I_||(Qo(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly or use `ignoreSpans`.")}),I_=!0)}function qF(t){var r;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=(r=Mt())==null?void 0:r.getOptions();return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}function M_(t){_e.log(`Ignoring span ${t.op} - ${t.description} because it matches \`ignoreSpans\`.`)}function N_(t,e){if(!(e!=null&&e.length)||!t.description)return!1;for(const r of e){if(JF(r)){if(_d(t.description,r))return Ce&&M_(t),!0;continue}if(!r.name&&!r.op)continue;const n=r.name?_d(t.description,r.name):!0,i=r.op?t.op&&_d(t.op,r.op):!0;if(n&&i)return Ce&&M_(t),!0}return!1}function ZF(t,e){const r=e.parent_span_id,n=e.span_id;if(r)for(const i of t)i.parent_span_id===n&&(i.parent_span_id=r)}function JF(t){return typeof t=="string"||t instanceof RegExp}const bx="production",QF="_frozenDsc";function gT(t,e){const r=e.getOptions(),{publicKey:n}=e.getDsn()||{},i={environment:r.environment||bx,release:r.release,public_key:n,trace_id:t,org_id:zF(e)};return e.emit("createDsc",i),i}function e4(t,e){const r=e.getPropagationContext();return r.dsc||gT(r.traceId,t)}function t4(t){var m;const e=Mt();if(!e)return{};const r=mT(t),n=_x(r),i=n.data,s=r.spanContext().traceState,o=(s==null?void 0:s.get("sentry.sample_rate"))??i[bF]??i[wF];function l(_){return(typeof o=="number"||typeof o=="string")&&(_.sample_rate=`${o}`),_}const c=r[QF];if(c)return l(c);const d=s==null?void 0:s.get("sentry.dsc"),u=d&&MF(d);if(u)return l(u);const h=gT(t.spanContext().traceId,e),p=i[_F],f=n.description;return p!=="url"&&f&&(h.transaction=f),qF()&&(h.sampled=String(XF(r)),h.sample_rand=(s==null?void 0:s.get("sentry.sample_rand"))??((m=uT(r).scope)==null?void 0:m.getPropagationContext().sampleRand.toString())),l(h),e.emit("createDsc",h,r),h}function Pn(t,e=100,r=1/0){try{return Om("",t,e,r)}catch(n){return{ERROR:`**non-serializable** (${n})`}}}function xT(t,e=3,r=100*1024){const n=Pn(t,e);return s4(n)>r?xT(t,e-1,r):n}function Om(t,e,r=1/0,n=1/0,i=o4()){const[s,o]=i;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const l=r4(t,e);if(!l.startsWith("[object "))return l;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:r;if(c===0)return l.replace("object ","");if(s(e))return"[Circular ~]";const d=e;if(d&&typeof d.toJSON=="function")try{const f=d.toJSON();return Om("",f,c-1,n,i)}catch{}const u=Array.isArray(e)?[]:{};let h=0;const p=sT(e);for(const f in p){if(!Object.prototype.hasOwnProperty.call(p,f))continue;if(h>=n){u[f]="[MaxProperties ~]";break}const m=p[f];u[f]=Om(f,m,c-1,n,i),h++}return o(e),u}function r4(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(tT(e))return JE(e);if(QL(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${Mi(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const r=n4(e);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(r){return`**non-serializable** (${r})`}}function n4(t){const e=Object.getPrototypeOf(t);return e!=null&&e.constructor?e.constructor.name:"null prototype"}function i4(t){return~-encodeURI(t).split(/%..|./).length}function s4(t){return i4(JSON.stringify(t))}function o4(){const t=new WeakSet;function e(n){return t.has(n)?!0:(t.add(n),!1)}function r(n){t.delete(n)}return[e,r]}function ra(t,e=[]){return[t,e]}function a4(t,e){const[r,n]=t;return[r,[...n,e]]}function Um(t,e){const r=t[1];for(const n of r){const i=n[0].type;if(e(n,i))return!0}return!1}function l4(t,e){return Um(t,(r,n)=>e.includes(n))}function zm(t){const e=Ju(Ge);return e.encodePolyfill?e.encodePolyfill(t):new TextEncoder().encode(t)}function c4(t){const[e,r]=t;let n=JSON.stringify(e);function i(s){typeof n=="string"?n=typeof s=="string"?n+s:[zm(n),s]:n.push(typeof s=="string"?zm(s):s)}for(const s of r){const[o,l]=s;if(i(`
${JSON.stringify(o)}
`),typeof l=="string"||l instanceof Uint8Array)i(l);else{let c;try{c=JSON.stringify(l)}catch{c=JSON.stringify(Pn(l))}i(c)}}return typeof n=="string"?n:d4(n)}function d4(t){const e=t.reduce((i,s)=>i+s.length,0),r=new Uint8Array(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function u4(t){const e=typeof t.data=="string"?zm(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const h4={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item",metric:"metric",trace_metric:"metric"};function B_(t){return h4[t]}function yT(t){if(!(t!=null&&t.sdk))return;const{name:e,version:r}=t.sdk;return{name:e,version:r}}function p4(t,e,r,n){var s;const i=(s=t.sdkProcessingMetadata)==null?void 0:s.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!r&&n&&{dsn:ta(n)},...i&&{trace:i}}}function f4(t,e){var n,i,s,o;if(!e)return t;const r=t.sdk||{};return t.sdk={...r,name:r.name||e.name,version:r.version||e.version,integrations:[...((n=t.sdk)==null?void 0:n.integrations)||[],...e.integrations||[]],packages:[...((i=t.sdk)==null?void 0:i.packages)||[],...e.packages||[]],settings:(s=t.sdk)!=null&&s.settings||e.settings?{...(o=t.sdk)==null?void 0:o.settings,...e.settings}:void 0},t}function m4(t,e,r,n){const i=yT(r),s={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!n&&e&&{dsn:ta(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return ra(s,[o])}function g4(t,e,r,n){const i=yT(r),s=t.type&&t.type!=="replay_event"?t.type:"event";f4(t,r==null?void 0:r.sdk);const o=p4(t,i,n,e);return delete t.sdkProcessingMetadata,ra(o,[[{type:s},t]])}const Np=0,D_=1,L_=2;function ih(t){return new kl(e=>{e(t)})}function wx(t){return new kl((e,r)=>{r(t)})}class kl{constructor(e){this._state=Np,this._handlers=[],this._runExecutor(e)}then(e,r){return new kl((n,i)=>{this._handlers.push([!1,s=>{if(!e)n(s);else try{n(e(s))}catch(o){i(o)}},s=>{if(!r)i(s);else try{n(r(s))}catch(o){i(o)}}]),this._executeHandlers()})}catch(e){return this.then(r=>r,e)}finally(e){return new kl((r,n)=>{let i,s;return this.then(o=>{s=!1,i=o,e&&e()},o=>{s=!0,i=o,e&&e()}).then(()=>{if(s){n(i);return}r(i)})})}_executeHandlers(){if(this._state===Np)return;const e=this._handlers.slice();this._handlers=[],e.forEach(r=>{r[0]||(this._state===D_&&r[1](this._value),this._state===L_&&r[2](this._value),r[0]=!0)})}_runExecutor(e){const r=(s,o)=>{if(this._state===Np){if(Hl(o)){o.then(n,i);return}this._state=s,this._value=o,this._executeHandlers()}},n=s=>{r(D_,s)},i=s=>{r(L_,s)};try{e(n,i)}catch(s){i(s)}}}function x4(t,e,r,n=0){try{const i=$m(e,r,t,n);return Hl(i)?i:ih(i)}catch(i){return wx(i)}}function $m(t,e,r,n){const i=r[n];if(!t||!i)return t;const s=i({...t},e);return Ce&&s===null&&_e.log(`Event processor "${i.id||"?"}" dropped event`),Hl(s)?s.then(o=>$m(o,e,r,n+1)):$m(s,e,r,n+1)}let kn,F_,O_,ei;function y4(t){const e=Ge._sentryDebugIds,r=Ge._debugIds;if(!e&&!r)return{};const n=e?Object.keys(e):[],i=r?Object.keys(r):[];if(ei&&n.length===F_&&i.length===O_)return ei;F_=n.length,O_=i.length,ei={},kn||(kn={});const s=(o,l)=>{for(const c of o){const d=l[c],u=kn==null?void 0:kn[c];if(u&&ei&&d)ei[u[0]]=d,kn&&(kn[c]=[u[0],d]);else if(d){const h=t(c);for(let p=h.length-1;p>=0;p--){const f=h[p],m=f==null?void 0:f.filename;if(m&&ei&&kn){ei[m]=d,kn[c]=[m,d];break}}}}};return e&&s(n,e),r&&s(i,r),ei}function v4(t,e){const{fingerprint:r,span:n,breadcrumbs:i,sdkProcessingMetadata:s}=e;b4(t,e),n&&E4(t,n),T4(t,r),w4(t,i),S4(t,s)}function U_(t,e){const{extra:r,tags:n,attributes:i,user:s,contexts:o,level:l,sdkProcessingMetadata:c,breadcrumbs:d,fingerprint:u,eventProcessors:h,attachments:p,propagationContext:f,transactionName:m,span:_}=e;Ca(t,"extra",r),Ca(t,"tags",n),Ca(t,"attributes",i),Ca(t,"user",s),Ca(t,"contexts",o),t.sdkProcessingMetadata=Vl(t.sdkProcessingMetadata,c,2),l&&(t.level=l),m&&(t.transactionName=m),_&&(t.span=_),d.length&&(t.breadcrumbs=[...t.breadcrumbs,...d]),u.length&&(t.fingerprint=[...t.fingerprint,...u]),h.length&&(t.eventProcessors=[...t.eventProcessors,...h]),p.length&&(t.attachments=[...t.attachments,...p]),t.propagationContext={...t.propagationContext,...f}}function Ca(t,e,r){t[e]=Vl(t[e],r,1)}function _4(t,e){const r=yF().getScopeData();return t&&U_(r,t.getScopeData()),e&&U_(r,e.getScopeData()),r}function b4(t,e){const{extra:r,tags:n,user:i,contexts:s,level:o,transactionName:l}=e;Object.keys(r).length&&(t.extra={...r,...t.extra}),Object.keys(n).length&&(t.tags={...n,...t.tags}),Object.keys(i).length&&(t.user={...i,...t.user}),Object.keys(s).length&&(t.contexts={...s,...t.contexts}),o&&(t.level=o),l&&t.type!=="transaction"&&(t.transaction=l)}function w4(t,e){const r=[...t.breadcrumbs||[],...e];t.breadcrumbs=r.length?r:void 0}function S4(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function E4(t,e){t.contexts={trace:GF(e),...t.contexts},t.sdkProcessingMetadata={dynamicSamplingContext:t4(e),...t.sdkProcessingMetadata};const r=mT(e),n=_x(r).description;n&&!t.transaction&&t.type==="transaction"&&(t.transaction=n)}function T4(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint.length||delete t.fingerprint}function C4(t,e,r,n,i,s){const{normalizeDepth:o=3,normalizeMaxBreadth:l=1e3}=t,c={...e,event_id:e.event_id||r.event_id||Mr(),timestamp:e.timestamp||Wl()},d=r.integrations||t.integrations.map(y=>y.name);A4(c,t),R4(c,d),i&&i.emit("applyFrameMetadata",e),e.type===void 0&&k4(c,t.stackParser);const u=j4(n,r.captureContext);r.mechanism&&Oo(c,r.mechanism);const h=i?i.getEventProcessors():[],p=_4(s,u),f=[...r.attachments||[],...p.attachments];f.length&&(r.attachments=f),v4(c,p);const m=[...h,...p.eventProcessors];return x4(m,c,r).then(y=>(y&&I4(y),typeof o=="number"&&o>0?P4(y,o,l):y))}function A4(t,e){var l,c;const{environment:r,release:n,dist:i,maxValueLength:s}=e;t.environment=t.environment||r||bx,!t.release&&n&&(t.release=n),!t.dist&&i&&(t.dist=i);const o=t.request;o!=null&&o.url&&s&&(o.url=Dm(o.url,s)),s&&((c=(l=t.exception)==null?void 0:l.values)==null||c.forEach(d=>{d.value&&(d.value=Dm(d.value,s))}))}function k4(t,e){var n,i;const r=y4(e);(i=(n=t.exception)==null?void 0:n.values)==null||i.forEach(s=>{var o,l;(l=(o=s.stacktrace)==null?void 0:o.frames)==null||l.forEach(c=>{c.filename&&(c.debug_id=r[c.filename])})})}function I4(t){var n,i;const e={};if((i=(n=t.exception)==null?void 0:n.values)==null||i.forEach(s=>{var o,l;(l=(o=s.stacktrace)==null?void 0:o.frames)==null||l.forEach(c=>{c.debug_id&&(c.abs_path?e[c.abs_path]=c.debug_id:c.filename&&(e[c.filename]=c.debug_id),delete c.debug_id)})}),Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const r=t.debug_meta.images;Object.entries(e).forEach(([s,o])=>{r.push({type:"sourcemap",code_file:s,debug_id:o})})}function R4(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function P4(t,e,r){var i,s;if(!t)return null;const n={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(o=>({...o,...o.data&&{data:Pn(o.data,e,r)}}))},...t.user&&{user:Pn(t.user,e,r)},...t.contexts&&{contexts:Pn(t.contexts,e,r)},...t.extra&&{extra:Pn(t.extra,e,r)}};return(i=t.contexts)!=null&&i.trace&&n.contexts&&(n.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(n.contexts.trace.data=Pn(t.contexts.trace.data,e,r))),t.spans&&(n.spans=t.spans.map(o=>({...o,...o.data&&{data:Pn(o.data,e,r)}}))),(s=t.contexts)!=null&&s.flags&&n.contexts&&(n.contexts.flags=Pn(t.contexts.flags,3,r)),n}function j4(t,e){if(!e)return t;const r=t?t.clone():new wn;return r.update(e),r}function M4(t){if(t)return N4(t)?{captureContext:t}:D4(t)?{captureContext:t}:t}function N4(t){return t instanceof wn||typeof t=="function"}const B4=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function D4(t){return Object.keys(t).some(e=>B4.includes(e))}function vT(t,e){return Tn().captureException(t,M4(e))}function _T(t,e){return Tn().captureEvent(t,e)}function L4(t,e){$i().setContext(t,e)}function F4(){return $i().lastEventId()}function z_(t){const e=$i(),r=Tn(),{userAgent:n}=Ge.navigator||{},i=lF({user:r.getUser()||e.getUser(),...n&&{userAgent:n},...t}),s=e.getSession();return(s==null?void 0:s.status)==="ok"&&Uo(s,{status:"exited"}),bT(),e.setSession(i),i}function bT(){const t=$i(),r=Tn().getSession()||t.getSession();r&&cF(r),wT(),t.setSession()}function wT(){const t=$i(),e=Mt(),r=t.getSession();r&&e&&e.captureSession(r)}function $_(t=!1){if(t){bT();return}wT()}const O4="7";function ST(t){const e=t.protocol?`${t.protocol}:`:"",r=t.port?`:${t.port}`:"";return`${e}//${t.host}${r}${t.path?`/${t.path}`:""}/api/`}function U4(t){return`${ST(t)}${t.projectId}/envelope/`}function z4(t,e){const r={sentry_version:O4};return t.publicKey&&(r.sentry_key=t.publicKey),e&&(r.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(r).toString()}function $4(t,e,r){return e||`${U4(t)}?${z4(t,r)}`}function G4(t,e){const r=pT(t);if(!r)return"";const n=`${ST(r)}embed/error-page/`;let i=`dsn=${ta(r)}`;for(const s in e)if(s!=="dsn"&&s!=="onClose")if(s==="user"){const o=e.user;if(!o)continue;o.name&&(i+=`&name=${encodeURIComponent(o.name)}`),o.email&&(i+=`&email=${encodeURIComponent(o.email)}`)}else i+=`&${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`;return`${n}?${i}`}const G_=[];function H4(t){const e={};return t.forEach(r=>{const{name:n}=r,i=e[n];i&&!i.isDefaultInstance&&r.isDefaultInstance||(e[n]=r)}),Object.values(e)}function W4(t){const e=t.defaultIntegrations||[],r=t.integrations;e.forEach(i=>{i.isDefaultInstance=!0});let n;if(Array.isArray(r))n=[...e,...r];else if(typeof r=="function"){const i=r(e);n=Array.isArray(i)?i:[i]}else n=e;return H4(n)}function V4(t,e){const r={};return e.forEach(n=>{n&&ET(t,n,r)}),r}function H_(t,e){for(const r of e)r!=null&&r.afterAllSetup&&r.afterAllSetup(t)}function ET(t,e,r){if(r[e.name]){Ce&&_e.log(`Integration skipped because it was already installed: ${e.name}`);return}if(r[e.name]=e,!G_.includes(e.name)&&typeof e.setupOnce=="function"&&(e.setupOnce(),G_.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const n=e.preprocessEvent.bind(e);t.on("preprocessEvent",(i,s)=>n(i,s,t))}if(typeof e.processEvent=="function"){const n=e.processEvent.bind(e),i=Object.assign((s,o)=>n(s,o,t),{id:e.name});t.addEventProcessor(i)}Ce&&_e.log(`Integration installed: ${e.name}`)}function X4(t){return[{type:"log",item_count:t.length,content_type:"application/vnd.sentry.items.log+json"},{items:t}]}function Y4(t,e,r,n){const i={};return e!=null&&e.sdk&&(i.sdk={name:e.sdk.name,version:e.sdk.version}),r&&n&&(i.dsn=ta(n)),ra(i,[X4(t)])}function TT(t,e){const r=e??K4(t)??[];if(r.length===0)return;const n=t.getOptions(),i=Y4(r,n._metadata,n.tunnel,t.getDsn());CT().set(t,[]),t.emit("flushLogs"),t.sendEnvelope(i)}function K4(t){return CT().get(t)}function CT(){return Jo("clientToLogBufferMap",()=>new WeakMap)}function q4(t){return[{type:"trace_metric",item_count:t.length,content_type:"application/vnd.sentry.items.trace-metric+json"},{items:t}]}function Z4(t,e,r,n){const i={};return e!=null&&e.sdk&&(i.sdk={name:e.sdk.name,version:e.sdk.version}),r&&n&&(i.dsn=ta(n)),ra(i,[q4(t)])}function AT(t,e){const r=e??J4(t)??[];if(r.length===0)return;const n=t.getOptions(),i=Z4(r,n._metadata,n.tunnel,t.getDsn());kT().set(t,[]),t.emit("flushMetrics"),t.sendEnvelope(i)}function J4(t){return kT().get(t)}function kT(){return Jo("clientToMetricBufferMap",()=>new WeakMap)}const Sx=Symbol.for("SentryBufferFullError");function Ex(t=100){const e=new Set;function r(){return e.size<t}function n(o){e.delete(o)}function i(o){if(!r())return wx(Sx);const l=o();return e.add(l),l.then(()=>n(l),()=>n(l)),l}function s(o){if(!e.size)return ih(!0);const l=Promise.allSettled(Array.from(e)).then(()=>!0);if(!o)return l;const c=[l,new Promise(d=>setTimeout(()=>d(!1),o))];return Promise.race(c)}return{get $(){return Array.from(e)},add:i,drain:s}}const Q4=60*1e3;function e3(t,e=rh()){const r=parseInt(`${t}`,10);if(!isNaN(r))return r*1e3;const n=Date.parse(`${t}`);return isNaN(n)?Q4:n-e}function t3(t,e){return t[e]||t.all||0}function r3(t,e,r=rh()){return t3(t,e)>r}function n3(t,{statusCode:e,headers:r},n=rh()){const i={...t},s=r==null?void 0:r["x-sentry-rate-limits"],o=r==null?void 0:r["retry-after"];if(s)for(const l of s.trim().split(",")){const[c,d,,,u]=l.split(":",5),h=parseInt(c,10),p=(isNaN(h)?60:h)*1e3;if(!d)i.all=n+p;else for(const f of d.split(";"))f==="metric_bucket"?(!u||u.split(";").includes("custom"))&&(i[f]=n+p):i[f]=n+p}else o?i.all=n+e3(o,n):e===429&&(i.all=n+60*1e3);return i}const IT=64;function i3(t,e,r=Ex(t.bufferSize||IT)){let n={};const i=o=>r.drain(o);function s(o){const l=[];if(Um(o,(h,p)=>{const f=B_(p);r3(n,f)?t.recordDroppedEvent("ratelimit_backoff",f):l.push(h)}),l.length===0)return Promise.resolve({});const c=ra(o[0],l),d=h=>{if(l4(c,["client_report"])){Ce&&_e.warn(`Dropping client report. Will not send outcomes (reason: ${h}).`);return}Um(c,(p,f)=>{t.recordDroppedEvent(h,B_(f))})},u=()=>e({body:c4(c)}).then(h=>(h.statusCode!==void 0&&(h.statusCode<200||h.statusCode>=300)&&Ce&&_e.warn(`Sentry responded with status code ${h.statusCode} to sent event.`),n=n3(n,h),h),h=>{throw d("network_error"),Ce&&_e.error("Encountered error running transport request:",h),h});return r.add(u).then(h=>h,h=>{if(h===Sx)return Ce&&_e.error("Skipped sending event because buffer is full."),d("queue_overflow"),Promise.resolve({});throw h})}return{send:s,flush:i}}function s3(t,e,r){const n=[{type:"client_report"},{timestamp:Wl(),discarded_events:t}];return ra(e?{dsn:e}:{},[n])}function RT(t){const e=[];t.message&&e.push(t.message);try{const r=t.exception.values[t.exception.values.length-1];r!=null&&r.value&&(e.push(r.value),r.type&&e.push(`${r.type}: ${r.value}`))}catch{}return e}function o3(t){var c;const{trace_id:e,parent_span_id:r,span_id:n,status:i,origin:s,data:o,op:l}=((c=t.contexts)==null?void 0:c.trace)??{};return{data:o??{},description:t.transaction,op:l,parent_span_id:r,span_id:n??"",start_timestamp:t.start_timestamp??0,status:i,timestamp:t.timestamp,trace_id:e??"",origin:s,profile_id:o==null?void 0:o[cT],exclusive_time:o==null?void 0:o[dT],measurements:t.measurements,is_segment:!0}}function a3(t){return{type:"transaction",timestamp:t.timestamp,start_timestamp:t.start_timestamp,transaction:t.description,contexts:{trace:{trace_id:t.trace_id,span_id:t.span_id,parent_span_id:t.parent_span_id,op:t.op,status:t.status,origin:t.origin,data:{...t.data,...t.profile_id&&{[cT]:t.profile_id},...t.exclusive_time&&{[dT]:t.exclusive_time}}}},measurements:t.measurements}}const W_="Not capturing exception because it's already been captured.",V_="Discarded session because of missing or non-string release",PT=Symbol.for("SentryInternalError"),jT=Symbol.for("SentryDoNotSendEventError"),l3=5e3;function bd(t){return{message:t,[PT]:!0}}function Bp(t){return{message:t,[jT]:!0}}function X_(t){return!!t&&typeof t=="object"&&PT in t}function Y_(t){return!!t&&typeof t=="object"&&jT in t}function K_(t,e,r,n,i){let s=0,o,l=!1;t.on(r,()=>{s=0,clearTimeout(o),l=!1}),t.on(e,c=>{s+=n(c),s>=8e5?i(t):l||(l=!0,o=setTimeout(()=>{i(t)},l3))}),t.on("flush",()=>{i(t)})}class c3{constructor(e){var n,i,s;if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],this._promiseBuffer=Ex(((n=e.transportOptions)==null?void 0:n.bufferSize)??IT),e.dsn?this._dsn=pT(e.dsn):Ce&&_e.warn("No DSN provided, client will not send events."),this._dsn){const o=$4(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:o})}this._options.enableLogs=this._options.enableLogs??((i=this._options._experiments)==null?void 0:i.enableLogs),this._options.enableLogs&&K_(this,"afterCaptureLog","flushLogs",p3,TT),(this._options.enableMetrics??((s=this._options._experiments)==null?void 0:s.enableMetrics)??!0)&&K_(this,"afterCaptureMetric","flushMetrics",h3,AT)}captureException(e,r,n){const i=Mr();if(w_(e))return Ce&&_e.log(W_),i;const s={event_id:i,...r};return this._process(()=>this.eventFromException(e,s).then(o=>this._captureEvent(o,s,n)).then(o=>o),"error"),s.event_id}captureMessage(e,r,n,i){const s={event_id:Mr(),...n},o=fx(e)?e:String(e),l=Qu(e),c=l?this.eventFromMessage(o,r,s):this.eventFromException(e,s);return this._process(()=>c.then(d=>this._captureEvent(d,s,i)),l?"unknown":"error"),s.event_id}captureEvent(e,r,n){const i=Mr();if(r!=null&&r.originalException&&w_(r.originalException))return Ce&&_e.log(W_),i;const s={event_id:i,...r},o=e.sdkProcessingMetadata||{},l=o.capturedSpanScope,c=o.capturedSpanIsolationScope,d=q_(e.type);return this._process(()=>this._captureEvent(e,s,l||n,c),d),s.event_id}captureSession(e){this.sendSession(e),Uo(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}async flush(e){const r=this._transport;if(!r)return!0;this.emit("flush");const n=await this._isClientDoneProcessing(e),i=await r.flush(e);return n&&i}async close(e){const r=await this.flush(e);return this.getOptions().enabled=!1,this.emit("close"),r}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const r=this._integrations[e.name];ET(this,e,this._integrations),r||H_(this,[e])}sendEvent(e,r={}){this.emit("beforeSendEvent",e,r);let n=g4(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of r.attachments||[])n=a4(n,u4(i));this.sendEnvelope(n).then(i=>this.emit("afterSendEvent",e,i))}sendSession(e){const{release:r,environment:n=bx}=this._options;if("aggregates"in e){const s=e.attrs||{};if(!s.release&&!r){Ce&&_e.warn(V_);return}s.release=s.release||r,s.environment=s.environment||n,e.attrs=s}else{if(!e.release&&!r){Ce&&_e.warn(V_);return}e.release=e.release||r,e.environment=e.environment||n}this.emit("beforeSendSession",e);const i=m4(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(i)}recordDroppedEvent(e,r,n=1){if(this._options.sendClientReports){const i=`${e}:${r}`;Ce&&_e.log(`Recording outcome: "${i}"${n>1?` (${n} times)`:""}`),this._outcomes[i]=(this._outcomes[i]||0)+n}}on(e,r){const n=this._hooks[e]=this._hooks[e]||new Set,i=(...s)=>r(...s);return n.add(i),()=>{n.delete(i)}}emit(e,...r){const n=this._hooks[e];n&&n.forEach(i=>i(...r))}async sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)try{return await this._transport.send(e)}catch(r){return Ce&&_e.error("Error while sending envelope:",r),{}}return Ce&&_e.error("Transport disabled"),{}}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=V4(this,e),H_(this,e)}_updateSessionFromEvent(e,r){var c,d;let n=r.level==="fatal",i=!1;const s=(c=r.exception)==null?void 0:c.values;if(s){i=!0,n=!1;for(const u of s)if(((d=u.mechanism)==null?void 0:d.handled)===!1){n=!0;break}}const o=e.status==="ok";(o&&e.errors===0||o&&n)&&(Uo(e,{...n&&{status:"crashed"},errors:e.errors||Number(i||n)}),this.captureSession(e))}async _isClientDoneProcessing(e){let r=0;for(;!e||r<e;){if(await new Promise(n=>setTimeout(n,1)),!this._numProcessing)return!0;r++}return!1}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,r,n,i){const s=this.getOptions(),o=Object.keys(this._integrations);return!r.integrations&&(o!=null&&o.length)&&(r.integrations=o),this.emit("preprocessEvent",e,r),e.type||i.setLastEventId(e.event_id||r.event_id),C4(s,e,r,n,this,i).then(l=>{if(l===null)return l;this.emit("postprocessEvent",l,r),l.contexts={trace:vF(n),...l.contexts};const c=e4(this,n);return l.sdkProcessingMetadata={dynamicSamplingContext:c,...l.sdkProcessingMetadata},l})}_captureEvent(e,r={},n=Tn(),i=$i()){return Ce&&Gm(e)&&_e.log(`Captured error event \`${RT(e)[0]||"<unknown>"}\``),this._processEvent(e,r,n,i).then(s=>s.event_id,s=>{Ce&&(Y_(s)?_e.log(s.message):X_(s)?_e.warn(s.message):_e.warn(s))})}_processEvent(e,r,n,i){const s=this.getOptions(),{sampleRate:o}=s,l=MT(e),c=Gm(e),u=`before send for type \`${e.type||"error"}\``,h=typeof o>"u"?void 0:$F(o);if(c&&typeof h=="number"&&gu()>h)return this.recordDroppedEvent("sample_rate","error"),wx(Bp(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const p=q_(e.type);return this._prepareEvent(e,r,n,i).then(f=>{if(f===null)throw this.recordDroppedEvent("event_processor",p),Bp("An event processor returned `null`, will not send event.");if(r.data&&r.data.__sentry__===!0)return f;const _=u3(this,s,f,r);return d3(_,u)}).then(f=>{var y;if(f===null){if(this.recordDroppedEvent("before_send",p),l){const v=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",v)}throw Bp(`${u} returned \`null\`, will not send event.`)}const m=n.getSession()||i.getSession();if(c&&m&&this._updateSessionFromEvent(m,f),l){const x=((y=f.sdkProcessingMetadata)==null?void 0:y.spanCountBeforeProcessing)||0,v=f.spans?f.spans.length:0,g=x-v;g>0&&this.recordDroppedEvent("before_send","span",g)}const _=f.transaction_info;if(l&&_&&f.transaction!==e.transaction){const x="custom";f.transaction_info={..._,source:x}}return this.sendEvent(f,r),f}).then(null,f=>{throw Y_(f)||X_(f)?f:(this.captureException(f,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:f}),bd(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${f}`))})}_process(e,r){this._numProcessing++,this._promiseBuffer.add(e).then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n===Sx&&this.recordDroppedEvent("queue_overflow",r),n))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([r,n])=>{const[i,s]=r.split(":");return{reason:i,category:s,quantity:n}})}_flushOutcomes(){Ce&&_e.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){Ce&&_e.log("No outcomes to send");return}if(!this._dsn){Ce&&_e.log("No dsn provided, will not send outcomes");return}Ce&&_e.log("Sending outcomes:",e);const r=s3(e,this._options.tunnel&&ta(this._dsn));this.sendEnvelope(r)}}function q_(t){return t==="replay_event"?"replay":t||"error"}function d3(t,e){const r=`${e} must return \`null\` or a valid event.`;if(Hl(t))return t.then(n=>{if(!Al(n)&&n!==null)throw bd(r);return n},n=>{throw bd(`${e} rejected with ${n}`)});if(!Al(t)&&t!==null)throw bd(r);return t}function u3(t,e,r,n){const{beforeSend:i,beforeSendTransaction:s,beforeSendSpan:o,ignoreSpans:l}=e;let c=r;if(Gm(c)&&i)return i(c,n);if(MT(c)){if(o||l){const d=o3(c);if(l!=null&&l.length&&N_(d,l))return null;if(o){const u=o(d);u?c=Vl(r,a3(u)):j_()}if(c.spans){const u=[],h=c.spans;for(const f of h){if(l!=null&&l.length&&N_(f,l)){ZF(h,f);continue}if(o){const m=o(f);m?u.push(m):(j_(),u.push(f))}else u.push(f)}const p=c.spans.length-u.length;p&&t.recordDroppedEvent("before_send","span",p),c.spans=u}}if(s){if(c.spans){const d=c.spans.length;c.sdkProcessingMetadata={...r.sdkProcessingMetadata,spanCountBeforeProcessing:d}}return s(c,n)}}return c}function Gm(t){return t.type===void 0}function MT(t){return t.type==="transaction"}function h3(t){let e=0;return t.name&&(e+=t.name.length*2),e+=8,e+NT(t.attributes)}function p3(t){let e=0;return t.message&&(e+=t.message.length*2),e+NT(t.attributes)}function NT(t){if(!t)return 0;let e=0;return Object.values(t).forEach(r=>{Array.isArray(r)?e+=r.length*Z_(r[0]):Qu(r)?e+=Z_(r):e+=100}),e}function Z_(t){return typeof t=="string"?t.length*2:typeof t=="number"?8:typeof t=="boolean"?4:0}function f3(t){return Gl(t)&&"__sentry_fetch_url_host__"in t&&typeof t.__sentry_fetch_url_host__=="string"}function J_(t){return f3(t)?`${t.message} (${t.__sentry_fetch_url_host__})`:t.message}function m3(t,e){e.debug===!0&&(Ce?_e.enable():Qo(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),Tn().update(e.initialScope);const n=new t(e);return g3(n),n.init(),n}function g3(t){Tn().setClient(t)}function Dp(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const r=e[6]||"",n=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:r,hash:n,relative:e[5]+r+n}}function x3(t,e=!0){if(t.startsWith("data:")){const r=t.match(/^data:([^;,]+)/),n=r?r[1]:"text/plain",i=t.includes(";base64,"),s=t.indexOf(",");let o="";if(e&&s!==-1){const l=t.slice(s+1);o=l.length>10?`${l.slice(0,10)}... [truncated]`:l}return`data:${n}${i?",base64":""}${o?`,${o}`:""}`}return t}function y3(t){var e;"aggregates"in t?((e=t.attrs)==null?void 0:e.ip_address)===void 0&&(t.attrs={...t.attrs,ip_address:"{{auto}}"}):t.ipAddress===void 0&&(t.ipAddress="{{auto}}")}function BT(t,e,r=[e],n="npm"){const i=t._metadata||{};i.sdk||(i.sdk={name:`sentry.javascript.${e}`,packages:r.map(s=>({name:`${n}:@sentry/${s}`,version:ps})),version:ps}),t._metadata=i}const v3=100;function Sn(t,e){const r=Mt(),n=$i();if(!r)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:s=v3}=r.getOptions();if(s<=0)return;const l={timestamp:Wl(),...t},c=i?Qo(()=>i(l,e)):l;c!==null&&(r.emit&&r.emit("beforeAddBreadcrumb",c,e),n.addBreadcrumb(c,s))}let Q_;const _3="FunctionToString",e1=new WeakMap,b3=()=>({name:_3,setupOnce(){Q_=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=xx(this),r=e1.has(Mt())&&e!==void 0?e:this;return Q_.apply(r,t)}}catch{}},setup(t){e1.set(t,!0)}}),w3=b3,S3=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],E3="EventFilters",T3=(t={})=>{let e;return{name:E3,setup(r){const n=r.getOptions();e=t1(t,n)},processEvent(r,n,i){if(!e){const s=i.getOptions();e=t1(t,s)}return A3(r,e)?null:r}}},C3=(t={})=>({...T3(t),name:"InboundFilters"});function t1(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:S3],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function A3(t,e){if(t.type){if(t.type==="transaction"&&I3(t,e.ignoreTransactions))return Ce&&_e.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${is(t)}`),!0}else{if(k3(t,e.ignoreErrors))return Ce&&_e.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${is(t)}`),!0;if(M3(t))return Ce&&_e.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${is(t)}`),!0;if(R3(t,e.denyUrls))return Ce&&_e.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${is(t)}.
Url: ${xu(t)}`),!0;if(!P3(t,e.allowUrls))return Ce&&_e.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${is(t)}.
Url: ${xu(t)}`),!0}return!1}function k3(t,e){return e!=null&&e.length?RT(t).some(r=>nh(r,e)):!1}function I3(t,e){if(!(e!=null&&e.length))return!1;const r=t.transaction;return r?nh(r,e):!1}function R3(t,e){if(!(e!=null&&e.length))return!1;const r=xu(t);return r?nh(r,e):!1}function P3(t,e){if(!(e!=null&&e.length))return!0;const r=xu(t);return r?nh(r,e):!0}function j3(t=[]){for(let e=t.length-1;e>=0;e--){const r=t[e];if(r&&r.filename!=="<anonymous>"&&r.filename!=="[native code]")return r.filename||null}return null}function xu(t){var e,r;try{const n=[...((e=t.exception)==null?void 0:e.values)??[]].reverse().find(s=>{var o,l,c;return((o=s.mechanism)==null?void 0:o.parent_id)===void 0&&((c=(l=s.stacktrace)==null?void 0:l.frames)==null?void 0:c.length)}),i=(r=n==null?void 0:n.stacktrace)==null?void 0:r.frames;return i?j3(i):null}catch{return Ce&&_e.error(`Cannot extract url for event ${is(t)}`),null}}function M3(t){var e,r;return(r=(e=t.exception)==null?void 0:e.values)!=null&&r.length?!t.message&&!t.exception.values.some(n=>n.stacktrace||n.type&&n.type!=="Error"||n.value):!1}function N3(t,e,r,n,i,s){var l;if(!((l=i.exception)!=null&&l.values)||!s||!Ni(s.originalException,Error))return;const o=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;o&&(i.exception.values=Hm(t,e,n,s.originalException,r,i.exception.values,o,0))}function Hm(t,e,r,n,i,s,o,l){if(s.length>=r+1)return s;let c=[...s];if(Ni(n[i],Error)){r1(o,l,n);const d=t(e,n[i]),u=c.length;n1(d,i,u,l),c=Hm(t,e,r,n[i],i,[d,...c],d,u)}return DT(n)&&n.errors.forEach((d,u)=>{if(Ni(d,Error)){r1(o,l,n);const h=t(e,d),p=c.length;n1(h,`errors[${u}]`,p,l),c=Hm(t,e,r,d,i,[h,...c],h,p)}}),c}function DT(t){return Array.isArray(t.errors)}function r1(t,e,r){t.mechanism={handled:!0,type:"auto.core.linked_errors",...DT(r)&&{is_exception_group:!0},...t.mechanism,exception_id:e}}function n1(t,e,r,n){t.mechanism={handled:!0,...t.mechanism,type:"chained",source:e,exception_id:r,parent_id:n}}function B3(t){const e="console";Ps(e,t),js(e,D3)}function D3(){"console"in Ge&&LL.forEach(function(t){t in Ge.console&&xr(Ge.console,t,function(e){return mu[t]=e,function(...r){Qr("console",{args:r,level:t});const i=mu[t];i==null||i.apply(Ge.console,r)}})})}function L3(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const F3="Dedupe",O3=()=>{let t;return{name:F3,processEvent(e){if(e.type)return e;try{if(z3(e,t))return Ce&&_e.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},U3=O3;function z3(t,e){return e?!!($3(t,e)||G3(t,e)):!1}function $3(t,e){const r=t.message,n=e.message;return!(!r&&!n||r&&!n||!r&&n||r!==n||!FT(t,e)||!LT(t,e))}function G3(t,e){const r=i1(e),n=i1(t);return!(!r||!n||r.type!==n.type||r.value!==n.value||!FT(t,e)||!LT(t,e))}function LT(t,e){let r=g_(t),n=g_(e);if(!r&&!n)return!0;if(r&&!n||!r&&n||(r=r,n=n,n.length!==r.length))return!1;for(let i=0;i<n.length;i++){const s=n[i],o=r[i];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function FT(t,e){let r=t.fingerprint,n=e.fingerprint;if(!r&&!n)return!0;if(r&&!n||!r&&n)return!1;r=r,n=n;try{return r.join("")===n.join("")}catch{return!1}}function i1(t){var e,r;return(r=(e=t.exception)==null?void 0:e.values)==null?void 0:r[0]}const H3="ConversationId",W3=()=>({name:H3,setup(t){t.on("spanStart",e=>{const r=Tn().getScopeData(),n=$i().getScopeData(),i=r.conversationId||n.conversationId;i&&e.setAttribute(TF,i)})}}),V3=W3;function OT(t){if(t!==void 0)return t>=400&&t<500?"warning":t>=500?"error":void 0}const Il=Ge;function X3(){return"history"in Il&&!!Il.history}function Y3(){if(!("fetch"in Il))return!1;try{return new Headers,new Request("data:,"),new Response,!0}catch{return!1}}function Wm(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function K3(){var r;if(typeof EdgeRuntime=="string")return!0;if(!Y3())return!1;if(Wm(Il.fetch))return!0;let t=!1;const e=Il.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),(r=n.contentWindow)!=null&&r.fetch&&(t=Wm(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){Ce&&_e.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function q3(t,e){const r="fetch";Ps(r,t),js(r,()=>Z3(void 0,e))}function Z3(t,e=!1){e&&!K3()||xr(Ge,"fetch",function(r){return function(...n){const i=new Error,{method:s,url:o}=J3(n),l={args:n,fetchData:{method:s,url:o},startTimestamp:$n()*1e3,virtualError:i,headers:Q3(n)};return Qr("fetch",{...l}),r.apply(Ge,n).then(async c=>(Qr("fetch",{...l,endTimestamp:$n()*1e3,response:c}),c),c=>{Qr("fetch",{...l,endTimestamp:$n()*1e3,error:c}),Gl(c)&&c.stack===void 0&&(c.stack=i.stack,Bi(c,"framesToPop",1));const d=Mt(),u=(d==null?void 0:d.getOptions().enhanceFetchErrorMessages)??"always";if(u!==!1&&c instanceof TypeError&&(c.message==="Failed to fetch"||c.message==="Load failed"||c.message==="NetworkError when attempting to fetch resource."))try{const f=new URL(l.fetchData.url).host;u==="always"?c.message=`${c.message} (${f})`:Bi(c,"__sentry_fetch_url_host__",f)}catch{}throw c})}})}function wd(t,e){return!!t&&typeof t=="object"&&!!t[e]}function s1(t){return typeof t=="string"?t:t?wd(t,"url")?t.url:t.toString?t.toString():"":""}function J3(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[r,n]=t;return{url:s1(r),method:wd(n,"method")?String(n.method).toUpperCase():rT(r)&&wd(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:s1(e),method:wd(e,"method")?String(e.method).toUpperCase():"GET"}}function Q3(t){const[e,r]=t;try{if(typeof r=="object"&&r!==null&&"headers"in r&&r.headers)return new Headers(r.headers);if(rT(e))return new Headers(e.headers)}catch{}}function e5(){return"npm"}const Je=Ge;let Vm=0;function UT(){return Vm>0}function t5(){Vm++,setTimeout(()=>{Vm--})}function $o(t,e={}){function r(i){return typeof i=="function"}if(!r(t))return t;try{const i=t.__sentry_wrapped__;if(i)return typeof i=="function"?i:t;if(xx(t))return t}catch{return t}const n=function(...i){try{const s=i.map(o=>$o(o,e));return t.apply(this,s)}catch(s){throw t5(),vx(o=>{o.addEventProcessor(l=>(e.mechanism&&(Lm(l,void 0),Oo(l,e.mechanism)),l.extra={...l.extra,arguments:i},l)),vT(s)}),s}};try{for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}catch{}iT(n,t),Bi(t,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get(){return t.name}})}catch{}return n}function r5(){const t=gx(),{referrer:e}=Je.document||{},{userAgent:r}=Je.navigator||{},n={...e&&{Referer:e},...r&&{"User-Agent":r}};return{url:t,headers:n}}function Tx(t,e){const r=Cx(t,e),n={type:a5(e),value:l5(e)};return r.length&&(n.stacktrace={frames:r}),n.type===void 0&&n.value===""&&(n.value="Unrecoverable error caught"),n}function n5(t,e,r,n){const i=Mt(),s=i==null?void 0:i.getOptions().normalizeDepth,o=p5(e),l={__serialized__:xT(e,s)};if(o)return{exception:{values:[Tx(t,o)]},extra:l};const c={exception:{values:[{type:eh(e)?e.constructor.name:n?"UnhandledRejection":"Error",value:u5(e,{isUnhandledRejection:n})}]},extra:l};if(r){const d=Cx(t,r);d.length&&(c.exception.values[0].stacktrace={frames:d})}return c}function Lp(t,e){return{exception:{values:[Tx(t,e)]}}}function Cx(t,e){const r=e.stacktrace||e.stack||"",n=s5(e),i=o5(e);try{return t(r,n,i)}catch{}return[]}const i5=/Minified React error #\d+;/i;function s5(t){return t&&i5.test(t.message)?1:0}function o5(t){return typeof t.framesToPop=="number"?t.framesToPop:0}function zT(t){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?t instanceof WebAssembly.Exception:!1}function a5(t){const e=t==null?void 0:t.name;return!e&&zT(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function l5(t){const e=t==null?void 0:t.message;return zT(t)?Array.isArray(t.message)&&t.message.length==2?t.message[1]:"wasm exception":e?e.error&&typeof e.error.message=="string"?J_(e.error):J_(t):"No error message"}function c5(t,e,r,n){const i=(r==null?void 0:r.syntheticException)||void 0,s=Ax(t,e,i,n);return Oo(s),s.level="error",r!=null&&r.event_id&&(s.event_id=r.event_id),ih(s)}function d5(t,e,r="info",n,i){const s=(n==null?void 0:n.syntheticException)||void 0,o=Xm(t,e,s,i);return o.level=r,n!=null&&n.event_id&&(o.event_id=n.event_id),ih(o)}function Ax(t,e,r,n,i){let s;if(eT(e)&&e.error)return Lp(t,e.error);if(y_(e)||qL(e)){const o=e;if("stack"in e)s=Lp(t,e);else{const l=o.name||(y_(o)?"DOMError":"DOMException"),c=o.message?`${l}: ${o.message}`:l;s=Xm(t,c,r,n),Lm(s,c)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return Gl(e)?Lp(t,e):Al(e)||eh(e)?(s=n5(t,e,r,i),Oo(s,{synthetic:!0}),s):(s=Xm(t,e,r,n),Lm(s,`${e}`),Oo(s,{synthetic:!0}),s)}function Xm(t,e,r,n){const i={};if(n&&r){const s=Cx(t,r);s.length&&(i.exception={values:[{value:e,stacktrace:{frames:s}}]}),Oo(i,{synthetic:!0})}if(fx(e)){const{__sentry_template_string__:s,__sentry_template_values__:o}=e;return i.logentry={message:s,params:o},i}return i.message=e,i}function u5(t,{isUnhandledRejection:e}){const r=nF(t),n=e?"promise rejection":"exception";return eT(t)?`Event \`ErrorEvent\` captured as ${n} with message \`${t.message}\``:eh(t)?`Event \`${h5(t)}\` (type=${t.type}) captured as ${n}`:`Object captured as ${n} with keys: ${r}`}function h5(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function p5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];if(r instanceof Error)return r}}class f5 extends c3{constructor(e){var u;const r=m5(e),n=Je.SENTRY_SDK_SOURCE||e5();BT(r,"browser",["browser"],n),(u=r._metadata)!=null&&u.sdk&&(r._metadata.sdk.settings={infer_ip:r.sendDefaultPii?"auto":"never",...r._metadata.sdk.settings}),super(r);const{sendDefaultPii:i,sendClientReports:s,enableLogs:o,_experiments:l,enableMetrics:c}=this._options,d=c??(l==null?void 0:l.enableMetrics)??!0;Je.document&&(s||o||d)&&Je.document.addEventListener("visibilitychange",()=>{Je.document.visibilityState==="hidden"&&(s&&this._flushOutcomes(),o&&TT(this),d&&AT(this))}),i&&this.on("beforeSendSession",y3)}eventFromException(e,r){return c5(this._options.stackParser,e,r,this._options.attachStacktrace)}eventFromMessage(e,r="info",n){return d5(this._options.stackParser,e,r,n,this._options.attachStacktrace)}_prepareEvent(e,r,n,i){return e.platform=e.platform||"javascript",super._prepareEvent(e,r,n,i)}}function m5(t){var e;return{release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(e=Je.SENTRY_RELEASE)==null?void 0:e.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...t}}const g5=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Zt=Ge,x5=1e3;let o1,Ym,Km;function y5(t){const e="dom";Ps(e,t),js(e,v5)}function v5(){if(!Zt.document)return;const t=Qr.bind(null,"dom"),e=a1(t,!0);Zt.document.addEventListener("click",e,!1),Zt.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(r=>{var s,o;const i=(s=Zt[r])==null?void 0:s.prototype;(o=i==null?void 0:i.hasOwnProperty)!=null&&o.call(i,"addEventListener")&&(xr(i,"addEventListener",function(l){return function(c,d,u){if(c==="click"||c=="keypress")try{const h=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},p=h[c]=h[c]||{refCount:0};if(!p.handler){const f=a1(t);p.handler=f,l.call(this,c,f,u)}p.refCount++}catch{}return l.call(this,c,d,u)}}),xr(i,"removeEventListener",function(l){return function(c,d,u){if(c==="click"||c=="keypress")try{const h=this.__sentry_instrumentation_handlers__||{},p=h[c];p&&(p.refCount--,p.refCount<=0&&(l.call(this,c,p.handler,u),p.handler=void 0,delete h[c]),Object.keys(h).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return l.call(this,c,d,u)}}))})}function _5(t){if(t.type!==Ym)return!1;try{if(!t.target||t.target._sentryId!==Km)return!1}catch{}return!0}function b5(t,e){return t!=="keypress"?!1:e!=null&&e.tagName?!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable):!0}function a1(t,e=!1){return r=>{if(!r||r._sentryCaptured)return;const n=w5(r);if(b5(r.type,n))return;Bi(r,"_sentryCaptured",!0),n&&!n._sentryId&&Bi(n,"_sentryId",Mr());const i=r.type==="keypress"?"input":r.type;_5(r)||(t({event:r,name:i,global:e}),Ym=r.type,Km=n?n._sentryId:void 0),clearTimeout(o1),o1=Zt.setTimeout(()=>{Km=void 0,Ym=void 0},x5)}}function w5(t){try{return t.target}catch{return null}}let $c;function $T(t){const e="history";Ps(e,t),js(e,S5)}function S5(){if(Zt.addEventListener("popstate",()=>{const e=Zt.location.href,r=$c;if($c=e,r===e)return;Qr("history",{from:r,to:e})}),!X3())return;function t(e){return function(...r){const n=r.length>2?r[2]:void 0;if(n){const i=$c,s=E5(String(n));if($c=s,i===s)return e.apply(this,r);Qr("history",{from:i,to:s})}return e.apply(this,r)}}xr(Zt.history,"pushState",t),xr(Zt.history,"replaceState",t)}function E5(t){try{return new URL(t,Zt.location.origin).toString()}catch{return t}}const Sd={};function T5(t){const e=Sd[t];if(e)return e;let r=Zt[t];if(Wm(r))return Sd[t]=r.bind(Zt);const n=Zt.document;if(n&&typeof n.createElement=="function")try{const i=n.createElement("iframe");i.hidden=!0,n.head.appendChild(i);const s=i.contentWindow;s!=null&&s[t]&&(r=s[t]),n.head.removeChild(i)}catch(i){g5&&_e.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,i)}return r&&(Sd[t]=r.bind(Zt))}function C5(t){Sd[t]=void 0}const Oa="__sentry_xhr_v3__";function A5(t){const e="xhr";Ps(e,t),js(e,k5)}function k5(){if(!Zt.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,r,n){const i=new Error,s=$n()*1e3,o=zn(n[0])?n[0].toUpperCase():void 0,l=I5(n[1]);if(!o||!l)return e.apply(r,n);r[Oa]={method:o,url:l,request_headers:{}},o==="POST"&&l.match(/sentry_key/)&&(r.__sentry_own_request__=!0);const c=()=>{const d=r[Oa];if(d&&r.readyState===4){try{d.status_code=r.status}catch{}const u={endTimestamp:$n()*1e3,startTimestamp:s,xhr:r,virtualError:i};Qr("xhr",u)}};return"onreadystatechange"in r&&typeof r.onreadystatechange=="function"?r.onreadystatechange=new Proxy(r.onreadystatechange,{apply(d,u,h){return c(),d.apply(u,h)}}):r.addEventListener("readystatechange",c),r.setRequestHeader=new Proxy(r.setRequestHeader,{apply(d,u,h){const[p,f]=h,m=u[Oa];return m&&zn(p)&&zn(f)&&(m.request_headers[p.toLowerCase()]=f),d.apply(u,h)}}),e.apply(r,n)}}),t.send=new Proxy(t.send,{apply(e,r,n){const i=r[Oa];if(!i)return e.apply(r,n);n[0]!==void 0&&(i.body=n[0]);const s={startTimestamp:$n()*1e3,xhr:r};return Qr("xhr",s),e.apply(r,n)}})}function I5(t){if(zn(t))return t;try{return t.toString()}catch{}}const R5=40;function P5(t,e=T5("fetch")){let r=0,n=0;async function i(s){const o=s.body.length;r+=o,n++;const l={body:s.body,method:"POST",referrerPolicy:"strict-origin",headers:t.headers,keepalive:r<=6e4&&n<15,...t.fetchOptions};try{const c=await e(t.url,l);return{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}}catch(c){throw C5("fetch"),c}finally{r-=o,n--}}return i3(t,i,Ex(t.bufferSize||R5))}const Go=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,j5=30,M5=50;function qm(t,e,r,n){const i={filename:t,function:e==="<anonymous>"?Ss:e,in_app:!0};return r!==void 0&&(i.lineno=r),n!==void 0&&(i.colno=n),i}const N5=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,B5=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,D5=/\((\S*)(?::(\d+))(?::(\d+))\)/,L5=/at (.+?) ?\(data:(.+?),/,F5=t=>{const e=t.match(L5);if(e)return{filename:`<data:${e[2]}>`,function:e[1]};const r=N5.exec(t);if(r){const[,i,s,o]=r;return qm(i,Ss,+s,+o)}const n=B5.exec(t);if(n){if(n[2]&&n[2].indexOf("eval")===0){const l=D5.exec(n[2]);l&&(n[2]=l[1],n[3]=l[2],n[4]=l[3])}const[s,o]=GT(n[1]||Ss,n[2]);return qm(o,s,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},O5=[j5,F5],U5=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,z5=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,$5=t=>{const e=U5.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const s=z5.exec(e[3]);s&&(e[1]=e[1]||"eval",e[3]=s[1],e[4]=s[2],e[5]="")}let n=e[3],i=e[1]||Ss;return[i,n]=GT(i,n),qm(n,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},G5=[M5,$5],H5=[O5,G5],W5=ZE(...H5),GT=(t,e)=>{const r=t.indexOf("safari-extension")!==-1,n=t.indexOf("safari-web-extension")!==-1;return r||n?[t.indexOf("@")!==-1?t.split("@")[0]:Ss,r?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},Gc=1024,V5="Breadcrumbs",X5=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:V5,setup(r){e.console&&B3(Z5(r)),e.dom&&y5(q5(r,e.dom)),e.xhr&&A5(J5(r)),e.fetch&&q3(Q5(r)),e.history&&$T(eO(r)),e.sentry&&r.on("beforeSendEvent",K5(r))}}},Y5=X5;function K5(t){return function(r){Mt()===t&&Sn({category:`sentry.${r.type==="transaction"?"transaction":"event"}`,event_id:r.event_id,level:r.level,message:is(r)},{event:r})}}function q5(t,e){return function(n){if(Mt()!==t)return;let i,s,o=typeof e=="object"?e.serializeAttribute:void 0,l=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;l&&l>Gc&&(Go&&_e.warn(`\`dom.maxStringLength\` cannot exceed ${Gc}, but a value of ${l} was configured. Sentry will use ${Gc} instead.`),l=Gc),typeof o=="string"&&(o=[o]);try{const d=n.event,u=tO(d)?d.target:d;i=nT(u,{keyAttrs:o,maxStringLength:l}),s=rF(u)}catch{i="<unknown>"}if(i.length===0)return;const c={category:`ui.${n.name}`,message:i};s&&(c.data={"ui.component_name":s}),Sn(c,{event:n.event,name:n.name,global:n.global})}}function Z5(t){return function(r){if(Mt()!==t)return;const n={category:"console",data:{arguments:r.args,logger:"console"},level:L3(r.level),message:b_(r.args," ")};if(r.level==="assert")if(r.args[0]===!1)n.message=`Assertion failed: ${b_(r.args.slice(1)," ")||"console.assert"}`,n.data.arguments=r.args.slice(1);else return;Sn(n,{input:r.args,level:r.level})}}function J5(t){return function(r){if(Mt()!==t)return;const{startTimestamp:n,endTimestamp:i}=r,s=r.xhr[Oa];if(!n||!i||!s)return;const{method:o,url:l,status_code:c,body:d}=s,u={method:o,url:l,status_code:c},h={xhr:r.xhr,input:d,startTimestamp:n,endTimestamp:i},p={category:"xhr",data:u,type:"http",level:OT(c)};t.emit("beforeOutgoingRequestBreadcrumb",p,h),Sn(p,h)}}function Q5(t){return function(r){if(Mt()!==t)return;const{startTimestamp:n,endTimestamp:i}=r;if(i&&!(r.fetchData.url.match(/sentry_key/)&&r.fetchData.method==="POST"))if(r.fetchData.method,r.fetchData.url,r.error){const s=r.fetchData,o={data:r.error,input:r.args,startTimestamp:n,endTimestamp:i},l={category:"fetch",data:s,level:"error",type:"http"};t.emit("beforeOutgoingRequestBreadcrumb",l,o),Sn(l,o)}else{const s=r.response,o={...r.fetchData,status_code:s==null?void 0:s.status};r.fetchData.request_body_size,r.fetchData.response_body_size,s==null||s.status;const l={input:r.args,response:s,startTimestamp:n,endTimestamp:i},c={category:"fetch",data:o,type:"http",level:OT(o.status_code)};t.emit("beforeOutgoingRequestBreadcrumb",c,l),Sn(c,l)}}}function eO(t){return function(r){if(Mt()!==t)return;let n=r.from,i=r.to;const s=Dp(Je.location.href);let o=n?Dp(n):void 0;const l=Dp(i);o!=null&&o.path||(o=s),s.protocol===l.protocol&&s.host===l.host&&(i=l.relative),s.protocol===o.protocol&&s.host===o.host&&(n=o.relative),Sn({category:"navigation",data:{from:n,to:i}})}}function tO(t){return!!t&&!!t.target}const rO=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],nO="BrowserApiErrors",iO=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...t};return{name:nO,setupOnce(){e.setTimeout&&xr(Je,"setTimeout",l1),e.setInterval&&xr(Je,"setInterval",l1),e.requestAnimationFrame&&xr(Je,"requestAnimationFrame",oO),e.XMLHttpRequest&&"XMLHttpRequest"in Je&&xr(XMLHttpRequest.prototype,"send",aO);const r=e.eventTarget;r&&(Array.isArray(r)?r:rO).forEach(i=>lO(i,e))}}},sO=iO;function l1(t){return function(...e){const r=e[0];return e[0]=$o(r,{mechanism:{handled:!1,type:`auto.browser.browserapierrors.${Mi(t)}`}}),t.apply(this,e)}}function oO(t){return function(e){return t.apply(this,[$o(e,{mechanism:{data:{handler:Mi(t)},handled:!1,type:"auto.browser.browserapierrors.requestAnimationFrame"}})])}}function aO(t){return function(...e){const r=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(i=>{i in r&&typeof r[i]=="function"&&xr(r,i,function(s){const o={mechanism:{data:{handler:Mi(s)},handled:!1,type:`auto.browser.browserapierrors.xhr.${i}`}},l=xx(s);return l&&(o.mechanism.data.handler=Mi(l)),$o(s,o)})}),t.apply(this,e)}}function lO(t,e){var i,s;const n=(i=Je[t])==null?void 0:i.prototype;(s=n==null?void 0:n.hasOwnProperty)!=null&&s.call(n,"addEventListener")&&(xr(n,"addEventListener",function(o){return function(l,c,d){try{cO(c)&&(c.handleEvent=$o(c.handleEvent,{mechanism:{data:{handler:Mi(c),target:t},handled:!1,type:"auto.browser.browserapierrors.handleEvent"}}))}catch{}return e.unregisterOriginalCallbacks&&dO(this,l,c),o.apply(this,[l,$o(c,{mechanism:{data:{handler:Mi(c),target:t},handled:!1,type:"auto.browser.browserapierrors.addEventListener"}}),d])}}),xr(n,"removeEventListener",function(o){return function(l,c,d){try{const u=c.__sentry_wrapped__;u&&o.call(this,l,u,d)}catch{}return o.call(this,l,c,d)}}))}function cO(t){return typeof t.handleEvent=="function"}function dO(t,e,r){t&&typeof t=="object"&&"removeEventListener"in t&&typeof t.removeEventListener=="function"&&t.removeEventListener(e,r)}const uO=()=>({name:"BrowserSession",setupOnce(){if(typeof Je.document>"u"){Go&&_e.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}z_({ignoreDuration:!0}),$_(),$T(({from:t,to:e})=>{t!==void 0&&t!==e&&(z_({ignoreDuration:!0}),$_())})}}),hO="GlobalHandlers",pO=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:hO,setupOnce(){Error.stackTraceLimit=50},setup(r){e.onerror&&(mO(r),c1("onerror")),e.onunhandledrejection&&(gO(r),c1("onunhandledrejection"))}}},fO=pO;function mO(t){VL(e=>{const{stackParser:r,attachStacktrace:n}=HT();if(Mt()!==t||UT())return;const{msg:i,url:s,line:o,column:l,error:c}=e,d=vO(Ax(r,c||i,void 0,n,!1),s,o,l);d.level="error",_T(d,{originalException:c,mechanism:{handled:!1,type:"auto.browser.global_handlers.onerror"}})})}function gO(t){YL(e=>{const{stackParser:r,attachStacktrace:n}=HT();if(Mt()!==t||UT())return;const i=xO(e),s=Qu(i)?yO(i):Ax(r,i,void 0,n,!0);s.level="error",_T(s,{originalException:i,mechanism:{handled:!1,type:"auto.browser.global_handlers.onunhandledrejection"}})})}function xO(t){if(Qu(t))return t;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return t}function yO(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function vO(t,e,r,n){const i=t.exception=t.exception||{},s=i.values=i.values||[],o=s[0]=s[0]||{},l=o.stacktrace=o.stacktrace||{},c=l.frames=l.frames||[],d=n,u=r,h=_O(e)??gx();return c.length===0&&c.push({colno:d,filename:h,function:Ss,in_app:!0,lineno:u}),t}function c1(t){Go&&_e.log(`Global Handler attached: ${t}`)}function HT(){const t=Mt();return(t==null?void 0:t.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}function _O(t){if(!(!zn(t)||t.length===0))return t.startsWith("data:")?`<${x3(t,!1)}>`:t}const bO=()=>({name:"HttpContext",preprocessEvent(t){var n;if(!Je.navigator&&!Je.location&&!Je.document)return;const e=r5(),r={...e.headers,...(n=t.request)==null?void 0:n.headers};t.request={...e,...t.request,headers:r}}}),wO="cause",SO=5,EO="LinkedErrors",TO=(t={})=>{const e=t.limit||SO,r=t.key||wO;return{name:EO,preprocessEvent(n,i,s){const o=s.getOptions();N3(Tx,o.stackParser,r,e,n,i)}}},CO=TO;function AO(){return kO()?(Go&&Qo(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0):!1}function kO(){var s;if(typeof Je.window>"u")return!1;const t=Je;if(t.nw)return!1;const e=t.chrome||t.browser;if(!((s=e==null?void 0:e.runtime)!=null&&s.id))return!1;const r=gx(),n=["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"];return!(Je===Je.top&&n.some(o=>r.startsWith(`${o}://`)))}function IO(t){return[C3(),w3(),V3(),sO(),Y5(),fO(),CO(),U3(),bO(),uO()]}function RO(t={}){const e=!t.skipBrowserExtensionCheck&&AO();let r=t.defaultIntegrations==null?IO():t.defaultIntegrations;const n={...t,enabled:e?!1:t.enabled,stackParser:HL(t.stackParser||W5),integrations:W4({integrations:t.integrations,defaultIntegrations:r}),transport:t.transport||P5};return m3(f5,n)}function d1(t={}){const e=Je.document,r=(e==null?void 0:e.head)||(e==null?void 0:e.body);if(!r){Go&&_e.error("[showReportDialog] Global document not defined");return}const n=Tn(),i=Mt(),s=i==null?void 0:i.getDsn();if(!s){Go&&_e.error("[showReportDialog] DSN not configured");return}const o={...t,user:{...n.getUser(),...t.user},eventId:t.eventId||F4()},l=Je.document.createElement("script");l.async=!0,l.crossOrigin="anonymous",l.src=G4(s,o);const{onLoad:c,onClose:d}=o;if(c&&(l.onload=c),d){const u=h=>{if(h.data==="__sentry_reportdialog_closed__")try{d()}finally{Je.removeEventListener("message",u)}};Je.addEventListener("message",u)}r.appendChild(l)}function PO(t){const e={...t};return BT(e,"react"),L4("react",{version:w.version}),RO(e)}function jO(t){const e=t.match(/^([^.]+)/);return e!==null&&parseInt(e[0])>=17}function MO(t,e){const r=new WeakSet;function n(i,s){if(!r.has(i)){if(i.cause)return r.add(i),n(i.cause,s);i.cause=s}}n(t,e)}function NO(t,{componentStack:e},r){if(jO(w.version)&&Gl(t)&&e){const n=new Error(t.message);n.name=`React ErrorBoundary ${t.name}`,n.stack=e,MO(t,n)}return vx(n=>(n.setContext("react",{componentStack:e}),vT(t,r)))}const BO=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Fp={componentStack:null,error:null,eventId:null};class DO extends w.Component{constructor(e){super(e),this.state=Fp,this._openFallbackReportDialog=!0;const r=Mt();r&&e.showDialog&&(this._openFallbackReportDialog=!1,this._cleanupHook=r.on("afterSendEvent",n=>{!n.type&&this._lastEventId&&n.event_id===this._lastEventId&&d1({...e.dialogOptions,eventId:this._lastEventId})}))}componentDidCatch(e,r){const{componentStack:n}=r,{beforeCapture:i,onError:s,showDialog:o,dialogOptions:l}=this.props;vx(c=>{i&&i(c,e,n);const d=this.props.handled!=null?this.props.handled:!!this.props.fallback,u=NO(e,r,{mechanism:{handled:d,type:"auto.function.react.error_boundary"}});s&&s(e,n,u),o&&(this._lastEventId=u,this._openFallbackReportDialog&&d1({...l,eventId:u})),this.setState({error:e,componentStack:n,eventId:u})})}componentDidMount(){const{onMount:e}=this.props;e&&e()}componentWillUnmount(){const{error:e,componentStack:r,eventId:n}=this.state,{onUnmount:i}=this.props;i&&(this.state===Fp?i(null,null,null):i(e,r,n)),this._cleanupHook&&(this._cleanupHook(),this._cleanupHook=void 0)}resetErrorBoundary(){const{onReset:e}=this.props,{error:r,componentStack:n,eventId:i}=this.state;e&&e(r,n,i),this.setState(Fp)}render(){const{fallback:e,children:r}=this.props,n=this.state;if(n.componentStack===null)return typeof r=="function"?r():r;const i=typeof e=="function"?w.createElement(e,{error:n.error,componentStack:n.componentStack,resetError:()=>this.resetErrorBoundary(),eventId:n.eventId}):e;return w.isValidElement(i)?i:(e&&BO&&_e.warn("fallback did not produce a valid ReactElement"),null)}}const ti={SPECIES_CORRECT:50,CHANNEL_CORRECT:25,TIMING_PERFECT:25,TIMING_PARTIAL:10};class LO{constructor(e){Zn(this,"panner");this.panner=e.createStereoPanner()}get output(){return this.panner}setPan(e){this.panner.pan.value=Math.max(-1,Math.min(1,e))}disconnect(){this.panner.disconnect()}}class u1{constructor(e){Zn(this,"ctx");Zn(this,"inputGain");Zn(this,"leftGain");Zn(this,"rightGain");Zn(this,"merger");this.ctx=e,this.inputGain=e.createGain(),this.leftGain=e.createGain(),this.rightGain=e.createGain(),this.merger=e.createChannelMerger(2),this.inputGain.connect(this.leftGain),this.inputGain.connect(this.rightGain),this.leftGain.connect(this.merger,0,0),this.rightGain.connect(this.merger,0,1),this.setPan(0)}get output(){return this.inputGain}get destination(){return this.merger}setPan(e){const n=(Math.max(-1,Math.min(1,e))+1)*Math.PI/4,i=Math.cos(n),s=Math.sin(n);this.leftGain.gain.setValueAtTime(i,this.ctx.currentTime),this.rightGain.gain.setValueAtTime(s,this.ctx.currentTime)}disconnect(){this.inputGain.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.merger.disconnect()}}class FO{constructor(){Zn(this,"capabilities");this.capabilities=this.detectCapabilities(),console.log("Audio capabilities:",this.capabilities)}detectCapabilities(){const e=navigator.userAgent,r=/iPad|iPhone|iPod/.test(e)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,n=r&&/CriOS/.test(e),i=r&&/FxiOS/.test(e),s=r&&/EdgiOS/.test(e),o=typeof AudioContext<"u"||typeof window.webkitAudioContext<"u",l=o&&typeof StereoPannerNode<"u"&&!n&&!i&&!s;return{supportsStereoPanner:l,supportsWebAudio:o,isIOSChrome:n,isIOS:r,browserInfo:`iOS: ${r}, Chrome: ${n}, StereoPanner: ${l}`}}getCapabilities(){return{...this.capabilities}}supportsStereoPanner(){return this.capabilities.supportsStereoPanner}isIOSChrome(){return this.capabilities.isIOSChrome}createPanner(e){return this.capabilities.supportsStereoPanner?new LO(e):new u1(e)}createChannelPanner(e,r){const n=this.createPanner(e);return n.setPan(r==="left"?-1:1),n}connectPannerToDestination(e,r){e instanceof u1?e.destination.connect(r):e.output.connect(r)}}let Op=null;function h1(){return Op||(Op=new FO),Op}const p1={low:100,medium:150,high:200},OO={level_id:1,pack_id:"common_se_birds",mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},UO={NOCA:"#E57373",CARW:"#81C784",BLJA:"#4FC3F7",AMCR:"#424242",TUTI:"#FFD54F",BEKI:"#00BCD4",RSHA:"#8D6E63",AMGO:"#FFEB3B",CACH:"#B0BEC5",PIWA:"#AED581",WTSP:"#BCAAA4",HOFI:"#EF9A9A",EABL:"#64B5F6",AMRO:"#FF8A65",HETH:"#D7CCC8",BHNU:"#A1887F",BRCR:"#8D6E63",WBNU:"#80CBC4",YBSA:"#FFF59D",RBWO:"#CE93D8",DOWO:"#90A4AE",HAWO:"#CFD8DC",NOFL:"#FFCC80",PIWO:"#B39DDB",BRTH:"#A1887F",GRCA:"#78909C",MODO:"#BCAAA4"};function zO(t){let e=t;return()=>(e=e*1103515245+12345&2147483647,e/2147483647)}function $O(t=OO){const e=w.useRef(null),r=w.useRef(new Map),n=w.useRef(new Map),i=w.useRef(new Map),s=w.useRef(new Map),o=w.useRef(new Map),l=w.useRef(null),[c,d]=w.useState({}),u=w.useMemo(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}},[]),[h,p]=w.useState({}),[f,m]=w.useState(!1),[_,y]=w.useState({}),[x,v]=w.useState(void 0),[g,b]=w.useState([]),[S,j]=w.useState([]),[E,T]=w.useState([]);w.useEffect(()=>{console.log("species state changed, now has",E.length,"species:",E.map(G=>G.code))},[E]),w.useEffect(()=>{fetch("/data/taxonomic_order.json").then(G=>G.json()).then(G=>{d(G)}).catch(G=>console.error("Failed to load taxonomic order:",G))},[]),w.useEffect(()=>{Promise.all([fetch("/data/nz_display_codes.json").then(G=>G.json()).catch(()=>({codes:{}})),Kg()]).then(([G])=>{p(G.codes||{}),m(!0)}).catch(G=>{console.error("Failed to load NZ display codes:",G),m(!0)})},[]),w.useEffect(()=>{if(!t.pack_id.startsWith("nz_")){y({}),v(void 0);return}fetch(`/data/packs/${t.pack_id}.json`).then(ee=>ee.json()).then(ee=>{console.log("Loaded pack config for",t.pack_id,"- subspecies_filter:",ee.subspecies_filter,"region_filter:",ee.region_filter),y(ee.subspecies_filter||{}),v(ee.region_filter)}).catch(ee=>{console.warn("Failed to load pack config for",t.pack_id,ee),y({}),v(void 0)})},[t.pack_id]);const B=w.useCallback(G=>u&&Object.keys(c).length>0?[...G].sort((ee,ve)=>{const ae=c[ee.code]||9999,we=c[ve.code]||9999;return ae-we}):[...G].sort((ee,ve)=>ee.tileName.localeCompare(ve.tileName)),[u,c]),[M,F]=w.useState("idle"),[U,k]=w.useState(!1),[R,z]=w.useState(0),[N,P]=w.useState(0),[L,I]=w.useState(t.round_duration_sec),D=w.useRef(0),[C,A]=w.useState(0),[O,H]=w.useState(0),[pe,ie]=w.useState(0),[V,ge]=w.useState(0),[Re,je]=w.useState(0),[Te,fe]=w.useState([]),[Me,ct]=w.useState([]),[wt,pt]=w.useState(0),Lr=w.useRef(1),Xt=w.useRef(typeof window<"u"&&localStorage.getItem("soundfield_continuous_play")==="true"),[Yl,Kl]=w.useState(0),Ms=5e3,[na,qn]=w.useState(()=>{const G=p1[t.event_density]||100,ee=localStorage.getItem("soundfield_scroll_speed"),ve=ee?parseFloat(ee):.5;return Lr.current=ve,G*ve}),[q,Ie]=w.useState(null),[We,le]=w.useState(!0),oe=w.useRef(null),$=w.useRef([]),W=w.useRef(0),X=w.useRef([]),Z=w.useRef(new Set),Pe=w.useRef(0),dt=w.useRef(0),Ve=w.useRef(0),gt=w.useRef(0),wr=w.useRef(0),At=w.useRef(0),Yt=w.useRef([]),ia=w.useRef([]),ze=w.useRef(0),Sr=w.useRef(null),Ut=w.useRef(null),Fr=w.useRef({left:null,right:null}),tt=w.useRef({left:null,right:null}),oh=w.useCallback(async()=>{var G;if(!f){console.log("loadClips: Waiting for NZ display codes to load...");return}console.log("loadClips called with level:",{pack_id:t.pack_id,species_pool_length:(G=t.species_pool)==null?void 0:G.length,species_count:t.species_count});try{const ee=t.pack_id.startsWith("nz_")||t.pack_id==="custom"&&localStorage.getItem("soundfield_custom_pack_region")==="nz",ve=ee?"clips-nz.json":"clips.json";console.log("loadClips: Loading",ve,"for pack",t.pack_id);const ae=await fetch(`/data/${ve}`);if(!ae.ok)throw new Error(`Failed to load ${ve}`);const we=await ae.json();b(we);const xe=t.species_pool,ye=xe?new Set(xe):null,ke=new Map,Oe=sessionStorage.getItem("nzSortMode")||"maori",Ne=sessionStorage.getItem("naDisplayMode")||"code",xt=ee&&Oe==="english",J=!ee&&Ne==="name";for(const Se of we){if(ye&&!ye.has(Se.species_code))continue;const rt=ee?Jw(Se.species_code):Se.species_code;if(ee&&Se.species_code!==rt&&console.log(`loadClips: Mapped subspecies ${Se.species_code} -> ${rt}`),!ke.has(rt)){const Xe=h[rt],Nt=(Xe==null?void 0:Xe.code)||rt;let Er;ee?Er=xt&&(Xe!=null&&Xe.englishName)?Xe.englishName:(Xe==null?void 0:Xe.tileName)||rt:Er=J?Se.common_name:rt,ke.set(rt,{code:rt,displayCode:Nt,tileName:Er,name:Se.common_name,color:UO[rt]})}}const ce=Array.from(ke.values());console.log("loadClips: Built speciesMap with keys:",Array.from(ke.keys())),j(ce);const Be=sessionStorage.getItem("roundSpecies");if(console.log("loadClips: roundSpecies from sessionStorage:",Be),Be)try{const Se=JSON.parse(Be);console.log("loadClips: Parsed preSelected order:",Se);const rt=new Map(ce.map(Nt=>[Nt.code,Nt])),Xe=Se.map(Nt=>rt.get(Nt)).filter(Nt=>Nt!==void 0);if(Xe.length>0){console.log("loadClips: Using pre-selected species (preserving order):",Xe.map(Nt=>Nt.code)),console.log("loadClips: Species tileNames in order:",Xe.map(Nt=>Nt.tileName)),T(Xe);return}}catch(Se){console.error("Failed to parse pre-selected species in loadClips:",Se)}console.log("loadClips: No pre-selected species, using pool (will be shuffled in startRound)"),T(ce)}catch(ee){console.error("Error loading clips:",ee)}},[t.pack_id,t.species_pool,t.species_count,h,f]);w.useEffect(()=>{f&&(console.log("NZ display codes loaded or pack changed, running loadClips for pack:",t.pack_id),oh())},[f,t.pack_id]);const kx=w.useCallback(async()=>{if(e.current){console.log("initializeAudio: Already initialized, setting isAudioReady"),le(!0);return}try{const G=h1();console.log("initializeAudio: Browser capabilities:",G.getCapabilities());const ee=new AudioContext;e.current=ee,console.log("initializeAudio: AudioContext created, state:",ee.state),ee.state==="suspended"&&(console.log("initializeAudio: AudioContext suspended, attempting resume..."),await ee.resume(),console.log("initializeAudio: AudioContext resumed, state:",ee.state)),le(!0),console.log("initializeAudio: Audio is ready!")}catch(G){console.error("initializeAudio: Failed to initialize audio:",G),le(!0)}},[]),ah=w.useCallback(async G=>{const ee=e.current;if(!ee)throw new Error("Audio context not initialized");const ve=r.current.get(G);if(ve)return console.log("loadAudioBuffer: Using cached buffer for",G),ve;console.log("loadAudioBuffer: Fetching",G);const ae=await fetch(`/${G}`);if(!ae.ok)throw console.error("loadAudioBuffer: Fetch failed",ae.status,ae.statusText),new Error(`Failed to load audio: ${G}`);console.log("loadAudioBuffer: Fetch OK, decoding...");const we=await ae.arrayBuffer();try{const xe=await ee.decodeAudioData(we);return console.log("loadAudioBuffer: Decoded OK, duration:",xe.duration),r.current.set(G,xe),xe}catch(xe){throw console.error(` DECODE FAILED for ${G}:`,xe),console.error("  This file cannot be played in Web Audio API (gameplay)"),console.error("  File size:",we.byteLength,"bytes"),Sn({category:"audio",message:`Decode failed: ${G} (${we.byteLength} bytes)`,level:"error"}),new Error(`Cannot decode audio file: ${G} - ${xe}`)}},[]),Ix=w.useCallback(async(G,ee,ve,ae)=>{const we=e.current;if(!we){console.error("playAudio: No AudioContext!");return}console.log("playAudio:",G,"ctx.state:",we.state);try{we.state==="suspended"&&(console.log("playAudio: Context suspended, trying to resume..."),await we.resume());const xe=await ah(G);console.log("playAudio: Buffer loaded, duration:",xe.duration);const ye=h1();console.log("playAudio: Using adapter, capabilities:",ye.getCapabilities());const ke=we.createBufferSource(),Oe=we.createGain(),Ne=ye.createChannelPanner(we,ee);Oe.gain.value=.05,ke.buffer=xe,ke.connect(Oe),Oe.connect(Ne.output),ye.connectPannerToDestination(Ne,we.destination),ke.loop=!0,n.current.set(ve,ke),i.current.set(ve,Oe),s.current.set(ve,Ne),o.current.set(ve,ae),ke.onended=()=>{n.current.delete(ve),i.current.delete(ve);const xt=s.current.get(ve);xt&&(xt.disconnect(),s.current.delete(ve)),o.current.delete(ve)},ke.start(),console.log("playAudio: Started playing")}catch(xe){console.error(" playAudio FAILED for",G),console.error("   Error:",xe),console.error("   This bird will have no audio during gameplay!")}},[ah]),sa=w.useCallback(G=>{const ee=n.current.get(G);if(ee)try{ee.stop()}catch{}const ve=s.current.get(G);ve&&ve.disconnect(),n.current.delete(G),i.current.delete(G),s.current.delete(G),o.current.delete(G)},[]),Rx=w.useCallback((G,ee,ve,ae)=>{let we=[G];if(x){const ye=_[G];if(ye)we=[ye],console.log(`selectClipsForSpecies: Using subspecies filter ${G} -> ${ye} for region ${x}`);else{const ke=Zw(G);if(ke){const Oe=lI((Object.keys(ke.region_labels).find(Ne=>ke.region_labels[Ne]===x),G),x);Oe&&(we=[Oe],console.log(`selectClipsForSpecies: Using regional subspecies ${G} -> ${Oe} for region ${x}`))}}}const xe=ee.filter(ye=>we.includes(ye.species_code)&&!ye.rejected);if(xe.length===0){console.warn(`selectClipsForSpecies: No clips found for ${we.join(", ")}, falling back to ${G}`);const ye=ee.filter(ke=>ke.species_code===G&&!ke.rejected);return ye.length===0?[]:Px(ye,ve,ae)}return Px(xe,ve,ae)},[_,x]),Px=w.useCallback((G,ee,ve)=>{if(G.length===0)return[];const ae=G.filter(Ne=>Ne.canonical),we=G.filter(Ne=>!Ne.canonical);if(ee==="canonical")return ae.length>0?ae:G.slice(0,1);if(ee==="all")return G;const xe=ee,ye=[];ae.length>0&&ye.push(...ae);const ke=[...we];for(let Ne=ke.length-1;Ne>0;Ne--){const xt=Math.floor(ve()*(Ne+1));[ke[Ne],ke[xt]]=[ke[xt],ke[Ne]]}const Oe=xe-ye.length;return ye.push(...ke.slice(0,Oe)),ye},[]),jx=w.useCallback(G=>{const ee=[],ve=Date.now(),ae=zO(ve),we=t.clip_selection??(t.canonical_only?"canonical":"all");let xe;if(G&&G.length>0)xe=[...G];else if(t.species_pool&&t.species_pool.length>0)xe=[...t.species_pool];else{const J=new Set;for(const Be of g)Be.rejected||J.add(Be.species_code);const ce=Array.from(J);for(let Be=ce.length-1;Be>0;Be--){const Se=Math.floor(ae()*(Be+1));[ce[Be],ce[Se]]=[ce[Se],ce[Be]]}xe=ce.slice(0,t.species_count)}const ye=new Map;for(const J of xe){const ce=Rx(J,g,we,ae);ce.length>0&&ye.set(J,ce)}if(xe=xe.filter(J=>ye.has(J)),xe.length===0)return console.error("No species with available clips!"),[];console.log("generateEvents:",{clipSelection:we,selectedSpecies:xe,clipsPerSpecies:Object.fromEntries(Array.from(ye.entries()).map(([J,ce])=>[J,ce.map(Be=>Be.clip_id)]))});const ke=2,Oe=new Map,xt=localStorage.getItem("soundfield_continuous_play")==="true"?100:Math.ceil(t.round_duration_sec/2)+5;for(let J=0;J<xt;J++){const ce=xe.filter(Er=>(ye.get(Er)||[]).some(Gi=>(Oe.get(Gi.clip_id)||0)<ke));let Be;ce.length>0?Be=ce[Math.floor(ae()*ce.length)]:Be=xe[Math.floor(ae()*xe.length)];const Se=ye.get(Be)||[],rt=Se.filter(Er=>(Oe.get(Er.clip_id)||0)<ke);let Xe;if(rt.length>0?Xe=rt[Math.floor(ae()*rt.length)]:Xe=Se.reduce((Er,oa)=>{const Gi=Oe.get(Er.clip_id)||0;return(Oe.get(oa.clip_id)||0)<Gi?oa:Er},Se[0]),!Xe)continue;Oe.set(Xe.clip_id,(Oe.get(Xe.clip_id)||0)+1);const Nt=ae()<.5?"left":"right";ee.push({event_id:`evt_${J}_${ve}`,clip_id:Xe.clip_id,species_code:Be,channel:Nt,scheduled_time_ms:0,scoring_window_start_ms:0,scoring_window_end_ms:0,duration_ms:Xe.duration_ms,vocalization_type:Xe.vocalization_type})}return ee},[g,t,Rx]),Mx=w.useCallback(G=>g.find(ee=>ee.clip_id===G),[g]),Or=w.useCallback(G=>{const ee=ia.current,ve=ze.current,ae=t.channel_mode||"single",we=Ms/Lr.current;if(ve>=ee.length){ae==="single"?Sr.current=null:G&&(Fr.current[G]=null);return}const xe=performance.now(),ye=W.current,ke=xe-ye;if(!Xt.current&&t.round_duration_sec*1e3-ke<2e3){ae==="single"?Sr.current=null:G&&(Fr.current[G]=null);return}const Oe=ee[ve];ze.current=ve+1;let Ne;if(ae==="offset"&&G?Ne=G:Ne=Oe.channel,ae==="single")Ut.current!==null&&(clearTimeout(Ut.current),Ut.current=null);else{const Tr=tt.current[Ne];Tr!==null&&(clearTimeout(Tr),tt.current[Ne]=null)}const xt=ke,J=ke+we,ce={...Oe,channel:Ne,scheduled_time_ms:J,scoring_window_start_ms:xt,scoring_window_end_ms:J+500};ae==="single"?Sr.current=ce.event_id:Fr.current[Ne]=ce.event_id;const Be=Mx(ce.clip_id);if(!Be){console.error("spawnNextEvent: clip not found for clip_id:",ce.clip_id,"species:",ce.species_code),ae==="single"?Or():G&&Or(G);return}X.current.push(ce);const Se=h[ce.species_code],rt=sessionStorage.getItem("nzSortMode")||"maori",Xe=sessionStorage.getItem("naDisplayMode")||"code",Nt=!!Se,Er=rt==="english"&&(Se==null?void 0:Se.englishName),oa=!Nt&&Xe==="name";let Gi;Nt?Gi=Er?Se.englishName:(Se==null?void 0:Se.tileName)||ce.species_code:Gi=oa?Be.common_name:ce.species_code;const $x={...ce,spectrogramPath:Be.spectrogram_path||null,filePath:Be.file_path,displayCode:(Se==null?void 0:Se.code)||ce.species_code,tileName:Gi};ct(Tr=>[...Tr,$x]),Ix(Be.file_path,Ne,ce.event_id,ce.scheduled_time_ms),fe(Tr=>[...Tr,{...ce,isActive:!0,hasBeenScored:!1}]);const ZT=we+500,aa=ce.event_id,la=Ne,Gx=ce.species_code,Hx=window.setTimeout(()=>{if(ae==="single"){if(Sr.current!==aa)return;Ut.current=null}else{if(Fr.current[la]!==aa)return;tt.current[la]=null}sa(aa),fe(Tr=>Tr.map(Hi=>Hi.event_id===aa?{...Hi,isActive:!1}:Hi)),fe(Tr=>{const Hi=Tr.find(ca=>ca.event_id===aa);if(Hi&&!Hi.hasBeenScored){je(Ns=>Ns+1),wr.current+=1,P(0),Yt.current.push({expectedSpecies:Gx,guessedSpecies:null,channel:la});const ca={id:`miss_${Date.now()}`,type:"miss",score:0,breakdown:{speciesCorrect:!1,channelCorrect:!1,timingAccuracy:"miss",speciesPoints:0,channelPoints:0,timingPoints:0,totalPoints:0},channel:la,timestamp:performance.now(),expectedSpecies:Gx};Ie(ca),setTimeout(()=>{Ie(Ns=>(Ns==null?void 0:Ns.id)===ca.id?null:Ns)},1500)}return Tr}),window.setTimeout(()=>{ae==="single"?Or():Or(la)},200)},ZT);ae==="single"?Ut.current=Hx:tt.current[Ne]=Hx},[Mx,Ix,sa,t.round_duration_sec,t.channel_mode]),Nx=w.useCallback((G,ee)=>{if((t.channel_mode||"single")==="single"){if(Sr.current!==G)return;Ut.current!==null&&(clearTimeout(Ut.current),Ut.current=null),Sr.current=null,sa(G),Or()}else{if(Fr.current[ee]!==G)return;const ae=tt.current[ee];ae!==null&&(clearTimeout(ae),tt.current[ee]=null),Fr.current[ee]=null,sa(G),Or(ee)}},[sa,Or,t.channel_mode]),Bx=w.useCallback(async()=>{console.log("initialize: Starting...");try{await Promise.all([oh().catch(G=>console.error("initialize: loadClips failed:",G)),kx().catch(G=>console.error("initialize: initializeAudio failed:",G))])}catch(G){console.error("initialize: Failed:",G)}le(!0),console.log("initialize: Complete, isAudioReady forced to true")},[oh,kx]),Dx=w.useCallback(async()=>{if(console.log("startRound called, roundState:",M,"clips.length:",g.length),M!=="idle"||g.length===0)return;let G=e.current;if(G||(G=new AudioContext,e.current=G,console.log("AudioContext created during tap")),G.state==="suspended")try{await G.resume(),console.log("AudioContext resumed, state:",G.state)}catch(J){console.error("Failed to resume AudioContext:",J)}try{const J="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAYYoRwmHAAAAAAD/+1DEAAAHAAGf9AAAIgAANIAAAARMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7UMQbA8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",ce=new Audio(J);ce.volume=.01,await ce.play(),console.log("HTML5 silent audio played to unlock iOS audio session")}catch(J){console.error("Failed to play HTML5 silent audio:",J)}console.log("AudioContext state:",G.state),le(!0);const ee=p1[t.event_density]||100,ve=localStorage.getItem("soundfield_scroll_speed"),ae=ve?parseFloat(ve):.5;Lr.current=ae,qn(ee*ae),z(0),P(0),A(0),H(0),ie(0),ge(0),je(0),fe([]),ct([]),Ie(null),I(t.round_duration_sec),Z.current.clear(),Pe.current=0,dt.current=0,Ve.current=0,gt.current=0,wr.current=0,At.current=0,Yt.current=[],X.current=[];let we;console.log("startRound: species.length =",E.length,"allPoolSpecies.length =",S.length,"species_count =",t.species_count);const xe=sessionStorage.getItem("roundSpecies")!==null;if(console.log("startRound: hasExplicitSelection =",xe),xe&&E.length>0)console.log("startRound: Using explicit selection from PreRoundPreview:",E.map(J=>J.code)),console.log("startRound: Species tileNames in order:",E.map(J=>J.tileName)),we=E.map(J=>J.code);else if(t.species_count&&S.length>t.species_count){console.log("startRound: Randomly selecting",t.species_count,"species from pool of",S.length);const J=[...S];for(let Se=J.length-1;Se>0;Se--){const rt=Math.floor(Math.random()*(Se+1));[J[Se],J[rt]]=[J[rt],J[Se]]}const ce=J.slice(0,t.species_count),Be=B(ce);console.log("Random selection: setting species to",Be.length,"species:",Be.map(Se=>Se.code)),T(Be),we=Be.map(Se=>Se.code)}else console.log("Using all pool species:",S.length),T(S),we=S.map(J=>J.code);const ye=jx(we);ia.current=ye,ze.current=0;const ke=[...new Set(ye.map(J=>J.clip_id))];console.log("Preloading",ke.length,"audio clips during tap gesture...");const Oe=ke.map(async J=>{const ce=g.find(Be=>Be.clip_id===J);if(ce)try{await ah(ce.file_path)}catch(Be){console.error("Failed to preload clip:",J,Be)}});await Promise.all(Oe),console.log("Audio preloading complete"),Sr.current=null,Ut.current!==null&&(clearTimeout(Ut.current),Ut.current=null),Fr.current={left:null,right:null},tt.current.left!==null&&clearTimeout(tt.current.left),tt.current.right!==null&&clearTimeout(tt.current.right),tt.current={left:null,right:null};const Ne=performance.now();if(F("playing"),pt(Ne),W.current=Ne,(t.channel_mode||"single")==="single")Or();else{Or("left");const ce=window.setTimeout(()=>{Or("right")},1500);$.current.push(ce)}if(Xt.current=localStorage.getItem("soundfield_continuous_play")==="true",Xt.current)I(0),oe.current=window.setInterval(()=>{I(J=>J+1)},1e3);else{oe.current=window.setInterval(()=>{I(ce=>ce<=1?(rn(),0):ce-1)},1e3);const J=window.setTimeout(()=>{rn()},t.round_duration_sec*1e3);$.current.push(J)}},[M,g.length,t.round_duration_sec,t.channel_mode,t.species_count,S,jx,Or]),rn=w.useCallback(()=>{F("ended"),oe.current&&(clearInterval(oe.current),oe.current=null),Ut.current!==null&&(clearTimeout(Ut.current),Ut.current=null),Sr.current=null,tt.current.left!==null&&clearTimeout(tt.current.left),tt.current.right!==null&&clearTimeout(tt.current.right),tt.current={left:null,right:null},Fr.current={left:null,right:null};for(const ae of $.current)clearTimeout(ae);$.current=[];for(const ae of n.current.values())try{ae.stop()}catch{}for(const ae of s.current.values())ae.disconnect();n.current.clear(),i.current.clear(),s.current.clear(),o.current.clear();const G={};for(const ae of X.current){const we=ae.species_code;G[we]||(G[we]={total:0,correct:0}),G[we].total++,Z.current.has(ae.event_id)&&G[we].correct++}const ee=Z.current.size,ve={score:dt.current,eventsScored:ee,totalEvents:X.current.length,speciesCorrect:Ve.current,channelCorrect:gt.current,perfectCount:Pe.current,missCount:wr.current,maxStreak:At.current,speciesResults:G,species:E.map(ae=>({code:ae.code,name:ae.name})),mode:t.mode,packId:t.pack_id,levelId:t.level_id,levelTitle:t.title,confusionData:Yt.current};localStorage.setItem("soundfield_round_results",JSON.stringify(ve))},[E,t.mode,t.pack_id,t.level_id,t.title]),Lx=w.useCallback(()=>{M!=="playing"||U||(k(!0),D.current=performance.now(),oe.current&&(clearInterval(oe.current),oe.current=null),e.current&&e.current.state==="running"&&e.current.suspend())},[M,U]),Fx=w.useCallback(()=>{M!=="playing"||!U||(k(!1),e.current&&e.current.state==="suspended"&&e.current.resume(),Xt.current?oe.current=window.setInterval(()=>{I(G=>G+1)},1e3):oe.current=window.setInterval(()=>{I(G=>G<=1?(rn(),0):G-1)},1e3))},[M,U,rn]),Ox=w.useCallback((G,ee,ve,ae)=>{const we=cI(ee,G.species_code),xe=ve===G.channel,ye=G.scheduled_time_ms,ke=G.scoring_window_start_ms,Oe=ye-ke,Ne=ye-ae,xt=Math.max(0,Math.min(1,Ne/Oe));let J;xt>=.5?J="perfect":(xt>=.25,J="partial");const ce=we?ti.SPECIES_CORRECT:0,Be=we&&xe?ti.CHANNEL_CORRECT:0;let Se=0;we&&xe&&(xt>=.75?Se=ti.TIMING_PERFECT:xt>=.5&&(Se=ti.TIMING_PARTIAL));const rt=ce+Be+Se;return{speciesPoints:ce,channelPoints:Be,timingPoints:Se,totalPoints:rt,speciesCorrect:we,channelCorrect:xe,timingAccuracy:J}},[]),Ux=w.useCallback((G,ee)=>{if(M!=="playing")return;const ve=performance.now(),ae=ve-W.current,we=t.channel_mode||"single",xe=Te.find(J=>!(J.hasBeenScored||ae<J.scoring_window_start_ms||ae>J.scoring_window_end_ms||we==="offset"&&J.channel!==ee));if(!xe)return;const ye=Ox(xe,G,ee,ae);Yt.current.push({expectedSpecies:xe.species_code,guessedSpecies:G,channel:xe.channel}),ye.speciesCorrect&&Z.current.add(xe.event_id),Nx(xe.event_id,xe.channel),fe(J=>J.map(ce=>ce.event_id===xe.event_id?{...ce,hasBeenScored:!0}:ce)),z(J=>J+ye.totalPoints),dt.current+=ye.totalPoints,A(J=>J+1),ye.speciesCorrect&&(H(J=>J+1),Ve.current+=1),ye.channelCorrect&&(ie(J=>J+1),gt.current+=1);const ke=ti.SPECIES_CORRECT+ti.CHANNEL_CORRECT;ye.totalPoints===ke?(ge(J=>J+1),Pe.current+=1,P(J=>{const ce=J+1;return At.current=Math.max(At.current,ce),ce})):ye.totalPoints>0?P(J=>{const ce=J+1;return At.current=Math.max(At.current,ce),ce}):P(0);let Oe;const Ne=ti.SPECIES_CORRECT+ti.CHANNEL_CORRECT;ye.totalPoints===Ne?Oe="perfect":ye.speciesCorrect&&ye.channelCorrect?Oe="good":ye.speciesCorrect?Oe="partial":Oe="miss";const xt={id:`feedback_${Date.now()}`,type:Oe,score:ye.totalPoints,breakdown:ye,channel:xe.channel,timestamp:ve,expectedSpecies:Oe==="miss"?xe.species_code:void 0};Ie(xt),setTimeout(()=>{Ie(J=>(J==null?void 0:J.id)===xt.id?null:J)},Oe==="miss"?1500:500)},[M,Te,Ox,Nx,t.channel_mode]),zx=w.useCallback(()=>{rn(),F("idle"),z(0),P(0),A(0),H(0),ie(0),ge(0),je(0),fe([]),ct([]),pt(0),Ie(null),I(t.round_duration_sec)},[rn,t.round_duration_sec]);w.useEffect(()=>{if(M!=="playing"){l.current&&(cancelAnimationFrame(l.current),l.current=null);return}const G=()=>{var ae;const ee=performance.now()-W.current,ve=Ms/Lr.current;for(const[we,xe]of i.current.entries()){const ye=o.current.get(we);if(ye===void 0)continue;const ke=ye-ee,Ne=.05+Math.max(0,Math.min(1,1-ke/ve))*.95;xe.gain.setValueAtTime(Ne,((ae=e.current)==null?void 0:ae.currentTime)||0)}l.current=requestAnimationFrame(G)};return l.current=requestAnimationFrame(G),()=>{l.current&&cancelAnimationFrame(l.current)}},[M]),w.useEffect(()=>()=>{oe.current&&clearInterval(oe.current),l.current&&cancelAnimationFrame(l.current);for(const G of $.current)clearTimeout(G);for(const G of n.current.values())try{G.stop()}catch{}},[]),w.useEffect(()=>{if(M!=="playing"||!Xt.current)return;const G=ia.current.length,ee=ze.current;G>0&&ee>=G&&Te.length===0&&(console.log("Continuous mode: all events processed, ending round"),rn())},[M,C,Re,Te.length,rn]);const KT={roundState:M,isPaused:U,score:R,streak:N,timeRemaining:L,totalTime:t.round_duration_sec,eventsScored:C,speciesCorrect:O,channelCorrect:pe,perfectCount:V,missCount:Re,activeEvents:Te,scheduledEvents:Me,roundStartTime:wt,scrollSpeed:na,currentFeedback:q,species:E,isAudioReady:We},qT=w.useMemo(()=>({initialize:Bx,startRound:Dx,endRound:rn,submitInput:Ux,reset:zx,pauseGame:Lx,resumeGame:Fx}),[Bx,Dx,rn,Ux,zx,Lx,Fx]);return[KT,qT]}function f1({code:t,tileName:e,size:r=32,color:n,twoRowLayout:i=!1}){const[s,o]=w.useState(!0),l=`/data/icons/${t}.png`,c=e||t;return i?a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"3px",width:"100%"},children:[s?a.jsx("img",{src:l,alt:c,width:r,height:r,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>o(!1)}):a.jsx("div",{style:{width:r,height:r,borderRadius:"50%",background:n||"transparent",display:"flex",alignItems:"center",justifyContent:"center",fontSize:r*.35,fontWeight:700},children:c.slice(0,4)}),a.jsx("span",{style:{fontSize:"8px",fontWeight:600,color:"#FFFFFF",lineHeight:1.2,textShadow:"0 1px 2px rgba(0,0,0,0.5)",textAlign:"center",width:"100%",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"break-word"},children:c})]}):a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[s&&a.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c}),s?a.jsx("img",{src:l,alt:c,width:r,height:r,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>o(!1)}):a.jsx("div",{style:{width:r,height:r,borderRadius:"50%",background:n||"transparent",display:"flex",alignItems:"center",justifyContent:"center",fontSize:r*.35,fontWeight:700},children:c})]})}const m1=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F"],GO={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function g1(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function x1(t){return t>=4?"offset":"single"}const y1={campaign:{mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},practice:{mode:"practice",round_duration_sec:60,species_count:3,event_density:"low",overlap_probability:0,scoring_window_ms:3e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},challenge:{mode:"challenge",round_duration_sec:60,species_count:8,event_density:"medium",overlap_probability:0,scoring_window_ms:1500,spectrogram_mode:"fading",clip_selection:"all",channel_mode:"offset"},random:{mode:"random",round_duration_sec:45,species_count:6,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"all",channel_mode:"single"}};function HO(){var D;const t=cr(),[e]=Ko(),r=w.useRef(null),[n,i]=w.useState({width:400,height:400}),[s,o]=w.useState(null),[l,c]=w.useState(null),[d,u]=w.useState([]),[h,p]=w.useState(!1),[f,m]=w.useState(()=>localStorage.getItem("soundfield_training_mode")==="true"),_=w.useRef(!1),y=w.useMemo(()=>localStorage.getItem("soundfield_spectrogram_mode")||"full",[]);w.useEffect(()=>{localStorage.setItem("soundfield_training_mode",String(f)),f&&(_.current=!0)},[f]);const x=e.get("mode")||"campaign",v=e.get("pack")||"common_se_birds",g=parseInt(e.get("level")||"1",10);w.useEffect(()=>{console.log("Fetching levels.json..."),fetch("/data/levels.json").then(C=>C.json()).then(C=>{console.log("Loaded",C.length,"levels from levels.json"),u(C)}).catch(C=>{console.error("Failed to load levels.json:",C)})},[]);const b=w.useMemo(()=>{var A;if(console.log("levelConfig useMemo: mode =",x,"packId =",v,"campaignLevels.length =",d.length),v==="custom"){let O=[];try{const H=sessionStorage.getItem("roundSpecies");if(H)O=JSON.parse(H);else{const pe=localStorage.getItem("soundfield_custom_pack");pe&&(O=JSON.parse(pe),sessionStorage.setItem("roundSpecies",pe))}}catch(H){console.error("Failed to parse custom species:",H)}return console.log("Custom pack: using species:",O,"for level",g),{level_id:g,pack_id:"custom",mode:"campaign",title:GO[g]||`Level ${g}`,round_duration_sec:30,species_count:O.length,species_pool:O,clip_selection:g1(g),channel_mode:x1(g),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:y}}if(v==="drill"){let O=[];try{const H=sessionStorage.getItem("roundSpecies");if(H)O=JSON.parse(H);else{const pe=sessionStorage.getItem("drillSpecies");pe&&(O=JSON.parse(pe),sessionStorage.setItem("roundSpecies",pe))}}catch(H){console.error("Failed to parse drill species:",H)}return console.log("Drill pack: using species:",O),{level_id:g,pack_id:"drill",mode:"campaign",title:"Confusion Drill",round_duration_sec:30,species_count:O.length,species_pool:O,clip_selection:g1(g),channel_mode:x1(g),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:y}}if(x==="campaign"&&d.length>0){const O=d.find(pe=>pe.pack_id===v&&pe.level_id===g);if(O)return console.log("Found level from levels.json:",O.pack_id,O.title,"species_pool:",(A=O.species_pool)==null?void 0:A.length),{...O,spectrogram_mode:y};const H=d.find(pe=>pe.pack_id===v);return H?(console.log("Using first level for pack:",H.pack_id,H.title),{...H,spectrogram_mode:y}):(console.log("Ultimate fallback to first level"),{...d[0],spectrogram_mode:y})}console.log("Using hardcoded MODE_CONFIGS (no campaign levels loaded yet)");const C=y1[x]||y1.campaign;return{level_id:1,pack_id:v,...C,spectrogram_mode:y}},[x,v,g,d,y]),[S,j]=$O(b),E=w.useRef(null);w.useEffect(()=>{var O,H;if(x==="campaign"&&d.length===0&&v!=="custom"&&v!=="drill"){console.log("Waiting for levels.json to load...");return}const C=((O=b.species_pool)==null?void 0:O.length)??"none",A=`${b.pack_id}-${b.level_id}-${C}`;console.log("Init effect: key =",A,"lastKey =",E.current),E.current!==A&&(E.current=A,console.log("Initializing for",A),j.initialize(),Lk(b.pack_id,b.level_id,((H=b.species_pool)==null?void 0:H.length)??0))},[x,d.length,b.pack_id,b.level_id,b.species_pool,j]),w.useEffect(()=>{const C=()=>{if(r.current){const A=r.current.getBoundingClientRect();i({width:A.width,height:A.height})}};return C(),window.addEventListener("resize",C),()=>window.removeEventListener("resize",C)},[]);const T=w.useRef(j);T.current=j;const B=w.useRef(S.roundState);B.current=S.roundState,w.useEffect(()=>()=>{B.current==="playing"&&T.current.reset()},[]);const M=w.useMemo(()=>localStorage.getItem("soundfield_continuous_play")==="true",[]),F=S.species.map((C,A)=>({code:C.code,displayCode:C.displayCode,tileName:C.tileName||C.displayCode,name:C.name,color:C.color||m1[A%m1.length]})),U=w.useCallback(C=>{o(C);const A=document.getElementById(`flash-${C}`);A&&(A.classList.add("active"),setTimeout(()=>A.classList.remove("active"),150)),l&&(j.submitInput(l,C),o(null),c(null))},[l,j]),k=w.useCallback(C=>{c(C),s&&(j.submitInput(C,s),o(null),c(null))},[s,j]);w.useEffect(()=>{const C=A=>{if(S.roundState==="playing"){if(A.key==="a"||A.key==="A"||A.key==="ArrowLeft"||A.key==="1")U("left");else if(A.key==="d"||A.key==="D"||A.key==="ArrowRight"||A.key==="2")U("right");else if(A.key>="3"&&A.key<="9"){const O=parseInt(A.key)-3;O<F.length&&k(F[O].code)}}};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[S.roundState,U,k,F]);const R=w.useCallback(()=>{j.reset(),t(`/preview?pack=${v}&level=${g}&keepBirds=true`)},[t,j,v,g]),z=w.useCallback(()=>{p(!0)},[]),N=w.useCallback(()=>{p(!1)},[]),P=w.useCallback(()=>{j.reset(),t(`/preview?pack=${v}&level=${g}&keepBirds=true`)},[t,j,v,g]),L=w.useCallback(()=>{console.log("handleStart clicked, isAudioReady:",S.isAudioReady,"species.length:",S.species.length),S.isAudioReady&&S.species.length>0?(console.log("Calling startRound..."),_.current=f,j.startRound()):console.log("Not calling startRound - conditions not met")},[S.isAudioReady,S.species.length,j,f]),I=w.useCallback(()=>{j.endRound();try{const C=localStorage.getItem("soundfield_round_results");if(C){const A=JSON.parse(C);A.usedTrainingMode=_.current,localStorage.setItem("soundfield_round_results",JSON.stringify(A))}}catch(C){console.error("Failed to update results with training mode flag:",C)}t("/summary",{replace:!0})},[t,j]);return w.useEffect(()=>{if(S.roundState==="ended"){try{const C=localStorage.getItem("soundfield_round_results");if(C){const A=JSON.parse(C);A.usedTrainingMode=_.current,localStorage.setItem("soundfield_round_results",JSON.stringify(A));const O=A.correctCount&&A.totalEvents?A.correctCount/A.totalEvents*100:0,H=A.duration??0;Fk(b.pack_id,b.level_id,S.score,O,H)}}catch(C){console.error("Failed to update results with training mode flag:",C)}t("/summary",{replace:!0})}},[S.roundState,S.score,b.pack_id,b.level_id,t]),a.jsxs("div",{className:"gameplay-screen",children:[a.jsx(AI,{score:S.score,streak:S.streak,timeRemaining:S.timeRemaining,mode:x,levelId:b.level_id,levelTitle:b.title}),a.jsx("button",{className:"back-button",onClick:R,"aria-label":"Back to menu",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),S.roundState==="playing"&&a.jsx("button",{className:"quit-button",onClick:z,"aria-label":"Quit round",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("button",{className:`training-toggle ${f?"active":""}`,onClick:()=>{const C=!f;m(C),Ok(C)},"aria-label":f?"Disable training mode":"Enable training mode",title:f?"Training Mode ON - Icons visible":"Training Mode OFF",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f?a.jsxs(a.Fragment,{children:[a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]}):a.jsxs(a.Fragment,{children:[a.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),a.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]})})}),M&&S.roundState==="playing"&&a.jsx("button",{className:"end-round-button",onClick:I,"aria-label":"End round",children:"End Round"}),a.jsxs("div",{ref:r,className:"game-container",children:[a.jsx(DL,{width:n.width,height:n.height,scheduledEvents:S.scheduledEvents,activeEvents:S.activeEvents,roundStartTime:S.roundStartTime,roundState:S.roundState,scrollSpeed:S.scrollSpeed,currentFeedback:S.currentFeedback,onChannelTap:U,trainingMode:f,spectrogramMode:b.spectrogram_mode}),a.jsx("div",{id:"flash-left",className:"channel-flash left"}),a.jsx("div",{id:"flash-right",className:"channel-flash right"}),s&&a.jsx("div",{className:`channel-indicator ${s}`,children:s.toUpperCase()}),S.roundState==="idle"&&a.jsx("div",{className:"start-overlay",children:a.jsx("button",{className:"start-button",onClick:L,disabled:!S.isAudioReady||S.species.length===0,children:S.isAudioReady&&S.species.length>0?"Start Round":"Loading..."})}),S.currentFeedback&&a.jsxs("div",{className:`feedback-overlay ${S.currentFeedback.type} ${S.currentFeedback.channel}`,children:[a.jsxs("div",{className:"feedback-score",children:["+",S.currentFeedback.score]}),a.jsx("div",{className:"feedback-type",children:S.currentFeedback.type.toUpperCase()}),S.currentFeedback.type==="miss"&&S.currentFeedback.expectedSpecies&&a.jsxs("div",{className:"feedback-correct",children:["Was: ",((D=F.find(C=>C.code===S.currentFeedback.expectedSpecies))==null?void 0:D.tileName)||S.currentFeedback.expectedSpecies]})]})]}),a.jsxs("div",{className:"dual-input-panel",children:[a.jsxs("div",{className:"input-column left",children:[a.jsx("div",{className:"column-label",children:"LEFT EAR"}),a.jsx("div",{className:"species-buttons",children:F.map(C=>a.jsx("button",{className:`species-btn ${l===C.code?"selected":""}`,style:{backgroundColor:l===C.code?C.color:void 0},onClick:()=>{j.submitInput(C.code,"left");const A=document.getElementById("flash-left");A&&(A.classList.add("active"),setTimeout(()=>A.classList.remove("active"),150))},disabled:S.roundState!=="playing",children:a.jsx(f1,{code:C.code,tileName:C.tileName,size:40,color:C.color,twoRowLayout:!0})},C.code))})]}),a.jsxs("div",{className:"input-column right",children:[a.jsx("div",{className:"column-label",children:"RIGHT EAR"}),a.jsx("div",{className:"species-buttons",children:F.map(C=>a.jsx("button",{className:`species-btn ${l===C.code?"selected":""}`,style:{backgroundColor:l===C.code?C.color:void 0},onClick:()=>{j.submitInput(C.code,"right");const A=document.getElementById("flash-right");A&&(A.classList.add("active"),setTimeout(()=>A.classList.remove("active"),150))},disabled:S.roundState!=="playing",children:a.jsx(f1,{code:C.code,tileName:C.tileName,size:40,color:C.color,twoRowLayout:!0})},C.code))})]})]}),h&&a.jsx("div",{className:"quit-modal-overlay",children:a.jsxs("div",{className:"quit-modal",children:[a.jsx("h3",{style:{margin:0,marginBottom:"16px",fontSize:"20px"},children:"Quit Round?"}),a.jsx("p",{style:{margin:0,marginBottom:"24px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Your progress will not be saved."}),a.jsxs("div",{style:{display:"flex",gap:"12px"},children:[a.jsx("button",{className:"btn-secondary",onClick:N,style:{flex:1,padding:"12px"},children:"Cancel"}),a.jsx("button",{className:"btn-primary",onClick:P,style:{flex:1,padding:"12px",background:"var(--color-error)"},children:"Quit"})]})]})}),a.jsx("style",{children:`
        .gameplay-screen {
          display: flex;
          flex-direction: column;
          height: 100%;
          background-color: var(--color-background);
          overflow: hidden;
        }

        .back-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 8px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-accent);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .back-button:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .quit-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 8px;
          width: 40px;
          height: 40px;
          background: rgba(229, 115, 115, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-error);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .quit-button:hover {
          background: rgba(229, 115, 115, 0.5);
        }

        .quit-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        .quit-modal {
          background: var(--color-surface);
          border-radius: 16px;
          padding: 24px;
          max-width: 320px;
          width: 90%;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
          animation: slideUp 0.2s ease-out;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

        .training-toggle {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 56px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: 2px solid transparent;
          border-radius: 50%;
          color: var(--color-text-muted);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: all 0.2s;
        }

        .training-toggle:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .training-toggle.active {
          background: rgba(76, 175, 80, 0.3);
          border-color: rgba(76, 175, 80, 0.6);
          color: #81C784;
        }

        .end-round-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 12px;
          padding: 8px 16px;
          background: rgba(229, 115, 115, 0.8);
          border: none;
          border-radius: 20px;
          color: white;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          z-index: 100;
          transition: background 0.2s;
        }

        .end-round-button:hover {
          background: rgba(229, 115, 115, 1);
        }

        .game-container {
          flex: 1;
          position: relative;
          min-height: 0;
          overflow: hidden;
        }

        .channel-flash {
          position: absolute;
          top: 0;
          bottom: 0;
          width: 50%;
          pointer-events: none;
          background: transparent;
          transition: background 0.1s;
        }

        .channel-flash.left {
          left: 0;
        }

        .channel-flash.right {
          right: 0;
        }

        .channel-flash.active {
          background: rgba(255, 255, 255, 0.1);
        }

        .channel-indicator {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 8px 16px;
          background: var(--color-accent);
          color: var(--color-background);
          font-weight: 700;
          font-size: 14px;
          border-radius: 4px;
          pointer-events: none;
          animation: fadeIn 0.15s ease-out;
        }

        .channel-indicator.left {
          left: 20px;
        }

        .channel-indicator.right {
          right: 20px;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-50%) scale(0.9);
          }
          to {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
        }

        .start-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(0, 0, 0, 0.7);
          z-index: 50;
        }

        .start-button {
          padding: 16px 32px;
          font-size: 18px;
          font-weight: 700;
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: transform 0.2s, background 0.2s;
        }

        .start-button:hover:not(:disabled) {
          transform: scale(1.05);
          background: var(--color-accent);
        }

        .start-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .feedback-overlay {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 12px 20px;
          border-radius: 8px;
          pointer-events: none;
          animation: feedbackPop 0.5s ease-out forwards;
          z-index: 60;
        }

        .feedback-overlay.left {
          left: 20%;
        }

        .feedback-overlay.right {
          right: 20%;
        }

        .feedback-overlay.perfect {
          background: var(--color-success);
        }

        .feedback-overlay.good {
          background: #4CAF50;
        }

        .feedback-overlay.partial {
          background: var(--color-accent);
        }

        .feedback-overlay.miss {
          background: var(--color-error);
          animation: feedbackPopMiss 1.5s ease-out forwards;
        }

        .feedback-score {
          font-family: var(--font-mono);
          font-size: 24px;
          font-weight: 700;
          color: white;
          text-align: center;
        }

        .feedback-type {
          font-size: 12px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          text-align: center;
        }

        .feedback-correct {
          font-size: 14px;
          font-weight: 700;
          color: white;
          text-align: center;
          margin-top: 4px;
          padding-top: 4px;
          border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes feedbackPop {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          20% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          40% {
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-80%) scale(1);
          }
        }

        @keyframes feedbackPopMiss {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          5% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          10% {
            transform: translateY(-50%) scale(1);
          }
          85% {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-70%) scale(1);
          }
        }

        .dual-input-panel {
          display: flex;
          justify-content: space-between;
          padding: 8px 12px;
          padding-bottom: calc(12px + var(--safe-area-bottom, 0px));
          background: linear-gradient(0deg, var(--color-surface) 0%, rgba(26, 26, 46, 0.9) 100%);
          gap: 20px;
        }

        .input-column {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }

        .input-column.left {
          align-items: flex-start;
        }

        .input-column.right {
          align-items: flex-end;
        }

        .column-label {
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          padding: 2px 8px;
          border-radius: 4px;
        }

        .input-column.left .column-label {
          color: #81C784;
          background: rgba(129, 199, 132, 0.15);
        }

        .input-column.right .column-label {
          color: #64B5F6;
          background: rgba(100, 181, 246, 0.15);
        }

        .species-buttons {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 6px;
          width: 180px; /* Fixed width for 3 columns */
        }

        .input-column.left .species-buttons {
          justify-self: start;
        }

        .input-column.right .species-buttons {
          justify-self: end;
          margin-left: auto; /* Push to right edge */
        }

        .species-btn {
          padding: 6px;
          border-radius: 12px;
          border: 2px solid var(--color-text-muted);
          background: var(--color-surface);
          color: var(--color-text);
          font-size: 10px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.15s ease-out;
          touch-action: manipulation;
          -webkit-tap-highlight-color: transparent;
          width: 100%; /* Fill grid cell */
          min-width: 0; /* Allow shrinking */
          overflow: hidden; /* Hide overflow */
        }

        .species-btn:hover:not(:disabled) {
          transform: scale(1.1);
        }

        .species-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .species-btn.selected {
          color: var(--color-background);
          transform: scale(1.05);
        }

        .species-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        /* Tablet: larger icons and more spacing */
        @media (min-width: 768px) {
          .species-buttons {
            width: 260px; /* Wider for larger buttons */
            gap: 10px;
          }

          .species-btn {
            padding: 8px;
          }

          .species-btn img {
            width: 52px !important;
            height: 52px !important;
          }

          .species-btn > div > span {
            font-size: 13px !important;
          }
        }
      `})]})}const WT=w.forwardRef(({score:t,accuracy:e,eventsScored:r,totalEvents:n,maxStreak:i,species:s,packId:o,levelId:l,levelTitle:c,topConfusion:d,usedTrainingMode:u},h)=>{const p=w.useRef(null),[f,m]=w.useState(!1),_=w.useRef(new Map),[y,x]=w.useState(!1),[v,g]=w.useState(!1),b=w.useRef(null);w.useEffect(()=>{(async()=>{const T="/",B=s.map(M=>new Promise((F,U)=>{const k=new Image;k.crossOrigin="anonymous",k.onload=()=>F({code:M.code,img:k}),k.onerror=U,k.src=`${T}data/icons/${M.code}.png`}));try{(await Promise.all(B)).forEach(({code:F,img:U})=>{_.current.set(F,U)}),m(!0)}catch(M){console.error("Failed to load bird icons:",M),m(!0)}})()},[s]),w.useEffect(()=>{(async()=>{const T="/",B=new Image;B.crossOrigin="anonymous",B.onload=()=>{b.current=B,g(!0)},B.onerror=()=>{console.error("Failed to load owl icon"),g(!0)},B.src=`${T}data/icons/OwlHeadphones.png`})()},[]),w.useEffect(()=>{if(!f||!v||!p.current)return;const E=p.current,T=E.getContext("2d");if(!T)return;const B=800,M=800,F=window.devicePixelRatio||1;E.width=B*F,E.height=M*F,E.style.width=`${B}px`,E.style.height=`${M}px`,T.scale(F,F),T.textBaseline="alphabetic";const U=T.createLinearGradient(0,0,0,M);if(U.addColorStop(0,"#f0f4f8"),U.addColorStop(1,"#d9e2ec"),T.fillStyle=U,T.fillRect(0,0,B,M),b.current){T.save(),T.globalAlpha=1;const V=280,ge=B-V-20,Re=20;T.beginPath(),T.arc(ge+V/2,Re+V/2,V/2,0,Math.PI*2),T.clip(),T.drawImage(b.current,ge,Re,V,V),T.restore()}T.fillStyle="#102a43",T.font="bold 48px -apple-system, system-ui, sans-serif",T.textAlign="center",T.fillText("ChipNotes! ",B/2,80),T.textAlign="left";const k=60;T.font="80px -apple-system, system-ui, sans-serif",T.fillStyle=e>=80?"#6aaa64":e>=60?"#c9b458":"#787c7e",T.fillText("",k,200),T.font="bold 110px -apple-system, system-ui, sans-serif",T.fillText(`${e}%`,k+95,200),T.font="32px -apple-system, system-ui, sans-serif",T.fillStyle="#334e68",T.fillText(`${t} points`,k,245),T.font="22px -apple-system, system-ui, sans-serif",T.fillStyle="#486581",T.fillText(`${r}/${n} birds identified`,k,280),T.textAlign="center",T.font="bold 26px -apple-system, system-ui, sans-serif",T.fillStyle="#d97706",T.fillText(` Best Streak: ${i}`,B/2,320);const z=s.slice(0,4),N=160,P=24,L=z.length*N+(z.length-1)*P,I=(B-L)/2;let D=365;z.forEach((V,ge)=>{const Re=I+ge*(N+P),je=D,Te=_.current.get(V.code);if(Te){T.save(),T.beginPath(),T.arc(Re+N/2,je+N/2,N/2,0,Math.PI*2),T.clip();const fe=Te.width/Te.height;let Me=N,ct=N,wt=0,pt=0;fe>1?(Me=N*fe,wt=-(Me-N)/2):fe<1&&(ct=N/fe,pt=-(ct-N)/2),T.drawImage(Te,Re+wt,je+pt,Me,ct),T.restore(),T.strokeStyle="#d3d6da",T.lineWidth=3,T.beginPath(),T.arc(Re+N/2,je+N/2,N/2,0,Math.PI*2),T.stroke(),T.font="22px -apple-system, system-ui, sans-serif",T.fillStyle="#102a43",T.fillText(V.code,Re+N/2,je+N+38)}});const C=D+N+100;if(o&&l){const V=WO(o);T.font="22px -apple-system, system-ui, sans-serif",T.fillStyle="#486581",T.fillText(`${V}  Level ${l}`,B/2,C)}const A=s.map(V=>V.code).join("  ");T.font="18px -apple-system, system-ui, sans-serif",T.fillStyle="#627d98";const O=700,H=A.split(" ");let pe="",ie=C+32;for(let V=0;V<H.length;V++){const ge=pe+H[V]+" ";T.measureText(ge).width>O&&V>0?(T.fillText(pe.trim(),B/2,ie),pe=H[V]+" ",ie+=25):pe=ge}if(T.fillText(pe.trim(),B/2,ie),u){const V=ie+35;T.font="18px -apple-system, system-ui, sans-serif",T.fillStyle="#d97706",T.fillText(" Still training. Ready to migrate soon.",B/2,V)}T.font="bold 26px -apple-system, system-ui, sans-serif",T.fillStyle="#102a43",T.textAlign="center",T.fillText("chipnotes.app",B/2,M-60),T.font="20px -apple-system, system-ui, sans-serif",T.fillStyle="#486581",T.fillText("#chipnotes #birdnerd",B/2,M-30),T.getImageData(0,0,1,1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{x(!0)})})},[f,v,t,e,r,n,i,s,o,l,d,u]);const S=()=>{if(!p.current)return;const E=document.createElement("a");E.download=`chipnotes-${e}pct-${Date.now()}.png`,E.href=p.current.toDataURL("image/png"),E.click()},j=async()=>{if(!p.current||!y)throw new Error("Canvas not ready");const E=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;try{if(E){const T=p.current.toDataURL("image/png"),B=window.open();return B&&(B.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
              <title>ChipNotes Score</title>
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <style>
                body {
                  margin: 0;
                  padding: 20px;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
                  background: #1a1a1a;
                  color: white;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  min-height: 100vh;
                }
                img {
                  max-width: 100%;
                  height: auto;
                  border-radius: 12px;
                  box-shadow: 0 10px 40px rgba(0,0,0,0.5);
                }
                .instructions {
                  margin-top: 20px;
                  padding: 16px;
                  background: rgba(255,255,255,0.1);
                  border-radius: 8px;
                  text-align: center;
                  max-width: 90%;
                }
                .instructions h2 {
                  margin: 0 0 12px 0;
                  font-size: 20px;
                }
                .instructions p {
                  margin: 8px 0;
                  font-size: 16px;
                  opacity: 0.9;
                }
                .highlight {
                  color: #d97706;
                  font-weight: 600;
                }
                .close-btn {
                  position: fixed;
                  top: 20px;
                  left: 20px;
                  width: 48px;
                  height: 48px;
                  border-radius: 50%;
                  background: rgba(255,255,255,0.9);
                  border: 2px solid rgba(0,0,0,0.1);
                  color: #1a1a1a;
                  font-size: 28px;
                  font-weight: bold;
                  cursor: pointer;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  transition: all 0.3s;
                  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                  z-index: 1000;
                }
                .close-btn:hover {
                  background: white;
                  transform: scale(1.1);
                  box-shadow: 0 6px 16px rgba(0,0,0,0.4);
                }
              </style>
            </head>
            <body>
              <button class="close-btn" onclick="window.close(); setTimeout(function() { window.history.back(); }, 100);"></button>
              <img src="${T}" alt="ChipNotes Score">
              <div class="instructions">
                <p> <span class="highlight">Press and hold the image above to share or save</span></p>
              </div>
            </body>
            </html>
          `),B.document.close()),"ios-instructions"}else{const T=await new Promise((M,F)=>{p.current.toBlob(U=>{U?M(U):F(new Error("toBlob failed"))},"image/png",1)}),B=new File([T],"chipnotes-score.png",{type:"image/png"});return navigator.share&&navigator.canShare&&navigator.canShare({files:[B]})?(await navigator.share({title:"ChipNotes! Score",text:`Just identified ${r}/${n} birds with ${e}% accuracy! `,files:[B]}),"shared"):(S(),"downloaded")}}catch(T){return console.error("Share failed:",T),S(),"error-downloaded"}};return w.useImperativeHandle(h,()=>({share:j,download:S,isReady:()=>y}),[y]),a.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px"},children:a.jsx("canvas",{ref:p})})});WT.displayName="ShareCard";function WO(t){return{starter_birds:"Common Backyard",expanded_backyard:"Expanded Backyard",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard"}[t]||t}const v1=6,VO={starter_birds:"Backyard Birds",grassland_birds:"Grassland & Open Country",expanded_backyard:"Eastern Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Birds",custom:"Custom Pack",drill:"Confusion Drill",nz_all_birds:"All NZ Birds",nz_common:"Garden & Bush",nz_rare:"Rare & Endemic"},Up=["nz_all_birds","nz_common","nz_rare"],XO="#4db6ac";function Gs(t){return t<=2?"#4CAF50":t<=4?"rgba(245, 166, 35, 0.8)":"#FF5722"}function YO(){const t=cr(),e=w.useRef(null),[r,n]=w.useState(null),[i,s]=w.useState([]),[o,l]=w.useState([]),[c,d]=w.useState(!1),[u,h]=w.useState(!1),[p,f]=w.useState(!1),[m,_]=w.useState(null),[y,x]=w.useState(null);w.useEffect(()=>{var O;const A=localStorage.getItem("soundfield_round_results");if(A)try{const H=JSON.parse(A);if(n(H),H.mode==="campaign"&&H.levelId){const ie="soundfield_progress",V=JSON.parse(localStorage.getItem(ie)||"{}"),ge=`level_${H.levelId}`,Re=((O=V[ge])==null?void 0:O.bestScore)||0;V[ge]={completed:!0,bestScore:Math.max(Re,H.score),accuracy:H.totalEvents>0?Math.round(H.eventsScored/H.totalEvents*100):0},localStorage.setItem(ie,JSON.stringify(V))}const pe=[];for(const ie of H.species){const V=H.speciesResults[ie.code]||{total:0,correct:0};V.total>0&&pe.push({code:ie.code,name:ie.name,total:V.total,correct:V.correct,accuracy:Math.round(V.correct/V.total*100)})}if(pe.sort((ie,V)=>ie.accuracy-V.accuracy),s(pe),H.confusionData&&H.confusionData.length>0){const ie=new Map;for(const ge of H.confusionData){if(ge.guessedSpecies===ge.expectedSpecies)continue;const Re=`${ge.expectedSpecies}|${ge.guessedSpecies??"MISS"}`;ie.set(Re,(ie.get(Re)||0)+1)}const V=[];for(const[ge,Re]of ie.entries()){const[je,Te]=ge.split("|");V.push({expectedSpecies:je,guessedSpecies:Te==="MISS"?null:Te,count:Re})}V.sort((ge,Re)=>Re.count-ge.count),l(V)}}catch(H){console.error("Failed to parse round results:",H)}},[]);const v=r&&r.totalEvents>0?Math.round(r.eventsScored/r.totalEvents*100):0,g=(r==null?void 0:r.mode)==="campaign",b=(r==null?void 0:r.levelId)||1,S=(r==null?void 0:r.packId)||"starter_birds",j=b>1,E=b<v1,T=S==="drill",M=(()=>{if(Up.includes(S)||S==="custom"&&localStorage.getItem("soundfield_custom_pack_region")==="nz")return!0;if(T){if(y&&Up.includes(y.packId))return!0;try{const A=sessionStorage.getItem("drillOrigin");if(A){const O=JSON.parse(A);if(Up.includes(O.packId))return!0}}catch{}}return!1})()?XO:"var(--color-accent)";w.useEffect(()=>{if(T){const A=sessionStorage.getItem("drillOrigin");if(A)try{x(JSON.parse(A))}catch(O){console.error("Failed to parse drill origin:",O)}}},[T]);const F=A=>{if(r!=null&&r.species){const O=r.species.map(H=>H.code);sessionStorage.setItem("roundSpecies",JSON.stringify(O))}t(`/preview?pack=${S}&level=${A}&keepBirds=true`)},U=()=>{t(`/level-select?pack=${S}`)},k=()=>{t("/")},R=()=>{y&&(sessionStorage.removeItem("drillOrigin"),sessionStorage.removeItem("drillSpecies"),t(`/preview?pack=${y.packId}&level=${y.level}`))},N=(()=>{if(!o.length)return[];const A=new Set;for(const O of o)A.add(O.expectedSpecies),O.guessedSpecies&&A.add(O.guessedSpecies);return Array.from(A)})(),P=N.length>=4,[L,I]=w.useState(!1),D=(A=b)=>{sessionStorage.setItem("drillSpecies",JSON.stringify(N)),sessionStorage.setItem("drillOrigin",JSON.stringify({packId:S,level:b})),t(`/preview?pack=drill&level=${A}`)};w.useEffect(()=>{const A=setInterval(()=>{var O;(O=e.current)!=null&&O.isReady()&&(f(!0),clearInterval(A))},100);return()=>clearInterval(A)},[r]);const C=async()=>{if(e.current){h(!0),_(null);try{await e.current.share()==="ios-instructions"&&(_("Follow instructions in new tab to save & share! "),setTimeout(()=>_(null),5e3))}catch(A){console.error("Share failed:",A),_("Share failed. Please try again."),setTimeout(()=>_(null),3e3)}finally{h(!1)}}};return a.jsxs("div",{className:"screen",style:{paddingTop:"calc(12px + var(--safe-area-top, 0px))",paddingBottom:"calc(24px + var(--safe-area-bottom, 0px))"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px"},children:[a.jsx("button",{className:"btn-icon",onClick:U,"aria-label":"Back to levels",style:{color:M,opacity:.6},children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),a.jsxs("div",{style:{flex:1,textAlign:"center"},children:[a.jsx("h1",{style:{fontSize:"20px",margin:0},children:"Round Complete"}),g&&a.jsxs("p",{className:"text-muted",style:{margin:"4px 0 0",fontSize:"13px"},children:["Level ",b,": ",(r==null?void 0:r.levelTitle)||"Campaign"]})]}),a.jsx("button",{className:"btn-icon",onClick:k,"aria-label":"Home",style:{color:M},children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})})]}),r&&a.jsx(WT,{ref:e,score:r.score,accuracy:v,eventsScored:r.eventsScored,totalEvents:r.totalEvents,maxStreak:r.maxStreak,species:r.species,packId:r.packId,levelId:r.levelId,levelTitle:r.levelTitle,usedTrainingMode:r.usedTrainingMode,topConfusion:o.length>0&&o[0].guessedSpecies?{from:o[0].expectedSpecies,to:o[0].guessedSpecies}:null}),a.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[a.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[a.jsx("span",{children:"Score"}),a.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:"24px",color:M,opacity:.85},children:(r==null?void 0:r.score)||0})]}),a.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[a.jsx("span",{children:"Birds Identified"}),a.jsxs("span",{children:[(r==null?void 0:r.eventsScored)||0," / ",(r==null?void 0:r.totalEvents)||0]})]}),a.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[a.jsx("span",{children:"Overall Accuracy"}),a.jsxs("span",{className:v>=70?"text-success":v>=50?"text-accent":"text-error",children:[v,"%"]})]}),a.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[a.jsx("span",{children:"Perfect Hits"}),a.jsx("span",{className:"text-success",children:(r==null?void 0:r.perfectCount)||0})]}),a.jsxs("div",{className:"flex-row justify-between",children:[a.jsx("span",{children:"Best Streak"}),a.jsx("span",{children:(r==null?void 0:r.maxStreak)||0})]}),(r==null?void 0:r.usedTrainingMode)&&a.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid var(--color-surface)",fontSize:"13px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"6px"},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"Training Mode was used"]})]}),a.jsx("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:a.jsx("button",{className:"btn-primary",onClick:()=>F(b),style:{width:"100%"},children:T?"Drill Again":"Play Again"})}),i.length>0&&a.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Species Breakdown"}),i.map(A=>a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[a.jsxs("span",{style:{fontSize:"14px"},children:[A.code," ",a.jsxs("span",{className:"text-muted",children:["(",A.name,")"]})]}),a.jsxs("span",{style:{fontSize:"14px"},children:[A.correct,"/",A.total," (",A.accuracy,"%)"]})]}),a.jsx("div",{style:{height:"8px",backgroundColor:"var(--color-background)",borderRadius:"4px",overflow:"hidden"},children:a.jsx("div",{style:{width:`${A.accuracy}%`,height:"100%",backgroundColor:A.accuracy>=80?"var(--color-success)":A.accuracy>=50?"var(--color-accent)":"var(--color-error)",borderRadius:"4px",transition:"width 0.3s ease"}})})]},A.code))]}),o.length>0&&a.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[a.jsx("h3",{style:{marginBottom:"4px"},children:"Confusion Summary"}),a.jsx("p",{style:{fontSize:"12px",color:"var(--color-text-muted)",margin:"0 0 12px 0"},children:"Played  Your guess"}),o.map((A,O)=>a.jsx("div",{style:{marginBottom:"8px",fontSize:"14px"},children:A.guessedSpecies===null?a.jsxs("span",{children:["Missed ",a.jsx("span",{className:"text-accent",children:A.expectedSpecies}),": ",A.count,"x"]}):a.jsxs("span",{children:[a.jsx("span",{className:"text-accent",children:A.expectedSpecies}),"  ",a.jsx("span",{className:"text-error",children:A.guessedSpecies}),": ",A.count,"x"]})},O)),P&&a.jsxs("div",{style:{marginTop:"12px"},children:[a.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",justifyContent:"center"},children:[a.jsxs("button",{onClick:()=>D(b),style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 14px",fontSize:"13px",fontWeight:600,borderRadius:"8px",border:"none",background:"linear-gradient(135deg, #E57373 0%, #C62828 100%)",color:"white",cursor:"pointer"},children:[a.jsx(JO,{}),"Drill These ",N.length," Birds"]}),a.jsxs("button",{onClick:()=>I(!L),title:"Change drill level",style:{display:"flex",alignItems:"center",gap:"6px",background:"transparent",border:"none",color:Gs(b),fontSize:"12px",cursor:"pointer",padding:"4px"},children:[a.jsx("span",{style:{width:"32px",height:"32px",borderRadius:"50%",background:L?Gs(b):`linear-gradient(135deg, ${Gs(b)}33, ${Gs(b)}11)`,border:`2px solid ${Gs(b)}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"14px",color:L?"var(--color-background)":Gs(b)},children:b}),a.jsx("span",{style:{textDecoration:"underline"},children:"Level"})]})]}),L&&a.jsxs("div",{style:{marginTop:"10px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px"},children:[a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginBottom:"10px",textAlign:"center"},children:"Drill at level:"}),a.jsx("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[1,2,3,4,5,6].map(A=>a.jsx("button",{onClick:()=>D(A),style:{width:"40px",height:"40px",borderRadius:"50%",border:A===b?`2px solid ${M}`:"1px solid var(--color-text-muted)",background:A===b?M:"linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02))",color:A===b?"var(--color-background)":"var(--color-text)",fontWeight:600,fontSize:"16px",cursor:"pointer"},children:A},A))})]})]})]}),a.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto"},children:[g&&a.jsxs("div",{className:"flex-row gap-md",style:{marginBottom:"12px"},children:[a.jsxs("button",{className:"btn-secondary",onClick:()=>F(b-1),disabled:!j,style:{flex:1,opacity:j?1:.4},children:[a.jsx(KO,{})," Prev"]}),a.jsxs("button",{className:"btn-secondary",onClick:()=>d(!c),style:{flex:1},children:["Level ",b,"/",v1]}),a.jsxs("button",{className:"btn-secondary",onClick:()=>F(b+1),disabled:!E,style:{flex:1,opacity:E?1:.4},children:["Next ",a.jsx(qO,{})]})]}),c&&a.jsxs("div",{className:"card",style:{marginBottom:"12px",padding:"12px"},children:[a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginBottom:"8px"},children:"Jump to level:"}),a.jsx("div",{className:"flex-row",style:{flexWrap:"wrap",gap:"8px"},children:[1,2,3,4,5,6].map(A=>a.jsx("button",{onClick:()=>{d(!1),F(A)},style:{width:"40px",height:"40px",borderRadius:"8px",border:A===b?`2px solid ${M}`:"1px solid var(--color-text-muted)",background:A===b?M:"var(--color-surface)",color:A===b?"var(--color-background)":"var(--color-text)",fontWeight:600,cursor:"pointer"},children:A},A))})]}),a.jsxs("div",{className:"flex-col gap-md",children:[T&&y&&a.jsxs("button",{className:"btn-primary",onClick:R,style:{width:"100%",background:"linear-gradient(135deg, #4A90D9 0%, #357ABD 100%)"},children:[" Back to ",VO[y.packId]||y.packId]}),a.jsxs("button",{className:"btn-primary",onClick:C,disabled:u||!r||!p,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[a.jsx(ZO,{}),u?"Generating...":p?"Share Your Score":"Preparing..."]}),a.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",textAlign:"center",marginTop:"-8px",marginBottom:"0",fontStyle:"italic"},children:"Let them Wordle, you already know how to spell."}),m&&a.jsx("p",{style:{fontSize:"14px",color:M,textAlign:"center",marginTop:"0",marginBottom:"0",fontWeight:600,animation:"fadeIn 0.3s ease"},children:m})]})]})]})}function KO(){return a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"4px"},children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}function qO(){return a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"4px"},children:a.jsx("path",{d:"M9 18l6-6-6-6"})})}function ZO(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]})}function JO(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]})}const Ho="chipnotes-v2",sh="chipnotes_offline_packs",VT=4,QO=250,e6=120,t6=25;let Hc=null;function Ua(t){const e=window.location.origin+"/";return new URL(t,e).href}function XT(){const t=window.isSecureContext,e="caches"in window,r="serviceWorker"in navigator;return(!t||!e||!r)&&console.log("[OfflineManager] Support check:",{isSecureContext:t,hasCaches:e,hasServiceWorker:r,protocol:window.location.protocol,hostname:window.location.hostname}),t&&e&&r}async function r6(){return Hc||(Hc=await(await fetch(Ua("data/clips.json"))).json(),Hc)}async function Xl(t){const e=await r6(),n=await(await fetch(Ua(`data/packs/${t}.json`))).json(),i=new Set(n.species),s=e.filter(u=>i.has(u.species_code)&&!u.rejected),o=[];for(const u of i)o.push({url:Ua(`data/icons/${u}.png`),type:"icon"});for(const u of s)o.push({url:Ua(u.file_path),type:"audio"}),u.spectrogram_path&&o.push({url:Ua(u.spectrogram_path),type:"spectrogram"});const l=o.filter(u=>u.type==="audio").length,c=o.filter(u=>u.type==="spectrogram").length,d=Math.round((l*e6+c*t6)/1024);return{packId:t,displayName:n.display_name,clipCount:s.length,estimatedSizeMB:d,assets:o}}let ui=null,ko=null;function yu(){try{const t=localStorage.getItem(sh);if(t){const e=JSON.parse(t);if(e.schemaVersion===1)return e}}catch(t){console.error("Failed to parse offline packs state:",t)}return{schemaVersion:1,packs:{}}}function Wt(t,e){const r=ui||yu(),n=r.packs[t]||{packId:t,status:"not_downloaded",downloadedFiles:0,totalFiles:0,lastUpdated:Date.now()};r.packs[t]={...n,...e,lastUpdated:Date.now()},ui=r,ko||(ko=setTimeout(()=>{ui&&localStorage.setItem(sh,JSON.stringify(ui)),ko=null,ui=null},QO))}function Rl(){ko&&(clearTimeout(ko),ko=null),ui&&(localStorage.setItem(sh,JSON.stringify(ui)),ui=null)}async function YT(t,e,r){const n=[...t],i=[];async function s(){for(;n.length>0;){const o=n.shift();o&&await r(o)}}for(let o=0;o<Math.min(e,t.length);o++)i.push(s());await Promise.all(i)}async function n6(t,e,r){const n=await Xl(t),i=await caches.open(Ho),s=`${Date.now()}-${Math.random().toString(36).slice(2)}`;let o=0;Wt(t,{status:"downloading",downloadedFiles:0,totalFiles:n.assets.length,downloadSessionId:s});async function l(c){if(r!=null&&r.aborted)throw new Error("Download aborted");if(await i.match(c.url)){o++,e(o,n.assets.length),Wt(t,{downloadedFiles:o});return}try{const u=await fetch(c.url,{signal:r});u.ok&&await i.put(c.url,u.clone())}catch(u){if(u.name==="AbortError")throw u;console.warn(`Failed to download ${c.url}:`,u),Sn({category:"offline",message:`Download failed: ${c.url}`,level:"warning"})}o++,e(o,n.assets.length),Wt(t,{downloadedFiles:o})}try{await YT(n.assets,VT,l),Wt(t,{status:"downloaded",downloadedFiles:n.assets.length,downloadSessionId:void 0})}catch(c){if(c.name==="AbortError"||c.message==="Download aborted")Wt(t,{status:"partial",downloadSessionId:void 0});else throw Wt(t,{status:"partial",downloadSessionId:void 0}),c}finally{Rl()}}async function i6(t,e,r){const n=await Xl(t),i=await caches.open(Ho),s=[];for(const u of n.assets)await i.match(u.url)||s.push(u);if(s.length===0){Wt(t,{status:"downloaded",downloadedFiles:n.assets.length,totalFiles:n.assets.length}),Rl(),e(n.assets.length,n.assets.length);return}const o=n.assets.length-s.length;let l=o;const c=`${Date.now()}-${Math.random().toString(36).slice(2)}`;Wt(t,{status:"downloading",downloadedFiles:o,totalFiles:n.assets.length,downloadSessionId:c}),e(l,n.assets.length);async function d(u){if(r!=null&&r.aborted)throw new Error("Download aborted");try{const h=await fetch(u.url,{signal:r});h.ok&&await i.put(u.url,h.clone())}catch(h){if(h.name==="AbortError")throw h;console.warn(`Failed to download ${u.url}:`,h),Sn({category:"offline",message:`Resume download failed: ${u.url}`,level:"warning"})}l++,e(l,n.assets.length),Wt(t,{downloadedFiles:l})}try{await YT(s,VT,d),Wt(t,{status:"downloaded",downloadedFiles:n.assets.length,downloadSessionId:void 0})}catch(u){if(u.name==="AbortError"||u.message==="Download aborted")Wt(t,{status:"partial",downloadSessionId:void 0});else throw Wt(t,{status:"partial",downloadSessionId:void 0}),u}finally{Rl()}}async function s6(t){try{const e=await Xl(t),r=await caches.open(Ho);for(const n of e.assets)if(!await r.match(n.url))return!1;return!0}catch(e){return console.error(`Failed to verify pack ${t}:`,e),!1}}async function o6(){if(!XT())return;const t=yu();for(const[e,r]of Object.entries(t.packs)){if(r.status==="downloaded"||r.status==="partial"){const n=await s6(e);n&&r.status!=="downloaded"?Wt(e,{status:"downloaded"}):!n&&r.status==="downloaded"&&Wt(e,{status:"partial"})}r.status==="downloading"&&Wt(e,{status:"partial",downloadSessionId:void 0})}Rl()}async function a6(t){const e=await Xl(t),r=await caches.open(Ho);for(const n of e.assets)await r.delete(n.url);Wt(t,{status:"not_downloaded",downloadedFiles:0,totalFiles:0,downloadSessionId:void 0}),Rl()}async function l6(){await caches.delete(Ho),localStorage.removeItem(sh),await caches.open(Ho)}async function Wc(){var t;if(!((t=navigator.storage)!=null&&t.estimate))return null;try{const e=await navigator.storage.estimate();return{used:e.usage||0,available:e.quota||0}}catch(e){return console.error("Failed to get storage estimate:",e),null}}function _1(t){return t<1024?`${t} B`:t<1024*1024?`${Math.round(t/1024)} KB`:t<1024*1024*1024?`${Math.round(t/(1024*1024))} MB`:`${(t/(1024*1024*1024)).toFixed(1)} GB`}const Vc=["starter_birds","grassland_birds","sparrows","woodpeckers","spring_warblers","western_birds","expanded_backyard","common_se_birds","nz_common","nz_north_island","nz_south_island","nz_all_birds"],ri={SCROLL_SPEED:"soundfield_scroll_speed",SPECTROGRAM_MODE:"soundfield_spectrogram_mode",CONTINUOUS_PLAY:"soundfield_continuous_play",COOKIE_CONSENT:"chipnotes_cookie_consent"};function c6(){const t=cr(),[e,r]=w.useState(()=>localStorage.getItem(ri.SPECTROGRAM_MODE)||"full"),[n,i]=w.useState(()=>{const F=localStorage.getItem(ri.SCROLL_SPEED);return F?parseFloat(F):.5}),[s,o]=w.useState(()=>localStorage.getItem(ri.CONTINUOUS_PLAY)==="true"),[l,c]=w.useState(()=>localStorage.getItem(ri.COOKIE_CONSENT)==="accepted"),[d]=w.useState(()=>XT()),[u,h]=w.useState({}),[p,f]=w.useState({}),[m,_]=w.useState({}),[y,x]=w.useState(null),[v,g]=w.useState(null),b=w.useRef(null);w.useEffect(()=>{if(!d)return;const F=async()=>{const R={};for(const z of Vc)try{const N=await Xl(z);R[z]=N}catch(N){console.error(`Failed to load manifest for ${z}:`,N)}h(R)},U=async()=>{var N;await o6();const R=yu(),z={};for(const P of Vc)z[P]=((N=R.packs[P])==null?void 0:N.status)||"not_downloaded";f(z)},k=async()=>{const R=await Wc();g(R)};F(),U(),k()},[d]);const S=w.useCallback(async(F,U)=>{if(y)return;x(F),f(z=>({...z,[F]:"downloading"}));const k=new AbortController;b.current=k;const R=(z,N)=>{_(P=>({...P,[F]:{completed:z,total:N}}))};try{U?await i6(F,R,k.signal):await n6(F,R,k.signal),f(z=>({...z,[F]:"downloaded"}))}catch(z){z.name!=="AbortError"&&console.error(`Download failed for ${F}:`,z);const N=yu();f(P=>{var L;return{...P,[F]:((L=N.packs[F])==null?void 0:L.status)||"partial"}})}finally{x(null),b.current=null,_(N=>{const{[F]:P,...L}=N;return L});const z=await Wc();g(z)}},[y]),j=w.useCallback(()=>{b.current&&b.current.abort()},[]),E=w.useCallback(async F=>{try{await a6(F),f(k=>({...k,[F]:"not_downloaded"}));const U=await Wc();g(U)}catch(U){console.error(`Failed to clear pack ${F}:`,U)}},[]),T=w.useCallback(async()=>{if(confirm("This will remove all downloaded packs. You can re-download them anytime. Continue?"))try{await l6();const U={};for(const R of Vc)U[R]="not_downloaded";f(U);const k=await Wc();g(k)}catch(U){console.error("Failed to clear all packs:",U)}},[]);w.useEffect(()=>{localStorage.setItem(ri.SPECTROGRAM_MODE,e)},[e]),w.useEffect(()=>{localStorage.setItem(ri.SCROLL_SPEED,n.toString())},[n]),w.useEffect(()=>{localStorage.setItem(ri.CONTINUOUS_PLAY,s.toString())},[s]);const B=F=>{c(F),localStorage.setItem(ri.COOKIE_CONSENT,F?"accepted":"declined"),alert(F?"Analytics enabled. Please refresh the page for changes to take effect.":"Analytics disabled. Please refresh the page for changes to take effect.")},M=()=>{confirm("This will delete ALL your progress, settings, and custom packs. This cannot be undone. Are you sure?")&&(localStorage.clear(),"caches"in window&&caches.keys().then(U=>{U.forEach(k=>{caches.delete(k)})}),alert("All data has been deleted. The app will now reload."),window.location.href=window.location.origin+"/")};return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[a.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",style:{color:"var(--color-accent)"},children:a.jsx(d6,{})}),a.jsx("h2",{style:{margin:0,flex:1},children:"Settings"}),a.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:a.jsx(u6,{})})]}),a.jsxs("div",{className:"flex-col gap-lg",children:[a.jsxs("div",{className:"card",children:[a.jsx("h3",{children:"Spectrogram Mode"}),a.jsx("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:"Visual difficulty setting"}),a.jsx("div",{className:"flex-row gap-sm",children:["full","fading","none"].map(F=>a.jsx("button",{className:e===F?"btn-primary":"btn-secondary",onClick:()=>r(F),style:{flex:1,textTransform:"capitalize"},children:F},F))})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h3",{children:["Scroll Speed ",a.jsx("span",{style:{fontWeight:400,opacity:.6},children:"(default 0.5x)"})]}),a.jsxs("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:["How fast tiles move: ",n.toFixed(2),"x"]}),a.jsx("input",{type:"range",min:"0.25",max:"2.0",step:"0.05",value:n,onChange:F=>i(parseFloat(F.target.value)),style:{width:"100%"}})]}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex-row justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{style:{marginBottom:"4px"},children:"Continuous Play"}),a.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"No timer - play until all clips done"})]}),a.jsx("button",{className:s?"btn-primary":"btn-secondary",onClick:()=>o(!s),style:{width:"60px"},children:s?"ON":"OFF"})]})}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"8px"},children:"Offline Mode"}),a.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:"Download packs to play without internet. Great for flights!"}),d?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-muted",style:{fontSize:"12px",marginBottom:"12px",fontStyle:"italic"},children:"Note: Packs may be cleared by your browser if storage runs low."}),v&&a.jsxs("div",{className:"text-muted",style:{fontSize:"13px",marginBottom:"16px"},children:["Storage: ",_1(v.used)," used / ~",_1(v.available)," available"]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Vc.map(F=>{const U=u[F],k=p[F]||"not_downloaded",R=y===F;return a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px",backgroundColor:"var(--color-surface)",borderRadius:"6px"},children:[a.jsxs("span",{style:{fontSize:"14px",width:"20px"},children:[k==="downloaded"&&"",k==="partial"&&"",k==="downloading"&&"",k==="not_downloaded"&&""]}),a.jsxs("div",{style:{flex:1,minWidth:0},children:[a.jsx("div",{style:{fontSize:"14px",fontWeight:500},children:(U==null?void 0:U.displayName)||F}),a.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:["~",(U==null?void 0:U.estimatedSizeMB)||"?"," MB"]})]}),R?a.jsx("button",{className:"btn-secondary",onClick:j,style:{fontSize:"12px",padding:"4px 8px"},children:"Cancel"}):k==="downloaded"?a.jsx("button",{className:"btn-secondary",onClick:()=>E(F),style:{fontSize:"12px",padding:"4px 8px"},children:"Remove"}):k==="partial"?a.jsx("button",{className:"btn-secondary",onClick:()=>S(F,!0),disabled:y!==null,style:{fontSize:"12px",padding:"4px 8px"},children:"Resume"}):a.jsx("button",{className:"btn-secondary",onClick:()=>S(F,!1),disabled:y!==null,style:{fontSize:"12px",padding:"4px 8px"},children:"Download"})]},F)})}),y&&m[y]&&a.jsxs("div",{style:{marginTop:"12px"},children:[a.jsx("div",{style:{height:"8px",backgroundColor:"var(--color-surface)",borderRadius:"4px",overflow:"hidden"},children:a.jsx("div",{style:{height:"100%",width:`${m[y].completed/m[y].total*100}%`,backgroundColor:"var(--color-accent)",transition:"width 0.2s ease-out"}})}),a.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginTop:"4px",textAlign:"center"},children:[m[y].completed," / ",m[y].total," files"]})]}),Object.values(p).some(F=>F==="downloaded"||F==="partial")&&a.jsx("button",{className:"btn-secondary",onClick:T,style:{marginTop:"16px",width:"100%",fontSize:"13px"},children:"Clear All Downloaded Packs"})]}):a.jsx("div",{style:{color:"var(--color-error)",fontSize:"13px"},children:"Offline mode is not supported in this browser."})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex-row justify-between items-center",style:{marginBottom:"8px"},children:[a.jsx("div",{children:a.jsx("h3",{style:{marginBottom:"0"},children:"Analytics"})}),a.jsx("button",{className:l?"btn-primary":"btn-secondary",onClick:()=>B(!l),style:{width:"60px"},children:l?"ON":"OFF"})]}),a.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"I know I'm a stranger, but please accept my cookies! Analytics help me understand how many players I have, which birds everyone loves, and what features are most useful. I promise I'm just adding bird nerds to my LIFE LIST, not stalking you. Your IP is anonymized, no personal data collected, full GDPR/CCPA compliance."})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"8px"},children:"Privacy Policy"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["Learn about how your privacy is protected, what data is collected, and your rights."," ",a.jsx("button",{onClick:()=>t("/privacy"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Privacy Policy "})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"8px"},children:"How to Play"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["New to ChipNotes? Learn about gameplay, scoring, packs, and tips."," ",a.jsx("button",{onClick:()=>t("/help"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Help Guide "})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"8px"},children:"Feedback & Bug Reports"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["Found a bug? Have a feature idea? Email me at"," ",a.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]}),a.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:[a.jsx("span",{style:{color:"var(--color-text)"},children:"Have a bird sound on your phone that you think should be in the game?"})," Send it to me! I'll add it and give you credit in the app."]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"8px"},children:"Support This Project"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["ChipNotes is free,"," ",a.jsx("a",{href:"https://github.com/chrysogonum/bird-sound-game",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},onClick:()=>Za("https://github.com/chrysogonum/bird-sound-game","github_repo","settings_page"),children:"open source"}),", and built as a passion project. If it's helped you level-up your birding skills, consider"," ",a.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},onClick:()=>Za("https://ko-fi.com/chipnotes","donation","settings_page"),children:"supporting development"})," ","- your donations help me add new species, add features, and do more birding. Now, you go build something cool - it might be easier than you think! ;)"]}),a.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:"Please also consider supporting the organizations that make this possible, and tell them ChipNotes! sent you:"}),a.jsxs("ul",{style:{fontSize:"13px",lineHeight:"1.5",color:"var(--color-text-muted)",marginBottom:"12px"},children:[a.jsxs("li",{style:{marginBottom:"8px"},children:[a.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.birds.cornell.edu/home/support/"})," ","- Incredible bird sound archive"]}),a.jsxs("li",{children:[a.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://xeno-canto.org/about/donate"})," ","- Community-driven bird recording database"]}),a.jsxs("li",{style:{marginTop:"8px"},children:[a.jsx("a",{href:"https://www.doc.govt.nz/get-involved/donate/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.doc.govt.nz/get-involved/donate/"})," ","- New Zealand bird conservation and sound archive"]})]}),a.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"Thank you for learning with me! "})]}),a.jsx("div",{className:"card",children:a.jsx("button",{className:"btn-secondary",onClick:M,style:{width:"100%",color:"var(--color-error)"},children:"Reset All Progress"})})]})]})}function d6(){return a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}function u6(){return a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}const Xc=[{code:"NOCA",name:"Northern Cardinal",accuracy:92,attempts:45},{code:"BLJA",name:"Blue Jay",accuracy:88,attempts:38},{code:"CARW",name:"Carolina Wren",accuracy:76,attempts:29},{code:"AMCR",name:"American Crow",accuracy:95,attempts:22},{code:"TUTI",name:"Tufted Titmouse",accuracy:71,attempts:18}];function h6(){const t=cr(),e=Math.round(Xc.reduce((r,n)=>r+n.accuracy,0)/Xc.length);return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[a.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:a.jsx(p6,{})}),a.jsx("h2",{style:{margin:0},children:"Progress"})]}),a.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"linear-gradient(135deg, rgba(245, 166, 35, 0.15) 0%, rgba(245, 166, 35, 0.05) 100%)",border:"2px solid var(--color-accent)",borderRadius:"12px",textAlign:"center"},children:[a.jsx("div",{style:{fontSize:"16px",fontWeight:700,color:"var(--color-accent)",marginBottom:"4px"},children:" Coming Soon! "}),a.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.4},children:"Real stats tracking is in development. The data below is a preview of what's coming!"})]}),a.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[a.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Demo Data"}),a.jsxs("div",{className:"flex-row justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Overall Accuracy"}),a.jsxs("div",{style:{fontSize:"32px",fontWeight:700},className:"text-success",children:[e,"%"]})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Total Attempts"}),a.jsx("div",{style:{fontSize:"24px",fontWeight:600},children:Xc.reduce((r,n)=>r+n.attempts,0)})]})]})]}),a.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[a.jsx("h3",{style:{margin:0},children:"This Session"}),a.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),a.jsxs("div",{className:"flex-row justify-between",style:{marginTop:"12px"},children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Rounds"}),a.jsx("div",{style:{fontSize:"20px"},children:"5"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Score"}),a.jsx("div",{style:{fontSize:"20px"},className:"text-accent",children:"12,450"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Best Streak"}),a.jsx("div",{style:{fontSize:"20px"},children:"18"})]})]})]}),a.jsxs("div",{className:"card",style:{opacity:.7},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[a.jsx("h3",{style:{margin:0},children:"Species Accuracy"}),a.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),Xc.map(r=>a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[a.jsxs("span",{style:{fontSize:"14px"},children:[r.code," ",a.jsxs("span",{className:"text-muted",children:["(",r.attempts,")"]})]}),a.jsxs("span",{style:{fontSize:"14px"},className:r.accuracy>=80?"text-success":r.accuracy>=60?"text-accent":"text-error",children:[r.accuracy,"%"]})]}),a.jsx("div",{style:{height:"6px",backgroundColor:"var(--color-background)",borderRadius:"3px",overflow:"hidden"},children:a.jsx("div",{style:{width:`${r.accuracy}%`,height:"100%",backgroundColor:r.accuracy>=80?"var(--color-success)":r.accuracy>=60?"var(--color-accent)":"var(--color-error)",borderRadius:"3px"}})})]},r.code))]}),a.jsx("div",{className:"card",style:{marginTop:"24px",opacity:.7},children:a.jsx("button",{className:"btn-secondary",style:{width:"100%",cursor:"not-allowed"},disabled:!0,children:"View Confusion Matrix (Coming Soon)"})})]})}function p6(){return a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function f6(){var _;const t=cr(),e=Oi(),r=["Why Learn Bird Song?","ChipNotes Basics"];e.hash==="#training-mode"&&r.push("Training Mode"),(_=e.state)!=null&&_.openVersionHistory&&r.push("Full Version History");const[n,i]=w.useState(new Set(r)),[s,o]=w.useState(!1),l=w.useRef(null),c=w.useRef(null),d=w.useRef(!1),u=["Why Learn Bird Song?","ChipNotes Basics","The Spectrograms","Training Mode","Scoring","The Bird Packs","The Bird Gallery","The Sound Library","The Levels","Offline Play","Taxonomic Sorting","The 4-Letter Codes","About & Credits","Support This Project","Feedback & Bug Reports","Full Version History"],h=y=>{const x=new Set(n);x.has(y)?x.delete(y):x.add(y),i(x)},p=()=>{n.size===u.length?i(new Set):i(new Set(u))},f=n.size===u.length;w.useEffect(()=>{const y=()=>{var g;if(!s){const b=l.current&&l.current.scrollTop>0,S=((g=l.current)==null?void 0:g.parentElement)&&l.current.parentElement.scrollTop>0;(b||S)&&o(!0)}},x=l.current,v=x==null?void 0:x.parentElement;return x&&x.addEventListener("scroll",y),v&&v.addEventListener("scroll",y),()=>{x==null||x.removeEventListener("scroll",y),v==null||v.removeEventListener("scroll",y)}},[s]),w.useEffect(()=>{var y;(y=e.state)!=null&&y.openVersionHistory&&c.current&&setTimeout(()=>{var x;(x=c.current)==null||x.scrollIntoView({behavior:"smooth",block:"start"})},100)},[e.state]),w.useEffect(()=>{e.hash==="#training-mode"&&!d.current&&(d.current=!0,setTimeout(()=>{const y=document.getElementById("training-mode");y&&y.scrollIntoView({behavior:"smooth",block:"start"})},100))},[e.hash]);const m=()=>{var y;l.current&&l.current.scrollTo({top:0,behavior:"smooth"}),(y=l.current)!=null&&y.parentElement&&l.current.parentElement.scrollTo({top:0,behavior:"smooth"})};return a.jsxs("div",{ref:l,className:"screen",style:{paddingBottom:"32px",position:"relative"},children:[a.jsxs("button",{onClick:m,style:{position:"fixed",top:"calc(24px + var(--safe-area-top, 0px))",right:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(76, 175, 80, 0.15)",color:"var(--color-success)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",zIndex:1e3},onMouseEnter:y=>{y.currentTarget.style.transform="scale(1.05)",y.currentTarget.style.background="rgba(76, 175, 80, 0.25)",y.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:y=>{y.currentTarget.style.transform="scale(1)",y.currentTarget.style.background="rgba(76, 175, 80, 0.15)",y.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},"aria-label":"Scroll to top",children:[a.jsx("span",{style:{fontSize:"12px"},children:""}),"Top"]}),a.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[a.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:a.jsx(m6,{})}),a.jsx("h2",{style:{margin:0,flex:1},children:"How to Play"})]}),a.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[a.jsxs(Gt,{title:"Why Learn Bird Song?",isExpanded:n.has("Why Learn Bird Song?"),onToggle:()=>h("Why Learn Bird Song?"),children:[a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{children:"Birds"})," are heard more often than they're seen. But, even their sounds can be easy to miss. If you learn their songs, you'll know what to look for - and suddenly your backyard becomes way more interesting."]}),a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{children:"ChipNotes"}),` plays sounds separately in your left and right ears. It may seem like a hearing test, but that's birding! You're constantly triangulating: "Cardinal to my left, chickadee to my right, warbler... somewhere up there?" Training your ears to separate simultaneous sounds - like a pianist controlling both hands independently - dramatically sharpens your field skills.`]}),a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{children:"Neuroplasticity works:"})," Your brain rewires with practice. These sound patterns feel impossible at first, but repeated exposure trains your auditory cortex faster than you'd think. Give it a few sessions - you'll be amazed what you can hear."]}),a.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsx("strong",{children:"Need real-time ID?"})," Get Cornell's free ",a.jsx("a",{href:"https://merlin.allaboutbirds.org/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"Merlin app"}),` - it's magic for "what bird is that singing `,a.jsx("em",{children:"right now"}),'?"']})]}),a.jsxs(Gt,{title:"ChipNotes Basics",isExpanded:n.has("ChipNotes Basics"),onToggle:()=>h("ChipNotes Basics"),children:[a.jsx("p",{style:{marginBottom:"12px"},children:a.jsx("strong",{children:"Listen. Identify. Tap."})}),a.jsx("p",{style:{marginBottom:"12px"},children:"Bird sounds play through your left or right ear. Identify which bird is singing and tap its circle on the correct side before the tile passes the scoring zone."}),a.jsx("p",{style:{marginBottom:"12px"},children:"Each round is 30 seconds. Use headphones for the best experience - unless you want everyone to know you're a bird nerd!"}),a.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsx("strong",{children:"Mobile tip:"}),' For fullscreen play on iOS, use Safari. On Android Chrome, tap   "Add to Home screen" and launch from the icon.']}),a.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsx("strong",{children:"Offline tip:"})," Playing on a flight?"," ",a.jsx("button",{onClick:()=>{i(y=>new Set([...y,"Offline Play"])),setTimeout(()=>{var y;(y=document.getElementById("offline-play"))==null||y.scrollIntoView({behavior:"smooth",block:"start"})},100)},style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"14px",textDecoration:"underline",cursor:"pointer",padding:0},children:"See Offline Play"})," ","to download packs ahead of time."]})]}),a.jsxs(Gt,{title:"The Spectrograms",isExpanded:n.has("The Spectrograms"),onToggle:()=>h("The Spectrograms"),children:[a.jsx("p",{style:{marginBottom:"12px"},children:"The colorful images on tiles are spectrograms - visual pictures of sound. Time flows left to right, pitch goes bottom to top, and brightness shows volume."}),a.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px",marginBottom:"12px"},children:[a.jsx("div",{style:{fontSize:"13px",fontWeight:600,marginBottom:"8px",color:"var(--color-text-muted)"},children:"Example: Carolina Wren song"}),a.jsx("img",{src:"/data/spectrograms/CARW_941065.png",alt:"Carolina Wren spectrogram - loud, ringing 'teakettle teakettle' song",style:{width:"100%",height:"auto",borderRadius:"8px",border:"2px solid rgba(255, 152, 0, 0.3)"}}),a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginTop:"8px",fontStyle:"italic"},children:`Notice the repeating pattern - this is the Carolina Wren's distinctive "teakettle teakettle" song`})]}),a.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"14px"},children:"With practice, you'll recognize birds by their visual patterns too!"})]}),a.jsxs(Gt,{id:"training-mode",title:"Training Mode",isExpanded:n.has("Training Mode"),onToggle:()=>h("Training Mode"),children:[a.jsx("p",{style:{marginBottom:"12px"},children:"Training Mode shows bird icons and names on each tile alongside the spectrogramperfect for learning which sounds belong to which birds. North American packs show 4-letter codes (like NOCA), while New Zealand packs show Mori names."}),a.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",marginBottom:"12px"},children:[a.jsxs("div",{style:{background:"var(--color-surface)",padding:"10px",borderRadius:"8px",fontSize:"13px",display:"flex",alignItems:"center",gap:"10px",flex:1},children:[a.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",background:"rgba(76, 175, 80, 0.3)",border:"2px solid rgba(76, 175, 80, 0.6)",borderRadius:"50%",color:"#81C784",flexShrink:0},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),a.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Eye icon glows green when ON"})]}),a.jsx("img",{src:"/images/training-mode-example.png",alt:"Training mode tile showing spectrogram with bird icon and species label",style:{width:"120px",height:"auto",borderRadius:"8px",flexShrink:0}})]}),a.jsxs("p",{children:["Enable it on the preview screen before starting a round, or toggle on/off anytime during gameplay using the ",a.jsx("strong",{children:"eye icon"})," (next to the back button). Start with labels visible, then toggle off to challenge yourself!"]})]}),a.jsxs(Gt,{title:"Scoring",isExpanded:n.has("Scoring"),onToggle:()=>h("Scoring"),children:[a.jsx(Yc,{label:"Perfect",points:100,description:"Right bird + right ear + great timing",color:"var(--color-success)"}),a.jsx(Yc,{label:"Good",points:75,description:"Right bird + right ear",color:"var(--color-success)"}),a.jsx(Yc,{label:"Partial",points:25,description:"Right bird, wrong ear",color:"var(--color-accent)"}),a.jsx(Yc,{label:"Miss",points:0,description:"Wrong bird or no response",color:"var(--color-error)"}),a.jsxs("p",{style:{marginTop:"12px",fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:["After each round, check the confusion matrix to see which birds you mixed up. If you confused 4+ birds, use the  ",a.jsx("strong",{children:'"Drill These Birds"'})," button to immediately practice just those species!"]})]}),a.jsxs(Gt,{title:"The Bird Packs",isExpanded:n.has("The Bird Packs"),onToggle:()=>h("The Bird Packs"),children:[a.jsxs("p",{style:{marginBottom:"16px",fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.5},children:[a.jsx("strong",{style:{color:"var(--color-text)"},children:"Start with Backyard Birds"}),"even if you're eager for more! Mastering 6 distinctive species builds the foundation for tackling larger packs."]}),a.jsx("div",{style:{marginBottom:"16px",padding:"12px 16px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",borderLeft:"3px solid var(--color-primary)"},children:a.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text)",lineHeight:1.5,display:"flex",alignItems:"flex-start",gap:"6px"},children:[a.jsx("span",{style:{color:"#F5A623",fontSize:"16px",fontWeight:"bold",flexShrink:0},children:"+"}),a.jsxs("div",{children:[a.jsx("strong",{children:"Build Your Own Pack:"})," You can combine any birds from the packs below into custom training sessions. Perfect for drilling problem birds, comparing confusing species, or creating and saving your yard list!"]})]})}),a.jsx(Xi,{name:"Backyard Birds",description:"Perfect for beginners. 6 distinctive birds you'll hear around your neighborhood: American Crow (AMCR), American Robin (AMRO), Blue Jay (BLJA), Carolina Wren (CARW), Northern Cardinal (NOCA), and Tufted Titmouse (TUTI)."}),a.jsx(Xi,{name:"Grassland & Open Country",description:"10 species of grasslands, prairies, farmland, and field edges: Barn Swallow, Common Yellowthroat, Dickcissel, Eastern Kingbird, Eastern Meadowlark, Field Sparrow, Indigo Bunting, Red-winged Blackbird, Savannah Sparrow, and Yellow Warbler."}),a.jsx(Xi,{name:"Eastern Birds",description:"60 species from the eastern US. 9 birds are selected randomly, and you can shuffle for a new set anytime from the preview screen."}),a.jsx(Xi,{name:"Western Birds",description:"26 common species from western North America: Steller's Jay, California Scrub-Jay, Oak Titmouse, Black-capped Chickadee, White-crowned Sparrow, Killdeer, Red-breasted Nuthatch, and more."}),a.jsx(Xi,{name:"Woodpeckers",description:"Drums, rattles, and calls. 9 species: Downy, Hairy, Red-bellied, Pileated, Yellow-bellied Sapsucker, Northern Flicker, Red-headed, Acorn, and Lewis's."}),a.jsx(Xi,{name:"Sparrows",description:"Master the subtle singers! 9 sparrow species with distinctive patterns: White-throated, Song, Chipping, Swamp, Savannah, Field, Lincoln's, White-crowned, and House Sparrow."}),a.jsx(Xi,{name:"Warbler Academy",description:"For experts! 34 wood-warbler species with their high-pitched, buzzy songs. 9 warblers are selected randomlyshuffle for a new set anytime."}),a.jsx("div",{style:{marginTop:"20px",marginBottom:"16px",padding:"12px 16px",background:"rgba(45, 122, 122, 0.15)",borderRadius:"8px",borderLeft:"3px solid #2d7a7a"},children:a.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text)",lineHeight:1.5,display:"flex",alignItems:"flex-start",gap:"6px"},children:[a.jsx("span",{style:{fontSize:"16px",flexShrink:0},children:""}),a.jsxs("div",{children:[a.jsx("strong",{children:"New Zealand Birds:"}),` ChipNotes goes global, starting with New Zealandhome to some of the world's most unusual and iconic birds, species found nowhere else. 42 native species across 4 packs: "All NZ Birds" (complete collection), "Garden & Bush" (9 common species), "North Island" (21 species), and "South Island" (22 species). Birds display their Mori names during gameplay. Regional packs play region-specific recordings for subspecies like Toutouwai (NZ Robin).`]})]})}),a.jsxs("p",{style:{marginTop:"16px",fontSize:"13px",color:"var(--color-text-muted)",fontStyle:"italic"},children:["There are 11,000 birds out there, so more are coming soon. Send your suggestions to"," ",a.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"}),"!"]})]}),a.jsxs(Gt,{title:"The Bird Gallery",isExpanded:n.has("The Bird Gallery"),onToggle:()=>h("The Bird Gallery"),children:[a.jsxs("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:["Before you play, get to know your birds! Look for the"," ",a.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px",fontSize:"16px",verticalAlign:"middle"},children:""})," ","gallery icon on any pack's Level Select screen."]}),a.jsxs("div",{className:"card",style:{marginBottom:"12px",background:"rgba(100, 181, 246, 0.08)",border:"1px solid rgba(100, 181, 246, 0.2)"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#64B5F6"},children:" See the Birds"}),a.jsx("p",{style:{margin:0,fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:"Tap the gallery icon to see all birds in a pack displayed as large, scrollable cards. Each card shows:"}),a.jsxs("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6},children:[a.jsx("li",{children:"A large icon so you can see what the bird looks like"}),a.jsx("li",{children:"All the ways the bird is knowncommon names, Mori names, 4-letter codes, and scientific names"}),a.jsxs("li",{children:["A ",a.jsx("strong",{children:" play button"})," to hear the bird's signature sound"]})]})]}),a.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:"This is a great way to preview unfamiliar species before jumping into gameplay. Tap the play button on each card to hear what you'll be listening for, while seeing the bird's face at the same timeconnecting sight and sound helps the names stick!"})]}),a.jsxs(Gt,{title:"The Sound Library",isExpanded:n.has("The Sound Library"),onToggle:()=>h("The Sound Library"),children:[a.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"The Sound Library  lets you explore every audio clip in the game. Access it from three places:"}),a.jsxs("div",{className:"card",style:{marginBottom:"12px",background:"rgba(255, 152, 0, 0.08)",border:"1px solid rgba(255, 152, 0, 0.2)"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"var(--color-accent)"},children:" Pack Select Page"}),a.jsx("p",{style:{margin:0,fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:"Scroll to the bottom of the Pack Select page to find the complete Sound Library. Expand any species to see all available clips with recordist credits and source links. Great for deep exploration!"})]}),a.jsxs("div",{className:"card",style:{marginBottom:"12px",background:"rgba(100, 181, 246, 0.08)",border:"1px solid rgba(100, 181, 246, 0.2)"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#64B5F6"},children:" Level Select Page"}),a.jsx("p",{style:{margin:0,fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:"Tap the  icon to open a modal with all clips for every bird in that pack. Quick access without leaving the page."})]}),a.jsxs("div",{className:"card",style:{marginBottom:"12px",background:"rgba(76, 175, 80, 0.08)",border:"1px solid rgba(76, 175, 80, 0.2)"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#81C784"},children:" Ready to Play Page"}),a.jsx("p",{style:{margin:0,fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:"Tap the  icon to preview clips for just the 9 birds you're about to play. Perfect for a quick refresher before the round starts!"})]}),a.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5,marginTop:"12px"},children:"Each clip shows its vocalization type (song, call, drum, etc.) and whether it's the signature clip () used in Level 1."}),a.jsxs("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5,marginTop:"12px"},children:["Want to know where the bird sounds come from? (And no, we're not talking about the syrinx...) See"," ",a.jsx("button",{onClick:()=>{i(y=>new Set([...y,"About & Credits"])),setTimeout(()=>{var y;(y=document.getElementById("about-credits"))==null||y.scrollIntoView({behavior:"smooth",block:"start"})},100)},style:{background:"none",border:"none",color:"var(--color-accent)",textDecoration:"underline",cursor:"pointer",padding:0,font:"inherit"},children:"About & Credits"}),"."]})]}),a.jsxs(Gt,{title:"The Levels",isExpanded:n.has("The Levels"),onToggle:()=>h("The Levels"),children:[a.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Each pack has 6 levels that build your skills. Your selected birds stay the same between roundshit the shuffle button on the Ready to Play screen for a fresh set."}),a.jsx(Hs,{level:1,title:"Meet the Birds",description:"One clear recording per bird, single ear. Learn each signature voice."}),a.jsx(Hs,{level:2,title:"Sound Variations",description:"Up to 3 recordings per bird. Same species, different songs."}),a.jsx(Hs,{level:3,title:"Full Repertoire",description:"All recordings in play. Master every variation."}),a.jsx(Hs,{level:4,title:"Both Ears",description:"Sounds from either side. Identify the bird AND the direction."}),a.jsx(Hs,{level:5,title:"Variations + Both Ears",description:"Multiple recordings, either ear. Getting challenging!"}),a.jsx(Hs,{level:6,title:"Master Birder",description:"Everything at once. You're a pro now."})]}),a.jsx("div",{id:"offline-play",children:a.jsxs(Gt,{title:"Offline Play",isExpanded:n.has("Offline Play"),onToggle:()=>h("Offline Play"),children:[a.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"ChipNotes works great on flights and in areas with no signal  you just need to prepare ahead of time."}),a.jsx("h4",{style:{margin:"16px 0 8px 0",fontSize:"15px"},children:"How It Works"}),a.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"When you play normally, audio clips and spectrograms are downloaded from the server as needed. The app automatically saves them to your device's cache, so clips you've already heard load instantly next time."}),a.jsx("h4",{style:{margin:"16px 0 8px 0",fontSize:"15px"},children:"Preparing for Offline"}),a.jsxs("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:["Go to ",a.jsx("strong",{children:"Settings  Offline Mode"})," and download the packs you want. This pre-fetches all audio and spectrograms so the entire pack works without internet. Pack sizes range from ~15 MB to ~180 MB depending on species count."]}),a.jsx("h4",{style:{margin:"16px 0 8px 0",fontSize:"15px"},children:"Good to Know"}),a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsx("li",{style:{marginBottom:"6px"},children:"Downloads can be paused and resumed if interrupted"}),a.jsx("li",{style:{marginBottom:"6px"},children:'Your browser may clear cached data if storage runs low  the app will show "partial" status if this happens'}),a.jsx("li",{style:{marginBottom:"6px"},children:"Clips you've played before are already cached, even without using the download feature"}),a.jsx("li",{children:"Offline mode requires a modern browser (Chrome, Safari, Firefox, Edge)"})]})]})}),a.jsxs(Gt,{title:"Taxonomic Sorting",isExpanded:n.has("Taxonomic Sorting"),onToggle:()=>h("Taxonomic Sorting"),children:[a.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginBottom:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(100, 181, 246, 0.3)",border:"2px solid rgba(100, 181, 246, 0.6)",borderRadius:"50%",color:"#64B5F6"},children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})}),a.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Toggle glows blue when Taxonomic Sorting is ON"})]}),a.jsx("p",{children:"Taxonomic sorting can be toggled on and off throughout the game - on the preview screen, in Sound Library sections, in the Custom Pack Builder, and during gameplay. When enabled, birds appear in phylogenetic order with scientific names instead of alphabetically. "}),a.jsxs("p",{style:{marginTop:"12px"},children:["Birds are sorted by their position on the evolutionary tree (using the 2025 eBird/AOS taxonomy), and common names are replaced with ",a.jsx("em",{children:"scientific names in italics"}),". Perfect for learning evolutionary relationships!"]}),a.jsx("p",{style:{marginTop:"12px"},children:"Most beginners stick with alphabetical sorting during gameplay - it's faster to find birds by their 4-letter codes. But as you advance, you might prefer taxonomic sorting everywhere, building muscle memory based on evolutionary relationships. Either way works - you're training your brain to recognize patterns!"})]}),a.jsxs(Gt,{title:"The 4-Letter Codes",isExpanded:n.has("The 4-Letter Codes"),onToggle:()=>h("The 4-Letter Codes"),children:[a.jsx("p",{children:`Birders use standardized 4-letter codes (called "Alpha codes") as shorthand for species names. They're easy to learn:`}),a.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"8px",fontSize:"14px",lineHeight:1.6},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Two-word names:"})," First 2 letters of each word"]}),a.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Northern Cardinal  NO + CA  NOCA"}),a.jsxs("div",{style:{marginTop:"8px"},children:[a.jsx("strong",{children:"Three-word names:"})," 1 + 1 + 2 letters"]}),a.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Red-bellied Woodpecker  R + B + WO  RBWO"}),a.jsxs("div",{style:{marginTop:"12px",fontStyle:"italic",color:"var(--color-text-muted)"},children:["There ",a.jsx("a",{href:"https://www.birdpop.org/pages/birdSpeciesCodes.php",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"are exceptions"}),". Because, ornithology. And when species collide (generating identical codes), things get ",a.jsx("a",{href:"https://www.carolinabirdclub.org/bandcodes.html",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"even messier"}),"."]})]})]}),a.jsxs(Gt,{id:"about-credits",title:"About & Credits",isExpanded:n.has("About & Credits"),onToggle:()=>h("About & Credits"),children:[a.jsxs("div",{style:{textAlign:"center",marginBottom:"16px"},children:[a.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"   "}),a.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:"Created by Peter Repetti"}),a.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:"Made with love by bird nerds, for bird nerds"})]}),a.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:[a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--color-accent)"},children:"Bird sounds:"})," North American species sourced from"," ",a.jsx("a",{href:"https://xeno-canto.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Xeno-Canto"}),", the"," ",a.jsx("a",{href:"https://www.macaulaylibrary.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Cornell Macaulay Library"}),", and from user contributions. New Zealand species sourced from the"," ",a.jsx("a",{href:"https://www.doc.govt.nz/nature/native-animals/birds/bird-songs-and-calls/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"New Zealand Department of Conservation (DOC)"}),". All sound clips have attribution in the Sound Library."]}),a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--color-accent)"},children:"Bird icons:"})," Designed by Peter Repetti with assistance from Claude and ChatGPT (DALL-E 3)."]}),a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--color-accent)"},children:"The Tech:"})," Pair-programmed with Claude Code using TypeScript, React, and PixiJS for buttery-smooth scrolling spectrograms. The Web Audio API handles sample-accurate playback with real-time stereo panning - your browser decodes and buffers audio into memory for zero-latency triggering. Vite bundles it all into a PWA (Progressive Web App) that caches sounds as you play them - so load up those birds before your flight to New Zealand takes off ."]}),a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--color-accent)"},children:"Audio Processing:"})," Every clip in ChipNotes is 0.5-3 seconds, mono, and normalized to -16 LUFS for consistent volume. For North American birds, I run Xeno-canto and Cornell recordings through an algorithm that automatically extracts the loudest 3-second window using sliding RMS energy analysis - the loudest moment is usually when the bird is singing most clearly. For New Zealand birds, DOC recordings are often longer field recordings, so I built a visual Clip Selector tool to display the waveform and manually select the best segments - it's quicker than you'd think. Either way, every clip gets the same final processing: convert to mono, normalize loudness, generate spectrogram."]}),a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--color-accent)"},children:"Special thanks:"})," To the global birding community for sharing these recordings."]}),a.jsx("p",{style:{marginTop:"16px",fontSize:"13px",fontStyle:"italic"},children:"Good birding! "})]})]}),a.jsxs(Gt,{title:"Support This Project",isExpanded:n.has("Support This Project"),onToggle:()=>h("Support This Project"),children:[a.jsxs("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:["ChipNotes is free,"," ",a.jsx("a",{href:"https://github.com/chrysogonum/bird-sound-game",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},onClick:()=>Za("https://github.com/chrysogonum/bird-sound-game","github_repo","help_page"),children:"open source"}),", and built as a passion project. If it's helped you level-up your birding skills, consider"," ",a.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},onClick:()=>Za("https://ko-fi.com/chipnotes","donation","help_page"),children:"supporting development"})," ","- your donations help me add new species, add features, and do more birding. Now, you go build something cool - it might be easier than you think! ;)"]}),a.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"8px",fontWeight:600},children:"Please also consider supporting the organizations that make this possible, and tell them ChipNotes! sent you:"}),a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"var(--color-text-muted)",lineHeight:1.8},children:[a.jsxs("li",{children:[a.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.birds.cornell.edu/home/support/"})," ","- Incredible bird sound archive"]}),a.jsxs("li",{children:[a.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://xeno-canto.org/about/donate"})," ","- Community-driven bird recording database"]}),a.jsxs("li",{children:[a.jsx("a",{href:"https://www.doc.govt.nz/get-involved/donate/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.doc.govt.nz/get-involved/donate/"})," ","- New Zealand bird conservation and sound archive"]})]}),a.jsx("p",{style:{marginTop:"16px",fontSize:"14px",fontStyle:"italic",color:"var(--color-text-muted)"},children:"Thank you for learning with me! "})]}),a.jsxs(Gt,{title:"Feedback & Bug Reports",isExpanded:n.has("Feedback & Bug Reports"),onToggle:()=>h("Feedback & Bug Reports"),children:[a.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:"I'd love to hear from you! Found a bug? Have a feature suggestion? Want to share your experience?"}),a.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px",marginBottom:"12px"},children:[a.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" Email"}),a.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"feedback@chipnotes.app"})]}),a.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px"},children:[a.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" GitHub Issues"}),a.jsx("a",{href:"https://github.com/chrysogonum/bird-sound-game/issues",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},onClick:()=>Za("https://github.com/chrysogonum/bird-sound-game/issues","github_issues","help_page"),children:"github.com/chrysogonum/bird-sound-game/issues"})]})]}),a.jsxs("div",{ref:c,children:[a.jsxs("div",{className:"card",style:{marginBottom:"16px",background:"rgba(255, 152, 0, 0.08)",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[a.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"16px",color:"var(--color-accent)",opacity:.6},children:" Recent Updates"}),a.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.8},children:[a.jsxs("div",{children:[" ",a.jsx("strong",{children:"Worldwide Bird Packs!"}),"  ChipNotes goes global! Starting with New Zealand, home to some of the world's most unusual and iconic birds. 42 native NZ species across 4 regional packs."]}),a.jsxs("div",{children:[" ",a.jsx("strong",{children:"120 Species!"}),"  120 North American species with curated audio clips and spectrograms"]}),a.jsxs("div",{children:[" ",a.jsx("strong",{children:"Drill Confused Birds"}),"  After a round, instantly practice just the birds you mixed up"]}),a.jsxs("div",{children:[" ",a.jsx("strong",{children:"Pack Expansions"}),"  New Grassland pack (10 species), plus Western Birds expanded to 26, Eastern to 60, and Woodpeckers to 9"]}),a.jsxs("div",{children:[" ",a.jsx("strong",{children:"Taxonomic Sorting"}),"  Play birds in evolutionary order, see scientific names"]}),a.jsxs("div",{children:[" ",a.jsx("strong",{children:"Custom Pack Builder"}),"  Build and save up to 10 custom packs from any species"]})]})]}),a.jsxs(Gt,{title:"Full Version History",isExpanded:n.has("Full Version History"),onToggle:()=>h("Full Version History"),children:[a.jsx(ne,{version:"4.20",date:"February 5, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Error Tracking:"}),' Added Sentry error monitoring to automatically capture and report crashes in production  no more silent white screens. Includes a friendly error fallback UI with a "Back to Menu" button.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Test Coverage:"})," Added offline manager test suite (21 new tests) and coverage threshold enforcement to catch regressions early."]})]})}),a.jsx(ne,{version:"4.19",date:"February 3, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Offline Mode Fix:"})," Core data files (levels, species, packs) and bird icons now pre-cache on first app load, so the full game works offline  not just the audio and spectrograms."]})})}),a.jsx(ne,{version:"4.18",date:"February 3, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Offline Mode:"})," New Settings section lets you download individual packs for offline play  perfect for flights or areas with no signal. Downloads include all audio clips and spectrograms for selected packs. Resume interrupted downloads, verify cache status, and clear storage when needed."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Offline Play Guide:"})," New Help section explaining how caching works and how to prepare for offline use."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Service Worker Re-enabled:"})," PWA caching restored for better offline support and faster load times on repeat visits."]})]})}),a.jsx(ne,{version:"4.17",date:"February 3, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"NZ Custom Pack Builder Fix:"})," Added North Island and South Island to the pack filter options  previously only showed All NZ Birds and Garden & Bush."]})})}),a.jsx(ne,{version:"4.16",date:"February 2, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Select Tips Refresh:"})," Updated tip bullets with clearer guidance on device and audio setup  headphones recommended, and how to fix missing sound on mobile."]})})}),a.jsx(ne,{version:"4.15",date:"February 1, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Sound Library Notice:"})," Added construction banner to all Sound Library locations  sound type labels (song, call, etc.) are being reviewed and corrected across all clips."]})})}),a.jsx(ne,{version:"4.14",date:"February 1, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder Fix:"})," Fixed scroll jumping to top when selecting birds  the list now stays in place as you tap through species."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Drill Level Fix:"})," Confusion drills now match the difficulty level you were playing at, instead of always defaulting to Level 1."]})]})}),a.jsx(ne,{version:"4.13",date:"January 31, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Eastern Birds Expansion:"})," Eastern Birds pack expanded from 46 to 60 species with 14 new birds: Wood Thrush, Killdeer, Baltimore Oriole, Northern House Wren, European Starling, Yellow-billed Cuckoo, Chimney Swift, Scarlet Tanager, Veery, Summer Tanager, Blue-gray Gnatcatcher, Great Blue Heron, Green Heron, and Red-breasted Nuthatch. 80 new curated audio clips with spectrograms and icons."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Western Birds Expansion:"})," Western Birds pack expanded from 21 to 26 species with Killdeer, European Starling, Northern House Wren, Red-breasted Nuthatch, and Great Blue Heron."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Clip Editor Enhancement:"})," clip_editor.py now auto-populates recordist and vocalization type from the Xeno-Canto API, eliminating manual data entry during clip extraction."]})]})}),a.jsx(ne,{version:"4.12",date:"January 28, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Meet Birders Where They're At:"}),` North American birds can now be displayed with common names instead of 4-letter codestoggle on the Ready to Play screen. Whether you're fluent in banding codes or prefer "Northern Cardinal," ChipNotes adapts to you.`]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Settings Status Line:"})," Current settings (Training, Display, Sort) now shown above the Ready to Play button for quick reference."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Sound Library Modals:"})," The  icon on Ready to Play and Level Select pages now opens a Sound Library modal showing all clips for the selected birdsno more navigating away to explore sounds."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Slower Scroll Option:"})," Scroll speed can now go as low as 0.25x for players who want more time to identify birds."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"UI Polish:"})," Home icons and Custom Pack card now more vibrant; added home button to NZ Pack Select page for easier navigation."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"How To Page Refresh:"})," Reorganized sections for better flowTraining Mode now follows Spectrograms, new Sound Library section explains all access points. Tips integrated into relevant sections. Added visual examples for Training Mode and Taxonomic Sorting."]})]})}),a.jsx(ne,{version:"4.11",date:"January 27, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Gameplay Tile Redesign:"}),' Bird icons are now larger with names displayed below in up to 2 linesno more truncated names like "Yellow..." or "Orange...".']})})}),a.jsx(ne,{version:"4.10",date:"January 27, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Audio Fix:"})," Replaced Eastern Meadowlark clip that had background noise from another species."]})})}),a.jsx(ne,{version:"4.09",date:"January 27, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Better Feedback:"}),` When you miss a bird, the "Was:" text now shows the bird's name instead of its species codemuch more helpful for learning.`]}),a.jsxs("li",{children:[a.jsx("strong",{children:"UI Polish:"})," Sound Library header and sort buttons cleaned up for clarity."]})]})}),a.jsx(ne,{version:"4.08",date:"January 26, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Bug Fix:"})," Fixed issue where All NZ Birds pack would sometimes show only 8 birds instead of 9 when both subspecies of a merged species were randomly selected."]})})}),a.jsx(ne,{version:"4.07",date:"January 26, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"NZ Pack Overhaul:"}),` Reorganized NZ birds into regional packsNorth Island and South Islandreplacing the old Rare & Endemic pack. Garden & Bush consolidated to 9 common species to help visitors get familiar with the birds they're most likely to encounter. Regional subspecies (like North Island Robin and South Island Robin) are now merged for gameplayyou'll see "Toutouwai" as one bird. Regional packs play region-specific clips: North Island pack plays only NI subspecies recordings, South Island pack plays only SI subspecies recordings. All NZ Birds pools clips from all regions.`]}),a.jsxs("li",{children:[a.jsx("strong",{children:"3-Way NZ Sorting:"})," NZ birds now support three sort modes: Te Reo (Mori names), English, and Taxonomic. Toggle appears on Ready to Play and in Sound Library. Your sort preference carries through to gameplayif you sort by English, both the buttons and spectrogram tiles show English names."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Sound Library Consistency:"})," Sort toggles moved to header level for both NA and NZ Sound Librariescleaner UI with one toggle affecting all packs."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Bird Gallery:"})," Tap the play button on any bird card to hear its signature sound. Gallery icon () now wiggles to show it's tappable."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Back Button Fix:"})," Pressing back from gameplay now returns you to Ready to Play with the same birds in the same order."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"More Improved Icons:"})," Continuing icon refresh49 bird icons now updated with improved artwork."]})]})}),a.jsx(ne,{version:"4.06",date:"January 26, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"NZ Bird Naming:"})," Subspecies now use consistent namingMori names for sorting (so Fantail and Chatham Fantail group under Pwakawaka), English names for display (Fantail, Fantail (Ch.))."]})})}),a.jsx(ne,{version:"4.05",date:"January 25, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"More Improved Icons:"})," Continuing icon refresh46 bird icons now updated with improved artwork."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help Page Polish:"})," Level descriptions now show colored difficulty circles (green/orange/red) matching the Level Select screen. Sound Library link shows  icons. Training Mode section leads with the glowing green eye icon."]})]})}),a.jsx(ne,{version:"4.04",date:"January 25, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Bird Gallery:"})," Tap any pack name on the Level Select screen to see all birds in that pack displayed as large, scrollable cards. Each card shows the bird's icon, common name (or Mori name for NZ birds), and scientific name. Great for learning what each bird looks like before you play!"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"More Improved Icons:"})," Refreshed 38 bird icons total with improved artwork."]})]})}),a.jsx(ne,{version:"4.02",date:"January 25, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Play Again Button:"})," Moved Play Again to top of Round Summary screen for quick access. Share Your Score moved to bottommost users want to replay immediately."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Desktop Layout:"})," Added max-width constraint (1024px) for wide desktop monitors. Game now stays centered and playable instead of stretching edge-to-edge."]})]})}),a.jsx(ne,{version:"4.01",date:"January 25, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Audio Processing Documentation:"})," Added technical note to About & Credits explaining how clips are preparedautomatic loudest-window extraction for NA birds, visual Clip Selector tool for NZ field recordings."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Sound Library Navigation:"})," Fixed species selection being lost when navigating to Sound Library and back. Sorting preference (alphabetical/taxonomic) now preserved correctly."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack UX:"})," Sound Library button hidden on Ready to Play screen for custom packs (since birds come from mixed sources)."]})]})}),a.jsx(ne,{version:"4.0",date:"January 25, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:" Worldwide Bird Packs:"})," ChipNotes goes global, starting with New Zealandhome to some of the most unusual and iconic birds on Earth, species found nowhere else."]}),a.jsxs("li",{children:[a.jsx("strong",{children:" New Zealand Birds:"}),' 42 native NZ species across 4 packs: "All NZ Birds" (complete collection), "Garden & Bush" (9 common species), "North Island" (21 species), and "South Island" (22 species). Regional packs play region-specific recordings for merged subspecies.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Te Reo Mori Names:"}),' NZ birds display their Mori names during gameplay (T, Korimako, Ruru, Pwakawaka, etc.) with English names shown in tooltips. Common names throughout the app show Mori first (e.g., "Korimako / Bellbird"). For subspecies sharing a Mori name, a parenthetical qualifier distinguishes theme.g., "Toutouwai (NI)" for North Island Robin vs "Toutouwai (SI)" for South Island Robin.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"NZ Sound Library:"})," Expandable sound library showing all clips for each NZ species with recordist attribution and Xeno-canto source links."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"NZ Custom Pack Builder:"})," Build custom packs from NZ birds with region-aware navigation that remembers your region when going back."]}),a.jsxs("li",{children:[a.jsx("strong",{children:" UI Refresh:"})," Refined color palette throughout the appmuted accent colors for navigation and chrome, teal theme for NZ pages, improved visual hierarchy and readability."]})]})}),a.jsx(ne,{version:"3.57",date:"January 24, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Oak Titmouse:"})," Added Oak Titmouse (OATI) to Western Birds pack - a common California oak woodland species. 9 new audio clips from Xeno-canto. Western Birds pack now has 21 species."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Tufted Titmouse Icon:"})," Updated Tufted Titmouse (TUTI) icon with improved design."]})]})}),a.jsx(ne,{version:"3.56",date:"January 24, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Drill Confused Birds:"}),' After a round, if you confused 4+ different birds, a new "Drill These X Birds" button appears in the Confusion Summary. Click it to immediately start a focused practice session with just those species - the fastest way to improve on your trouble areas.']})})}),a.jsx(ne,{version:"3.55",date:"January 24, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Tablet Support:"})," ChipNotes now scales up on iPad and other tablets. UI elements are 1.4x larger on screens 768px+, making buttons easier to tap and spectrograms easier to see."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Gameplay Bird Grid:"})," Bird selection icons now display in consistent 3-column layout on tablets (previously wrapped to 6+3), with larger icons (52px vs 36px) and improved spacing for easier tapping during gameplay."]})]})}),a.jsx(ne,{version:"3.54",date:"January 23, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"New Pack: Grassland & Open Country:"})," Added new 10-species pack featuring birds of grasslands, prairies, farmland, and field edges. Includes Indigo Bunting, Eastern Kingbird, Barn Swallow, Eastern Meadowlark, Dickcissel, Red-winged Blackbird, Savannah Sparrow, Field Sparrow, Common Yellowthroat, and Yellow Warbler - 30 new audio clips and spectrograms."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Curation Improvements:"})," Added Red-winged Blackbird to Grassland pack (iconic grassland/wetland species). Added Common Grackle and Dark-eyed Junco to Western Birds pack (common transcontinental species). Western Birds pack expanded from 18 to 20 species."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Species Icon Additions:"})," Added bird icons for all 5 new grassland species (BARS, DICK, EAKI, EAME, INBU) - now available in Bird Reference and Custom Pack Builder."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Yellow Warbler Addition:"})," Added Yellow Warbler (YEWA) to Warbler Academy pack alongside the new grassland pack - versatile species found in both habitats."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Common Yellowthroat Canonical Update:"})," Changed signature clip from XC1013902 to XC1021804 for improved audio quality."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help Page Enhancements:"}),` Added link to Carolina Bird Club's 4-letter code article in "The 4-Letter Codes" section explaining code collisions and exceptions. Updated Custom Pack Builder callout to emphasize "creating and saving your yard list" use case. Made Backyard Birds description more inclusive ("around your neighborhood" vs "in your own backyard").`]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Repository Cleanup:"})," Removed temporary candidate folders from data directory (~13.6 MB) after clips were merged into game - cleaner project structure."]})]})}),a.jsx(ne,{version:"3.53",date:"January 22, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Select Page Redesign:"}),' Moved Custom Pack Builder to top of page (above pack grid), made it collapsible with "See examples" link for cleaner layout while maintaining discoverability.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Sound Library Branding:"})," Unified Sound Library icon to  (headphones + books) across all screens - appears in Pack Select header, Level Select, and Ready to Play screens for consistent visual identity."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Level Select Cleanup:"})," Simplified header by moving Sound Library link to icon-only button positioned near Home icon, removed redundant text for cleaner interface."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Select Flow:"})," Removed redundant scroll hint below packs (already mentioned in intro bullets), streamlined page flow from intro  Custom Pack  packs  Sound Library."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Select Intro:"}),' Refined "young Grasshopper" joke bullet point with SAVS sparrow icon for better visibility and clearer birding reference (Grasshopper Sparrow species).']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder Pack Filters:"}),` Added pack-based filtering chips (All Birds, Backyard, Eastern, Sparrows, Warblers, Woodpeckers, Western) above search bar. Click any pack to filter species grid to only birds in that pack. Combines with text search for powerful filtering like "all warblers with 'yellow' in name". Fully dynamic - auto-updates when pack definitions change.`]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder Card Density:"})," Reduced bird card sizes ~30% (140px  110px width) and optimized spacing throughout for better mobile efficiency. Shows more birds without scrolling. Reduced font size from 12px  11px, improved text contrast with pure white species names and bold 4-letter codes for better readability."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Version Navigation:"})," Clicking version number on main menu now navigates to Recent Updates section instead of auto-expanding Full Version History - better UX for discovering latest features."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Recent Updates Header:"}),' Simplified to just " Recent Updates" without version range for cleaner presentation.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Analytics Tracking:"})," Added Google Analytics tracking for Ko-fi donation link clicks, GitHub repository link clicks, and GitHub Issues link clicks to understand external link engagement and donation funnel."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Open Source Transparency:"}),' Added clickable GitHub repository links to "open source" mentions in Help and Settings pages for easy access to source code.']})]})}),a.jsx(ne,{version:"3.52",date:"January 22, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder Promotion:"}),' Added prominent callout box in Help page "The Bird Packs" section highlighting the ability to combine birds from any pack into custom training sessions.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Section Rename:"}),' Renamed "The Packs" section to "The Bird Packs" for clarity.']})]})}),a.jsx(ne,{version:"3.51",date:"January 22, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Help Page Reorganization:"}),' Moved "The Spectrograms" section to appear just before "Scoring" section for better logical flow - spectrograms are introduced early as a core learning concept.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Spectrograms Section Enhancement:"}),' Added visual example showing Carolina Wren canonical spectrogram with caption explaining the distinctive "teakettle teakettle" repeating pattern - makes the concept concrete for new users.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help Page UX:"}),' Changed default expanded sections - "Scoring" now starts collapsed to reduce initial information overload, keeping focus on "Why Learn Bird Song?" and "ChipNotes Basics".']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Main Menu Discoverability:"}),' Bottom navigation icons now include text labels ("How To", "Settings", "Stats") and are slightly larger for improved discoverability and clarity.']})]})}),a.jsx(ne,{version:"3.50",date:"January 22, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:'Custom Pack: "Save Before Play" Prompt:'}),' When clicking "Start" with an unsaved custom pack, users are now prompted to save before playing. Options include "Save & Play" (opens save dialog then plays), "Just Play" (plays immediately without saving), or "Cancel". Temporary packs are automatically cleared when returning to the builder, providing a clean slate.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack: Rename & Update Improvements:"}),' Redesigned save dialog for editing existing packs. Users can now rename packs by updating the name in the save dialog - the "Update [Pack Name]" button updates the existing pack with the new name and species. Added "Save As New Pack" option to create variants while preserving the original pack.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Navigation Consistency:"})," All back arrows throughout the game are now orange for visual consistency. Gameplay back button now returns to level select (not home page) for better flow. Home icons always return to main menu."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"High Contrast Setting Removed:"})," Removed ineffective high contrast setting from Settings page - the effect was too subtle to be useful for accessibility."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Icon Credits Added:"})," Added attribution for bird icon design in About & Credits section - icons designed by Peter Repetti with assistance from Claude and ChatGPT (DALL-E 3)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"YBSA Canonical Update:"})," Changed Yellow-bellied Sapsucker canonical clip from XC1011116 to XC663258 for improved audio quality."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Select Text Polish:"}),' Changed "6 levels/pack" to "6 levels per pack" for improved readability in Quick Tips section.']})]})}),a.jsx(ne,{version:"3.49",date:"January 21, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:'Custom Pack "Play Again" Fix:'}),' Fixed Custom Pack behavior to match regular packs - clicking "Play Again" after completing a round now keeps the same 9 birds instead of shuffling to a new random selection. Previously, custom packs with more than 9 birds would re-shuffle on every "Play Again", breaking the practice loop.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Navigation Consistency:"})," Unified navigation across all screens with orange home icons - Pack Select, Settings, Help, Progress, and Level Select pages now all feature consistent small orange home icons in upper corners for quick navigation back to menu or pack selection."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help Page Restructure:"}),' "Recent Updates" card now always visible at top of Help page, with "Full Version History" collapsible below. Improved discoverability of latest features without requiring users to expand sections.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Text Improvements:"}),' Pack descriptions updated for grammatical consistency (numeric formatting, removed redundant words). Section renamed from "The Basics" to "ChipNotes Basics" throughout Help page.']})]})}),a.jsx(ne,{version:"3.48",date:"January 21, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Western Birds Pack Expansion:"})," Western Birds pack expanded from 14 to 18 species with Wrentit, Spotted Towhee, Western Bluebird, and Acorn Woodpecker (14 new audio clips and spectrograms). Pack now includes distinctive western species across jays, finches, towhees, bluebirds, and woodpeckers."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Display Fix:"})," Fixed Western Birds levels to display 9 species on wheel (randomly selected from full pool of 18), matching behavior of other large packs like Eastern Birds. Previously showed all 17 species causing UI overflow."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Schema Updates:"})," Increased level schema maximum species_count from 12 to 20 to accommodate growing pack sizes while maintaining 9-species wheel limit for optimal gameplay."]})]})}),a.jsx(ne,{version:"3.47",date:"January 21, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Two New Woodpeckers Added:"})," Woodpeckers pack expanded from 7 to 9 species with Acorn Woodpecker and Lewis's Woodpecker. Both western species with distinctive vocalizations."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Select UX Improvements:"})," Added fifth tip bullet pointing users to custom pack builder feature below with pointing emoji. Updated timer anxiety tip for clarity. Pack descriptions updated to reflect new species counts."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Merge Candidates Script Fix:"})," Fixed ",a.jsx("code",{children:"merge_candidates.py"})," to generate proper hash-based clip_ids (matching existing pattern) instead of flawed XC-based IDs. Future bird additions will now have correct unique identifiers from the start."]})]})}),a.jsx(ne,{version:"3.46",date:"January 21, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"House Sparrow Added:"})," Sparrows pack now includes 9 species with House Sparrow (3 new audio clips and spectrograms). Common urban sparrow found across North America."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Audio Clip Curation:"})," Trimmed Swamp Sparrow canonical song clip to remove interfering bird at end. Updated canonical clip selection for improved audio quality."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Critical Safety Improvements:"})," Deleted dangerous ",a.jsx("code",{children:"audio_tagger.py"})," script that destroyed curated metadata. All workflows now use safe ",a.jsx("code",{children:"merge_candidates.py"})," for adding clips. Updated ",a.jsx("code",{children:"/add-bird"})," workflow with auto-updating species_count and stronger warnings about following documented steps."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Workflow Documentation:"})," Added prominent warnings to ",a.jsx("code",{children:"/add-bird"})," command documenting common failure modes (missing species_count updates, UI pack count mismatches, browser cache issues)."]})]})}),a.jsx(ne,{version:"3.45",date:"January 21, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Red-eyed Vireo Added:"})," Eastern Birds pack now includes 46 species with Red-eyed Vireo (5 new audio clips and spectrograms). One of the most common forest songbirds in eastern North America."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Add-Bird Workflow Improvements:"})," New automated pack count validation tool prevents UI species count mismatches. Script detects and auto-fixes hardcoded counts in PackSelect and Help screens with ",a.jsx("code",{children:"--fix"})," flag, integrated into add-bird workflow as Step 6c."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Attribution Bug Fix:"})," Fixed merge_candidates.py to generate clickable Xeno-canto source URLs for all new bird additions. Recordist names now appear as proper links in Bird Reference."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Data Consistency:"})," Synced species arrays in expanded_backyard pack definition for clearer data structure (species and display_species now both contain all 46 birds)."]})]})}),a.jsx(ne,{version:"3.44",date:"January 21, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Documentation Updates:"})," Updated Eastern Birds pack count from 40 to 45 in Help page, and clarified Training Mode can be enabled before or during gameplay."]})})}),a.jsx(ne,{version:"3.43",date:"January 21, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Bird Reference Attribution Overhaul:"}),' Improved clip source attribution system with clear categorization (Xeno-canto, Cornell Macaulay, User-contributed). Compact display format shows "XC667361  Nick Komar" with clickable links to original Xeno-canto recordings. Recovered 363 lost recordist attributions and corrected 78 vocalization type errors from earlier data migration.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Source Transparency:"})," Every clip now clearly shows its origin - Xeno-canto (with catalog number link), Cornell CD track number, or user-contributed recordings. Enables proper attribution to recordists and easy access to original recordings for deeper learning."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Metadata Protection:"})," Enhanced git pre-commit hooks now protect recordist attributions and vocalization type classifications (song/call/drum) in addition to canonical flags, preventing future accidental data loss during bulk operations."]})]})}),a.jsx(ne,{version:"3.42",date:"January 21, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"5 New Eastern Birds:"})," Eastern Birds pack from 40 to 45 species with White-eyed Vireo, Acadian Flycatcher, Eastern Phoebe, Great Crested Flycatcher, and Eastern Wood-Pewee (24 new audio clips and spectrograms)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Data Integrity Safeguards:"})," Added comprehensive protection for canonical clip flags (Bird Reference signature indicators) including git pre-commit hooks, extensive documentation, and automated validation to prevent accidental data loss."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Audio Quality Improvements:"})," Trimmed dead space from multiple clips for cleaner, more focused bird vocalizations."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Count Corrections:"})," Updated Eastern Birds pack display to correctly show 45 species across all UI locations."]})]})}),a.jsx(ne,{version:"3.41",date:"January 20, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Dark-eyed Junco added:"})," Eastern Birds pack now includes 40 species (previously 39) with Dark-eyed Junco clips and spectrograms."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Level rotation fix:"})," Fixed bug where newly added species appeared in pack definitions but not in gameplay rotation - Dark-eyed Junco now appears in all 6 levels."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Species count corrections:"})," Updated pack selection and help text to reflect accurate species counts."]})]})}),a.jsx(ne,{version:"3.40",date:"January 20, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Editing:"}),' Load, edit, and update existing saved packs! When you load a pack and modify it, you can choose to update the original pack or save as a new one. Visual indicator shows "Editing: [Pack Name]" at the top of the builder.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Expansion:"}),' Increased max pack size from 9 to 30 birds! For packs with 10+ birds, the game randomly selects 9 for each round with a re-roll button to shuffle the selection. Perfect for creating comprehensive regional packs like "All Midwest Warblers" or "Backyard Regulars."']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack UX:"}),' Made entire bird card clickable (not just the icon) for easier selection, added 4-letter species codes below bird names in taxonomic sort mode, and improved button labels to show "Update / Save As New" when editing.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Spectrogram Fix:"})," Fixed missing spectrograms for species updated in 2025 AOS taxonomy (American Goldfinch, Cedar Waxwing, California Scrub-Jay, Savannah Sparrow) - all 415 clips now have working visual tiles."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Preview Screen UX:"})," Made Training Mode and Taxonomic Sort toggle boxes more visible with subtle background and borders in inactive state."]})]})}),a.jsx(ne,{version:"3.39",date:"January 20, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder: Separated Controls:"})," Redesigned bird cards with distinct touch areas - play button () on left for audio preview, bird icon on right for add/remove. No more overlapping actions!"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder: Saved Packs:"}),' Save up to 10 named custom packs (e.g., "My Backyard", "Lake Erie Migrants") with persistent localStorage storage. Saved packs appear in a collapsible section with load/delete buttons for easy management across sessions.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder: Pack Validation & Versioning:"})," Saved packs now auto-validate species codes on load - if birds are removed from the game due to taxonomy updates, you'll see a friendly warning and the pack auto-cleans invalid entries. Includes version field for future migrations and backward compatibility with legacy packs."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder: Mobile Touch Fix:"})," Fixed delete button not working on mobile devices - replaced native browser confirm() dialog (which was being blocked on touch) with custom modal dialog that works reliably across all devices and screen sizes."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder: Taxonomic Sorting:"})," Added taxonomic sort toggle ( Taxonomic ) to group birds by evolutionary relationships - perfect for adding related species like all woodpeckers, corvids, or comparing warbler genera. Displays scientific names in italic when active."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder: Smart Search:"}),' Search behavior now adapts - single match (e.g., "cardinal") auto-clears for next search; multiple matches (e.g., "warbler") keeps filter active so you can select multiple birds from the same group']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help Page Navigation:"}),' Repositioned floating buttons for better UX - small " Back" button on bottom left, "Expand/Collapse All" and " Top" grouped on bottom right. All buttons now consistently styled and only appear after scrolling.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Suggestions:"}),' Added note in Packs section: "There are 11,000 birds out there, so more are coming soon" with feedback email link']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Branding Consistency:"}),' Standardized "ChipNotes!" (with !) for logos/titles/first mentions, "ChipNotes" (no !) for prose and mid-sentence references']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Support Section Harmonized:"}),' Updated Help and Settings "Support This Project" sections with consistent messaging emphasizing open source nature and attribution to Cornell/Xeno-Canto']}),a.jsxs("li",{children:[a.jsx("strong",{children:"PWA Safe Area Fix:"})," Fixed content bleeding into iOS status bar on PreRoundPreview screen when installed as home screen app"]})]})}),a.jsx(ne,{version:"3.38",date:"January 20, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Taxonomy Migration:"})," Updated all bird species codes to 2025 AOS/IBP taxonomy - migrated 5 codes (AMGOAGOL, CEWACEDW, SASPSAVS, WESJCASJ, EWPEEAWP) and fixed species names to match current ornithological standards"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Data Audit System:"})," Added comprehensive species data validation tools to ensure 100% consistency between game data and the authoritative IBP-AOS-list25.csv taxonomy reference"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Bug Fix:"})," Fixed taxonomic sort toggle re-shuffling birds on preview screen - now correctly re-orders existing birds without selecting new random ones"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Preview Screen Redesign:"}),' Completely overhauled "Ready to Play" page for better space efficiency - compact header, side-by-side toggles, larger bird grid visibility, and new tip box explaining grid positions']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Training Mode Visual Update:"})," Training mode toggle now highlights in green (instead of orange) for better visual distinction from other controls"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Sort Button Clarity:"}),' Alphabetical sort now displays as "Sort" by default, switching to "Taxonomic " when phylogenetic ordering is active']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Bird Reference Quick Access:"}),` Added  book icon button on preview screen that jumps directly to the pack's Bird Reference section with auto-expansion - includes "Ready to Play?" button for easy return`]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help Page Navigation:"}),' Added paired navigation buttons in bottom-right corner: green " Top" for scroll-to-top and orange "Expand/Collapse All" for section management']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Preview Instructions:"}),' Updated preview text to "Tap to preview signature song. Press and hold to get a closer look!" for clearer user guidance']})]})}),a.jsx(ne,{version:"3.37",date:"January 19, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Help Documentation:"}),' Added dedicated "Taxonomic Sorting" section to Help page - explains phylogenetic ordering, scientific name display, and how the feature works during gameplay']}),a.jsxs("li",{children:[a.jsx("strong",{children:"README Update:"})," Fixed Backyard Birds species count (56, added Robin) and updated version number"]})]})}),a.jsx(ne,{version:"3.36",date:"January 19, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Taxonomic Sort Toggle:"})," Added taxonomic/alphabetical sort toggle to pre-round preview screen - when enabled, shows birds in phylogenetic order with scientific names (italicized) instead of common names "]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Button Sort Persistence:"})," Species buttons during gameplay now respect taxonomic sort preference, making it easier for taxonomically-inclined players to build muscle memory"]})]})}),a.jsx(ne,{version:"3.35",date:"January 19, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"2025 AOS Taxonomy:"})," Updated all 86 species to official 2025 American Ornithological Society (66th Supplement) taxonomic positions - fixes phylogenetic ordering across all families, especially warblers (Swainson's Warbler now correctly appears before Setophaga radiation)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Scientific Names Fix:"})," Corrected numerous errors in displayed scientific names - WEWA now shows ",a.jsx("em",{children:"Helmitheros vermivorum"})," (not ",a.jsx("em",{children:"Setophaga pensylvanica"}),"!), plus 13+ other species fixed to match 2025 AOS data"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Species Data File:"})," Added comprehensive species.json with common names, scientific names, genus, species epithet, and taxonomic order for all birds - auto-generated from authoritative IBP-AOS-list25.csv"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder Icons:"})," Replaced generic circles with cute illustrated bird icon images - makes custom pack building more visual and fun!"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Data Source:"})," All taxonomy from The Institute for Bird Populations' official 2025 AOS list (2352 taxa) - scientifically accurate and up-to-date"]})]})}),a.jsx(ne,{version:"3.34",date:"January 19, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Scientific Names:"})," Bird Reference now shows scientific names (italicized) below common names when sorted taxonomically - perfect for learning phylogenetic relationships!"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Select UX:"}),' Enhanced grasshopper sparrow joke to read "6 levels/packstart @ #1,  sparrow" - more punchy and visual']}),a.jsxs("li",{children:[a.jsx("strong",{children:"OCWA Clips:"})," Added 7 new Orange-crowned Warbler clips from Xeno-Canto (6 songs, 1 call) - all quality A recordings for expanded species coverage"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Audio Quality:"})," Trimmed OCWA_985696 to remove interfering bird vocalization at beginning - now shows clean warbler song only"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Data Fixes:"})," Removed duplicate OCWA_1046368 entry in clips database, set OCWA_976251 as canonical clip, removed low-quality SASP_1060896 clip"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Home Page:"})," Tightened spacing between title and tagline for better visual balance"]})]})}),a.jsx(ne,{version:"3.33",date:"January 19, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Taxonomic Sort:"})," Bird Reference now supports eBird/Clements 2025 taxonomic order - toggle between alphabetical and phylogenetic sorting with a fun easter egg for the science nerds"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Species Fixes:"})," Corrected Carolina Wren code from CAWR to CARW, and Barred Owl from BADO to BAOW - now matches eBird standard across all packs and data files"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"American Robin:"})," Added AMRO to starter pack (now 6 birds) - merged PR #4 with Cornell/Macaulay Library attribution"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Naming:"}),' Simplified "Common Eastern US Backyard Birds" to just "Backyard Birds" everywhere']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help Page Polish:"}),' Alphabetized bird list in pack descriptions, added "There are exceptions. Because, ornithology." note to 4-letter codes section']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help Navigation Fix:"})," Fixed unwanted auto-scroll when expanding sections after navigating from Pack Select with hash links"]})]})}),a.jsx(ne,{version:"3.32",date:"January 18, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Select UX:"})," Simplified intro bullets with direct links to Help (Training Mode section) and Settings - reduced text, added helpful navigation"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Back Button Enhancement:"}),' Made back buttons more prominent on Help and Settings pages (orange color, "Back" text instead of just icon) for better PWA navigation visibility']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Settings Copy:"})," Updated Support section with friendlier wording"]})]})}),a.jsx(ne,{version:"3.31",date:"January 18, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Bird Reference Link:"}),' Made "Bird Reference" in Tips section clickable - now all references to Pack Select have proper back navigation in PWA mode!']})})}),a.jsx(ne,{version:"3.30",date:"January 18, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"PWA Navigation Fix:"}),` Added "Back to Help" button on Bird Reference screen when navigated from Help page's About & Credits section - complete PWA navigation coverage!`]})})}),a.jsx(ne,{version:"3.29",date:"January 18, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"PWA Navigation Enhancement:"}),' Added "Back to Level Select" button on Bird Reference screen when navigated from Level Select - no more getting stuck in PWA mode!']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Rejection tracking system:"})," Clips rejected during review are now logged to prevent re-downloading - no more duplicate review efforts!"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Yellow-rumped Warbler (YRWA) quality improvements:"})," Curated down to 2 high-quality clips (from 14 candidates) - improved from Q3 to Q4 with better song/call diversity"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Cedar Waxwing (CEWA) audit:"})," Reviewed and optimized clip selection for better quality and vocalization diversity"]})]})}),a.jsx(ne,{version:"3.28",date:"January 18, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Bird Reference Navigation:"}),` Added contextual "Bird Reference" link from Level Select screen that jumps directly to the selected pack's bird list - easily review sounds before starting a level`]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Improved Xeno-canto Attribution:"}),' Now displays XC catalog numbers (e.g., "XC1015145 - David A. Brinkman") for proper credit and licensing compliance']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Deep Linking:"})," Navigate directly to Bird Reference section from Help page with smooth scrolling"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Pack Auto-Expansion:"})," When navigating from Level Select, the relevant pack automatically expands in Bird Reference"]})]})}),a.jsx(ne,{version:"3.27",date:"January 18, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Share Card UX:"}),' Improved share instructions with upward arrow emoji and clearer text "Press and hold the image above" to prevent confusion']})})}),a.jsx(ne,{version:"3.26",date:"January 18, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"PWA Home Screen Fix:"})," Fixed 404 error when adding ChipNotes to iPhone home screen - start_url now correctly points to root path"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Manifest Update:"}),' Updated PWA description to match new tagline "Train your ear. Know the birds."']})]})}),a.jsx(ne,{version:"3.25",date:"January 18, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Home Screen Refresh:"}),' New tagline "Train your ear. Know the birds." emphasizes the educational journey and real-world birding payoff']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Enhanced Visual Flow:"}),' Added 3-step "Hear  Match  Train" diagram with brain icon to clearly show the learning process']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Cleaner Layout:"})," Redesigned home screen with tighter spacing and more intuitive visual hierarchy"]})]})}),a.jsx(ne,{version:"3.24",date:"January 18, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Share Card Polish:"})," Refined share card design with circular bird icons and owl mascot, cleaner font hierarchy (removed monospace, reduced bold usage), and improved spacing for better visual balance"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Icon Improvements:"})," Bird icons and owl now display as perfect circles with proper aspect ratio scaling - no more white backgrounds or distortion"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Layout Refinement:"})," Moved Best Streak above bird icons, tightened spacing between pack/level and bird codes, centered text better in available space"]})]})}),a.jsx(ne,{version:"3.23",date:"January 17, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Share Score Card:"})," New shareable score card feature - download or share your round results with fun bird icons, stats, and confusion matrix highlights"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Domain:"})," ChipNotes now available at ",a.jsx("a",{href:"https://chipnotes.app",style:{color:"var(--color-accent)"},children:"chipnotes.app"})," - easier to remember and share!"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Training Mode indicator:"})," Share cards now show when Training Mode was used during the round"]})]})}),a.jsx(ne,{version:"3.22",date:"January 17, 2026",children:a.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:a.jsxs("li",{children:[a.jsx("strong",{children:"Version chronology fix:"})," Moved v3.02 and v3.03 to correct position in version history (after v3.13, before v2.0) - no more time-traveling versions!"]})})}),a.jsx(ne,{version:"3.21",date:"January 17, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"All Birds pack race condition fix:"})," Fixed state management bug where pack JSON loading overwrote the All Birds pack, causing it to disappear - now merges state correctly to preserve all packs"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Clickable version number:"})," Main menu version now links to Version History - auto-expands and scrolls to changelog"]})]})}),a.jsx(ne,{version:"3.20",date:"January 17, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Service worker cache fix:"}),' Fixed "Twilight Zone" bug where All Birds pack appeared on first load but disappeared after refresh - hashed JS bundles no longer cached, ensuring fresh code always loads']}),a.jsxs("li",{children:[a.jsx("strong",{children:"PWA stability:"})," Installed PWAs now properly update to show latest changes without requiring reinstall"]})]})}),a.jsx(ne,{version:"3.19",date:"January 17, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Version numbering fix:"})," Renamed v3.4 to v3.19 to maintain sequential ordering - fixes Apple-style confusion where 3.4 appeared after 3.18"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help page UX:"})," Collapsible sections with floating Expand All button - less scrolling, more scanning"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"All Birds reference:"})," Fixed missing bird icons in Bird Reference pack"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Navigation improvements:"})," Added Back button at bottom of Help page, Help link in Settings for easy cross-navigation"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Support link:"})," Ko-fi donation link added to Settings - buy me a coffee if ChipNotes helps you ID more birds"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Tech description restored:"})," Brought back the detailed tech paragraph about TypeScript, React, PixiJS, and PWA offline caching"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Privacy language:"}),' Updated Settings privacy text to be more neutral and less "we"-focused, "not stalking you" instead of "them"']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Credits update:"})," Added Cornell Macaulay Library, user contributions, and Bird Reference attribution"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Project timeline:"})," Documented creation timeline (Jan 8-11, 2026) and Claude Code collaboration"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Voice consistency:"}),' Changed "we" to "I" in Feedback section']})]})}),a.jsx(ne,{version:"3.18",date:"January 17, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"UI polish:"})," Streamlined pack selection, tightened layout, less visual clutter"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Custom Pack Builder:"}),' Sticky "Start" button stays visible with iOS keyboard, auto-focus for rapid bird entry, added preview tip']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help page:"})," Reorganized sections, added creator attribution"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Privacy page:"})," Full privacy policy accessible from Settings"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Analytics fix:"})," Fixed gtag initialization pattern - tracking now works correctly"]})]})}),a.jsx(ne,{version:"3.17",date:"January 16, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Cookie consent:"})," I know I'm a stranger, but please accept my cookies! It really helps me document how many players I have and which birds everyone loves. (GDPR-compliant banner now appears on first visit)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Privacy controls:"}),' Changed your mind? New "Analytics Cookies" toggle in Settings lets you opt in/out anytime']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Your data is safe:"})," IP anonymization enabled, secure cookie flags set, full GDPR/CCPA compliance - I promise I'm just adding bird nerds to my LIFE LIST, not stalking you"]})]})}),a.jsx(ne,{version:"3.16",date:"January 16, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Bird Reference enhancement:"})," Separated display species (40) from gameplay rotation (28) for Eastern Birds pack - Bird Reference now shows all available species for preview"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"UI improvements:"})," Streamlined pack selection tips, improved Help page tips with confusion matrix mention"]})]})}),a.jsx(ne,{version:"3.15",date:"January 16, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Xeno-canto attribution:"})," All Xeno-canto recordings now display recordist names for legal compliance (355 recordings attributed to 87+ contributors)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Help page enhancements:"}),' Added "Why Learn Bird Song?" section explaining the educational value of left/right audio training, tech details about PWA offline caching']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Audio curation:"})," Extensive clip review and quality improvements - refined canonical clips, updated vocalization types (call/song/drum), removed low-quality recordings"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"UI improvements:"}),' Moved shuffle button above bird grid for better visibility, added "Coming Soon" banner to Stats screen to clarify demo data']}),a.jsxs("li",{children:[a.jsx("strong",{children:"New bird icons:"})," Added icons for upcoming Macaulay species (ACFL, EAPH, EWPE, WEVI)"]})]})}),a.jsx(ne,{version:"3.14",date:"January 15, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Analytics:"})," Added Google Analytics 4 tracking for usage insights (page views, pack/level selections, Training Mode adoption)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Data fixes:"})," Restored BCCH, MODO, and WBNU clips lost during Cornell CD processing"]})]})}),a.jsx(ne,{version:"3.13",date:"January 15, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Western Birds pack:"})," 14 new species including Steller's Jay, California Scrub-Jay, Black-capped Chickadee, and more. Fixed to use 9 random birds per round."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Audio improvements:"})," Restored canonical clips for 71+ species, resolved 202 broken audio references, cleaned up duplicate EATO clips (115)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"UI refinements:"})," Black backgrounds on Training Mode labels for better readability, Warbler Academy icon updated to Blackburnian Warbler, improved loading indicators"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Bird Reference enhancements:"})," Collapsible packs with expand/collapse controls, source badges (Xeno-canto, Cornell, contributors), pack cards with representative bird icons"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Fixed blank spectrograms"})," (async texture loading), added pull-to-refresh on main menu, audio preloading on preview screen"]}),a.jsx("li",{children:"Added White-crowned Sparrow to Sparrows pack (now 9 species)"})]})}),a.jsx(ne,{version:"3.03",date:"January 17, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Quit button:"})," Added X button during gameplay to quit rounds early with confirmation"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Support section:"})," Added Ko-fi donation link and encouragement to support Cornell Macaulay Library and Xeno-Canto"]})]})}),a.jsx(ne,{version:"3.02",date:"January 17, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Mobile navigation fix:"})," Bottom menu icons now properly visible on both Safari and Chrome mobile browsers"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Fullscreen tip:"})," Added browser guidance for best mobile experience"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"PWA improvements:"})," Enhanced Apple mobile web app support"]})]})}),a.jsx(ne,{version:"2.0",date:"January 12, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsx("li",{children:"Rebranded to ChipNotes! with Owl Professor mascot"}),a.jsx("li",{children:"Training Mode: Toggle eye icon to show bird labels on tiles"}),a.jsx("li",{children:"Warbler Academy pack: 33 wood-warbler species for experts"}),a.jsx("li",{children:"Complete icon set: Hand-illustrated icons for all 91+ species"}),a.jsx("li",{children:"Added Eastern Towhee to Expanded Backyard pack"}),a.jsx("li",{children:"Birds now persist between rounds by default"}),a.jsx("li",{children:"Fixed scoring to allow full 100 points as documented"}),a.jsx("li",{children:"iOS audio improvements and playback fixes"})]})}),a.jsx(ne,{version:"1.0",date:"January 11, 2026",children:a.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[a.jsx("li",{children:"Initial release with 6 bird packs"}),a.jsx("li",{children:"Pre-round preview screen to hear and see birds before playing"}),a.jsx("li",{children:"Custom pack builder for targeted practice"}),a.jsx("li",{children:"Continuous play mode (untimed, relaxed practice)"}),a.jsx("li",{children:"Enhanced round summary with per-species breakdown"}),a.jsx("li",{children:"Progressive difficulty: 6 levels per pack"}),a.jsx("li",{children:"Real spectrograms for visual learning"}),a.jsx("li",{children:"PWA support for offline play and mobile installation"})]})})]})]}),a.jsx("div",{style:{height:"120px"}})]}),s&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{var y;return(y=e.state)!=null&&y.fromPackSelect?t("/pack-select"):t(-1)},style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",left:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",zIndex:1e3},onMouseEnter:y=>{y.currentTarget.style.transform="scale(1.05)",y.currentTarget.style.background="rgba(255, 152, 0, 0.25)",y.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:y=>{y.currentTarget.style.transform="scale(1)",y.currentTarget.style.background="rgba(255, 152, 0, 0.15)",y.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},"aria-label":"Back",children:[a.jsx("span",{style:{fontSize:"12px"},children:""}),"Back"]}),a.jsxs("button",{onClick:p,style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",right:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",zIndex:1e3},onMouseEnter:y=>{y.currentTarget.style.transform="scale(1.05)",y.currentTarget.style.background="rgba(255, 152, 0, 0.25)",y.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:y=>{y.currentTarget.style.transform="scale(1)",y.currentTarget.style.background="rgba(255, 152, 0, 0.15)",y.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},children:[a.jsx("span",{style:{fontSize:"12px"},children:f?"":""}),f?"Collapse All":"Expand All"]})]})]})}function Gt({id:t,title:e,children:r,isExpanded:n,onToggle:i}){return a.jsxs("div",{id:t,style:{marginBottom:"16px",scrollMarginTop:"20px"},children:[a.jsxs("h3",{onClick:i,style:{fontSize:"16px",fontWeight:600,marginBottom:n?"12px":"0",color:"var(--color-accent)",opacity:.85,borderBottom:"1px solid var(--color-surface)",paddingBottom:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"opacity 0.2s",userSelect:"none"},onMouseEnter:s=>s.currentTarget.style.opacity="0.7",onMouseLeave:s=>s.currentTarget.style.opacity="0.85",children:[a.jsx("span",{style:{fontSize:"14px",width:"14px",textAlign:"center",flexShrink:0},children:n?"":""}),e]}),n&&a.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,color:"var(--color-text)"},children:r})]})}function Yc({label:t,points:e,description:r,color:n}){return a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[a.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:n,minWidth:"40px"},children:["+",e]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:600},children:t}),a.jsx("span",{style:{color:"var(--color-text-muted)",marginLeft:"8px",fontSize:"13px"},children:r})]})]})}function Xi({name:t,description:e}){return a.jsxs("div",{style:{marginBottom:"12px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px"},children:[a.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:t}),a.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:e})]})}function Hs({level:t,title:e,description:r}){const i=(s=>s<=2?"#4CAF50":s<=4?"rgba(245, 166, 35, 0.8)":"#FF5722")(t);return a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px",padding:"10px 12px",background:"var(--color-surface)",borderRadius:"10px"},children:[a.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:`linear-gradient(135deg, ${i}33, ${i}11)`,border:`2px solid ${i}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"16px",color:i,flexShrink:0},children:t}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:600,marginBottom:"2px"},children:e}),a.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.3},children:r})]})]})}function ne({version:t,date:e,children:r}){return a.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px",borderLeft:"3px solid rgba(245, 166, 35, 0.5)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"8px",marginBottom:"8px"},children:[a.jsxs("span",{style:{fontWeight:700,fontSize:"16px",color:"var(--color-accent)",opacity:.7},children:["v",t]}),a.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:e})]}),r]})}function m6(){return a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function g6(){const t=cr();return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[a.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:a.jsx(x6,{})}),a.jsx("h2",{style:{margin:0},children:"Privacy Policy"})]}),a.jsxs("div",{className:"flex-col gap-lg",style:{maxWidth:"800px"},children:[a.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[a.jsxs("p",{style:{marginBottom:"12px"},children:[a.jsx("strong",{children:"Last Updated:"})," January 25, 2026"]}),a.jsx("p",{style:{marginBottom:"12px"},children:"ChipNotes! is committed to protecting your privacy. This policy explains what data is collected, how it is used, and your rights."})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Data Collection"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[a.jsx("p",{style:{marginBottom:"8px"},children:a.jsx("strong",{children:"Local Data (Always Stored on Your Device):"})}),a.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[a.jsx("li",{children:"Game settings (scroll speed, spectrogram mode, high contrast, continuous play)"}),a.jsx("li",{children:"Custom pack selections (bird species you choose) and saved custom packs (pack names you create, up to 10 packs)"}),a.jsx("li",{children:"Round results and scores (not linked to your identity)"}),a.jsx("li",{children:"Cookie consent preference"})]}),a.jsx("p",{style:{marginBottom:"8px"},children:a.jsx("strong",{children:"Analytics Data (Only if You Consent):"})}),a.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[a.jsx("li",{children:"Anonymized usage data via Google Analytics (IP addresses are anonymized)"}),a.jsx("li",{children:"Which features are used and which birds are practiced"}),a.jsx("li",{children:"App performance metrics"})]}),a.jsxs("p",{style:{fontSize:"13px",color:"var(--color-accent)"},children:[a.jsx("strong",{children:"Not collected:"})," Names, email addresses, phone numbers, precise location, or any personally identifiable information. Your game data stays on your device."]})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"How Your Data Is Used"}),a.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:a.jsxs("ul",{style:{marginLeft:"20px"},children:[a.jsx("li",{children:"Local data: Saves your preferences and tracks your progress"}),a.jsx("li",{children:"Analytics data: Used to understand how many players use ChipNotes, which features are popular, and how to improve the app"}),a.jsx("li",{children:"Your data is never sold, rented, or shared with third parties (except Google Analytics if you consent)"})]})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Third-Party Services"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[a.jsxs("p",{style:{marginBottom:"8px"},children:[a.jsx("strong",{children:"Google Analytics"})," (only if you consent)"]}),a.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[a.jsx("li",{children:"Used to collect anonymized usage statistics"}),a.jsx("li",{children:"IP anonymization enabled"}),a.jsx("li",{children:"No ad personalization or cross-device tracking"}),a.jsxs("li",{children:["Learn more: ",a.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Google Privacy Policy"})]})]}),a.jsx("p",{style:{marginBottom:"8px"},children:a.jsx("strong",{children:"Bird Audio"})}),a.jsxs("ul",{style:{marginLeft:"20px"},children:[a.jsx("li",{children:"Bird sound recordings are sourced from Xeno-Canto, Cornell Macaulay Library, and New Zealand Department of Conservation, and cached locally on your device"}),a.jsx("li",{children:"No data is sent to these sources when you play sounds offline"})]})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Your Rights"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[a.jsx("p",{style:{marginBottom:"8px"},children:"You have the right to:"}),a.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Access your data:"})," All local data is stored in your browser's localStorage (visible in browser dev tools)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Delete your data:"}),' Delete individual saved custom packs using the Delete button in Custom Pack Builder, or use the "Reset All Progress" button in Settings to delete all local data and cache']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Withdraw consent:"}),' Toggle "Analytics" in Settings to disable Google Analytics at any time']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Data portability:"})," Local data can be exported via browser dev tools (localStorage)"]})]}),a.jsx("p",{style:{fontSize:"13px"},children:"Since all game data is stored locally on your device, you have full control. Uninstalling the app or clearing browser data will permanently delete all your data."})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Cookies & Local Storage"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[a.jsx("p",{style:{marginBottom:"8px"},children:a.jsx("strong",{children:"Essential (Always Active):"})}),a.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[a.jsxs("li",{children:[a.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"chipnotes_cookie_consent"})," - Stores your cookie consent choice"]}),a.jsxs("li",{children:[a.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"soundfield_*"})," - Game settings and progress (all stored in localStorage)"]})]}),a.jsx("p",{style:{marginBottom:"8px"},children:a.jsx("strong",{children:"Analytics (Only if You Consent):"})}),a.jsx("ul",{style:{marginLeft:"20px"},children:a.jsxs("li",{children:[a.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga"}),", ",a.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga_*"})," - Google Analytics cookies (2-year expiration)"]})})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Data Security"}),a.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:a.jsxs("ul",{style:{marginLeft:"20px"},children:[a.jsx("li",{children:"All data is stored locally on your device (no cloud servers)"}),a.jsx("li",{children:"HTTPS encryption for all web traffic"}),a.jsx("li",{children:"No user accounts or authentication (no password risks)"}),a.jsx("li",{children:"Service Worker caches audio files for offline use (stored locally)"})]})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Children's Privacy"}),a.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:a.jsx("p",{children:"ChipNotes does not knowingly collect data from children under 13. The app does not require any personal information, and analytics are opt-in. Parents can disable analytics in Settings."})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"International Users"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[a.jsx("p",{style:{marginBottom:"8px"},children:"ChipNotes complies with:"}),a.jsxs("ul",{style:{marginLeft:"20px"},children:[a.jsxs("li",{children:[a.jsx("strong",{children:"GDPR"})," (European Union) - Right to access, deletion, and data portability"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"CCPA"})," (California) - Right to know and delete personal information"]}),a.jsx("li",{children:"Since no personal information is collected, compliance is straightforward"})]})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Changes to This Policy"}),a.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:a.jsx("p",{children:'This Privacy Policy may be updated from time to time. Changes will be posted on this page with an updated "Last Updated" date. Continued use of the app after changes constitutes acceptance of the updated policy.'})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{style:{marginBottom:"12px"},children:"Contact Us"}),a.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[a.jsx("p",{style:{marginBottom:"8px"},children:"Questions about this Privacy Policy or your data?"}),a.jsxs("p",{children:["Email:"," ",a.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]})]})]})]})]})}function x6(){return a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}const b1="#4db6ac",w1=[{id:"nz_common",name:"Garden & Bush",speciesCount:9,isUnlocked:!0,description:`The 9 most common birds you'll hear
across New Zealand.`},{id:"nz_north_island",name:"North Island",speciesCount:21,isUnlocked:!0,description:`Birds of
Te Ika-a-Maui`},{id:"nz_south_island",name:"South Island",speciesCount:22,isUnlocked:!0,description:`Birds of
Te Waipounamu`},{id:"nz_all_birds",name:"All NZ Birds",speciesCount:37,isUnlocked:!0,description:`The complete collection of 37
New Zealand native birds.`}];function y6(){var R,z;const t=cr(),e=Oi(),[r]=Ko(),[n,i]=w.useState([]),[s,o]=w.useState({}),[l,c]=w.useState({}),[d,u]=w.useState({}),[h,p]=w.useState({}),[f,m]=w.useState(new Set),[_,y]=w.useState(null),[x,v]=w.useState(null),[g,b]=w.useState({}),[S,j]=qw(),E=w.useRef(null),T=w.useRef(null);w.useEffect(()=>{var P;const N=(P=document.querySelector(".screen"))==null?void 0:P.parentElement;N&&N.scrollTo(0,0),window.scrollTo(0,0)},[]),w.useEffect(()=>{const N=r.get("expand")||r.get("expandPack");N&&(m(new Set([N])),setTimeout(()=>{var P;(P=T.current)==null||P.scrollIntoView({behavior:"smooth",block:"start"})},100))},[r]),w.useEffect(()=>{fetch("/data/clips.json").then(N=>N.json()).then(N=>{const P=N.filter(L=>L.source==="doc");i(P)}).catch(N=>console.error("Failed to load clips:",N))},[]),w.useEffect(()=>{Promise.all([fetch("/data/species.json").then(N=>N.json()),fetch("/data/nz_display_codes.json").then(N=>N.json()).catch(()=>({codes:{}})),fetch("/data/taxonomic_order.json").then(N=>N.json()).catch(()=>({}))]).then(([N,P,L])=>{const I={},D={};N.forEach(C=>{I[C.species_code]=C.common_name,C.scientific_name&&(D[C.species_code]=C.scientific_name)}),c(I),u(D),p(P.codes||{}),b(L)}).catch(N=>console.error("Failed to load species:",N))},[]),w.useEffect(()=>{const N=["nz_all_birds","nz_common","nz_north_island","nz_south_island"];Promise.all([...N.map(P=>fetch(`/data/packs/${P}.json`).then(L=>L.json()).catch(()=>null)),Kg()]).then(P=>{const L={};P.slice(0,N.length).forEach((I,D)=>{I&&I.species&&(L[N[D]]=I.display_species||I.species)}),o(L)})},[]);const B=N=>{Yw(N.id,N.name),t(`/level-select?pack=${N.id}`)},M=N=>{const L=(s[N]||[]).map(I=>{const D=oI();let C=[I];if(D){for(const V of Object.values(D.merges))if(V.subspecies.includes(I)||V.icon===I){C=V.subspecies;break}}const A=n.filter(V=>C.includes(V.species_code)&&!V.rejected),H=A.find(V=>V.canonical)||A[0],pe=A.sort((V,ge)=>V.canonical&&!ge.canonical?-1:!V.canonical&&ge.canonical?1:V.clip_id.localeCompare(ge.clip_id)).map(V=>({id:V.clip_id,path:`/${V.file_path}`,isCanonical:!!V.canonical,vocalizationType:V.vocalization_type,source:V.source,sourceId:V.source_id,sourceUrl:V.source_url,recordist:V.recordist,regionLabel:aI(V.species_code)})),ie=h[I];return{code:I,displayCode:(ie==null?void 0:ie.code)||I,tileName:(ie==null?void 0:ie.tileName)||I,englishName:(ie==null?void 0:ie.englishName)||l[I]||I,name:l[I]||I,scientificName:d[I],canonicalClipPath:H?`/${H.file_path}`:null,clipCount:A.length,allClips:pe}});switch(S){case"english":return L.sort((I,D)=>I.englishName.localeCompare(D.englishName));case"taxonomic":return Object.keys(g).length>0?L.sort((I,D)=>{const C=g[I.code]||9999,A=g[D.code]||9999;return C-A}):L.sort((I,D)=>I.tileName.localeCompare(D.tileName));case"maori":default:return L.sort((I,D)=>I.tileName.localeCompare(D.tileName))}},F=(N,P)=>{if(E.current&&(E.current.pause(),E.current=null),x===P){v(null);return}const L=new Audio(N);E.current=L,v(P),L.play().catch(I=>console.error("Failed to play audio:",I)),L.onended=()=>{v(null),E.current=null}};w.useEffect(()=>()=>{E.current&&E.current.pause()},[]);const U={nz_all_birds:"linear-gradient(135deg, #4a7a6a 0%, #2a5a4a 100%)",nz_common:"linear-gradient(135deg, #b8a832 0%, #8a7a28 100%)",nz_north_island:"linear-gradient(135deg, #7a5a3d 0%, #5a4028 100%)",nz_south_island:"linear-gradient(135deg, #5a6a8a 0%, #3a4a6a 100%)"},k={nz_all_birds:"kakapo2",nz_common:"tui1",nz_north_island:"kokako3",nz_south_island:"kea1"};return a.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[a.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[a.jsx("button",{className:"btn-icon",onClick:()=>t("/pack-select"),"aria-label":"Back",style:{color:b1},children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),a.jsxs("h2",{style:{margin:0,flex:1,fontSize:"22px"},children:["New Zealand Birds ",a.jsx("span",{style:{fontSize:"26px"},children:""})]}),a.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:b1},children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})})]}),a.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.6,background:"rgba(70, 70, 90, 0.5)",padding:"16px",borderRadius:"12px"},children:a.jsxs("p",{style:{margin:0},children:["37 native species from Aotearoa New Zealand. Audio courtesy of the"," ",a.jsx("a",{href:"https://www.doc.govt.nz/nature/native-animals/birds/bird-songs-and-calls/",target:"_blank",rel:"noopener noreferrer",style:{color:"#a8d5a2",textDecoration:"underline"},children:"NZ Department of Conservation"})," (Crown Copyright)."]})}),a.jsx("div",{style:{marginBottom:"20px",background:"var(--color-surface)",border:"2px solid rgba(45, 122, 122, 0.4)",borderRadius:"16px",overflow:"visible"},children:a.jsxs("div",{onClick:()=>t("/custom-pack?region=nz"),style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px 20px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:N=>{N.currentTarget.style.background="rgba(45, 122, 122, 0.15)"},onMouseLeave:N=>{N.currentTarget.style.background="transparent"},children:[a.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(45, 122, 122, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",flexShrink:0},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 5v14M5 12h14"})})}),a.jsxs("div",{style:{flex:1,minWidth:0},children:[a.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#f5f0e6"},children:"Create Custom Pack"}),a.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginTop:"2px"},children:"Mix and match your own selection of NZ birds"})]}),a.jsx("span",{style:{fontSize:"20px",color:"#a8d5a2"},children:""})]})}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"32px"},children:w1.map(N=>a.jsxs("button",{onClick:()=>B(N),style:{position:"relative",overflow:"hidden",textAlign:"left",padding:"16px",borderRadius:"16px",border:"none",background:U[N.id],boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s",gridColumn:N.id==="nz_common"||N.id==="nz_all_birds"?"1 / -1":"auto"},onMouseEnter:P=>{P.currentTarget.style.transform="translateY(-2px)",P.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:P=>{P.currentTarget.style.transform="translateY(0)",P.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:[a.jsx("img",{src:`/data/icons/${k[N.id]}.png`,alt:"",style:{position:"absolute",right:"-10px",bottom:"-10px",width:"80px",height:"80px",opacity:.75,filter:"brightness(1.2)",transform:"rotate(-15deg)",objectFit:"cover"}}),a.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:2},children:a.jsx("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#a8d5a2",fontWeight:600,textTransform:"uppercase"},children:"Play "})}),a.jsxs("div",{style:{position:"relative",zIndex:1,paddingTop:N.id==="nz_common"||N.id==="nz_all_birds"?0:"8px",maxWidth:"55%"},children:[a.jsx("div",{style:{fontSize:"16px",fontWeight:700,color:"#f5f0e6",marginBottom:"6px"},children:N.name}),a.jsx("div",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.9)",marginBottom:"10px"},children:N.description}),a.jsxs("span",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.9)",fontWeight:600},children:[N.speciesCount," species"]})]})]},N.id))}),a.jsxs("div",{ref:T,children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"12px"},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{fontSize:"16px",margin:0,color:"var(--color-text-muted)"},children:"Sound Library"}),a.jsx("div",{style:{fontSize:"14px",marginTop:"2px"},children:""})]}),a.jsxs("div",{style:{display:"flex",borderRadius:"6px",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.15)"},children:[a.jsx("button",{onClick:()=>{j("maori"),vo("maori","sound_library")},style:{padding:"6px 10px",background:S==="maori"?"rgba(77, 182, 172, 0.3)":"rgba(255, 255, 255, 0.05)",border:"none",borderRight:"1px solid rgba(255, 255, 255, 0.15)",cursor:"pointer",fontSize:"11px",color:S==="maori"?"#4db6ac":"var(--color-text-muted)",fontWeight:S==="maori"?600:400},title:"Sort by Maori name",children:"Te Reo"}),a.jsx("button",{onClick:()=>{j("english"),vo("english","sound_library")},style:{padding:"6px 10px",background:S==="english"?"rgba(77, 182, 172, 0.3)":"rgba(255, 255, 255, 0.05)",border:"none",borderRight:"1px solid rgba(255, 255, 255, 0.15)",cursor:"pointer",fontSize:"11px",color:S==="english"?"#4db6ac":"var(--color-text-muted)",fontWeight:S==="english"?600:400},title:"Sort by English name",children:"English"}),a.jsx("button",{onClick:()=>{j("taxonomic"),vo("taxonomic","sound_library")},style:{padding:"6px 10px",background:S==="taxonomic"?"rgba(77, 182, 172, 0.3)":"rgba(255, 255, 255, 0.05)",border:"none",cursor:"pointer",fontSize:"11px",color:S==="taxonomic"?"#4db6ac":"var(--color-text-muted)",fontWeight:S==="taxonomic"?600:400},title:"Sort by taxonomic order",children:" Taxonomy"})]})]}),a.jsxs("div",{style:{background:"rgba(255, 200, 50, 0.12)",border:"1px solid rgba(255, 200, 50, 0.3)",borderRadius:"8px",padding:"10px 14px",marginBottom:"16px",fontSize:"13px",color:"rgba(255, 255, 255, 0.8)",lineHeight:"1.4"},children:[a.jsx("span",{style:{marginRight:"6px"},children:""}),"Sound library under construction. Sound type labels (song, call, etc.) are being reviewed and corrected  don't rely on them just yet."]}),a.jsxs("p",{style:{margin:"0 0 16px 0",fontSize:"12px",color:"var(--color-text-muted)",fontStyle:"italic"},children:["Regional subspecies are merged for gameplay. Clips show region badges:"," ",a.jsx("span",{style:{background:"#4db6ac",color:"#fff",padding:"1px 4px",borderRadius:"3px",fontSize:"10px"},children:"NI"})," ",a.jsx("span",{style:{background:"#4db6ac",color:"#fff",padding:"1px 4px",borderRadius:"3px",fontSize:"10px"},children:"SI"})," ",a.jsx("span",{style:{background:"#4db6ac",color:"#fff",padding:"1px 4px",borderRadius:"3px",fontSize:"10px"},children:"Ch"})]}),((R=e.state)==null?void 0:R.fromLevelSelect)&&((z=e.state)==null?void 0:z.packId)&&a.jsx("div",{style:{marginBottom:"16px"},children:a.jsxs("button",{onClick:()=>t(`/level-select?pack=${e.state.packId}`),style:{background:"#4db6ac",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Level Select",children:[a.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Level Select"]})}),w1.map(N=>{var I,D;const P=f.has(N.id),L=M(N.id);return a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsxs("div",{onClick:()=>{const C=new Set(f);C.has(N.id)?C.delete(N.id):C.add(N.id),m(C)},style:{fontSize:"14px",color:"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"10px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},children:[a.jsx("span",{style:{color:"#2d7a7a",opacity:.7},children:P?"":""}),a.jsx("span",{style:{fontWeight:600,color:"#4db6ac",opacity:.85},children:N.name}),a.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[L.length," species"]})]}),P&&a.jsxs("div",{style:{marginTop:"8px"},children:[((I=e.state)==null?void 0:I.fromPreview)&&((D=e.state)==null?void 0:D.pack)===N.id&&a.jsx("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"flex-end",paddingRight:"8px"},children:a.jsx("button",{onClick:()=>{const{pack:C,level:A}=e.state;t(`/preview?pack=${C}&level=${A}&keepBirds=true`)},style:{padding:"10px 16px",fontSize:"14px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 4px 12px rgba(45, 90, 39, 0.4)",display:"flex",alignItems:"center",gap:"6px"},children:"Ready to Play?"})}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px",padding:"8px",background:"rgba(0,0,0,0.2)",borderRadius:"8px"},children:L.map(C=>{const A=_===C.code;return a.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:C.clipCount>1?"pointer":"default"},onClick:()=>{C.clipCount>1&&y(A?null:C.code)},children:[a.jsx("img",{src:`/data/icons/${C.code}.png`,alt:C.name,style:{width:"36px",height:"36px",borderRadius:"50%",objectFit:"cover",flexShrink:0},onError:O=>{O.currentTarget.style.display="none"}}),a.jsxs("div",{style:{flex:1,minWidth:0},children:[a.jsx("div",{style:{fontSize:"13px",fontWeight:700,color:"#4db6ac"},children:S==="english"?C.englishName:C.tileName}),a.jsx("div",{style:{fontSize:"11px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--color-text-muted)",fontStyle:S==="taxonomic"?"italic":"normal"},children:S==="taxonomic"?C.scientificName:S==="english"?C.tileName!==C.englishName?C.tileName:"":C.englishName!==C.tileName?C.englishName:""}),a.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)"},children:[C.clipCount," clip",C.clipCount!==1?"s":"",C.clipCount>1&&a.jsx("span",{style:{marginLeft:"4px",color:"#2d7a7a",opacity:.7},children:A?"":""})]})]}),C.canonicalClipPath&&a.jsx("button",{onClick:O=>{O.stopPropagation(),F(C.canonicalClipPath,C.code)},style:{width:"28px",height:"28px",borderRadius:"50%",border:"none",background:x===C.code?"#4db6ac":"rgba(77, 182, 172, 0.3)",color:x===C.code?"#000":"#4db6ac",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",flexShrink:0},children:x===C.code?"":""})]}),A&&C.allClips.length>0&&a.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"8px 12px",background:"rgba(0,0,0,0.2)"},children:[a.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"8px"},children:["All ",C.clipCount," clips:"]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:C.allClips.map((O,H)=>a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("button",{onClick:()=>F(O.path,O.id),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:x===O.id?"#4db6ac":"rgba(77, 182, 172, 0.3)",color:x===O.id?"#000":"#4db6ac",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,fontSize:"10px"},"aria-label":`Play clip ${H+1}`,children:x===O.id?"":""}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px",flex:1},children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[a.jsx("span",{style:{fontSize:"11px",color:"var(--color-text)"},children:O.sourceId||`Clip ${H+1}`}),O.isCanonical&&a.jsx("span",{style:{fontSize:"9px",color:"#000",background:"#4db6ac",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"SIGNATURE"}),O.vocalizationType&&a.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px",textTransform:"capitalize"},children:O.vocalizationType}),O.regionLabel&&a.jsx("span",{style:{fontSize:"9px",color:"#fff",background:"#4db6ac",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:O.regionLabel}),O.source==="doc"&&a.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:"DOC NZ"})]})})]},O.id))})]})]},C.code)})})]})]},N.id)})]})]})}const zp="chipnotes_cookie_consent";function S1(){if(typeof window>"u")return;if(window.gtag){console.log("Google Analytics already loaded");return}window.dataLayer=window.dataLayer||[],window.gtag=function(){var e;(e=window.dataLayer)==null||e.push(arguments)},window.gtag("js",new Date),window.gtag("config","G-MJXQZYWWZ0",{anonymize_ip:!0,cookie_flags:"SameSite=Lax;Secure",cookie_expires:63072e3,allow_ad_personalization_signals:!1,allow_google_signals:!1});const t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-MJXQZYWWZ0",document.head.appendChild(t),console.log("Google Analytics loading with user consent")}function v6(){const[t,e]=w.useState(!1);w.useEffect(()=>{const i=localStorage.getItem(zp);i==="accepted"?S1():i===null&&e(!0)},[]);const r=()=>{localStorage.setItem(zp,"accepted"),e(!1),S1(),setTimeout(()=>{window.location.reload()},100)},n=()=>{localStorage.setItem(zp,"declined"),e(!1),setTimeout(()=>{window.location.reload()},100)};return t?a.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"rgba(26, 26, 46, 0.98)",backdropFilter:"blur(10px)",borderTop:"1px solid var(--color-primary)",padding:"16px",paddingBottom:"calc(16px + var(--safe-area-bottom, 0px))",zIndex:1e4,boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.3)"},children:a.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"12px"},children:[a.jsxs("div",{style:{fontSize:"14px",lineHeight:1.5,color:"var(--color-text)"},children:[a.jsx("strong",{style:{color:"var(--color-accent)"},children:" Cookies & Privacy"}),a.jsxs("p",{style:{margin:"8px 0 0 0",color:"var(--color-text-muted)"},children:["We use Google Analytics to understand how people use ChipNotes and improve the app. This helps us know which features are useful and which birds people practice most. We anonymize your IP address and don't collect personal information."," ",a.jsx("a",{href:"/bird-sound-game/privacy",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Learn more"})]})]}),a.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[a.jsx("button",{onClick:r,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="#3a7332"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-primary)"},children:"Accept Analytics"}),a.jsx("button",{onClick:n,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-surface)",color:"var(--color-text)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="var(--color-background)"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-surface)"},children:"Decline"})]})]})}):null}const _6=1.4,b6=768,w6=1024;function S6(){const[t,e]=w.useState(1);return w.useEffect(()=>{const r=()=>{window.innerWidth>=b6?e(_6):e(1)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),w.useEffect(()=>(document.documentElement.style.fontSize=`${16*t}px`,()=>{document.documentElement.style.fontSize="16px"}),[t]),a.jsxs("div",{style:{zoom:t,width:"100%",maxWidth:`${w6}px`,height:"100%",overflow:"auto",margin:"0 auto"},children:[a.jsxs(_k,{children:[a.jsx(ur,{path:"/",element:a.jsx(jk,{})}),a.jsx(ur,{path:"/pack-select",element:a.jsx(Gk,{})}),a.jsx(ur,{path:"/nz-packs",element:a.jsx(y6,{})}),a.jsx(ur,{path:"/level-select",element:a.jsx(Qk,{})}),a.jsx(ur,{path:"/preview",element:a.jsx(gI,{})}),a.jsx(ur,{path:"/custom-pack",element:a.jsx(_I,{})}),a.jsx(ur,{path:"/gameplay",element:a.jsx(HO,{})}),a.jsx(ur,{path:"/summary",element:a.jsx(YO,{})}),a.jsx(ur,{path:"/settings",element:a.jsx(c6,{})}),a.jsx(ur,{path:"/progress",element:a.jsx(h6,{})}),a.jsx(ur,{path:"/help",element:a.jsx(f6,{})}),a.jsx(ur,{path:"/privacy",element:a.jsx(g6,{})})]}),a.jsx(v6,{})]})}const E6="https://3537776cce5db894ff33a749d1110007@o4510835658850304.ingest.us.sentry.io/4510835673530368";function T6(){PO({dsn:E6,release:"chipnotes@4.20",sampleRate:1,tracesSampleRate:0,beforeSend(t){var r,n,i,s;const e=(s=(i=(n=(r=t.exception)==null?void 0:r.values)==null?void 0:n[0])==null?void 0:i.stacktrace)==null?void 0:s.frames;return e!=null&&e.some(o=>{var l,c;return((l=o.filename)==null?void 0:l.startsWith("chrome-extension://"))||((c=o.filename)==null?void 0:c.startsWith("moz-extension://"))})?null:t}})}function C6(){return a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",background:"var(--color-background, #1A1A2E)",color:"var(--color-text, #FFFFFF)",fontFamily:"Inter, -apple-system, sans-serif",padding:"24px",textAlign:"center"},children:[a.jsx("h1",{style:{fontSize:"24px",marginBottom:"12px"},children:"Something went wrong"}),a.jsx("p",{style:{color:"var(--color-text-muted, #C8C8D8)",fontSize:"15px",maxWidth:"320px",lineHeight:1.5,marginBottom:"24px"},children:"An unexpected error occurred. The error has been reported automatically."}),a.jsx("button",{onClick:()=>{window.location.href="/"},style:{padding:"14px 32px",fontSize:"16px",fontWeight:600,background:"var(--color-primary, #2D5A27)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer"},children:"Back to Menu"})]})}function A6({children:t}){return a.jsx(DO,{fallback:a.jsx(C6,{}),children:t})}T6();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered:",e.scope)}).catch(e=>{console.log("SW registration failed:",e)})});$p.createRoot(document.getElementById("root")).render(a.jsx(N1.StrictMode,{children:a.jsx(A6,{children:a.jsx(kk,{basename:"/",children:a.jsx(S6,{})})})}));
