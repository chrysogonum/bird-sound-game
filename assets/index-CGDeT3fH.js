var Z1=Object.defineProperty;var J1=(t,e,r)=>e in t?Z1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var mn=(t,e,r)=>J1(t,typeof e!="symbol"?e+"":e,r);function ew(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var So=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function tw(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Py={exports:{}},Pc={},Iy={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var la=Symbol.for("react.element"),rw=Symbol.for("react.portal"),nw=Symbol.for("react.fragment"),iw=Symbol.for("react.strict_mode"),sw=Symbol.for("react.profiler"),ow=Symbol.for("react.provider"),aw=Symbol.for("react.context"),lw=Symbol.for("react.forward_ref"),cw=Symbol.for("react.suspense"),uw=Symbol.for("react.memo"),hw=Symbol.for("react.lazy"),im=Symbol.iterator;function dw(t){return t===null||typeof t!="object"?null:(t=im&&t[im]||t["@@iterator"],typeof t=="function"?t:null)}var ky={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},My=Object.assign,By={};function Gs(t,e,r){this.props=t,this.context=e,this.refs=By,this.updater=r||ky}Gs.prototype.isReactComponent={};Gs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Gs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function jy(){}jy.prototype=Gs.prototype;function Bf(t,e,r){this.props=t,this.context=e,this.refs=By,this.updater=r||ky}var jf=Bf.prototype=new jy;jf.constructor=Bf;My(jf,Gs.prototype);jf.isPureReactComponent=!0;var sm=Array.isArray,Ny=Object.prototype.hasOwnProperty,Nf={current:null},Fy={key:!0,ref:!0,__self:!0,__source:!0};function Ly(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Ny.call(e,n)&&!Fy.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:la,type:t,key:s,ref:o,props:i,_owner:Nf.current}}function fw(t,e){return{$$typeof:la,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ff(t){return typeof t=="object"&&t!==null&&t.$$typeof===la}function pw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var om=/\/+/g;function mu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?pw(""+t.key):e.toString(36)}function pl(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case la:case rw:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+mu(o,0):n,sm(i)?(r="",t!=null&&(r=t.replace(om,"$&/")+"/"),pl(i,e,r,"",function(u){return u})):i!=null&&(Ff(i)&&(i=fw(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(om,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",sm(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+mu(s,a);o+=pl(s,e,r,l,i)}else if(l=dw(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+mu(s,a++),o+=pl(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Aa(t,e,r){if(t==null)return t;var n=[],i=0;return pl(t,n,"","",function(s){return e.call(r,s,i++)}),n}function mw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Et={current:null},ml={transition:null},gw={ReactCurrentDispatcher:Et,ReactCurrentBatchConfig:ml,ReactCurrentOwner:Nf};function Dy(){throw Error("act(...) is not supported in production builds of React.")}ye.Children={map:Aa,forEach:function(t,e,r){Aa(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Aa(t,function(){e++}),e},toArray:function(t){return Aa(t,function(e){return e})||[]},only:function(t){if(!Ff(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ye.Component=Gs;ye.Fragment=nw;ye.Profiler=sw;ye.PureComponent=Bf;ye.StrictMode=iw;ye.Suspense=cw;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gw;ye.act=Dy;ye.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=My({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Nf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Ny.call(e,l)&&!Fy.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:la,type:t.type,key:i,ref:s,props:n,_owner:o}};ye.createContext=function(t){return t={$$typeof:aw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ow,_context:t},t.Consumer=t};ye.createElement=Ly;ye.createFactory=function(t){var e=Ly.bind(null,t);return e.type=t,e};ye.createRef=function(){return{current:null}};ye.forwardRef=function(t){return{$$typeof:lw,render:t}};ye.isValidElement=Ff;ye.lazy=function(t){return{$$typeof:hw,_payload:{_status:-1,_result:t},_init:mw}};ye.memo=function(t,e){return{$$typeof:uw,type:t,compare:e===void 0?null:e}};ye.startTransition=function(t){var e=ml.transition;ml.transition={};try{t()}finally{ml.transition=e}};ye.unstable_act=Dy;ye.useCallback=function(t,e){return Et.current.useCallback(t,e)};ye.useContext=function(t){return Et.current.useContext(t)};ye.useDebugValue=function(){};ye.useDeferredValue=function(t){return Et.current.useDeferredValue(t)};ye.useEffect=function(t,e){return Et.current.useEffect(t,e)};ye.useId=function(){return Et.current.useId()};ye.useImperativeHandle=function(t,e,r){return Et.current.useImperativeHandle(t,e,r)};ye.useInsertionEffect=function(t,e){return Et.current.useInsertionEffect(t,e)};ye.useLayoutEffect=function(t,e){return Et.current.useLayoutEffect(t,e)};ye.useMemo=function(t,e){return Et.current.useMemo(t,e)};ye.useReducer=function(t,e,r){return Et.current.useReducer(t,e,r)};ye.useRef=function(t){return Et.current.useRef(t)};ye.useState=function(t){return Et.current.useState(t)};ye.useSyncExternalStore=function(t,e,r){return Et.current.useSyncExternalStore(t,e,r)};ye.useTransition=function(){return Et.current.useTransition()};ye.version="18.3.1";Iy.exports=ye;var b=Iy.exports;const Oy=Mf(b),xw=ew({__proto__:null,default:Oy},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yw=b,vw=Symbol.for("react.element"),_w=Symbol.for("react.fragment"),ww=Object.prototype.hasOwnProperty,Sw=yw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bw={key:!0,ref:!0,__self:!0,__source:!0};function Uy(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)ww.call(e,n)&&!bw.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:vw,type:t,key:s,ref:o,props:i,_owner:Sw.current}}Pc.Fragment=_w;Pc.jsx=Uy;Pc.jsxs=Uy;Py.exports=Pc;var c=Py.exports,Dh={},zy={exports:{}},$t={},Gy={exports:{}},Hy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,N){var R=j.length;j.push(N);e:for(;0<R;){var C=R-1>>>1,B=j[C];if(0<i(B,N))j[C]=N,j[R]=B,R=C;else break e}}function r(j){return j.length===0?null:j[0]}function n(j){if(j.length===0)return null;var N=j[0],R=j.pop();if(R!==N){j[0]=R;e:for(var C=0,B=j.length,$=B>>>1;C<$;){var V=2*(C+1)-1,ie=j[V],ae=V+1,Q=j[ae];if(0>i(ie,R))ae<B&&0>i(Q,ie)?(j[C]=Q,j[ae]=R,C=ae):(j[C]=ie,j[V]=R,C=V);else if(ae<B&&0>i(Q,R))j[C]=Q,j[ae]=R,C=ae;else break e}}return N}function i(j,N){var R=j.sortIndex-N.sortIndex;return R!==0?R:j.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,d=null,f=3,p=!1,m=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(j){for(var N=r(u);N!==null;){if(N.callback===null)n(u);else if(N.startTime<=j)n(u),N.sortIndex=N.expirationTime,e(l,N);else break;N=r(u)}}function w(j){if(v=!1,g(j),!m)if(r(l)!==null)m=!0,O(S);else{var N=r(u);N!==null&&M(w,N.startTime-j)}}function S(j,N){m=!1,v&&(v=!1,x(E),E=-1),p=!0;var R=f;try{for(g(N),d=r(l);d!==null&&(!(d.expirationTime>N)||j&&!L());){var C=d.callback;if(typeof C=="function"){d.callback=null,f=d.priorityLevel;var B=C(d.expirationTime<=N);N=t.unstable_now(),typeof B=="function"?d.callback=B:d===r(l)&&n(l),g(N)}else n(l);d=r(l)}if(d!==null)var $=!0;else{var V=r(u);V!==null&&M(w,V.startTime-N),$=!1}return $}finally{d=null,f=R,p=!1}}var T=!1,A=null,E=-1,k=5,F=-1;function L(){return!(t.unstable_now()-F<k)}function U(){if(A!==null){var j=t.unstable_now();F=j;var N=!0;try{N=A(!0,j)}finally{N?P():(T=!1,A=null)}}else T=!1}var P;if(typeof y=="function")P=function(){y(U)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,D=I.port2;I.port1.onmessage=U,P=function(){D.postMessage(null)}}else P=function(){_(U,0)};function O(j){A=j,T||(T=!0,P())}function M(j,N){E=_(function(){j(t.unstable_now())},N)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,O(S))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(j){switch(f){case 1:case 2:case 3:var N=3;break;default:N=f}var R=f;f=N;try{return j()}finally{f=R}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,N){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var R=f;f=j;try{return N()}finally{f=R}},t.unstable_scheduleCallback=function(j,N,R){var C=t.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?C+R:C):R=C,j){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=R+B,j={id:h++,callback:N,priorityLevel:j,startTime:R,expirationTime:B,sortIndex:-1},R>C?(j.sortIndex=R,e(u,j),r(l)===null&&j===r(u)&&(v?(x(E),E=-1):v=!0,M(w,R-C))):(j.sortIndex=B,e(l,j),m||p||(m=!0,O(S))),j},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(j){var N=f;return function(){var R=f;f=N;try{return j.apply(this,arguments)}finally{f=R}}}})(Hy);Gy.exports=Hy;var Ew=Gy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tw=b,Wt=Ew;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wy=new Set,Lo={};function Ii(t,e){Ms(t,e),Ms(t+"Capture",e)}function Ms(t,e){for(Lo[t]=e,t=0;t<e.length;t++)Wy.add(e[t])}var nn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oh=Object.prototype.hasOwnProperty,Aw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,am={},lm={};function Cw(t){return Oh.call(lm,t)?!0:Oh.call(am,t)?!1:Aw.test(t)?lm[t]=!0:(am[t]=!0,!1)}function Rw(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Pw(t,e,r,n){if(e===null||typeof e>"u"||Rw(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Tt(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dt[t]=new Tt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dt[e]=new Tt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dt[t]=new Tt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dt[t]=new Tt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dt[t]=new Tt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dt[t]=new Tt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dt[t]=new Tt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dt[t]=new Tt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dt[t]=new Tt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Lf=/[\-:]([a-z])/g;function Df(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Lf,Df);dt[e]=new Tt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Lf,Df);dt[e]=new Tt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Lf,Df);dt[e]=new Tt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dt[t]=new Tt(t,1,!1,t.toLowerCase(),null,!1,!1)});dt.xlinkHref=new Tt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dt[t]=new Tt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Of(t,e,r,n){var i=dt.hasOwnProperty(e)?dt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Pw(e,r,i,n)&&(r=null),n||i===null?Cw(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var un=Tw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ca=Symbol.for("react.element"),is=Symbol.for("react.portal"),ss=Symbol.for("react.fragment"),Uf=Symbol.for("react.strict_mode"),Uh=Symbol.for("react.profiler"),$y=Symbol.for("react.provider"),Vy=Symbol.for("react.context"),zf=Symbol.for("react.forward_ref"),zh=Symbol.for("react.suspense"),Gh=Symbol.for("react.suspense_list"),Gf=Symbol.for("react.memo"),wn=Symbol.for("react.lazy"),Xy=Symbol.for("react.offscreen"),cm=Symbol.iterator;function qs(t){return t===null||typeof t!="object"?null:(t=cm&&t[cm]||t["@@iterator"],typeof t=="function"?t:null)}var Ge=Object.assign,gu;function co(t){if(gu===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);gu=e&&e[1]||""}return`
`+gu+t}var xu=!1;function yu(t,e){if(!t||xu)return"";xu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{xu=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?co(t):""}function Iw(t){switch(t.tag){case 5:return co(t.type);case 16:return co("Lazy");case 13:return co("Suspense");case 19:return co("SuspenseList");case 0:case 2:case 15:return t=yu(t.type,!1),t;case 11:return t=yu(t.type.render,!1),t;case 1:return t=yu(t.type,!0),t;default:return""}}function Hh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ss:return"Fragment";case is:return"Portal";case Uh:return"Profiler";case Uf:return"StrictMode";case zh:return"Suspense";case Gh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vy:return(t.displayName||"Context")+".Consumer";case $y:return(t._context.displayName||"Context")+".Provider";case zf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Gf:return e=t.displayName||null,e!==null?e:Hh(t.type)||"Memo";case wn:e=t._payload,t=t._init;try{return Hh(t(e))}catch{}}return null}function kw(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hh(e);case 8:return e===Uf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Yy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Mw(t){var e=Yy(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ra(t){t._valueTracker||(t._valueTracker=Mw(t))}function Ky(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Yy(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Dl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Wh(t,e){var r=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function um(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Hn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qy(t,e){e=e.checked,e!=null&&Of(t,"checked",e,!1)}function $h(t,e){qy(t,e);var r=Hn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vh(t,e.type,r):e.hasOwnProperty("defaultValue")&&Vh(t,e.type,Hn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function hm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Vh(t,e,r){(e!=="number"||Dl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var uo=Array.isArray;function ys(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Hn(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Xh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function dm(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(H(92));if(uo(r)){if(1<r.length)throw Error(H(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Hn(r)}}function Qy(t,e){var r=Hn(e.value),n=Hn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function fm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Zy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Zy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Pa,Jy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Pa=Pa||document.createElement("div"),Pa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Pa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Do(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var bo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Bw=["Webkit","ms","Moz","O"];Object.keys(bo).forEach(function(t){Bw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bo[e]=bo[t]})});function ev(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||bo.hasOwnProperty(t)&&bo[t]?(""+e).trim():e+"px"}function tv(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=ev(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var jw=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kh(t,e){if(e){if(jw[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function qh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qh=null;function Hf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Zh=null,vs=null,_s=null;function pm(t){if(t=ha(t)){if(typeof Zh!="function")throw Error(H(280));var e=t.stateNode;e&&(e=jc(e),Zh(t.stateNode,t.type,e))}}function rv(t){vs?_s?_s.push(t):_s=[t]:vs=t}function nv(){if(vs){var t=vs,e=_s;if(_s=vs=null,pm(t),e)for(t=0;t<e.length;t++)pm(e[t])}}function iv(t,e){return t(e)}function sv(){}var vu=!1;function ov(t,e,r){if(vu)return t(e,r);vu=!0;try{return iv(t,e,r)}finally{vu=!1,(vs!==null||_s!==null)&&(sv(),nv())}}function Oo(t,e){var r=t.stateNode;if(r===null)return null;var n=jc(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(H(231,e,typeof r));return r}var Jh=!1;if(nn)try{var Qs={};Object.defineProperty(Qs,"passive",{get:function(){Jh=!0}}),window.addEventListener("test",Qs,Qs),window.removeEventListener("test",Qs,Qs)}catch{Jh=!1}function Nw(t,e,r,n,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(h){this.onError(h)}}var Eo=!1,Ol=null,Ul=!1,ed=null,Fw={onError:function(t){Eo=!0,Ol=t}};function Lw(t,e,r,n,i,s,o,a,l){Eo=!1,Ol=null,Nw.apply(Fw,arguments)}function Dw(t,e,r,n,i,s,o,a,l){if(Lw.apply(this,arguments),Eo){if(Eo){var u=Ol;Eo=!1,Ol=null}else throw Error(H(198));Ul||(Ul=!0,ed=u)}}function ki(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function av(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function mm(t){if(ki(t)!==t)throw Error(H(188))}function Ow(t){var e=t.alternate;if(!e){if(e=ki(t),e===null)throw Error(H(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return mm(i),t;if(s===n)return mm(i),e;s=s.sibling}throw Error(H(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(H(189))}}if(r.alternate!==n)throw Error(H(190))}if(r.tag!==3)throw Error(H(188));return r.stateNode.current===r?t:e}function lv(t){return t=Ow(t),t!==null?cv(t):null}function cv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=cv(t);if(e!==null)return e;t=t.sibling}return null}var uv=Wt.unstable_scheduleCallback,gm=Wt.unstable_cancelCallback,Uw=Wt.unstable_shouldYield,zw=Wt.unstable_requestPaint,Ke=Wt.unstable_now,Gw=Wt.unstable_getCurrentPriorityLevel,Wf=Wt.unstable_ImmediatePriority,hv=Wt.unstable_UserBlockingPriority,zl=Wt.unstable_NormalPriority,Hw=Wt.unstable_LowPriority,dv=Wt.unstable_IdlePriority,Ic=null,Fr=null;function Ww(t){if(Fr&&typeof Fr.onCommitFiberRoot=="function")try{Fr.onCommitFiberRoot(Ic,t,void 0,(t.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:Xw,$w=Math.log,Vw=Math.LN2;function Xw(t){return t>>>=0,t===0?32:31-($w(t)/Vw|0)|0}var Ia=64,ka=4194304;function ho(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gl(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=ho(a):(s&=o,s!==0&&(n=ho(s)))}else o=r&~i,o!==0?n=ho(o):s!==0&&(n=ho(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-mr(e),i=1<<r,n|=t[r],e&=~i;return n}function Yw(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kw(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-mr(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=Yw(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function td(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fv(){var t=Ia;return Ia<<=1,!(Ia&4194240)&&(Ia=64),t}function _u(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ca(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mr(e),t[e]=r}function qw(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-mr(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function $f(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-mr(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Re=0;function pv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var mv,Vf,gv,xv,yv,rd=!1,Ma=[],Bn=null,jn=null,Nn=null,Uo=new Map,zo=new Map,En=[],Qw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xm(t,e){switch(t){case"focusin":case"focusout":Bn=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Nn=null;break;case"pointerover":case"pointerout":Uo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zo.delete(e.pointerId)}}function Zs(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ha(e),e!==null&&Vf(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Zw(t,e,r,n,i){switch(e){case"focusin":return Bn=Zs(Bn,t,e,r,n,i),!0;case"dragenter":return jn=Zs(jn,t,e,r,n,i),!0;case"mouseover":return Nn=Zs(Nn,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Uo.set(s,Zs(Uo.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,zo.set(s,Zs(zo.get(s)||null,t,e,r,n,i)),!0}return!1}function vv(t){var e=fi(t.target);if(e!==null){var r=ki(e);if(r!==null){if(e=r.tag,e===13){if(e=av(r),e!==null){t.blockedOn=e,yv(t.priority,function(){gv(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=nd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Qh=n,r.target.dispatchEvent(n),Qh=null}else return e=ha(r),e!==null&&Vf(e),t.blockedOn=r,!1;e.shift()}return!0}function ym(t,e,r){gl(t)&&r.delete(e)}function Jw(){rd=!1,Bn!==null&&gl(Bn)&&(Bn=null),jn!==null&&gl(jn)&&(jn=null),Nn!==null&&gl(Nn)&&(Nn=null),Uo.forEach(ym),zo.forEach(ym)}function Js(t,e){t.blockedOn===e&&(t.blockedOn=null,rd||(rd=!0,Wt.unstable_scheduleCallback(Wt.unstable_NormalPriority,Jw)))}function Go(t){function e(i){return Js(i,t)}if(0<Ma.length){Js(Ma[0],t);for(var r=1;r<Ma.length;r++){var n=Ma[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Bn!==null&&Js(Bn,t),jn!==null&&Js(jn,t),Nn!==null&&Js(Nn,t),Uo.forEach(e),zo.forEach(e),r=0;r<En.length;r++)n=En[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<En.length&&(r=En[0],r.blockedOn===null);)vv(r),r.blockedOn===null&&En.shift()}var ws=un.ReactCurrentBatchConfig,Hl=!0;function eS(t,e,r,n){var i=Re,s=ws.transition;ws.transition=null;try{Re=1,Xf(t,e,r,n)}finally{Re=i,ws.transition=s}}function tS(t,e,r,n){var i=Re,s=ws.transition;ws.transition=null;try{Re=4,Xf(t,e,r,n)}finally{Re=i,ws.transition=s}}function Xf(t,e,r,n){if(Hl){var i=nd(t,e,r,n);if(i===null)Iu(t,e,n,Wl,r),xm(t,n);else if(Zw(i,t,e,r,n))n.stopPropagation();else if(xm(t,n),e&4&&-1<Qw.indexOf(t)){for(;i!==null;){var s=ha(i);if(s!==null&&mv(s),s=nd(t,e,r,n),s===null&&Iu(t,e,n,Wl,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Iu(t,e,n,null,r)}}var Wl=null;function nd(t,e,r,n){if(Wl=null,t=Hf(n),t=fi(t),t!==null)if(e=ki(t),e===null)t=null;else if(r=e.tag,r===13){if(t=av(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Wl=t,null}function _v(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gw()){case Wf:return 1;case hv:return 4;case zl:case Hw:return 16;case dv:return 536870912;default:return 16}default:return 16}}var Cn=null,Yf=null,xl=null;function wv(){if(xl)return xl;var t,e=Yf,r=e.length,n,i="value"in Cn?Cn.value:Cn.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return xl=i.slice(t,1<n?1-n:void 0)}function yl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ba(){return!0}function vm(){return!1}function Vt(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ba:vm,this.isPropagationStopped=vm,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),e}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kf=Vt(Hs),ua=Ge({},Hs,{view:0,detail:0}),rS=Vt(ua),wu,Su,eo,kc=Ge({},ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==eo&&(eo&&t.type==="mousemove"?(wu=t.screenX-eo.screenX,Su=t.screenY-eo.screenY):Su=wu=0,eo=t),wu)},movementY:function(t){return"movementY"in t?t.movementY:Su}}),_m=Vt(kc),nS=Ge({},kc,{dataTransfer:0}),iS=Vt(nS),sS=Ge({},ua,{relatedTarget:0}),bu=Vt(sS),oS=Ge({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),aS=Vt(oS),lS=Ge({},Hs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cS=Vt(lS),uS=Ge({},Hs,{data:0}),wm=Vt(uS),hS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=fS[t])?!!e[t]:!1}function qf(){return pS}var mS=Ge({},ua,{key:function(t){if(t.key){var e=hS[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?dS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qf,charCode:function(t){return t.type==="keypress"?yl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gS=Vt(mS),xS=Ge({},kc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sm=Vt(xS),yS=Ge({},ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qf}),vS=Vt(yS),_S=Ge({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),wS=Vt(_S),SS=Ge({},kc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),bS=Vt(SS),ES=[9,13,27,32],Qf=nn&&"CompositionEvent"in window,To=null;nn&&"documentMode"in document&&(To=document.documentMode);var TS=nn&&"TextEvent"in window&&!To,Sv=nn&&(!Qf||To&&8<To&&11>=To),bm=" ",Em=!1;function bv(t,e){switch(t){case"keyup":return ES.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ev(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var os=!1;function AS(t,e){switch(t){case"compositionend":return Ev(e);case"keypress":return e.which!==32?null:(Em=!0,bm);case"textInput":return t=e.data,t===bm&&Em?null:t;default:return null}}function CS(t,e){if(os)return t==="compositionend"||!Qf&&bv(t,e)?(t=wv(),xl=Yf=Cn=null,os=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Sv&&e.locale!=="ko"?null:e.data;default:return null}}var RS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!RS[t.type]:e==="textarea"}function Tv(t,e,r,n){rv(n),e=$l(e,"onChange"),0<e.length&&(r=new Kf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ao=null,Ho=null;function PS(t){Fv(t,0)}function Mc(t){var e=cs(t);if(Ky(e))return t}function IS(t,e){if(t==="change")return e}var Av=!1;if(nn){var Eu;if(nn){var Tu="oninput"in document;if(!Tu){var Am=document.createElement("div");Am.setAttribute("oninput","return;"),Tu=typeof Am.oninput=="function"}Eu=Tu}else Eu=!1;Av=Eu&&(!document.documentMode||9<document.documentMode)}function Cm(){Ao&&(Ao.detachEvent("onpropertychange",Cv),Ho=Ao=null)}function Cv(t){if(t.propertyName==="value"&&Mc(Ho)){var e=[];Tv(e,Ho,t,Hf(t)),ov(PS,e)}}function kS(t,e,r){t==="focusin"?(Cm(),Ao=e,Ho=r,Ao.attachEvent("onpropertychange",Cv)):t==="focusout"&&Cm()}function MS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Mc(Ho)}function BS(t,e){if(t==="click")return Mc(e)}function jS(t,e){if(t==="input"||t==="change")return Mc(e)}function NS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vr=typeof Object.is=="function"?Object.is:NS;function Wo(t,e){if(vr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Oh.call(e,i)||!vr(t[i],e[i]))return!1}return!0}function Rm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Pm(t,e){var r=Rm(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Rm(r)}}function Rv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Rv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Pv(){for(var t=window,e=Dl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Dl(t.document)}return e}function Zf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function FS(t){var e=Pv(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Rv(r.ownerDocument.documentElement,r)){if(n!==null&&Zf(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Pm(r,s);var o=Pm(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var LS=nn&&"documentMode"in document&&11>=document.documentMode,as=null,id=null,Co=null,sd=!1;function Im(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;sd||as==null||as!==Dl(n)||(n=as,"selectionStart"in n&&Zf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Co&&Wo(Co,n)||(Co=n,n=$l(id,"onSelect"),0<n.length&&(e=new Kf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=as)))}function ja(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ls={animationend:ja("Animation","AnimationEnd"),animationiteration:ja("Animation","AnimationIteration"),animationstart:ja("Animation","AnimationStart"),transitionend:ja("Transition","TransitionEnd")},Au={},Iv={};nn&&(Iv=document.createElement("div").style,"AnimationEvent"in window||(delete ls.animationend.animation,delete ls.animationiteration.animation,delete ls.animationstart.animation),"TransitionEvent"in window||delete ls.transitionend.transition);function Bc(t){if(Au[t])return Au[t];if(!ls[t])return t;var e=ls[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Iv)return Au[t]=e[r];return t}var kv=Bc("animationend"),Mv=Bc("animationiteration"),Bv=Bc("animationstart"),jv=Bc("transitionend"),Nv=new Map,km="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yn(t,e){Nv.set(t,e),Ii(e,[t])}for(var Cu=0;Cu<km.length;Cu++){var Ru=km[Cu],DS=Ru.toLowerCase(),OS=Ru[0].toUpperCase()+Ru.slice(1);Yn(DS,"on"+OS)}Yn(kv,"onAnimationEnd");Yn(Mv,"onAnimationIteration");Yn(Bv,"onAnimationStart");Yn("dblclick","onDoubleClick");Yn("focusin","onFocus");Yn("focusout","onBlur");Yn(jv,"onTransitionEnd");Ms("onMouseEnter",["mouseout","mouseover"]);Ms("onMouseLeave",["mouseout","mouseover"]);Ms("onPointerEnter",["pointerout","pointerover"]);Ms("onPointerLeave",["pointerout","pointerover"]);Ii("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ii("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ii("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ii("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ii("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ii("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),US=new Set("cancel close invalid load scroll toggle".split(" ").concat(fo));function Mm(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Dw(n,e,void 0,t),t.currentTarget=null}function Fv(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Mm(i,a,u),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Mm(i,a,u),s=l}}}if(Ul)throw t=ed,Ul=!1,ed=null,t}function Be(t,e){var r=e[ud];r===void 0&&(r=e[ud]=new Set);var n=t+"__bubble";r.has(n)||(Lv(e,t,2,!1),r.add(n))}function Pu(t,e,r){var n=0;e&&(n|=4),Lv(r,t,n,e)}var Na="_reactListening"+Math.random().toString(36).slice(2);function $o(t){if(!t[Na]){t[Na]=!0,Wy.forEach(function(r){r!=="selectionchange"&&(US.has(r)||Pu(r,!1,t),Pu(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Na]||(e[Na]=!0,Pu("selectionchange",!1,e))}}function Lv(t,e,r,n){switch(_v(e)){case 1:var i=eS;break;case 4:i=tS;break;default:i=Xf}r=i.bind(null,e,r,t),i=void 0,!Jh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Iu(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=fi(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}ov(function(){var u=s,h=Hf(r),d=[];e:{var f=Nv.get(t);if(f!==void 0){var p=Kf,m=t;switch(t){case"keypress":if(yl(r)===0)break e;case"keydown":case"keyup":p=gS;break;case"focusin":m="focus",p=bu;break;case"focusout":m="blur",p=bu;break;case"beforeblur":case"afterblur":p=bu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=_m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=iS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=vS;break;case kv:case Mv:case Bv:p=aS;break;case jv:p=wS;break;case"scroll":p=rS;break;case"wheel":p=bS;break;case"copy":case"cut":case"paste":p=cS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Sm}var v=(e&4)!==0,_=!v&&t==="scroll",x=v?f!==null?f+"Capture":null:f;v=[];for(var y=u,g;y!==null;){g=y;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,x!==null&&(w=Oo(y,x),w!=null&&v.push(Vo(y,w,g)))),_)break;y=y.return}0<v.length&&(f=new p(f,m,null,r,h),d.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&r!==Qh&&(m=r.relatedTarget||r.fromElement)&&(fi(m)||m[sn]))break e;if((p||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?fi(m):null,m!==null&&(_=ki(m),m!==_||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(v=_m,w="onMouseLeave",x="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(v=Sm,w="onPointerLeave",x="onPointerEnter",y="pointer"),_=p==null?f:cs(p),g=m==null?f:cs(m),f=new v(w,y+"leave",p,r,h),f.target=_,f.relatedTarget=g,w=null,fi(h)===u&&(v=new v(x,y+"enter",m,r,h),v.target=g,v.relatedTarget=_,w=v),_=w,p&&m)t:{for(v=p,x=m,y=0,g=v;g;g=Ui(g))y++;for(g=0,w=x;w;w=Ui(w))g++;for(;0<y-g;)v=Ui(v),y--;for(;0<g-y;)x=Ui(x),g--;for(;y--;){if(v===x||x!==null&&v===x.alternate)break t;v=Ui(v),x=Ui(x)}v=null}else v=null;p!==null&&Bm(d,f,p,v,!1),m!==null&&_!==null&&Bm(d,_,m,v,!0)}}e:{if(f=u?cs(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var S=IS;else if(Tm(f))if(Av)S=jS;else{S=MS;var T=kS}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=BS);if(S&&(S=S(t,u))){Tv(d,S,r,h);break e}T&&T(t,f,u),t==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&Vh(f,"number",f.value)}switch(T=u?cs(u):window,t){case"focusin":(Tm(T)||T.contentEditable==="true")&&(as=T,id=u,Co=null);break;case"focusout":Co=id=as=null;break;case"mousedown":sd=!0;break;case"contextmenu":case"mouseup":case"dragend":sd=!1,Im(d,r,h);break;case"selectionchange":if(LS)break;case"keydown":case"keyup":Im(d,r,h)}var A;if(Qf)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else os?bv(t,r)&&(E="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(Sv&&r.locale!=="ko"&&(os||E!=="onCompositionStart"?E==="onCompositionEnd"&&os&&(A=wv()):(Cn=h,Yf="value"in Cn?Cn.value:Cn.textContent,os=!0)),T=$l(u,E),0<T.length&&(E=new wm(E,t,null,r,h),d.push({event:E,listeners:T}),A?E.data=A:(A=Ev(r),A!==null&&(E.data=A)))),(A=TS?AS(t,r):CS(t,r))&&(u=$l(u,"onBeforeInput"),0<u.length&&(h=new wm("onBeforeInput","beforeinput",null,r,h),d.push({event:h,listeners:u}),h.data=A))}Fv(d,e)})}function Vo(t,e,r){return{instance:t,listener:e,currentTarget:r}}function $l(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Oo(t,r),s!=null&&n.unshift(Vo(t,s,i)),s=Oo(t,e),s!=null&&n.push(Vo(t,s,i))),t=t.return}return n}function Ui(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Bm(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,u=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&u!==null&&(a=u,i?(l=Oo(r,s),l!=null&&o.unshift(Vo(r,l,a))):i||(l=Oo(r,s),l!=null&&o.push(Vo(r,l,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var zS=/\r\n?/g,GS=/\u0000|\uFFFD/g;function jm(t){return(typeof t=="string"?t:""+t).replace(zS,`
`).replace(GS,"")}function Fa(t,e,r){if(e=jm(e),jm(t)!==e&&r)throw Error(H(425))}function Vl(){}var od=null,ad=null;function ld(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cd=typeof setTimeout=="function"?setTimeout:void 0,HS=typeof clearTimeout=="function"?clearTimeout:void 0,Nm=typeof Promise=="function"?Promise:void 0,WS=typeof queueMicrotask=="function"?queueMicrotask:typeof Nm<"u"?function(t){return Nm.resolve(null).then(t).catch($S)}:cd;function $S(t){setTimeout(function(){throw t})}function ku(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Go(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Go(e)}function Fn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Fm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ws=Math.random().toString(36).slice(2),jr="__reactFiber$"+Ws,Xo="__reactProps$"+Ws,sn="__reactContainer$"+Ws,ud="__reactEvents$"+Ws,VS="__reactListeners$"+Ws,XS="__reactHandles$"+Ws;function fi(t){var e=t[jr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[sn]||r[jr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Fm(t);t!==null;){if(r=t[jr])return r;t=Fm(t)}return e}t=r,r=t.parentNode}return null}function ha(t){return t=t[jr]||t[sn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function cs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function jc(t){return t[Xo]||null}var hd=[],us=-1;function Kn(t){return{current:t}}function Ne(t){0>us||(t.current=hd[us],hd[us]=null,us--)}function ke(t,e){us++,hd[us]=t.current,t.current=e}var Wn={},vt=Kn(Wn),jt=Kn(!1),wi=Wn;function Bs(t,e){var r=t.type.contextTypes;if(!r)return Wn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Nt(t){return t=t.childContextTypes,t!=null}function Xl(){Ne(jt),Ne(vt)}function Lm(t,e,r){if(vt.current!==Wn)throw Error(H(168));ke(vt,e),ke(jt,r)}function Dv(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(H(108,kw(t)||"Unknown",i));return Ge({},r,n)}function Yl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Wn,wi=vt.current,ke(vt,t),ke(jt,jt.current),!0}function Dm(t,e,r){var n=t.stateNode;if(!n)throw Error(H(169));r?(t=Dv(t,e,wi),n.__reactInternalMemoizedMergedChildContext=t,Ne(jt),Ne(vt),ke(vt,t)):Ne(jt),ke(jt,r)}var Yr=null,Nc=!1,Mu=!1;function Ov(t){Yr===null?Yr=[t]:Yr.push(t)}function YS(t){Nc=!0,Ov(t)}function qn(){if(!Mu&&Yr!==null){Mu=!0;var t=0,e=Re;try{var r=Yr;for(Re=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Yr=null,Nc=!1}catch(i){throw Yr!==null&&(Yr=Yr.slice(t+1)),uv(Wf,qn),i}finally{Re=e,Mu=!1}}return null}var hs=[],ds=0,Kl=null,ql=0,qt=[],Qt=0,Si=null,Kr=1,qr="";function ni(t,e){hs[ds++]=ql,hs[ds++]=Kl,Kl=t,ql=e}function Uv(t,e,r){qt[Qt++]=Kr,qt[Qt++]=qr,qt[Qt++]=Si,Si=t;var n=Kr;t=qr;var i=32-mr(n)-1;n&=~(1<<i),r+=1;var s=32-mr(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Kr=1<<32-mr(e)+i|r<<i|n,qr=s+t}else Kr=1<<s|r<<i|n,qr=t}function Jf(t){t.return!==null&&(ni(t,1),Uv(t,1,0))}function ep(t){for(;t===Kl;)Kl=hs[--ds],hs[ds]=null,ql=hs[--ds],hs[ds]=null;for(;t===Si;)Si=qt[--Qt],qt[Qt]=null,qr=qt[--Qt],qt[Qt]=null,Kr=qt[--Qt],qt[Qt]=null}var Ht=null,Ut=null,Le=!1,fr=null;function zv(t,e){var r=Zt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Om(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ht=t,Ut=Fn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ht=t,Ut=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Si!==null?{id:Kr,overflow:qr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Zt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Ht=t,Ut=null,!0):!1;default:return!1}}function dd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fd(t){if(Le){var e=Ut;if(e){var r=e;if(!Om(t,e)){if(dd(t))throw Error(H(418));e=Fn(r.nextSibling);var n=Ht;e&&Om(t,e)?zv(n,r):(t.flags=t.flags&-4097|2,Le=!1,Ht=t)}}else{if(dd(t))throw Error(H(418));t.flags=t.flags&-4097|2,Le=!1,Ht=t}}}function Um(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ht=t}function La(t){if(t!==Ht)return!1;if(!Le)return Um(t),Le=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ld(t.type,t.memoizedProps)),e&&(e=Ut)){if(dd(t))throw Gv(),Error(H(418));for(;e;)zv(t,e),e=Fn(e.nextSibling)}if(Um(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ut=Fn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ut=null}}else Ut=Ht?Fn(t.stateNode.nextSibling):null;return!0}function Gv(){for(var t=Ut;t;)t=Fn(t.nextSibling)}function js(){Ut=Ht=null,Le=!1}function tp(t){fr===null?fr=[t]:fr.push(t)}var KS=un.ReactCurrentBatchConfig;function to(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(H(309));var n=r.stateNode}if(!n)throw Error(H(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(H(284));if(!r._owner)throw Error(H(290,t))}return t}function Da(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function zm(t){var e=t._init;return e(t._payload)}function Hv(t){function e(x,y){if(t){var g=x.deletions;g===null?(x.deletions=[y],x.flags|=16):g.push(y)}}function r(x,y){if(!t)return null;for(;y!==null;)e(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function i(x,y){return x=Un(x,y),x.index=0,x.sibling=null,x}function s(x,y,g){return x.index=g,t?(g=x.alternate,g!==null?(g=g.index,g<y?(x.flags|=2,y):g):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,y,g,w){return y===null||y.tag!==6?(y=Ou(g,x.mode,w),y.return=x,y):(y=i(y,g),y.return=x,y)}function l(x,y,g,w){var S=g.type;return S===ss?h(x,y,g.props.children,w,g.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===wn&&zm(S)===y.type)?(w=i(y,g.props),w.ref=to(x,y,g),w.return=x,w):(w=Tl(g.type,g.key,g.props,null,x.mode,w),w.ref=to(x,y,g),w.return=x,w)}function u(x,y,g,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=Uu(g,x.mode,w),y.return=x,y):(y=i(y,g.children||[]),y.return=x,y)}function h(x,y,g,w,S){return y===null||y.tag!==7?(y=xi(g,x.mode,w,S),y.return=x,y):(y=i(y,g),y.return=x,y)}function d(x,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Ou(""+y,x.mode,g),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ca:return g=Tl(y.type,y.key,y.props,null,x.mode,g),g.ref=to(x,null,y),g.return=x,g;case is:return y=Uu(y,x.mode,g),y.return=x,y;case wn:var w=y._init;return d(x,w(y._payload),g)}if(uo(y)||qs(y))return y=xi(y,x.mode,g,null),y.return=x,y;Da(x,y)}return null}function f(x,y,g,w){var S=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return S!==null?null:a(x,y,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ca:return g.key===S?l(x,y,g,w):null;case is:return g.key===S?u(x,y,g,w):null;case wn:return S=g._init,f(x,y,S(g._payload),w)}if(uo(g)||qs(g))return S!==null?null:h(x,y,g,w,null);Da(x,g)}return null}function p(x,y,g,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(g)||null,a(y,x,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ca:return x=x.get(w.key===null?g:w.key)||null,l(y,x,w,S);case is:return x=x.get(w.key===null?g:w.key)||null,u(y,x,w,S);case wn:var T=w._init;return p(x,y,g,T(w._payload),S)}if(uo(w)||qs(w))return x=x.get(g)||null,h(y,x,w,S,null);Da(y,w)}return null}function m(x,y,g,w){for(var S=null,T=null,A=y,E=y=0,k=null;A!==null&&E<g.length;E++){A.index>E?(k=A,A=null):k=A.sibling;var F=f(x,A,g[E],w);if(F===null){A===null&&(A=k);break}t&&A&&F.alternate===null&&e(x,A),y=s(F,y,E),T===null?S=F:T.sibling=F,T=F,A=k}if(E===g.length)return r(x,A),Le&&ni(x,E),S;if(A===null){for(;E<g.length;E++)A=d(x,g[E],w),A!==null&&(y=s(A,y,E),T===null?S=A:T.sibling=A,T=A);return Le&&ni(x,E),S}for(A=n(x,A);E<g.length;E++)k=p(A,x,E,g[E],w),k!==null&&(t&&k.alternate!==null&&A.delete(k.key===null?E:k.key),y=s(k,y,E),T===null?S=k:T.sibling=k,T=k);return t&&A.forEach(function(L){return e(x,L)}),Le&&ni(x,E),S}function v(x,y,g,w){var S=qs(g);if(typeof S!="function")throw Error(H(150));if(g=S.call(g),g==null)throw Error(H(151));for(var T=S=null,A=y,E=y=0,k=null,F=g.next();A!==null&&!F.done;E++,F=g.next()){A.index>E?(k=A,A=null):k=A.sibling;var L=f(x,A,F.value,w);if(L===null){A===null&&(A=k);break}t&&A&&L.alternate===null&&e(x,A),y=s(L,y,E),T===null?S=L:T.sibling=L,T=L,A=k}if(F.done)return r(x,A),Le&&ni(x,E),S;if(A===null){for(;!F.done;E++,F=g.next())F=d(x,F.value,w),F!==null&&(y=s(F,y,E),T===null?S=F:T.sibling=F,T=F);return Le&&ni(x,E),S}for(A=n(x,A);!F.done;E++,F=g.next())F=p(A,x,E,F.value,w),F!==null&&(t&&F.alternate!==null&&A.delete(F.key===null?E:F.key),y=s(F,y,E),T===null?S=F:T.sibling=F,T=F);return t&&A.forEach(function(U){return e(x,U)}),Le&&ni(x,E),S}function _(x,y,g,w){if(typeof g=="object"&&g!==null&&g.type===ss&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Ca:e:{for(var S=g.key,T=y;T!==null;){if(T.key===S){if(S=g.type,S===ss){if(T.tag===7){r(x,T.sibling),y=i(T,g.props.children),y.return=x,x=y;break e}}else if(T.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===wn&&zm(S)===T.type){r(x,T.sibling),y=i(T,g.props),y.ref=to(x,T,g),y.return=x,x=y;break e}r(x,T);break}else e(x,T);T=T.sibling}g.type===ss?(y=xi(g.props.children,x.mode,w,g.key),y.return=x,x=y):(w=Tl(g.type,g.key,g.props,null,x.mode,w),w.ref=to(x,y,g),w.return=x,x=w)}return o(x);case is:e:{for(T=g.key;y!==null;){if(y.key===T)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){r(x,y.sibling),y=i(y,g.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else e(x,y);y=y.sibling}y=Uu(g,x.mode,w),y.return=x,x=y}return o(x);case wn:return T=g._init,_(x,y,T(g._payload),w)}if(uo(g))return m(x,y,g,w);if(qs(g))return v(x,y,g,w);Da(x,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(r(x,y.sibling),y=i(y,g),y.return=x,x=y):(r(x,y),y=Ou(g,x.mode,w),y.return=x,x=y),o(x)):r(x,y)}return _}var Ns=Hv(!0),Wv=Hv(!1),Ql=Kn(null),Zl=null,fs=null,rp=null;function np(){rp=fs=Zl=null}function ip(t){var e=Ql.current;Ne(Ql),t._currentValue=e}function pd(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Ss(t,e){Zl=t,rp=fs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(kt=!0),t.firstContext=null)}function rr(t){var e=t._currentValue;if(rp!==t)if(t={context:t,memoizedValue:e,next:null},fs===null){if(Zl===null)throw Error(H(308));fs=t,Zl.dependencies={lanes:0,firstContext:t}}else fs=fs.next=t;return e}var pi=null;function sp(t){pi===null?pi=[t]:pi.push(t)}function $v(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,sp(e)):(r.next=i.next,i.next=r),e.interleaved=r,on(t,n)}function on(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Sn=!1;function op(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function tn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ln(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,be&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,on(t,r)}return i=n.interleaved,i===null?(e.next=e,sp(n)):(e.next=i.next,i.next=e),n.interleaved=e,on(t,r)}function vl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,$f(t,r)}}function Gm(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Jl(t,e,r,n){var i=t.updateQueue;Sn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,h=u=l=null,a=s;do{var f=a.lane,p=a.eventTime;if((n&f)===f){h!==null&&(h=h.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,v=a;switch(f=e,p=r,v.tag){case 1:if(m=v.payload,typeof m=="function"){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,f=typeof m=="function"?m.call(p,d,f):m,f==null)break e;d=Ge({},d,f);break e;case 2:Sn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=p,l=d):h=h.next=p,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(h===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ei|=o,t.lanes=o,t.memoizedState=d}}function Hm(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(H(191,i));i.call(n)}}}var da={},Lr=Kn(da),Yo=Kn(da),Ko=Kn(da);function mi(t){if(t===da)throw Error(H(174));return t}function ap(t,e){switch(ke(Ko,e),ke(Yo,t),ke(Lr,da),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Yh(e,t)}Ne(Lr),ke(Lr,e)}function Fs(){Ne(Lr),Ne(Yo),Ne(Ko)}function Xv(t){mi(Ko.current);var e=mi(Lr.current),r=Yh(e,t.type);e!==r&&(ke(Yo,t),ke(Lr,r))}function lp(t){Yo.current===t&&(Ne(Lr),Ne(Yo))}var Oe=Kn(0);function ec(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bu=[];function cp(){for(var t=0;t<Bu.length;t++)Bu[t]._workInProgressVersionPrimary=null;Bu.length=0}var _l=un.ReactCurrentDispatcher,ju=un.ReactCurrentBatchConfig,bi=0,ze=null,tt=null,it=null,tc=!1,Ro=!1,qo=0,qS=0;function gt(){throw Error(H(321))}function up(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!vr(t[r],e[r]))return!1;return!0}function hp(t,e,r,n,i,s){if(bi=s,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,_l.current=t===null||t.memoizedState===null?eb:tb,t=r(n,i),Ro){s=0;do{if(Ro=!1,qo=0,25<=s)throw Error(H(301));s+=1,it=tt=null,e.updateQueue=null,_l.current=rb,t=r(n,i)}while(Ro)}if(_l.current=rc,e=tt!==null&&tt.next!==null,bi=0,it=tt=ze=null,tc=!1,e)throw Error(H(300));return t}function dp(){var t=qo!==0;return qo=0,t}function Ir(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?ze.memoizedState=it=t:it=it.next=t,it}function nr(){if(tt===null){var t=ze.alternate;t=t!==null?t.memoizedState:null}else t=tt.next;var e=it===null?ze.memoizedState:it.next;if(e!==null)it=e,tt=t;else{if(t===null)throw Error(H(310));tt=t,t={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},it===null?ze.memoizedState=it=t:it=it.next=t}return it}function Qo(t,e){return typeof e=="function"?e(t):e}function Nu(t){var e=nr(),r=e.queue;if(r===null)throw Error(H(311));r.lastRenderedReducer=t;var n=tt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,u=s;do{var h=u.lane;if((bi&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=n):l=l.next=d,ze.lanes|=h,Ei|=h}u=u.next}while(u!==null&&u!==s);l===null?o=n:l.next=a,vr(n,e.memoizedState)||(kt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,ze.lanes|=s,Ei|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Fu(t){var e=nr(),r=e.queue;if(r===null)throw Error(H(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);vr(s,e.memoizedState)||(kt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Yv(){}function Kv(t,e){var r=ze,n=nr(),i=e(),s=!vr(n.memoizedState,i);if(s&&(n.memoizedState=i,kt=!0),n=n.queue,fp(Zv.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||it!==null&&it.memoizedState.tag&1){if(r.flags|=2048,Zo(9,Qv.bind(null,r,n,i,e),void 0,null),ot===null)throw Error(H(349));bi&30||qv(r,e,i)}return i}function qv(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Qv(t,e,r,n){e.value=r,e.getSnapshot=n,Jv(e)&&e0(t)}function Zv(t,e,r){return r(function(){Jv(e)&&e0(t)})}function Jv(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!vr(t,r)}catch{return!0}}function e0(t){var e=on(t,1);e!==null&&gr(e,t,1,-1)}function Wm(t){var e=Ir();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:t},e.queue=t,t=t.dispatch=JS.bind(null,ze,t),[e.memoizedState,t]}function Zo(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function t0(){return nr().memoizedState}function wl(t,e,r,n){var i=Ir();ze.flags|=t,i.memoizedState=Zo(1|e,r,void 0,n===void 0?null:n)}function Fc(t,e,r,n){var i=nr();n=n===void 0?null:n;var s=void 0;if(tt!==null){var o=tt.memoizedState;if(s=o.destroy,n!==null&&up(n,o.deps)){i.memoizedState=Zo(e,r,s,n);return}}ze.flags|=t,i.memoizedState=Zo(1|e,r,s,n)}function $m(t,e){return wl(8390656,8,t,e)}function fp(t,e){return Fc(2048,8,t,e)}function r0(t,e){return Fc(4,2,t,e)}function n0(t,e){return Fc(4,4,t,e)}function i0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function s0(t,e,r){return r=r!=null?r.concat([t]):null,Fc(4,4,i0.bind(null,e,t),r)}function pp(){}function o0(t,e){var r=nr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&up(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function a0(t,e){var r=nr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&up(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function l0(t,e,r){return bi&21?(vr(r,e)||(r=fv(),ze.lanes|=r,Ei|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,kt=!0),t.memoizedState=r)}function QS(t,e){var r=Re;Re=r!==0&&4>r?r:4,t(!0);var n=ju.transition;ju.transition={};try{t(!1),e()}finally{Re=r,ju.transition=n}}function c0(){return nr().memoizedState}function ZS(t,e,r){var n=On(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},u0(t))h0(e,r);else if(r=$v(t,e,r,n),r!==null){var i=bt();gr(r,t,n,i),d0(r,e,n)}}function JS(t,e,r){var n=On(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(u0(t))h0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,vr(a,o)){var l=e.interleaved;l===null?(i.next=i,sp(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=$v(t,e,i,n),r!==null&&(i=bt(),gr(r,t,n,i),d0(r,e,n))}}function u0(t){var e=t.alternate;return t===ze||e!==null&&e===ze}function h0(t,e){Ro=tc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function d0(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,$f(t,r)}}var rc={readContext:rr,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useInsertionEffect:gt,useLayoutEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useMutableSource:gt,useSyncExternalStore:gt,useId:gt,unstable_isNewReconciler:!1},eb={readContext:rr,useCallback:function(t,e){return Ir().memoizedState=[t,e===void 0?null:e],t},useContext:rr,useEffect:$m,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,wl(4194308,4,i0.bind(null,e,t),r)},useLayoutEffect:function(t,e){return wl(4194308,4,t,e)},useInsertionEffect:function(t,e){return wl(4,2,t,e)},useMemo:function(t,e){var r=Ir();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Ir();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=ZS.bind(null,ze,t),[n.memoizedState,t]},useRef:function(t){var e=Ir();return t={current:t},e.memoizedState=t},useState:Wm,useDebugValue:pp,useDeferredValue:function(t){return Ir().memoizedState=t},useTransition:function(){var t=Wm(!1),e=t[0];return t=QS.bind(null,t[1]),Ir().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ze,i=Ir();if(Le){if(r===void 0)throw Error(H(407));r=r()}else{if(r=e(),ot===null)throw Error(H(349));bi&30||qv(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,$m(Zv.bind(null,n,s,t),[t]),n.flags|=2048,Zo(9,Qv.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Ir(),e=ot.identifierPrefix;if(Le){var r=qr,n=Kr;r=(n&~(1<<32-mr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=qo++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=qS++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},tb={readContext:rr,useCallback:o0,useContext:rr,useEffect:fp,useImperativeHandle:s0,useInsertionEffect:r0,useLayoutEffect:n0,useMemo:a0,useReducer:Nu,useRef:t0,useState:function(){return Nu(Qo)},useDebugValue:pp,useDeferredValue:function(t){var e=nr();return l0(e,tt.memoizedState,t)},useTransition:function(){var t=Nu(Qo)[0],e=nr().memoizedState;return[t,e]},useMutableSource:Yv,useSyncExternalStore:Kv,useId:c0,unstable_isNewReconciler:!1},rb={readContext:rr,useCallback:o0,useContext:rr,useEffect:fp,useImperativeHandle:s0,useInsertionEffect:r0,useLayoutEffect:n0,useMemo:a0,useReducer:Fu,useRef:t0,useState:function(){return Fu(Qo)},useDebugValue:pp,useDeferredValue:function(t){var e=nr();return tt===null?e.memoizedState=t:l0(e,tt.memoizedState,t)},useTransition:function(){var t=Fu(Qo)[0],e=nr().memoizedState;return[t,e]},useMutableSource:Yv,useSyncExternalStore:Kv,useId:c0,unstable_isNewReconciler:!1};function hr(t,e){if(t&&t.defaultProps){e=Ge({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function md(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ge({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Lc={isMounted:function(t){return(t=t._reactInternals)?ki(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=bt(),i=On(t),s=tn(n,i);s.payload=e,r!=null&&(s.callback=r),e=Ln(t,s,i),e!==null&&(gr(e,t,i,n),vl(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=bt(),i=On(t),s=tn(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Ln(t,s,i),e!==null&&(gr(e,t,i,n),vl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=bt(),n=On(t),i=tn(r,n);i.tag=2,e!=null&&(i.callback=e),e=Ln(t,i,n),e!==null&&(gr(e,t,n,r),vl(e,t,n))}};function Vm(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Wo(r,n)||!Wo(i,s):!0}function f0(t,e,r){var n=!1,i=Wn,s=e.contextType;return typeof s=="object"&&s!==null?s=rr(s):(i=Nt(e)?wi:vt.current,n=e.contextTypes,s=(n=n!=null)?Bs(t,i):Wn),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Lc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Xm(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Lc.enqueueReplaceState(e,e.state,null)}function gd(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},op(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=rr(s):(s=Nt(e)?wi:vt.current,i.context=Bs(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(md(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Lc.enqueueReplaceState(i,i.state,null),Jl(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ls(t,e){try{var r="",n=e;do r+=Iw(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Lu(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function xd(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var nb=typeof WeakMap=="function"?WeakMap:Map;function p0(t,e,r){r=tn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){ic||(ic=!0,Cd=n),xd(t,e)},r}function m0(t,e,r){r=tn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){xd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){xd(t,e),typeof n!="function"&&(Dn===null?Dn=new Set([this]):Dn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Ym(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new nb;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=xb.bind(null,t,e,r),e.then(t,t))}function Km(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function qm(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=tn(-1,1),e.tag=2,Ln(r,e,1))),r.lanes|=1),t)}var ib=un.ReactCurrentOwner,kt=!1;function wt(t,e,r,n){e.child=t===null?Wv(e,null,r,n):Ns(e,t.child,r,n)}function Qm(t,e,r,n,i){r=r.render;var s=e.ref;return Ss(e,i),n=hp(t,e,r,n,s,i),r=dp(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,an(t,e,i)):(Le&&r&&Jf(e),e.flags|=1,wt(t,e,n,i),e.child)}function Zm(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!Sp(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,g0(t,e,s,n,i)):(t=Tl(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Wo,r(o,n)&&t.ref===e.ref)return an(t,e,i)}return e.flags|=1,t=Un(s,n),t.ref=e.ref,t.return=e,e.child=t}function g0(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Wo(s,n)&&t.ref===e.ref)if(kt=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(kt=!0);else return e.lanes=t.lanes,an(t,e,i)}return yd(t,e,r,n,i)}function x0(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(ms,Ot),Ot|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ke(ms,Ot),Ot|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ke(ms,Ot),Ot|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,ke(ms,Ot),Ot|=n;return wt(t,e,i,r),e.child}function y0(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function yd(t,e,r,n,i){var s=Nt(r)?wi:vt.current;return s=Bs(e,s),Ss(e,i),r=hp(t,e,r,n,s,i),n=dp(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,an(t,e,i)):(Le&&n&&Jf(e),e.flags|=1,wt(t,e,r,i),e.child)}function Jm(t,e,r,n,i){if(Nt(r)){var s=!0;Yl(e)}else s=!1;if(Ss(e,i),e.stateNode===null)Sl(t,e),f0(e,r,n),gd(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=rr(u):(u=Nt(r)?wi:vt.current,u=Bs(e,u));var h=r.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==u)&&Xm(e,o,n,u),Sn=!1;var f=e.memoizedState;o.state=f,Jl(e,n,o,i),l=e.memoizedState,a!==n||f!==l||jt.current||Sn?(typeof h=="function"&&(md(e,r,h,n),l=e.memoizedState),(a=Sn||Vm(e,r,a,n,f,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Vv(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:hr(e.type,a),o.props=u,d=e.pendingProps,f=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=rr(l):(l=Nt(r)?wi:vt.current,l=Bs(e,l));var p=r.getDerivedStateFromProps;(h=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&Xm(e,o,n,l),Sn=!1,f=e.memoizedState,o.state=f,Jl(e,n,o,i);var m=e.memoizedState;a!==d||f!==m||jt.current||Sn?(typeof p=="function"&&(md(e,r,p,n),m=e.memoizedState),(u=Sn||Vm(e,r,u,n,f,m,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return vd(t,e,r,n,s,i)}function vd(t,e,r,n,i,s){y0(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Dm(e,r,!1),an(t,e,s);n=e.stateNode,ib.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Ns(e,t.child,null,s),e.child=Ns(e,null,a,s)):wt(t,e,a,s),e.memoizedState=n.state,i&&Dm(e,r,!0),e.child}function v0(t){var e=t.stateNode;e.pendingContext?Lm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Lm(t,e.context,!1),ap(t,e.containerInfo)}function eg(t,e,r,n,i){return js(),tp(i),e.flags|=256,wt(t,e,r,n),e.child}var _d={dehydrated:null,treeContext:null,retryLane:0};function wd(t){return{baseLanes:t,cachePool:null,transitions:null}}function _0(t,e,r){var n=e.pendingProps,i=Oe.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ke(Oe,i&1),t===null)return fd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Uc(o,n,0,null),t=xi(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=wd(r),e.memoizedState=_d,t):mp(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return sb(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Un(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Un(a,s):(s=xi(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?wd(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=_d,n}return s=t.child,t=s.sibling,n=Un(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function mp(t,e){return e=Uc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Oa(t,e,r,n){return n!==null&&tp(n),Ns(e,t.child,null,r),t=mp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sb(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=Lu(Error(H(422))),Oa(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Uc({mode:"visible",children:n.children},i,0,null),s=xi(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Ns(e,t.child,null,o),e.child.memoizedState=wd(o),e.memoizedState=_d,s);if(!(e.mode&1))return Oa(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(H(419)),n=Lu(s,n,void 0),Oa(t,e,o,n)}if(a=(o&t.childLanes)!==0,kt||a){if(n=ot,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,on(t,i),gr(n,t,i,-1))}return wp(),n=Lu(Error(H(421))),Oa(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=yb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ut=Fn(i.nextSibling),Ht=e,Le=!0,fr=null,t!==null&&(qt[Qt++]=Kr,qt[Qt++]=qr,qt[Qt++]=Si,Kr=t.id,qr=t.overflow,Si=e),e=mp(e,n.children),e.flags|=4096,e)}function tg(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),pd(t.return,e,r)}function Du(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function w0(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(wt(t,e,n.children,r),n=Oe.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&tg(t,r,e);else if(t.tag===19)tg(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ke(Oe,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&ec(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Du(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ec(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Du(e,!0,r,null,s);break;case"together":Du(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function an(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ei|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,r=Un(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Un(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function ob(t,e,r){switch(e.tag){case 3:v0(e),js();break;case 5:Xv(e);break;case 1:Nt(e.type)&&Yl(e);break;case 4:ap(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;ke(Ql,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ke(Oe,Oe.current&1),e.flags|=128,null):r&e.child.childLanes?_0(t,e,r):(ke(Oe,Oe.current&1),t=an(t,e,r),t!==null?t.sibling:null);ke(Oe,Oe.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return w0(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ke(Oe,Oe.current),n)break;return null;case 22:case 23:return e.lanes=0,x0(t,e,r)}return an(t,e,r)}var S0,Sd,b0,E0;S0=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Sd=function(){};b0=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,mi(Lr.current);var s=null;switch(r){case"input":i=Wh(t,i),n=Wh(t,n),s=[];break;case"select":i=Ge({},i,{value:void 0}),n=Ge({},n,{value:void 0}),s=[];break;case"textarea":i=Xh(t,i),n=Xh(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Vl)}Kh(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Lo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(a=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Lo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Be("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};E0=function(t,e,r,n){r!==n&&(e.flags|=4)};function ro(t,e){if(!Le)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function xt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function ab(t,e,r){var n=e.pendingProps;switch(ep(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(e),null;case 1:return Nt(e.type)&&Xl(),xt(e),null;case 3:return n=e.stateNode,Fs(),Ne(jt),Ne(vt),cp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(La(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fr!==null&&(Id(fr),fr=null))),Sd(t,e),xt(e),null;case 5:lp(e);var i=mi(Ko.current);if(r=e.type,t!==null&&e.stateNode!=null)b0(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(H(166));return xt(e),null}if(t=mi(Lr.current),La(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[jr]=e,n[Xo]=s,t=(e.mode&1)!==0,r){case"dialog":Be("cancel",n),Be("close",n);break;case"iframe":case"object":case"embed":Be("load",n);break;case"video":case"audio":for(i=0;i<fo.length;i++)Be(fo[i],n);break;case"source":Be("error",n);break;case"img":case"image":case"link":Be("error",n),Be("load",n);break;case"details":Be("toggle",n);break;case"input":um(n,s),Be("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Be("invalid",n);break;case"textarea":dm(n,s),Be("invalid",n)}Kh(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Fa(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Fa(n.textContent,a,t),i=["children",""+a]):Lo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Be("scroll",n)}switch(r){case"input":Ra(n),hm(n,s,!0);break;case"textarea":Ra(n),fm(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Vl)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Zy(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[jr]=e,t[Xo]=n,S0(t,e,!1,!1),e.stateNode=t;e:{switch(o=qh(r,n),r){case"dialog":Be("cancel",t),Be("close",t),i=n;break;case"iframe":case"object":case"embed":Be("load",t),i=n;break;case"video":case"audio":for(i=0;i<fo.length;i++)Be(fo[i],t);i=n;break;case"source":Be("error",t),i=n;break;case"img":case"image":case"link":Be("error",t),Be("load",t),i=n;break;case"details":Be("toggle",t),i=n;break;case"input":um(t,n),i=Wh(t,n),Be("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ge({},n,{value:void 0}),Be("invalid",t);break;case"textarea":dm(t,n),i=Xh(t,n),Be("invalid",t);break;default:i=n}Kh(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?tv(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Jy(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Do(t,l):typeof l=="number"&&Do(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Lo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Be("scroll",t):l!=null&&Of(t,s,l,o))}switch(r){case"input":Ra(t),hm(t,n,!1);break;case"textarea":Ra(t),fm(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Hn(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?ys(t,!!n.multiple,s,!1):n.defaultValue!=null&&ys(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Vl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xt(e),null;case 6:if(t&&e.stateNode!=null)E0(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(H(166));if(r=mi(Ko.current),mi(Lr.current),La(e)){if(n=e.stateNode,r=e.memoizedProps,n[jr]=e,(s=n.nodeValue!==r)&&(t=Ht,t!==null))switch(t.tag){case 3:Fa(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Fa(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[jr]=e,e.stateNode=n}return xt(e),null;case 13:if(Ne(Oe),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Le&&Ut!==null&&e.mode&1&&!(e.flags&128))Gv(),js(),e.flags|=98560,s=!1;else if(s=La(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(H(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(H(317));s[jr]=e}else js(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xt(e),s=!1}else fr!==null&&(Id(fr),fr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Oe.current&1?rt===0&&(rt=3):wp())),e.updateQueue!==null&&(e.flags|=4),xt(e),null);case 4:return Fs(),Sd(t,e),t===null&&$o(e.stateNode.containerInfo),xt(e),null;case 10:return ip(e.type._context),xt(e),null;case 17:return Nt(e.type)&&Xl(),xt(e),null;case 19:if(Ne(Oe),s=e.memoizedState,s===null)return xt(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)ro(s,!1);else{if(rt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ec(t),o!==null){for(e.flags|=128,ro(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ke(Oe,Oe.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ke()>Ds&&(e.flags|=128,n=!0,ro(s,!1),e.lanes=4194304)}else{if(!n)if(t=ec(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ro(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Le)return xt(e),null}else 2*Ke()-s.renderingStartTime>Ds&&r!==1073741824&&(e.flags|=128,n=!0,ro(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ke(),e.sibling=null,r=Oe.current,ke(Oe,n?r&1|2:r&1),e):(xt(e),null);case 22:case 23:return _p(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ot&1073741824&&(xt(e),e.subtreeFlags&6&&(e.flags|=8192)):xt(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function lb(t,e){switch(ep(e),e.tag){case 1:return Nt(e.type)&&Xl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Fs(),Ne(jt),Ne(vt),cp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return lp(e),null;case 13:if(Ne(Oe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));js()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ne(Oe),null;case 4:return Fs(),null;case 10:return ip(e.type._context),null;case 22:case 23:return _p(),null;case 24:return null;default:return null}}var Ua=!1,yt=!1,cb=typeof WeakSet=="function"?WeakSet:Set,q=null;function ps(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){$e(t,e,n)}else r.current=null}function bd(t,e,r){try{r()}catch(n){$e(t,e,n)}}var rg=!1;function ub(t,e){if(od=Hl,t=Pv(),Zf(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,u=0,h=0,d=t,f=null;t:for(;;){for(var p;d!==r||i!==0&&d.nodeType!==3||(a=o+i),d!==s||n!==0&&d.nodeType!==3||(l=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===t)break t;if(f===r&&++u===i&&(a=o),f===s&&++h===n&&(l=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ad={focusedElem:t,selectionRange:r},Hl=!1,q=e;q!==null;)if(e=q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,q=t;else for(;q!==null;){e=q;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,_=m.memoizedState,x=e.stateNode,y=x.getSnapshotBeforeUpdate(e.elementType===e.type?v:hr(e.type,v),_);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(w){$e(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,q=t;break}q=e.return}return m=rg,rg=!1,m}function Po(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&bd(e,r,s)}i=i.next}while(i!==n)}}function Dc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Ed(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function T0(t){var e=t.alternate;e!==null&&(t.alternate=null,T0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jr],delete e[Xo],delete e[ud],delete e[VS],delete e[XS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function A0(t){return t.tag===5||t.tag===3||t.tag===4}function ng(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||A0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Td(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Vl));else if(n!==4&&(t=t.child,t!==null))for(Td(t,e,r),t=t.sibling;t!==null;)Td(t,e,r),t=t.sibling}function Ad(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Ad(t,e,r),t=t.sibling;t!==null;)Ad(t,e,r),t=t.sibling}var ct=null,dr=!1;function gn(t,e,r){for(r=r.child;r!==null;)C0(t,e,r),r=r.sibling}function C0(t,e,r){if(Fr&&typeof Fr.onCommitFiberUnmount=="function")try{Fr.onCommitFiberUnmount(Ic,r)}catch{}switch(r.tag){case 5:yt||ps(r,e);case 6:var n=ct,i=dr;ct=null,gn(t,e,r),ct=n,dr=i,ct!==null&&(dr?(t=ct,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ct.removeChild(r.stateNode));break;case 18:ct!==null&&(dr?(t=ct,r=r.stateNode,t.nodeType===8?ku(t.parentNode,r):t.nodeType===1&&ku(t,r),Go(t)):ku(ct,r.stateNode));break;case 4:n=ct,i=dr,ct=r.stateNode.containerInfo,dr=!0,gn(t,e,r),ct=n,dr=i;break;case 0:case 11:case 14:case 15:if(!yt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&bd(r,e,o),i=i.next}while(i!==n)}gn(t,e,r);break;case 1:if(!yt&&(ps(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){$e(r,e,a)}gn(t,e,r);break;case 21:gn(t,e,r);break;case 22:r.mode&1?(yt=(n=yt)||r.memoizedState!==null,gn(t,e,r),yt=n):gn(t,e,r);break;default:gn(t,e,r)}}function ig(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new cb),e.forEach(function(n){var i=vb.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function or(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ct=a.stateNode,dr=!1;break e;case 3:ct=a.stateNode.containerInfo,dr=!0;break e;case 4:ct=a.stateNode.containerInfo,dr=!0;break e}a=a.return}if(ct===null)throw Error(H(160));C0(s,o,i),ct=null,dr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){$e(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)R0(e,t),e=e.sibling}function R0(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(or(e,t),Sr(t),n&4){try{Po(3,t,t.return),Dc(3,t)}catch(v){$e(t,t.return,v)}try{Po(5,t,t.return)}catch(v){$e(t,t.return,v)}}break;case 1:or(e,t),Sr(t),n&512&&r!==null&&ps(r,r.return);break;case 5:if(or(e,t),Sr(t),n&512&&r!==null&&ps(r,r.return),t.flags&32){var i=t.stateNode;try{Do(i,"")}catch(v){$e(t,t.return,v)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&qy(i,s),qh(a,o);var u=qh(a,s);for(o=0;o<l.length;o+=2){var h=l[o],d=l[o+1];h==="style"?tv(i,d):h==="dangerouslySetInnerHTML"?Jy(i,d):h==="children"?Do(i,d):Of(i,h,d,u)}switch(a){case"input":$h(i,s);break;case"textarea":Qy(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?ys(i,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?ys(i,!!s.multiple,s.defaultValue,!0):ys(i,!!s.multiple,s.multiple?[]:"",!1))}i[Xo]=s}catch(v){$e(t,t.return,v)}}break;case 6:if(or(e,t),Sr(t),n&4){if(t.stateNode===null)throw Error(H(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){$e(t,t.return,v)}}break;case 3:if(or(e,t),Sr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Go(e.containerInfo)}catch(v){$e(t,t.return,v)}break;case 4:or(e,t),Sr(t);break;case 13:or(e,t),Sr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(yp=Ke())),n&4&&ig(t);break;case 22:if(h=r!==null&&r.memoizedState!==null,t.mode&1?(yt=(u=yt)||h,or(e,t),yt=u):or(e,t),Sr(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(q=t,h=t.child;h!==null;){for(d=q=h;q!==null;){switch(f=q,p=f.child,f.tag){case 0:case 11:case 14:case 15:Po(4,f,f.return);break;case 1:ps(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){$e(n,r,v)}}break;case 5:ps(f,f.return);break;case 22:if(f.memoizedState!==null){og(d);continue}}p!==null?(p.return=f,q=p):og(d)}h=h.sibling}e:for(h=null,d=t;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=ev("display",o))}catch(v){$e(t,t.return,v)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){$e(t,t.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:or(e,t),Sr(t),n&4&&ig(t);break;case 21:break;default:or(e,t),Sr(t)}}function Sr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(A0(r)){var n=r;break e}r=r.return}throw Error(H(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Do(i,""),n.flags&=-33);var s=ng(t);Ad(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=ng(t);Td(t,a,o);break;default:throw Error(H(161))}}catch(l){$e(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hb(t,e,r){q=t,P0(t)}function P0(t,e,r){for(var n=(t.mode&1)!==0;q!==null;){var i=q,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Ua;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||yt;a=Ua;var u=yt;if(Ua=o,(yt=l)&&!u)for(q=i;q!==null;)o=q,l=o.child,o.tag===22&&o.memoizedState!==null?ag(i):l!==null?(l.return=o,q=l):ag(i);for(;s!==null;)q=s,P0(s),s=s.sibling;q=i,Ua=a,yt=u}sg(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,q=s):sg(t)}}function sg(t){for(;q!==null;){var e=q;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:yt||Dc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!yt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:hr(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Hm(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Hm(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Go(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}yt||e.flags&512&&Ed(e)}catch(f){$e(e,e.return,f)}}if(e===t){q=null;break}if(r=e.sibling,r!==null){r.return=e.return,q=r;break}q=e.return}}function og(t){for(;q!==null;){var e=q;if(e===t){q=null;break}var r=e.sibling;if(r!==null){r.return=e.return,q=r;break}q=e.return}}function ag(t){for(;q!==null;){var e=q;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Dc(4,e)}catch(l){$e(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){$e(e,i,l)}}var s=e.return;try{Ed(e)}catch(l){$e(e,s,l)}break;case 5:var o=e.return;try{Ed(e)}catch(l){$e(e,o,l)}}}catch(l){$e(e,e.return,l)}if(e===t){q=null;break}var a=e.sibling;if(a!==null){a.return=e.return,q=a;break}q=e.return}}var db=Math.ceil,nc=un.ReactCurrentDispatcher,gp=un.ReactCurrentOwner,tr=un.ReactCurrentBatchConfig,be=0,ot=null,Qe=null,ht=0,Ot=0,ms=Kn(0),rt=0,Jo=null,Ei=0,Oc=0,xp=0,Io=null,It=null,yp=0,Ds=1/0,Vr=null,ic=!1,Cd=null,Dn=null,za=!1,Rn=null,sc=0,ko=0,Rd=null,bl=-1,El=0;function bt(){return be&6?Ke():bl!==-1?bl:bl=Ke()}function On(t){return t.mode&1?be&2&&ht!==0?ht&-ht:KS.transition!==null?(El===0&&(El=fv()),El):(t=Re,t!==0||(t=window.event,t=t===void 0?16:_v(t.type)),t):1}function gr(t,e,r,n){if(50<ko)throw ko=0,Rd=null,Error(H(185));ca(t,r,n),(!(be&2)||t!==ot)&&(t===ot&&(!(be&2)&&(Oc|=r),rt===4&&Tn(t,ht)),Ft(t,n),r===1&&be===0&&!(e.mode&1)&&(Ds=Ke()+500,Nc&&qn()))}function Ft(t,e){var r=t.callbackNode;Kw(t,e);var n=Gl(t,t===ot?ht:0);if(n===0)r!==null&&gm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&gm(r),e===1)t.tag===0?YS(lg.bind(null,t)):Ov(lg.bind(null,t)),WS(function(){!(be&6)&&qn()}),r=null;else{switch(pv(n)){case 1:r=Wf;break;case 4:r=hv;break;case 16:r=zl;break;case 536870912:r=dv;break;default:r=zl}r=L0(r,I0.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function I0(t,e){if(bl=-1,El=0,be&6)throw Error(H(327));var r=t.callbackNode;if(bs()&&t.callbackNode!==r)return null;var n=Gl(t,t===ot?ht:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=oc(t,n);else{e=n;var i=be;be|=2;var s=M0();(ot!==t||ht!==e)&&(Vr=null,Ds=Ke()+500,gi(t,e));do try{mb();break}catch(a){k0(t,a)}while(!0);np(),nc.current=s,be=i,Qe!==null?e=0:(ot=null,ht=0,e=rt)}if(e!==0){if(e===2&&(i=td(t),i!==0&&(n=i,e=Pd(t,i))),e===1)throw r=Jo,gi(t,0),Tn(t,n),Ft(t,Ke()),r;if(e===6)Tn(t,n);else{if(i=t.current.alternate,!(n&30)&&!fb(i)&&(e=oc(t,n),e===2&&(s=td(t),s!==0&&(n=s,e=Pd(t,s))),e===1))throw r=Jo,gi(t,0),Tn(t,n),Ft(t,Ke()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(H(345));case 2:ii(t,It,Vr);break;case 3:if(Tn(t,n),(n&130023424)===n&&(e=yp+500-Ke(),10<e)){if(Gl(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){bt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=cd(ii.bind(null,t,It,Vr),e);break}ii(t,It,Vr);break;case 4:if(Tn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-mr(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=Ke()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*db(n/1960))-n,10<n){t.timeoutHandle=cd(ii.bind(null,t,It,Vr),n);break}ii(t,It,Vr);break;case 5:ii(t,It,Vr);break;default:throw Error(H(329))}}}return Ft(t,Ke()),t.callbackNode===r?I0.bind(null,t):null}function Pd(t,e){var r=Io;return t.current.memoizedState.isDehydrated&&(gi(t,e).flags|=256),t=oc(t,e),t!==2&&(e=It,It=r,e!==null&&Id(e)),t}function Id(t){It===null?It=t:It.push.apply(It,t)}function fb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!vr(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Tn(t,e){for(e&=~xp,e&=~Oc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-mr(e),n=1<<r;t[r]=-1,e&=~n}}function lg(t){if(be&6)throw Error(H(327));bs();var e=Gl(t,0);if(!(e&1))return Ft(t,Ke()),null;var r=oc(t,e);if(t.tag!==0&&r===2){var n=td(t);n!==0&&(e=n,r=Pd(t,n))}if(r===1)throw r=Jo,gi(t,0),Tn(t,e),Ft(t,Ke()),r;if(r===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ii(t,It,Vr),Ft(t,Ke()),null}function vp(t,e){var r=be;be|=1;try{return t(e)}finally{be=r,be===0&&(Ds=Ke()+500,Nc&&qn())}}function Ti(t){Rn!==null&&Rn.tag===0&&!(be&6)&&bs();var e=be;be|=1;var r=tr.transition,n=Re;try{if(tr.transition=null,Re=1,t)return t()}finally{Re=n,tr.transition=r,be=e,!(be&6)&&qn()}}function _p(){Ot=ms.current,Ne(ms)}function gi(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,HS(r)),Qe!==null)for(r=Qe.return;r!==null;){var n=r;switch(ep(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Xl();break;case 3:Fs(),Ne(jt),Ne(vt),cp();break;case 5:lp(n);break;case 4:Fs();break;case 13:Ne(Oe);break;case 19:Ne(Oe);break;case 10:ip(n.type._context);break;case 22:case 23:_p()}r=r.return}if(ot=t,Qe=t=Un(t.current,null),ht=Ot=e,rt=0,Jo=null,xp=Oc=Ei=0,It=Io=null,pi!==null){for(e=0;e<pi.length;e++)if(r=pi[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}pi=null}return t}function k0(t,e){do{var r=Qe;try{if(np(),_l.current=rc,tc){for(var n=ze.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}tc=!1}if(bi=0,it=tt=ze=null,Ro=!1,qo=0,gp.current=null,r===null||r.return===null){rt=1,Jo=e,Qe=null;break}e:{var s=t,o=r.return,a=r,l=e;if(e=ht,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=Km(o);if(p!==null){p.flags&=-257,qm(p,o,a,s,e),p.mode&1&&Ym(s,u,e),e=p,l=u;var m=e.updateQueue;if(m===null){var v=new Set;v.add(l),e.updateQueue=v}else m.add(l);break e}else{if(!(e&1)){Ym(s,u,e),wp();break e}l=Error(H(426))}}else if(Le&&a.mode&1){var _=Km(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),qm(_,o,a,s,e),tp(Ls(l,a));break e}}s=l=Ls(l,a),rt!==4&&(rt=2),Io===null?Io=[s]:Io.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=p0(s,l,e);Gm(s,x);break e;case 1:a=l;var y=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Dn===null||!Dn.has(g)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=m0(s,a,e);Gm(s,w);break e}}s=s.return}while(s!==null)}j0(r)}catch(S){e=S,Qe===r&&r!==null&&(Qe=r=r.return);continue}break}while(!0)}function M0(){var t=nc.current;return nc.current=rc,t===null?rc:t}function wp(){(rt===0||rt===3||rt===2)&&(rt=4),ot===null||!(Ei&268435455)&&!(Oc&268435455)||Tn(ot,ht)}function oc(t,e){var r=be;be|=2;var n=M0();(ot!==t||ht!==e)&&(Vr=null,gi(t,e));do try{pb();break}catch(i){k0(t,i)}while(!0);if(np(),be=r,nc.current=n,Qe!==null)throw Error(H(261));return ot=null,ht=0,rt}function pb(){for(;Qe!==null;)B0(Qe)}function mb(){for(;Qe!==null&&!Uw();)B0(Qe)}function B0(t){var e=F0(t.alternate,t,Ot);t.memoizedProps=t.pendingProps,e===null?j0(t):Qe=e,gp.current=null}function j0(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=lb(r,e),r!==null){r.flags&=32767,Qe=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rt=6,Qe=null;return}}else if(r=ab(r,e,Ot),r!==null){Qe=r;return}if(e=e.sibling,e!==null){Qe=e;return}Qe=e=t}while(e!==null);rt===0&&(rt=5)}function ii(t,e,r){var n=Re,i=tr.transition;try{tr.transition=null,Re=1,gb(t,e,r,n)}finally{tr.transition=i,Re=n}return null}function gb(t,e,r,n){do bs();while(Rn!==null);if(be&6)throw Error(H(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(qw(t,s),t===ot&&(Qe=ot=null,ht=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||za||(za=!0,L0(zl,function(){return bs(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=tr.transition,tr.transition=null;var o=Re;Re=1;var a=be;be|=4,gp.current=null,ub(t,r),R0(r,t),FS(ad),Hl=!!od,ad=od=null,t.current=r,hb(r),zw(),be=a,Re=o,tr.transition=s}else t.current=r;if(za&&(za=!1,Rn=t,sc=i),s=t.pendingLanes,s===0&&(Dn=null),Ww(r.stateNode),Ft(t,Ke()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(ic)throw ic=!1,t=Cd,Cd=null,t;return sc&1&&t.tag!==0&&bs(),s=t.pendingLanes,s&1?t===Rd?ko++:(ko=0,Rd=t):ko=0,qn(),null}function bs(){if(Rn!==null){var t=pv(sc),e=tr.transition,r=Re;try{if(tr.transition=null,Re=16>t?16:t,Rn===null)var n=!1;else{if(t=Rn,Rn=null,sc=0,be&6)throw Error(H(331));var i=be;for(be|=4,q=t.current;q!==null;){var s=q,o=s.child;if(q.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(q=u;q!==null;){var h=q;switch(h.tag){case 0:case 11:case 15:Po(8,h,s)}var d=h.child;if(d!==null)d.return=h,q=d;else for(;q!==null;){h=q;var f=h.sibling,p=h.return;if(T0(h),h===u){q=null;break}if(f!==null){f.return=p,q=f;break}q=p}}}var m=s.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}q=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,q=o;else e:for(;q!==null;){if(s=q,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Po(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,q=x;break e}q=s.return}}var y=t.current;for(q=y;q!==null;){o=q;var g=o.child;if(o.subtreeFlags&2064&&g!==null)g.return=o,q=g;else e:for(o=y;q!==null;){if(a=q,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Dc(9,a)}}catch(S){$e(a,a.return,S)}if(a===o){q=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,q=w;break e}q=a.return}}if(be=i,qn(),Fr&&typeof Fr.onPostCommitFiberRoot=="function")try{Fr.onPostCommitFiberRoot(Ic,t)}catch{}n=!0}return n}finally{Re=r,tr.transition=e}}return!1}function cg(t,e,r){e=Ls(r,e),e=p0(t,e,1),t=Ln(t,e,1),e=bt(),t!==null&&(ca(t,1,e),Ft(t,e))}function $e(t,e,r){if(t.tag===3)cg(t,t,r);else for(;e!==null;){if(e.tag===3){cg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Dn===null||!Dn.has(n))){t=Ls(r,t),t=m0(e,t,1),e=Ln(e,t,1),t=bt(),e!==null&&(ca(e,1,t),Ft(e,t));break}}e=e.return}}function xb(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=bt(),t.pingedLanes|=t.suspendedLanes&r,ot===t&&(ht&r)===r&&(rt===4||rt===3&&(ht&130023424)===ht&&500>Ke()-yp?gi(t,0):xp|=r),Ft(t,e)}function N0(t,e){e===0&&(t.mode&1?(e=ka,ka<<=1,!(ka&130023424)&&(ka=4194304)):e=1);var r=bt();t=on(t,e),t!==null&&(ca(t,e,r),Ft(t,r))}function yb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),N0(t,r)}function vb(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(H(314))}n!==null&&n.delete(e),N0(t,r)}var F0;F0=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||jt.current)kt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return kt=!1,ob(t,e,r);kt=!!(t.flags&131072)}else kt=!1,Le&&e.flags&1048576&&Uv(e,ql,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Sl(t,e),t=e.pendingProps;var i=Bs(e,vt.current);Ss(e,r),i=hp(null,e,n,t,i,r);var s=dp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nt(n)?(s=!0,Yl(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,op(e),i.updater=Lc,e.stateNode=i,i._reactInternals=e,gd(e,n,t,r),e=vd(null,e,n,!0,s,r)):(e.tag=0,Le&&s&&Jf(e),wt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Sl(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=wb(n),t=hr(n,t),i){case 0:e=yd(null,e,n,t,r);break e;case 1:e=Jm(null,e,n,t,r);break e;case 11:e=Qm(null,e,n,t,r);break e;case 14:e=Zm(null,e,n,hr(n.type,t),r);break e}throw Error(H(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:hr(n,i),yd(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:hr(n,i),Jm(t,e,n,i,r);case 3:e:{if(v0(e),t===null)throw Error(H(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Vv(t,e),Jl(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ls(Error(H(423)),e),e=eg(t,e,n,r,i);break e}else if(n!==i){i=Ls(Error(H(424)),e),e=eg(t,e,n,r,i);break e}else for(Ut=Fn(e.stateNode.containerInfo.firstChild),Ht=e,Le=!0,fr=null,r=Wv(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(js(),n===i){e=an(t,e,r);break e}wt(t,e,n,r)}e=e.child}return e;case 5:return Xv(e),t===null&&fd(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,ld(n,i)?o=null:s!==null&&ld(n,s)&&(e.flags|=32),y0(t,e),wt(t,e,o,r),e.child;case 6:return t===null&&fd(e),null;case 13:return _0(t,e,r);case 4:return ap(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ns(e,null,n,r):wt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:hr(n,i),Qm(t,e,n,i,r);case 7:return wt(t,e,e.pendingProps,r),e.child;case 8:return wt(t,e,e.pendingProps.children,r),e.child;case 12:return wt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ke(Ql,n._currentValue),n._currentValue=o,s!==null)if(vr(s.value,o)){if(s.children===i.children&&!jt.current){e=an(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=tn(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),pd(s.return,r,e),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(H(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),pd(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}wt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Ss(e,r),i=rr(i),n=n(i),e.flags|=1,wt(t,e,n,r),e.child;case 14:return n=e.type,i=hr(n,e.pendingProps),i=hr(n.type,i),Zm(t,e,n,i,r);case 15:return g0(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:hr(n,i),Sl(t,e),e.tag=1,Nt(n)?(t=!0,Yl(e)):t=!1,Ss(e,r),f0(e,n,i),gd(e,n,i,r),vd(null,e,n,!0,t,r);case 19:return w0(t,e,r);case 22:return x0(t,e,r)}throw Error(H(156,e.tag))};function L0(t,e){return uv(t,e)}function _b(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zt(t,e,r,n){return new _b(t,e,r,n)}function Sp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wb(t){if(typeof t=="function")return Sp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===zf)return 11;if(t===Gf)return 14}return 2}function Un(t,e){var r=t.alternate;return r===null?(r=Zt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Tl(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")Sp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ss:return xi(r.children,i,s,e);case Uf:o=8,i|=8;break;case Uh:return t=Zt(12,r,e,i|2),t.elementType=Uh,t.lanes=s,t;case zh:return t=Zt(13,r,e,i),t.elementType=zh,t.lanes=s,t;case Gh:return t=Zt(19,r,e,i),t.elementType=Gh,t.lanes=s,t;case Xy:return Uc(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $y:o=10;break e;case Vy:o=9;break e;case zf:o=11;break e;case Gf:o=14;break e;case wn:o=16,n=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=Zt(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function xi(t,e,r,n){return t=Zt(7,t,n,e),t.lanes=r,t}function Uc(t,e,r,n){return t=Zt(22,t,n,e),t.elementType=Xy,t.lanes=r,t.stateNode={isHidden:!1},t}function Ou(t,e,r){return t=Zt(6,t,null,e),t.lanes=r,t}function Uu(t,e,r){return e=Zt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Sb(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_u(0),this.expirationTimes=_u(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_u(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function bp(t,e,r,n,i,s,o,a,l){return t=new Sb(t,e,r,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Zt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},op(s),t}function bb(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:is,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function D0(t){if(!t)return Wn;t=t._reactInternals;e:{if(ki(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Nt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var r=t.type;if(Nt(r))return Dv(t,r,e)}return e}function O0(t,e,r,n,i,s,o,a,l){return t=bp(r,n,!0,t,i,s,o,a,l),t.context=D0(null),r=t.current,n=bt(),i=On(r),s=tn(n,i),s.callback=e??null,Ln(r,s,i),t.current.lanes=i,ca(t,i,n),Ft(t,n),t}function zc(t,e,r,n){var i=e.current,s=bt(),o=On(i);return r=D0(r),e.context===null?e.context=r:e.pendingContext=r,e=tn(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Ln(i,e,o),t!==null&&(gr(t,i,o,s),vl(t,i,o)),o}function ac(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ug(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Ep(t,e){ug(t,e),(t=t.alternate)&&ug(t,e)}function Eb(){return null}var U0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Tp(t){this._internalRoot=t}Gc.prototype.render=Tp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));zc(t,e,null,null)};Gc.prototype.unmount=Tp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ti(function(){zc(null,t,null,null)}),e[sn]=null}};function Gc(t){this._internalRoot=t}Gc.prototype.unstable_scheduleHydration=function(t){if(t){var e=xv();t={blockedOn:null,target:t,priority:e};for(var r=0;r<En.length&&e!==0&&e<En[r].priority;r++);En.splice(r,0,t),r===0&&vv(t)}};function Ap(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function hg(){}function Tb(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=ac(o);s.call(u)}}var o=O0(e,n,t,0,null,!1,!1,"",hg);return t._reactRootContainer=o,t[sn]=o.current,$o(t.nodeType===8?t.parentNode:t),Ti(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var u=ac(l);a.call(u)}}var l=bp(t,0,!1,null,null,!1,!1,"",hg);return t._reactRootContainer=l,t[sn]=l.current,$o(t.nodeType===8?t.parentNode:t),Ti(function(){zc(e,l,r,n)}),l}function Wc(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=ac(o);a.call(l)}}zc(e,o,t,i)}else o=Tb(r,e,t,i,n);return ac(o)}mv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ho(e.pendingLanes);r!==0&&($f(e,r|1),Ft(e,Ke()),!(be&6)&&(Ds=Ke()+500,qn()))}break;case 13:Ti(function(){var n=on(t,1);if(n!==null){var i=bt();gr(n,t,1,i)}}),Ep(t,1)}};Vf=function(t){if(t.tag===13){var e=on(t,134217728);if(e!==null){var r=bt();gr(e,t,134217728,r)}Ep(t,134217728)}};gv=function(t){if(t.tag===13){var e=On(t),r=on(t,e);if(r!==null){var n=bt();gr(r,t,e,n)}Ep(t,e)}};xv=function(){return Re};yv=function(t,e){var r=Re;try{return Re=t,e()}finally{Re=r}};Zh=function(t,e,r){switch(e){case"input":if($h(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=jc(n);if(!i)throw Error(H(90));Ky(n),$h(n,i)}}}break;case"textarea":Qy(t,r);break;case"select":e=r.value,e!=null&&ys(t,!!r.multiple,e,!1)}};iv=vp;sv=Ti;var Ab={usingClientEntryPoint:!1,Events:[ha,cs,jc,rv,nv,vp]},no={findFiberByHostInstance:fi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Cb={bundleType:no.bundleType,version:no.version,rendererPackageName:no.rendererPackageName,rendererConfig:no.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:un.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=lv(t),t===null?null:t.stateNode},findFiberByHostInstance:no.findFiberByHostInstance||Eb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ga=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ga.isDisabled&&Ga.supportsFiber)try{Ic=Ga.inject(Cb),Fr=Ga}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ab;$t.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ap(e))throw Error(H(200));return bb(t,e,null,r)};$t.createRoot=function(t,e){if(!Ap(t))throw Error(H(299));var r=!1,n="",i=U0;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=bp(t,1,!1,null,null,r,!1,n,i),t[sn]=e.current,$o(t.nodeType===8?t.parentNode:t),new Tp(e)};$t.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=lv(e),t=t===null?null:t.stateNode,t};$t.flushSync=function(t){return Ti(t)};$t.hydrate=function(t,e,r){if(!Hc(e))throw Error(H(200));return Wc(null,t,e,!0,r)};$t.hydrateRoot=function(t,e,r){if(!Ap(t))throw Error(H(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=U0;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=O0(e,null,t,1,r??null,i,!1,s,o),t[sn]=e.current,$o(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Gc(e)};$t.render=function(t,e,r){if(!Hc(e))throw Error(H(200));return Wc(null,t,e,!1,r)};$t.unmountComponentAtNode=function(t){if(!Hc(t))throw Error(H(40));return t._reactRootContainer?(Ti(function(){Wc(null,null,t,!1,function(){t._reactRootContainer=null,t[sn]=null})}),!0):!1};$t.unstable_batchedUpdates=vp;$t.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Hc(r))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return Wc(t,e,r,!1,n)};$t.version="18.3.1-next-f1338f8080-20240426";function z0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(z0)}catch(t){console.error(t)}}z0(),zy.exports=$t;var Rb=zy.exports,dg=Rb;Dh.createRoot=dg.createRoot,Dh.hydrateRoot=dg.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ea(){return ea=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ea.apply(this,arguments)}var Pn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Pn||(Pn={}));const fg="popstate";function Pb(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return kd("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:lc(i)}return kb(e,r,null,t)}function Ze(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Cp(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Ib(){return Math.random().toString(36).substr(2,8)}function pg(t,e){return{usr:t.state,key:t.key,idx:e}}function kd(t,e,r,n){return r===void 0&&(r=null),ea({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?$s(e):e,{state:r,key:e&&e.key||n||Ib()})}function lc(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function $s(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function kb(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=Pn.Pop,l=null,u=h();u==null&&(u=0,o.replaceState(ea({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function d(){a=Pn.Pop;let _=h(),x=_==null?null:_-u;u=_,l&&l({action:a,location:v.location,delta:x})}function f(_,x){a=Pn.Push;let y=kd(v.location,_,x);u=h()+1;let g=pg(y,u),w=v.createHref(y);try{o.pushState(g,"",w)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(w)}s&&l&&l({action:a,location:v.location,delta:1})}function p(_,x){a=Pn.Replace;let y=kd(v.location,_,x);u=h();let g=pg(y,u),w=v.createHref(y);o.replaceState(g,"",w),s&&l&&l({action:a,location:v.location,delta:0})}function m(_){let x=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof _=="string"?_:lc(_);return y=y.replace(/ $/,"%20"),Ze(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let v={get action(){return a},get location(){return t(i,o)},listen(_){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(fg,d),l=_,()=>{i.removeEventListener(fg,d),l=null}},createHref(_){return e(i,_)},createURL:m,encodeLocation(_){let x=m(_);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:p,go(_){return o.go(_)}};return v}var mg;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(mg||(mg={}));function Mb(t,e,r){return r===void 0&&(r="/"),Bb(t,e,r)}function Bb(t,e,r,n){let i=typeof e=="string"?$s(e):e,s=Rp(i.pathname||"/",r);if(s==null)return null;let o=G0(t);jb(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=Vb(s);a=Hb(o[l],u)}return a}function G0(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Ze(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=zn([n,l.relativePath]),h=r.concat(l);s.children&&s.children.length>0&&(Ze(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),G0(s.children,e,h,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:zb(u,s.index),routesMeta:h})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of H0(s.path))i(s,o,l)}),e}function H0(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=H0(n.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function jb(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Gb(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Nb=/^:[\w-]+$/,Fb=3,Lb=2,Db=1,Ob=10,Ub=-2,gg=t=>t==="*";function zb(t,e){let r=t.split("/"),n=r.length;return r.some(gg)&&(n+=Ub),e&&(n+=Lb),r.filter(i=>!gg(i)).reduce((i,s)=>i+(Nb.test(s)?Fb:s===""?Db:Ob),n)}function Gb(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Hb(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],u=a===n.length-1,h=s==="/"?e:e.slice(s.length)||"/",d=Wb({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},h),f=l.route;if(!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:zn([s,d.pathname]),pathnameBase:Qb(zn([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=zn([s,d.pathnameBase]))}return o}function Wb(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=$b(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((u,h,d)=>{let{paramName:f,isOptional:p}=h;if(f==="*"){let v=a[d]||"";o=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const m=a[d];return p&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function $b(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Cp(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function Vb(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Cp(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Rp(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const Xb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Yb=t=>Xb.test(t);function Kb(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?$s(t):t,s;if(r)if(Yb(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Cp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=xg(r.substring(1),"/"):s=xg(r,e)}else s=e;return{pathname:s,search:Zb(n),hash:Jb(i)}}function xg(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function zu(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function qb(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function W0(t,e){let r=qb(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function $0(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=$s(t):(i=ea({},t),Ze(!i.pathname||!i.pathname.includes("?"),zu("?","pathname","search",i)),Ze(!i.pathname||!i.pathname.includes("#"),zu("#","pathname","hash",i)),Ze(!i.search||!i.search.includes("#"),zu("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let d=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=Kb(i,a),u=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||h)&&(l.pathname+="/"),l}const zn=t=>t.join("/").replace(/\/\/+/g,"/"),Qb=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Zb=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Jb=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function eE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const V0=["post","put","patch","delete"];new Set(V0);const tE=["get",...V0];new Set(tE);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ta(){return ta=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ta.apply(this,arguments)}const Pp=b.createContext(null),rE=b.createContext(null),Mi=b.createContext(null),$c=b.createContext(null),Bi=b.createContext({outlet:null,matches:[],isDataRoute:!1}),X0=b.createContext(null);function nE(t,e){let{relative:r}=e===void 0?{}:e;fa()||Ze(!1);let{basename:n,navigator:i}=b.useContext(Mi),{hash:s,pathname:o,search:a}=K0(t,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:zn([n,o])),i.createHref({pathname:l,search:a,hash:s})}function fa(){return b.useContext($c)!=null}function Qn(){return fa()||Ze(!1),b.useContext($c).location}function Y0(t){b.useContext(Mi).static||b.useLayoutEffect(t)}function Xt(){let{isDataRoute:t}=b.useContext(Bi);return t?gE():iE()}function iE(){fa()||Ze(!1);let t=b.useContext(Pp),{basename:e,future:r,navigator:n}=b.useContext(Mi),{matches:i}=b.useContext(Bi),{pathname:s}=Qn(),o=JSON.stringify(W0(i,r.v7_relativeSplatPath)),a=b.useRef(!1);return Y0(()=>{a.current=!0}),b.useCallback(function(u,h){if(h===void 0&&(h={}),!a.current)return;if(typeof u=="number"){n.go(u);return}let d=$0(u,JSON.parse(o),s,h.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:zn([e,d.pathname])),(h.replace?n.replace:n.push)(d,h.state,h)},[e,n,o,s,t])}function K0(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=b.useContext(Mi),{matches:i}=b.useContext(Bi),{pathname:s}=Qn(),o=JSON.stringify(W0(i,n.v7_relativeSplatPath));return b.useMemo(()=>$0(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function sE(t,e){return oE(t,e)}function oE(t,e,r,n){fa()||Ze(!1);let{navigator:i}=b.useContext(Mi),{matches:s}=b.useContext(Bi),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Qn(),h;if(e){var d;let _=typeof e=="string"?$s(e):e;l==="/"||(d=_.pathname)!=null&&d.startsWith(l)||Ze(!1),h=_}else h=u;let f=h.pathname||"/",p=f;if(l!=="/"){let _=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(_.length).join("/")}let m=Mb(t,{pathname:p}),v=hE(m&&m.map(_=>Object.assign({},_,{params:Object.assign({},a,_.params),pathname:zn([l,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?l:zn([l,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,r,n);return e&&v?b.createElement($c.Provider,{value:{location:ta({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Pn.Pop}},v):v}function aE(){let t=mE(),e=eE(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),r?b.createElement("pre",{style:i},r):null,null)}const lE=b.createElement(aE,null);class cE extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?b.createElement(Bi.Provider,{value:this.props.routeContext},b.createElement(X0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uE(t){let{routeContext:e,match:r,children:n}=t,i=b.useContext(Pp);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement(Bi.Provider,{value:e},n)}function hE(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let h=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);h>=0||Ze(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<o.length;h++){let d=o[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:p}=r,m=d.route.loader&&f[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||m){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,d,f)=>{let p,m=!1,v=null,_=null;r&&(p=a&&d.route.id?a[d.route.id]:void 0,v=d.route.errorElement||lE,l&&(u<0&&f===0?(xE("route-fallback"),m=!0,_=null):u===f&&(m=!0,_=d.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,f+1)),y=()=>{let g;return p?g=v:m?g=_:d.route.Component?g=b.createElement(d.route.Component,null):d.route.element?g=d.route.element:g=h,b.createElement(uE,{match:d,routeContext:{outlet:h,matches:x,isDataRoute:r!=null},children:g})};return r&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?b.createElement(cE,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var q0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(q0||{}),Q0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Q0||{});function dE(t){let e=b.useContext(Pp);return e||Ze(!1),e}function fE(t){let e=b.useContext(rE);return e||Ze(!1),e}function pE(t){let e=b.useContext(Bi);return e||Ze(!1),e}function Z0(t){let e=pE(),r=e.matches[e.matches.length-1];return r.route.id||Ze(!1),r.route.id}function mE(){var t;let e=b.useContext(X0),r=fE(),n=Z0();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function gE(){let{router:t}=dE(q0.UseNavigateStable),e=Z0(Q0.UseNavigateStable),r=b.useRef(!1);return Y0(()=>{r.current=!0}),b.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,ta({fromRouteId:e},s)))},[t,e])}const yg={};function xE(t,e,r){yg[t]||(yg[t]=!0)}function yE(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Yt(t){Ze(!1)}function vE(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Pn.Pop,navigator:s,static:o=!1,future:a}=t;fa()&&Ze(!1);let l=e.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:l,navigator:s,static:o,future:ta({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof n=="string"&&(n=$s(n));let{pathname:h="/",search:d="",hash:f="",state:p=null,key:m="default"}=n,v=b.useMemo(()=>{let _=Rp(h,l);return _==null?null:{location:{pathname:_,search:d,hash:f,state:p,key:m},navigationType:i}},[l,h,d,f,p,m,i]);return v==null?null:b.createElement(Mi.Provider,{value:u},b.createElement($c.Provider,{children:r,value:v}))}function _E(t){let{children:e,location:r}=t;return sE(Md(e),r)}new Promise(()=>{});function Md(t,e){e===void 0&&(e=[]);let r=[];return b.Children.forEach(t,(n,i)=>{if(!b.isValidElement(n))return;let s=[...e,i];if(n.type===b.Fragment){r.push.apply(r,Md(n.props.children,s));return}n.type!==Yt&&Ze(!1),!n.props.index||!n.props.children||Ze(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Md(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bd(){return Bd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bd.apply(this,arguments)}function wE(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function SE(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function bE(t,e){return t.button===0&&(!e||e==="_self")&&!SE(t)}function jd(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function EE(t,e){let r=jd(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(s=>{r.append(i,s)})}),r}const TE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],AE="6";try{window.__reactRouterVersion=AE}catch{}const CE="startTransition",vg=xw[CE];function RE(t){let{basename:e,children:r,future:n,window:i}=t,s=b.useRef();s.current==null&&(s.current=Pb({window:i,v5Compat:!0}));let o=s.current,[a,l]=b.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},h=b.useCallback(d=>{u&&vg?vg(()=>l(d)):l(d)},[l,u]);return b.useLayoutEffect(()=>o.listen(h),[o,h]),b.useEffect(()=>yE(n),[n]),b.createElement(vE,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const PE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",IE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ra=b.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:h,viewTransition:d}=e,f=wE(e,TE),{basename:p}=b.useContext(Mi),m,v=!1;if(typeof u=="string"&&IE.test(u)&&(m=u,PE))try{let g=new URL(window.location.href),w=u.startsWith("//")?new URL(g.protocol+u):new URL(u),S=Rp(w.pathname,p);w.origin===g.origin&&S!=null?u=S+w.search+w.hash:v=!0}catch{}let _=nE(u,{relative:i}),x=kE(u,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,viewTransition:d});function y(g){n&&n(g),g.defaultPrevented||x(g)}return b.createElement("a",Bd({},f,{href:m||_,onClick:v||s?n:y,ref:r,target:l}))});var _g;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(_g||(_g={}));var wg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(wg||(wg={}));function kE(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=Xt(),u=Qn(),h=K0(t,{relative:o});return b.useCallback(d=>{if(bE(d,r)){d.preventDefault();let f=n!==void 0?n:lc(u)===lc(h);l(t,{replace:f,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,h,n,i,r,t,s,o,a])}function Vc(t){let e=b.useRef(jd(t)),r=b.useRef(!1),n=Qn(),i=b.useMemo(()=>EE(n.search,r.current?null:e.current),[n.search]),s=Xt(),o=b.useCallback((a,l)=>{const u=jd(typeof a=="function"?a(i):a);r.current=!0,s("?"+u,l)},[s,i]);return[i,o]}function ME(){const t=Xt(),[e,r]=b.useState(0),[n,i]=b.useState(!1),s=b.useRef(null),o=80;return b.useEffect(()=>{const a=s.current;if(!a)return;let l=0,u=0,h=!1;const d=m=>{a.scrollTop===0&&(l=m.touches[0].clientY,h=!0,console.log("Pull-to-refresh: Touch started"))},f=m=>{if(!h)return;u=m.touches[0].clientY;const v=u-l;if(v>0){m.preventDefault();const _=Math.pow(v,.85);r(Math.min(_,o*1.5)),console.log("Pull distance:",Math.min(_,o*1.5).toFixed(0))}},p=()=>{e>o?(i(!0),r(0),setTimeout(()=>{window.location.reload()},400)):r(0),h=!1};return a.addEventListener("touchstart",d,{passive:!0}),a.addEventListener("touchmove",f,{passive:!1}),a.addEventListener("touchend",p),()=>{a.removeEventListener("touchstart",d),a.removeEventListener("touchmove",f),a.removeEventListener("touchend",p)}},[e]),c.jsxs("div",{ref:s,className:"screen screen-center",style:{position:"relative",overflow:"auto"},children:[c.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:`${e}px`,display:"flex",alignItems:"flex-end",justifyContent:"center",paddingBottom:"8px",opacity:Math.min(e/o,1),transition:e===0?"all 0.3s ease":"none",pointerEvents:"none",zIndex:10},children:n?c.jsx("div",{style:{width:"24px",height:"24px",border:"3px solid var(--color-surface)",borderTop:"3px solid var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}):c.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",fontWeight:600},children:e>o?" Release to refresh":" Pull to refresh"})}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",zIndex:1,transform:`translateY(${e}px)`,transition:e===0?"transform 0.3s ease":"none",paddingBottom:"120px"},children:[c.jsx("img",{src:"/data/icons/OwlHeadphones.png",alt:"ChipNotes Owl Professor",style:{width:"180px",height:"180px",borderRadius:"50%",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",marginBottom:"4px"}}),c.jsx("h1",{style:{margin:0,fontSize:"44px",fontWeight:800,letterSpacing:"-1px",background:"linear-gradient(135deg, #FFD54F 0%, #FF8A65 50%, #E57373 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"ChipNotes!"}),c.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"16px",maxWidth:"280px",textAlign:"center",lineHeight:1.4,marginTop:"-4px",fontWeight:600},children:"Train your ear. Know the birds."}),c.jsx("button",{onClick:()=>t("/pack-select"),style:{marginTop:"16px",padding:"18px 64px",fontSize:"20px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"16px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.4)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:a=>{a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow="0 6px 20px rgba(45, 90, 39, 0.5)"},onMouseLeave:a=>{a.currentTarget.style.transform="translateY(0)",a.currentTarget.style.boxShadow="0 4px 16px rgba(45, 90, 39, 0.4)"},children:"Play"}),c.jsx("div",{style:{marginTop:"20px",padding:"16px",background:"var(--color-surface)",borderRadius:"16px",maxWidth:"360px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px"},children:[c.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[c.jsx("div",{style:{width:"72px",height:"52px",background:"linear-gradient(180deg, #1a1a2e 0%, #0d1520 100%)",borderRadius:"10px",padding:"6px",display:"flex",alignItems:"flex-end",justifyContent:"center",gap:"2px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.3)"},children:c.jsx(BE,{})}),c.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Hear"})]}),c.jsx("div",{style:{color:"var(--color-accent)",fontSize:"24px",marginTop:"-16px"},children:""}),c.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"4px"},children:["NOCA","BLJA","TUTI","CARW"].map((a,l)=>c.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",overflow:"hidden",border:l===0?"2px solid var(--color-accent)":"2px solid transparent",boxShadow:l===0?"0 0 8px rgba(255, 152, 0, 0.4)":"none"},children:c.jsx("img",{src:`/data/icons/${a}.png`,alt:a,style:{width:"100%",height:"100%",objectFit:"cover"}})},a))}),c.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Match"})]}),c.jsx("div",{style:{color:"var(--color-accent)",fontSize:"24px",marginTop:"-16px"},children:""}),c.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[c.jsx("div",{style:{width:"72px",height:"52px",background:"#2a2a3e",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.4)"},children:c.jsx("div",{style:{fontSize:"32px"},children:""})}),c.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Train"})]})]})})]}),c.jsxs("div",{style:{position:"absolute",bottom:"70px",left:0,right:0,display:"flex",justifyContent:"center",gap:"40px",zIndex:1e3},children:[c.jsx("button",{className:"btn-icon",onClick:()=>t("/help"),"aria-label":"How to Play",children:c.jsx(jE,{})}),c.jsx("button",{className:"btn-icon",onClick:()=>t("/settings"),"aria-label":"Settings",children:c.jsx(NE,{})}),c.jsx("button",{className:"btn-icon",onClick:()=>t("/progress"),"aria-label":"Progress",children:c.jsx(FE,{})})]}),c.jsx("button",{onClick:()=>t("/help",{state:{openVersionHistory:!0}}),style:{position:"absolute",bottom:"calc(4px + var(--safe-area-bottom, 0px))",left:0,right:0,textAlign:"center",fontSize:"11px",color:"var(--color-text-muted)",opacity:.6,background:"none",border:"none",cursor:"pointer",padding:"4px",transition:"opacity 0.2s",zIndex:1001},onMouseEnter:a=>a.currentTarget.style.opacity="1",onMouseLeave:a=>a.currentTarget.style.opacity="0.6","aria-label":"View version history",children:"v3.38"})]})}function BE(){const t=[8,16,24,32,26,34,28,36,20,12,26,32];return c.jsx("svg",{width:"76",height:"40",viewBox:"0 0 76 40",children:t.map((e,r)=>c.jsx("rect",{x:r*6+2,y:40-e,width:"4",height:e,rx:"1.5",fill:`hsl(${30+r*8}, 80%, ${50+r*2}%)`,opacity:.8+r*.015},r))})}function jE(){return c.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10"}),c.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),c.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}function NE(){return c.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("circle",{cx:"12",cy:"12",r:"3"}),c.jsx("path",{d:"M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"})]})}function FE(){return c.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M3 3v18h18"}),c.jsx("path",{d:"M7 16l4-4 4 4 6-6"})]})}function pa(t,e){typeof window.gtag=="function"&&window.gtag("event",t,e)}function LE(t,e){pa("pack_select",{pack_id:t,pack_name:e})}function DE(t,e,r){pa("game_start",{pack_id:t,level_id:e,species_count:r})}function OE(t,e,r,n,i){pa("round_complete",{pack_id:t,level_id:e,score:r,accuracy:n,duration_sec:i})}function UE(t){pa("training_mode_toggle",{enabled:t})}function zE(t,e,r){pa("level_select",{pack_id:t,level_id:e,level_title:r})}const Sg={AMCR:"Corvus brachyrhynchos",AMGO:"Spinus tristis",AMRE:"Setophaga ruticilla",AMRO:"Turdus migratorius",BAOW:"Strix varia",BAWW:"Mniotilta varia",BBWA:"Setophaga castanea",BCCH:"Poecile atricapillus",BEKI:"Megaceryle alcyon",BHNU:"Sitta pusilla",BLBW:"Setophaga fusca",BLJA:"Cyanocitta cristata",BLPW:"Setophaga striata",BRCR:"Certhia americana",BRTH:"Toxostoma rufum",BTBW:"Setophaga caerulescens",BTNW:"Setophaga virens",BWWA:"Vermivora cyanoptera",CACH:"Poecile carolinensis",CAFI:"Haemorhous cassinii",CARW:"Thryothorus ludovicianus",CAWA:"Cardellina canadensis",CEWA:"Setophaga cerulea",CHSP:"Spizella passerina",CMWA:"Setophaga tigrina",COGR:"Quiscalus quiscula",COHA:"Astur cooperii",CONW:"Oporornis agilis",COYE:"Geothlypis trichas",CSWA:"Setophaga pensylvanica",DOWO:"Dryobates pubescens",EABL:"Sialia sialis",EATO:"Pipilo erythrophthalmus",EVGR:"Coccothraustes vespertinus",FICR:"Corvus ossifragus",FISP:"Spizella pusilla",GCKI:"Regulus satrapa",GRCA:"Dumetella carolinensis",GWWA:"Vermivora chrysoptera",HAWO:"Dryobates villosus",HETH:"Catharus guttatus",HOFI:"Haemorhous mexicanus",KEWA:"Geothlypis formosa",LISP:"Melospiza lincolnii",LOWA:"Parkesia motacilla",MAWA:"Setophaga magnolia",MODO:"Zenaida macroura",MOWA:"Geothlypis philadelphia",NAWA:"Leiothlypis ruficapilla",NOCA:"Cardinalis cardinalis",NOFL:"Colaptes auratus",NOMO:"Mimus polyglottos",NOPA:"Setophaga americana",NOWA:"Parkesia noveboracensis",OCWA:"Leiothlypis celata",OVEN:"Seiurus aurocapilla",PAWA:"Setophaga palmarum",PISI:"Spinus pinus",PIWA:"Setophaga pinus",PIWO:"Dryocopus pileatus",PRAW:"Setophaga discolor",PROW:"Protonotaria citrea",RBWO:"Melanerpes carolinus",RCKI:"Corthylio calendula",RHWO:"Melanerpes erythrocephalus",RSHA:"Buteo lineatus",RTHA:"Buteo jamaicensis",RTHU:"Archilochus colubris",RWBL:"Agelaius phoeniceus",SASP:"Passerculus sandwichensis",SOSP:"Melospiza melodia",SSHA:"Accipiter striatus",STJA:"Cyanocitta stelleri",SWSP:"Melospiza georgiana",SWWA:"Limnothlypis swainsonii",TEWA:"Leiothlypis peregrina",TUTI:"Baeolophus bicolor",WBNU:"Sitta carolinensis",WCSP:"Zonotrichia leucophrys",WESJ:"Aphelocoma californica",WEWA:"Helmitheros vermivorum",WIWA:"Cardellina pusilla",WTSP:"Zonotrichia albicollis",YBSA:"Sphyrapicus varius",YRWA:"Setophaga coronata",YTWA:"Setophaga dominica"},Gu=[{id:"starter_birds",name:"Eastern Backyard Birds",speciesCount:6,isUnlocked:!0,description:"Start here! Distinctive, bold, recognizable voices."},{id:"expanded_backyard",name:"Expanded Eastern Birds",speciesCount:39,isUnlocked:!0,description:"Ready for more? 9 random per round."},{id:"sparrows",name:"Sparrows",speciesCount:8,isUnlocked:!0,description:"Master their subtle songs."},{id:"woodpeckers",name:"Woodpeckers",speciesCount:7,isUnlocked:!0,description:"Drums, calls, and rattles."},{id:"western_birds",name:"Western Backyard Birds",speciesCount:14,isUnlocked:!0,description:"Pacific coast to the Rockies."},{id:"spring_warblers",name:"Warbler Academy",speciesCount:33,isUnlocked:!0,description:"9 random per round. Custom Pack mode recommended!"}];function GE(){var L,U,P;const t=Xt(),e=Qn(),[r]=Vc(),[n,i]=b.useState([]),[s,o]=b.useState({}),[a,l]=b.useState(null),[u,h]=b.useState(null),[d,f]=b.useState(new Set),[p,m]=b.useState(!1),[v,_]=b.useState(!1),[x,y]=b.useState(!1),[g,w]=b.useState(!1),[S,T]=b.useState({}),A=b.useRef(null);b.useEffect(()=>{fetch("/data/clips.json").then(I=>I.json()).then(I=>{i(I);const D=Array.from(new Set(I.filter(O=>!O.rejected&&(!O.spectrogram_path||!O.spectrogram_path.includes("spectrograms-rejected"))).map(O=>O.species_code))).sort();o(O=>({...O,all_birds:D}))}).catch(I=>console.error("Failed to load clips:",I))},[]),b.useEffect(()=>{fetch("/data/taxonomic_order.json").then(I=>I.json()).then(I=>{T(I)}).catch(I=>console.error("Failed to load taxonomic order:",I))},[]),b.useEffect(()=>{const I=["starter_birds","expanded_backyard","sparrows","woodpeckers","spring_warblers","western_birds"];Promise.all(I.map(D=>fetch(`/data/packs/${D}.json`).then(O=>O.json()).catch(O=>(console.error(`Failed to load pack ${D}:`,O),null)))).then(D=>{const O={};D.forEach((M,j)=>{M&&M.species&&(O[I[j]]=M.display_species||M.species)}),o(M=>({...M,...O}))})},[]);const E=I=>{const O=(s[I]||[]).map(M=>{const j=n.filter(B=>B.species_code===M&&!B.rejected&&(!B.spectrogram_path||!B.spectrogram_path.includes("spectrograms-rejected"))),R=j.find(B=>B.canonical)||j[0],C=j.sort((B,$)=>B.canonical&&!$.canonical?-1:!B.canonical&&$.canonical?1:B.clip_id.localeCompare($.clip_id)).map(B=>({id:B.clip_id,path:`/data/clips/${B.file_path.split("/").pop()}`,isCanonical:!!B.canonical,vocalizationType:B.vocalization_type,source:B.source,sourceId:B.source_id,recordist:B.recordist}));return{code:M,name:(R==null?void 0:R.common_name)||M,canonicalClipPath:R?`/data/clips/${R.file_path.split("/").pop()}`:null,clipCount:j.length,allClips:C}});return I==="all_birds"&&x&&Object.keys(S).length>0?O.sort((M,j)=>{const N=S[M.code]||9999,R=S[j.code]||9999;return N-R}):O.sort((M,j)=>M.code.localeCompare(j.code))},k=I=>{I.isUnlocked&&(LE(I.id,I.name),t(`/level-select?pack=${I.id}`))},F=(I,D)=>{if(A.current&&(A.current.pause(),A.current=null),a===D){l(null);return}const O=new Audio(I);A.current=O,l(D),O.play().catch(M=>console.error("Failed to play audio:",M)),O.onended=()=>{l(null),A.current=null}};return b.useEffect(()=>()=>{A.current&&A.current.pause()},[]),b.useEffect(()=>{const I=r.get("expand")||r.get("expandPack");I&&f(new Set([I])),window.location.hash&&setTimeout(()=>{const D=document.querySelector(window.location.hash);D&&D.scrollIntoView({behavior:"smooth",block:"start"})},100)},[r]),c.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[c.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[c.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",children:c.jsx(HE,{})}),c.jsx("h2",{style:{margin:0},children:"Select a Bird Pack"})]}),c.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.6,background:"rgba(70, 70, 90, 0.5)",padding:"16px",borderRadius:"12px"},children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[c.jsx("li",{style:{fontWeight:600},children:"Use  (or not), but do UNmute "}),c.jsx("li",{children:"6 levels/packstart @ #1,  sparrow"}),c.jsxs("li",{children:["Try training mode ()"," ",c.jsx(ra,{to:"/help#training-mode",state:{fromPackSelect:!0},style:{color:"var(--color-accent)"},children:"Help "})]}),c.jsxs("li",{children:["Timer anxiety? Continuous Play"," ",c.jsx(ra,{to:"/settings",state:{fromPackSelect:!0},style:{color:"var(--color-accent)"},children:" "})]})]})}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"32px"},children:Gu.map(I=>{const D={starter_birds:"linear-gradient(135deg, #2d5a3d 0%, #1a3d2a 100%)",expanded_backyard:"linear-gradient(135deg, #3d5a6e 0%, #2a3d4a 100%)",sparrows:"linear-gradient(135deg, #6b5344 0%, #4a3a2e 100%)",woodpeckers:"linear-gradient(135deg, #6e3d3d 0%, #4a2a2a 100%)",spring_warblers:"linear-gradient(135deg, #7a6b2d 0%, #5a4a1a 100%)",western_birds:"linear-gradient(135deg, #5a4a7a 0%, #3a2a5a 100%)"},O={starter_birds:"NOCA",expanded_backyard:"AMGO",sparrows:"WTSP",woodpeckers:"PIWO",spring_warblers:"BLBW",western_birds:"STJA"};return c.jsxs("button",{onClick:()=>k(I),style:{position:"relative",overflow:"hidden",textAlign:"left",padding:"12px 12px 14px 12px",borderRadius:"16px",border:"none",background:D[I.id]||D.starter_birds,boxShadow:I.isUnlocked?"0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"none",opacity:I.isUnlocked?1:.5,cursor:I.isUnlocked?"pointer":"not-allowed",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:M=>{I.isUnlocked&&(M.currentTarget.style.transform="translateY(-2px)",M.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1)")},onMouseLeave:M=>{M.currentTarget.style.transform="translateY(0)",M.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[c.jsx("img",{src:`/data/icons/${O[I.id]}.png`,alt:"",style:{position:"absolute",right:"-10px",bottom:"-10px",width:"80px",height:"80px",opacity:.3,transform:"rotate(-15deg)",objectFit:"cover"}}),I.isUnlocked&&c.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:2},children:c.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#a8d5a2",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Play ",c.jsx(WE,{})]})}),c.jsxs("div",{style:{position:"relative",zIndex:1},children:[c.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#f5f0e6",lineHeight:1.3,marginBottom:"6px",paddingRight:"50px"},children:I.name}),c.jsx("div",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.6)",lineHeight:1.4,marginBottom:"10px"},children:I.description}),c.jsx("div",{children:c.jsxs("span",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.7)",fontWeight:500},children:[I.speciesCount," species"]})})]})]},I.id)})}),c.jsxs("div",{onClick:()=>t("/custom-pack"),style:{marginBottom:"32px",background:"var(--color-surface)",border:"2px solid var(--color-accent)",borderRadius:"16px",padding:"20px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:I=>{I.currentTarget.style.background="rgba(45, 90, 39, 0.15)",I.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:I=>{I.currentTarget.style.background="var(--color-surface)",I.currentTarget.style.transform="translateY(0)"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[c.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"var(--color-accent)",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:c.jsx($E,{})}),c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)"},children:"Create Custom Pack"}),c.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:"Build your own training session"})]})]}),c.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6},children:[c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Got a nemesis bird? Queue it up and drill all its variations."]}),c.jsxs("div",{style:{marginBottom:v?"8px":"12px"},children:[c.jsx("span",{style:{color:"var(--color-accent)"},children:""})," A friend's eBird checklist has you jealous? Queue up their birds, and it will be like you were there."]}),v&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Constantly confuse Kinglets, Creepers and Waxwings? Put them head-to-head."]}),c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Warbler Wizard Wannabe? Training starts here!"]}),c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("span",{style:{color:"var(--color-accent)"},children:""})," You think you know your woodpeckers? Try the Pileated vs. Northern Flicker on Level 5."]}),c.jsxs("div",{style:{marginBottom:"12px"},children:[c.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Mix species from any pack  your rules, your practice."]})]}),c.jsx("button",{onClick:I=>{I.stopPropagation(),_(!v)},style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",cursor:"pointer",padding:"4px 0",textDecoration:"underline",display:"flex",alignItems:"center",gap:"4px"},children:v?" Show less":"More examples "})]})]}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",marginTop:"24px",marginBottom:"16px",opacity:.5},children:[c.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",textAlign:"center"},children:"Browse all birds below"}),c.jsx("div",{style:{animation:"bounce 2s ease-in-out infinite"},children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-text-muted)",strokeWidth:"2",children:c.jsx("path",{d:"M12 5v14M5 12l7 7 7-7"})})})]}),c.jsxs("div",{id:"bird-reference",style:{marginTop:"16px",scrollMarginTop:"20px"},children:[((L=e.state)==null?void 0:L.fromLevelSelect)&&((U=e.state)==null?void 0:U.packId)&&c.jsx("div",{style:{marginBottom:"16px"},children:c.jsxs("button",{onClick:()=>t(`/level-select?pack=${e.state.packId}`),style:{background:"var(--color-accent)",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Level Select",children:[c.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Level Select"]})}),((P=e.state)==null?void 0:P.fromHelp)&&c.jsx("div",{style:{marginBottom:"16px"},children:c.jsxs("button",{onClick:()=>t("/help"),style:{background:"var(--color-accent)",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Help",children:[c.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Help"]})}),c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[c.jsx("h3",{style:{fontSize:"16px",margin:0,color:"var(--color-text-muted)"},children:"Bird Reference"}),c.jsx("button",{onClick:()=>{if(p)f(new Set),m(!1);else{const I=Gu.filter(D=>D.isUnlocked).map(D=>D.id);f(new Set(I)),m(!0)}},style:{fontSize:"12px",padding:"6px 12px",background:p?"var(--color-accent)":"var(--color-surface)",color:p?"#000":"var(--color-text)",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:600},children:p?"Collapse All":"Expand All"})]}),c.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"20px",paddingLeft:"12px",borderLeft:"3px solid var(--color-accent)"},children:"Preview signature sounds for each bird before you play. Click pack names to expand and see all birds, or click individual birds to explore their full library of recordings."}),s.all_birds&&(()=>{var O;const I="all_birds",D=p||d.has(I);return c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsxs("div",{onClick:()=>{const M=new Set(d);M.has(I)?M.delete(I):M.add(I),f(M)},style:{fontSize:"14px",marginBottom:D?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:M=>M.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:M=>M.currentTarget.style.background="var(--color-surface)",children:[c.jsx("span",{style:{fontSize:"14px"},children:D?"":""}),c.jsx("span",{style:{fontWeight:600},children:"All Birds"}),c.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((O=s[I])==null?void 0:O.length)||0," species"]})]}),D&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{marginBottom:"12px",padding:"10px",background:"rgba(70, 70, 90, 0.3)",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",position:"relative"},children:[c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[c.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"var(--color-text-muted)"},children:"Sort:"}),c.jsx("button",{onClick:()=>{const M=!x;y(M),M&&(w(!0),setTimeout(()=>w(!1),1400))},style:{padding:"6px 12px",fontSize:"12px",fontWeight:600,background:x?"var(--color-accent)":"rgba(255,255,255,0.15)",color:x?"#000":"var(--color-text)",border:x?"none":"1.5px solid var(--color-accent)",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s",boxShadow:x?"0 2px 8px rgba(245, 166, 35, 0.3)":"none"},onMouseEnter:M=>{x||(M.currentTarget.style.background="rgba(255,255,255,0.25)",M.currentTarget.style.transform="scale(1.05)")},onMouseLeave:M=>{x||(M.currentTarget.style.background="rgba(255,255,255,0.15)",M.currentTarget.style.transform="scale(1)")},children:x?" Taxonomic":" A-Z"}),c.jsx("span",{style:{fontSize:"11px",color:"var(--color-text-muted)",flex:"1",minWidth:"180px"},children:x?"Phylogenetic (eBird 2025)":"Species codes"})]}),g&&c.jsx("div",{style:{position:"absolute",top:"15px",left:"70%",transform:"translateX(-50%)",background:"rgba(245, 166, 35, 1.0)",color:"#000",padding:"6px 20px",borderRadius:"16px",fontSize:"13px",fontWeight:600,boxShadow:"0 2px 8px rgba(245, 166, 35, 0.3)",animation:"floatPop 1.4s ease-out forwards",zIndex:1e3,pointerEvents:"none",whiteSpace:"nowrap"},children:" nerd alert!"})]}),c.jsx("style",{children:`
                  @keyframes floatPop {
                    0% {
                      opacity: 0;
                      transform: translateX(-50%) translateY(0) scale(0.8);
                    }
                    15% {
                      opacity: 0.75;
                      transform: translateX(-50%) translateY(-5px) scale(1);
                    }
                    80% {
                      opacity: 0.75;
                      transform: translateX(-50%) translateY(-35px) scale(1);
                    }
                    90% {
                      opacity: 0.5;
                      transform: translateX(-50%) translateY(-40px) scale(1.05);
                    }
                    100% {
                      opacity: 0;
                      transform: translateX(-50%) translateY(-45px) scale(0.6);
                    }
                  }
                `}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:E(I).map(M=>{const j=u===M.code;return c.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:M.clipCount>1?"pointer":"default"},onClick:()=>{M.clipCount>1&&h(j?null:M.code)},children:[c.jsx(Tg,{code:M.code,size:36}),c.jsxs("div",{style:{minWidth:0,flex:1},children:[c.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:M.code}),c.jsx("div",{style:{fontSize:"13px",fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:M.name}),x&&Sg[M.code]&&c.jsx("div",{style:{fontSize:"11px",fontStyle:"italic",color:"var(--color-text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:Sg[M.code]})]}),M.canonicalClipPath&&c.jsx("button",{onClick:N=>{N.stopPropagation(),F(M.canonicalClipPath,M.code)},style:{width:"32px",height:"32px",borderRadius:"50%",border:"none",background:a===M.code?"var(--color-accent)":"rgba(255,255,255,0.1)",color:a===M.code?"#000":"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px"},children:a===M.code?"":""}),M.clipCount>1&&c.jsx("span",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:j?"":""})]}),j&&M.allClips.length>0&&c.jsxs("div",{style:{padding:"0 12px 12px 12px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[c.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"8px",marginBottom:"8px",fontWeight:600},children:["All Recordings (",M.allClips.length,")"]}),M.allClips.map((N,R)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",padding:"6px",background:"rgba(0,0,0,0.2)",borderRadius:"6px"},children:[c.jsx("button",{onClick:()=>F(N.path,`${M.code}_${R}`),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===`${M.code}_${R}`?"var(--color-accent)":"rgba(255,255,255,0.1)",color:a===`${M.code}_${R}`?"#000":"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",flexShrink:0},children:a===`${M.code}_${R}`?"":""}),c.jsx("div",{style:{flex:1,fontSize:"11px"},children:c.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",flexWrap:"wrap"},children:[N.isCanonical&&c.jsx("span",{style:{fontSize:"9px",background:"var(--color-accent)",color:"#000",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"SIGNATURE"}),c.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:N.vocalizationType==="song"?"rgba(76, 175, 80, 0.2)":"rgba(245, 166, 35, 0.2)",padding:"2px 6px",borderRadius:"4px",textTransform:"uppercase"},children:N.vocalizationType}),(N.source||N.recordist)&&c.jsxs("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:[N.source==="xenocanto"&&N.sourceId?N.sourceId:N.source==="cornell"?"Cornell":N.source==="user_recording"?"User":N.source,N.recordist&&` - ${N.recordist}`]})]})})]},N.id))]})]},M.code)})})]})]},I)})(),Gu.filter(I=>I.isUnlocked).map(I=>{var O,M,j;const D=p||d.has(I.id);return c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsxs("div",{onClick:()=>{const N=new Set(d);N.has(I.id)?N.delete(I.id):N.add(I.id),f(N)},style:{fontSize:"14px",marginBottom:D?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:N=>N.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:N=>N.currentTarget.style.background="var(--color-surface)",children:[c.jsx("span",{style:{fontSize:"14px"},children:D?"":""}),c.jsx("span",{style:{fontWeight:600},children:I.name}),c.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((O=s[I.id])==null?void 0:O.length)||0," species"]})]}),D&&((M=e.state)==null?void 0:M.fromPreview)&&((j=e.state)==null?void 0:j.pack)===I.id&&c.jsx("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"flex-end"},children:c.jsx("button",{onClick:()=>{const{pack:N,level:R}=e.state;t(`/preview?pack=${N}&level=${R}`)},style:{padding:"10px 16px",fontSize:"14px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 4px 12px rgba(45, 90, 39, 0.4)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:N=>{N.currentTarget.style.transform="scale(1.05)",N.currentTarget.style.boxShadow="0 6px 16px rgba(45, 90, 39, 0.5)"},onMouseLeave:N=>{N.currentTarget.style.transform="scale(1)",N.currentTarget.style.boxShadow="0 4px 12px rgba(45, 90, 39, 0.4)"},children:"Ready to Play?"})}),D&&c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:E(I.id).map(N=>{const R=u===N.code;return c.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:N.clipCount>1?"pointer":"default"},onClick:()=>{N.clipCount>1&&h(R?null:N.code)},children:[c.jsx(Tg,{code:N.code,size:36}),c.jsxs("div",{style:{minWidth:0,flex:1},children:[c.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:N.code}),c.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:N.name}),c.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)"},children:[N.clipCount," clip",N.clipCount!==1?"s":"",N.clipCount>1&&c.jsx("span",{style:{marginLeft:"4px",color:"var(--color-accent)"},children:R?"":""})]})]}),c.jsx("button",{onClick:C=>{C.stopPropagation(),N.canonicalClipPath&&F(N.canonicalClipPath,N.code)},disabled:!N.canonicalClipPath,style:{width:"28px",height:"28px",borderRadius:"50%",border:"none",background:a===N.code?"var(--color-accent)":"var(--color-primary)",color:"white",cursor:N.canonicalClipPath?"pointer":"not-allowed",opacity:N.canonicalClipPath?1:.3,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play ${N.name}`,children:a===N.code?c.jsx(Eg,{}):c.jsx(bg,{})})]}),R&&N.allClips.length>0&&c.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"8px 12px",background:"rgba(0,0,0,0.2)"},children:[c.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"8px"},children:["All ",N.clipCount," clips:"]}),c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:N.allClips.map((C,B)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("button",{onClick:()=>F(C.path,C.id),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===C.id?"var(--color-accent)":"rgba(255,255,255,0.15)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play clip ${B+1}`,children:a===C.id?c.jsx(Eg,{size:8}):c.jsx(bg,{size:8})}),c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px",flex:1},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[c.jsx("span",{style:{fontSize:"11px",color:"var(--color-text)"},children:C.sourceId||`Clip ${B+1}`}),C.isCanonical&&c.jsx("span",{style:{fontSize:"9px",color:"#000",background:"var(--color-accent)",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:" SIGNATURE"}),C.vocalizationType&&c.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px",textTransform:"capitalize"},children:C.vocalizationType}),C.source&&c.jsxs("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:[C.source==="xenocanto"&&C.sourceId?C.sourceId:C.source==="cornell"?"Cornell":C.source==="user_recording"?"User":C.source,C.recordist&&` - ${C.recordist}`]})]})})]},C.id))})]})]},N.code)})})]},I.id)})]})]})}function HE(){return c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),c.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function bg({size:t=14}){return c.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M8 5v14l11-7z"})})}function Eg({size:t=12}){return c.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function WE(){return c.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:c.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}function $E(){return c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:c.jsx("path",{d:"M12 5v14M5 12h14"})})}function VE({size:t=80}){return c.jsx("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"currentColor",children:c.jsx("path",{d:"M85 35c-5-3-12-2-18 1-3-8-10-14-19-16 2-3 3-7 2-11-1-5-5-8-9-7s-7 5-6 10c0 2 1 4 2 5-10 3-18 11-21 21-8-1-16 2-21 8-2 2-1 5 1 6s5 0 7-2c3-4 8-5 13-4 0 12 7 23 18 28l-8 12c-2 2-1 5 1 7 2 1 5 1 6-2l10-14c3 1 6 1 9 1 4 0 7-1 10-2l10 14c2 2 5 3 7 1s2-5 0-7l-8-12c11-5 18-16 18-28 5-1 10 0 13 4 2 2 5 3 7 2s3-4 1-6c-5-6-13-9-21-8z"})})}function Tg({code:t,size:e=36}){const[r,n]=b.useState(!0),i=`/data/icons/${t}.png`;return r?c.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",flexShrink:0},onError:()=>n(!1)}):c.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-primary)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.4,flexShrink:0},children:c.jsx(VE,{size:e*.7})})}const XE={starter_birds:"Eastern Backyard Birds",expanded_backyard:"Expanded Eastern US Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard Birds",custom:"Custom Pack"};function YE(t){return[{level_id:1,pack_id:"custom",mode:"campaign",title:"Meet Your Birds",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:2,pack_id:"custom",mode:"campaign",title:"Sound Variations",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:3,pack_id:"custom",mode:"campaign",title:"Full Repertoire",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:4,pack_id:"custom",mode:"campaign",title:"Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:5,pack_id:"custom",mode:"campaign",title:"Variations + Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:6,pack_id:"custom",mode:"campaign",title:"Master Birder",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"}]}function KE(t){const e=[];return t.clip_selection==="canonical"?e.push("Signature sounds only"):t.clip_selection==="all"?e.push("Full repertoire"):typeof t.clip_selection=="number"&&e.push(`${t.clip_selection} variations per bird`),t.channel_mode==="offset"?e.push("both ears"):e.push("one ear"),e.join("  ")}function qE(t){const e=t.level_id;return e<=2?{label:"Easy",color:"#4CAF50"}:e<=4?{label:"Medium",color:"#FFC107"}:{label:"Hard",color:"#FF5722"}}function QE(){const t=Xt(),[e]=Vc(),r=e.get("pack")||"starter_birds",[n,i]=b.useState([]),[s,o]=b.useState(!0);b.useEffect(()=>{if(r==="custom"){try{const u=localStorage.getItem("soundfield_custom_pack");if(u){const h=JSON.parse(u);if(Array.isArray(h)&&h.length>0){i(YE(h.length)),o(!1);return}}t("/custom-pack",{replace:!0})}catch(u){console.error("Failed to load custom pack:",u),t("/custom-pack",{replace:!0})}return}fetch("/data/levels.json").then(u=>u.json()).then(u=>{const h=u.filter(d=>d.pack_id===r);i(h.sort((d,f)=>d.level_id-f.level_id)),o(!1)}).catch(u=>{console.error("Failed to load levels:",u),o(!1)})},[r,t]);const a=u=>{zE(r,u.level_id,u.title||`Level ${u.level_id}`),t(`/preview?pack=${r}&level=${u.level_id}`)},l=XE[r]||r;return c.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[c.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"8px"},children:[c.jsx("button",{className:"btn-icon",onClick:()=>t(r==="custom"?"/custom-pack":"/pack-select"),"aria-label":"Back",children:c.jsx(ZE,{})}),c.jsxs("div",{style:{flex:1},children:[c.jsx("h2",{style:{margin:0,fontSize:"20px"},children:l}),c.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[c.jsx("span",{children:"Select a level"}),r!=="custom"&&c.jsxs(c.Fragment,{children:[c.jsx("span",{style:{color:"var(--color-surface)"},children:""}),c.jsx(ra,{to:`/pack-select?expand=${r}#bird-reference`,state:{fromLevelSelect:!0,packId:r},style:{color:"var(--color-accent)",textDecoration:"none",fontSize:"12px"},children:"Bird Reference"})]})]})]})]}),s?c.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--color-text-muted)"},children:"Loading levels..."}):c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:n.map(u=>{const h=qE(u);return c.jsxs("button",{onClick:()=>a(u),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"var(--color-surface)",border:"none",borderRadius:"12px",cursor:"pointer",textAlign:"left",transition:"transform 0.15s, background 0.15s"},onMouseEnter:d=>{d.currentTarget.style.transform="translateX(4px)",d.currentTarget.style.background="rgba(45, 45, 68, 1)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateX(0)",d.currentTarget.style.background="var(--color-surface)"},children:[c.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:`linear-gradient(135deg, ${h.color}33, ${h.color}11)`,border:`2px solid ${h.color}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"20px",color:h.color,flexShrink:0},children:u.level_id}),c.jsxs("div",{style:{flex:1,minWidth:0},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:u.title}),c.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:KE(u)})]}),c.jsx("div",{style:{color:"var(--color-text-muted)",flexShrink:0},children:c.jsx(JE,{})})]},u.level_id)})}),c.jsx("div",{style:{marginTop:"24px",padding:"12px 16px",background:"rgba(245, 166, 35, 0.1)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:c.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:[c.jsx("strong",{style:{color:"var(--color-accent)"},children:"Tip:"})," Start with Level 1 to learn each bird's signature sound, then progress to variations and both-ear challenges."]})})]})}function ZE(){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}function JE(){return c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M9 18l6-6-6-6"})})}const zi=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"],eT={starter_birds:"Eastern Backyard Birds",expanded_backyard:"Expanded Eastern US Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard Birds",custom:"Custom Pack"},tT={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function rT(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function nT(t){return t>=4?"offset":"single"}function iT({code:t,size:e=56,color:r}){const[n,i]=b.useState(!0),s=`/data/icons/${t}.png`;return c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",WebkitTapHighlightColor:"transparent"},children:[n&&c.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?c.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",WebkitTapHighlightColor:"transparent"},onError:()=>i(!1)}):c.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"var(--color-surface)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.25,fontWeight:700,color:"#1A1A2E"},children:t})]})}function sT(){const t=Xt(),[e]=Vc(),r=e.get("pack")||"starter_birds",n=parseInt(e.get("level")||"1",10),i=e.get("keepBirds")==="true",[s,o]=b.useState(null),[a,l]=b.useState([]),[u,h]=b.useState([]),[d,f]=b.useState(null),[p,m]=b.useState(!0),[v,_]=b.useState("idle"),[x,y]=b.useState({loaded:0,total:0}),[g,w]=b.useState(()=>{try{return localStorage.getItem("soundfield_training_mode")==="true"}catch{return!1}}),[S,T]=b.useState(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}}),[A,E]=b.useState({}),[k,F]=b.useState({}),L=b.useRef(null),U=()=>{const R=!g;w(R);try{localStorage.setItem("soundfield_training_mode",String(R))}catch(C){console.error("Failed to save training mode:",C)}},P=()=>{const R=!S;T(R);try{localStorage.setItem("soundfield_taxonomic_sort",String(R))}catch(C){console.error("Failed to save taxonomic sort:",C)}};b.useEffect(()=>{if(u.length===0||Object.keys(A).length===0)return;const R=u.map(V=>V.code),B=(S?[...R].sort((V,ie)=>{const ae=A[V]||9999,Q=A[ie]||9999;return ae-Q}):[...R].sort()).map((V,ie)=>({...u.find(Q=>Q.code===V),color:zi[ie%zi.length]}));B.some((V,ie)=>V.code!==u[ie].code)&&h(B)},[S,A]),b.useEffect(()=>{Promise.all([fetch("/data/taxonomic_order.json").then(R=>R.json()),fetch("/data/species.json").then(R=>R.json())]).then(([R,C])=>{E(R);const B={};C.forEach($=>{B[$.species_code]=$.scientific_name}),F(B)}).catch(R=>console.error("Failed to load taxonomy data:",R))},[]);const I=b.useCallback((R,C)=>[...R].sort().map(($,V)=>{const ie=C.find(me=>me.species_code===$&&me.canonical&&!me.rejected),ae=C.find(me=>me.species_code===$&&!me.rejected),Q=ie||ae;return{code:$,name:(Q==null?void 0:Q.common_name)||$,scientificName:k[$],color:zi[V%zi.length],clipPath:Q?`/data/clips/${Q.file_path.split("/").pop()}`:null}}),[k]),D=b.useCallback((R,C)=>{const B=R.species_pool||[],$=R.species_count||B.length,Q=[...B].sort(()=>Math.random()-.5).slice(0,$).sort().map((me,Me)=>{const Pe=C.find(Ee=>Ee.species_code===me&&Ee.canonical&&!Ee.rejected),we=C.find(Ee=>Ee.species_code===me&&!Ee.rejected),Se=Pe||we;return{code:me,name:(Se==null?void 0:Se.common_name)||me,scientificName:k[me],color:zi[Me%zi.length],clipPath:Se?`/data/clips/${Se.file_path.split("/").pop()}`:null}});h(Q)},[k]);b.useEffect(()=>{Promise.all([fetch("/data/levels.json").then(R=>R.json()),fetch("/data/clips.json").then(R=>R.json())]).then(([R,C])=>{if(l(C),r==="custom"){const $=localStorage.getItem("soundfield_custom_pack");if($)try{const V=JSON.parse($),ie={level_id:n,pack_id:"custom",mode:"campaign",title:tT[n]||`Level ${n}`,round_duration_sec:30,species_count:V.length,species_pool:V,clip_selection:rT(n),channel_mode:nT(n),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"};o(ie),h(I(V,C))}catch(V){console.error("Failed to parse custom pack:",V)}m(!1);return}const B=R.find($=>$.pack_id===r&&$.level_id===n);if(B){if(o(B),i){const $=sessionStorage.getItem("roundSpecies");if($)try{const V=JSON.parse($),ie=B.species_pool||[],ae=V.filter(Q=>ie.includes(Q));if(ae.length===V.length){h(I(ae,C)),m(!1);return}}catch(V){console.error("Failed to parse saved species:",V)}}D(B,C)}m(!1)}).catch(R=>{console.error("Failed to load data:",R),m(!1)})},[r,n,i,I,D]),b.useEffect(()=>{if(u.length===0||a.length===0){_("idle");return}const R=u.map(V=>V.code),C=a.filter(V=>R.includes(V.species_code)&&!V.rejected);if(C.length===0){_("ready"),y({loaded:0,total:0});return}_("loading"),y({loaded:0,total:C.length}),console.log(`Preloading ${C.length} clips for ${R.length} species...`);let B=0;const $=C.map(async V=>{const ie=`/${V.file_path}`;try{const ae=await fetch(ie);ae.ok&&await ae.arrayBuffer()}catch(ae){console.warn("Failed to preload:",V.file_path,ae)}finally{B++,y({loaded:B,total:C.length})}});Promise.all($).then(()=>{console.log("Preloading complete!"),_("ready")})},[u,a]);const O=()=>{s&&a.length>0&&(L.current&&(L.current.pause(),L.current=null,f(null)),_("idle"),D(s,a))},M=R=>{if(console.log(`[Preview] Attempting to play: ${R.code}`),console.log(`[Preview] Clip path: ${R.clipPath}`),L.current&&(L.current.pause(),L.current=null),d===R.code){f(null);return}if(!R.clipPath){console.error(`[Preview] No clip path for ${R.code}!`);return}const C=new Audio(R.clipPath);L.current=C,f(R.code),C.play().then(()=>console.log(`[Preview] Playing ${R.code} successfully`)).catch(B=>{console.error(`[Preview] Failed to play ${R.code}:`,B),console.error(`[Preview] Clip path was: ${R.clipPath}`)}),C.onended=()=>{console.log(`[Preview] ${R.code} finished playing`),f(null),L.current=null}},j=()=>{L.current&&L.current.pause();const R=u.map(C=>C.code);sessionStorage.setItem("roundSpecies",JSON.stringify(R)),t(`/gameplay?mode=campaign&pack=${r}&level=${n}&preview=true`)};if(b.useEffect(()=>()=>{L.current&&L.current.pause()},[]),p)return c.jsx("div",{className:"screen screen-center",children:c.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading..."})});if(!s)return c.jsxs("div",{className:"screen screen-center",children:[c.jsx("div",{style:{color:"var(--color-error)"},children:"Level not found"}),c.jsx("button",{onClick:()=>t(-1),style:{marginTop:"16px",padding:"8px 16px",background:"var(--color-surface)",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"Go Back"})]});const N=eT[r]||r;return c.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",paddingTop:"calc(12px + var(--safe-area-top))",paddingBottom:"calc(12px + var(--safe-area-bottom))",paddingLeft:"16px",paddingRight:"16px",gap:"10px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("button",{className:"btn-icon",onClick:()=>t(`/level-select?pack=${r}`),"aria-label":"Back",style:{flexShrink:0},children:c.jsx(oT,{})}),c.jsxs("div",{style:{flex:1,minWidth:0},children:[c.jsx("h2",{style:{margin:0,fontSize:"14px",lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:N}),c.jsxs("div",{style:{fontSize:"12px",color:"var(--color-accent)",lineHeight:1.1},children:["Level ",s.level_id,": ",s.title]})]}),c.jsx("button",{onClick:()=>t(`/pack-select?scrollTo=${r}&expandPack=${r}#bird-reference`,{state:{fromPreview:!0,pack:r,level:n}}),style:{padding:"6px 10px",background:"transparent",border:"1px solid rgba(100, 181, 246, 0.3)",borderRadius:"6px",color:"#64B5F6",fontSize:"15px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",flexShrink:0,whiteSpace:"nowrap"},children:""}),s.species_pool&&s.species_pool.length>(s.species_count||0)&&c.jsx("button",{onClick:O,style:{padding:"6px 10px",background:"transparent",border:"1px solid var(--color-accent)",borderRadius:"6px",color:"var(--color-accent)",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",flexShrink:0},children:c.jsx(aT,{})})]}),c.jsxs("div",{style:{display:"flex",gap:"6px",fontSize:"12px"},children:[c.jsxs("button",{onClick:U,style:{flex:1,padding:"6px 8px",background:g?"rgba(76, 175, 80, 0.15)":"var(--color-surface)",border:g?"1px solid var(--color-success)":"1px solid transparent",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[c.jsx(lT,{filled:g,color:g?"var(--color-success)":void 0}),c.jsx("span",{style:{fontSize:"11px"},children:"Training"})]}),c.jsxs("button",{onClick:P,style:{flex:1,padding:"6px 8px",background:S?"rgba(100, 181, 246, 0.15)":"var(--color-surface)",border:S?"1px solid #64B5F6":"1px solid transparent",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"14px"},children:S?"":""}),c.jsx("span",{style:{fontSize:"11px"},children:S?"Taxonomic ":"Sort"})]})]}),v==="loading"&&c.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"6px",padding:"6px 10px"},children:[c.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"4px"},children:["Loading sounds ",x.loaded,"/",x.total]}),c.jsx("div",{style:{width:"100%",height:"3px",background:"rgba(0,0,0,0.2)",borderRadius:"2px",overflow:"hidden"},children:c.jsx("div",{style:{width:`${x.loaded/x.total*100}%`,height:"100%",background:"var(--color-accent)",transition:"width 0.2s ease"}})})]}),c.jsx("div",{style:{background:"rgba(100, 181, 246, 0.1)",border:"1px solid rgba(100, 181, 246, 0.3)",borderRadius:"8px",padding:"10px 12px"},children:c.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text)",lineHeight:1.4,textAlign:"center"},children:[c.jsx("strong",{children:" Study the grid:"})," Each bird will appear in the same position during play. Take a moment to memorize where each species lives on screenand any unfamiliar code names. Use  to mix it up. Engage  for speed-learning."]})}),c.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:0},children:[c.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Tap to preview signature song. Press and hold to get a closer look!"}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px",maxWidth:"320px",width:"100%"},children:u.map(R=>c.jsxs("button",{onClick:()=>M(R),disabled:!R.clipPath,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px",padding:"10px 6px",background:d===R.code?`${R.color}33`:"var(--color-surface)",border:`2px solid ${R.color}`,borderRadius:"10px",cursor:R.clipPath?"pointer":"not-allowed",opacity:R.clipPath?1:.5,transition:"transform 0.15s, background 0.15s",WebkitTapHighlightColor:"transparent"},children:[c.jsx("div",{style:{position:"relative",WebkitTapHighlightColor:"transparent"},children:c.jsx(iT,{code:R.code,size:52,color:R.color})}),c.jsx("div",{style:{fontSize:"10px",color:"var(--color-text)",textAlign:"center",lineHeight:1.2,maxWidth:"75px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontStyle:S&&R.scientificName?"italic":"normal"},children:S&&R.scientificName?R.scientificName:R.name})]},R.code))})]}),c.jsx("button",{onClick:j,style:{width:"100%",padding:"12px",fontSize:"15px",fontWeight:700,background:v==="ready"?"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)":"linear-gradient(135deg, #555 0%, #444 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 3px 10px rgba(45, 90, 39, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:v==="ready"?c.jsxs(c.Fragment,{children:["Ready to Play ",c.jsx(Ag,{})]}):v==="loading"?c.jsx(c.Fragment,{children:"Loading..."}):c.jsxs(c.Fragment,{children:["Ready to Play ",c.jsx(Ag,{})]})}),c.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.7; }
        }
        * {
          -webkit-tap-highlight-color: transparent;
        }
      `})]})}function oT(){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}function aT(){return c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M16 3h5v5"}),c.jsx("path",{d:"M4 20L21 3"}),c.jsx("path",{d:"M21 16v5h-5"}),c.jsx("path",{d:"M15 15l6 6"}),c.jsx("path",{d:"M4 4l5 5"})]})}function Ag(){return c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M8 5v14l11-7z"})})}function lT({filled:t,color:e}){const r=e||(t?"var(--color-accent)":"var(--color-text-muted)");return c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",children:[c.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),c.jsx("circle",{cx:"12",cy:"12",r:"3",fill:t?r:"none"})]})}const Gi=9,Cg="soundfield_custom_pack",Rg=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"];function cT(){const t=Xt(),[e,r]=b.useState([]),[n,i]=b.useState([]),[s,o]=b.useState(""),[a,l]=b.useState(null),[u,h]=b.useState(!0),d=b.useRef(null),f=b.useRef(null),[p,m]=b.useState(null);b.useEffect(()=>{fetch("/data/clips.json").then(S=>{if(!S.ok)throw new Error(`HTTP ${S.status}: ${S.statusText}`);return S.json()}).then(S=>{const T=new Map;for(const E of S)if(!E.rejected&&!T.has(E.species_code)){const F=S.find(L=>L.species_code===E.species_code&&L.canonical&&!L.rejected&&L.common_name)||S.find(L=>L.species_code===E.species_code&&L.common_name&&!L.rejected)||E;if(!F.common_name){console.warn(`Skipping ${E.species_code} - missing common_name`);continue}T.set(E.species_code,{code:E.species_code,name:F.common_name,clipPath:`/data/clips/${F.file_path.split("/").pop()}`})}const A=Array.from(T.values()).sort((E,k)=>(E.name||E.code).localeCompare(k.name||k.code));r(A),h(!1)}).catch(S=>{console.error("Failed to load clips:",S),h(!1)});try{const S=localStorage.getItem(Cg);if(S){const T=JSON.parse(S);Array.isArray(T)&&T.length>0&&i(T)}}catch(S){console.error("Failed to load saved pack:",S)}},[]);const v=b.useCallback(S=>{i(T=>{const A=T.includes(S),E=T.length>=Gi;return A?T.filter(k=>k!==S):E?T:(o(""),setTimeout(()=>{var k;(k=f.current)==null||k.focus()},0),[...T,S])})},[]),_=(S,T)=>{if(T.stopPropagation(),d.current&&(d.current.pause(),d.current=null),a===S.code){l(null);return}if(!S.clipPath)return;const A=new Audio(S.clipPath);d.current=A,l(S.code),A.play().catch(E=>console.error("Failed to play:",E)),A.onended=()=>{l(null),d.current=null}},x=()=>{n.length!==0&&(localStorage.setItem(Cg,JSON.stringify(n)),t("/level-select?pack=custom"))},y=()=>{i([])},g=()=>{o(""),setTimeout(()=>{var S;(S=f.current)==null||S.focus()},0)},w=s?e.filter(S=>S.name.toLowerCase().includes(s.toLowerCase())||S.code.toLowerCase().includes(s.toLowerCase())):e;return b.useEffect(()=>()=>{d.current&&d.current.pause()},[]),u?c.jsx("div",{className:"screen screen-center",children:c.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading species..."})}):c.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",overflow:"hidden"},children:[c.jsx("div",{style:{flexShrink:0,marginBottom:"12px"},children:c.jsxs("div",{className:"flex-row items-center gap-md",children:[c.jsx("button",{className:"btn-icon",onClick:()=>t("/pack-select"),"aria-label":"Back",children:c.jsx(hT,{})}),c.jsxs("div",{children:[c.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Custom Pack Builder"}),c.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:["Select up to ",Gi," birds"]})]})]})}),c.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",position:"relative"},children:[c.jsx("input",{ref:f,type:"text",placeholder:"Search birds...",value:s,onChange:S=>o(S.target.value),style:{width:"100%",padding:"10px 12px",paddingRight:s?"36px":"12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px"}}),s&&c.jsx("button",{onClick:g,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"var(--color-text-muted)",border:"none",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:0},"aria-label":"Clear search",children:c.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-background)",strokeWidth:"3",children:c.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),c.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",padding:"8px 12px",background:"rgba(45, 90, 39, 0.1)",borderRadius:"8px",fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.4},children:[c.jsx("span",{style:{color:"var(--color-accent)"},children:" Tip:"})," Click a ",c.jsx("strong",{style:{color:"var(--color-text)"},children:"bird icon"})," to add it to your pack. Hover over an icon and click the ",c.jsx("strong",{style:{color:"var(--color-text)"},children:" play button"})," to preview its signature sound."]}),n.length>0&&c.jsx("div",{style:{flexShrink:0,marginBottom:"12px",position:"sticky",top:"0",zIndex:100,paddingTop:"4px",paddingBottom:"4px",background:"var(--color-background)"},children:c.jsxs("button",{onClick:x,style:{width:"100%",padding:"14px 20px",fontSize:"16px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s"},children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M8 5v14l11-7z"})}),"Start with ",n.length," bird",n.length>1?"s":""]})}),c.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",padding:"8px 12px",background:n.length>0?"rgba(45, 90, 39, 0.2)":"var(--color-surface)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("span",{style:{fontSize:"14px"},children:[c.jsx("span",{style:{fontWeight:700,color:"var(--color-accent)"},children:n.length}),"/",Gi," selected"]}),n.length>0&&c.jsx("button",{onClick:y,style:{background:"none",border:"none",color:"var(--color-text-muted)",fontSize:"12px",cursor:"pointer",textDecoration:"underline"},children:"Clear all"})]}),c.jsx("div",{style:{flex:1,overflowY:"auto",marginBottom:"12px"},children:c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"8px"},children:w.map(S=>{const T=n.includes(S.code),A=n.indexOf(S.code),E=T?Rg[A%Rg.length]:void 0;return c.jsxs("button",{onClick:()=>v(S.code),onMouseEnter:()=>m(S.code),onMouseLeave:()=>m(null),disabled:!T&&n.length>=Gi,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px",padding:"12px 8px",background:T?`${E}22`:"var(--color-surface)",border:T?`2px solid ${E}`:"1px solid transparent",borderRadius:"12px",cursor:T||n.length<Gi?"pointer":"not-allowed",opacity:T||n.length<Gi?1:.5,textAlign:"center",transition:"all 0.15s",position:"relative"},children:[c.jsxs("div",{style:{position:"relative"},children:[c.jsx(uT,{code:S.code,size:48}),(p===S.code||a===S.code)&&c.jsx("div",{onClick:k=>_(S,k),style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"32px",height:"32px",borderRadius:"50%",background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.15s"},children:a===S.code?c.jsx(fT,{color:"#FFFFFF"}):c.jsx(dT,{})}),T&&c.jsx("div",{style:{position:"absolute",top:"-4px",right:"-4px",width:"20px",height:"20px",borderRadius:"50%",background:E,display:"flex",alignItems:"center",justifyContent:"center"},children:c.jsx(pT,{})})]}),c.jsx("div",{style:{width:"100%"},children:c.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:500},children:S.name})})]},S.code)})})})]})}function uT({code:t,size:e=48}){const[r,n]=b.useState(!0),i=`/data/icons/${t}.png`;return r?c.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>n(!1)}):c.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-text-muted)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:700,color:"#FFFFFF"},children:t})}function hT(){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}function dT(){return c.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"#FFFFFF",children:c.jsx("path",{d:"M8 5v14l11-7z"})})}function fT({color:t="currentColor"}){return c.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:t,children:c.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function pT(){return c.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1A1A2E",strokeWidth:"3",children:c.jsx("path",{d:"M20 6L9 17l-5-5"})})}const mT={campaign:"Learn",practice:"Practice",challenge:"Challenge",random:"Random"};function gT({score:t,streak:e,timeRemaining:r,mode:n,levelId:i,levelTitle:s}){const o=Math.floor(r/60),a=r%60,l=`${o}:${a.toString().padStart(2,"0")}`;return c.jsxs("div",{className:"hud",children:[c.jsxs("div",{className:"hud-score",children:[c.jsx("span",{className:"hud-label",children:"Score"}),c.jsx("span",{className:"hud-value",children:t.toLocaleString()})]}),c.jsxs("div",{className:"hud-center",children:[n==="campaign"&&i?c.jsxs("span",{className:"hud-mode",children:["Level ",i,s?`: ${s}`:""]}):n?c.jsx("span",{className:"hud-mode",children:mT[n]||n}):null,c.jsx("div",{className:"hud-streak",children:e===0?c.jsx("span",{className:"streak-dot",children:""}):Array.from({length:e}).map((u,h)=>c.jsx("span",{className:"streak-dot active",children:""},h))})]}),c.jsxs("div",{className:"hud-timer",children:[c.jsx("span",{className:"hud-label",children:"Time"}),c.jsx("span",{className:"hud-value",children:l})]}),c.jsx("style",{children:`
        .hud {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          padding-top: calc(12px + var(--safe-area-top, 0px));
          background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.3) 100%);
          border-bottom: 1px solid var(--color-surface);
        }

        .hud-score, .hud-timer {
          display: flex;
          flex-direction: column;
          align-items: center;
          min-width: 80px;
        }

        .hud-label {
          font-size: 10px;
          text-transform: uppercase;
          color: var(--color-text-muted);
          letter-spacing: 0.5px;
        }

        .hud-value {
          font-family: var(--font-mono);
          font-size: 20px;
          font-weight: 600;
          color: var(--color-accent);
        }

        .hud-center {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 4px;
        }

        .hud-mode {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1px;
          color: var(--color-text-muted);
          padding: 2px 8px;
          border-radius: 4px;
          background: rgba(255, 255, 255, 0.1);
        }

        .hud-streak {
          display: flex;
          gap: 4px;
          font-size: 12px;
        }

        .streak-dot {
          color: var(--color-text-muted);
          transition: color 0.2s, transform 0.2s;
        }

        .streak-dot.active {
          color: var(--color-accent);
          transform: scale(1.2);
        }
      `})]})}const xT=b.memo(gT);var ji=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(ji||{}),J0=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(J0||{}),Nd=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Nd||{}),le=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(le||{}),Nr=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(Nr||{}),W=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(W||{}),Es=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Es||{}),ne=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(ne||{}),Y=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(Y||{}),Qr=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(Qr||{}),Gn=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Gn||{}),Ur=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Ur||{}),Mt=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Mt||{}),Mr=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Mr||{}),Ip=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(Ip||{}),Jt=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(Jt||{}),et=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(et||{}),qe=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(qe||{}),Dr=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(Dr||{});const yT={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},K={ADAPTER:yT,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Hu=/iPhone/i,Pg=/iPod/i,Ig=/iPad/i,kg=/\biOS-universal(?:.+)Mac\b/i,Wu=/\bAndroid(?:.+)Mobile\b/i,Mg=/Android/i,Hi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ha=/Silk/i,Wr=/Windows Phone/i,Bg=/\bWindows(?:.+)ARM\b/i,jg=/BlackBerry/i,Ng=/BB10/i,Fg=/Opera Mini/i,Lg=/\b(CriOS|Chrome)(?:.+)Mobile/i,Dg=/Mobile(?:.+)Firefox\b/i,Og=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function vT(t){return function(e){return e.test(t)}}function Ug(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,n=r.split("[FBAN");typeof n[1]<"u"&&(r=n[0]),n=r.split("Twitter"),typeof n[1]<"u"&&(r=n[0]);var i=vT(r),s={apple:{phone:i(Hu)&&!i(Wr),ipod:i(Pg),tablet:!i(Hu)&&(i(Ig)||Og(e))&&!i(Wr),universal:i(kg),device:(i(Hu)||i(Pg)||i(Ig)||i(kg)||Og(e))&&!i(Wr)},amazon:{phone:i(Hi),tablet:!i(Hi)&&i(Ha),device:i(Hi)||i(Ha)},android:{phone:!i(Wr)&&i(Hi)||!i(Wr)&&i(Wu),tablet:!i(Wr)&&!i(Hi)&&!i(Wu)&&(i(Ha)||i(Mg)),device:!i(Wr)&&(i(Hi)||i(Ha)||i(Wu)||i(Mg))||i(/\bokhttp\b/i)},windows:{phone:i(Wr),tablet:i(Bg),device:i(Wr)||i(Bg)},other:{blackberry:i(jg),blackberry10:i(Ng),opera:i(Fg),firefox:i(Dg),chrome:i(Lg),device:i(jg)||i(Ng)||i(Fg)||i(Dg)||i(Lg)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const _T=Ug.default??Ug,Zr=_T(globalThis.navigator);K.RETINA_PREFIX=/@([0-9\.]+)x/;K.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var e_={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function s(l,u,h,d,f){if(typeof h!="function")throw new TypeError("The listener must be a function");var p=new i(h,d||l,f),m=r?r+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],p]:l._events[m].push(p):(l._events[m]=p,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],h,d;if(this._eventsCount===0)return u;for(d in h=this._events)e.call(h,d)&&u.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},a.prototype.listeners=function(u){var h=r?r+u:u,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,p=d.length,m=new Array(p);f<p;f++)m[f]=d[f].fn;return m},a.prototype.listenerCount=function(u){var h=r?r+u:u,d=this._events[h];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,h,d,f,p,m){var v=r?r+u:u;if(!this._events[v])return!1;var _=this._events[v],x=arguments.length,y,g;if(_.fn){switch(_.once&&this.removeListener(u,_.fn,void 0,!0),x){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,h),!0;case 3:return _.fn.call(_.context,h,d),!0;case 4:return _.fn.call(_.context,h,d,f),!0;case 5:return _.fn.call(_.context,h,d,f,p),!0;case 6:return _.fn.call(_.context,h,d,f,p,m),!0}for(g=1,y=new Array(x-1);g<x;g++)y[g-1]=arguments[g];_.fn.apply(_.context,y)}else{var w=_.length,S;for(g=0;g<w;g++)switch(_[g].once&&this.removeListener(u,_[g].fn,void 0,!0),x){case 1:_[g].fn.call(_[g].context);break;case 2:_[g].fn.call(_[g].context,h);break;case 3:_[g].fn.call(_[g].context,h,d);break;case 4:_[g].fn.call(_[g].context,h,d,f);break;default:if(!y)for(S=1,y=new Array(x-1);S<x;S++)y[S-1]=arguments[S];_[g].fn.apply(_[g].context,y)}}return!0},a.prototype.on=function(u,h,d){return s(this,u,h,d,!1)},a.prototype.once=function(u,h,d){return s(this,u,h,d,!0)},a.prototype.removeListener=function(u,h,d,f){var p=r?r+u:u;if(!this._events[p])return this;if(!h)return o(this,p),this;var m=this._events[p];if(m.fn)m.fn===h&&(!f||m.once)&&(!d||m.context===d)&&o(this,p);else{for(var v=0,_=[],x=m.length;v<x;v++)(m[v].fn!==h||f&&!m[v].once||d&&m[v].context!==d)&&_.push(m[v]);_.length?this._events[p]=_.length===1?_[0]:_:o(this,p)}return this},a.prototype.removeAllListeners=function(u){var h;return u?(h=r?r+u:u,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(e_);var wT=e_.exports;const ma=Mf(wT);var kp={exports:{}};kp.exports=Xc;kp.exports.default=Xc;function Xc(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=t_(t,0,i,r,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,h,d,f,p;if(n&&(s=AT(t,e,s,r)),t.length>80*r){a=u=t[0],l=h=t[1];for(var m=r;m<i;m+=r)d=t[m],f=t[m+1],d<a&&(a=d),f<l&&(l=f),d>u&&(u=d),f>h&&(h=f);p=Math.max(u-a,h-l),p=p!==0?32767/p:0}return na(s,o,r,a,l,p,0),o}function t_(t,e,r,n,i){var s,o;if(i===Dd(t,e,r,n)>0)for(s=e;s<r;s+=n)o=zg(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=zg(s,t[s],t[s+1],o);return o&&Yc(o,o.next)&&(sa(o),o=o.next),o}function Ai(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Yc(r,r.next)||Ue(r.prev,r,r.next)===0)){if(sa(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function na(t,e,r,n,i,s,o){if(t){!o&&s&&kT(t,n,i,s);for(var a=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,s?bT(t,n,i,s):ST(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),sa(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=ET(Ai(t),e,r),na(t,e,r,n,i,s,2)):o===2&&TT(t,e,r,n,i,s):na(Ai(t),e,r,n,i,s,1);break}}}}function ST(t){var e=t.prev,r=t,n=t.next;if(Ue(e,r,n)>=0)return!1;for(var i=e.x,s=r.x,o=n.x,a=e.y,l=r.y,u=n.y,h=i<s?i<o?i:o:s<o?s:o,d=a<l?a<u?a:u:l<u?l:u,f=i>s?i>o?i:o:s>o?s:o,p=a>l?a>u?a:u:l>u?l:u,m=n.next;m!==e;){if(m.x>=h&&m.x<=f&&m.y>=d&&m.y<=p&&gs(i,a,s,l,o,u,m.x,m.y)&&Ue(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function bT(t,e,r,n){var i=t.prev,s=t,o=t.next;if(Ue(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,u=o.x,h=i.y,d=s.y,f=o.y,p=a<l?a<u?a:u:l<u?l:u,m=h<d?h<f?h:f:d<f?d:f,v=a>l?a>u?a:u:l>u?l:u,_=h>d?h>f?h:f:d>f?d:f,x=Fd(p,m,e,r,n),y=Fd(v,_,e,r,n),g=t.prevZ,w=t.nextZ;g&&g.z>=x&&w&&w.z<=y;){if(g.x>=p&&g.x<=v&&g.y>=m&&g.y<=_&&g!==i&&g!==o&&gs(a,h,l,d,u,f,g.x,g.y)&&Ue(g.prev,g,g.next)>=0||(g=g.prevZ,w.x>=p&&w.x<=v&&w.y>=m&&w.y<=_&&w!==i&&w!==o&&gs(a,h,l,d,u,f,w.x,w.y)&&Ue(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;g&&g.z>=x;){if(g.x>=p&&g.x<=v&&g.y>=m&&g.y<=_&&g!==i&&g!==o&&gs(a,h,l,d,u,f,g.x,g.y)&&Ue(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;w&&w.z<=y;){if(w.x>=p&&w.x<=v&&w.y>=m&&w.y<=_&&w!==i&&w!==o&&gs(a,h,l,d,u,f,w.x,w.y)&&Ue(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function ET(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!Yc(i,s)&&r_(i,n,n.next,s)&&ia(i,s)&&ia(s,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(s.i/r|0),sa(n),sa(n.next),n=t=s),n=n.next}while(n!==t);return Ai(n)}function TT(t,e,r,n,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&jT(o,a)){var l=n_(o,a);o=Ai(o,o.next),l=Ai(l,l.next),na(o,e,r,n,i,s,0),na(l,e,r,n,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function AT(t,e,r,n){var i=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:t.length,u=t_(t,a,l,n,!1),u===u.next&&(u.steiner=!0),i.push(BT(u));for(i.sort(CT),s=0;s<i.length;s++)r=RT(i[s],r);return r}function CT(t,e){return t.x-e.x}function RT(t,e){var r=PT(t,e);if(!r)return e;var n=n_(r,t);return Ai(n,n.next),Ai(r,r.next)}function PT(t,e){var r=e,n=t.x,i=t.y,s=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s&&(s=a,o=r.x<r.next.x?r:r.next,a===n))return o}r=r.next}while(r!==e);if(!o)return null;var l=o,u=o.x,h=o.y,d=1/0,f;r=o;do n>=r.x&&r.x>=u&&n!==r.x&&gs(i<h?n:s,i,u,h,i<h?s:n,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(n-r.x),ia(r,t)&&(f<d||f===d&&(r.x>o.x||r.x===o.x&&IT(o,r)))&&(o=r,d=f)),r=r.next;while(r!==l);return o}function IT(t,e){return Ue(t.prev,t,e.prev)<0&&Ue(e.next,t,t.next)<0}function kT(t,e,r,n){var i=t;do i.z===0&&(i.z=Fd(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,MT(i)}function MT(t){var e,r,n,i,s,o,a,l,u=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,n=r,a=0,e=0;e<u&&(a++,n=n.nextZ,!!n);e++);for(l=u;a>0||l>0&&n;)a!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n}s.nextZ=null,u*=2}while(o>1);return t}function Fd(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function BT(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function gs(t,e,r,n,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(r-o)*(e-a)&&(r-o)*(s-a)>=(i-o)*(n-a)}function jT(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!NT(t,e)&&(ia(t,e)&&ia(e,t)&&FT(t,e)&&(Ue(t.prev,t,e.prev)||Ue(t,e.prev,e))||Yc(t,e)&&Ue(t.prev,t,t.next)>0&&Ue(e.prev,e,e.next)>0)}function Ue(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Yc(t,e){return t.x===e.x&&t.y===e.y}function r_(t,e,r,n){var i=$a(Ue(t,e,r)),s=$a(Ue(t,e,n)),o=$a(Ue(r,n,t)),a=$a(Ue(r,n,e));return!!(i!==s&&o!==a||i===0&&Wa(t,r,e)||s===0&&Wa(t,n,e)||o===0&&Wa(r,t,n)||a===0&&Wa(r,e,n))}function Wa(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function $a(t){return t>0?1:t<0?-1:0}function NT(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&r_(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function ia(t,e){return Ue(t.prev,t,t.next)<0?Ue(t,e,t.next)>=0&&Ue(t,t.prev,e)>=0:Ue(t,e,t.prev)<0||Ue(t,t.next,e)<0}function FT(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function n_(t,e){var r=new Ld(t.i,t.x,t.y),n=new Ld(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function zg(t,e,r,n){var i=new Ld(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function sa(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ld(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Xc.deviation=function(t,e,r,n){var i=e&&e.length,s=i?e[0]*r:t.length,o=Math.abs(Dd(t,0,s,r));if(i)for(var a=0,l=e.length;a<l;a++){var u=e[a]*r,h=a<l-1?e[a+1]*r:t.length;o-=Math.abs(Dd(t,u,h,r))}var d=0;for(a=0;a<n.length;a+=3){var f=n[a]*r,p=n[a+1]*r,m=n[a+2]*r;d+=Math.abs((t[f]-t[m])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[m+1]-t[f+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function Dd(t,e,r,n){for(var i=0,s=e,o=r-n;s<r;s+=n)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}Xc.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[i][s][o]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var LT=kp.exports;const DT=Mf(LT);var cc={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */cc.exports;(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof So=="object"&&So;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a=2147483647,l=36,u=1,h=26,d=38,f=700,p=72,m=128,v="-",_=/^xn--/,x=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=l-u,S=Math.floor,T=String.fromCharCode,A;function E(R){throw new RangeError(g[R])}function k(R,C){for(var B=R.length,$=[];B--;)$[B]=C(R[B]);return $}function F(R,C){var B=R.split("@"),$="";B.length>1&&($=B[0]+"@",R=B[1]),R=R.replace(y,".");var V=R.split("."),ie=k(V,C).join(".");return $+ie}function L(R){for(var C=[],B=0,$=R.length,V,ie;B<$;)V=R.charCodeAt(B++),V>=55296&&V<=56319&&B<$?(ie=R.charCodeAt(B++),(ie&64512)==56320?C.push(((V&1023)<<10)+(ie&1023)+65536):(C.push(V),B--)):C.push(V);return C}function U(R){return k(R,function(C){var B="";return C>65535&&(C-=65536,B+=T(C>>>10&1023|55296),C=56320|C&1023),B+=T(C),B}).join("")}function P(R){return R-48<10?R-22:R-65<26?R-65:R-97<26?R-97:l}function I(R,C){return R+22+75*(R<26)-((C!=0)<<5)}function D(R,C,B){var $=0;for(R=B?S(R/f):R>>1,R+=S(R/C);R>w*h>>1;$+=l)R=S(R/w);return S($+(w+1)*R/(R+d))}function O(R){var C=[],B=R.length,$,V=0,ie=m,ae=p,Q,me,Me,Pe,we,Se,Ee,Ve,_t;for(Q=R.lastIndexOf(v),Q<0&&(Q=0),me=0;me<Q;++me)R.charCodeAt(me)>=128&&E("not-basic"),C.push(R.charCodeAt(me));for(Me=Q>0?Q+1:0;Me<B;){for(Pe=V,we=1,Se=l;Me>=B&&E("invalid-input"),Ee=P(R.charCodeAt(Me++)),(Ee>=l||Ee>S((a-V)/we))&&E("overflow"),V+=Ee*we,Ve=Se<=ae?u:Se>=ae+h?h:Se-ae,!(Ee<Ve);Se+=l)_t=l-Ve,we>S(a/_t)&&E("overflow"),we*=_t;$=C.length+1,ae=D(V-Pe,$,Pe==0),S(V/$)>a-ie&&E("overflow"),ie+=S(V/$),V%=$,C.splice(V++,0,ie)}return U(C)}function M(R){var C,B,$,V,ie,ae,Q,me,Me,Pe,we,Se=[],Ee,Ve,_t,At;for(R=L(R),Ee=R.length,C=m,B=0,ie=p,ae=0;ae<Ee;++ae)we=R[ae],we<128&&Se.push(T(we));for($=V=Se.length,V&&Se.push(v);$<Ee;){for(Q=a,ae=0;ae<Ee;++ae)we=R[ae],we>=C&&we<Q&&(Q=we);for(Ve=$+1,Q-C>S((a-B)/Ve)&&E("overflow"),B+=(Q-C)*Ve,C=Q,ae=0;ae<Ee;++ae)if(we=R[ae],we<C&&++B>a&&E("overflow"),we==C){for(me=B,Me=l;Pe=Me<=ie?u:Me>=ie+h?h:Me-ie,!(me<Pe);Me+=l)At=me-Pe,_t=l-Pe,Se.push(T(I(Pe+At%_t,0))),me=S(At/_t);Se.push(T(I(me,0))),ie=D(B,Ve,$==V),B=0,++$}++B,++C}return Se.join("")}function j(R){return F(R,function(C){return _.test(C)?O(C.slice(4).toLowerCase()):C})}function N(R){return F(R,function(C){return x.test(C)?"xn--"+M(C):C})}if(o={version:"1.4.1",ucs2:{decode:L,encode:U},decode:O,encode:M,toASCII:N,toUnicode:j},n&&i)if(t.exports==n)i.exports=o;else for(A in o)o.hasOwnProperty(A)&&(n[A]=o[A]);else r.punycode=o})(So)})(cc,cc.exports);var OT=cc.exports,Vs=TypeError;const UT={},zT=Object.freeze(Object.defineProperty({__proto__:null,default:UT},Symbol.toStringTag,{value:"Module"})),GT=tw(zT);var Mp=typeof Map=="function"&&Map.prototype,$u=Object.getOwnPropertyDescriptor&&Mp?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,uc=Mp&&$u&&typeof $u.get=="function"?$u.get:null,Gg=Mp&&Map.prototype.forEach,Bp=typeof Set=="function"&&Set.prototype,Vu=Object.getOwnPropertyDescriptor&&Bp?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,hc=Bp&&Vu&&typeof Vu.get=="function"?Vu.get:null,Hg=Bp&&Set.prototype.forEach,HT=typeof WeakMap=="function"&&WeakMap.prototype,Mo=HT?WeakMap.prototype.has:null,WT=typeof WeakSet=="function"&&WeakSet.prototype,Bo=WT?WeakSet.prototype.has:null,$T=typeof WeakRef=="function"&&WeakRef.prototype,Wg=$T?WeakRef.prototype.deref:null,VT=Boolean.prototype.valueOf,XT=Object.prototype.toString,YT=Function.prototype.toString,KT=String.prototype.match,jp=String.prototype.slice,In=String.prototype.replace,qT=String.prototype.toUpperCase,$g=String.prototype.toLowerCase,i_=RegExp.prototype.test,Vg=Array.prototype.concat,Br=Array.prototype.join,QT=Array.prototype.slice,Xg=Math.floor,Od=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Xu=Object.getOwnPropertySymbols,Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Os=typeof Symbol=="function"&&typeof Symbol.iterator=="object",jo=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Os||!0)?Symbol.toStringTag:null,s_=Object.prototype.propertyIsEnumerable,Yg=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Kg(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||i_.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-Xg(-t):Xg(t);if(n!==t){var i=String(n),s=jp.call(e,i.length+1);return In.call(i,r,"$&_")+"."+In.call(In.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return In.call(e,r,"$&_")}var zd=GT,qg=zd.custom,Qg=l_(qg)?qg:null,o_={__proto__:null,double:'"',single:"'"},ZT={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},Kc=function t(e,r,n,i){var s=r||{};if(Xr(s,"quoteStyle")&&!Xr(o_,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Xr(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Xr(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Xr(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Xr(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return u_(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?Kg(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return a?Kg(e,u):u}var h=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=h&&h>0&&typeof e=="object")return Gd(e)?"[Array]":"[Object]";var d=gA(s,n);if(typeof i>"u")i=[];else if(c_(i,e)>=0)return"[Circular]";function f(P,I,D){if(I&&(i=QT.call(i),i.push(I)),D){var O={depth:s.depth};return Xr(s,"quoteStyle")&&(O.quoteStyle=s.quoteStyle),t(P,O,n+1,i)}return t(P,s,n+1,i)}if(typeof e=="function"&&!Zg(e)){var p=aA(e),m=Va(e,f);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(m.length>0?" { "+Br.call(m,", ")+" }":"")}if(l_(e)){var v=Os?In.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Ud.call(e);return typeof e=="object"&&!Os?io(v):v}if(fA(e)){for(var _="<"+$g.call(String(e.nodeName)),x=e.attributes||[],y=0;y<x.length;y++)_+=" "+x[y].name+"="+a_(JT(x[y].value),"double",s);return _+=">",e.childNodes&&e.childNodes.length&&(_+="..."),_+="</"+$g.call(String(e.nodeName))+">",_}if(Gd(e)){if(e.length===0)return"[]";var g=Va(e,f);return d&&!mA(g)?"["+Hd(g,d)+"]":"[ "+Br.call(g,", ")+" ]"}if(tA(e)){var w=Va(e,f);return!("cause"in Error.prototype)&&"cause"in e&&!s_.call(e,"cause")?"{ ["+String(e)+"] "+Br.call(Vg.call("[cause]: "+f(e.cause),w),", ")+" }":w.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Br.call(w,", ")+" }"}if(typeof e=="object"&&o){if(Qg&&typeof e[Qg]=="function"&&zd)return zd(e,{depth:h-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(lA(e)){var S=[];return Gg&&Gg.call(e,function(P,I){S.push(f(I,e,!0)+" => "+f(P,e))}),Jg("Map",uc.call(e),S,d)}if(hA(e)){var T=[];return Hg&&Hg.call(e,function(P){T.push(f(P,e))}),Jg("Set",hc.call(e),T,d)}if(cA(e))return Yu("WeakMap");if(dA(e))return Yu("WeakSet");if(uA(e))return Yu("WeakRef");if(nA(e))return io(f(Number(e)));if(sA(e))return io(f(Od.call(e)));if(iA(e))return io(VT.call(e));if(rA(e))return io(f(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof So<"u"&&e===So)return"{ [object globalThis] }";if(!eA(e)&&!Zg(e)){var A=Va(e,f),E=Yg?Yg(e)===Object.prototype:e instanceof Object||e.constructor===Object,k=e instanceof Object?"":"null prototype",F=!E&&jo&&Object(e)===e&&jo in e?jp.call(Zn(e),8,-1):k?"Object":"",L=E||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",U=L+(F||k?"["+Br.call(Vg.call([],F||[],k||[]),": ")+"] ":"");return A.length===0?U+"{}":d?U+"{"+Hd(A,d)+"}":U+"{ "+Br.call(A,", ")+" }"}return String(e)};function a_(t,e,r){var n=r.quoteStyle||e,i=o_[n];return i+t+i}function JT(t){return In.call(String(t),/"/g,"&quot;")}function Ni(t){return!jo||!(typeof t=="object"&&(jo in t||typeof t[jo]<"u"))}function Gd(t){return Zn(t)==="[object Array]"&&Ni(t)}function eA(t){return Zn(t)==="[object Date]"&&Ni(t)}function Zg(t){return Zn(t)==="[object RegExp]"&&Ni(t)}function tA(t){return Zn(t)==="[object Error]"&&Ni(t)}function rA(t){return Zn(t)==="[object String]"&&Ni(t)}function nA(t){return Zn(t)==="[object Number]"&&Ni(t)}function iA(t){return Zn(t)==="[object Boolean]"&&Ni(t)}function l_(t){if(Os)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Ud)return!1;try{return Ud.call(t),!0}catch{}return!1}function sA(t){if(!t||typeof t!="object"||!Od)return!1;try{return Od.call(t),!0}catch{}return!1}var oA=Object.prototype.hasOwnProperty||function(t){return t in this};function Xr(t,e){return oA.call(t,e)}function Zn(t){return XT.call(t)}function aA(t){if(t.name)return t.name;var e=KT.call(YT.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function c_(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function lA(t){if(!uc||!t||typeof t!="object")return!1;try{uc.call(t);try{hc.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function cA(t){if(!Mo||!t||typeof t!="object")return!1;try{Mo.call(t,Mo);try{Bo.call(t,Bo)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function uA(t){if(!Wg||!t||typeof t!="object")return!1;try{return Wg.call(t),!0}catch{}return!1}function hA(t){if(!hc||!t||typeof t!="object")return!1;try{hc.call(t);try{uc.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function dA(t){if(!Bo||!t||typeof t!="object")return!1;try{Bo.call(t,Bo);try{Mo.call(t,Mo)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function fA(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function u_(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return u_(jp.call(t,0,e.maxStringLength),e)+n}var i=ZT[e.quoteStyle||"single"];i.lastIndex=0;var s=In.call(In.call(t,i,"\\$1"),/[\x00-\x1f]/g,pA);return a_(s,"single",e)}function pA(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+qT.call(e.toString(16))}function io(t){return"Object("+t+")"}function Yu(t){return t+" { ? }"}function Jg(t,e,r,n){var i=n?Hd(r,n):Br.call(r,", ");return t+" ("+e+") {"+i+"}"}function mA(t){for(var e=0;e<t.length;e++)if(c_(t[e],`
`)>=0)return!1;return!0}function gA(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=Br.call(Array(t.indent+1)," ");else return null;return{base:r,prev:Br.call(Array(e+1),r)}}function Hd(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+Br.call(t,","+r)+`
`+e.prev}function Va(t,e){var r=Gd(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=Xr(t,i)?e(t[i],t):""}var s=typeof Xu=="function"?Xu(t):[],o;if(Os){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in t)Xr(t,l)&&(r&&String(Number(l))===l&&l<t.length||Os&&o["$"+l]instanceof Symbol||(i_.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if(typeof Xu=="function")for(var u=0;u<s.length;u++)s_.call(t,s[u])&&n.push("["+e(s[u])+"]: "+e(t[s[u]],t));return n}var xA=Kc,yA=Vs,qc=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},vA=function(t,e){if(t){var r=qc(t,e);return r&&r.value}},_A=function(t,e,r){var n=qc(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},wA=function(t,e){return t?!!qc(t,e):!1},SA=function(t,e){if(t)return qc(t,e,!0)},bA=function(){var e,r={assert:function(n){if(!r.has(n))throw new yA("Side channel does not contain "+xA(n))},delete:function(n){var i=e&&e.next,s=SA(e,n);return s&&i&&i===s&&(e=void 0),!!s},get:function(n){return vA(e,n)},has:function(n){return wA(e,n)},set:function(n,i){e||(e={next:void 0}),_A(e,n,i)}};return r},h_=Object,EA=Error,TA=EvalError,AA=RangeError,CA=ReferenceError,RA=SyntaxError,PA=URIError,IA=Math.abs,kA=Math.floor,MA=Math.max,BA=Math.min,jA=Math.pow,NA=Math.round,FA=Number.isNaN||function(e){return e!==e},LA=FA,DA=function(e){return LA(e)||e===0?e:e<0?-1:1},OA=Object.getOwnPropertyDescriptor,Al=OA;if(Al)try{Al([],"length")}catch{Al=null}var d_=Al,Cl=Object.defineProperty||!1;if(Cl)try{Cl({},"a",{value:1})}catch{Cl=!1}var UA=Cl,Ku,ex;function zA(){return ex||(ex=1,Ku=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),Ku}var qu,tx;function GA(){if(tx)return qu;tx=1;var t=typeof Symbol<"u"&&Symbol,e=zA();return qu=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},qu}var Qu,rx;function f_(){return rx||(rx=1,Qu=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Qu}var Zu,nx;function p_(){if(nx)return Zu;nx=1;var t=h_;return Zu=t.getPrototypeOf||null,Zu}var HA="Function.prototype.bind called on incompatible ",WA=Object.prototype.toString,$A=Math.max,VA="[object Function]",ix=function(e,r){for(var n=[],i=0;i<e.length;i+=1)n[i]=e[i];for(var s=0;s<r.length;s+=1)n[s+e.length]=r[s];return n},XA=function(e,r){for(var n=[],i=r,s=0;i<e.length;i+=1,s+=1)n[s]=e[i];return n},YA=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},KA=function(e){var r=this;if(typeof r!="function"||WA.apply(r)!==VA)throw new TypeError(HA+r);for(var n=XA(arguments,1),i,s=function(){if(this instanceof i){var h=r.apply(this,ix(n,arguments));return Object(h)===h?h:this}return r.apply(e,ix(n,arguments))},o=$A(0,r.length-n.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+YA(a,",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var u=function(){};u.prototype=r.prototype,i.prototype=new u,u.prototype=null}return i},qA=KA,Qc=Function.prototype.bind||qA,Np=Function.prototype.call,Ju,sx;function m_(){return sx||(sx=1,Ju=Function.prototype.apply),Ju}var QA=typeof Reflect<"u"&&Reflect&&Reflect.apply,ZA=Qc,JA=m_(),eC=Np,tC=QA,rC=tC||ZA.call(eC,JA),nC=Qc,iC=Vs,sC=Np,oC=rC,g_=function(e){if(e.length<1||typeof e[0]!="function")throw new iC("a function is required");return oC(nC,sC,e)},eh,ox;function aC(){if(ox)return eh;ox=1;var t=g_,e=d_,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return eh=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,eh}var th,ax;function lC(){if(ax)return th;ax=1;var t=f_(),e=p_(),r=aC();return th=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,th}var rh,lx;function cC(){if(lx)return rh;lx=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=Qc;return rh=r.call(t,e),rh}var ge,uC=h_,hC=EA,dC=TA,fC=AA,pC=CA,Us=RA,Ts=Vs,mC=PA,gC=IA,xC=kA,yC=MA,vC=BA,_C=jA,wC=NA,SC=DA,x_=Function,nh=function(t){try{return x_('"use strict"; return ('+t+").constructor;")()}catch{}},oa=d_,bC=UA,ih=function(){throw new Ts},EC=oa?function(){try{return arguments.callee,ih}catch{try{return oa(arguments,"callee").get}catch{return ih}}}():ih,Wi=GA()(),nt=lC(),TC=p_(),AC=f_(),y_=m_(),ga=Np,Qi={},CC=typeof Uint8Array>"u"||!nt?ge:nt(Uint8Array),yi={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?ge:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ge:ArrayBuffer,"%ArrayIteratorPrototype%":Wi&&nt?nt([][Symbol.iterator]()):ge,"%AsyncFromSyncIteratorPrototype%":ge,"%AsyncFunction%":Qi,"%AsyncGenerator%":Qi,"%AsyncGeneratorFunction%":Qi,"%AsyncIteratorPrototype%":Qi,"%Atomics%":typeof Atomics>"u"?ge:Atomics,"%BigInt%":typeof BigInt>"u"?ge:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ge:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ge:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ge:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":hC,"%eval%":eval,"%EvalError%":dC,"%Float16Array%":typeof Float16Array>"u"?ge:Float16Array,"%Float32Array%":typeof Float32Array>"u"?ge:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ge:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ge:FinalizationRegistry,"%Function%":x_,"%GeneratorFunction%":Qi,"%Int8Array%":typeof Int8Array>"u"?ge:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ge:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ge:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Wi&&nt?nt(nt([][Symbol.iterator]())):ge,"%JSON%":typeof JSON=="object"?JSON:ge,"%Map%":typeof Map>"u"?ge:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Wi||!nt?ge:nt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":uC,"%Object.getOwnPropertyDescriptor%":oa,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ge:Promise,"%Proxy%":typeof Proxy>"u"?ge:Proxy,"%RangeError%":fC,"%ReferenceError%":pC,"%Reflect%":typeof Reflect>"u"?ge:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ge:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Wi||!nt?ge:nt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ge:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Wi&&nt?nt(""[Symbol.iterator]()):ge,"%Symbol%":Wi?Symbol:ge,"%SyntaxError%":Us,"%ThrowTypeError%":EC,"%TypedArray%":CC,"%TypeError%":Ts,"%Uint8Array%":typeof Uint8Array>"u"?ge:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ge:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ge:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ge:Uint32Array,"%URIError%":mC,"%WeakMap%":typeof WeakMap>"u"?ge:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ge:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ge:WeakSet,"%Function.prototype.call%":ga,"%Function.prototype.apply%":y_,"%Object.defineProperty%":bC,"%Object.getPrototypeOf%":TC,"%Math.abs%":gC,"%Math.floor%":xC,"%Math.max%":yC,"%Math.min%":vC,"%Math.pow%":_C,"%Math.round%":wC,"%Math.sign%":SC,"%Reflect.getPrototypeOf%":AC};if(nt)try{null.error}catch(t){var RC=nt(nt(t));yi["%Error.prototype%"]=RC}var PC=function t(e){var r;if(e==="%AsyncFunction%")r=nh("async function () {}");else if(e==="%GeneratorFunction%")r=nh("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=nh("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&nt&&(r=nt(i.prototype))}return yi[e]=r,r},cx={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},xa=Qc,dc=cC(),IC=xa.call(ga,Array.prototype.concat),kC=xa.call(y_,Array.prototype.splice),ux=xa.call(ga,String.prototype.replace),fc=xa.call(ga,String.prototype.slice),MC=xa.call(ga,RegExp.prototype.exec),BC=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,jC=/\\(\\)?/g,NC=function(e){var r=fc(e,0,1),n=fc(e,-1);if(r==="%"&&n!=="%")throw new Us("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Us("invalid intrinsic syntax, expected opening `%`");var i=[];return ux(e,BC,function(s,o,a,l){i[i.length]=a?ux(l,jC,"$1"):o||s}),i},FC=function(e,r){var n=e,i;if(dc(cx,n)&&(i=cx[n],n="%"+i[0]+"%"),dc(yi,n)){var s=yi[n];if(s===Qi&&(s=PC(n)),typeof s>"u"&&!r)throw new Ts("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Us("intrinsic "+e+" does not exist!")},Fp=function(e,r){if(typeof e!="string"||e.length===0)throw new Ts("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Ts('"allowMissing" argument must be a boolean');if(MC(/^%?[^%]*%?$/,e)===null)throw new Us("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=NC(e),i=n.length>0?n[0]:"",s=FC("%"+i+"%",r),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],kC(n,IC([0,1],u)));for(var h=1,d=!0;h<n.length;h+=1){var f=n[h],p=fc(f,0,1),m=fc(f,-1);if((p==='"'||p==="'"||p==="`"||m==='"'||m==="'"||m==="`")&&p!==m)throw new Us("property names with quotes must have matching quotes");if((f==="constructor"||!d)&&(l=!0),i+="."+f,o="%"+i+"%",dc(yi,o))a=yi[o];else if(a!=null){if(!(f in a)){if(!r)throw new Ts("base intrinsic for "+e+" exists, but the property is not available.");return}if(oa&&h+1>=n.length){var v=oa(a,f);d=!!v,d&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else d=dc(a,f),a=a[f];d&&!l&&(yi[o]=a)}}return a},v_=Fp,__=g_,LC=__([v_("%String.prototype.indexOf%")]),w_=function(e,r){var n=v_(e,!!r);return typeof n=="function"&&LC(e,".prototype.")>-1?__([n]):n},DC=Fp,ya=w_,OC=Kc,UC=Vs,hx=DC("%Map%",!0),zC=ya("Map.prototype.get",!0),GC=ya("Map.prototype.set",!0),HC=ya("Map.prototype.has",!0),WC=ya("Map.prototype.delete",!0),$C=ya("Map.prototype.size",!0),S_=!!hx&&function(){var e,r={assert:function(n){if(!r.has(n))throw new UC("Side channel does not contain "+OC(n))},delete:function(n){if(e){var i=WC(e,n);return $C(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return zC(e,n)},has:function(n){return e?HC(e,n):!1},set:function(n,i){e||(e=new hx),GC(e,n,i)}};return r},VC=Fp,Zc=w_,XC=Kc,Xa=S_,YC=Vs,$i=VC("%WeakMap%",!0),KC=Zc("WeakMap.prototype.get",!0),qC=Zc("WeakMap.prototype.set",!0),QC=Zc("WeakMap.prototype.has",!0),ZC=Zc("WeakMap.prototype.delete",!0),JC=$i?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new YC("Side channel does not contain "+XC(i))},delete:function(i){if($i&&i&&(typeof i=="object"||typeof i=="function")){if(e)return ZC(e,i)}else if(Xa&&r)return r.delete(i);return!1},get:function(i){return $i&&i&&(typeof i=="object"||typeof i=="function")&&e?KC(e,i):r&&r.get(i)},has:function(i){return $i&&i&&(typeof i=="object"||typeof i=="function")&&e?QC(e,i):!!r&&r.has(i)},set:function(i,s){$i&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new $i),qC(e,i,s)):Xa&&(r||(r=Xa()),r.set(i,s))}};return n}:Xa,e2=Vs,t2=Kc,r2=bA,n2=S_,i2=JC,s2=i2||n2||r2,b_=function(){var e,r={assert:function(n){if(!r.has(n))throw new e2("Side channel does not contain "+t2(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=s2()),e.set(n,i)}};return r},o2=String.prototype.replace,a2=/%20/g,sh={RFC1738:"RFC1738",RFC3986:"RFC3986"},Lp={default:sh.RFC3986,formatters:{RFC1738:function(t){return o2.call(t,a2,"+")},RFC3986:function(t){return String(t)}},RFC1738:sh.RFC1738,RFC3986:sh.RFC3986},l2=Lp,c2=b_,oh=Object.prototype.hasOwnProperty,hi=Array.isArray,Jc=c2(),E_=function(e,r){return Jc.set(e,r),e},pc=function(e){return Jc.has(e)},Wd=function(e){return Jc.get(e)},T_=function(e,r){Jc.set(e,r)},br=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),u2=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(hi(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]<"u"&&i.push(n[s]);r.obj[r.prop]=i}}},Dp=function(e,r){for(var n=r&&r.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},h2=function t(e,r,n){if(!r)return e;if(typeof r!="object"&&typeof r!="function"){if(hi(e))e.push(r);else if(e&&typeof e=="object")if(pc(e)){var i=Wd(e)+1;e[i]=r,T_(e,i)}else(n&&(n.plainObjects||n.allowPrototypes)||!oh.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object"){if(pc(r)){for(var s=Object.keys(r),o=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},a=0;a<s.length;a++){var l=parseInt(s[a],10);o[l+1]=r[s[a]]}return E_(o,Wd(r)+1)}return[e].concat(r)}var u=e;return hi(e)&&!hi(r)&&(u=Dp(e,n)),hi(e)&&hi(r)?(r.forEach(function(h,d){if(oh.call(e,d)){var f=e[d];f&&typeof f=="object"&&h&&typeof h=="object"?e[d]=t(f,h,n):e.push(h)}else e[d]=h}),e):Object.keys(r).reduce(function(h,d){var f=r[d];return oh.call(h,d)?h[d]=t(h[d],f,n):h[d]=f,h},u)},d2=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},f2=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},ah=1024,p2=function(e,r,n,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(p){return"%26%23"+parseInt(p.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;l+=ah){for(var u=o.length>=ah?o.slice(l,l+ah):o,h=[],d=0;d<u.length;++d){var f=u.charCodeAt(d);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||s===l2.RFC1738&&(f===40||f===41)){h[h.length]=u.charAt(d);continue}if(f<128){h[h.length]=br[f];continue}if(f<2048){h[h.length]=br[192|f>>6]+br[128|f&63];continue}if(f<55296||f>=57344){h[h.length]=br[224|f>>12]+br[128|f>>6&63]+br[128|f&63];continue}d+=1,f=65536+((f&1023)<<10|u.charCodeAt(d)&1023),h[h.length]=br[240|f>>18]+br[128|f>>12&63]+br[128|f>>6&63]+br[128|f&63]}a+=h.join("")}return a},m2=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var u=a[l],h=o[u];typeof h=="object"&&h!==null&&n.indexOf(h)===-1&&(r.push({obj:o,prop:u}),n.push(h))}return u2(r),e},g2=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},x2=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},y2=function(e,r,n,i){if(pc(e)){var s=Wd(e)+1;return e[s]=r,T_(e,s),e}var o=[].concat(e,r);return o.length>n?E_(Dp(o,{plainObjects:i}),o.length-1):o},v2=function(e,r){if(hi(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},A_={arrayToObject:Dp,assign:d2,combine:y2,compact:m2,decode:f2,encode:p2,isBuffer:x2,isOverflow:pc,isRegExp:g2,maybeMap:v2,merge:h2},C_=b_,Rl=A_,No=Lp,_2=Object.prototype.hasOwnProperty,R_={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},kr=Array.isArray,w2=Array.prototype.push,P_=function(t,e){w2.apply(t,kr(e)?e:[e])},S2=Date.prototype.toISOString,dx=No.default,Je={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Rl.encode,encodeValuesOnly:!1,filter:void 0,format:dx,formatter:No.formatters[dx],indices:!1,serializeDate:function(e){return S2.call(e)},skipNulls:!1,strictNullHandling:!1},b2=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},lh={},E2=function t(e,r,n,i,s,o,a,l,u,h,d,f,p,m,v,_,x,y){for(var g=e,w=y,S=0,T=!1;(w=w.get(lh))!==void 0&&!T;){var A=w.get(e);if(S+=1,typeof A<"u"){if(A===S)throw new RangeError("Cyclic object value");T=!0}typeof w.get(lh)>"u"&&(S=0)}if(typeof h=="function"?g=h(r,g):g instanceof Date?g=p(g):n==="comma"&&kr(g)&&(g=Rl.maybeMap(g,function(R){return R instanceof Date?p(R):R})),g===null){if(o)return u&&!_?u(r,Je.encoder,x,"key",m):r;g=""}if(b2(g)||Rl.isBuffer(g)){if(u){var E=_?r:u(r,Je.encoder,x,"key",m);return[v(E)+"="+v(u(g,Je.encoder,x,"value",m))]}return[v(r)+"="+v(String(g))]}var k=[];if(typeof g>"u")return k;var F;if(n==="comma"&&kr(g))_&&u&&(g=Rl.maybeMap(g,u)),F=[{value:g.length>0?g.join(",")||null:void 0}];else if(kr(h))F=h;else{var L=Object.keys(g);F=d?L.sort(d):L}var U=l?String(r).replace(/\./g,"%2E"):String(r),P=i&&kr(g)&&g.length===1?U+"[]":U;if(s&&kr(g)&&g.length===0)return P+"[]";for(var I=0;I<F.length;++I){var D=F[I],O=typeof D=="object"&&D&&typeof D.value<"u"?D.value:g[D];if(!(a&&O===null)){var M=f&&l?String(D).replace(/\./g,"%2E"):String(D),j=kr(g)?typeof n=="function"?n(P,M):P:P+(f?"."+M:"["+M+"]");y.set(e,S);var N=C_();N.set(lh,y),P_(k,t(O,j,n,i,s,o,a,l,n==="comma"&&_&&kr(g)?null:u,h,d,f,p,m,v,_,x,N))}}return k},T2=function(e){if(!e)return Je;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||Je.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=No.default;if(typeof e.format<"u"){if(!_2.call(No.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=No.formatters[n],s=Je.filter;(typeof e.filter=="function"||kr(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in R_?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=Je.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Je.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Je.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Je.allowEmptyArrays,arrayFormat:o,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Je.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Je.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Je.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Je.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Je.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Je.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Je.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Je.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Je.strictNullHandling}},A2=function(t,e){var r=t,n=T2(e),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):kr(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var a=R_[n.arrayFormat],l=a==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var u=C_(),h=0;h<i.length;++h){var d=i[h],f=r[d];n.skipNulls&&f===null||P_(o,E2(f,d,a,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var p=o.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),p.length>0?m+p:""},$n=A_,Pl=Object.prototype.hasOwnProperty,fx=Array.isArray,We={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:$n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},C2=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},I_=function(t,e,r){if(t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&r>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return t},R2="utf8=%26%2310003%3B",P2="utf8=%E2%9C%93",I2=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,r.throwOnLimitExceeded?s+1:s);if(r.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,l,u=r.charset;if(r.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===P2?u="utf-8":o[l]===R2&&(u="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var h=o[l],d=h.indexOf("]="),f=d===-1?h.indexOf("="):d+1,p,m;if(f===-1?(p=r.decoder(h,We.decoder,u,"key"),m=r.strictNullHandling?null:""):(p=r.decoder(h.slice(0,f),We.decoder,u,"key"),p!==null&&(m=$n.maybeMap(I_(h.slice(f+1),r,fx(n[p])?n[p].length:0),function(_){return r.decoder(_,We.decoder,u,"value")}))),m&&r.interpretNumericEntities&&u==="iso-8859-1"&&(m=C2(String(m))),h.indexOf("[]=")>-1&&(m=fx(m)?[m]:m),p!==null){var v=Pl.call(n,p);v&&r.duplicates==="combine"?n[p]=$n.combine(n[p],m,r.arrayLimit,r.plainObjects):(!v||r.duplicates==="last")&&(n[p]=m)}}return n},k2=function(t,e,r,n){var i=0;if(t.length>0&&t[t.length-1]==="[]"){var s=t.slice(0,-1).join("");i=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=n?e:I_(e,r,i),a=t.length-1;a>=0;--a){var l,u=t[a];if(u==="[]"&&r.parseArrays)$n.isOverflow(o)?l=o:l=r.allowEmptyArrays&&(o===""||r.strictNullHandling&&o===null)?[]:$n.combine([],o,r.arrayLimit,r.plainObjects);else{l=r.plainObjects?{__proto__:null}:{};var h=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,d=r.decodeDotInKeys?h.replace(/%2E/g,"."):h,f=parseInt(d,10);!r.parseArrays&&d===""?l={0:o}:!isNaN(f)&&u!==d&&String(f)===d&&f>=0&&r.parseArrays&&f<=r.arrayLimit?(l=[],l[f]=o):d!=="__proto__"&&(l[d]=o)}o=l}return o},M2=function(e,r){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e;if(r.depth<=0)return!r.plainObjects&&Pl.call(Object.prototype,n)&&!r.allowPrototypes?void 0:[n];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(n),a=o?n.slice(0,o.index):n,l=[];if(a){if(!r.plainObjects&&Pl.call(Object.prototype,a)&&!r.allowPrototypes)return;l.push(a)}for(var u=0;(o=s.exec(n))!==null&&u<r.depth;){u+=1;var h=o[1].slice(1,-1);if(!r.plainObjects&&Pl.call(Object.prototype,h)&&!r.allowPrototypes)return;l.push(o[1])}if(o){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");l.push("["+n.slice(o.index)+"]")}return l},B2=function(e,r,n,i){if(e){var s=M2(e,n);if(s)return k2(s,r,n,i)}},j2=function(e){if(!e)return We;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=typeof e.charset>"u"?We.charset:e.charset,n=typeof e.duplicates>"u"?We.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:We.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:We.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:We.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:We.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:We.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:We.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:We.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:We.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:We.decoder,delimiter:typeof e.delimiter=="string"||$n.isRegExp(e.delimiter)?e.delimiter:We.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:We.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:We.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:We.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:We.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:We.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:We.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},N2=function(t,e){var r=j2(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?{__proto__:null}:{};for(var n=typeof t=="string"?I2(t,r):t,i=r.plainObjects?{__proto__:null}:{},s=Object.keys(n),o=0;o<s.length;++o){var a=s[o],l=B2(a,n[a],r,typeof t=="string");i=$n.merge(i,l,r)}return r.allowSparse===!0?i:$n.compact(i)},F2=A2,L2=N2,D2=Lp,O2={formats:D2,parse:L2,stringify:F2},U2=OT;function rn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var z2=/^([a-z0-9.+-]+:)/i,G2=/:[0-9]*$/,H2=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,W2=["<",">",'"',"`"," ","\r",`
`,"	"],$2=["{","}","|","\\","^","`"].concat(W2),$d=["'"].concat($2),px=["%","/","?",";","#"].concat($d),mx=["/","?","#"],V2=255,gx=/^[+a-z0-9A-Z_-]{0,63}$/,X2=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Y2={javascript:!0,"javascript:":!0},Vd={javascript:!0,"javascript:":!0},As={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Xd=O2;function K2(t,e,r){if(t&&typeof t=="object"&&t instanceof rn)return t;var n=new rn;return n.parse(t,e,r),n}rn.prototype.parse=function(t,e,r){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var a=t;if(a=a.trim(),!r&&t.split("#").length===1){var l=H2.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=Xd.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=z2.exec(a);if(u){u=u[0];var h=u.toLowerCase();this.protocol=h,a=a.substr(u.length)}if(r||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var d=a.substr(0,2)==="//";d&&!(u&&Vd[u])&&(a=a.substr(2),this.slashes=!0)}if(!Vd[u]&&(d||u&&!As[u])){for(var f=-1,p=0;p<mx.length;p++){var m=a.indexOf(mx[p]);m!==-1&&(f===-1||m<f)&&(f=m)}var v,_;f===-1?_=a.lastIndexOf("@"):_=a.lastIndexOf("@",f),_!==-1&&(v=a.slice(0,_),a=a.slice(_+1),this.auth=decodeURIComponent(v)),f=-1;for(var p=0;p<px.length;p++){var m=a.indexOf(px[p]);m!==-1&&(f===-1||m<f)&&(f=m)}f===-1&&(f=a.length),this.host=a.slice(0,f),a=a.slice(f),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var y=this.hostname.split(/\./),p=0,g=y.length;p<g;p++){var w=y[p];if(w&&!w.match(gx)){for(var S="",T=0,A=w.length;T<A;T++)w.charCodeAt(T)>127?S+="x":S+=w[T];if(!S.match(gx)){var E=y.slice(0,p),k=y.slice(p+1),F=w.match(X2);F&&(E.push(F[1]),k.unshift(F[2])),k.length&&(a="/"+k.join(".")+a),this.hostname=E.join(".");break}}}this.hostname.length>V2?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=U2.toASCII(this.hostname));var L=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+L,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Y2[h])for(var p=0,g=$d.length;p<g;p++){var P=$d[p];if(a.indexOf(P)!==-1){var I=encodeURIComponent(P);I===P&&(I=escape(P)),a=a.split(P).join(I)}}var D=a.indexOf("#");D!==-1&&(this.hash=a.substr(D),a=a.slice(0,D));var O=a.indexOf("?");if(O!==-1?(this.search=a.substr(O),this.query=a.substr(O+1),e&&(this.query=Xd.parse(this.query)),a=a.slice(0,O)):e&&(this.search="",this.query={}),a&&(this.pathname=a),As[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",M=this.search||"";this.path=L+M}return this.href=this.format(),this};rn.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Xd.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||As[e])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+r+o+n};rn.prototype.resolve=function(t){return this.resolveObject(K2(t,!1,!0)).format()};rn.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new rn;e.parse(t,!1,!0),t=e}for(var r=new rn,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(r[l]=t[l])}return As[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!As[t.protocol]){for(var u=Object.keys(t),h=0;h<u.length;h++){var d=u[h];r[d]=t[d]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!Vd[t.protocol]){for(var g=(t.pathname||"").split("/");g.length&&!(t.host=g.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),r.pathname=g.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var f=r.pathname||"",p=r.search||"";r.path=f+p}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&r.pathname.charAt(0)==="/",v=t.host||t.pathname&&t.pathname.charAt(0)==="/",_=v||m||r.host&&t.pathname,x=_,y=r.pathname&&r.pathname.split("/")||[],g=t.pathname&&t.pathname.split("/")||[],w=r.protocol&&!As[r.protocol];if(w&&(r.hostname="",r.port=null,r.host&&(y[0]===""?y[0]=r.host:y.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(g[0]===""?g[0]=t.host:g.unshift(t.host)),t.host=null),_=_&&(g[0]===""||y[0]==="")),v)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,y=g;else if(g.length)y||(y=[]),y.pop(),y=y.concat(g),r.search=t.search,r.query=t.query;else if(t.search!=null){if(w){r.host=y.shift(),r.hostname=r.host;var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return r.search=t.search,r.query=t.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!y.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=y.slice(-1)[0],A=(r.host||t.host||y.length>1)&&(T==="."||T==="..")||T==="",E=0,k=y.length;k>=0;k--)T=y[k],T==="."?y.splice(k,1):T===".."?(y.splice(k,1),E++):E&&(y.splice(k,1),E--);if(!_&&!x)for(;E--;E)y.unshift("..");_&&y[0]!==""&&(!y[0]||y[0].charAt(0)!=="/")&&y.unshift(""),A&&y.join("/").substr(-1)!=="/"&&y.push("");var F=y[0]===""||y[0]&&y[0].charAt(0)==="/";if(w){r.hostname=F?"":y.length?y.shift():"",r.host=r.hostname;var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return _=_||r.host&&y.length,_&&!F&&y.unshift(""),y.length>0?r.pathname=y.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};rn.prototype.parseHost=function(){var t=this.host,e=G2.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const xx={};function xe(t,e,r=3){if(xx[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),xx[e]=!0}function ar(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function so(t){return t.split("?")[0].split("#")[0]}function q2(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Q2(t,e,r){return t.replace(new RegExp(q2(e),"g"),r)}function Z2(t,e){let r="",n=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),i=a,s=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=a,s=0;continue}}}else r.length>0?r+=`/${t.slice(i+1,a)}`:r=t.slice(i+1,a),n=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return r}const at={toPosix(t){return Q2(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){ar(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(ar(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=so(this.toPosix(e??K.ADAPTER.getBaseUrl())),i=so(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?at.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(ar(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=Z2(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return ar(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(ar(n),n.length>0)if(e===void 0)e=n;else{const i=t[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(ar(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){n=a;break}}else i=!1;return n===-1?r?"/":this.isUrl(o)?s+t:s:r&&n===1?"//":s+t.slice(0,n)},rootname(t){ar(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){ar(t),e&&ar(e),t=so(this.toPosix(t));let r=0,n=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const l=t.charCodeAt(s);if(l===47){if(!i){r=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return r===n?n=a:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){r=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){ar(t),t=so(this.toPosix(t));let e=-1,r=0,n=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){r=o+1;break}continue}n===-1&&(i=!1,n=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){ar(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=so(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let i;e.root=this.rootname(t),n||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,a=-1,l=!0,u=t.length-1,h=0;for(;u>=i;--u){if(r=t.charCodeAt(u),r===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),r===46?s===-1?s=u:h!==1&&(h=1):s!==-1&&(h=-1)}return s===-1||a===-1||h===0||h===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&n?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&n?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let ch;async function J2(){return ch??(ch=(async()=>{var s;const t=document.createElement("canvas").getContext("webgl");if(!t)return Mt.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return Mt.UNPACK;const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(s=t.getExtension("WEBGL_lose_context"))==null||s.loseContext(),i[0]<=i[3]?Mt.PMA:Mt.UNPACK})()),ch}let uh;function eR(){return typeof uh>"u"&&(uh=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:K.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!K.ADAPTER.getWebGLRenderingContext())return!1;const r=K.ADAPTER.createCanvas();let n=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,i}catch{return!1}}()),uh}var tR={grad:.9,turn:360,rad:360/(2*Math.PI)},$r=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},st=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},er=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},k_=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},yx=function(t){return{r:er(t.r,0,255),g:er(t.g,0,255),b:er(t.b,0,255),a:er(t.a)}},hh=function(t){return{r:st(t.r),g:st(t.g),b:st(t.b),a:st(t.a,3)}},rR=/^#([0-9a-f]{3,8})$/i,Ya=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},M_=function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=Math.max(e,r,n),o=s-Math.min(e,r,n),a=o?s===e?(r-n)/o:s===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},B_=function(t){var e=t.h,r=t.s,n=t.v,i=t.a;e=e/360*6,r/=100,n/=100;var s=Math.floor(e),o=n*(1-r),a=n*(1-(e-s)*r),l=n*(1-(1-e+s)*r),u=s%6;return{r:255*[n,a,o,o,l,n][u],g:255*[l,n,n,a,o,o][u],b:255*[o,o,l,n,n,a][u],a:i}},vx=function(t){return{h:k_(t.h),s:er(t.s,0,100),l:er(t.l,0,100),a:er(t.a)}},_x=function(t){return{h:st(t.h),s:st(t.s),l:st(t.l),a:st(t.a,3)}},wx=function(t){return B_((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},Fo=function(t){return{h:(e=M_(t)).h,s:(i=(200-(r=e.s))*(n=e.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,r,n,i},nR=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,iR=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,sR=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,oR=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Yd={string:[[function(t){var e=rR.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?st(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?st(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=sR.exec(t)||oR.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:yx({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=nR.exec(t)||iR.exec(t);if(!e)return null;var r,n,i=vx({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(tR[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return wx(i)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=i===void 0?1:i;return $r(e)&&$r(r)&&$r(n)?yx({r:Number(e),g:Number(r),b:Number(n),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,i=t.a,s=i===void 0?1:i;if(!$r(e)||!$r(r)||!$r(n))return null;var o=vx({h:Number(e),s:Number(r),l:Number(n),a:Number(s)});return wx(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,i=t.a,s=i===void 0?1:i;if(!$r(e)||!$r(r)||!$r(n))return null;var o=function(a){return{h:k_(a.h),s:er(a.s,0,100),v:er(a.v,0,100),a:er(a.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(s)});return B_(o)},"hsv"]]},Sx=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},aR=function(t){return typeof t=="string"?Sx(t.trim(),Yd.string):typeof t=="object"&&t!==null?Sx(t,Yd.object):[null,void 0]},dh=function(t,e){var r=Fo(t);return{h:r.h,s:er(r.s+100*e,0,100),l:r.l,a:r.a}},fh=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},bx=function(t,e){var r=Fo(t);return{h:r.h,s:r.s,l:er(r.l+100*e,0,100),a:r.a}},Kd=function(){function t(e){this.parsed=aR(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return st(fh(this.rgba),2)},t.prototype.isDark=function(){return fh(this.rgba)<.5},t.prototype.isLight=function(){return fh(this.rgba)>=.5},t.prototype.toHex=function(){return e=hh(this.rgba),r=e.r,n=e.g,i=e.b,o=(s=e.a)<1?Ya(st(255*s)):"","#"+Ya(r)+Ya(n)+Ya(i)+o;var e,r,n,i,s,o},t.prototype.toRgb=function(){return hh(this.rgba)},t.prototype.toRgbString=function(){return e=hh(this.rgba),r=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+r+", "+n+", "+i+", "+s+")":"rgb("+r+", "+n+", "+i+")";var e,r,n,i,s},t.prototype.toHsl=function(){return _x(Fo(this.rgba))},t.prototype.toHslString=function(){return e=_x(Fo(this.rgba)),r=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+r+", "+n+"%, "+i+"%, "+s+")":"hsl("+r+", "+n+"%, "+i+"%)";var e,r,n,i,s},t.prototype.toHsv=function(){return e=M_(this.rgba),{h:st(e.h),s:st(e.s),v:st(e.v),a:st(e.a,3)};var e},t.prototype.invert=function(){return Tr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),Tr(dh(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),Tr(dh(this.rgba,-e))},t.prototype.grayscale=function(){return Tr(dh(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),Tr(bx(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),Tr(bx(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?Tr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):st(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=Fo(this.rgba);return typeof e=="number"?Tr({h:e,s:r.s,l:r.l,a:r.a}):st(r.h)},t.prototype.isEqual=function(e){return this.toHex()===Tr(e).toHex()},t}(),Tr=function(t){return t instanceof Kd?t:new Kd(t)},Ex=[],lR=function(t){t.forEach(function(e){Ex.indexOf(e)<0&&(e(Kd,Yd),Ex.push(e))})};function cR(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=n[this.toHex()];if(u)return u;if(o!=null&&o.closest){var h=this.toRgb(),d=1/0,f="black";if(!s.length)for(var p in r)s[p]=new t(r[p]).toRgb();for(var m in r){var v=(a=h,l=s[m],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));v<d&&(d=v,f=m)}return f}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}lR([cR]);const Zi=class Il{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Il)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,s)=>i===r[s]);if(e!==null&&r!==null){const i=Object.keys(e),s=Object.keys(r);return i.length!==s.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,n,i]=this._components;return{r:e,g:r,b:n,a:i}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,i]=this._components;return e=e??[],e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[r,n,i]=this._components;return e[0]=r,e[1]=n,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,i,s]=Il.temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return r&&(n=n*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[r,n,i]=this._components;return this._components[0]=Math.round(r*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[r,n,i,s]=this._components;return e[0]=r,e[1]=n,e[2]=i,e[3]=s,e}normalize(e){let r,n,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,i,s=255]=e,r/=255,n/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Il.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=Tr(e);o.isValid()&&({r,g:n,b:i,a:s}=o.rgba,r/=255,n/=255,i/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,r),n)}),e)}};Zi.shared=new Zi,Zi.temp=new Zi,Zi.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let je=Zi;function uR(t){return xe("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),je.shared.setValue(t).toHex()}function hR(t){return xe("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),je.shared.setValue(t).toNumber()}function dR(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[le.NORMAL_NPM]=le.NORMAL,t[le.ADD_NPM]=le.ADD,t[le.SCREEN_NPM]=le.SCREEN,e[le.NORMAL]=le.NORMAL_NPM,e[le.ADD]=le.ADD_NPM,e[le.SCREEN]=le.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}const j_=dR();function N_(t,e){return j_[e?1:0][t]}function fR(t,e=null){const r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let n=0,i=0;n<r;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function F_(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function mc(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function Tx(t){return!(t&t-1)&&!!t}function Ax(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function Cs(t,e,r){const n=t.length;let i;if(e>=n||r===0)return;r=e+r>n?n-e:r;const s=n-r;for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}function kn(t){return t===0?0:t<0?-1:1}let pR=0;function Ci(){return++pR}const qd=class{constructor(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};qd.EMPTY=new qd(0,0,0,0);let Cx=qd;const Rx={},Ar=Object.create(null),xn=Object.create(null);class mR{constructor(e,r,n){this._canvas=K.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||K.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Px(t,e,r){for(let n=0,i=4*r*e;n<e;++n,i+=4)if(t[i+3]!==0)return!1;return!0}function Ix(t,e,r,n,i){const s=4*e;for(let o=n,a=n*s+4*r;o<=i;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function gR(t){const{width:e,height:r}=t,n=t.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,e,r).data;let s=0,o=0,a=e-1,l=r-1;for(;o<r&&Px(i,e,o);)++o;if(o===r)return Cx.EMPTY;for(;Px(i,e,l);)--l;for(;Ix(i,e,s,o,l);)++s;for(;Ix(i,e,a,o,l);)--a;return++a,++l,new Cx(s,o,a,l)}function xR(t){const e=gR(t),{width:r,height:n}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,r,n)}return{width:r,height:n,data:i}}function yR(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}function ln(t,e=1){var n;const r=(n=K.RETINA_PREFIX)==null?void 0:n.exec(t);return r?parseFloat(r[1]):e}var X=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(X||{});const Qd=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},kx=(t,e)=>Qd(t).priority??e,J={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Qd).forEach(e=>{e.type.forEach(r=>{var n,i;return(i=(n=this._removeHandlers)[r])==null?void 0:i.call(n,e)})}),this},add(...t){return t.map(Qd).forEach(e=>{e.type.forEach(r=>{var s,o;const n=this._addHandlers,i=this._queue;n[r]?(s=n[r])==null||s.call(n,e):(i[r]=i[r]||[],(o=i[r])==null||o.push(e))})}),this},handle(t,e,r){var o;const n=this._addHandlers,i=this._removeHandlers;if(n[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,i[t]=r;const s=this._queue;return s[t]&&((o=s[t])==null||o.forEach(a=>e(a)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,s)=>kx(s,r)-kx(i,r)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}};class Zd{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const vR=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function _R(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function wR(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=vR.replace(/%forloop%/gi,_R(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}const ph=0,mh=1,gh=2,xh=3,yh=4,vh=5;class zr{constructor(){this.data=0,this.blendMode=le.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<ph)}set blend(e){!!(this.data&1<<ph)!==e&&(this.data^=1<<ph)}get offsets(){return!!(this.data&1<<mh)}set offsets(e){!!(this.data&1<<mh)!==e&&(this.data^=1<<mh)}get culling(){return!!(this.data&1<<gh)}set culling(e){!!(this.data&1<<gh)!==e&&(this.data^=1<<gh)}get depthTest(){return!!(this.data&1<<xh)}set depthTest(e){!!(this.data&1<<xh)!==e&&(this.data^=1<<xh)}get depthMask(){return!!(this.data&1<<vh)}set depthMask(e){!!(this.data&1<<vh)!==e&&(this.data^=1<<vh)}get clockwiseFrontFace(){return!!(this.data&1<<yh)}set clockwiseFrontFace(e){!!(this.data&1<<yh)!==e&&(this.data^=1<<yh)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==le.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new zr;return e.depthTest=!1,e.blend=!0,e}}zr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Jd=[];function L_(t,e){if(!t)return null;let r="";if(typeof t=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(let n=Jd.length-1;n>=0;--n){const i=Jd[n];if(i.test&&i.test(t,r))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class xr{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,n,i,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:h}=this;this._aliasCount++;for(let d=0,f=h.length;d<f;d++)h[d][u](e,r,n,i,s,o,a,l);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(xr.prototype,{dispatch:{value:xr.prototype.emit},run:{value:xr.prototype.emit}});class aa{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new xr("setRealSize"),this.onUpdate=new xr("update"),this.onError=new xr("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}}class eu extends aa{constructor(e,r){const{width:n,height:i}=r||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=e,this.unpackAlignment=r.unpackAlignment??4}upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Mt.UNPACK);const s=r.realWidth,o=r.realHeight;return n.width===s&&n.height===o?i.texSubImage2D(r.target,0,0,0,s,o,r.format,n.type,this.data):(n.width=s,n.height=o,i.texImage2D(r.target,0,n.internalFormat,s,o,0,r.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const SR={scaleMode:Qr.NEAREST,alphaMode:Mt.NPM},ef=class Ji extends ma{constructor(e=null,r=null){super(),r=Object.assign({},Ji.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:u,format:h,type:d,target:f,resolution:p,resourceOptions:m}=r;e&&!(e instanceof aa)&&(e=L_(e,m),e.internal=!0),this.resolution=p||K.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=u,this._scaleMode=o,this.format=h,this.type=d,this.target=f,this.alphaMode=n,this.uid=Ci(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,r){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,n=!0),n&&this.dirtyStyleId++,this}setSize(e,r,n){return n=n||this.resolution,this.setRealSize(e*n,r*n,n)}setRealSize(e,r,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(r)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Tx(this.realWidth)&&Tx(this.realHeight)}setResolution(e){const r=this.resolution;return r===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*r)/e,this.height=Math.round(this.height*r)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete xn[this.cacheId],delete Ar[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Ji.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,r,n=K.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Ci()}`}s=e._pixiId}let o=xn[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new Ji(e,r),o.cacheId=s,Ji.addToCache(o,s)),o}static fromBuffer(e,r,n,i){e=e||new Float32Array(r*n*4);const s=new eu(e,{width:r,height:n,...i==null?void 0:i.resourceOptions});let o,a;return e instanceof Float32Array?(o=W.RGBA,a=ne.FLOAT):e instanceof Int32Array?(o=W.RGBA_INTEGER,a=ne.INT):e instanceof Uint32Array?(o=W.RGBA_INTEGER,a=ne.UNSIGNED_INT):e instanceof Int16Array?(o=W.RGBA_INTEGER,a=ne.SHORT):e instanceof Uint16Array?(o=W.RGBA_INTEGER,a=ne.UNSIGNED_SHORT):e instanceof Int8Array?(o=W.RGBA,a=ne.BYTE):(o=W.RGBA,a=ne.UNSIGNED_BYTE),s.internal=!0,new Ji(s,Object.assign({},SR,{type:a,format:o},i))}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),xn[r]&&xn[r]!==e&&console.warn(`BaseTexture added to the cache with an id [${r}] that already had an entry`),xn[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=xn[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete xn[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)delete xn[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}};ef.defaultOptions={mipmap:Ur.POW2,anisotropicLevel:0,scaleMode:Qr.LINEAR,wrapMode:Gn.CLAMP,alphaMode:Mt.UNPACK,target:Es.TEXTURE_2D,format:W.RGBA,type:ne.UNSIGNED_BYTE},ef._globalBatch=0;let he=ef;class tf{constructor(){this.texArray=null,this.blend=0,this.type=Nr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let bR=0;class Ye{constructor(e,r=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=r,this.id=bR++,this.disposeRunner=new xr("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Dr.ELEMENT_ARRAY_BUFFER:Dr.ARRAY_BUFFER}get index(){return this.type===Dr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Ye(e)}}class gc{constructor(e,r=0,n=!1,i=ne.FLOAT,s,o,a,l=1){this.buffer=e,this.size=r,this.normalized=n,this.type=i,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,r,n,i,s){return new gc(e,r,n,i,s)}}const ER={Float32Array,Uint32Array,Int32Array,Uint8Array};function TR(t,e){let r=0,n=0;const i={};for(let l=0;l<t.length;l++)n+=e[l],r+=t[l].length;const s=new ArrayBuffer(r*4);let o=null,a=0;for(let l=0;l<t.length;l++){const u=e[l],h=t[l],d=F_(h);i[d]||(i[d]=new ER[d](s)),o=i[d];for(let f=0;f<h.length;f++){const p=(f/u|0)*n+a,m=f%u;o[p+m]=h[f]}a+=u}return new Float32Array(s)}const Mx={5126:4,5123:2,5121:1};let AR=0;const CR={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Vn{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=AR++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new xr("disposeGeometry"),this.refCount=0}addAttribute(e,r,n=0,i=!1,s,o,a,l=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof Ye||(r instanceof Array&&(r=new Float32Array(r)),r=new Ye(r));const u=e.split("|");if(u.length>1){for(let d=0;d<u.length;d++)this.addAttribute(u[d],r,n,i,s);return this}let h=this.buffers.indexOf(r);return h===-1&&(this.buffers.push(r),h=this.buffers.length-1),this.attributes[e]=new gc(h,n,i,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Ye||(e instanceof Array&&(e=new Uint16Array(e)),e=new Ye(e)),e.type=Dr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],r=[],n=new Ye;let i;for(i in this.attributes){const s=this.attributes[i],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*Mx[s.type]/4),s.buffer=0}for(n.data=TR(e,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Vn;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new Ye(this.buffers[r].data.slice(0));for(const r in this.attributes){const n=this.attributes[r];e.attributes[r]=new gc(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Dr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const r=new Vn,n=[],i=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l]=i[l]||0,i[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)n[a]=new CR[F_(o.buffers[a].data)](i[a]),r.buffers[a]=new Ye(n[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)n[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=Dr.ELEMENT_ARRAY_BUFFER;let a=0,l=0,u=0,h=0;for(let d=0;d<o.buffers.length;d++)if(o.buffers[d]!==o.indexBuffer){h=d;break}for(const d in o.attributes){const f=o.attributes[d];(f.buffer|0)===h&&(l+=f.size*Mx[f.type]/4)}for(let d=0;d<e.length;d++){const f=e[d].indexBuffer.data;for(let p=0;p<f.length;p++)r.indexBuffer.data[p+u]+=a;a+=e[d].buffers[h].data.length/l,u+=f.length}}return r}}class D_ extends Vn{constructor(e=!1){super(),this._buffer=new Ye(null,e,!1),this._indexBuffer=new Ye(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,ne.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,ne.FLOAT).addAttribute("aColor",this._buffer,4,!0,ne.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,ne.FLOAT).addIndex(this._indexBuffer)}}const xc=Math.PI*2,RR=180/Math.PI,PR=Math.PI/180;var ut=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(ut||{});class _e{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new _e(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}}_e.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Ka=[new _e,new _e,new _e,new _e];class fe{constructor(e=0,r=0,n=0,i=0){this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(i),this.type=ut.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new fe(0,0,0,0)}clone(){return new fe(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){const E=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=E)return!1;const k=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>k}const n=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=n||o<=s)return!1;const a=Ka[0].set(e.left,e.top),l=Ka[1].set(e.left,e.bottom),u=Ka[2].set(e.right,e.top),h=Ka[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const d=Math.sign(r.a*r.d-r.b*r.c);if(d===0||(r.apply(a,a),r.apply(l,l),r.apply(u,u),r.apply(h,h),Math.max(a.x,l.x,u.x,h.x)<=n||Math.min(a.x,l.x,u.x,h.x)>=i||Math.max(a.y,l.y,u.y,h.y)<=s||Math.min(a.y,l.y,u.y,h.y)>=o))return!1;const f=d*(l.y-a.y),p=d*(a.x-l.x),m=f*n+p*s,v=f*i+p*s,_=f*n+p*o,x=f*i+p*o;if(Math.max(m,v,_,x)<=f*a.x+p*a.y||Math.min(m,v,_,x)>=f*h.x+p*h.y)return!1;const y=d*(a.y-u.y),g=d*(u.x-a.x),w=y*n+g*s,S=y*i+g*s,T=y*n+g*o,A=y*i+g*o;return!(Math.max(w,S,T,A)<=y*a.x+g*a.y||Math.min(w,S,T,A)>=y*h.x+g*h.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,i=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=i,this.height=s-i,this}}fe.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class tu{constructor(e=0,r=0,n=0){this.x=e,this.y=r,this.radius=n,this.type=ut.CIRC}clone(){return new tu(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,s=this.y-r;return i*=i,s*=s,i+s<=n}getBounds(){return new fe(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}tu.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class ru{constructor(e=0,r=0,n=0,i=0){this.x=e,this.y=r,this.width=n,this.height=i,this.type=ut.ELIP}clone(){return new ru(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,i=(r-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new fe(this.x-this.width,this.y-this.height,this.width,this.height)}}ru.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class vi{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let i=0,s=r.length;i<s;i++)n.push(r[i].x,r[i].y);r=n}this.points=r,this.type=ut.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),r=new vi(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let n=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],h=this.points[o*2+1];l>r!=h>r&&e<(u-a)*((r-l)/(h-l))+a&&(n=!n)}return n}}vi.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class nu{constructor(e=0,r=0,n=0,i=0,s=20){this.x=e,this.y=r,this.width=n,this.height=i,this.radius=s,this.type=ut.RREC}clone(){return new nu(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),s=r-(this.y+n);const o=n*n;if(i*i+s*s<=o||(i=e-(this.x+this.width-n),i*i+s*s<=o)||(s=r-(this.y+this.height-n),i*i+s*s<=o)||(i=e-(this.x+n),i*i+s*s<=o))return!0}return!1}}nu.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Fe{constructor(e=1,r=0,n=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,i,s,o){return this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new _e;const n=e.x,i=e.y;return r.x=this.a*n+this.c*i+this.tx,r.y=this.b*n+this.d*i+this.ty,r}applyInverse(e,r){r=r||new _e;const n=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return r.x=this.d*n*i+-this.c*n*s+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*s+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*r-this.b*n,this.b=i*n+this.b*r,this.c=s*r-this.d*n,this.d=s*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,i=this.c,s=this.d;return this.a=e.a*r+e.b*i,this.b=e.a*n+e.b*s,this.c=e.c*r+e.d*i,this.d=e.c*n+e.d*s,this.tx=e.tx*r+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}setTransform(e,r,n,i,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(n*this.a+i*this.c),this.ty=r-(n*this.b+i*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),l=Math.atan2(n,r),u=Math.abs(a+l);return u<1e-5||Math.abs(xc-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*r+o.y*i),e.position.y=this.ty+(o.x*n+o.y*s),e}invert(){const e=this.a,r=this.b,n=this.c,i=this.d,s=this.tx,o=e*i-r*n;return this.a=i/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-i*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Fe;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Fe}static get TEMP_MATRIX(){return new Fe}}Fe.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const si=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],oi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ai=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],li=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rf=[],O_=[],qa=Math.sign;function IR(){for(let t=0;t<16;t++){const e=[];rf.push(e);for(let r=0;r<16;r++){const n=qa(si[t]*si[r]+ai[t]*oi[r]),i=qa(oi[t]*si[r]+li[t]*oi[r]),s=qa(si[t]*ai[r]+ai[t]*li[r]),o=qa(oi[t]*ai[r]+li[t]*li[r]);for(let a=0;a<16;a++)if(si[a]===n&&oi[a]===i&&ai[a]===s&&li[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Fe;e.set(si[t],oi[t],ai[t],li[t],0,0),O_.push(e)}}IR();const De={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>si[t],uY:t=>oi[t],vX:t=>ai[t],vY:t=>li[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>rf[t][e],sub:(t,e)=>rf[t][De.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?De.S:De.N:Math.abs(e)*2<=Math.abs(t)?t>0?De.E:De.W:e>0?t>0?De.SE:De.SW:t>0?De.NE:De.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const i=O_[De.inv(e)];i.tx=r,i.ty=n,t.append(i)}};class Jr{constructor(e,r,n=0,i=0){this._x=n,this._y=i,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new Jr(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Jr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const nf=class{constructor(){this.worldTransform=new Fe,this.localTransform=new Fe,this.position=new Jr(this.onChange,this,0,0),this.scale=new Jr(this.onChange,this,1,1),this.pivot=new Jr(this.onChange,this,0,0),this.skew=new Jr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};nf.IDENTITY=new nf;let Op=nf;Op.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var kR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,MR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Bx(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function _h(t){const e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function U_(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return _h(2*e);case"bvec3":return _h(3*e);case"bvec4":return _h(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Rs=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],BR={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},jR={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function NR(t,e){var n;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const s=e[i];if(!s){((n=t.uniforms[i])==null?void 0:n.group)===!0&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let a=!1;for(let l=0;l<Rs.length;l++)if(Rs[l].test(s,o)){r.push(Rs[l].code(i,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?BR:jR)[s.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const z_={};let Vi=z_;function FR(){if(Vi===z_||Vi!=null&&Vi.isContextLost()){const t=K.ADAPTER.createCanvas();let e;K.PREFER_ENV>=ji.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Vi=e}return Vi}let Qa;function LR(){if(!Qa){Qa=Jt.MEDIUM;const t=FR();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(Qa=e.precision?Jt.HIGH:Jt.MEDIUM)}}return Qa}function jx(t,e){const r=t.getShaderSource(e).split(`
`).map((u,h)=>`${h}: ${u}`),n=t.getShaderInfoLog(e),i=n.split(`
`),s={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{r[u-1]=`%c${r[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=r.join(`
`);a[0]=l,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function DR(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||jx(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||jx(t,n),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const OR={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function G_(t){return OR[t]}let Za=null;const Nx={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function H_(t,e){if(!Za){const r=Object.keys(Nx);Za={};for(let n=0;n<r.length;++n){const i=r[n];Za[t[i]]=Nx[i]}}return Za[e]}function Fx(t,e,r){if(t.substring(0,9)!=="precision"){let n=e;return e===Jt.HIGH&&r!==Jt.HIGH&&(n=Jt.MEDIUM),`precision ${n} float;
${t}`}else if(r!==Jt.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let oo;function UR(){if(typeof oo=="boolean")return oo;try{oo=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{oo=!1}return oo}let zR=0;const Ja={},sf=class es{constructor(e,r,n="pixi-shader",i={}){this.extra={},this.id=zR++,this.vertexSrc=e||es.defaultVertexSrc,this.fragmentSrc=r||es.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),Ja[n]?(Ja[n]++,n+=`-${Ja[n]}`):Ja[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=Fx(this.vertexSrc,es.defaultVertexPrecision,Jt.HIGH),this.fragmentSrc=Fx(this.fragmentSrc,es.defaultFragmentPrecision,LR())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return MR}static get defaultFragmentSrc(){return kR}static from(e,r,n){const i=e+r;let s=Rx[i];return s||(Rx[i]=s=new es(e,r,n)),s}};sf.defaultVertexPrecision=Jt.HIGH,sf.defaultFragmentPrecision=Zr.apple.device?Jt.HIGH:Jt.MEDIUM;let en=sf,GR=0;class yr{constructor(e,r,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=GR++,this.static=!!r,this.ubo=!!n,e instanceof Ye?(this.buffer=e,this.buffer.type=Dr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Ye(new Float32Array(1)),this.buffer.type=Dr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,n){if(!this.ubo)this.uniforms[e]=new yr(r,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,n){return new yr(e,r,n)}static uboFrom(e,r){return new yr(e,r??!0,!0)}}class Or{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof yr?this.uniformGroup=r:this.uniformGroup=new yr(r):this.uniformGroup=new yr({}),this.disposeRunner=new xr("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(const n in r.uniforms){const i=r.uniforms[n];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,n){const i=en.from(e,r);return new Or(i,n)}}class HR{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let s=0;s<e;s++)n[s]=s;this.defaultGroupCache[e]=yr.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new en(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Fe,default:this.defaultGroupCache[e]};return new Or(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let n=0;n<e;n++)n>0&&(r+=`
else `),n<e-1&&(r+=`if(vTextureId < ${n}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class of{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function WR(){return!Zr.apple.device}function $R(t){let e=!0;const r=K.ADAPTER.getNavigator();if(Zr.tablet||Zr.phone){if(Zr.apple.device){const n=r.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(Zr.android.device){const n=r.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?t:4}class iu{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var VR=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,XR=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const po=class cr extends iu{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=D_,this.vertexSize=6,this.state=zr.for2d(),this.size=cr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??$R(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??WR(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return xe("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return XR}static get defaultFragmentTemplate(){return VR}setShaderGenerator({vertex:e=cr.defaultVertexSrc,fragment:r=cr.defaultFragmentTemplate}={}){this.shaderGenerator=new HR(e,r)}contextChange(){const e=this.renderer.gl;K.PREFER_ENV===ji.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),cr.defaultMaxTextures),this.maxTextures=wR(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:r}=cr,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;e.length<n;)e.push(new tf);for(;r.length<i;)r.push(new of);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:r}=this,n=cr._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++he._globalBatch,l=0,u=n[0],h=0;i.copyBoundTextures(s,r);for(let d=0;d<this._bufferSize;++d){const f=e[d];e[d]=null,f._batchEnabled!==a&&(u.count>=r&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,h,d),h=d,u=n[++l],++a),f._batchEnabled=a,f.touched=o,u.elements[u.count++]=f)}u.count>0&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,h,this._bufferSize),++l,++a);for(let d=0;d<s.length;d++)s[d]=null;he._globalBatch=a}buildDrawCalls(e,r,n){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=cr._drawCallPool;let u=this._dcIndex,h=this._aIndex,d=this._iIndex,f=l[u];f.start=this._iIndex,f.texArray=e;for(let p=r;p<n;++p){const m=i[p],v=m._texture.baseTexture,_=j_[v.alphaMode?1:0][m.blendMode];i[p]=null,r<p&&f.blend!==_&&(f.size=d-f.start,r=p,f=l[++u],f.texArray=e,f.start=d),this.packInterleavedGeometry(m,s,o,h,d),h+=m.vertexData.length/2*a,d+=m.indices.length,f.blend=_}r<n&&(f.size=d-f.start,++u),this._dcIndex=u,this._aIndex=h,this._iIndex=d}bindAndClearTexArray(e){const r=this.renderer.texture;for(let n=0;n<e.count;n++)r.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:r,_indexBuffer:n}=this;cr.canUploadSameBuffer?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:r,state:n}=this.renderer,i=cr._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:u,start:h,blend:d}=i[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=d,n.set(this.state),r.drawElements(l,u,r.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),cr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const r=mc(Math.ceil(e/8)),n=Ax(r),i=r*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new Zd(i*this.vertexSize*4)),s}getIndexBuffer(e){const r=mc(Math.ceil(e/12)),n=Ax(r),i=r*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._iBuffers[n];return s||(this._iBuffers[n]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,r,n,i,s){const{uint32View:o,float32View:a}=r,l=i/this.vertexSize,u=e.uvs,h=e.indices,d=e.vertexData,f=e._texture.baseTexture._batchLocation,p=Math.min(e.worldAlpha,1),m=je.shared.setValue(e._tintRGB).toPremultiplied(p,e._texture.baseTexture.alphaMode>0);for(let v=0;v<d.length;v+=2)a[i++]=d[v],a[i++]=d[v+1],a[i++]=u[v],a[i++]=u[v+1],o[i++]=m,a[i++]=f;for(let v=0;v<h.length;v++)n[s++]=l+h[v]}};po.defaultBatchSize=4096,po.extension={name:"batch",type:X.RendererPlugin},po._drawCallPool=[],po._textureArrayPool=[];let ci=po;J.add(ci);var YR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,KR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const af=class mo extends Or{constructor(e,r,n){const i=en.from(e||mo.defaultVertexSrc,r||mo.defaultFragmentSrc);super(i,n),this.padding=0,this.resolution=mo.defaultResolution,this.multisample=mo.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new zr}apply(e,r,n,i,s){e.applyFilter(this,r,n,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return KR}static get defaultFragmentSrc(){return YR}};af.defaultResolution=1,af.defaultMultisample=qe.NONE;let St=af;class yc{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new je(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:r,background:n,backgroundAlpha:i}=e,s=n??r;s!==void 0&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}yc.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},yc.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"background"};J.add(yc);class W_{constructor(e){this.renderer=e,this.emptyRenderer=new iu(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){const{boundTextures:n}=this.renderer.texture;for(let i=r-1;i>=0;--i)e[i]=n[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,r,n,i){const{elements:s,ids:o,count:a}=e;let l=0;for(let u=0;u<a;u++){const h=s[u],d=h._batchLocation;if(d>=0&&d<i&&r[d]===h){o[u]=d;continue}for(;l<i;){const f=r[l];if(f&&f._batchEnabled===n&&f._batchLocation===l){l++;continue}o[u]=l,h._batchLocation=l,r[l]=h;break}}}destroy(){this.renderer=null}}W_.extension={type:X.RendererSystem,name:"batch"};J.add(W_);let Lx=0;class vc{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Lx++}init(e){if(e.context)this.initFromContext(e.context);else{const r=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Lx++,this.renderer.runners.contextChange.emit(e);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let n;if(K.PREFER_ENV>=ji.WEBGL2&&(n=e.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const r=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}vc.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},vc.extension={type:X.RendererSystem,name:"context"};J.add(vc);class lf{constructor(e,r){if(this.width=Math.round(e),this.height=Math.round(r),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new xr("disposeFramebuffer"),this.multisample=qe.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new he(null,{scaleMode:Qr.NEAREST,resolution:1,mipmap:Ur.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new he(null,{scaleMode:Qr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ur.OFF,format:W.DEPTH_COMPONENT,type:ne.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!e||!r)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],s=i.resolution;i.setSize(e/s,r/s)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,r/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class $_ extends he{constructor(e={}){if(typeof e=="number"){const r=arguments[0],n=arguments[1],i=arguments[2],s=arguments[3];e={width:r,height:n,scaleMode:i,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=qe.NONE),super(null,e),this.mipmap=Ur.OFF,this.valid=!0,this._clear=new je([0,0,0,0]),this.framebuffer=new lf(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class cn extends aa{constructor(e){const r=e,n=r.naturalWidth||r.videoWidth||r.displayWidth||r.width,i=r.naturalHeight||r.videoHeight||r.displayHeight||r.height;super(n,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,n){n===void 0&&!r.startsWith("data:")?e.crossOrigin=yR(r):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,r,n,i){const s=e.gl,o=r.realWidth,a=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Mt.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&n.width===o&&n.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,n.type,i):(n.width=o,n.height=a,s.texImage2D(r.target,0,n.internalFormat,r.format,n.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),super.update()}dispose(){this.source=null}}class V_ extends cn{constructor(e,r){if(r=r||{},typeof e=="string"){const n=new Image;cn.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??K.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,n)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{n(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Mt.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,n,this.bitmap),!this.preserveBitmap){let i=!0;const s=r._glTextures;for(const o in s){const a=s[o];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class Up{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,n){const i=r.width,s=r.height;if(n){const o=e.width/2/i,a=e.height/2/s,l=e.x/i+o,u=e.y/s+a;n=De.add(n,De.NW),this.x0=l+o*De.uX(n),this.y0=u+a*De.uY(n),n=De.add(n,2),this.x1=l+o*De.uX(n),this.y1=u+a*De.uY(n),n=De.add(n,2),this.x2=l+o*De.uX(n),this.y2=u+a*De.uY(n),n=De.add(n,2),this.x3=l+o*De.uX(n),this.y3=u+a*De.uY(n)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Up.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Dx=new Up;function el(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class Z extends ma{constructor(e,r,n,i,s,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new fe(0,0,1,1)),e instanceof Z&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=Dx,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new _e(o.x,o.y):new _e(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:r}=this.baseTexture;r!=null&&r.url&&Ar[r.url]&&Z.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Z.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new Z(this.baseTexture,!this.noFrame&&e,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===Dx&&(this._uvs=new Up),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},n=K.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else if(e instanceof he){if(!e.cacheId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${Ci()}`,he.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Ci()}`}s=e._pixiId}let o=Ar[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof he)?(r.resolution||(r.resolution=ln(e)),o=new Z(new he(e,r)),o.baseTexture.cacheId=s,he.addToCache(o.baseTexture,s),Z.addToCache(o,s)):!o&&e instanceof he&&(o=new Z(e),Z.addToCache(o,s)),o}static fromURL(e,r){const n=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=Z.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,r,n,i){return new Z(he.fromBuffer(e,r,n,i))}static fromLoader(e,r,n,i){const s=new he(e,Object.assign({scaleMode:he.defaultOptions.scaleMode,resolution:ln(r)},i)),{resource:o}=s;o instanceof V_&&(o.url=r);const a=new Z(s);return n||(n=r),he.addToCache(a.baseTexture,n),Z.addToCache(a,n),n!==r&&(he.addToCache(a.baseTexture,r),Z.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),Ar[r]&&Ar[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Ar[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=Ar[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete Ar[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)Ar[e.textureCacheIds[r]]===e&&delete Ar[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:r,y:n,width:i,height:s}=e,o=r+i>this.baseTexture.width,a=n+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",u=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,h=`Y: ${n} + ${s} = ${n+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${l} ${h}`)}this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Z._EMPTY||(Z._EMPTY=new Z(new he),el(Z._EMPTY),el(Z._EMPTY.baseTexture)),Z._EMPTY}static get WHITE(){if(!Z._WHITE){const e=K.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),Z._WHITE=new Z(he.from(e)),el(Z._WHITE),el(Z._WHITE.baseTexture)}return Z._WHITE}}class Fi extends Z{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,n=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(r*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new Fi(new $_(e))}}class X_{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,n=qe.NONE){const i=new $_(Object.assign({width:e,height:r,resolution:1,multisample:n},this.textureOptions));return new Fi(i)}getOptimalTexture(e,r,n=1,i=qe.NONE){let s;e=Math.max(Math.ceil(e*n-1e-6),1),r=Math.max(Math.ceil(r*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=mc(e),r=mc(r),s=((e&65535)<<16|r&65535)>>>0,i>1&&(s+=i*4294967296)):s=i>1?-i:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,i)),o.filterPoolKey=s,o.setResolution(n),o}getFilterTexture(e,r,n){const i=this.getOptimalTexture(e.width,e.height,r||e.resolution,n||qe.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const r in this.texturePool){const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}X_.SCREEN_KEY=-1;class qR extends Vn{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Y_ extends Vn{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ye(this.vertices),this.uvBuffer=new Ye(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+r.width/e.width,this.uvs[3]=i,this.uvs[4]=n+r.width/e.width,this.uvs[5]=i+r.height/e.height,this.uvs[6]=n,this.uvs[7]=i+r.height/e.height,n=r.x,i=r.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+r.width,this.vertices[3]=i,this.vertices[4]=n+r.width,this.vertices[5]=i+r.height,this.vertices[6]=n,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class QR{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=qe.NONE,this.sourceFrame=new fe,this.destinationFrame=new fe,this.bindingSourceFrame=new fe,this.bindingDestinationFrame=new fe,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const tl=[new _e,new _e,new _e,new _e],wh=new Fe;class K_{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new X_,this.statePool=[],this.quad=new qR,this.quadUv=new Y_,this.tempRect=new fe,this.activeState={},this.globalUniforms=new yr({outputFrame:new fe,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){const n=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new QR,o=n.renderTexture;let a,l;if(o.current){const _=o.current;a=_.resolution,l=_.multisample}else a=n.resolution,l=n.multisample;let u=r[0].resolution||a,h=r[0].multisample??l,d=r[0].padding,f=r[0].autoFit,p=r[0].legacy??!0;for(let _=1;_<r.length;_++){const x=r[_];u=Math.min(u,x.resolution||a),h=Math.min(h,x.multisample??l),d=this.useMaxPadding?Math.max(d,x.padding):d+x.padding,f=f&&x.autoFit,p=p||(x.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=u,s.multisample=h,s.legacy=p,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(d);const m=this.tempRect.copyFrom(o.sourceFrame);n.projection.transform&&this.transformAABB(wh.copyFrom(n.projection.transform).invert(),m),f?(s.sourceFrame.fit(m),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(m)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:n.resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,u,h),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const v=this.tempRect;v.x=0,v.y=0,v.width=s.sourceFrame.width,v.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=n.projection.transform,n.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,v),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,r=e.pop(),n=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const s=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*s[2]-.5*o[2],a[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){const u=i.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,l.renderTexture,Mr.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let u=r.renderTexture,h=this.getOptimalFilterTexture(u.width,u.height,r.resolution);h.filterFrame=u.filterFrame;let d=0;for(d=0;d<n.length-1;++d){d===1&&r.multisample>1&&(h=this.getOptimalFilterTexture(u.width,u.height,r.resolution),h.filterFrame=u.filterFrame),n[d].apply(this,u,h,Mr.CLEAR,r);const f=u;u=h,h=f}n[d].apply(this,u,l.renderTexture,Mr.BLEND,r),d>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(h)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=Mr.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,n.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=i.stateId&1||this.forceClear;(r===Mr.CLEAR||r===Mr.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,n,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(n,i),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Nr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Nr.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:s}=r._texture,o=e.set(i.width,0,0,i.height,n.x,n.y),a=r.worldTransform.copyTo(Fe.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,n=1,i=qe.NONE){return this.texturePool.getOptimalTexture(e,r,n,i)}getFilterTexture(e,r,n){if(typeof e=="number"){const s=e;e=r,r=s}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,n||qe.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){const n=tl[0],i=tl[1],s=tl[2],o=tl[3];n.set(r.left,r.top),i.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(n,n),e.apply(i,i),e.apply(s,s),e.apply(o,o);const a=Math.min(n.x,i.x,s.x,o.x),l=Math.min(n.y,i.y,s.y,o.y),u=Math.max(n.x,i.x,s.x,o.x),h=Math.max(n.y,i.y,s.y,o.y);r.x=a,r.y=l,r.width=u-a,r.height=h-l}roundFrame(e,r,n,i,s){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(s){const{a:o,b:a,c:l,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?wh.copyFrom(s):wh.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}}K_.extension={type:X.RendererSystem,name:"filter"};J.add(K_);class ZR{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=qe.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const JR=new fe;class q_{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new lf(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new fe,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;K.PREFER_ENV===ji.WEBGL_LEGACY&&(r=null,n=null),r?e.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,n=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=n),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){const o=r.width>>n,a=r.height>>n,l=o/r.width;this.setViewport(r.x*l,r.y*l,o,a)}else{const o=e.width>>n,a=e.height>>n;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,n,i){const s=this.viewport;e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),(s.width!==n||s.height!==i||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=n,s.height=i,this.gl.viewport(e,r,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,n,i,s=Nd.COLOR|Nd.DEPTH){const{gl:o}=this;o.clearColor(e,r,n,i),o.clear(s)}initFramebuffer(e){const{gl:r}=this,n=new ZR(r.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){r.bindRenderbuffer(r.RENDERBUFFER,n.stencil);let o;this.renderer.context.webGLVersion===1?o=r.DEPTH_STENCIL:e.depth&&e.stencil?o=r.DEPTH24_STENCIL8:e.depth?o=r.DEPTH_COMPONENT24:o=r.STENCIL_INDEX8,n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,o,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let s=i.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=i[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&n.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const u=s[l],h=u.parentTextureArray||u;this.renderer.texture.bind(h,0),l===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+l,u.target,h._glTextures[this.CONTEXT_UID].texture,r),a.push(n.COLOR_ATTACHMENT0+l))}if(a.length>1&&n.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,r)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||n.createRenderbuffer();let l,u;this.renderer.context.webGLVersion===1?(l=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH_STENCIL):e.depth&&e.stencil?(l=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH24_STENCIL8):e.depth?(l=n.DEPTH_ATTACHMENT,u=n.DEPTH_COMPONENT24):(l=n.STENCIL_ATTACHMENT,u=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,u,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,u,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,l,n.RENDERBUFFER,i.stencil)}else i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:r}=this;let n=qe.NONE;if(e<=1||r===null)return n;for(let i=0;i<r.length;i++)if(r[i]<=e){n=r[i];break}return n===1&&(n=qe.NONE),n}blit(e,r,n){const{current:i,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!i)return;const l=i.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const h=i.colorTextures[0];if(!h)return;l.blitFramebuffer||(l.blitFramebuffer=new lf(i.width,i.height),l.blitFramebuffer.addColorTexture(0,h)),e=l.blitFramebuffer,e.colorTextures[0]!==h&&(e.colorTextures[0]=h,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}r||(r=JR,r.width=i.width,r.height=i.height),n||(n=r);const u=r.width===n.width&&r.height===n.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,r){const n=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,r)}disposeAll(e){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<r.length;n++)this.disposeFramebuffer(r[n],e)}forceStencil(){const e=this.current;if(!e)return;const r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil&&e.stencil)return;e.stencil=!0;const n=e.width,i=e.height,s=this.gl,o=r.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,l,n,i):s.renderbufferStorage(s.RENDERBUFFER,l,n,i),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new fe}destroy(){this.renderer=null}}q_.extension={type:X.RendererSystem,name:"framebuffer"};J.add(q_);const Sh={5126:4,5123:2,5121:1};class Q_{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;K.PREFER_ENV===ji.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(i,s)=>n.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,a,l)=>n.drawElementsInstancedANGLE(i,s,o,a,l),e.drawArraysInstanced=(i,s,o,a)=>n.drawArraysInstancedANGLE(i,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;const{gl:n}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,r=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];r.update(i)}}checkCompatibility(e,r){const n=e.attributes,i=r.attributeData;for(const s in i)if(!n[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){const n=e.attributes,i=r.attributeData,s=["g",e.id];for(const o in n)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,r,n=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,a);const l=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let h=u[l];if(h)return u[a.id]=h,h;const d=e.buffers,f=e.attributes,p={},m={};for(const v in d)p[v]=0,m[v]=0;for(const v in f)!f[v].size&&a.attributeData[v]?f[v].size=a.attributeData[v].size:f[v].size||console.warn(`PIXI Geometry attribute '${v}' size cannot be determined (likely the bound shader does not have the attribute)`),p[f[v].buffer]+=f[v].size*Sh[f[v].type];for(const v in f){const _=f[v],x=_.size;_.stride===void 0&&(p[_.buffer]===x*Sh[_.type]?_.stride=0:_.stride=p[_.buffer]),_.start===void 0&&(_.start=m[_.buffer],m[_.buffer]+=x*Sh[_.type])}h=i.createVertexArray(),i.bindVertexArray(h);for(let v=0;v<d.length;v++){const _=d[v];o.bind(_),n&&_._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=h,u[l]=h,i.bindVertexArray(null),o.unbind(Dr.ARRAY_BUFFER),h}disposeGeometry(e,r){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!n){if(o)for(let l=0;l<s.length;l++){const u=s[l]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!r&&o.dispose(s[l],r))}if(!r){for(const l in n)if(l[0]==="g"){const u=n[l];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const r=Object.keys(this.managedGeometries);for(let n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],e)}activateVao(e,r){const n=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const u in a){const h=a[u],d=o[h.buffer],f=d._glBuffers[i];if(r.attributeData[u]){l!==f&&(s.bind(d),l=f);const p=r.attributeData[u].location;if(n.enableVertexAttribArray(p),n.vertexAttribPointer(p,h.size,h.type||n.FLOAT,h.normalized,h.stride,h.start),h.instance)if(this.hasInstance)n.vertexAttribDivisor(p,h.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,n,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,l,(n||0)*a,i||1):s.drawElements(e,r||o.indexBuffer.data.length,l,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,n,r||o.getSize(),i||1):s.drawArrays(e,n,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Q_.extension={type:X.RendererSystem,name:"geometry"};J.add(Q_);const Ox=new Fe;class Z_{constructor(e,r){this._texture=e,this.mapCoord=new Fe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];r[i]=s*n.a+o*n.c+n.tx,r[i+1]=s*n.b+o*n.d+n.ty}return r}update(e){const r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const n=r._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=r.orig,s=r.trim;s&&(Ox.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Ox));const o=r.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(r._frame.x+l+u)/o.width,a[1]=(r._frame.y+l+u)/o.height,a[2]=(r._frame.x+r._frame.width-l+u)/o.width,a[3]=(r._frame.y+r._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}}var eP=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,tP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class rP extends St{constructor(e,r,n){let i=null;typeof e!="string"&&r===void 0&&n===void 0&&(i=e,e=void 0,r=void 0,n=void 0),super(e||tP,r||eP,n),this.maskSprite=i,this.maskMatrix=new Fe}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,n,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Z_(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,n,i))}}class nP{constructor(e=null){this.type=et.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=St.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=et.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class J_{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let n=r;if(!n.isMaskData){const s=this.maskDataPool.pop()||new nP;s.pooled=!0,s.maskObject=r,n=s}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==et.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case et.SCISSOR:this.renderer.scissor.push(n);break;case et.STENCIL:this.renderer.stencil.push(n);break;case et.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case et.COLOR:this.pushColorMask(n);break}n.type===et.SPRITE&&this.maskStack.push(n)}pop(e){const r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case et.SCISSOR:this.renderer.scissor.pop(r);break;case et.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case et.SPRITE:this.popSpriteMask(r);break;case et.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===et.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const r=e.maskObject;r?r.isSprite?e.type=et.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=et.SCISSOR:e.type=et.STENCIL:e.type=et.COLOR}pushSpriteMask(e){const{maskObject:r}=e,n=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new rP])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=r;const s=n.filterArea;n.filterArea=r.getBounds(!0),this.renderer.filter.push(n,i),n.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const r=e._colorMask,n=e._colorMask=r&e.colorMask;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const r=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}J_.extension={type:X.RendererSystem,name:"mask"};J.add(J_);class e1{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:r}=this.renderer,n=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==n&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Ux=new Fe,zx=[],t1=class kl extends e1{constructor(e){super(e),this.glConst=K.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const r=e._scissorRect,{maskObject:n}=e,{renderer:i}=this,s=i.renderTexture,o=n.getBounds(!0,zx.pop()??new fe);this.roundFrameToPixels(o,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),r&&o.fit(r),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:r,b:n,c:i,d:s}=e;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(r)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:r}=e;if(!r.isFastRect||!r.isFastRect()||kl.isMatrixRotated(r.worldTransform)||kl.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const n=e._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(e,r,n,i,s){kl.isMatrixRotated(s)||(s=s?Ux.copyFrom(s):Ux.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*r),e.y=Math.round(e.y*r),e.width=Math.round(e.width*r),e.height=Math.round(e.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:r}=this.renderer;e._scissorRect||r.enable(r.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:r}=this.renderer;e&&zx.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():r.disable(r.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let r;this.renderer.renderTexture.current?r=e.y:r=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,r,e.width,e.height)}};t1.extension={type:X.RendererSystem,name:"scissor"};let iP=t1;J.add(iP);class r1 extends e1{constructor(e){super(e),this.glConst=K.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const r=e.maskObject,{gl:n}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,n.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(n._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}r1.extension={type:X.RendererSystem,name:"stencil"};J.add(r1);class n1{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return xe("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return xe("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return xe("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}n1.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"_plugin"};J.add(n1);class i1{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Fe,this.transform=null}update(e,r,n,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,n,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}}i1.extension={type:X.RendererSystem,name:"projection"};J.add(i1);const sP=new Op,Gx=new fe;class s1{constructor(e){this.renderer=e,this._tempMatrix=new Fe}generateTexture(e,r){const{region:n,...i}=r||{},s=(n==null?void 0:n.copyTo(Gx))||e.getLocalBounds(Gx,!0),o=i.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),i.width=s.width,i.height=s.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const a=Fi.create(i);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=sP,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}s1.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"textureGenerator"};J.add(s1);const ti=new fe,ao=new fe;class o1{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new fe,this.destinationFrame=new fe,this.viewportFrame=new fe}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,r,n){const i=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,r||(ti.width=e.frame.width,ti.height=e.frame.height,r=ti),n||(ao.x=e.frame.x,ao.y=e.frame.y,ao.width=r.width,ao.height=r.height,n=ao),o=s.framebuffer):(a=i.resolution,r||(ti.width=i._view.screen.width,ti.height=i._view.screen.height,r=ti),n||(n=ti,n.width=r.width,n.height=r.height));const l=this.viewportFrame;l.x=n.x*a,l.y=n.y*a,l.width=n.width*a,l.height=n.height*a,e||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(n,r,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)}clear(e,r){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=je.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:u,width:h,height:d}=this.viewportFrame;l=Math.round(l),u=Math.round(u),h=Math.round(h),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,u,h,d)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}o1.extension={type:X.RendererSystem,name:"renderTexture"};J.add(o1);class oP{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function aP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=H_(e,s.type),a={type:o,name:s.name,size:G_(o),location:e.getAttribLocation(t,s.name)};r[s.name]=a}return r}function lP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=H_(e,s.type);r[o]={name:o,index:i,type:l,size:s.size,isArray:a,value:U_(l,s.size)}}return r}function cP(t,e){var a;const r=Bx(t,t.VERTEX_SHADER,e.vertexSrc),n=Bx(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||DR(t,i,r,n),e.attributeData=aP(i,t),e.uniformData=lP(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((u,h)=>u>h?1:-1);for(let u=0;u<l.length;u++)e.attributeData[l[u]].location=u,t.bindAttribLocation(i,u,l[u]);t.linkProgram(i)}t.deleteShader(r),t.deleteShader(n);const o={};for(const l in e.uniformData){const u=e.uniformData[l];o[l]={location:t.getUniformLocation(i,l),value:U_(u.type,u.size)}}return new oP(i,o)}function uP(t,e,r,n,i){r.buffer.update(i)}const hP={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},a1={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function dP(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let r=0,n=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(r=a1[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!==0&&n<16){const a=n%r%16;n+=a,i+=a}n+r>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function fP(t,e){const r=[];for(const n in t)e[n]&&r.push(e[n]);return r.sort((n,i)=>n.index-i.index),r}function pP(t,e){if(!t.autoManage)return{size:0,syncFunc:uP};const r=fP(t.uniforms,e),{uboElements:n,size:i}=dP(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<n.length;o++){const a=n[o],l=t.uniforms[a.data.name],u=a.data.name;let h=!1;for(let d=0;d<Rs.length;d++){const f=Rs[d];if(f.codeUbo&&f.test(a.data,l)){s.push(`offset = ${a.offset/4};`,Rs[d].codeUbo(a.data.name,l)),h=!0;break}}if(!h)if(a.data.size>1){const d=G_(a.data.type),f=Math.max(a1[a.data.type]/16,1),p=d/f,m=(4-p%4)%4;s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*f}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const d=hP[a.data.type];s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${d};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let mP=0;const rl={textureCount:0,uboCount:0};class l1{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=mP++}systemCheck(){if(!UR())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),r||(rl.textureCount=0,rl.uboCount=0,this.syncUniformGroup(e.uniformGroup,rl)),i}setUniforms(e){const r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,r){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,r))}syncUniforms(e,r,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=NR(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const i=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,r);e.buffer.update(),i(n.uniformData,e.uniforms,this.renderer,rl,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[r])}createSyncBufferGroup(e,r,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(r.program,n);r.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=pP(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return r.uniformGroups[e.id]=a.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,n){const i=e.uniforms,s=[`${n}-`];for(const o in i)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=this.gl,n=e.program,i=cP(r,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}l1.extension={type:X.RendererSystem,name:"shader"};J.add(l1);class _c{constructor(e){this.renderer=e}run(e){const{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.4.3 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}}_c.defaultOptions={hello:!1},_c.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"startup"};J.add(_c);function gP(t,e=[]){return e[le.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.ADD]=[t.ONE,t.ONE],e[le.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.NONE]=[0,0],e[le.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[le.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[le.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[le.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[le.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[le.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[le.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[le.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[le.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[le.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[le.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const xP=0,yP=1,vP=2,_P=3,wP=4,SP=5,c1=class cf{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=le.NONE,this._blendEq=!1,this.map=[],this.map[xP]=this.setBlend,this.map[yP]=this.setOffset,this.map[vP]=this.setCullFace,this.map[_P]=this.setDepthTest,this.map[wP]=this.setFrontFace,this.map[SP]=this.setDepthMask,this.checks=[],this.defaultState=new zr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=gP(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let r=this.stateId^e.data,n=0;for(;r;)r&1&&this.map[n].call(this,!!(e.data&1<<n)),r=r>>1,n++;this.stateId=e.data}for(let r=0;r<this.checks.length;r++)this.checks[r](this,e)}forceState(e){e=e||this.defaultState;for(let r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(let r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(cf.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(cf.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const r=this.blendModes[e],n=this.gl;r.length===2?n.blendFunc(r[0],r[1]):n.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,n.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,r){this.gl.polygonOffset(e,r)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,r){const n=this.checks.indexOf(e);r&&n===-1?this.checks.push(e):!r&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,r){e.setBlendMode(r.blendMode)}static checkPolygonOffset(e,r){e.setPolygonOffset(1,r.polygonOffset)}destroy(){this.gl=null}};c1.extension={type:X.RendererSystem,name:"state"};let bP=c1;J.add(bP);class EP extends ma{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const r=(e.priority??[]).filter(i=>e.systems[i]),n=[...r,...Object.keys(e.systems).filter(i=>!r.includes(i))];for(const i of n)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(r=>{this.runners[r]=new xr(r)})}addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(e,r){const n=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=n.find(o=>this._systemsHash[o]===i);i[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const go=class Ml{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Ml.defaultMaxIdle,this.checkCountMax=Ml.defaultCheckCountMax,this.mode=Ml.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Ip.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,r=e.managedTextures;let n=!1;for(let i=0;i<r.length;i++){const s=r[i];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),r[i]=null,n=!0)}if(n){let i=0;for(let s=0;s<r.length;s++)r[s]!==null&&(r[i++]=r[s]);r.length=i}}unload(e){const r=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&r.destroyTexture(n);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};go.defaultMode=Ip.AUTO,go.defaultMaxIdle=60*60,go.defaultCheckCountMax=60*10,go.extension={type:X.RendererSystem,name:"textureGC"};let ui=go;J.add(ui);class bh{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=ne.UNSIGNED_BYTE,this.internalFormat=W.RGBA,this.samplerType=0}}function TP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:Y.FLOAT,[t.RGBA]:Y.FLOAT,[t.ALPHA]:Y.FLOAT,[t.LUMINANCE]:Y.FLOAT,[t.LUMINANCE_ALPHA]:Y.FLOAT,[t.R8]:Y.FLOAT,[t.R8_SNORM]:Y.FLOAT,[t.RG8]:Y.FLOAT,[t.RG8_SNORM]:Y.FLOAT,[t.RGB8]:Y.FLOAT,[t.RGB8_SNORM]:Y.FLOAT,[t.RGB565]:Y.FLOAT,[t.RGBA4]:Y.FLOAT,[t.RGB5_A1]:Y.FLOAT,[t.RGBA8]:Y.FLOAT,[t.RGBA8_SNORM]:Y.FLOAT,[t.RGB10_A2]:Y.FLOAT,[t.RGB10_A2UI]:Y.FLOAT,[t.SRGB8]:Y.FLOAT,[t.SRGB8_ALPHA8]:Y.FLOAT,[t.R16F]:Y.FLOAT,[t.RG16F]:Y.FLOAT,[t.RGB16F]:Y.FLOAT,[t.RGBA16F]:Y.FLOAT,[t.R32F]:Y.FLOAT,[t.RG32F]:Y.FLOAT,[t.RGB32F]:Y.FLOAT,[t.RGBA32F]:Y.FLOAT,[t.R11F_G11F_B10F]:Y.FLOAT,[t.RGB9_E5]:Y.FLOAT,[t.R8I]:Y.INT,[t.R8UI]:Y.UINT,[t.R16I]:Y.INT,[t.R16UI]:Y.UINT,[t.R32I]:Y.INT,[t.R32UI]:Y.UINT,[t.RG8I]:Y.INT,[t.RG8UI]:Y.UINT,[t.RG16I]:Y.INT,[t.RG16UI]:Y.UINT,[t.RG32I]:Y.INT,[t.RG32UI]:Y.UINT,[t.RGB8I]:Y.INT,[t.RGB8UI]:Y.UINT,[t.RGB16I]:Y.INT,[t.RGB16UI]:Y.UINT,[t.RGB32I]:Y.INT,[t.RGB32UI]:Y.UINT,[t.RGBA8I]:Y.INT,[t.RGBA8UI]:Y.UINT,[t.RGBA16I]:Y.INT,[t.RGBA16UI]:Y.UINT,[t.RGBA32I]:Y.INT,[t.RGBA32UI]:Y.UINT,[t.DEPTH_COMPONENT16]:Y.FLOAT,[t.DEPTH_COMPONENT24]:Y.FLOAT,[t.DEPTH_COMPONENT32F]:Y.FLOAT,[t.DEPTH_STENCIL]:Y.FLOAT,[t.DEPTH24_STENCIL8]:Y.FLOAT,[t.DEPTH32F_STENCIL8]:Y.FLOAT}:e={[t.RGB]:Y.FLOAT,[t.RGBA]:Y.FLOAT,[t.ALPHA]:Y.FLOAT,[t.LUMINANCE]:Y.FLOAT,[t.LUMINANCE_ALPHA]:Y.FLOAT,[t.DEPTH_STENCIL]:Y.FLOAT},e}function AP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[ne.UNSIGNED_BYTE]:{[W.RGBA]:t.RGBA8,[W.RGB]:t.RGB8,[W.RG]:t.RG8,[W.RED]:t.R8,[W.RGBA_INTEGER]:t.RGBA8UI,[W.RGB_INTEGER]:t.RGB8UI,[W.RG_INTEGER]:t.RG8UI,[W.RED_INTEGER]:t.R8UI,[W.ALPHA]:t.ALPHA,[W.LUMINANCE]:t.LUMINANCE,[W.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[ne.BYTE]:{[W.RGBA]:t.RGBA8_SNORM,[W.RGB]:t.RGB8_SNORM,[W.RG]:t.RG8_SNORM,[W.RED]:t.R8_SNORM,[W.RGBA_INTEGER]:t.RGBA8I,[W.RGB_INTEGER]:t.RGB8I,[W.RG_INTEGER]:t.RG8I,[W.RED_INTEGER]:t.R8I},[ne.UNSIGNED_SHORT]:{[W.RGBA_INTEGER]:t.RGBA16UI,[W.RGB_INTEGER]:t.RGB16UI,[W.RG_INTEGER]:t.RG16UI,[W.RED_INTEGER]:t.R16UI,[W.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[ne.SHORT]:{[W.RGBA_INTEGER]:t.RGBA16I,[W.RGB_INTEGER]:t.RGB16I,[W.RG_INTEGER]:t.RG16I,[W.RED_INTEGER]:t.R16I},[ne.UNSIGNED_INT]:{[W.RGBA_INTEGER]:t.RGBA32UI,[W.RGB_INTEGER]:t.RGB32UI,[W.RG_INTEGER]:t.RG32UI,[W.RED_INTEGER]:t.R32UI,[W.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[ne.INT]:{[W.RGBA_INTEGER]:t.RGBA32I,[W.RGB_INTEGER]:t.RGB32I,[W.RG_INTEGER]:t.RG32I,[W.RED_INTEGER]:t.R32I},[ne.FLOAT]:{[W.RGBA]:t.RGBA32F,[W.RGB]:t.RGB32F,[W.RG]:t.RG32F,[W.RED]:t.R32F,[W.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[ne.HALF_FLOAT]:{[W.RGBA]:t.RGBA16F,[W.RGB]:t.RGB16F,[W.RG]:t.RG16F,[W.RED]:t.R16F},[ne.UNSIGNED_SHORT_5_6_5]:{[W.RGB]:t.RGB565},[ne.UNSIGNED_SHORT_4_4_4_4]:{[W.RGBA]:t.RGBA4},[ne.UNSIGNED_SHORT_5_5_5_1]:{[W.RGBA]:t.RGB5_A1},[ne.UNSIGNED_INT_2_10_10_10_REV]:{[W.RGBA]:t.RGB10_A2,[W.RGBA_INTEGER]:t.RGB10_A2UI},[ne.UNSIGNED_INT_10F_11F_11F_REV]:{[W.RGB]:t.R11F_G11F_B10F},[ne.UNSIGNED_INT_5_9_9_9_REV]:{[W.RGB]:t.RGB9_E5},[ne.UNSIGNED_INT_24_8]:{[W.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[ne.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[W.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[ne.UNSIGNED_BYTE]:{[W.RGBA]:t.RGBA,[W.RGB]:t.RGB,[W.ALPHA]:t.ALPHA,[W.LUMINANCE]:t.LUMINANCE,[W.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[ne.UNSIGNED_SHORT_5_6_5]:{[W.RGB]:t.RGB},[ne.UNSIGNED_SHORT_4_4_4_4]:{[W.RGBA]:t.RGBA},[ne.UNSIGNED_SHORT_5_5_5_1]:{[W.RGBA]:t.RGBA}},e}class u1{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new he,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=AP(e),this.samplerTypes=TP(e);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new bh(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new bh(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,r=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:r,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}ensureSamplerType(e){const{boundTextures:r,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let s=e-1;s>=0;--s){const o=r[s];o&&o._glTextures[i].samplerType!==Y.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const r=new bh(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){var n;r.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,r.samplerType=this.samplerTypes[r.internalFormat]??Y.FLOAT,this.webGLVersion===2&&e.type===ne.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){var i;const r=e._glTextures[this.CONTEXT_UID];if(!r)return;const n=this.renderer;if(this.initTextureType(e,r),(i=e.resource)==null?void 0:i.upload(n,e,r))r.samplerType!==Y.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=n.gl;(r.width!==s||r.height!==o||r.dirtyId<0)&&(r.width=s,r.height=o,a.texImage2D(e.target,0,r.internalFormat,s,o,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(e);i!==-1&&Cs(this.managedTextures,i,1)}}updateTextureStyle(e){var n;const r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===Ur.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=Gn.CLAMP:r.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){const n=this.gl;if(r.mipmap&&e.mipmap!==Ur.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Qr.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===Qr.LINEAR){const s=Math.min(e.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===Qr.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===Qr.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}u1.extension={type:X.RendererSystem,name:"texture"};J.add(u1);class h1{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){const{gl:n,renderer:i}=this;r&&i.shader.bind(r),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:r,renderer:n,CONTEXT_UID:i}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[i]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(n.buffer.update(a),a._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){const n=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&s.dispose(a,r))}n&&(r||i.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}h1.extension={type:X.RendererSystem,name:"transformFeedback"};J.add(h1);class wc{constructor(e){this.renderer=e}init(e){this.screen=new fe(0,0,e.width,e.height),this.element=e.view||K.ADAPTER.createCanvas(),this.resolution=e.resolution||K.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var r;e&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}wc.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},wc.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"_view"};J.add(wc);K.PREFER_ENV=ji.WEBGL2;K.STRICT_TEXTURE_CACHE=!1;K.RENDER_OPTIONS={...vc.defaultOptions,...yc.defaultOptions,...wc.defaultOptions,..._c.defaultOptions};Object.defineProperties(K,{WRAP_MODE:{get(){return he.defaultOptions.wrapMode},set(t){xe("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),he.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return he.defaultOptions.scaleMode},set(t){xe("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),he.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return he.defaultOptions.mipmap},set(t){xe("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),he.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return he.defaultOptions.anisotropicLevel},set(t){xe("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),he.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return xe("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),St.defaultResolution},set(t){St.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return xe("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),St.defaultMultisample},set(t){St.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return ci.defaultMaxTextures},set(t){xe("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ci.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return ci.defaultBatchSize},set(t){xe("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ci.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return ci.canUploadSameBuffer},set(t){xe("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ci.canUploadSameBuffer=t}},GC_MODE:{get(){return ui.defaultMode},set(t){xe("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ui.defaultMode=t}},GC_MAX_IDLE:{get(){return ui.defaultMaxIdle},set(t){xe("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ui.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return ui.defaultCheckCountMax},set(t){xe("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ui.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return en.defaultVertexPrecision},set(t){xe("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),en.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return en.defaultFragmentPrecision},set(t){xe("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),en.defaultFragmentPrecision=t}}});var Ri=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Ri||{});class Eh{constructor(e,r=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=n,this.once=i}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const d1=class Dt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Eh(null,null,1/0),this.deltaMS=1/Dt.targetFPMS,this.elapsedMS=1/Dt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=Ri.NORMAL){return this._addListener(new Eh(e,r,n))}addOnce(e,r,n=Ri.NORMAL){return this._addListener(new Eh(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*Dt.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,Dt.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!Dt._shared){const e=Dt._shared=new Dt;e.autoStart=!0,e._protected=!0}return Dt._shared}static get system(){if(!Dt._system){const e=Dt._system=new Dt;e.autoStart=!0,e._protected=!0}return Dt._system}};d1.targetFPMS=.06;let zt=d1;Object.defineProperties(K,{TARGET_FPMS:{get(){return zt.targetFPMS},set(t){xe("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),zt.targetFPMS=t}}});class f1{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Ri.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?zt.shared:new zt,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}f1.extension=X.Application;J.add(f1);const p1=[];J.handleByList(X.Renderer,p1);function CP(t){for(const e of p1)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var RP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,PP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const IP=RP,m1=PP;class g1{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}r>=qe.HIGH?this.multisample=qe.HIGH:r>=qe.MEDIUM?this.multisample=qe.MEDIUM:r>=qe.LOW?this.multisample=qe.LOW:this.multisample=qe.NONE}destroy(){}}g1.extension={type:X.RendererSystem,name:"_multisample"};J.add(g1);class kP{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class x1{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);r.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[r]=e,n.bindBufferBase(n.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,n){const{gl:i,CONTEXT_UID:s}=this;n=n||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,o.buffer,n*256,256)}update(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{const s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),n&&(r||i.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const r=Object.keys(this.managedBuffers);for(let n=0;n<r.length;n++)this.dispose(this.managedBuffers[r[n]],e)}createGLBuffer(e){const{CONTEXT_UID:r,gl:n}=this;return e._glBuffers[r]=new kP(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}}x1.extension={type:X.RendererSystem,name:"buffer"};J.add(x1);class y1{constructor(e){this.renderer=e}render(e,r){const n=this.renderer;let i,s,o,a;if(r&&(i=r.renderTexture,s=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=o,!n.context.isLost){if(i||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(s??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),i&&(r.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}y1.extension={type:X.RendererSystem,name:"objectRenderer"};J.add(y1);const Bl=class uf extends EP{constructor(e){super(),this.type=J0.WEBGL,e=Object.assign({},K.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new yr({projectionMatrix:new Fe},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:uf.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in e&&(xe("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=uf.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:eR()}render(e,r){this.objectRenderer.render(e,r)}resize(e,r){this._view.resizeView(e,r)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return xe("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return xe("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return xe("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return xe("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){xe("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return xe("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){xe("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return xe("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,r){return this.textureGenerator.generateTexture(e,r)}};Bl.extension={type:X.Renderer,priority:1},Bl.__plugins={},Bl.__systems={};let zp=Bl;J.handleByMap(X.RendererPlugin,zp.__plugins);J.handleByMap(X.RendererSystem,zp.__systems);J.add(zp);class v1 extends aa{constructor(e,r){const{width:n,height:i}=r||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new he;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof aa?this.addResourceAt(e[n],n):this.addResourceAt(L_(e[n],r),n))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(e).then(()=>{const{realWidth:r,realHeight:n}=this.items[0];return this.resize(r,n),this.update(),Promise.resolve(this)}),this._load}}class MP extends v1{constructor(e,r){const{width:n,height:i}=r||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:n,height:i}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Es.TEXTURE_2D_ARRAY}upload(e,r,n){const{length:i,itemDirtyIds:s,items:o}=this,{gl:a}=e;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,r.format,n.type,null);for(let l=0;l<i;l++){const u=o[l];s[l]<u.dirtyId&&(s[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,r.format,n.type,u.resource.source))}return!0}}class BP extends cn{constructor(e){super(e)}static test(e){const{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const _1=class xo extends v1{constructor(e,r){const{width:n,height:i,autoLoad:s,linkBaseTexture:o}=r||{};if(e&&e.length!==xo.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:n,height:i});for(let a=0;a<xo.SIDES;a++)this.items[a].target=Es.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,r),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Es.TEXTURE_CUBE_MAP}addBaseTextureAt(e,r,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[r])throw new Error(`Index ${r} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Es.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this}upload(e,r,n){const i=this.itemDirtyIds;for(let s=0;s<xo.SIDES;s++){const o=this.items[s];(i[s]<o.dirtyId||n.dirtyId<r.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===xo.SIDES}};_1.SIDES=6;let jP=_1;class xs extends cn{constructor(e,r){r=r||{};let n,i,s;typeof e=="string"?(n=xs.EMPTY,i=e,s=!0):(n=e,i=null,s=!1),super(n),this.url=i,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.ownsImageBitmap=r.ownsImageBitmap??s,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{const n=await K.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Mt.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(n){if(this.destroyed)return;r(n),this.onError.emit(n)}}),this._load)}upload(e,r,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return xs._EMPTY=xs._EMPTY??K.ADAPTER.createCanvas(0,0),xs._EMPTY}}const hf=class jl extends cn{constructor(e,r){r=r||{},super(K.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},jl.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;cn.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=r=>{this._resolve&&(e.onerror=null,this.onError.emit(r))},e.onload=()=>{if(!this._resolve)return;const r=e.width,n=e.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=r*this.scale,s=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/n*r,s=this._overrideHeight||this._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);const o=this.source;o.width=i,o.height=s,o._pixiId=`canvas_${Ci()}`,o.getContext("2d").drawImage(e,0,0,r,n,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){const r=jl.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,r){return r==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&jl.SVG_XML.test(e)}};hf.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,hf.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let df=hf;class NP extends cn{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const ff=class pf extends cn{constructor(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){const n=document.createElement("video");r.autoLoad!==!1&&n.setAttribute("preload","auto"),r.playsinline!==!1&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),r.muted===!0&&(n.setAttribute("muted",""),n.muted=!0),r.loop===!0&&n.setAttribute("loop",""),r.autoPlay!==!1&&n.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];cn.crossOrigin(n,i,r.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const u=a.split("?").shift().toLowerCase(),h=u.slice(u.lastIndexOf(".")+1);l=l||pf.MIME_TYPES[h]||`video/${h}`}o.src=a,l&&(o.type=l),n.appendChild(o)}e=n}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=r.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),r.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const r=zt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((r,n)=>{this.valid?r(this):(this._resolve=r,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const r=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!r&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(zt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(zt.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(zt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,r){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||pf.TYPES.includes(r)}};ff.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],ff.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let w1=ff;Jd.push(xs,V_,BP,w1,NP,df,eu,jP,MP);class Sc{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?fe.EMPTY:(e=e||new fe(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){const{a:n,b:i,c:s,d:o,tx:a,ty:l}=e,u=n*r.x+s*r.y+a,h=i*r.x+o*r.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(e){let r=this.minX,n=this.minY,i=this.maxX,s=this.maxY,o=e[0],a=e[1];r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[2],a=e[3],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[4],a=e[5],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[6],a=e[7],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,this.minX=r,this.minY=n,this.maxX=i,this.maxY=s}addFrame(e,r,n,i,s){this.addFrameMatrix(e.worldTransform,r,n,i,s)}addFrameMatrix(e,r,n,i,s){const o=e.a,a=e.b,l=e.c,u=e.d,h=e.tx,d=e.ty;let f=this.minX,p=this.minY,m=this.maxX,v=this.maxY,_=o*r+l*n+h,x=a*r+u*n+d;f=_<f?_:f,p=x<p?x:p,m=_>m?_:m,v=x>v?x:v,_=o*i+l*n+h,x=a*i+u*n+d,f=_<f?_:f,p=x<p?x:p,m=_>m?_:m,v=x>v?x:v,_=o*r+l*s+h,x=a*r+u*s+d,f=_<f?_:f,p=x<p?x:p,m=_>m?_:m,v=x>v?x:v,_=o*i+l*s+h,x=a*i+u*s+d,f=_<f?_:f,p=x<p?x:p,m=_>m?_:m,v=x>v?x:v,this.minX=f,this.minY=p,this.maxX=m,this.maxY=v}addVertexData(e,r,n){let i=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=r;l<n;l+=2){const u=e[l],h=e[l+1];i=u<i?u:i,s=h<s?h:s,o=u>o?u:o,a=h>a?h:a}this.minX=i,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,r,n,i){this.addVerticesMatrix(e.worldTransform,r,n,i)}addVerticesMatrix(e,r,n,i,s=0,o=s){const a=e.a,l=e.b,u=e.c,h=e.d,d=e.tx,f=e.ty;let p=this.minX,m=this.minY,v=this.maxX,_=this.maxY;for(let x=n;x<i;x+=2){const y=r[x],g=r[x+1],w=a*y+u*g+d,S=h*g+l*y+f;p=Math.min(p,w-s),v=Math.max(v,w+s),m=Math.min(m,S-o),_=Math.max(_,S+o)}this.minX=p,this.minY=m,this.maxX=v,this.maxY=_}addBounds(e){const r=this.minX,n=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,r){const n=e.minX>r.minX?e.minX:r.minX,i=e.minY>r.minY?e.minY:r.minY,s=e.maxX<r.maxX?e.maxX:r.maxX,o=e.maxY<r.maxY?e.maxY:r.maxY;if(n<=s&&i<=o){const a=this.minX,l=this.minY,u=this.maxX,h=this.maxY;this.minX=n<a?n:a,this.minY=i<l?i:l,this.maxX=s>u?s:u,this.maxY=o>h?o:h}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){const n=e.minX>r.x?e.minX:r.x,i=e.minY>r.y?e.minY:r.y,s=e.maxX<r.x+r.width?e.maxX:r.x+r.width,o=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(n<=s&&i<=o){const a=this.minX,l=this.minY,u=this.maxX,h=this.maxY;this.minX=n<a?n:a,this.minY=i<l?i:l,this.maxX=s>u?s:u,this.maxY=o>h?o:h}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,n,i,s,o){e-=s,r-=o,n+=s,i+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class He extends ma{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Op,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Sc,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.defineProperty(He.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new fe),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new fe),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Sc);const r=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(n==null?void 0:n.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=n,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,n,i){return r&&(e=r.toGlobal(e,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,r=0,n=1,i=1,s=0,o=0,a=0,l=0,u=0){return this.position.x=e,this.position.y=r,this.scale.x=n||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new FP),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*RR}set angle(e){this.transform.rotation=e*PR}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class FP extends He{constructor(){super(...arguments),this.sortDirty=null}}He.prototype.displayObjectUpdateTransform=He.prototype.updateTransform;const LP=new Fe;function DP(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const S1=class mf extends He{constructor(){super(),this.children=[],this.sortableChildren=mf.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.addChild(e[r]);else{const r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]}addChildAt(e,r){if(r<0||r>this.children.length)throw new Error(`${e}addChildAt: The index ${r} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e}swapChildren(e,r){if(e===r)return;const n=this.getChildIndex(e),i=this.getChildIndex(r);this.children[n]=r,this.children[i]=e,this.onChildrenChange(n<i?n:i)}getChildIndex(e){const r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r}setChildIndex(e,r){if(r<0||r>=this.children.length)throw new Error(`The index ${r} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(e);Cs(this.children,n,1),this.children.splice(r,0,e),this.onChildrenChange(r)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.removeChild(e[r]);else{const r=e[0],n=this.children.indexOf(r);if(n===-1)return null;r.parent=null,r.transform._parentID=-1,Cs(this.children,n,1),this._boundsID++,this.onChildrenChange(n),r.emit("removed",this),this.emit("childRemoved",r,this,n)}return e[0]}removeChildAt(e){const r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,Cs(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r}removeChildren(e=0,r=this.children.length){const n=e,i=r,s=i-n;let o;if(s>0&&s<=i){o=this.children.splice(n,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let r=0,n=this.children.length;r<n;++r){const i=this.children[r];i._lastSortedIndex=r,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(DP),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,r=this.children.length;e<r;++e){const n=this.children[e];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const r=this.children[e];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){const n=r._mask.isMaskData?r._mask.maskObject:r._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,r=!1){const n=super.getLocalBounds(e);if(!r)for(let i=0,s=this.children.length;i<s;++i){const o=this.children[i];o.visible&&o.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const r=e.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==mf.prototype._render&&(n=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=LP.copyFrom(i),i.prepend(s)):i=s),n&&r.intersects(n,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],u=l.cullable;l.cullable=u||!this.cullArea,l.render(e),l.cullable=u}}render(e){var r;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(r=this.filters)!=null&&r.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,i=this.children.length;n<i;++n)this.children[n].render(e)}}renderAdvanced(e){var s,o,a;const r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<r.length;l++)r[l].enabled&&this._enabledFilters.push(r[l])}const i=r&&((s=this._enabledFilters)==null?void 0:s.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==et.NONE));if(i&&e.batch.flush(),r&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,u=this.children.length;l<u;++l)this.children[l].render(e)}i&&e.batch.flush(),n&&e.mask.pop(this),r&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const r=typeof e=="boolean"?e:e==null?void 0:e.children,n=this.removeChildren(0,this.children.length);if(r)for(let i=0;i<n.length;++i)n[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const r=this.getLocalBounds().width;r!==0?this.scale.x=e/r:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const r=this.getLocalBounds().height;r!==0?this.scale.y=e/r:this.scale.y=1,this._height=e}};S1.defaultSortableChildren=!1;let Lt=S1;Lt.prototype.containerUpdateTransform=Lt.prototype.updateTransform;Object.defineProperties(K,{SORTABLE_CHILDREN:{get(){return Lt.defaultSortableChildren},set(t){xe("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Lt.defaultSortableChildren=t}}});const lo=new _e,OP=new Uint16Array([0,1,2,0,2,3]);class Xn extends Lt{constructor(e){super(),this._anchor=new Jr(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new je(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=le.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Z.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=OP,this.pluginName="batch",this.isSprite=!0,this._roundPixels=K.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=kn(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=kn(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,u=this.vertexData,h=e.trim,d=e.orig,f=this._anchor;let p=0,m=0,v=0,_=0;if(h?(m=h.x-f._x*d.width,p=m+h.width,_=h.y-f._y*d.height,v=_+h.height):(m=-f._x*d.width,p=m+d.width,_=-f._y*d.height,v=_+d.height),u[0]=n*m+s*_+a,u[1]=o*_+i*m+l,u[2]=n*p+s*_+a,u[3]=o*_+i*p+l,u[4]=n*p+s*v+a,u[5]=o*v+i*p+l,u[6]=n*m+s*v+a,u[7]=o*v+i*m+l,this._roundPixels){const x=K.RESOLUTION;for(let y=0;y<u.length;++y)u[y]=Math.round(u[y]*x)/x}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,r=this.vertexTrimmedData,n=e.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,u=s.d,h=s.tx,d=s.ty,f=-i._x*n.width,p=f+n.width,m=-i._y*n.height,v=m+n.height;if(r[0]=o*f+l*m+h,r[1]=u*m+a*f+d,r[2]=o*p+l*m+h,r[3]=u*m+a*p+d,r[4]=o*p+l*v+h,r[5]=u*v+a*p+d,r[6]=o*f+l*v+h,r[7]=u*v+a*f+d,this._roundPixels){const _=K.RESOLUTION;for(let x=0;x<r.length;++x)r[x]=Math.round(r[x]*_)/_}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Sc),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new fe),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,lo);const r=this._texture.orig.width,n=this._texture.orig.height,i=-r*this.anchor.x;let s=0;return lo.x>=i&&lo.x<i+r&&(s=-n*this.anchor.y,lo.y>=s&&lo.y<s+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const r=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(e,r){const n=e instanceof Z?e:Z.from(e,r);return new Xn(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const r=kn(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const r=kn(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Z.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const b1=new Fe;He.prototype._cacheAsBitmap=!1;He.prototype._cacheData=null;He.prototype._cacheAsBitmapResolution=null;He.prototype._cacheAsBitmapMultisample=null;class UP{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(He.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new UP),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});He.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};He.prototype._initCachedDisplayObject=function(t){var f,p;if((f=this._cacheData)!=null&&f.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(new fe,!0);if((p=this.filters)!=null&&p.length){const m=this.filters[0].padding;r.pad(m)}const n=this.cacheAsBitmapResolution||t.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=Fi.create({width:r.width,height:r.height,resolution:n,multisample:this.cacheAsBitmapMultisample??t.multisample}),u=`cacheAsBitmap_${Ci()}`;this._cacheData.textureCacheId=u,he.addToCache(l.baseTexture,u),Z.addToCache(l,u);const h=this.transform.localTransform.copyTo(b1).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:h,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const d=new Xn(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(r.x/r.width),d.anchor.y=-(r.y/r.height),d.alpha=e,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)};He.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};He.prototype._initCachedDisplayObjectCanvas=function(t){var h;if((h=this._cacheData)!=null&&h.sprite)return;const e=this.getLocalBounds(new fe,!0),r=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Fi.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${Ci()}`;this._cacheData.textureCacheId=a,he.addToCache(o.baseTexture,a),Z.addToCache(o,a);const l=b1;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const u=new Xn(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};He.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};He.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};He.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,he.removeFromCache(this._cacheData.textureCacheId),Z.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};He.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};He.prototype.name=null;Lt.prototype.getChildByName=function(t,e){for(let r=0,n=this.children.length;r<n;r++)if(this.children[r].name===t)return this.children[r];if(e)for(let r=0,n=this.children.length;r<n;r++){const i=this.children[r];if(!i.getChildByName)continue;const s=i.getChildByName(t,!0);if(s)return s}return null};He.prototype.getGlobalPosition=function(t=new _e,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var zP=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class GP extends St{constructor(e=1){super(IP,zP,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const HP={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},WP=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function $P(t){const e=HP[t],r=e.length;let n=WP,i="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let l=s.replace("%index%",a.toString());o=a,a>=r&&(o=t-a-1),l=l.replace("%value%",e[o].toString()),i+=l,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}const VP=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function XP(t,e){const r=Math.ceil(t/2);let n=VP,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),i+=a,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}class gf extends St{constructor(e,r=8,n=4,i=St.defaultResolution,s=5){const o=XP(s,e),a=$P(s);super(o,a),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=n,this.blur=r}apply(e,r,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,n,i);else{const s=e.getFilterTexture(),o=e.renderer;let a=r,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Mr.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,Mr.BLIT),this.uniforms.uSampler=l;const h=l;l=a,a=h,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,n,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class YP extends St{constructor(e=8,r=4,n=St.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new gf(!0,e,r,n,i),this.blurYFilter=new gf(!1,e,r,n,i),this.resolution=n,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,n,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,r,a,Mr.CLEAR),this.blurYFilter.apply(e,a,n,i),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,r,n,i):this.blurXFilter.apply(e,r,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var KP=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class xf extends St{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(m1,KP,e),this.alpha=1}_loadMatrix(e,r=!1){let n=e;r&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,r,n){return e[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],e[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],e[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],e[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],e[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],e[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],e[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],e[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],e[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],e[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],e[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],e[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],e[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],e[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],e[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],e[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],e[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],e[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],e[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],e[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],e}_colorMatrix(e){const r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(e,r){const[n,i,s]=je.shared.setValue(e).toArray(),o=[n,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(e,r){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(e){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;const n=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=n+(1-n)*o,u=o*(1-n)-a*i,h=o*(1-n)+a*i,d=o*(1-n)+a*i,f=n+o*(1-n),p=o*(1-n)-a*i,m=o*(1-n)-a*i,v=o*(1-n)+a*i,_=n+o*(1-n),x=[l,u,h,0,0,d,f,p,0,0,m,v,_,0,0,0,0,0,1,0];this._loadMatrix(x,r)}contrast(e,r){const n=(e||0)+1,i=-.5*(n-1),s=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(s,r)}saturate(e=0,r){const n=e*2/3+1,i=(n-1)*-.5,s=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(e){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,n,i,s){e=e||.2,r=r||.15,n=n||16770432,i=i||3375104;const o=je.shared,[a,l,u]=o.setValue(n).toArray(),[h,d,f]=o.setValue(i).toArray(),p=[.3,.59,.11,0,0,a,l,u,e,0,h,d,f,r,0,a-h,l-d,u-f,0,0];this._loadMatrix(p,s)}night(e,r){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(e,r){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,r)}lsd(e){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}xf.prototype.grayscale=xf.prototype.greyscale;var qP=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,QP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class ZP extends St{constructor(e,r){const n=new Fe;e.renderable=!1,super(QP,qP,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,r==null&&(r=20),this.scale=new _e(r,r)}apply(e,r,n,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,r,n,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var JP=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,eI=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class tI extends St{constructor(){super(eI,JP)}}var rI=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class nI extends St{constructor(e=.5,r=Math.random()){super(m1,rI,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const Hx={AlphaFilter:GP,BlurFilter:YP,BlurFilterPass:gf,ColorMatrixFilter:xf,DisplacementFilter:ZP,FXAAFilter:tI,NoiseFilter:nI};Object.entries(Hx).forEach(([t,e])=>{Object.defineProperty(Hx,t,{get(){return xe("7.1.0",`filters.${t} has moved to ${t}`),e}})});class iI{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(zt.system.add(this.tickerUpdate,this,Ri.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(zt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const An=new iI;class va{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=va.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new _e,this.page=new _e,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,n,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class bc extends va{constructor(){super(...arguments),this.client=new _e,this.movement=new _e,this.offset=new _e,this.global=new _e,this.screen=new _e}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,r,n){return e.worldTransform.applyInverse(n||this.global,r)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,n,i,s,o,a,l,u,h,d,f,p,m,v){throw new Error("Method not implemented.")}}class ur extends bc{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Ps extends bc{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Ps.DOM_DELTA_PIXEL=0,Ps.DOM_DELTA_LINE=1,Ps.DOM_DELTA_PAGE=2;const sI=2048,oI=new _e,Th=new _e;class aI{constructor(e){this.dispatch=new ma,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const r=this.mappingTable[e.type];if(r)for(let n=0,i=r.length;n<i;n++)r[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){An.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[n](this.rootTarget,this.rootTarget.eventMode,oI.set(e,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,r){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=n.length-1;i<s;i++)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(r)?r:[r];for(let s=n.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=n[s],this.notifyTarget(e,o)})}propagationPath(e){const r=[e];for(let n=0;n<sI&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestMoveRecursive(e,r,n,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(An.pauseUpdate=!1),e.interactiveChildren&&e.children){const h=e.children;for(let d=h.length-1;d>=0;d--){const f=h[d],p=this.hitTestMoveRecursive(f,this._isInteractive(r)?r:f.eventMode,n,i,s,o||s(e,n));if(p){if(p.length>0&&!p[p.length-1].parent)continue;const m=e.isInteractive();(p.length>0||m)&&(m&&this._allInteractiveElements.push(e),p.push(e)),this._hitElements.length===0&&(this._hitElements=p),a=!0}}}const l=this._isInteractive(r),u=e.isInteractive();return l&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,n)&&i(e,n)?u?[e]:[]:null}hitTestRecursive(e,r,n,i,s){if(this._interactivePrune(e)||s(e,n))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(An.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let u=l.length-1;u>=0;u--){const h=l[u],d=this.hitTestRecursive(h,this._isInteractive(r)?r:h.eventMode,n,i,s);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const f=e.isInteractive();return(d.length>0||f)&&d.push(e),d}}}const o=this._isInteractive(r),a=e.isInteractive();return o&&i(e,n)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,r){var n;if(e.hitArea&&(e.worldTransform.applyInverse(r,Th),!e.hitArea.contains(Th.x,Th.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,r)))return!0}return!1}hitTestFn(e,r){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){var s,o;r=r??e.type;const n=`on${r}`;(o=(s=e.currentTarget)[n])==null||o.call(s,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){var l,u;if(!(e instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(((l=i.overTargets)==null?void 0:l.length)>0&&s!==r.target){const h=e.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(e,h,s);if(this.dispatchEvent(d,"pointerout"),n&&this.dispatchEvent(d,"mouseout"),!r.composedPath().includes(s)){const f=this.createPointerEvent(e,"pointerleave",s);for(f.eventPhase=f.AT_TARGET;f.target&&!r.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),n&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(d)}if(s!==r.target){const h=e.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(r,h);this.dispatchEvent(d,"pointerover"),n&&this.dispatchEvent(d,"mouseover");let f=s==null?void 0:s.parent;for(;f&&f!==this.rootTarget.parent&&f!==r.target;)f=f.parent;if(!f||f===this.rootTarget.parent){const p=this.clonePointerEvent(r,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==s&&p.target!==this.rootTarget.parent;)p.currentTarget=p.target,this.notifyTarget(p),n&&this.notifyTarget(p,"mouseenter"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(d)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),n&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=r.target)==null?void 0:u.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){var o;if(!(e instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(o=n.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(n,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId);if(r.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),n&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const a=n.button===2;this.dispatchEvent(n,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!n.composedPath().includes(s)){let a=s;for(;a&&!n.composedPath().includes(a);){if(n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.notifyTarget(n,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(n,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:r});const l=i.clicksByButton[e.button];if(l.target===a.target&&r-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=r,a.detail=l.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let s=n;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof Ps)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let n=1;n<e.length&&e[n].parent===r;n++)r=e[n];return r}createPointerEvent(e,r,n){const i=this.allocateEvent(ur);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof r=="string"&&(i.type=r),i}createWheelEvent(e){const r=this.allocateEvent(Ps);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){const n=this.allocateEvent(ur);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=r??n.type,n}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof ur&&r instanceof ur&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof bc&&r instanceof bc&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.shiftKey=e.shiftKey,r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){const n=e.currentTarget._events[r];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(r,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let i=0,s=n.length;i<s&&!e.propagationImmediatelyStopped;i++)n[i].once&&e.currentTarget.removeListener(r,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,e)}}const lI=1,cI={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},yf=class vf{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new aI(null),An.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ur(null),this.rootWheelEvent=new Ps(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...vf.defaultEventFeatures},{set:(r,n,i)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),r[n]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,vf._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=r.length;n<i;n++){const s=r[n],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,An.pointerMoved();const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let r=e.target;e.composedPath&&e.composedPath().length>0&&(r=e.composedPath()[0]);const n=r!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,i[s]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const r=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(e){this.removeEvents(),this.domElement=e,An.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;An.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;An.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,r,n){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(r-i.left)*(this.domElement.width/i.width)*s,e.y=(n-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){const r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const s=e.changedTouches[n];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,r.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=lI),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(e);return r}normalizeWheelEvent(e){const r=this.rootWheelEvent;return this.transferMouseData(r,e),r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ,r.deltaMode=e.deltaMode,this.mapPositionToPoint(r.screen,e.clientX,e.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=e,r.type=e.type,r}bootstrapEvent(e,r){return e.originalEvent=null,e.nativeEvent=r,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r),this.mapPositionToPoint(e.screen,r.clientX,r.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=r.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=cI[e.type]||e.type),e}transferMouseData(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=performance.now(),e.type=r.type,e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.relatedTarget=null,e.shiftKey=r.shiftKey}};yf.extension={name:"events",type:[X.RendererSystem,X.CanvasRendererSystem]},yf.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let _f=yf;J.add(_f);function Wx(t){return t==="dynamic"||t==="static"}const uI={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Wx(_f.defaultEventMode)},set interactive(t){xe("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??_f.defaultEventMode},set eventMode(t){this._internalInteractive=Wx(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof r=="object"?r.signal:void 0,s=typeof r=="object"?r.once===!0:!1,o=typeof e=="function"?void 0:e;t=n?`${t}capture`:t;const a=typeof e=="function"?e:e.handleEvent,l=this;i&&i.addEventListener("abort",()=>{l.off(t,a,o)}),s?l.once(t,a,o):l.on(t,a,o)},removeEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof va))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};He.mixin(uI);const hI={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};He.mixin(hI);const dI=9,nl=100,fI=0,pI=0,$x=2,Vx=1,mI=-1e3,gI=-1e3,xI=2;class E1{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Zr.tablet||Zr.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${nl}px`,r.style.height=`${nl}px`,r.style.position="absolute",r.style.top=`${fI}px`,r.style.left=`${pI}px`,r.style.zIndex=$x.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${Vx}px`,e.style.height=`${Vx}px`,e.style.position="absolute",e.style.top=`${mI}px`,e.style.left=`${gI}px`,e.style.zIndex=xI.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const r=e.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const e=performance.now();if(Zr.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,u=i/o*l,h=s/a*l;let d=this.div;d.style.left=`${r}px`,d.style.top=`${n}px`,d.style.width=`${o}px`,d.style.height=`${a}px`;for(let f=0;f<this.children.length;f++){const p=this.children[f];if(p.renderId!==this.renderId)p._accessibleActive=!1,Cs(this.children,f,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,f--;else{d=p._accessibleDiv;let m=p.hitArea;const v=p.worldTransform;p.hitArea?(d.style.left=`${(v.tx+m.x*v.a)*u}px`,d.style.top=`${(v.ty+m.y*v.d)*h}px`,d.style.width=`${m.width*v.a*u}px`,d.style.height=`${m.height*v.d*h}px`):(m=p.getBounds(),this.capHitArea(m),d.style.left=`${m.x*u}px`,d.style.top=`${m.y*h}px`,d.style.width=`${m.width*u}px`,d.style.height=`${m.height*h}px`,d.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(d.title=p.accessibleTitle),d.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&d.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==d.title||p.tabIndex!==d.tabIndex)&&(d.title=p.accessibleTitle,d.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:r,height:n}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${nl}px`,r.style.height=`${nl}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=$x.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){const{displayObject:n}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new va(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===dI&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}E1.extension={name:"accessibility",type:[X.RendererPlugin,X.CanvasRendererPlugin]};J.add(E1);const T1=class wf{constructor(e){this.stage=new Lt,e=Object.assign({forceCanvas:!1},e),this.renderer=CP(e),wf._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,r){const n=wf._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};T1._plugins=[];let A1=T1;J.handleByList(X.Application,A1._plugins);class C1{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;r=i,n=s}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}C1.extension=X.Application;J.add(C1);const Xx={loader:X.LoadParser,resolver:X.ResolveParser,cache:X.CacheParser,detection:X.DetectionParser};J.handle(X.Asset,t=>{const e=t.ref;Object.entries(Xx).filter(([r])=>!!e[r]).forEach(([r,n])=>J.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(Xx).filter(r=>!!e[r]).forEach(r=>J.remove(e[r]))});class yI{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Xs(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function Jn(t,e){const r=t.split("?")[0],n=at.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const pr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t),Sf=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t};function R1(t,e,r,n,i){const s=e[r];for(let o=0;o<s.length;o++){const a=s[o];r<e.length-1?R1(t.replace(n[r],a),e,r+1,n,i):i.push(t.replace(n[r],a))}}function vI(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const i=[];r.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),R1(t,i,0,r,n)}else n.push(t);return n}const Ec=t=>!Array.isArray(t);class _I{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=pr(e);let i;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(r)){i=l.getCacheableAssets(n,r);break}}i||(i={},n.forEach(a=>{i[a]=r}));const s=Object.keys(i),o={cacheKeys:s,keys:n};if(n.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{const l=i?i[a]:r;this._cache.has(a)&&this._cache.get(a)!==l&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),r instanceof Z){const a=r;n.forEach(l=>{a.baseTexture!==Z.EMPTY.baseTexture&&he.addToCache(a.baseTexture,l),Z.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const di=new _I;class wI{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{var o,a;let i=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.load&&((o=u.test)!=null&&o.call(u,e,r,this))){s=u;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,r,this),n.parser=s;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,i,r,this))&&(i=await u.parse(i,r,this)||i,n.parser=u)}return i})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const i={},s=Ec(e),o=pr(e,u=>({alias:[u],src:u})),a=o.length,l=o.map(async u=>{const h=at.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[h]||(this.promiseCache[h]=this._getLoadPromiseAndParser(h,u)),i[u.src]=await this.promiseCache[h].promise,r&&r(++n/a)}catch(d){throw delete this.promiseCache[h],delete i[u.src],new Error(`[Loader.load] Failed to load ${h}.
${d}`)}});return await Promise.all(l),s?i[o[0].src]:i}async unload(e){const r=pr(e,n=>({alias:[n],src:n})).map(async n=>{var o,a;const i=at.toAbsolute(n.src),s=this.promiseCache[i];if(s){const l=await s.promise;delete this.promiseCache[i],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,n,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(e[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...e,[r.name]:r}),{})}}var _r=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(_r||{});const SI=".json",bI="application/json",EI={extension:{type:X.LoadParser,priority:_r.Low},name:"loadJson",test(t){return Xs(t,bI)||Jn(t,SI)},async load(t){return await(await K.ADAPTER.fetch(t)).json()}};J.add(EI);const TI=".txt",AI="text/plain",CI={name:"loadTxt",extension:{type:X.LoadParser,priority:_r.Low},test(t){return Xs(t,AI)||Jn(t,TI)},async load(t){return await(await K.ADAPTER.fetch(t)).text()}};J.add(CI);const RI=["normal","bold","100","200","300","400","500","600","700","800","900"],PI=[".ttf",".otf",".woff",".woff2"],II=["font/ttf","font/otf","font/woff","font/woff2"],kI=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function MI(t){const e=at.extname(t),r=at.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let n=r.length>0;for(const s of r)if(!s.match(kI)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const BI=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function jI(t){return BI.test(t)?t:encodeURI(t)}const NI={extension:{type:X.LoadParser,priority:_r.Low},name:"loadWebFont",test(t){return Xs(t,II)||Jn(t,PI)},async load(t,e){var n,i,s;const r=K.ADAPTER.getFontFaceSet();if(r){const o=[],a=((n=e.data)==null?void 0:n.family)??MI(t),l=((s=(i=e.data)==null?void 0:i.weights)==null?void 0:s.filter(h=>RI.includes(h)))??["normal"],u=e.data??{};for(let h=0;h<l.length;h++){const d=l[h],f=new FontFace(a,`url(${jI(t)})`,{...u,weight:d});await f.load(),r.add(f),o.push(f)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>K.ADAPTER.getFontFaceSet().delete(e))}};J.add(NI);const FI=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Is=null,bf=class{constructor(){Is||(Is=URL.createObjectURL(new Blob([FI],{type:"application/javascript"}))),this.worker=new Worker(Is)}};bf.revokeObjectURL=function(){Is&&(URL.revokeObjectURL(Is),Is=null)};const LI=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let ks=null;class P1{constructor(){ks||(ks=URL.createObjectURL(new Blob([LI],{type:"application/javascript"}))),this.worker=new Worker(ks)}}P1.revokeObjectURL=function(){ks&&(URL.revokeObjectURL(ks),ks=null)};let Yx=0,Ah;class DI{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new bf;r.addEventListener("message",n=>{r.terminate(),bf.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Ah===void 0&&(Ah=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<Ah&&(this._createdWorkers++,e=new P1().worker,e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((i,s)=>{this.queue.push({id:e,arguments:r,resolve:i,reject:s})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const r=this.queue.pop(),n=r.id;this.resolveHash[Yx]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:Yx++,id:n})}}const Kx=new DI;function _a(t,e,r){t.resource.internal=!0;const n=new Z(t),i=()=>{delete e.promiseCache[r],di.has(r)&&di.remove(r)};return n.baseTexture.once("destroyed",()=>{r in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),n.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const OI=[".jpeg",".jpg",".png",".webp",".avif"],UI=["image/jpeg","image/png","image/webp","image/avif"];async function zI(t){const e=await K.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}const su={name:"loadTextures",extension:{type:X.LoadParser,priority:_r.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Xs(t,UI)||Jn(t,OI)},async load(t,e,r){var a;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;n?this.config.preferWorkers&&await Kx.isImageBitmapSupported()?i=await Kx.loadImageBitmap(t):i=await zI(t):i=await new Promise((l,u)=>{const h=new Image;h.crossOrigin=this.config.crossOrigin,h.src=t,h.complete?l(h):(h.onload=()=>l(h),h.onerror=d=>u(d))});const s={...e.data};s.resolution??(s.resolution=ln(t)),n&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new he(i,s);return o.resource.src=t,_a(o,r,t)},unload(t){t.destroy(!0)}};J.add(su);const GI=".svg",HI="image/svg+xml",WI={extension:{type:X.LoadParser,priority:_r.High},name:"loadSVG",test(t){return Xs(t,HI)||Jn(t,GI)},async testParse(t){return df.test(t)},async parse(t,e,r){var s;const n=new df(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await n.load();const i=new he(n,{resolution:ln(t),...e==null?void 0:e.data});return i.resource.src=e.src,_a(i,r,e.src)},async load(t,e){return(await K.ADAPTER.fetch(t)).text()},unload:su.unload};J.add(WI);const $I=[".mp4",".m4v",".webm",".ogv"],VI=["video/mp4","video/webm","video/ogg"],XI={name:"loadVideo",extension:{type:X.LoadParser,priority:_r.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return Xs(t,VI)||Jn(t,$I)},async load(t,e,r){var o;let n;const i=await(await K.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},l=new w1(s,a);await l.load();const u=new he(l,{alphaMode:await J2(),resolution:ln(t),...e==null?void 0:e.data});u.resource.src=t,n=_a(u,r,t),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return n},unload(t){t.destroy(!0)}};J.add(XI);class YI{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,name:n,src:i,srcs:s}=e;return pr(r||n||i||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];Array.isArray(r)?r.forEach(i=>{const s=i.src??i.srcs,o=i.alias??i.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);n.push(l),a=[o,l]}else{const l=o.map(u=>this._createBundleAssetId(e,u));n.push(...l),a=[...o,...l]}this.add({...i,alias:a,src:s})}):Object.keys(r).forEach(i=>{const s=[i,this._createBundleAssetId(e,i)];if(typeof r[i]=="string")this.add({alias:s,src:r[i]});else if(Array.isArray(r[i]))this.add({alias:s,src:r[i]});else{const o=r[i],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}n.push(...s)}),this._bundles[e]=n}add(e,r,n,i,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(xe("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:r,data:n,format:i,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},pr(o).forEach(l=>{const{src:u,srcs:h}=l;let{data:d,format:f,loadParser:p}=l;const m=pr(u||h).map(x=>typeof x=="string"?vI(x):Array.isArray(x)?x:[x]),v=this.getAlias(l);Array.isArray(v)?v.forEach(a):a(v);const _=[];m.forEach(x=>{x.forEach(y=>{let g={};if(typeof y!="object"){g.src=y;for(let w=0;w<this._parsers.length;w++){const S=this._parsers[w];if(S.test(y)){g=S.parse(y);break}}}else d=y.data??d,f=y.format??f,p=y.loadParser??p,g={...g,...y};if(!v)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this.buildResolvedAsset(g,{aliases:v,data:d,format:f,loadParser:p}),_.push(g)})}),v.forEach(x=>{this._assetMap[x]=_})})}resolveBundle(e){const r=Ec(e);e=pr(e);const n={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(i,l)]=u}n[i]=a}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const i in r)n[i]=r[i].src;return n}return r.src}resolve(e){const r=Ec(e);e=pr(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(u=>{const h=s.filter(d=>d[l]?d[l]===u:!1);h.length&&(s=h)})}),this._resolverHash[i]=s[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}buildResolvedAsset(e,r){const{aliases:n,data:i,loadParser:s,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=at.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??at.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class KI{constructor(){this._detections=[],this._initialized=!1,this.resolver=new YI,this.loader=new wI,this.cache=di,this._backgroundLoader=new yI(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const r=((s=e.texturePreference)==null?void 0:s.resolution)??1,n=typeof r=="number"?[r]:r,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e,r,n,i,s){this.resolver.add(e,r,n,i,s)}async load(e,r){this._initialized||await this.init();const n=Ec(e),i=pr(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,r);return n?o[i[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,l=0;const u=()=>{r==null||r(++a/l)},h=o.map(d=>{const f=i[d];return l+=Object.keys(f).length,this._mapLoadToResolve(f,u).then(p=>{s[d]=p})});return await Promise.all(h),n?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return di.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=di.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const o={};return n.forEach((a,l)=>{const u=s[a.src],h=[a.src];a.alias&&h.push(...a.alias),o[i[l]]=u,di.set(h,u)}),o}async unload(e){this._initialized||await this.init();const r=pr(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=pr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{di.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,i)=>r.indexOf(n)===i),r}get detections(){return this._detections}get preferWorkers(){return su.config.preferWorkers}set preferWorkers(e){xe("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const yo=new KI;J.handleByList(X.LoadParser,yo.loader.parsers).handleByList(X.ResolveParser,yo.resolver.parsers).handleByList(X.CacheParser,yo.cache.parsers).handleByList(X.DetectionParser,yo.detections);const qI={extension:X.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof Z),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((i,s)=>{r[n+(s===0?"":s+1)]=i})}),r}};J.add(qI);async function I1(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const QI={extension:{type:X.DetectionParser,priority:1},test:async()=>I1("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};J.add(QI);const ZI={extension:{type:X.DetectionParser,priority:0},test:async()=>I1("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};J.add(ZI);const qx=["png","jpg","jpeg"],JI={extension:{type:X.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...qx],remove:async t=>t.filter(e=>!qx.includes(e))};J.add(JI);const ek="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Gp(t){return ek?!1:document.createElement("video").canPlayType(t)!==""}const tk={extension:{type:X.DetectionParser,priority:0},test:async()=>Gp("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};J.add(tk);const rk={extension:{type:X.DetectionParser,priority:0},test:async()=>Gp("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};J.add(rk);const nk={extension:{type:X.DetectionParser,priority:0},test:async()=>Gp("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};J.add(nk);const ik={extension:X.ResolveParser,test:su.test,parse:t=>{var e;return{resolution:parseFloat(((e=K.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:at.extname(t).slice(1),src:t}}};J.add(ik);var lt=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(lt||{});const Tc={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Cr,ts;function Qx(){ts={bptc:Cr.getExtension("EXT_texture_compression_bptc"),astc:Cr.getExtension("WEBGL_compressed_texture_astc"),etc:Cr.getExtension("WEBGL_compressed_texture_etc"),s3tc:Cr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Cr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Cr.getExtension("WEBGL_compressed_texture_pvrtc")||Cr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Cr.getExtension("WEBGL_compressed_texture_etc1"),atc:Cr.getExtension("WEBGL_compressed_texture_atc")}}const sk={extension:{type:X.DetectionParser,priority:2},test:async()=>{const t=K.ADAPTER.createCanvas().getContext("webgl");return t?(Cr=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{ts||Qx();const e=[];for(const r in ts)ts[r]&&e.push(r);return[...e,...t]},remove:async t=>(ts||Qx(),t.filter(e=>!(e in ts)))};J.add(sk);class ok extends eu{constructor(e,r={width:1,height:1,autoLoad:!0}){let n,i;typeof e=="string"?(n=e,i=new Uint8Array):(n=null,i=e),super(i,r),this.origin=n,this.buffer=i?new Zd(i):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new Zd(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class _i extends ok{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=_i._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||_i._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,n){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:u,levelBuffer:h}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,l,u,0,h)}return!0}onBlobLoaded(){this._levelBuffers=_i._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,r,n,i,s,o,a){const l=new Array(n);let u=e.byteOffset,h=o,d=a,f=h+i-1&~(i-1),p=d+s-1&~(s-1),m=f*p*Tc[r];for(let v=0;v<n;v++)l[v]={levelID:v,levelWidth:n>1?h:f,levelHeight:n>1?d:p,levelBuffer:new Uint8Array(e.buffer,u,m)},u+=m,h=h>>1||1,d=d>>1||1,f=h+i-1&~(i-1),p=d+s-1&~(s-1),m=f*p*Tc[r];return l}}const Ch=4,il=124,ak=32,Zx=20,lk=542327876,sl={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},ck={FOURCC:2},ol={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},uk=1,hk=2,dk=4,fk=64,pk=512,mk=131072,gk=827611204,xk=861165636,yk=894720068,vk=808540228,_k=4,wk={[gk]:lt.COMPRESSED_RGBA_S3TC_DXT1_EXT,[xk]:lt.COMPRESSED_RGBA_S3TC_DXT3_EXT,[yk]:lt.COMPRESSED_RGBA_S3TC_DXT5_EXT},Sk={70:lt.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:lt.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:lt.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:lt.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:lt.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:lt.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:lt.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:lt.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:lt.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:lt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function bk(t){const e=new Uint32Array(t);if(e[0]!==lk)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,il/Uint32Array.BYTES_PER_ELEMENT),n=r[sl.HEIGHT],i=r[sl.WIDTH],s=r[sl.MIPMAP_COUNT],o=new Uint32Array(t,sl.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,ak/Uint32Array.BYTES_PER_ELEMENT),a=o[uk];if(a&dk){const l=o[ck.FOURCC];if(l!==vk){const y=wk[l],g=Ch+il,w=new Uint8Array(t,g);return[new _i(w,{format:y,width:i,height:n,levels:s})]}const u=Ch+il,h=new Uint32Array(e.buffer,u,Zx/Uint32Array.BYTES_PER_ELEMENT),d=h[ol.DXGI_FORMAT],f=h[ol.RESOURCE_DIMENSION],p=h[ol.MISC_FLAG],m=h[ol.ARRAY_SIZE],v=Sk[d];if(v===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(p===_k)throw new Error("DDSParser does not support cubemap textures");if(f===6)throw new Error("DDSParser does not supported 3D texture data");const _=new Array,x=Ch+il+Zx;if(m===1)_.push(new Uint8Array(t,x));else{const y=Tc[v];let g=0,w=i,S=n;for(let A=0;A<s;A++){const E=Math.max(1,w+3&-4),k=Math.max(1,S+3&-4),F=E*k*y;g+=F,w=w>>>1,S=S>>>1}let T=x;for(let A=0;A<m;A++)_.push(new Uint8Array(t,T,g)),T+=g}return _.map(y=>new _i(y,{format:v,width:i,height:n,levels:s}))}throw a&fk?new Error("DDSParser does not support uncompressed texture data."):a&pk?new Error("DDSParser does not supported YUV uncompressed texture data."):a&mk?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&hk?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Jx=[171,75,84,88,32,49,49,187,13,10,26,10],Ek=67305985,lr={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Ef=64,ey={[ne.UNSIGNED_BYTE]:1,[ne.UNSIGNED_SHORT]:2,[ne.INT]:4,[ne.UNSIGNED_INT]:4,[ne.FLOAT]:4,[ne.HALF_FLOAT]:8},Tk={[W.RGBA]:4,[W.RGB]:3,[W.RG]:2,[W.RED]:1,[W.LUMINANCE]:1,[W.LUMINANCE_ALPHA]:2,[W.ALPHA]:1},Ak={[ne.UNSIGNED_SHORT_4_4_4_4]:2,[ne.UNSIGNED_SHORT_5_5_5_1]:2,[ne.UNSIGNED_SHORT_5_6_5]:2};function Ck(t,e,r=!1){const n=new DataView(e);if(!Rk(t,n))return null;const i=n.getUint32(lr.ENDIANNESS,!0)===Ek,s=n.getUint32(lr.GL_TYPE,i),o=n.getUint32(lr.GL_FORMAT,i),a=n.getUint32(lr.GL_INTERNAL_FORMAT,i),l=n.getUint32(lr.PIXEL_WIDTH,i),u=n.getUint32(lr.PIXEL_HEIGHT,i)||1,h=n.getUint32(lr.PIXEL_DEPTH,i)||1,d=n.getUint32(lr.NUMBER_OF_ARRAY_ELEMENTS,i)||1,f=n.getUint32(lr.NUMBER_OF_FACES,i),p=n.getUint32(lr.NUMBER_OF_MIPMAP_LEVELS,i),m=n.getUint32(lr.BYTES_OF_KEY_VALUE_DATA,i);if(u===0||h!==1)throw new Error("Only 2D textures are supported");if(f!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");const v=4,_=4,x=l+3&-4,y=u+3&-4,g=new Array(d);let w=l*u;s===0&&(w=x*y);let S;if(s!==0?ey[s]?S=ey[s]*Tk[o]:S=Ak[s]:S=Tc[a],S===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const T=r?Ik(n,m,i):null;let A=w*S,E=l,k=u,F=x,L=y,U=Ef+m;for(let P=0;P<p;P++){const I=n.getUint32(U,i);let D=U+4;for(let O=0;O<d;O++){let M=g[O];M||(M=g[O]=new Array(p)),M[P]={levelID:P,levelWidth:p>1||s!==0?E:F,levelHeight:p>1||s!==0?k:L,levelBuffer:new Uint8Array(e,D,A)},D+=A}U+=I+4,U=U%4!==0?U+4-U%4:U,E=E>>1||1,k=k>>1||1,F=E+v-1&-4,L=k+_-1&-4,A=F*L*S}return s!==0?{uncompressed:g.map(P=>{let I=P[0].levelBuffer,D=!1;return s===ne.FLOAT?I=new Float32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4):s===ne.UNSIGNED_INT?(D=!0,I=new Uint32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)):s===ne.INT&&(D=!0,I=new Int32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)),{resource:new eu(I,{width:P[0].levelWidth,height:P[0].levelHeight}),type:s,format:D?Pk(o):o}}),kvData:T}:{compressed:g.map(P=>new _i(null,{format:a,width:l,height:u,levels:p,levelBuffers:P})),kvData:T}}function Rk(t,e){for(let r=0;r<Jx.length;r++)if(e.getUint8(r)!==Jx[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function Pk(t){switch(t){case W.RGBA:return W.RGBA_INTEGER;case W.RGB:return W.RGB_INTEGER;case W.RG:return W.RG_INTEGER;case W.RED:return W.RED_INTEGER;default:return t}}function Ik(t,e,r){const n=new Map;let i=0;for(;i<e;){const s=t.getUint32(Ef+i,r),o=Ef+i+4,a=3-(s+3)%4;if(s===0||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&t.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(t.buffer,o,l)),h=new DataView(t.buffer,o+l+1,s-l-1);n.set(u,h),i+=4+s+a}return n}const kk={extension:{type:X.LoadParser,priority:_r.High},name:"loadDDS",test(t){return Jn(t,".dds")},async load(t,e,r){const n=await(await K.ADAPTER.fetch(t)).arrayBuffer(),i=bk(n).map(s=>{const o=new he(s,{mipmap:Ur.OFF,alphaMode:Mt.NO_PREMULTIPLIED_ALPHA,resolution:ln(t),...e.data});return _a(o,r,t)});return i.length===1?i[0]:i},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};J.add(kk);const Mk={extension:{type:X.LoadParser,priority:_r.High},name:"loadKTX",test(t){return Jn(t,".ktx")},async load(t,e,r){const n=await(await K.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=Ck(t,n),a=i??s,l={mipmap:Ur.OFF,alphaMode:Mt.NO_PREMULTIPLIED_ALPHA,resolution:ln(t),...e.data},u=a.map(h=>{a===s&&Object.assign(l,{type:h.type,format:h.format});const d=h.resource??h,f=new he(d,l);return f.ktxKeyValueData=o,_a(f,r,t)});return u.length===1?u[0]:u},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};J.add(Mk);const Bk=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],jk={extension:X.ResolveParser,test:t=>{const e=at.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var n,i;const e=t.split("."),r=e.pop();if(["ktx","dds"].includes(r)){const s=e.pop();if(Bk.includes(s))return{resolution:parseFloat(((n=K.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:s,src:t}}return{resolution:parseFloat(((i=K.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:r,src:t}}};J.add(jk);const al=new fe,Nk=4,k1=class vo{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,r,n,i){const s=new Image;return s.src=await this.base64(e,r,n,i),s}async base64(e,r,n,i){const s=this.canvas(e,i);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>o(u.result),u.onerror=a,u.readAsDataURL(l)},r,n)});if(s.toDataURL!==void 0)return s.toDataURL(r,n);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:r,quality:n});return new Promise((a,l)=>{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=l,u.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);o&&vo._flipY(n,i,s),a&&vo._unpremultiplyAlpha(n);const l=new mR(i,s,1),u=new ImageData(new Uint8ClampedArray(n.buffer),i,s);return l.context.putImageData(u,0,0),l.canvas}pixels(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);return o&&vo._flipY(n,i,s),a&&vo._unpremultiplyAlpha(n),n}_rawPixels(e,r){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let i,s=!1,o=!1,a,l=!1;e&&(e instanceof Fi?a=e:(a=n.generateTexture(e,{region:r,resolution:n.resolution,multisample:n.multisample}),l=!0,r&&(al.width=r.width,al.height=r.height,r=al)));const u=n.gl;if(a){if(i=a.baseTexture.resolution,r=r??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===W.RGBA,!l){n.renderTexture.bind(a);const p=a.framebuffer.glFramebuffers[n.CONTEXT_UID];p.blitFramebuffer&&n.framebuffer.bind(p.blitFramebuffer)}}else i=n.resolution,r||(r=al,r.width=n.width/i,r.height=n.height/i),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const h=Math.max(Math.round(r.width*i),1),d=Math.max(Math.round(r.height*i),1),f=new Uint8Array(Nk*h*d);return u.readPixels(Math.round(r.x*i),Math.round(r.y*i),h,d,u.RGBA,u.UNSIGNED_BYTE,f),l&&(a==null||a.destroy(!0)),{pixels:f,width:h,height:d,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,r,n){const i=r<<2,s=n>>1,o=new Uint8Array(i);for(let a=0;a<s;a++){const l=a*i,u=(n-a-1)*i;o.set(e.subarray(l,l+i)),e.copyWithin(l,u,u+i),e.set(o,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const r=e.length;for(let n=0;n<r;n+=4){const i=e[n+3];if(i!==0){const s=255.001/i;e[n]=e[n]*s+.5,e[n+1]=e[n+1]*s+.5,e[n+2]=e[n+2]*s+.5}}}};k1.extension={name:"extract",type:X.RendererSystem};let Fk=k1;J.add(Fk);const Ac={build(t){const e=t.points;let r,n,i,s,o,a;if(t.type===ut.CIRC){const m=t.shape;r=m.x,n=m.y,o=a=m.radius,i=s=0}else if(t.type===ut.ELIP){const m=t.shape;r=m.x,n=m.y,o=m.width,a=m.height,i=s=0}else{const m=t.shape,v=m.width/2,_=m.height/2;r=m.x+v,n=m.y+_,o=a=Math.max(0,Math.min(m.radius,Math.min(v,_))),i=v-o,s=_-a}if(!(o>=0&&a>=0&&i>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(i?4:0)+(s?4:0);if(e.length=u,u===0)return;if(l===0){e.length=8,e[0]=e[6]=r+i,e[1]=e[3]=n+s,e[2]=e[4]=r-i,e[5]=e[7]=n-s;return}let h=0,d=l*4+(i?2:0)+2,f=d,p=u;{const m=i+o,v=s,_=r+m,x=r-m,y=n+v;if(e[h++]=_,e[h++]=y,e[--d]=y,e[--d]=x,s){const g=n-v;e[f++]=x,e[f++]=g,e[--p]=g,e[--p]=_}}for(let m=1;m<l;m++){const v=Math.PI/2*(m/l),_=i+Math.cos(v)*o,x=s+Math.sin(v)*a,y=r+_,g=r-_,w=n+x,S=n-x;e[h++]=y,e[h++]=w,e[--d]=w,e[--d]=g,e[f++]=g,e[f++]=S,e[--p]=S,e[--p]=y}{const m=i,v=s+a,_=r+m,x=r-m,y=n+v,g=n-v;e[h++]=_,e[h++]=y,e[--p]=g,e[--p]=_,i&&(e[h++]=x,e[h++]=y,e[--p]=g,e[--p]=x)}},triangulate(t,e){const r=t.points,n=e.points,i=e.indices;if(r.length===0)return;let s=n.length/2;const o=s;let a,l;if(t.type!==ut.RREC){const h=t.shape;a=h.x,l=h.y}else{const h=t.shape;a=h.x+h.width/2,l=h.y+h.height/2}const u=t.matrix;n.push(t.matrix?u.a*a+u.c*l+u.tx:a,t.matrix?u.b*a+u.d*l+u.ty:l),s++,n.push(r[0],r[1]);for(let h=2;h<r.length;h+=2)n.push(r[h],r[h+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function ty(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let i=0,s=t[r-2],o=t[r-1];i<r;i+=2){const a=t[i],l=t[i+1];n+=(a-s)*(l+o),s=a,o=l}if(!e&&n>0||e&&n<=0){const i=r/2;for(let s=i+i%2;s<r;s+=2){const o=r-s-2,a=r-s-1,l=s,u=s+1;[t[o],t[l]]=[t[l],t[o]],[t[a],t[u]]=[t[u],t[a]]}}}const M1={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const n=t.holes,i=e.points,s=e.indices;if(r.length>=6){ty(r,!1);const o=[];for(let u=0;u<n.length;u++){const h=n[u];ty(h.points,!0),o.push(r.length/2),r=r.concat(h.points)}const a=DT(r,o,2);if(!a)return;const l=i.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+l),s.push(a[u+1]+l),s.push(a[u+2]+l);for(let u=0;u<r.length;u++)i.push(r[u])}}},Lk={build(t){const e=t.shape,r=e.x,n=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(r,n,r+i,n,r+i,n+s,r,n+s)},triangulate(t,e){const r=t.points,n=e.points;if(r.length===0)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Dk={build(t){Ac.build(t)},triangulate(t,e){Ac.triangulate(t,e)}};var Kt=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Kt||{}),Mn=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(Mn||{});const zs={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class ry{static curveTo(e,r,n,i,s,o){const a=o[o.length-2],l=o[o.length-1]-r,u=a-e,h=i-r,d=n-e,f=Math.abs(l*d-u*h);if(f<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==r)&&o.push(e,r),null;const p=l*l+u*u,m=h*h+d*d,v=l*h+u*d,_=s*Math.sqrt(p)/f,x=s*Math.sqrt(m)/f,y=_*v/p,g=x*v/m,w=_*d+x*u,S=_*h+x*l,T=u*(x+y),A=l*(x+y),E=d*(_+g),k=h*(_+g),F=Math.atan2(A-S,T-w),L=Math.atan2(k-S,E-w);return{cx:w+e,cy:S+r,radius:s,startAngle:F,endAngle:L,anticlockwise:u*h>d*l}}static arc(e,r,n,i,s,o,a,l,u){const h=a-o,d=zs._segmentsCount(Math.abs(h)*s,Math.ceil(Math.abs(h)/xc)*40),f=h/(d*2),p=f*2,m=Math.cos(f),v=Math.sin(f),_=d-1,x=_%1/_;for(let y=0;y<=_;++y){const g=y+x*y,w=f+o+p*g,S=Math.cos(w),T=-Math.sin(w);u.push((m*S+v*T)*s+n,(m*-T+v*S)*s+i)}}}class Ok{constructor(){this.reset()}begin(e,r,n){this.reset(),this.style=e,this.start=r,this.attribStart=n}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Hp{static curveLength(e,r,n,i,s,o,a,l){let u=0,h=0,d=0,f=0,p=0,m=0,v=0,_=0,x=0,y=0,g=0,w=e,S=r;for(let T=1;T<=10;++T)h=T/10,d=h*h,f=d*h,p=1-h,m=p*p,v=m*p,_=v*e+3*m*h*n+3*p*d*s+f*a,x=v*r+3*m*h*i+3*p*d*o+f*l,y=w-_,g=S-x,w=_,S=x,u+=Math.sqrt(y*y+g*g);return u}static curveTo(e,r,n,i,s,o,a){const l=a[a.length-2],u=a[a.length-1];a.length-=2;const h=zs._segmentsCount(Hp.curveLength(l,u,e,r,n,i,s,o));let d=0,f=0,p=0,m=0,v=0;a.push(l,u);for(let _=1,x=0;_<=h;++_)x=_/h,d=1-x,f=d*d,p=f*d,m=x*x,v=m*x,a.push(p*l+3*f*x*e+3*d*m*n+v*s,p*u+3*f*x*r+3*d*m*i+v*o)}}function ny(t,e,r,n,i,s,o,a){const l=t-r*i,u=e-n*i,h=t+r*s,d=e+n*s;let f,p;o?(f=n,p=-r):(f=-n,p=r);const m=l+f,v=u+p,_=h+f,x=d+p;return a.push(m,v,_,x),2}function ri(t,e,r,n,i,s,o,a){const l=r-t,u=n-e;let h=Math.atan2(l,u),d=Math.atan2(i-t,s-e);a&&h<d?h+=Math.PI*2:!a&&h>d&&(d+=Math.PI*2);let f=h;const p=d-h,m=Math.abs(p),v=Math.sqrt(l*l+u*u),_=(15*m*Math.sqrt(v)/Math.PI>>0)+1,x=p/_;if(f+=x,a){o.push(t,e,r,n);for(let y=1,g=f;y<_;y++,g+=x)o.push(t,e,t+Math.sin(g)*v,e+Math.cos(g)*v);o.push(t,e,i,s)}else{o.push(r,n,t,e);for(let y=1,g=f;y<_;y++,g+=x)o.push(t+Math.sin(g)*v,e+Math.cos(g)*v,t,e);o.push(i,s,t,e)}return _*2}function Uk(t,e){const r=t.shape;let n=t.points||r.points.slice();const i=e.closePointEps;if(n.length===0)return;const s=t.lineStyle,o=new _e(n[0],n[1]),a=new _e(n[n.length-2],n[n.length-1]),l=r.type!==ut.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){n=n.slice(),u&&(n.pop(),n.pop(),a.set(n[n.length-2],n[n.length-1]));const M=(o.x+a.x)*.5,j=(a.y+o.y)*.5;n.unshift(M,j),n.push(M,j)}const h=e.points,d=n.length/2;let f=n.length;const p=h.length/2,m=s.width/2,v=m*m,_=s.miterLimit*s.miterLimit;let x=n[0],y=n[1],g=n[2],w=n[3],S=0,T=0,A=-(y-w),E=x-g,k=0,F=0,L=Math.sqrt(A*A+E*E);A/=L,E/=L,A*=m,E*=m;const U=s.alignment,P=(1-U)*2,I=U*2;l||(s.cap===Mn.ROUND?f+=ri(x-A*(P-I)*.5,y-E*(P-I)*.5,x-A*P,y-E*P,x+A*I,y+E*I,h,!0)+2:s.cap===Mn.SQUARE&&(f+=ny(x,y,A,E,P,I,!0,h))),h.push(x-A*P,y-E*P,x+A*I,y+E*I);for(let M=1;M<d-1;++M){x=n[(M-1)*2],y=n[(M-1)*2+1],g=n[M*2],w=n[M*2+1],S=n[(M+1)*2],T=n[(M+1)*2+1],A=-(y-w),E=x-g,L=Math.sqrt(A*A+E*E),A/=L,E/=L,A*=m,E*=m,k=-(w-T),F=g-S,L=Math.sqrt(k*k+F*F),k/=L,F/=L,k*=m,F*=m;const j=g-x,N=y-w,R=g-S,C=T-w,B=j*R+N*C,$=N*R-C*j,V=$<0;if(Math.abs($)<.001*Math.abs(B)){h.push(g-A*P,w-E*P,g+A*I,w+E*I),B>=0&&(s.join===Kt.ROUND?f+=ri(g,w,g-A*P,w-E*P,g-k*P,w-F*P,h,!1)+4:f+=2,h.push(g-k*I,w-F*I,g+k*P,w+F*P));continue}const ie=(-A+x)*(-E+w)-(-A+g)*(-E+y),ae=(-k+S)*(-F+w)-(-k+g)*(-F+T),Q=(j*ae-R*ie)/$,me=(C*ie-N*ae)/$,Me=(Q-g)*(Q-g)+(me-w)*(me-w),Pe=g+(Q-g)*P,we=w+(me-w)*P,Se=g-(Q-g)*I,Ee=w-(me-w)*I,Ve=Math.min(j*j+N*N,R*R+C*C),_t=V?P:I,At=Ve+_t*_t*v,Gr=Me<=At;let wr=s.join;if(wr===Kt.MITER&&Me/v>_&&(wr=Kt.BEVEL),Gr)switch(wr){case Kt.MITER:{h.push(Pe,we,Se,Ee);break}case Kt.BEVEL:{V?h.push(Pe,we,g+A*I,w+E*I,Pe,we,g+k*I,w+F*I):h.push(g-A*P,w-E*P,Se,Ee,g-k*P,w-F*P,Se,Ee),f+=2;break}case Kt.ROUND:{V?(h.push(Pe,we,g+A*I,w+E*I),f+=ri(g,w,g+A*I,w+E*I,g+k*I,w+F*I,h,!0)+4,h.push(Pe,we,g+k*I,w+F*I)):(h.push(g-A*P,w-E*P,Se,Ee),f+=ri(g,w,g-A*P,w-E*P,g-k*P,w-F*P,h,!1)+4,h.push(g-k*P,w-F*P,Se,Ee));break}}else{switch(h.push(g-A*P,w-E*P,g+A*I,w+E*I),wr){case Kt.MITER:{V?h.push(Se,Ee,Se,Ee):h.push(Pe,we,Pe,we),f+=2;break}case Kt.ROUND:{V?f+=ri(g,w,g+A*I,w+E*I,g+k*I,w+F*I,h,!0)+2:f+=ri(g,w,g-A*P,w-E*P,g-k*P,w-F*P,h,!1)+2;break}}h.push(g-k*P,w-F*P,g+k*I,w+F*I),f+=2}}x=n[(d-2)*2],y=n[(d-2)*2+1],g=n[(d-1)*2],w=n[(d-1)*2+1],A=-(y-w),E=x-g,L=Math.sqrt(A*A+E*E),A/=L,E/=L,A*=m,E*=m,h.push(g-A*P,w-E*P,g+A*I,w+E*I),l||(s.cap===Mn.ROUND?f+=ri(g-A*(P-I)*.5,w-E*(P-I)*.5,g-A*P,w-E*P,g+A*I,w+E*I,h,!1)+2:s.cap===Mn.SQUARE&&(f+=ny(g,w,A,E,P,I,!1,h)));const D=e.indices,O=zs.epsilon*zs.epsilon;for(let M=p;M<f+p-2;++M)x=h[M*2],y=h[M*2+1],g=h[(M+1)*2],w=h[(M+1)*2+1],S=h[(M+2)*2],T=h[(M+2)*2+1],!(Math.abs(x*(w-T)+g*(T-y)+S*(y-w))<O)&&D.push(M,M+1,M+2)}function zk(t,e){let r=0;const n=t.shape,i=t.points||n.points,s=n.type!==ut.POLY||n.closeStroke;if(i.length===0)return;const o=e.points,a=e.indices,l=i.length/2,u=o.length/2;let h=u;for(o.push(i[0],i[1]),r=1;r<l;r++)o.push(i[r*2],i[r*2+1]),a.push(h,h+1),h++;s&&a.push(h,u)}function iy(t,e){t.lineStyle.native?zk(t,e):Uk(t,e)}class Wp{static curveLength(e,r,n,i,s,o){const a=e-2*n+s,l=r-2*i+o,u=2*n-2*e,h=2*i-2*r,d=4*(a*a+l*l),f=4*(a*u+l*h),p=u*u+h*h,m=2*Math.sqrt(d+f+p),v=Math.sqrt(d),_=2*d*v,x=2*Math.sqrt(p),y=f/v;return(_*m+v*f*(m-x)+(4*p*d-f*f)*Math.log((2*v+y+m)/(y+x)))/(4*_)}static curveTo(e,r,n,i,s){const o=s[s.length-2],a=s[s.length-1],l=zs._segmentsCount(Wp.curveLength(o,a,e,r,n,i));let u=0,h=0;for(let d=1;d<=l;++d){const f=d/l;u=o+(e-o)*f,h=a+(r-a)*f,s.push(u+(e+(n-e)*f-u)*f,h+(r+(i-r)*f-h)*f)}}}const Rh={[ut.POLY]:M1,[ut.CIRC]:Ac,[ut.ELIP]:Ac,[ut.RECT]:Lk,[ut.RREC]:Dk},sy=[],ll=[];class Cc{constructor(e,r=null,n=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=r,this.matrix=i,this.type=e.type}clone(){return new Cc(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Xi=new _e,B1=class j1 extends D_{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Sc,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),ll.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r.reset(),sy.push(r)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,r=null,n=null,i=null){const s=new Cc(e,r,n,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,r=null){if(!this.graphicsData.length)return null;const n=new Cc(e,null,null,r),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const r=this.graphicsData;for(let n=0;n<r.length;++n){const i=r[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,Xi):Xi.copyFrom(e),i.shape.contains(Xi.x,Xi.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Xi.x,Xi.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,r=this.graphicsData;let n=null,i=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],i=n.style);for(let l=this.shapeIndex;l<r.length;l++){this.shapeIndex++;const u=r[l],h=u.fillStyle,d=u.lineStyle;Rh[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(h.visible||d.visible)&&this.processHoles(u.holes);for(let f=0;f<2;f++){const p=f===0?h:d;if(!p.visible)continue;const m=p.texture.baseTexture,v=this.indices.length,_=this.points.length/2;m.wrapMode=Gn.REPEAT,f===0?this.processFill(u):this.processLine(u);const x=this.points.length/2-_;x!==0&&(n&&!this._compareStyles(i,p)&&(n.end(v,_),n=null),n||(n=sy.pop()||new Ok,n.begin(p,v,_),this.batches.push(n),i=p),this.addUvs(this.points,e,p.texture,_,x,p.matrix))}}const s=this.indices.length,o=this.points.length/2;if(n&&n.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,r){return!(!e||!r||e.texture.baseTexture!==r.texture.baseTexture||e.color+e.alpha!==r.color+r.alpha||!!e.native!=!!r.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,r=this.graphicsData.length;e<r;e++){const n=this.graphicsData[e],i=n.fillStyle,s=n.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let r=0,n=e.length;r<n;r++){const i=e[r];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<j1.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++he._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),ll.push(this.drawCalls[d]);this.drawCalls.length=0;const r=this.colors,n=this.textureIds;let i=ll.pop();i||(i=new tf,i.texArray=new of),i.texArray.count=0,i.start=0,i.size=0,i.type=Nr.TRIANGLES;let s=0,o=null,a=0,l=!1,u=Nr.TRIANGLES,h=0;this.drawCalls.push(i);for(let d=0;d<this.batches.length;d++){const f=this.batches[d],p=8,m=f.style,v=m.texture.baseTexture;l!==!!m.native&&(l=!!m.native,u=l?Nr.LINES:Nr.TRIANGLES,o=null,s=p,e++),o!==v&&(o=v,v._batchEnabled!==e&&(s===p&&(e++,s=0,i.size>0&&(i=ll.pop(),i||(i=new tf,i.texArray=new of),this.drawCalls.push(i)),i.start=h,i.size=0,i.texArray.count=0,i.type=u),v.touched=1,v._batchEnabled=e,v._batchLocation=s,v.wrapMode=Gn.REPEAT,i.texArray.elements[i.texArray.count++]=v,s++)),i.size+=f.size,h+=f.size,a=v._batchLocation,this.addColors(r,m.color,m.alpha,f.attribSize,f.attribStart),this.addTextureIds(n,a,f.attribSize,f.attribStart)}he._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,r=this.uvs,n=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let u=0;u<e.length/2;u++)o[l++]=e[u*2],o[l++]=e[u*2+1],o[l++]=r[u*2],o[l++]=r[u*2+1],a[l++]=n[u],o[l++]=i[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?M1.triangulate(e,this):Rh[e.type].triangulate(e,this)}processLine(e){iy(e,this);for(let r=0;r<e.holes.length;r++)iy(e.holes[r],this)}processHoles(e){for(let r=0;r<e.length;r++){const n=e[r];Rh[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,r){for(let n=0;n<e.length/2;n++){const i=e[n*2],s=e[n*2+1];e[n*2]=r.a*i+r.c*s+r.tx,e[n*2+1]=r.b*i+r.d*s+r.ty}}addColors(e,r,n,i,s=0){const o=je.shared.setValue(r).toLittleEndianNumber(),a=je.shared.setValue(o).toPremultiplied(n);e.length=Math.max(e.length,s+i);for(let l=0;l<i;l++)e[s+l]=a}addTextureIds(e,r,n,i=0){e.length=Math.max(e.length,i+n);for(let s=0;s<n;s++)e[i+s]=r}addUvs(e,r,n,i,s,o=null){let a=0;const l=r.length,u=n.frame;for(;a<s;){let d=e[(i+a)*2],f=e[(i+a)*2+1];if(o){const p=o.a*d+o.c*f+o.tx;f=o.b*d+o.d*f+o.ty,d=p}a++,r.push(d/u.width,f/u.height)}const h=n.baseTexture;(u.width<h.width||u.height<h.height)&&this.adjustUvs(r,n,l,s)}adjustUvs(e,r,n,i){const s=r.baseTexture,o=1e-6,a=n+i*2,l=r.frame,u=l.width/s.width,h=l.height/s.height;let d=l.x/l.width,f=l.y/l.height,p=Math.floor(e[n]+o),m=Math.floor(e[n+1]+o);for(let v=n+2;v<a;v+=2)p=Math.min(p,Math.floor(e[v]+o)),m=Math.min(m,Math.floor(e[v+1]+o));d-=p,f-=m;for(let v=n;v<a;v+=2)e[v]=(e[v]+d)*u,e[v+1]=(e[v+1]+f)*h}};B1.BATCHABLE_SIZE=100;let Gk=B1;class ou{constructor(){this.color=16777215,this.alpha=1,this.texture=Z.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new ou;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Z.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class $p extends ou{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Mn.BUTT,this.join=Kt.MITER,this.miterLimit=10}clone(){const e=new $p;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Mn.BUTT,this.join=Kt.MITER,this.miterLimit=10}}const Ph={},Tf=class Nl extends Lt{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new ou,this._lineStyle=new $p,this._matrix=null,this._holeMode=!1,this.state=zr.for2d(),this._geometry=e||new Gk,this._geometry.refCount++,this._transformID=-1,this._tintColor=new je(16777215),this.blendMode=le.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Nl(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,r=0,n,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:r,alpha:n,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const r={width:0,texture:Z.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Mn.BUTT,join:Kt.MITER,miterLimit:10};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new vi,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new vi,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this}lineTo(e,r){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,i=n[n.length-2],s=n[n.length-1];return(i!==e||s!==r)&&n.push(e,r),this}_initCurve(e=0,r=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)}quadraticCurveTo(e,r,n,i){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),Wp.curveTo(e,r,n,i,s),this}bezierCurveTo(e,r,n,i,s,o){return this._initCurve(),Hp.curveTo(e,r,n,i,s,o,this.currentPath.points),this}arcTo(e,r,n,i,s){this._initCurve(e,r);const o=this.currentPath.points,a=ry.curveTo(e,r,n,i,s,o);if(a){const{cx:l,cy:u,radius:h,startAngle:d,endAngle:f,anticlockwise:p}=a;this.arc(l,u,h,d,f,p)}return this}arc(e,r,n,i,s,o=!1){if(i===s)return this;if(!o&&s<=i?s+=xc:o&&i<=s&&(i+=xc),s-i===0)return this;const a=e+Math.cos(i)*n,l=r+Math.sin(i)*n,u=this._geometry.closePointEps;let h=this.currentPath?this.currentPath.points:null;if(h){const d=Math.abs(h[h.length-2]-a),f=Math.abs(h[h.length-1]-l);d<u&&f<u||h.push(a,l)}else this.moveTo(a,l),h=this.currentPath.points;return ry.arc(a,l,e,r,n,i,s,o,h),this}beginFill(e=0,r){return this.beginTextureFill({texture:Z.WHITE,color:e,alpha:r})}normalizeColor(e){const r=je.shared.setValue(e.color??0);e.color=r.toNumber(),e.alpha??(e.alpha=r.alpha)}beginTextureFill(e){const r={texture:Z.WHITE,color:16777215,matrix:null};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,r,n,i){return this.drawShape(new fe(e,r,n,i))}drawRoundedRect(e,r,n,i,s){return this.drawShape(new nu(e,r,n,i,s))}drawCircle(e,r,n){return this.drawShape(new tu(e,r,n))}drawEllipse(e,r,n,i){return this.drawShape(new ru(e,r,n,i))}drawPolygon(...e){let r,n=!0;const i=e[0];i.points?(n=i.closeStroke,r=i.points):Array.isArray(e[0])?r=e[0]:r=e;const s=new vi(r);return s.closeStroke=n,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===ut.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,r=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let i=0;i<n;i++){const s=e.batches[i],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),h={vertexData:a,blendMode:r,indices:u,uvs:l,_batchRGB:je.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=h}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let r=0,n=this.batches.length;r<n;r++){const i=this.batches[r];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const r=this._resolveDirectShader(e),n=this._geometry,i=this.worldAlpha,s=r.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,je.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(r),e.geometry.bind(n,r),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,n.drawCalls[a])}_renderDrawCallDirect(e,r){const{texArray:n,type:i,size:s,start:o}=r,a=n.count;for(let l=0;l<a;l++)e.texture.bind(n.elements[l],l);e.geometry.draw(i,s,o)}_resolveDirectShader(e){let r=this.shader;const n=this.pluginName;if(!r){if(!Ph[n]){const{maxTextures:i}=e.plugins[n],s=new Int32Array(i);for(let l=0;l<i;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Fe,default:yr.from({uSamplers:s},!0)},a=e.plugins[n]._shader.program;Ph[n]=new Or(a,o)}r=Ph[n]}return r}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:r,minY:n,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,r,n,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,Nl._TEMP_POINT),this._geometry.containsPoint(Nl._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r._tintRGB=je.shared.setValue(this._tintColor).multiply(r._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,u=this._geometry.points,h=this.vertexData;let d=0;for(let f=0;f<u.length;f+=2){const p=u[f],m=u[f+1];h[d++]=n*p+s*m+a,h[d++]=o*m+i*p+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};Tf.curves=zs,Tf._TEMP_POINT=new _e;let Gt=Tf;class Hk{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const Ih=new _e,oy=new vi,N1=class F1 extends Lt{constructor(e,r,n,i=Nr.TRIANGLES){super(),this.geometry=e,this.shader=r,this.state=n||zr.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=K.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Nr.TRIANGLES&&r.length<F1.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const r=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const e=this.geometry.buffers[0],r=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,u=i.tx,h=i.ty,d=this.vertexData;for(let f=0;f<d.length/2;f++){const p=r[f*2],m=r[f*2+1];d[f*2]=s*p+a*m+u,d[f*2+1]=o*p+l*m+h}if(this._roundPixels){const f=K.RESOLUTION;for(let p=0;p<d.length;++p)d[p]=Math.round(d[p]*f)/f}this.vertexDirty=n}calculateUvs(){const e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Hk(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Ih);const r=this.geometry.getBuffer("aVertexPosition").data,n=oy.points,i=this.geometry.getIndex().data,s=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=i[a]*2,u=i[a+1]*2,h=i[a+2]*2;if(n[0]=r[l],n[1]=r[l+1],n[2]=r[u],n[3]=r[u+1],n[4]=r[h],n[5]=r[h+1],oy.contains(Ih.x,Ih.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};N1.BATCHABLE_SIZE=100;let ay=N1;class Wk extends Vn{constructor(e,r,n){super();const i=new Ye(e),s=new Ye(r,!0),o=new Ye(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,ne.FLOAT).addAttribute("aTextureCoord",s,2,!1,ne.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var $k=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,Vk=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class ly extends Or{constructor(e,r){const n={uSampler:e,alpha:1,uTextureMatrix:Fe.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||en.from(Vk,$k),n),this._colorDirty=!1,this.uvMatrix=new Z_(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new je(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;je.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class cy{constructor(e,r,n){this.geometry=new Vn,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||ne.FLOAT,offset:s.offset},r[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let r=0;this.indexBuffer=new Ye(fR(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Ye(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Ye(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===ne.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===ne.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,r,n){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,r,n,s.type===ne.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,n){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,r,n,s.type===ne.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var Xk=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,Yk=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class L1 extends iu{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Fe,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:ne.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Or.from(Yk,Xk,{}),this.state=zr.for2d()}render(e){const r=e.children,n=e._maxSize,i=e._batchSize,s=this.renderer;let o=r.length;if(o===0)return;o>n&&!e.autoResize&&(o=n);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=r[0]._texture.baseTexture,u=l.alphaMode>0;this.state.blendMode=N_(e.blendMode,u),s.state.set(this.state);const h=s.gl,d=e.worldTransform.copyTo(this.tempMatrix);d.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=je.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let f=!1;for(let p=0,m=0;p<o;p+=i,m+=1){let v=o-p;v>i&&(v=i),m>=a.length&&a.push(this._generateOneMoreBuffer(e));const _=a[m];_.uploadDynamic(r,p,v);const x=e._bufferUpdateIDs[m]||0;f=f||_._updateID<x,f&&(_._updateID=e._updateID,_.uploadStatic(r,p,v)),s.geometry.bind(_.geometry),h.drawElements(h.TRIANGLES,v*6,h.UNSIGNED_SHORT,0)}}generateBuffers(e){const r=[],n=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<n;o+=i)r.push(new cy(this.properties,s,i));return r}_generateOneMoreBuffer(e){const r=e._batchSize,n=e._properties;return new cy(this.properties,n,r)}uploadVertices(e,r,n,i,s,o){let a=0,l=0,u=0,h=0;for(let d=0;d<n;++d){const f=e[r+d],p=f._texture,m=f.scale.x,v=f.scale.y,_=p.trim,x=p.orig;_?(l=_.x-f.anchor.x*x.width,a=l+_.width,h=_.y-f.anchor.y*x.height,u=h+_.height):(a=x.width*(1-f.anchor.x),l=x.width*-f.anchor.x,u=x.height*(1-f.anchor.y),h=x.height*-f.anchor.y),i[o]=l*m,i[o+1]=h*v,i[o+s]=a*m,i[o+s+1]=h*v,i[o+s*2]=a*m,i[o+s*2+1]=u*v,i[o+s*3]=l*m,i[o+s*3+1]=u*v,o+=s*4}}uploadPosition(e,r,n,i,s,o){for(let a=0;a<n;a++){const l=e[r+a].position;i[o]=l.x,i[o+1]=l.y,i[o+s]=l.x,i[o+s+1]=l.y,i[o+s*2]=l.x,i[o+s*2+1]=l.y,i[o+s*3]=l.x,i[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,r,n,i,s,o){for(let a=0;a<n;a++){const l=e[r+a].rotation;i[o]=l,i[o+s]=l,i[o+s*2]=l,i[o+s*3]=l,o+=s*4}}uploadUvs(e,r,n,i,s,o){for(let a=0;a<n;++a){const l=e[r+a]._texture._uvs;l?(i[o]=l.x0,i[o+1]=l.y0,i[o+s]=l.x1,i[o+s+1]=l.y1,i[o+s*2]=l.x2,i[o+s*2+1]=l.y2,i[o+s*3]=l.x3,i[o+s*3+1]=l.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}}uploadTint(e,r,n,i,s,o){for(let a=0;a<n;++a){const l=e[r+a],u=je.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);i[o]=u,i[o+s]=u,i[o+s*2]=u,i[o+s*3]=u,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}L1.extension={name:"particle",type:X.RendererPlugin};J.add(L1);var au=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(au||{});const cl={willReadFrequently:!0},Rr=class te{static get experimentalLetterSpacingSupported(){let e=te._experimentalLetterSpacingSupported;if(e!==void 0){const r=K.ADAPTER.getCanvasRenderingContext2D().prototype;e=te._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,i,s,o,a,l,u){this.text=e,this.style=r,this.width=n,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e,r,n,i=te._canvas){n=n??r.wordWrap;const s=r.toFontString(),o=te.measureFont(s);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const a=i.getContext("2d",cl);a.font=s;const l=(n?te.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let h=0;for(let m=0;m<l.length;m++){const v=te._measureText(l[m],r.letterSpacing,a);u[m]=v,h=Math.max(h,v)}let d=h+r.strokeThickness;r.dropShadow&&(d+=r.dropShadowDistance);const f=r.lineHeight||o.fontSize+r.strokeThickness;let p=Math.max(f,o.fontSize+r.strokeThickness*2)+r.leading+(l.length-1)*(f+r.leading);return r.dropShadow&&(p+=r.dropShadowDistance),new te(e,r,d,p,l,u,f+r.leading,h,o)}static _measureText(e,r,n){let i=!1;te.experimentalLetterSpacingSupported&&(te.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let s=n.measureText(e).width;return s>0&&(i?s-=r:s+=(te.graphemeSegmenter(e).length-1)*r),s}static wordWrap(e,r,n=te._canvas){const i=n.getContext("2d",cl);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:h}=r,d=te.collapseSpaces(h),f=te.collapseNewlines(h);let p=!d;const m=r.wordWrapWidth+u,v=te.tokenize(e);for(let _=0;_<v.length;_++){let x=v[_];if(te.isNewline(x)){if(!f){a+=te.addLine(o),p=!d,o="",s=0;continue}x=" "}if(d){const g=te.isBreakingSpace(x),w=te.isBreakingSpace(o[o.length-1]);if(g&&w)continue}const y=te.getFromCache(x,u,l,i);if(y>m)if(o!==""&&(a+=te.addLine(o),o="",s=0),te.canBreakWords(x,r.breakWords)){const g=te.wordWrapSplit(x);for(let w=0;w<g.length;w++){let S=g[w],T=S,A=1;for(;g[w+A];){const k=g[w+A];if(!te.canBreakChars(T,k,x,w,r.breakWords))S+=k;else break;T=k,A++}w+=A-1;const E=te.getFromCache(S,u,l,i);E+s>m&&(a+=te.addLine(o),p=!1,o="",s=0),o+=S,s+=E}}else{o.length>0&&(a+=te.addLine(o),o="",s=0);const g=_===v.length-1;a+=te.addLine(x,!g),p=!1,o="",s=0}else y+s>m&&(p=!1,a+=te.addLine(o),o="",s=0),(o.length>0||!te.isBreakingSpace(x)||p)&&(o+=x,s+=y)}return a+=te.addLine(o,!1),a}static addLine(e,r=!0){return e=te.trimRight(e),e=r?`${e}
`:e,e}static getFromCache(e,r,n,i){let s=n[e];return typeof s!="number"&&(s=te._measureText(e,r,i)+r,n[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!te.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:te._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:te._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(te.isBreakingSpace(s,o)||te.isNewline(s)){n!==""&&(r.push(n),n=""),r.push(s);continue}n+=s}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,i,s){return!0}static wordWrapSplit(e){return te.graphemeSegmenter(e)}static measureFont(e){if(te._fonts[e])return te._fonts[e];const r={ascent:0,descent:0,fontSize:0},n=te._canvas,i=te._context;i.font=e;const s=te.METRICS_STRING+te.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(te.BASELINE_SYMBOL).width);const l=Math.ceil(te.HEIGHT_MULTIPLIER*a);if(a=a*te.BASELINE_MULTIPLIER|0,o===0||l===0)return te._fonts[e]=r,r;n.width=o,n.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const u=i.getImageData(0,0,o,l).data,h=u.length,d=o*4;let f=0,p=0,m=!1;for(f=0;f<a;++f){for(let v=0;v<d;v+=4)if(u[p+v]!==255){m=!0;break}if(!m)p+=d;else break}for(r.ascent=a-f,p=h-d,m=!1,f=l;f>a;--f){for(let v=0;v<d;v+=4)if(u[p+v]!==255){m=!0;break}if(!m)p-=d;else break}return r.descent=f-a,r.fontSize=r.ascent+r.descent,te._fonts[e]=r,r}static clearMetrics(e=""){e?delete te._fonts[e]:te._fonts={}}static get _canvas(){var e;if(!te.__canvas){let r;try{const n=new OffscreenCanvas(0,0);if((e=n.getContext("2d",cl))!=null&&e.measureText)return te.__canvas=n,n;r=K.ADAPTER.createCanvas()}catch{r=K.ADAPTER.createCanvas()}r.width=r.height=10,te.__canvas=r}return te.__canvas}static get _context(){return te.__context||(te.__context=te._canvas.getContext("2d",cl)),te.__context}};Rr.METRICS_STRING="|q",Rr.BASELINE_SYMBOL="M",Rr.BASELINE_MULTIPLIER=1.4,Rr.HEIGHT_MULTIPLIER=2,Rr.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})(),Rr.experimentalLetterSpacing=!1,Rr._fonts={},Rr._newlines=[10,13],Rr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let bn=Rr;const Kk=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],D1=class _o{constructor(e){this.styleID=0,this.reset(),Mh(this,e,e)}clone(){const e={};return Mh(e,this,_o.defaultStyle),new _o(e)}reset(){Mh(this,_o.defaultStyle,_o.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const r=kh(e);this._dropShadowColor!==r&&(this._dropShadowColor=r,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const r=kh(e);this._fill!==r&&(this._fill=r,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){qk(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const r=kh(e);this._stroke!==r&&(this._stroke=r,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let r=this.fontFamily;Array.isArray(this.fontFamily)||(r=this.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let i=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!Kk.includes(i)&&(i=`"${i}"`),r[n]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${r.join(",")}`}};D1.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:au.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ir=D1;function kh(t){const e=je.shared,r=n=>{const i=e.setValue(n);return i.alpha===1?i.toHex():i.toRgbaString()};return Array.isArray(t)?t.map(r):r(t)}function qk(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function Mh(t,e,r){for(const n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}const Qk={texture:!0,children:!1,baseTexture:!0},O1=class Af extends Xn{constructor(e,r,n){let i=!1;n||(n=K.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const s=Z.from(n);s.orig=new fe,s.trim=new fe,super(s),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=Af.defaultResolution??K.RESOLUTION,this._autoResolution=Af.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return bn.experimentalLetterSpacing}static set experimentalLetterSpacing(e){xe("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),bn.experimentalLetterSpacing=e}updateText(e){const r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const n=this.context,i=bn.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,a=i.lines,l=i.lineHeight,u=i.lineWidths,h=i.maxLineWidth,d=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;let f,p;const m=r.dropShadow?2:1;for(let v=0;v<m;++v){const _=r.dropShadow&&v===0,x=_?Math.ceil(Math.max(1,o)+r.padding*2):0,y=x*this._resolution;if(_){n.fillStyle="black",n.strokeStyle="black";const w=r.dropShadowColor,S=r.dropShadowBlur*this._resolution,T=r.dropShadowDistance*this._resolution;n.shadowColor=je.shared.setValue(w).setAlpha(r.dropShadowAlpha).toRgbaString(),n.shadowBlur=S,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*T,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*T+y}else n.fillStyle=this._generateFillStyle(r,a,i),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let g=(l-d.fontSize)/2;l-d.fontSize<0&&(g=0);for(let w=0;w<a.length;w++)f=r.strokeThickness/2,p=r.strokeThickness/2+w*l+d.ascent+g,r.align==="right"?f+=h-u[w]:r.align==="center"&&(f+=(h-u[w])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(a[w],f+r.padding,p+r.padding-x,!0),r.fill&&this.drawLetterSpacing(a[w],f+r.padding,p+r.padding-x)}this.updateTexture()}drawLetterSpacing(e,r,n,i=!1){const s=this._style.letterSpacing;let o=!1;if(bn.experimentalLetterSpacingSupported&&(bn.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(e,r,n):this.context.fillText(e,r,n);return}let a=r;const l=bn.graphemeSegmenter(e);let u=this.context.measureText(e).width,h=0;for(let d=0;d<l.length;++d){const f=l[d];i?this.context.strokeText(f,a,n):this.context.fillText(f,a,n);let p="";for(let m=d+1;m<l.length;++m)p+=l[m];h=this.context.measureText(p).width,a+=u-h+s,u=h}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=xR(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const r=this._texture,n=this._style,i=n.trim?0:n.padding,s=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-i*2,r.orig.height=r._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,r){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,r)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,r,n){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,u=this.canvas.height/this._resolution-o-a*2,h=i.slice(),d=e.fillGradientStops.slice();if(!d.length){const f=h.length+1;for(let p=1;p<f;++p)d.push(p/f)}if(h.unshift(i[0]),d.unshift(0),h.push(i[i.length-1]),d.push(1),e.fillGradientType===au.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,u+a);const f=n.fontProperties.fontSize+e.strokeThickness;for(let p=0;p<r.length;p++){const m=n.lineHeight*(p-1)+f,v=n.lineHeight*p;let _=v;p>0&&m>v&&(_=(v+m)/2);const x=v+f,y=n.lineHeight*(p+1);let g=x;p+1<r.length&&y<x&&(g=(x+y)/2);const w=(g-_)/u;for(let S=0;S<h.length;S++){let T=0;typeof d[S]=="number"?T=d[S]:T=S/h.length;let A=Math.min(1,Math.max(0,_/u+T*w));A=Number(A.toFixed(5)),s.addColorStop(A,h[S])}}}else{s=this.context.createLinearGradient(a,u/2,l+a,u/2);const f=h.length+1;let p=1;for(let m=0;m<h.length;m++){let v;typeof d[m]=="number"?v=d[m]:v=p/f,s.addColorStop(v,h[m]),p++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Qk,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const r=kn(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const r=kn(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof ir?this._style=e:this._style=new ir(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};O1.defaultAutoResolution=!0;let Pi=O1;class Zk{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Jk(t,e){var n;let r=!1;if((n=t==null?void 0:t._textures)!=null&&n.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof Z){const s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),r=!0)}}return r}function eM(t,e){if(t.baseTexture instanceof he){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function tM(t,e){if(t._texture&&t._texture instanceof Z){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function rM(t,e){return e instanceof Pi?(e.updateText(!0),!0):!1}function nM(t,e){if(e instanceof ir){const r=e.toFontString();return bn.measureFont(r),!0}return!1}function iM(t,e){if(t instanceof Pi){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function sM(t,e){return t instanceof ir?(e.includes(t)||e.push(t),!0):!1}const U1=class z1{constructor(e){this.limiter=new Zk(z1.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(iM),this.registerFindHook(sM),this.registerFindHook(Jk),this.registerFindHook(eM),this.registerFindHook(tM),this.registerUploadHook(rM),this.registerUploadHook(nM)}upload(e){return new Promise(r=>{e&&this.add(e),this.queue.length?(this.completes.push(r),this.ticking||(this.ticking=!0,zt.system.addOnce(this.tick,this,Ri.UTILITY))):r()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let r=!1;if(e&&!e._destroyed){for(let n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),r=!0;break}}r||this.queue.shift()}if(this.queue.length)zt.system.addOnce(this.tick,this,Ri.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let r=0,n=e.length;r<n;r++)e[r]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let r=0,n=this.addHooks.length;r<n&&!this.addHooks[r](e,this.queue);r++);if(e instanceof Lt)for(let r=e.children.length-1;r>=0;r--)this.add(e.children[r]);return this}destroy(){this.ticking&&zt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};U1.uploadsPerFrame=4;let Cf=U1;Object.defineProperties(K,{UPLOADS_PER_FRAME:{get(){return Cf.uploadsPerFrame},set(t){xe("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Cf.uploadsPerFrame=t}}});function G1(t,e){return e instanceof he?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function oM(t,e){if(!(e instanceof Gt))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:n}=r;for(let i=0;i<n.length;i++){const{texture:s}=n[i].style;s&&G1(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function aM(t,e){return t instanceof Gt?(e.push(t),!0):!1}class H1 extends Cf{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(aM),this.registerUploadHook(G1),this.registerUploadHook(oM)}}H1.extension={name:"prepare",type:X.RendererSystem};J.add(H1);var lM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,cM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,uM=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,uy=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,hM=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const ul=new Fe;class W1 extends iu{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new Y_,this.state=zr.for2d()}contextChange(){const e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=Or.from(uy,hM,r),this.shader=e.context.webGLVersion>1?Or.from(cM,lM,r):Or.from(uy,uM,r)}render(e){const r=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=n.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,n.invalidate();const a=e._texture,l=a.baseTexture,u=l.alphaMode>0,h=e.tileTransform.localTransform,d=e.uvMatrix;let f=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;f&&(l._glTextures[r.CONTEXT_UID]?f=l.wrapMode!==Gn.CLAMP:l.wrapMode===Gn.CLAMP&&(l.wrapMode=Gn.REPEAT));const p=f?this.simpleShader:this.shader,m=a.width,v=a.height,_=e._width,x=e._height;ul.set(h.a*m/_,h.b*m/x,h.c*v/_,h.d*v/x,h.tx/_,h.ty/x),ul.invert(),f?ul.prepend(d.mapCoord):(p.uniforms.uMapCoord=d.mapCoord.toArray(!0),p.uniforms.uClampFrame=d.uClampFrame,p.uniforms.uClampOffset=d.uClampOffset),p.uniforms.uTransform=ul.toArray(!0),p.uniforms.uColor=je.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(p.uniforms.uColor),p.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),p.uniforms.uSampler=a,r.shader.bind(p),r.geometry.bind(n),this.state.blendMode=N_(e.blendMode,u),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}W1.extension={name:"tilingSprite",type:X.RendererPlugin};J.add(W1);const $1=class wo{constructor(e,r,n){this.linkedSheets=[],(e instanceof he||e instanceof Z)&&(e={texture:e,data:r,resolutionFilename:n});const{texture:i,data:s,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=i instanceof Z?i:null,this.baseTexture=i instanceof he?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const l=this.baseTexture.resource;this.resolution=this._updateResolution(o||(l?l.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:r}=this.data.meta;let n=ln(e,null);return n===null&&(n=typeof r=="number"?r:parseFloat(r??"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=wo.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=wo.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const i=this._frameKeys[r],s=this._frames[i],o=s.frame;if(o){let a=null,l=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,h=new fe(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new fe(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new fe(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new fe(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new Z(this.baseTexture,a,h,l,s.rotated?2:0,s.anchor,s.borders),Z.addToCache(this.textures[i],this.cachePrefix+i.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const i=e[r][n];this.animations[r].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*wo.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*wo.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var r;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((r=this._texture)==null||r.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};$1.BATCH_SIZE=1e3;let hy=$1;const dM=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function V1(t,e,r){const n={};if(t.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[`${e.cachePrefix}${i}`]=e.textures[i]}),!r){const i=at.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(n,V1([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return n}const fM={extension:X.Asset,cache:{test:t=>t instanceof hy,getCacheableAssets:(t,e)=>V1(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&dM.includes(n)},parse:t=>{var r;const e=t.split(".");return{resolution:parseFloat(((r=K.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:X.LoadParser,priority:_r.Normal},async testParse(t,e){return at.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){var h,d;const{texture:n,imageFilename:i,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=at.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(n&&n.baseTexture)a=n;else{const f=Sf(o+(i??t.meta.image),e.src);a=(await r.load([f]))[f]}const l=new hy({texture:a.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await l.parse();const u=(h=t==null?void 0:t.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(u)){const f=[];for(const m of u){if(typeof m!="string")continue;let v=o+m;(d=e.data)!=null&&d.ignoreMultiPack||(v=Sf(v,e.src),f.push(r.load({src:v,data:{ignoreMultiPack:!0}})))}const p=await Promise.all(f);l.linkedSheets=p,p.forEach(m=>{m.linkedSheets=[l].concat(l.linkedSheets.filter(v=>v!==m))})}return l},unload(t){t.destroy(!0)}}};J.add(fM);class Rc{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Fl{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const r=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in r){const o=r[s].match(/^[a-z]+/gm)[0],a=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const u in a){const h=a[u].split("="),d=h[0],f=h[1].replace(/"/gm,""),p=parseFloat(f),m=isNaN(p)?f:p;l[d]=m}n[o].push(l)}const i=new Rc;return n.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),n.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),n.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),n.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),n.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),n.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class Rf{static test(e){const r=e;return typeof e!="string"&&"getElementsByTagName"in e&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const r=new Rc,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let u=0;u<n.length;u++)r.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(let u=0;u<i.length;u++)r.common.push({lineHeight:parseInt(i[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)r.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const h=o[u];r.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)r.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<l.length;u++)r.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return r}}class Pf{static test(e){return typeof e=="string"&&e.includes("<font>")?Rf.test(K.ADAPTER.parseXML(e)):!1}static parse(e){return Rf.parse(K.ADAPTER.parseXML(e))}}const Bh=[Fl,Rf,Pf];function pM(t){for(let e=0;e<Bh.length;e++)if(Bh[e].test(t))return Bh[e];return null}function mM(t,e,r,n,i,s){const o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,h=t.width/n-l-u*2,d=t.height/n-l-u*2,f=o.slice(),p=r.fillGradientStops.slice();if(!p.length){const m=f.length+1;for(let v=1;v<m;++v)p.push(v/m)}if(f.unshift(o[0]),p.unshift(0),f.push(o[o.length-1]),p.push(1),r.fillGradientType===au.LINEAR_VERTICAL){a=e.createLinearGradient(h/2,u,h/2,d+u);let m=0;const v=(s.fontProperties.fontSize+r.strokeThickness)/d;for(let _=0;_<i.length;_++){const x=s.lineHeight*_;for(let y=0;y<f.length;y++){let g=0;typeof p[y]=="number"?g=p[y]:g=y/f.length;const w=x/d+g*v;let S=Math.max(m,w);S=Math.min(S,1),a.addColorStop(S,f[y]),m=S}}}else{a=e.createLinearGradient(u,d/2,h+u,d/2);const m=f.length+1;let v=1;for(let _=0;_<f.length;_++){let x;typeof p[_]=="number"?x=p[_]:x=v/m,a.addColorStop(x,f[_]),v++}}return a}function gM(t,e,r,n,i,s,o){const a=r.text,l=r.fontProperties;e.translate(n,i),e.scale(s,s);const u=o.strokeThickness/2,h=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=mM(t,e,o,s,[a],r),e.strokeStyle=o.stroke,o.dropShadow){const d=o.dropShadowColor,f=o.dropShadowBlur*s,p=o.dropShadowDistance*s;e.shadowColor=je.shared.setValue(d).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=f,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,h+r.lineHeight-l.descent),o.fill&&e.fillText(a,u,h+r.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Ll(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function X1(t){return Array.from?Array.from(t):t.split("")}function xM(t){typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...X1(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const vn=class Pr{constructor(e,r,n){var h;const[i]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=ln(o.file),u={};this._ownsTextures=n,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=u;for(let d=0;d<e.page.length;d++){const{id:f,file:p}=e.page[d];u[f]=r instanceof Array?r[d]:r[p],a!=null&&a.fieldType&&a.fieldType!=="none"&&(u[f].baseTexture.alphaMode=Mt.NO_PREMULTIPLIED_ALPHA,u[f].baseTexture.mipmap=Ur.OFF)}for(let d=0;d<e.char.length;d++){const{id:f,page:p}=e.char[d];let{x:m,y:v,width:_,height:x,xoffset:y,yoffset:g,xadvance:w}=e.char[d];m/=l,v/=l,_/=l,x/=l,y/=l,g/=l,w/=l;const S=new fe(m+u[p].frame.x/l,v+u[p].frame.y/l,_,x);this.chars[f]={xOffset:y,yOffset:g,xAdvance:w,kerning:{},texture:new Z(u[p].baseTexture,S),page:p}}for(let d=0;d<e.kerning.length;d++){let{first:f,second:p,amount:m}=e.kerning[d];f/=l,p/=l,m/=l,this.chars[p]&&(this.chars[p].kerning[f]=m)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((h=a==null?void 0:a.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,r,n){let i;if(e instanceof Rc)i=e;else{const o=pM(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof Z&&(r=[r]);const s=new Pr(i,r,n);return Pr.available[s.font]=s,s}static uninstall(e){const r=Pr.available[e];if(!r)throw new Error(`No font found named '${e}'`);r.destroy(),delete Pr.available[e]}static from(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:l,...u}=Object.assign({},Pr.defaultOptions,n),h=xM(i),d=r instanceof ir?r:new ir(r),f=a,p=new Rc;p.info[0]={face:d.fontFamily,size:d.fontSize},p.common[0]={lineHeight:d.fontSize};let m=0,v=0,_,x,y,g=0;const w=[];for(let T=0;T<h.length;T++){_||(_=K.ADAPTER.createCanvas(),_.width=a,_.height=l,x=_.getContext("2d"),y=new he(_,{resolution:o,...u}),w.push(new Z(y)),p.page.push({id:w.length-1,file:""}));const A=h[T],E=bn.measureText(A,d,!1,_),k=E.width,F=Math.ceil(E.height),L=Math.ceil((d.fontStyle==="italic"?2:1)*k);if(v>=l-F*o){if(v===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${A}')`);--T,_=null,x=null,y=null,v=0,m=0,g=0;continue}if(g=Math.max(F+E.fontProperties.descent,g),L*o+m>=f){if(m===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${A}')`);--T,v+=g*o,v=Math.ceil(v),m=0,g=0;continue}gM(_,x,E,m,v,o,d);const U=Ll(E.text);p.char.push({id:U,page:w.length-1,x:m/o,y:v/o,width:L,height:F,xoffset:0,yoffset:0,xadvance:k-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),m+=(L+2*s)*o,m=Math.ceil(m)}if(!(n!=null&&n.skipKerning))for(let T=0,A=h.length;T<A;T++){const E=h[T];for(let k=0;k<A;k++){const F=h[k],L=x.measureText(E).width,U=x.measureText(F).width,P=x.measureText(E+F).width-(L+U);P&&p.kerning.push({first:Ll(E),second:Ll(F),amount:P})}}const S=new Pr(p,w,!0);return Pr.available[e]!==void 0&&Pr.uninstall(e),Pr.available[e]=S,S}};vn.ALPHA=[["a","z"],["A","Z"]," "],vn.NUMERIC=[["0","9"]],vn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],vn.ASCII=[[" ","~"]],vn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:vn.ALPHANUMERIC},vn.available={};let _n=vn;var yM=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,vM=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const dy=[],fy=[],py=[],_M=class Y1 extends Lt{constructor(e,r={}){super();const{align:n,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},Y1.styleDefaults,r);if(!_n.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new je(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Jr(()=>{this.dirty=!0},this,0,0),this._roundPixels=K.ROUND_PIXELS,this.dirty=!0,this._resolution=K.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var L;const e=_n.available[this._fontName],r=this.fontSize,n=r/e.size,i=new _e,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=X1(l),h=this._maxWidth*e.size/r,d=e.distanceFieldType==="none"?dy:fy;let f=null,p=0,m=0,v=0,_=-1,x=0,y=0,g=0,w=0;for(let U=0;U<u.length;U++){const P=u[U],I=Ll(P);if(/(?:\s)/.test(P)&&(_=U,x=p,w++),P==="\r"||P===`
`){o.push(p),a.push(-1),m=Math.max(m,p),++v,++y,i.x=0,i.y+=e.lineHeight,f=null,w=0;continue}const D=e.chars[I];if(!D)continue;f&&D.kerning[f]&&(i.x+=D.kerning[f]);const O=py.pop()||{texture:Z.EMPTY,line:0,charCode:0,prevSpaces:0,position:new _e};O.texture=D.texture,O.line=v,O.charCode=I,O.position.x=Math.round(i.x+D.xOffset+this._letterSpacing/2),O.position.y=Math.round(i.y+D.yOffset),O.prevSpaces=w,s.push(O),p=O.position.x+Math.max(D.xAdvance-D.xOffset,D.texture.orig.width),i.x+=D.xAdvance+this._letterSpacing,g=Math.max(g,D.yOffset+D.texture.height),f=I,_!==-1&&h>0&&i.x>h&&(++y,Cs(s,1+_-y,1+U-_),U=_,_=-1,o.push(x),a.push(s.length>0?s[s.length-1].prevSpaces:0),m=Math.max(m,x),v++,i.x=0,i.y+=e.lineHeight,f=null,w=0)}const S=u[u.length-1];S!=="\r"&&S!==`
`&&(/(?:\s)/.test(S)&&(p=x),o.push(p),m=Math.max(m,p),a.push(-1));const T=[];for(let U=0;U<=v;U++){let P=0;this._align==="right"?P=m-o[U]:this._align==="center"?P=(m-o[U])/2:this._align==="justify"&&(P=a[U]<0?0:(m-o[U])/a[U]),T.push(P)}const A=s.length,E={},k=[],F=this._activePagesMeshData;d.push(...F);for(let U=0;U<A;U++){const P=s[U].texture,I=P.baseTexture.uid;if(!E[I]){let D=d.pop();if(!D){const M=new Wk;let j,N;e.distanceFieldType==="none"?(j=new ly(Z.EMPTY),N=le.NORMAL):(j=new ly(Z.EMPTY,{program:en.from(vM,yM),uniforms:{uFWidth:0}}),N=le.NORMAL_NPM);const R=new ay(M,j);R.blendMode=N,D={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:R,vertices:null,uvs:null,indices:null}}D.index=0,D.indexCount=0,D.vertexCount=0,D.uvsCount=0,D.total=0;const{_textureCache:O}=this;O[I]=O[I]||new Z(P.baseTexture),D.mesh.texture=O[I],D.mesh.tint=this._tintColor.value,k.push(D),E[I]=D}E[I].total++}for(let U=0;U<F.length;U++)k.includes(F[U])||this.removeChild(F[U].mesh);for(let U=0;U<k.length;U++)k[U].mesh.parent!==this&&this.addChild(k[U].mesh);this._activePagesMeshData=k;for(const U in E){const P=E[U],I=P.total;if(!(((L=P.indices)==null?void 0:L.length)>6*I)||P.vertices.length<ay.BATCHABLE_SIZE*2)P.vertices=new Float32Array(4*2*I),P.uvs=new Float32Array(4*2*I),P.indices=new Uint16Array(6*I);else{const D=P.total,O=P.vertices;for(let M=D*4*2;M<O.length;M++)O[M]=0}P.mesh.size=6*I}for(let U=0;U<A;U++){const P=s[U];let I=P.position.x+T[P.line]*(this._align==="justify"?P.prevSpaces:1);this._roundPixels&&(I=Math.round(I));const D=I*n,O=P.position.y*n,M=P.texture,j=E[M.baseTexture.uid],N=M.frame,R=M._uvs,C=j.index++;j.indices[C*6+0]=0+C*4,j.indices[C*6+1]=1+C*4,j.indices[C*6+2]=2+C*4,j.indices[C*6+3]=0+C*4,j.indices[C*6+4]=2+C*4,j.indices[C*6+5]=3+C*4,j.vertices[C*8+0]=D,j.vertices[C*8+1]=O,j.vertices[C*8+2]=D+N.width*n,j.vertices[C*8+3]=O,j.vertices[C*8+4]=D+N.width*n,j.vertices[C*8+5]=O+N.height*n,j.vertices[C*8+6]=D,j.vertices[C*8+7]=O+N.height*n,j.uvs[C*8+0]=R.x0,j.uvs[C*8+1]=R.y0,j.uvs[C*8+2]=R.x1,j.uvs[C*8+3]=R.y1,j.uvs[C*8+4]=R.x2,j.uvs[C*8+5]=R.y2,j.uvs[C*8+6]=R.x3,j.uvs[C*8+7]=R.y3}this._textWidth=m*n,this._textHeight=(i.y+e.lineHeight)*n;for(const U in E){const P=E[U];if(this.anchor.x!==0||this.anchor.y!==0){let M=0;const j=this._textWidth*this.anchor.x,N=this._textHeight*this.anchor.y;for(let R=0;R<P.total;R++)P.vertices[M++]-=j,P.vertices[M++]-=N,P.vertices[M++]-=j,P.vertices[M++]-=N,P.vertices[M++]-=j,P.vertices[M++]-=N,P.vertices[M++]-=j,P.vertices[M++]-=N}this._maxLineHeight=g*n;const I=P.mesh.geometry.getBuffer("aVertexPosition"),D=P.mesh.geometry.getBuffer("aTextureCoord"),O=P.mesh.geometry.getIndex();I.data=P.vertices,D.data=P.uvs,O.data=P.indices,I.update(),D.update(),O.update()}for(let U=0;U<s.length;U++)py.push(s[U]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:r,distanceFieldType:n,size:i}=_n.available[this._fontName];if(n!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,u=Math.sqrt(s*s+o*o),h=Math.sqrt(a*a+l*l),d=(Math.abs(u)+Math.abs(h))/2,f=this.fontSize/i,p=e._view.resolution;for(const m of this._activePagesMeshData)m.mesh.shader.uniforms.uFWidth=d*r*f*p}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=_n.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!_n.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??_n.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:r}=this,n=_n.available[this._fontName].distanceFieldType==="none"?dy:fy;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>r[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=Z.EMPTY});for(const i in r)r[i].destroy(),delete r[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};_M.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const wM=[".xml",".fnt"],SM={extension:{type:X.LoadParser,priority:_r.Normal},name:"loadBitmapFont",test(t){return wM.includes(at.extname(t).toLowerCase())},async testParse(t){return Fl.test(t)||Pf.test(t)},async parse(t,e,r){const n=Fl.test(t)?Fl.parse(t):Pf.parse(t),{src:i}=e,{page:s}=n,o=[];for(let u=0;u<s.length;++u){const h=s[u].file;let d=at.join(at.dirname(i),h);d=Sf(d,i),o.push(d)}const a=await r.load(o),l=o.map(u=>a[u]);return _n.install(n,l,!0)},async load(t,e){return(await K.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};J.add(SM);const If=class rs extends ir{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new rs(Object.keys(rs.defaultOptions).reduce((r,n)=>({...r,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete rs.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,r={}){const{availableFonts:n}=rs;if(n[e]){const i=n[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return K.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,o)=>{const a=URL.createObjectURL(i),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(i)})).then(async([i,s])=>{const o=Object.assign({family:at.basename(e,at.extname(e)),weight:"normal",style:"normal",display:"auto",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},r);n[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const r=e.filter(n=>!this._overrides.includes(n));r.length>0&&(this._overrides.push(...r),this.styleID++)}removeOverride(...e){const r=e.filter(n=>this._overrides.includes(n));r.length>0&&(this._overrides=this._overrides.filter(n=>!r.includes(n)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,r)=>`${e}
            @font-face {
                font-family: "${r.family}";
                src: url('${r.dataSrc}');
                font-weight: ${r.weight};
                font-style: ${r.style};
                font-display: ${r.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=hR(e)),typeof e=="number"?uR(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const r=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&r<1&&(e+=(r*255|0).toString(16).padStart(2,"0"));const s=`${n}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,rs.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(r=>setTimeout(r,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=K.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};If.availableFonts={},If.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let jh=If;const hl=class ns extends Xn{constructor(e="",r={}){super(Z.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,i=Z.from(n,{scaleMode:K.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new fe,i.trim=new fe,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),u=document.createElementNS(o,"div"),h=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=ns.defaultMaxWidth,this.maxHeight=ns.defaultMaxHeight,this._domElement=u,this._styleElement=h,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(h),this._foreignObject.appendChild(u),this._image=n,this._loadImage=new Image,this._autoResolution=ns.defaultAutoResolution,this._resolution=ns.defaultResolution??K.RESOLUTION,this.text=e,this.style=r}measureText(e){var h,d;const{text:r,style:n,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:r,style:n.toCSS(i)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",u.toString()),r!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(h=this._style)==null?void 0:h.toCSS(i)}),this._styleElement.textContent=(d=this._style)==null?void 0:d.toGlobalCSS()),{width:l+n.padding*2,height:u+n.padding*2}}async updateText(e=!0){const{style:r,_image:n,_loadImage:i}=this;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();n.width=i.width=Math.ceil(Math.max(1,s)),n.height=i.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{i.onload=async()=>{if(a<this._updateID){l();return}await r.onBeforeDraw(),n.src=i.src,i.onload=null,i.src="",this.updateTexture(),l()};const u=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:r,_image:n,resolution:i}=this,{padding:s}=e,{baseTexture:o}=r;r.trim.width=r._frame.width=n.width/i,r.trim.height=r._frame.height=n.height/i,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-s*2,r.orig.height=r._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(n.width,n.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var n,i,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},ns.defaultDestroyOptions,e),super.destroy(e);const r=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=r,(i=this._svgRoot)==null||i.remove(),this._svgRoot=r,(s=this._domElement)==null||s.remove(),this._domElement=r,(o=this._foreignObject)==null||o.remove(),this._foreignObject=r,(a=this._styleElement)==null||a.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const r=kn(this.scale.x)||1;this.scale.x=r*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const r=kn(this.scale.y)||1;this.scale.y=r*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof jh?(this.ownsStyle=!1,this._style=e):e instanceof ir?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=jh.from(e)):(this.ownsStyle=!0,this._style=new jh(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};hl.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},hl.defaultMaxWidth=2024,hl.defaultMaxHeight=2024,hl.defaultAutoResolution=!0;const Bt={background:1710638,surface:2960708,hitZone:16098851,laneLeft:2972199,laneRight:4886745,textMuted:10526896,perfect:5025616,partial:16098851,miss:15037299},bM=.72,Nh=85,kf=.82,my=new Map;async function gy(t){const e=`/${t}`,r=my.get(t);if(r)return r;const n=(async()=>{try{console.log(`[Texture] Loading: ${e}`);const i=await yo.load(e);return!i||!i.valid?(console.error(`[Texture] Invalid texture loaded: ${t}`,{fullPath:e,texture:i}),null):(console.log(`[Texture] Success: ${t}`),i)}catch(i){return console.error(`[Texture] Failed to load: ${t}`,{fullPath:e,error:i}),null}})();return my.set(t,n),n}function EM({width:t,height:e,scheduledEvents:r,activeEvents:n,roundStartTime:i,roundState:s,scrollSpeed:o,currentFeedback:a,onChannelTap:l,trainingMode:u=!1,spectrogramMode:h="full",highContrast:d=!1}){const f=b.useRef(null),p=b.useRef(null),m=b.useRef(new Map),v=b.useRef(null),_=b.useCallback(x=>{var E;if(!l||!f.current)return;let y;"touches"in x?y=((E=x.touches[0])==null?void 0:E.clientX)??0:y=x.clientX;const g=f.current.getBoundingClientRect(),w=y-g.left,S=g.width/2,T=g.width*.1;if(Math.abs(w-S)<T/2)return;const A=w<S?"left":"right";l(A)},[l]);return b.useEffect(()=>{if(!f.current)return;const x=new A1({width:t,height:e,backgroundColor:Bt.background,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0});f.current.appendChild(x.view),p.current=x,yy(x,t,e),vy(x,t,e),_y(x,t,e);const y=new Lt;return x.stage.addChild(y),v.current=y,()=>{p.current&&(p.current.destroy(!0,{children:!0}),p.current=null),m.current.clear()}},[t,e]),b.useEffect(()=>{if(p.current){p.current.renderer.resize(t,e);const x=p.current;for(;x.stage.children.length>0;)x.stage.removeChildAt(0);yy(x,t,e),vy(x,t,e),_y(x,t,e);const y=new Lt;x.stage.addChild(y),v.current=y,m.current.clear()}},[t,e]),b.useEffect(()=>{const x=v.current;if(!x)return;if(s!=="playing"){x.removeChildren(),m.current.clear();return}if(r.length===0)return;const y=t/2,g=y*bM,w=e*kf;for(const S of r){if(m.current.has(S.event_id))continue;const T=TM(S,y,g,Nh,w,S.spectrogramPath,u,h,d);T.container.y=-Nh,x.addChild(T.container),m.current.set(S.event_id,T)}},[r,s,t,e,u,h,d]),b.useEffect(()=>{if(s!=="playing"||!p.current)return;const x=e*kf;let y;const g=()=>{const w=performance.now(),S=w-i;for(const T of m.current.values())if(T.hasBeenScored&&T.feedbackType){const A=w-T.feedbackStartTime;A>500&&(T.container.alpha=Math.max(0,1-(A-500)/200),T.container.alpha<=0&&(T.container.visible=!1))}else{const A=T.scheduledTimeMs-T.enterTimeMs,E=S-T.enterTimeMs,k=Math.max(0,E/A),F=-Nh,L=x;if(T.container.y=F+k*(L-F),h==="fading"){const U=T.container.getChildByName("spectrogram");U&&(k<.3?U.alpha=1:k<.8?U.alpha=1-(k-.3)/.5:U.alpha=0)}T.container.y>x+100&&(T.container.alpha=Math.max(0,1-(T.container.y-x-100)/50))}y=requestAnimationFrame(g)};return y=requestAnimationFrame(g),()=>{cancelAnimationFrame(y)}},[s,i,e,o,h]),b.useEffect(()=>{var x;if(a){for(const y of n)if(y.hasBeenScored&&y.channel===a.channel){const g=m.current.get(y.event_id);g&&!g.feedbackType&&(g.hasBeenScored=!0,g.feedbackType=a.type,g.feedbackStartTime=performance.now(),((x=a.breakdown)==null?void 0:x.speciesCorrect)?(xy(g,a.type,a.score),g.container.scale.set(1.3),setTimeout(()=>{g.container.visible=!1},400)):xy(g,a.type,a.score))}}},[a,n]),c.jsx("div",{ref:f,className:"pixi-game-container",onClick:_,onTouchStart:_,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none"}})}function TM(t,e,r,n,i,s,o=!1,a="full",l=!1){const u=new Lt,h=t.channel==="left"?e/2:e+e/2;u.x=h;const d=t.channel==="left"?Bt.laneLeft:Bt.laneRight,f=new Gt,p=l?.7:.4,m=l?4:2,v=l?1:.8;f.beginFill(d,p),f.lineStyle(m,d,v),f.drawRoundedRect(-r/2,-n/2,r,n,8),f.endFill(),u.addChild(f);const _=a!=="none"&&s;if(_&&gy(s).then(x=>{if(x&&u.parent){const y=new Xn(x);y.anchor.set(.5),y.position.set(0,0);const g=r-16,w=n-16;y.width=g,y.height=w,y.name="spectrogram",u.addChildAt(y,1),console.log(`[Sprite] Added spectrogram to tile: ${s}`)}else x?u.parent||console.warn(`[Sprite] Container removed before sprite could be added: ${s}`):console.error(`[Sprite] Texture null for: ${s}`)}),!_){const x=new Gt;for(let w=0;w<6;w++){const S=-n/2+10+w*10,T=(Math.random()*.4+.4)*r,A=-T/2+(Math.random()-.5)*20;x.beginFill(16777215,.2+Math.random()*.2),x.drawRect(A,S,T,2),x.endFill()}u.addChild(x);const y=new ir({fontFamily:"Inter, sans-serif",fontSize:18,fill:16777215,fontWeight:"700"}),g=new Pi("?",y);g.anchor.set(.5),g.position.set(0,0),g.alpha=.4,u.addChild(g)}if(o){const x=new ir({fontFamily:"Inter, sans-serif",fontSize:10,fill:16777215,fontWeight:"700"}),y=new Pi(t.species_code,x);y.anchor.set(.5),y.position.set(r/2-20,-n/2+44),y.alpha=.8;const g=new Gt;g.beginFill(0,.7);const w=3,S=y.width+w*2,T=y.height+w*2;g.drawRoundedRect(-S/2,-T/2,S,T,2),g.endFill(),g.position.set(y.position.x,y.position.y),u.addChild(g),u.addChild(y);const A=`data/icons/${t.species_code}.png`;gy(A).then(E=>{if(E&&u.parent){const k=new Xn(E);k.anchor.set(.5),k.width=32,k.height=32,k.position.set(r/2-20,-n/2+20),k.alpha=.9,u.addChild(k)}})}return{container:u,eventId:t.event_id,scheduledTimeMs:t.scheduled_time_ms,enterTimeMs:t.scoring_window_start_ms,channel:t.channel,speciesCode:t.species_code,hasBeenScored:!1,feedbackType:null,feedbackStartTime:0,spectrogramPath:s}}function xy(t,e,r){const n=t.container,i=e==="perfect"||e==="good"?Bt.perfect:e==="partial"?Bt.partial:Bt.miss,s=new Gt,o=100,a=70;if(s.beginFill(i,.5),s.drawRoundedRect(-o/2,-a/2,o,a,8),s.endFill(),n.addChildAt(s,1),r>0){const l=new ir({fontFamily:"JetBrains Mono, monospace",fontSize:20,fontWeight:"700",fill:i,stroke:0,strokeThickness:3}),u=new Pi(`+${r}`,l);u.anchor.set(.5),u.position.set(0,-a/2-15),n.addChild(u)}n.scale.set(1.1),setTimeout(()=>{n.scale.set(1)},100)}function yy(t,e,r){const n=e/2,i=new Gt;i.beginFill(Bt.background,1),i.drawRect(0,0,n-1,r),i.endFill(),t.stage.addChild(i);const s=new Gt;s.beginFill(Bt.background,1),s.drawRect(n+1,0,n-1,r),s.endFill(),t.stage.addChild(s);const o=new ir({fontFamily:"Inter, sans-serif",fontSize:14,fill:Bt.textMuted,fontWeight:"600"}),a=new Pi("LEFT",o);a.anchor.set(.5),a.position.set(n/2,30),a.alpha=.5,t.stage.addChild(a);const l=new Pi("RIGHT",o);l.anchor.set(.5),l.position.set(n+n/2,30),l.alpha=.5,t.stage.addChild(l)}function vy(t,e,r){const n=e/2,i=r*kf,s=4,o=new Gt;o.beginFill(Bt.hitZone,.8),o.drawRect(20,i,n-40,s),o.endFill(),t.stage.addChild(o);const a=new Gt;a.beginFill(Bt.hitZone,.8),a.drawRect(n+20,i,n-40,s),a.endFill(),t.stage.addChild(a);const l=new Gt;l.beginFill(Bt.hitZone,.2),l.drawRect(20,i-2,n-40,s+4),l.endFill(),t.stage.addChild(l);const u=new Gt;u.beginFill(Bt.hitZone,.2),u.drawRect(n+20,i-2,n-40,s+4),u.endFill(),t.stage.addChild(u)}function _y(t,e,r){const n=e/2,i=new Gt,s=20,o=10;let a=0;for(i.beginFill(Bt.surface,.5);a<r;)i.drawRect(n-1,a,2,s),a+=s+o;i.endFill(),t.stage.addChild(i)}const AM=b.memo(EM),yn={SPECIES_CORRECT:50,CHANNEL_CORRECT:25,TIMING_PERFECT:25,TIMING_PARTIAL:10};class CM{constructor(e){mn(this,"panner");this.panner=e.createStereoPanner()}get output(){return this.panner}setPan(e){this.panner.pan.value=Math.max(-1,Math.min(1,e))}disconnect(){this.panner.disconnect()}}class wy{constructor(e){mn(this,"ctx");mn(this,"inputGain");mn(this,"leftGain");mn(this,"rightGain");mn(this,"merger");this.ctx=e,this.inputGain=e.createGain(),this.leftGain=e.createGain(),this.rightGain=e.createGain(),this.merger=e.createChannelMerger(2),this.inputGain.connect(this.leftGain),this.inputGain.connect(this.rightGain),this.leftGain.connect(this.merger,0,0),this.rightGain.connect(this.merger,0,1),this.setPan(0)}get output(){return this.inputGain}get destination(){return this.merger}setPan(e){const n=(Math.max(-1,Math.min(1,e))+1)*Math.PI/4,i=Math.cos(n),s=Math.sin(n);this.leftGain.gain.setValueAtTime(i,this.ctx.currentTime),this.rightGain.gain.setValueAtTime(s,this.ctx.currentTime)}disconnect(){this.inputGain.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.merger.disconnect()}}class RM{constructor(){mn(this,"capabilities");this.capabilities=this.detectCapabilities(),console.log("Audio capabilities:",this.capabilities)}detectCapabilities(){const e=navigator.userAgent,r=/iPad|iPhone|iPod/.test(e)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,n=r&&/CriOS/.test(e),i=r&&/FxiOS/.test(e),s=r&&/EdgiOS/.test(e),o=typeof AudioContext<"u"||typeof window.webkitAudioContext<"u",a=o&&typeof StereoPannerNode<"u"&&!n&&!i&&!s;return{supportsStereoPanner:a,supportsWebAudio:o,isIOSChrome:n,isIOS:r,browserInfo:`iOS: ${r}, Chrome: ${n}, StereoPanner: ${a}`}}getCapabilities(){return{...this.capabilities}}supportsStereoPanner(){return this.capabilities.supportsStereoPanner}isIOSChrome(){return this.capabilities.isIOSChrome}createPanner(e){return this.capabilities.supportsStereoPanner?new CM(e):new wy(e)}createChannelPanner(e,r){const n=this.createPanner(e);return n.setPan(r==="left"?-1:1),n}connectPannerToDestination(e,r){e instanceof wy?e.destination.connect(r):e.output.connect(r)}}let Fh=null;function Sy(){return Fh||(Fh=new RM),Fh}const by={low:100,medium:150,high:200},PM={level_id:1,pack_id:"common_se_birds",mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},IM={NOCA:"#E57373",CARW:"#81C784",BLJA:"#4FC3F7",AMCR:"#424242",TUTI:"#FFD54F",BEKI:"#00BCD4",RSHA:"#8D6E63",AMGO:"#FFEB3B",CACH:"#B0BEC5",PIWA:"#AED581",WTSP:"#BCAAA4",HOFI:"#EF9A9A",EABL:"#64B5F6",AMRO:"#FF8A65",HETH:"#D7CCC8",BHNU:"#A1887F",BRCR:"#8D6E63",WBNU:"#80CBC4",YBSA:"#FFF59D",RBWO:"#CE93D8",DOWO:"#90A4AE",HAWO:"#CFD8DC",NOFL:"#FFCC80",PIWO:"#B39DDB",BRTH:"#A1887F",GRCA:"#78909C",MODO:"#BCAAA4"};function kM(t){let e=t;return()=>(e=e*1103515245+12345&2147483647,e/2147483647)}function MM(t=PM){const e=b.useRef(null),r=b.useRef(new Map),n=b.useRef(new Map),i=b.useRef(new Map),s=b.useRef(new Map),o=b.useRef(new Map),a=b.useRef(null),[l,u]=b.useState({}),h=b.useMemo(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}},[]),[d,f]=b.useState([]),[p,m]=b.useState([]),[v,_]=b.useState([]);b.useEffect(()=>{console.log("species state changed, now has",v.length,"species:",v.map(z=>z.code))},[v]),b.useEffect(()=>{fetch("/data/taxonomic_order.json").then(z=>z.json()).then(z=>{u(z)}).catch(z=>console.error("Failed to load taxonomic order:",z))},[]);const x=b.useCallback(z=>h&&Object.keys(l).length>0?[...z].sort((se,ce)=>{const re=l[se.code]||9999,ue=l[ce.code]||9999;return re-ue}):[...z].sort((se,ce)=>se.code.localeCompare(ce.code)),[h,l]),[y,g]=b.useState("idle"),[w,S]=b.useState(0),[T,A]=b.useState(0),[E,k]=b.useState(t.round_duration_sec),[F,L]=b.useState(0),[U,P]=b.useState(0),[I,D]=b.useState(0),[O,M]=b.useState(0),[j,N]=b.useState(0),[R,C]=b.useState([]),[B,$]=b.useState([]),[V,ie]=b.useState(0),ae=b.useRef(1),Q=b.useRef(typeof window<"u"&&localStorage.getItem("soundfield_continuous_play")==="true"),[me,Me]=b.useState(0),Pe=5e3,[we,Se]=b.useState(()=>{const z=by[t.event_density]||100,se=localStorage.getItem("soundfield_scroll_speed"),ce=se?parseFloat(se):.5;return ae.current=ce,z*ce}),[Ee,Ve]=b.useState(null),[_t,At]=b.useState(!0),Gr=b.useRef(null),wr=b.useRef([]),wa=b.useRef(0),Sa=b.useRef([]),ba=b.useRef(new Set),lu=b.useRef(0),cu=b.useRef(0),uu=b.useRef(0),hu=b.useRef(0),du=b.useRef(0),Li=b.useRef(0),Ea=b.useRef([]),fu=b.useRef([]),Ta=b.useRef(0),hn=b.useRef(null),Ct=b.useRef(null),dn=b.useRef({left:null,right:null}),ft=b.useRef({left:null,right:null}),Vp=b.useCallback(async()=>{var z;console.log("loadClips called with level:",{pack_id:t.pack_id,species_pool_length:(z=t.species_pool)==null?void 0:z.length,species_count:t.species_count});try{const se=await fetch("/data/clips.json");if(!se.ok)throw new Error("Failed to load clips.json");const ce=await se.json();f(ce);const re=t.species_pool,ue=re?new Set(re):null,oe=new Map;for(const de of ce)ue&&!ue.has(de.species_code)||oe.has(de.species_code)||oe.set(de.species_code,{code:de.species_code,name:de.common_name,color:IM[de.species_code]});const pe=Array.from(oe.values());m(pe);const Ie=sessionStorage.getItem("roundSpecies");if(Ie)try{const de=JSON.parse(Ie),Te=pe.filter(G=>de.includes(G.code)),Xe=x(Te);if(Xe.length>0){console.log("loadClips: Using pre-selected species:",Xe.map(G=>G.code)),_(Xe);return}}catch(de){console.error("Failed to parse pre-selected species in loadClips:",de)}_(pe)}catch(se){console.error("Error loading clips:",se)}},[t.species_pool,t.species_count]),Xp=b.useCallback(async()=>{if(e.current){console.log("initializeAudio: Already initialized, setting isAudioReady"),At(!0);return}try{const z=Sy();console.log("initializeAudio: Browser capabilities:",z.getCapabilities());const se=new AudioContext;e.current=se,console.log("initializeAudio: AudioContext created, state:",se.state),se.state==="suspended"&&(console.log("initializeAudio: AudioContext suspended, attempting resume..."),await se.resume(),console.log("initializeAudio: AudioContext resumed, state:",se.state)),At(!0),console.log("initializeAudio: Audio is ready!")}catch(z){console.error("initializeAudio: Failed to initialize audio:",z),At(!0)}},[]),pu=b.useCallback(async z=>{const se=e.current;if(!se)throw new Error("Audio context not initialized");const ce=r.current.get(z);if(ce)return console.log("loadAudioBuffer: Using cached buffer for",z),ce;console.log("loadAudioBuffer: Fetching",z);const re=await fetch(`/${z}`);if(!re.ok)throw console.error("loadAudioBuffer: Fetch failed",re.status,re.statusText),new Error(`Failed to load audio: ${z}`);console.log("loadAudioBuffer: Fetch OK, decoding...");const ue=await re.arrayBuffer();try{const oe=await se.decodeAudioData(ue);return console.log("loadAudioBuffer: Decoded OK, duration:",oe.duration),r.current.set(z,oe),oe}catch(oe){throw console.error(` DECODE FAILED for ${z}:`,oe),console.error("  This file cannot be played in Web Audio API (gameplay)"),console.error("  File size:",ue.byteLength,"bytes"),new Error(`Cannot decode audio file: ${z} - ${oe}`)}},[]),Yp=b.useCallback(async(z,se,ce,re)=>{const ue=e.current;if(!ue){console.error("playAudio: No AudioContext!");return}console.log("playAudio:",z,"ctx.state:",ue.state);try{ue.state==="suspended"&&(console.log("playAudio: Context suspended, trying to resume..."),await ue.resume());const oe=await pu(z);console.log("playAudio: Buffer loaded, duration:",oe.duration);const pe=Sy();console.log("playAudio: Using adapter, capabilities:",pe.getCapabilities());const Ie=ue.createBufferSource(),de=ue.createGain(),Te=pe.createChannelPanner(ue,se);de.gain.value=.05,Ie.buffer=oe,Ie.connect(de),de.connect(Te.output),pe.connectPannerToDestination(Te,ue.destination),Ie.loop=!0,n.current.set(ce,Ie),i.current.set(ce,de),s.current.set(ce,Te),o.current.set(ce,re),Ie.onended=()=>{n.current.delete(ce),i.current.delete(ce);const Xe=s.current.get(ce);Xe&&(Xe.disconnect(),s.current.delete(ce)),o.current.delete(ce)},Ie.start(),console.log("playAudio: Started playing")}catch(oe){console.error(" playAudio FAILED for",z),console.error("   Error:",oe),console.error("   This bird will have no audio during gameplay!")}},[pu]),Ys=b.useCallback(z=>{const se=n.current.get(z);if(se)try{se.stop()}catch{}const ce=s.current.get(z);ce&&ce.disconnect(),n.current.delete(z),i.current.delete(z),s.current.delete(z),o.current.delete(z)},[]),Kp=b.useCallback((z,se,ce,re)=>{const ue=se.filter(G=>G.species_code===z&&!G.rejected);if(ue.length===0)return[];const oe=ue.filter(G=>G.canonical),pe=ue.filter(G=>!G.canonical);if(ce==="canonical")return oe.length>0?oe:ue.slice(0,1);if(ce==="all")return ue;const Ie=ce,de=[];oe.length>0&&de.push(...oe);const Te=[...pe];for(let G=Te.length-1;G>0;G--){const ee=Math.floor(re()*(G+1));[Te[G],Te[ee]]=[Te[ee],Te[G]]}const Xe=Ie-de.length;return de.push(...Te.slice(0,Xe)),de},[]),qp=b.useCallback(z=>{const se=[],ce=Date.now(),re=kM(ce),ue=t.clip_selection??(t.canonical_only?"canonical":"all");let oe;if(z&&z.length>0)oe=[...z];else if(t.species_pool&&t.species_pool.length>0)oe=[...t.species_pool];else{const G=new Set;for(const ve of d)ve.rejected||G.add(ve.species_code);const ee=Array.from(G);for(let ve=ee.length-1;ve>0;ve--){const Ce=Math.floor(re()*(ve+1));[ee[ve],ee[Ce]]=[ee[Ce],ee[ve]]}oe=ee.slice(0,t.species_count)}const pe=new Map;for(const G of oe){const ee=Kp(G,d,ue,re);ee.length>0&&pe.set(G,ee)}if(oe=oe.filter(G=>pe.has(G)),oe.length===0)return console.error("No species with available clips!"),[];console.log("generateEvents:",{clipSelection:ue,selectedSpecies:oe,clipsPerSpecies:Object.fromEntries(Array.from(pe.entries()).map(([G,ee])=>[G,ee.map(ve=>ve.clip_id)]))});const Ie=2,de=new Map,Xe=localStorage.getItem("soundfield_continuous_play")==="true"?100:Math.ceil(t.round_duration_sec/2)+5;for(let G=0;G<Xe;G++){const ee=oe.filter(Hr=>(pe.get(Hr)||[]).some(mt=>(de.get(mt.clip_id)||0)<Ie));let ve;ee.length>0?ve=ee[Math.floor(re()*ee.length)]:ve=oe[Math.floor(re()*oe.length)];const Ce=pe.get(ve)||[],pt=Ce.filter(Hr=>(de.get(Hr.clip_id)||0)<Ie);let Rt;if(pt.length>0?Rt=pt[Math.floor(re()*pt.length)]:Rt=Ce.reduce((Hr,Di)=>{const mt=de.get(Hr.clip_id)||0;return(de.get(Di.clip_id)||0)<mt?Di:Hr},Ce[0]),!Rt)continue;de.set(Rt.clip_id,(de.get(Rt.clip_id)||0)+1);const ei=re()<.5?"left":"right";se.push({event_id:`evt_${G}_${ce}`,clip_id:Rt.clip_id,species_code:ve,channel:ei,scheduled_time_ms:0,scoring_window_start_ms:0,scoring_window_end_ms:0,duration_ms:Rt.duration_ms,vocalization_type:Rt.vocalization_type})}return se},[d,t,Kp]),Qp=b.useCallback(z=>d.find(se=>se.clip_id===z),[d]),sr=b.useCallback(z=>{const se=fu.current,ce=Ta.current,re=t.channel_mode||"single",ue=Pe/ae.current;if(ce>=se.length){re==="single"?hn.current=null:z&&(dn.current[z]=null);return}const oe=performance.now(),pe=wa.current,Ie=oe-pe;if(!Q.current&&t.round_duration_sec*1e3-Ie<2e3){re==="single"?hn.current=null:z&&(dn.current[z]=null);return}const de=se[ce];Ta.current=ce+1;let Te;if(re==="offset"&&z?Te=z:Te=de.channel,re==="single")Ct.current!==null&&(clearTimeout(Ct.current),Ct.current=null);else{const mt=ft.current[Te];mt!==null&&(clearTimeout(mt),ft.current[Te]=null)}const Xe=Ie,G=Ie+ue,ee={...de,channel:Te,scheduled_time_ms:G,scoring_window_start_ms:Xe,scoring_window_end_ms:G+500};re==="single"?hn.current=ee.event_id:dn.current[Te]=ee.event_id;const ve=Qp(ee.clip_id);if(!ve){console.error("spawnNextEvent: clip not found for clip_id:",ee.clip_id,"species:",ee.species_code),re==="single"?sr():z&&sr(z);return}Sa.current.push(ee);const Ce={...ee,spectrogramPath:ve.spectrogram_path||null,filePath:ve.file_path};$(mt=>[...mt,Ce]),Yp(ve.file_path,Te,ee.event_id,ee.scheduled_time_ms),C(mt=>[...mt,{...ee,isActive:!0,hasBeenScored:!1}]);const pt=ue+500,Rt=ee.event_id,ei=Te,Hr=ee.species_code,Di=window.setTimeout(()=>{if(re==="single"){if(hn.current!==Rt)return;Ct.current=null}else{if(dn.current[ei]!==Rt)return;ft.current[ei]=null}Ys(Rt),C(mt=>mt.map(pn=>pn.event_id===Rt?{...pn,isActive:!1}:pn)),C(mt=>{const pn=mt.find(Ks=>Ks.event_id===Rt);if(pn&&!pn.hasBeenScored){N(Oi=>Oi+1),du.current+=1,A(0),Ea.current.push({expectedSpecies:Hr,guessedSpecies:null,channel:ei});const Ks={id:`miss_${Date.now()}`,type:"miss",score:0,breakdown:{speciesCorrect:!1,channelCorrect:!1,timingAccuracy:"miss",speciesPoints:0,channelPoints:0,timingPoints:0,totalPoints:0},channel:ei,timestamp:performance.now(),expectedSpecies:Hr};Ve(Ks),setTimeout(()=>{Ve(Oi=>(Oi==null?void 0:Oi.id)===Ks.id?null:Oi)},1500)}return mt}),window.setTimeout(()=>{re==="single"?sr():sr(ei)},200)},pt);re==="single"?Ct.current=Di:ft.current[Te]=Di},[Qp,Yp,Ys,t.round_duration_sec,t.channel_mode]),Zp=b.useCallback((z,se)=>{if((t.channel_mode||"single")==="single"){if(hn.current!==z)return;Ct.current!==null&&(clearTimeout(Ct.current),Ct.current=null),hn.current=null,Ys(z),sr()}else{if(dn.current[se]!==z)return;const re=ft.current[se];re!==null&&(clearTimeout(re),ft.current[se]=null),dn.current[se]=null,Ys(z),sr(se)}},[Ys,sr,t.channel_mode]),Jp=b.useCallback(async()=>{console.log("initialize: Starting...");try{await Promise.all([Vp().catch(z=>console.error("initialize: loadClips failed:",z)),Xp().catch(z=>console.error("initialize: initializeAudio failed:",z))])}catch(z){console.error("initialize: Failed:",z)}At(!0),console.log("initialize: Complete, isAudioReady forced to true")},[Vp,Xp]),em=b.useCallback(async()=>{if(console.log("startRound called, roundState:",y,"clips.length:",d.length),y!=="idle"||d.length===0)return;let z=e.current;if(z||(z=new AudioContext,e.current=z,console.log("AudioContext created during tap")),z.state==="suspended")try{await z.resume(),console.log("AudioContext resumed, state:",z.state)}catch(G){console.error("Failed to resume AudioContext:",G)}try{const G="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAYYoRwmHAAAAAAD/+1DEAAAHAAGf9AAAIgAANIAAAARMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7UMQbA8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",ee=new Audio(G);ee.volume=.01,await ee.play(),console.log("HTML5 silent audio played to unlock iOS audio session")}catch(G){console.error("Failed to play HTML5 silent audio:",G)}console.log("AudioContext state:",z.state),At(!0);const se=by[t.event_density]||100,ce=localStorage.getItem("soundfield_scroll_speed"),re=ce?parseFloat(ce):.5;ae.current=re,Se(se*re),S(0),A(0),L(0),P(0),D(0),M(0),N(0),C([]),$([]),Ve(null),k(t.round_duration_sec),ba.current.clear(),lu.current=0,cu.current=0,uu.current=0,hu.current=0,du.current=0,Li.current=0,Ea.current=[],Sa.current=[];let ue;console.log("startRound: allPoolSpecies.length =",p.length,"species_count =",t.species_count);const oe=sessionStorage.getItem("roundSpecies");if(oe)try{const G=JSON.parse(oe);sessionStorage.removeItem("roundSpecies");const ee=G.filter(ve=>p.some(Ce=>Ce.code===ve));if(ee.length>0){const ve=p.filter(pt=>ee.includes(pt.code)),Ce=x(ve);console.log("Using pre-selected species:",Ce.map(pt=>pt.code)),_(Ce),ue=Ce.map(pt=>pt.code)}}catch(G){console.error("Failed to parse pre-selected species:",G),sessionStorage.removeItem("roundSpecies")}if(!ue)if(t.species_count&&p.length>t.species_count){const G=[...p];for(let Ce=G.length-1;Ce>0;Ce--){const pt=Math.floor(Math.random()*(Ce+1));[G[Ce],G[pt]]=[G[pt],G[Ce]]}const ee=G.slice(0,t.species_count),ve=x(ee);console.log("Random selection: setting species to",ve.length,"species:",ve.map(Ce=>Ce.code)),_(ve),ue=ve.map(Ce=>Ce.code)}else console.log("Using all pool species:",p.length),_(p),ue=p.map(G=>G.code);const pe=qp(ue);fu.current=pe,Ta.current=0;const Ie=[...new Set(pe.map(G=>G.clip_id))];console.log("Preloading",Ie.length,"audio clips during tap gesture...");const de=Ie.map(async G=>{const ee=d.find(ve=>ve.clip_id===G);if(ee)try{await pu(ee.file_path)}catch(ve){console.error("Failed to preload clip:",G,ve)}});await Promise.all(de),console.log("Audio preloading complete"),hn.current=null,Ct.current!==null&&(clearTimeout(Ct.current),Ct.current=null),dn.current={left:null,right:null},ft.current.left!==null&&clearTimeout(ft.current.left),ft.current.right!==null&&clearTimeout(ft.current.right),ft.current={left:null,right:null};const Te=performance.now();if(g("playing"),ie(Te),wa.current=Te,(t.channel_mode||"single")==="single")sr();else{sr("left");const ee=window.setTimeout(()=>{sr("right")},1500);wr.current.push(ee)}if(Q.current=localStorage.getItem("soundfield_continuous_play")==="true",Q.current)k(0),Gr.current=window.setInterval(()=>{k(G=>G+1)},1e3);else{Gr.current=window.setInterval(()=>{k(ee=>ee<=1?(fn(),0):ee-1)},1e3);const G=window.setTimeout(()=>{fn()},t.round_duration_sec*1e3);wr.current.push(G)}},[y,d.length,t.round_duration_sec,t.channel_mode,t.species_count,p,qp,sr]),fn=b.useCallback(()=>{g("ended"),Gr.current&&(clearInterval(Gr.current),Gr.current=null),Ct.current!==null&&(clearTimeout(Ct.current),Ct.current=null),hn.current=null,ft.current.left!==null&&clearTimeout(ft.current.left),ft.current.right!==null&&clearTimeout(ft.current.right),ft.current={left:null,right:null},dn.current={left:null,right:null};for(const re of wr.current)clearTimeout(re);wr.current=[];for(const re of n.current.values())try{re.stop()}catch{}for(const re of s.current.values())re.disconnect();n.current.clear(),i.current.clear(),s.current.clear(),o.current.clear();const z={};for(const re of Sa.current){const ue=re.species_code;z[ue]||(z[ue]={total:0,correct:0}),z[ue].total++,ba.current.has(re.event_id)&&z[ue].correct++}const se=ba.current.size,ce={score:cu.current,eventsScored:se,totalEvents:Sa.current.length,speciesCorrect:uu.current,channelCorrect:hu.current,perfectCount:lu.current,missCount:du.current,maxStreak:Li.current,speciesResults:z,species:v.map(re=>({code:re.code,name:re.name})),mode:t.mode,packId:t.pack_id,levelId:t.level_id,levelTitle:t.title,confusionData:Ea.current};localStorage.setItem("soundfield_round_results",JSON.stringify(ce))},[v,t.mode,t.pack_id,t.level_id,t.title]),tm=b.useCallback((z,se,ce,re)=>{const ue=se===z.species_code,oe=ce===z.channel,pe=z.scheduled_time_ms,Ie=z.scoring_window_start_ms,de=pe-Ie,Te=pe-re,Xe=Math.max(0,Math.min(1,Te/de));let G;Xe>=.5?G="perfect":(Xe>=.25,G="partial");const ee=ue?yn.SPECIES_CORRECT:0,ve=ue&&oe?yn.CHANNEL_CORRECT:0;let Ce=0;ue&&oe&&(Xe>=.75?Ce=yn.TIMING_PERFECT:Xe>=.5&&(Ce=yn.TIMING_PARTIAL));const pt=ee+ve+Ce;return{speciesPoints:ee,channelPoints:ve,timingPoints:Ce,totalPoints:pt,speciesCorrect:ue,channelCorrect:oe,timingAccuracy:G}},[]),rm=b.useCallback((z,se)=>{if(y!=="playing")return;const ce=performance.now(),re=ce-wa.current,ue=t.channel_mode||"single",oe=R.find(G=>!(G.hasBeenScored||re<G.scoring_window_start_ms||re>G.scoring_window_end_ms||ue==="offset"&&G.channel!==se));if(!oe)return;const pe=tm(oe,z,se,re);Ea.current.push({expectedSpecies:oe.species_code,guessedSpecies:z,channel:oe.channel}),pe.speciesCorrect&&ba.current.add(oe.event_id),Zp(oe.event_id,oe.channel),C(G=>G.map(ee=>ee.event_id===oe.event_id?{...ee,hasBeenScored:!0}:ee)),S(G=>G+pe.totalPoints),cu.current+=pe.totalPoints,L(G=>G+1),pe.speciesCorrect&&(P(G=>G+1),uu.current+=1),pe.channelCorrect&&(D(G=>G+1),hu.current+=1);const Ie=yn.SPECIES_CORRECT+yn.CHANNEL_CORRECT;pe.totalPoints===Ie?(M(G=>G+1),lu.current+=1,A(G=>{const ee=G+1;return Li.current=Math.max(Li.current,ee),ee})):pe.totalPoints>0?A(G=>{const ee=G+1;return Li.current=Math.max(Li.current,ee),ee}):A(0);let de;const Te=yn.SPECIES_CORRECT+yn.CHANNEL_CORRECT;pe.totalPoints===Te?de="perfect":pe.speciesCorrect&&pe.channelCorrect?de="good":pe.speciesCorrect?de="partial":de="miss";const Xe={id:`feedback_${Date.now()}`,type:de,score:pe.totalPoints,breakdown:pe,channel:oe.channel,timestamp:ce,expectedSpecies:de==="miss"?oe.species_code:void 0};Ve(Xe),setTimeout(()=>{Ve(G=>(G==null?void 0:G.id)===Xe.id?null:G)},de==="miss"?1500:500)},[y,R,tm,Zp,t.channel_mode]),nm=b.useCallback(()=>{fn(),g("idle"),S(0),A(0),L(0),P(0),D(0),M(0),N(0),C([]),$([]),ie(0),Ve(null),k(t.round_duration_sec)},[fn,t.round_duration_sec]);b.useEffect(()=>{if(y!=="playing"){a.current&&(cancelAnimationFrame(a.current),a.current=null);return}const z=()=>{var re;const se=performance.now()-wa.current,ce=Pe/ae.current;for(const[ue,oe]of i.current.entries()){const pe=o.current.get(ue);if(pe===void 0)continue;const Ie=pe-se,Te=.05+Math.max(0,Math.min(1,1-Ie/ce))*.95;oe.gain.setValueAtTime(Te,((re=e.current)==null?void 0:re.currentTime)||0)}a.current=requestAnimationFrame(z)};return a.current=requestAnimationFrame(z),()=>{a.current&&cancelAnimationFrame(a.current)}},[y]),b.useEffect(()=>()=>{Gr.current&&clearInterval(Gr.current),a.current&&cancelAnimationFrame(a.current);for(const z of wr.current)clearTimeout(z);for(const z of n.current.values())try{z.stop()}catch{}},[]),b.useEffect(()=>{if(y!=="playing"||!Q.current)return;const z=fu.current.length,se=Ta.current;z>0&&se>=z&&R.length===0&&(console.log("Continuous mode: all events processed, ending round"),fn())},[y,F,j,R.length,fn]);const q1={roundState:y,score:w,streak:T,timeRemaining:E,totalTime:t.round_duration_sec,eventsScored:F,speciesCorrect:U,channelCorrect:I,perfectCount:O,missCount:j,activeEvents:R,scheduledEvents:B,roundStartTime:V,scrollSpeed:we,currentFeedback:Ee,species:v,isAudioReady:_t},Q1=b.useMemo(()=>({initialize:Jp,startRound:em,endRound:fn,submitInput:rm,reset:nm}),[Jp,em,fn,rm,nm]);return[q1,Q1]}function Ey({code:t,size:e=32,color:r}){const[n,i]=b.useState(!0),s=`/data/icons/${t}.png`;return c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[n&&c.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?c.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>i(!1)}):c.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"transparent",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.35,fontWeight:700},children:t})]})}const Ty=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F"],BM={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function jM(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function NM(t){return t>=4?"offset":"single"}const Ay={campaign:{mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},practice:{mode:"practice",round_duration_sec:60,species_count:3,event_density:"low",overlap_probability:0,scoring_window_ms:3e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},challenge:{mode:"challenge",round_duration_sec:60,species_count:8,event_density:"medium",overlap_probability:0,scoring_window_ms:1500,spectrogram_mode:"fading",clip_selection:"all",channel_mode:"offset"},random:{mode:"random",round_duration_sec:45,species_count:6,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"all",channel_mode:"single"}};function FM(){const t=Xt(),[e]=Vc(),r=b.useRef(null),[n,i]=b.useState({width:400,height:400}),[s,o]=b.useState(null),[a,l]=b.useState(null),[u,h]=b.useState([]),[d,f]=b.useState(!1),[p,m]=b.useState(()=>localStorage.getItem("soundfield_training_mode")==="true"),v=b.useRef(!1),_=b.useMemo(()=>localStorage.getItem("soundfield_spectrogram_mode")||"full",[]),x=b.useMemo(()=>localStorage.getItem("soundfield_high_contrast")==="true",[]);b.useEffect(()=>{localStorage.setItem("soundfield_training_mode",String(p)),p&&(v.current=!0)},[p]);const y=e.get("mode")||"campaign",g=e.get("pack")||"common_se_birds",w=parseInt(e.get("level")||"1",10);b.useEffect(()=>{console.log("Fetching levels.json..."),fetch("/data/levels.json").then(C=>C.json()).then(C=>{console.log("Loaded",C.length,"levels from levels.json"),h(C)}).catch(C=>{console.error("Failed to load levels.json:",C)})},[]);const S=b.useMemo(()=>{var B;if(console.log("levelConfig useMemo: mode =",y,"packId =",g,"campaignLevels.length =",u.length),g==="custom"){let $=[];try{const V=sessionStorage.getItem("roundSpecies");if(V)$=JSON.parse(V);else{const ie=localStorage.getItem("soundfield_custom_pack");ie&&($=JSON.parse(ie),sessionStorage.setItem("roundSpecies",ie))}}catch(V){console.error("Failed to parse custom species:",V)}return console.log("Custom pack: using species:",$,"for level",w),{level_id:w,pack_id:"custom",mode:"campaign",title:BM[w]||`Level ${w}`,round_duration_sec:30,species_count:$.length,species_pool:$,clip_selection:jM(w),channel_mode:NM(w),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:_}}if(y==="campaign"&&u.length>0){const $=u.find(ie=>ie.pack_id===g&&ie.level_id===w);if($)return console.log("Found level from levels.json:",$.pack_id,$.title,"species_pool:",(B=$.species_pool)==null?void 0:B.length),{...$,spectrogram_mode:_};const V=u.find(ie=>ie.pack_id===g);return V?(console.log("Using first level for pack:",V.pack_id,V.title),{...V,spectrogram_mode:_}):(console.log("Ultimate fallback to first level"),{...u[0],spectrogram_mode:_})}console.log("Using hardcoded MODE_CONFIGS (no campaign levels loaded yet)");const C=Ay[y]||Ay.campaign;return{level_id:1,pack_id:g,...C,spectrogram_mode:_}},[y,g,w,u,_]),[T,A]=MM(S),E=b.useRef(null);b.useEffect(()=>{var $,V;if(y==="campaign"&&u.length===0&&g!=="custom"){console.log("Waiting for levels.json to load...");return}const C=(($=S.species_pool)==null?void 0:$.length)??"none",B=`${S.pack_id}-${S.level_id}-${C}`;console.log("Init effect: key =",B,"lastKey =",E.current),E.current!==B&&(E.current=B,console.log("Initializing for",B),A.initialize(),DE(S.pack_id,S.level_id,((V=S.species_pool)==null?void 0:V.length)??0))},[y,u.length,S.pack_id,S.level_id,S.species_pool,A]),b.useEffect(()=>{const C=()=>{if(r.current){const B=r.current.getBoundingClientRect();i({width:B.width,height:B.height})}};return C(),window.addEventListener("resize",C),()=>window.removeEventListener("resize",C)},[]);const k=b.useRef(A);k.current=A;const F=b.useRef(T.roundState);F.current=T.roundState,b.useEffect(()=>()=>{F.current==="playing"&&k.current.reset()},[]);const L=b.useMemo(()=>localStorage.getItem("soundfield_continuous_play")==="true",[]),U=T.species.map((C,B)=>({code:C.code,name:C.name,color:C.color||Ty[B%Ty.length]})),P=b.useCallback(C=>{o(C);const B=document.getElementById(`flash-${C}`);B&&(B.classList.add("active"),setTimeout(()=>B.classList.remove("active"),150)),a&&(A.submitInput(a,C),o(null),l(null))},[a,A]),I=b.useCallback(C=>{l(C),s&&(A.submitInput(C,s),o(null),l(null))},[s,A]);b.useEffect(()=>{const C=B=>{if(T.roundState==="playing"){if(B.key==="a"||B.key==="A"||B.key==="ArrowLeft"||B.key==="1")P("left");else if(B.key==="d"||B.key==="D"||B.key==="ArrowRight"||B.key==="2")P("right");else if(B.key>="3"&&B.key<="9"){const $=parseInt(B.key)-3;$<U.length&&I(U[$].code)}}};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[T.roundState,P,I,U]);const D=b.useCallback(()=>{A.reset(),t("/")},[t,A]),O=b.useCallback(()=>{f(!0)},[]),M=b.useCallback(()=>{A.reset(),t(-1)},[t,A]),j=b.useCallback(()=>{f(!1)},[]),N=b.useCallback(()=>{console.log("handleStart clicked, isAudioReady:",T.isAudioReady,"species.length:",T.species.length),T.isAudioReady&&T.species.length>0?(console.log("Calling startRound..."),v.current=p,A.startRound()):console.log("Not calling startRound - conditions not met")},[T.isAudioReady,T.species.length,A,p]),R=b.useCallback(()=>{A.endRound();try{const C=localStorage.getItem("soundfield_round_results");if(C){const B=JSON.parse(C);B.usedTrainingMode=v.current,localStorage.setItem("soundfield_round_results",JSON.stringify(B))}}catch(C){console.error("Failed to update results with training mode flag:",C)}t("/summary",{replace:!0})},[t,A]);return b.useEffect(()=>{if(T.roundState==="ended"){try{const C=localStorage.getItem("soundfield_round_results");if(C){const B=JSON.parse(C);B.usedTrainingMode=v.current,localStorage.setItem("soundfield_round_results",JSON.stringify(B));const $=B.correctCount&&B.totalEvents?B.correctCount/B.totalEvents*100:0,V=B.duration??0;OE(S.pack_id,S.level_id,T.score,$,V)}}catch(C){console.error("Failed to update results with training mode flag:",C)}t("/summary",{replace:!0})}},[T.roundState,T.score,S.pack_id,S.level_id,t]),c.jsxs("div",{className:"gameplay-screen",children:[c.jsx(xT,{score:T.score,streak:T.streak,timeRemaining:T.timeRemaining,mode:y,levelId:S.level_id,levelTitle:S.title}),c.jsx("button",{className:"back-button",onClick:D,"aria-label":"Back to menu",children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}),T.roundState==="playing"&&c.jsx("button",{className:"quit-button",onClick:O,"aria-label":"Quit round",children:c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),c.jsx("button",{className:`training-toggle ${p?"active":""}`,onClick:()=>{const C=!p;m(C),UE(C)},"aria-label":p?"Disable training mode":"Enable training mode",title:p?"Training Mode ON - Icons visible":"Training Mode OFF",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:p?c.jsxs(c.Fragment,{children:[c.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),c.jsx("circle",{cx:"12",cy:"12",r:"3"})]}):c.jsxs(c.Fragment,{children:[c.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),c.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]})})}),L&&T.roundState==="playing"&&c.jsx("button",{className:"end-round-button",onClick:R,"aria-label":"End round",children:"End Round"}),c.jsxs("div",{ref:r,className:"game-container",children:[c.jsx(AM,{width:n.width,height:n.height,scheduledEvents:T.scheduledEvents,activeEvents:T.activeEvents,roundStartTime:T.roundStartTime,roundState:T.roundState,scrollSpeed:T.scrollSpeed,currentFeedback:T.currentFeedback,onChannelTap:P,trainingMode:p,spectrogramMode:S.spectrogram_mode,highContrast:x}),c.jsx("div",{id:"flash-left",className:"channel-flash left"}),c.jsx("div",{id:"flash-right",className:"channel-flash right"}),s&&c.jsx("div",{className:`channel-indicator ${s}`,children:s.toUpperCase()}),T.roundState==="idle"&&c.jsx("div",{className:"start-overlay",children:c.jsx("button",{className:"start-button",onClick:N,disabled:!T.isAudioReady||T.species.length===0,children:T.isAudioReady&&T.species.length>0?"Start Round":"Loading..."})}),T.currentFeedback&&c.jsxs("div",{className:`feedback-overlay ${T.currentFeedback.type} ${T.currentFeedback.channel}`,children:[c.jsxs("div",{className:"feedback-score",children:["+",T.currentFeedback.score]}),c.jsx("div",{className:"feedback-type",children:T.currentFeedback.type.toUpperCase()}),T.currentFeedback.type==="miss"&&T.currentFeedback.expectedSpecies&&c.jsxs("div",{className:"feedback-correct",children:["Was: ",T.currentFeedback.expectedSpecies]})]})]}),c.jsxs("div",{className:"dual-input-panel",children:[c.jsxs("div",{className:"input-column left",children:[c.jsx("div",{className:"column-label",children:"LEFT EAR"}),c.jsx("div",{className:"species-buttons",children:U.map(C=>c.jsx("button",{className:`species-btn ${a===C.code?"selected":""}`,style:{backgroundColor:a===C.code?C.color:void 0},onClick:()=>{A.submitInput(C.code,"left");const B=document.getElementById("flash-left");B&&(B.classList.add("active"),setTimeout(()=>B.classList.remove("active"),150))},disabled:T.roundState!=="playing",children:c.jsx(Ey,{code:C.code,size:36,color:C.color})},C.code))})]}),c.jsxs("div",{className:"input-column right",children:[c.jsx("div",{className:"column-label",children:"RIGHT EAR"}),c.jsx("div",{className:"species-buttons",children:U.map(C=>c.jsx("button",{className:`species-btn ${a===C.code?"selected":""}`,style:{backgroundColor:a===C.code?C.color:void 0},onClick:()=>{A.submitInput(C.code,"right");const B=document.getElementById("flash-right");B&&(B.classList.add("active"),setTimeout(()=>B.classList.remove("active"),150))},disabled:T.roundState!=="playing",children:c.jsx(Ey,{code:C.code,size:36,color:C.color})},C.code))})]})]}),d&&c.jsx("div",{className:"quit-modal-overlay",children:c.jsxs("div",{className:"quit-modal",children:[c.jsx("h3",{style:{margin:0,marginBottom:"16px",fontSize:"20px"},children:"Quit Round?"}),c.jsx("p",{style:{margin:0,marginBottom:"24px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Your progress will not be saved."}),c.jsxs("div",{style:{display:"flex",gap:"12px"},children:[c.jsx("button",{className:"btn-secondary",onClick:j,style:{flex:1,padding:"12px"},children:"Cancel"}),c.jsx("button",{className:"btn-primary",onClick:M,style:{flex:1,padding:"12px",background:"var(--color-error)"},children:"Quit"})]})]})}),c.jsx("style",{children:`
        .gameplay-screen {
          display: flex;
          flex-direction: column;
          height: 100%;
          background-color: var(--color-background);
          overflow: hidden;
        }

        .back-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 8px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-text);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .back-button:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .quit-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 8px;
          width: 40px;
          height: 40px;
          background: rgba(229, 115, 115, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-error);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .quit-button:hover {
          background: rgba(229, 115, 115, 0.5);
        }

        .quit-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        .quit-modal {
          background: var(--color-surface);
          border-radius: 16px;
          padding: 24px;
          max-width: 320px;
          width: 90%;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
          animation: slideUp 0.2s ease-out;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

        .training-toggle {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 56px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: 2px solid transparent;
          border-radius: 50%;
          color: var(--color-text-muted);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: all 0.2s;
        }

        .training-toggle:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .training-toggle.active {
          background: rgba(76, 175, 80, 0.3);
          border-color: rgba(76, 175, 80, 0.6);
          color: #81C784;
        }

        .end-round-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 12px;
          padding: 8px 16px;
          background: rgba(229, 115, 115, 0.8);
          border: none;
          border-radius: 20px;
          color: white;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          z-index: 100;
          transition: background 0.2s;
        }

        .end-round-button:hover {
          background: rgba(229, 115, 115, 1);
        }

        .game-container {
          flex: 1;
          position: relative;
          min-height: 0;
          overflow: hidden;
        }

        .channel-flash {
          position: absolute;
          top: 0;
          bottom: 0;
          width: 50%;
          pointer-events: none;
          background: transparent;
          transition: background 0.1s;
        }

        .channel-flash.left {
          left: 0;
        }

        .channel-flash.right {
          right: 0;
        }

        .channel-flash.active {
          background: rgba(255, 255, 255, 0.1);
        }

        .channel-indicator {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 8px 16px;
          background: var(--color-accent);
          color: var(--color-background);
          font-weight: 700;
          font-size: 14px;
          border-radius: 4px;
          pointer-events: none;
          animation: fadeIn 0.15s ease-out;
        }

        .channel-indicator.left {
          left: 20px;
        }

        .channel-indicator.right {
          right: 20px;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-50%) scale(0.9);
          }
          to {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
        }

        .start-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(0, 0, 0, 0.7);
          z-index: 50;
        }

        .start-button {
          padding: 16px 32px;
          font-size: 18px;
          font-weight: 700;
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: transform 0.2s, background 0.2s;
        }

        .start-button:hover:not(:disabled) {
          transform: scale(1.05);
          background: var(--color-accent);
        }

        .start-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .feedback-overlay {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 12px 20px;
          border-radius: 8px;
          pointer-events: none;
          animation: feedbackPop 0.5s ease-out forwards;
          z-index: 60;
        }

        .feedback-overlay.left {
          left: 20%;
        }

        .feedback-overlay.right {
          right: 20%;
        }

        .feedback-overlay.perfect {
          background: var(--color-success);
        }

        .feedback-overlay.good {
          background: #4CAF50;
        }

        .feedback-overlay.partial {
          background: var(--color-accent);
        }

        .feedback-overlay.miss {
          background: var(--color-error);
          animation: feedbackPopMiss 1.5s ease-out forwards;
        }

        .feedback-score {
          font-family: var(--font-mono);
          font-size: 24px;
          font-weight: 700;
          color: white;
          text-align: center;
        }

        .feedback-type {
          font-size: 12px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          text-align: center;
        }

        .feedback-correct {
          font-size: 14px;
          font-weight: 700;
          color: white;
          text-align: center;
          margin-top: 4px;
          padding-top: 4px;
          border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes feedbackPop {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          20% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          40% {
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-80%) scale(1);
          }
        }

        @keyframes feedbackPopMiss {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          5% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          10% {
            transform: translateY(-50%) scale(1);
          }
          85% {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-70%) scale(1);
          }
        }

        .dual-input-panel {
          display: flex;
          justify-content: space-between;
          padding: 8px 12px;
          padding-bottom: calc(12px + var(--safe-area-bottom, 0px));
          background: linear-gradient(0deg, var(--color-surface) 0%, rgba(26, 26, 46, 0.9) 100%);
          gap: 20px;
        }

        .input-column {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }

        .input-column.left {
          align-items: flex-start;
        }

        .input-column.right {
          align-items: flex-end;
        }

        .column-label {
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          padding: 2px 8px;
          border-radius: 4px;
        }

        .input-column.left .column-label {
          color: #81C784;
          background: rgba(129, 199, 132, 0.15);
        }

        .input-column.right .column-label {
          color: #64B5F6;
          background: rgba(100, 181, 246, 0.15);
        }

        .species-buttons {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
        }

        .input-column.left .species-buttons {
          justify-content: flex-start;
        }

        .input-column.right .species-buttons {
          justify-content: flex-end;
        }

        .species-btn {
          padding: 6px;
          border-radius: 12px;
          border: 2px solid var(--color-text-muted);
          background: var(--color-surface);
          color: var(--color-text);
          font-size: 10px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.15s ease-out;
          touch-action: manipulation;
          -webkit-tap-highlight-color: transparent;
        }

        .species-btn:hover:not(:disabled) {
          transform: scale(1.1);
        }

        .species-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .species-btn.selected {
          color: var(--color-background);
          transform: scale(1.05);
        }

        .species-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }
      `})]})}const K1=b.forwardRef(({score:t,accuracy:e,eventsScored:r,totalEvents:n,maxStreak:i,species:s,packId:o,levelId:a,levelTitle:l,topConfusion:u,usedTrainingMode:h},d)=>{const f=b.useRef(null),[p,m]=b.useState(!1),v=b.useRef(new Map),[_,x]=b.useState(!1),[y,g]=b.useState(!1),w=b.useRef(null);b.useEffect(()=>{(async()=>{const E="/",k=s.map(F=>new Promise((L,U)=>{const P=new Image;P.crossOrigin="anonymous",P.onload=()=>L({code:F.code,img:P}),P.onerror=U,P.src=`${E}data/icons/${F.code}.png`}));try{(await Promise.all(k)).forEach(({code:L,img:U})=>{v.current.set(L,U)}),m(!0)}catch(F){console.error("Failed to load bird icons:",F),m(!0)}})()},[s]),b.useEffect(()=>{(async()=>{const E="/",k=new Image;k.crossOrigin="anonymous",k.onload=()=>{w.current=k,g(!0)},k.onerror=()=>{console.error("Failed to load owl icon"),g(!0)},k.src=`${E}data/icons/OwlHeadphones.png`})()},[]),b.useEffect(()=>{if(!p||!y||!f.current)return;const A=f.current,E=A.getContext("2d");if(!E)return;const k=800,F=800,L=window.devicePixelRatio||1;A.width=k*L,A.height=F*L,A.style.width=`${k}px`,A.style.height=`${F}px`,E.scale(L,L),E.textBaseline="alphabetic";const U=E.createLinearGradient(0,0,0,F);if(U.addColorStop(0,"#f0f4f8"),U.addColorStop(1,"#d9e2ec"),E.fillStyle=U,E.fillRect(0,0,k,F),w.current){E.save(),E.globalAlpha=1;const Q=280,me=k-Q-20,Me=20;E.beginPath(),E.arc(me+Q/2,Me+Q/2,Q/2,0,Math.PI*2),E.clip(),E.drawImage(w.current,me,Me,Q,Q),E.restore()}E.fillStyle="#102a43",E.font="bold 48px -apple-system, system-ui, sans-serif",E.textAlign="center",E.fillText("ChipNotes! ",k/2,80),E.textAlign="left";const P=60;E.font="80px -apple-system, system-ui, sans-serif",E.fillStyle=e>=80?"#6aaa64":e>=60?"#c9b458":"#787c7e",E.fillText("",P,200),E.font="bold 110px -apple-system, system-ui, sans-serif",E.fillText(`${e}%`,P+95,200),E.font="32px -apple-system, system-ui, sans-serif",E.fillStyle="#334e68",E.fillText(`${t} points`,P,245),E.font="22px -apple-system, system-ui, sans-serif",E.fillStyle="#486581",E.fillText(`${r}/${n} birds identified`,P,280),E.textAlign="center",E.font="bold 26px -apple-system, system-ui, sans-serif",E.fillStyle="#d97706",E.fillText(` Best Streak: ${i}`,k/2,320);const D=s.slice(0,4),O=160,M=24,j=D.length*O+(D.length-1)*M,N=(k-j)/2;let R=365;D.forEach((Q,me)=>{const Me=N+me*(O+M),Pe=R,we=v.current.get(Q.code);if(we){E.save(),E.beginPath(),E.arc(Me+O/2,Pe+O/2,O/2,0,Math.PI*2),E.clip();const Se=we.width/we.height;let Ee=O,Ve=O,_t=0,At=0;Se>1?(Ee=O*Se,_t=-(Ee-O)/2):Se<1&&(Ve=O/Se,At=-(Ve-O)/2),E.drawImage(we,Me+_t,Pe+At,Ee,Ve),E.restore(),E.strokeStyle="#d3d6da",E.lineWidth=3,E.beginPath(),E.arc(Me+O/2,Pe+O/2,O/2,0,Math.PI*2),E.stroke(),E.font="22px -apple-system, system-ui, sans-serif",E.fillStyle="#102a43",E.fillText(Q.code,Me+O/2,Pe+O+38)}});const C=R+O+100;if(o&&a){const Q=LM(o);E.font="22px -apple-system, system-ui, sans-serif",E.fillStyle="#486581",E.fillText(`${Q}  Level ${a}`,k/2,C)}const B=s.map(Q=>Q.code).join("  ");E.font="18px -apple-system, system-ui, sans-serif",E.fillStyle="#627d98";const $=700,V=B.split(" ");let ie="",ae=C+32;for(let Q=0;Q<V.length;Q++){const me=ie+V[Q]+" ";E.measureText(me).width>$&&Q>0?(E.fillText(ie.trim(),k/2,ae),ie=V[Q]+" ",ae+=25):ie=me}if(E.fillText(ie.trim(),k/2,ae),h){const Q=ae+35;E.font="18px -apple-system, system-ui, sans-serif",E.fillStyle="#d97706",E.fillText(" Still training. Ready to migrate soon.",k/2,Q)}E.font="bold 26px -apple-system, system-ui, sans-serif",E.fillStyle="#102a43",E.textAlign="center",E.fillText("chipnotes.app",k/2,F-60),E.font="20px -apple-system, system-ui, sans-serif",E.fillStyle="#486581",E.fillText("#chipnotes #birdnerd",k/2,F-30),E.getImageData(0,0,1,1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{x(!0)})})},[p,y,t,e,r,n,i,s,o,a,u,h]);const S=()=>{if(!f.current)return;const A=document.createElement("a");A.download=`chipnotes-${e}pct-${Date.now()}.png`,A.href=f.current.toDataURL("image/png"),A.click()},T=async()=>{if(!f.current||!_)throw new Error("Canvas not ready");const A=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;try{if(A){const E=f.current.toDataURL("image/png"),k=window.open();return k&&(k.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
              <title>ChipNotes Score</title>
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <style>
                body {
                  margin: 0;
                  padding: 20px;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
                  background: #1a1a1a;
                  color: white;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  min-height: 100vh;
                }
                img {
                  max-width: 100%;
                  height: auto;
                  border-radius: 12px;
                  box-shadow: 0 10px 40px rgba(0,0,0,0.5);
                }
                .instructions {
                  margin-top: 20px;
                  padding: 16px;
                  background: rgba(255,255,255,0.1);
                  border-radius: 8px;
                  text-align: center;
                  max-width: 90%;
                }
                .instructions h2 {
                  margin: 0 0 12px 0;
                  font-size: 20px;
                }
                .instructions p {
                  margin: 8px 0;
                  font-size: 16px;
                  opacity: 0.9;
                }
                .highlight {
                  color: #d97706;
                  font-weight: 600;
                }
                .close-btn {
                  position: fixed;
                  top: 20px;
                  left: 20px;
                  width: 48px;
                  height: 48px;
                  border-radius: 50%;
                  background: rgba(255,255,255,0.9);
                  border: 2px solid rgba(0,0,0,0.1);
                  color: #1a1a1a;
                  font-size: 28px;
                  font-weight: bold;
                  cursor: pointer;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  transition: all 0.3s;
                  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                  z-index: 1000;
                }
                .close-btn:hover {
                  background: white;
                  transform: scale(1.1);
                  box-shadow: 0 6px 16px rgba(0,0,0,0.4);
                }
              </style>
            </head>
            <body>
              <button class="close-btn" onclick="window.close(); setTimeout(function() { window.history.back(); }, 100);"></button>
              <img src="${E}" alt="ChipNotes Score">
              <div class="instructions">
                <p> <span class="highlight">Press and hold the image above to share or save</span></p>
              </div>
            </body>
            </html>
          `),k.document.close()),"ios-instructions"}else{const E=await new Promise((F,L)=>{f.current.toBlob(U=>{U?F(U):L(new Error("toBlob failed"))},"image/png",1)}),k=new File([E],"chipnotes-score.png",{type:"image/png"});return navigator.share&&navigator.canShare&&navigator.canShare({files:[k]})?(await navigator.share({title:"ChipNotes! Score",text:`Just identified ${r}/${n} birds with ${e}% accuracy! `,files:[k]}),"shared"):(S(),"downloaded")}}catch(E){return console.error("Share failed:",E),S(),"error-downloaded"}};return b.useImperativeHandle(d,()=>({share:T,download:S,isReady:()=>_}),[_]),c.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px"},children:c.jsx("canvas",{ref:f})})});K1.displayName="ShareCard";function LM(t){return{starter_birds:"Common Backyard",expanded_backyard:"Expanded Backyard",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard"}[t]||t}const Cy=6;function DM(){const t=Xt(),e=b.useRef(null),[r,n]=b.useState(null),[i,s]=b.useState([]),[o,a]=b.useState([]),[l,u]=b.useState(!1),[h,d]=b.useState(!1),[f,p]=b.useState(!1),[m,v]=b.useState(null);b.useEffect(()=>{var U;const L=localStorage.getItem("soundfield_round_results");if(L)try{const P=JSON.parse(L);if(n(P),P.mode==="campaign"&&P.levelId){const D="soundfield_progress",O=JSON.parse(localStorage.getItem(D)||"{}"),M=`level_${P.levelId}`,j=((U=O[M])==null?void 0:U.bestScore)||0;O[M]={completed:!0,bestScore:Math.max(j,P.score),accuracy:P.totalEvents>0?Math.round(P.eventsScored/P.totalEvents*100):0},localStorage.setItem(D,JSON.stringify(O))}const I=[];for(const D of P.species){const O=P.speciesResults[D.code]||{total:0,correct:0};O.total>0&&I.push({code:D.code,name:D.name,total:O.total,correct:O.correct,accuracy:Math.round(O.correct/O.total*100)})}if(I.sort((D,O)=>D.accuracy-O.accuracy),s(I),P.confusionData&&P.confusionData.length>0){const D=new Map;for(const M of P.confusionData){if(M.guessedSpecies===M.expectedSpecies)continue;const j=`${M.expectedSpecies}|${M.guessedSpecies??"MISS"}`;D.set(j,(D.get(j)||0)+1)}const O=[];for(const[M,j]of D.entries()){const[N,R]=M.split("|");O.push({expectedSpecies:N,guessedSpecies:R==="MISS"?null:R,count:j})}O.sort((M,j)=>j.count-M.count),a(O)}}catch(P){console.error("Failed to parse round results:",P)}},[]);const _=r&&r.totalEvents>0?Math.round(r.eventsScored/r.totalEvents*100):0,x=(r==null?void 0:r.mode)==="campaign",y=(r==null?void 0:r.levelId)||1,g=(r==null?void 0:r.packId)||"starter_birds",w=y>1,S=y<Cy,T=L=>{if(r!=null&&r.species){const U=r.species.map(P=>P.code);sessionStorage.setItem("roundSpecies",JSON.stringify(U))}t(`/preview?pack=${g}&level=${L}&keepBirds=true`)},A=()=>{t(`/level-select?pack=${g}`)},E=()=>{t("/pack-select")},k=()=>{t("/")};b.useEffect(()=>{const L=setInterval(()=>{var U;(U=e.current)!=null&&U.isReady()&&(p(!0),clearInterval(L))},100);return()=>clearInterval(L)},[r]);const F=async()=>{if(e.current){d(!0),v(null);try{await e.current.share()==="ios-instructions"&&(v("Follow instructions in new tab to save & share! "),setTimeout(()=>v(null),5e3))}catch(L){console.error("Share failed:",L),v("Share failed. Please try again."),setTimeout(()=>v(null),3e3)}finally{d(!1)}}};return c.jsxs("div",{className:"screen",style:{paddingTop:"32px",paddingBottom:"calc(24px + var(--safe-area-bottom, 0px))"},children:[c.jsx("h1",{style:{textAlign:"center",marginBottom:"8px"},children:"ROUND COMPLETE"}),x&&c.jsxs("p",{className:"text-muted",style:{textAlign:"center",marginBottom:"16px"},children:["Level ",y,": ",(r==null?void 0:r.levelTitle)||"Campaign"]}),c.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto 16px"},children:[c.jsxs("button",{className:"btn-primary",onClick:F,disabled:h||!r||!f,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx(zM,{}),h?"Generating...":f?"Share Your Score":"Preparing..."]}),c.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",textAlign:"center",marginTop:"8px",marginBottom:"0",fontStyle:"italic"},children:"Let them Wordle, you already know how to spell."}),m&&c.jsx("p",{style:{fontSize:"14px",color:"var(--color-accent)",textAlign:"center",marginTop:"8px",marginBottom:"0",fontWeight:600,animation:"fadeIn 0.3s ease"},children:m})]}),r&&c.jsx(K1,{ref:e,score:r.score,accuracy:_,eventsScored:r.eventsScored,totalEvents:r.totalEvents,maxStreak:r.maxStreak,species:r.species,packId:r.packId,levelId:r.levelId,levelTitle:r.levelTitle,usedTrainingMode:r.usedTrainingMode,topConfusion:o.length>0&&o[0].guessedSpecies?{from:o[0].expectedSpecies,to:o[0].guessedSpecies}:null}),c.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[c.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[c.jsx("span",{children:"Score"}),c.jsx("span",{className:"text-accent",style:{fontFamily:"var(--font-mono)",fontSize:"24px"},children:(r==null?void 0:r.score)||0})]}),c.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[c.jsx("span",{children:"Birds Identified"}),c.jsxs("span",{children:[(r==null?void 0:r.eventsScored)||0," / ",(r==null?void 0:r.totalEvents)||0]})]}),c.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[c.jsx("span",{children:"Overall Accuracy"}),c.jsxs("span",{className:_>=70?"text-success":_>=50?"text-accent":"text-error",children:[_,"%"]})]}),c.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[c.jsx("span",{children:"Perfect Hits"}),c.jsx("span",{className:"text-success",children:(r==null?void 0:r.perfectCount)||0})]}),c.jsxs("div",{className:"flex-row justify-between",children:[c.jsx("span",{children:"Best Streak"}),c.jsx("span",{children:(r==null?void 0:r.maxStreak)||0})]}),(r==null?void 0:r.usedTrainingMode)&&c.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid var(--color-surface)",fontSize:"13px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),c.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"Training Mode was used"]})]}),i.length>0&&c.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Species Breakdown"}),i.map(L=>c.jsxs("div",{style:{marginBottom:"12px"},children:[c.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[c.jsxs("span",{style:{fontSize:"14px"},children:[L.code," ",c.jsxs("span",{className:"text-muted",children:["(",L.name,")"]})]}),c.jsxs("span",{style:{fontSize:"14px"},children:[L.correct,"/",L.total," (",L.accuracy,"%)"]})]}),c.jsx("div",{style:{height:"8px",backgroundColor:"var(--color-background)",borderRadius:"4px",overflow:"hidden"},children:c.jsx("div",{style:{width:`${L.accuracy}%`,height:"100%",backgroundColor:L.accuracy>=80?"var(--color-success)":L.accuracy>=50?"var(--color-accent)":"var(--color-error)",borderRadius:"4px",transition:"width 0.3s ease"}})})]},L.code))]}),o.length>0&&c.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Confusion Summary"}),o.map((L,U)=>c.jsx("div",{style:{marginBottom:"8px",fontSize:"14px"},children:L.guessedSpecies===null?c.jsxs("span",{children:["Missed ",c.jsx("span",{className:"text-accent",children:L.expectedSpecies}),": ",L.count,"x"]}):c.jsxs("span",{children:[c.jsx("span",{className:"text-accent",children:L.expectedSpecies}),"  ",c.jsx("span",{className:"text-error",children:L.guessedSpecies}),": ",L.count,"x"]})},U))]}),c.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto"},children:[x&&c.jsxs("div",{className:"flex-row gap-md",style:{marginBottom:"12px"},children:[c.jsxs("button",{className:"btn-secondary",onClick:()=>T(y-1),disabled:!w,style:{flex:1,opacity:w?1:.4},children:[c.jsx(OM,{})," Prev"]}),c.jsxs("button",{className:"btn-secondary",onClick:()=>u(!l),style:{flex:1},children:["Level ",y,"/",Cy]}),c.jsxs("button",{className:"btn-secondary",onClick:()=>T(y+1),disabled:!S,style:{flex:1,opacity:S?1:.4},children:["Next ",c.jsx(UM,{})]})]}),l&&c.jsxs("div",{className:"card",style:{marginBottom:"12px",padding:"12px"},children:[c.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginBottom:"8px"},children:"Jump to level:"}),c.jsx("div",{className:"flex-row",style:{flexWrap:"wrap",gap:"8px"},children:[1,2,3,4,5,6].map(L=>c.jsx("button",{onClick:()=>{u(!1),T(L)},style:{width:"40px",height:"40px",borderRadius:"8px",border:L===y?"2px solid var(--color-accent)":"1px solid var(--color-text-muted)",background:L===y?"var(--color-accent)":"var(--color-surface)",color:L===y?"var(--color-background)":"var(--color-text)",fontWeight:600,cursor:"pointer"},children:L},L))})]}),c.jsxs("div",{className:"flex-col gap-md",children:[c.jsx("button",{className:"btn-primary",onClick:()=>T(y),style:{width:"100%"},children:"Play Again"}),c.jsxs("div",{className:"flex-row gap-md",children:[c.jsx("button",{className:"btn-secondary",onClick:A,style:{flex:1},children:"Levels"}),c.jsx("button",{className:"btn-secondary",onClick:E,style:{flex:1},children:"Packs"}),c.jsx("button",{className:"btn-secondary",onClick:k,style:{flex:1},children:"Home"})]})]})]})]})}function OM(){return c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"4px"},children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}function UM(){return c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"4px"},children:c.jsx("path",{d:"M9 18l6-6-6-6"})})}function zM(){return c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("circle",{cx:"18",cy:"5",r:"3"}),c.jsx("circle",{cx:"6",cy:"12",r:"3"}),c.jsx("circle",{cx:"18",cy:"19",r:"3"}),c.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),c.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]})}const Er={SCROLL_SPEED:"soundfield_scroll_speed",SPECTROGRAM_MODE:"soundfield_spectrogram_mode",HIGH_CONTRAST:"soundfield_high_contrast",CONTINUOUS_PLAY:"soundfield_continuous_play",COOKIE_CONSENT:"chipnotes_cookie_consent"};function GM(){const t=Xt(),e=Qn(),[r,n]=b.useState(()=>localStorage.getItem(Er.SPECTROGRAM_MODE)||"full"),[i,s]=b.useState(()=>{const m=localStorage.getItem(Er.SCROLL_SPEED);return m?parseFloat(m):.5}),[o,a]=b.useState(()=>localStorage.getItem(Er.HIGH_CONTRAST)==="true"),[l,u]=b.useState(()=>localStorage.getItem(Er.CONTINUOUS_PLAY)==="true"),[h,d]=b.useState(()=>localStorage.getItem(Er.COOKIE_CONSENT)==="accepted");b.useEffect(()=>{localStorage.setItem(Er.SPECTROGRAM_MODE,r)},[r]),b.useEffect(()=>{localStorage.setItem(Er.SCROLL_SPEED,i.toString())},[i]),b.useEffect(()=>{localStorage.setItem(Er.HIGH_CONTRAST,o.toString())},[o]),b.useEffect(()=>{localStorage.setItem(Er.CONTINUOUS_PLAY,l.toString())},[l]);const f=m=>{d(m),localStorage.setItem(Er.COOKIE_CONSENT,m?"accepted":"declined"),alert(m?"Analytics enabled. Please refresh the page for changes to take effect.":"Analytics disabled. Please refresh the page for changes to take effect.")},p=()=>{confirm("This will delete ALL your progress, settings, and custom packs. This cannot be undone. Are you sure?")&&(localStorage.clear(),"caches"in window&&caches.keys().then(v=>{v.forEach(_=>{caches.delete(_)})}),alert("All data has been deleted. The app will now reload."),window.location.href=window.location.origin+"/")};return c.jsxs("div",{className:"screen",children:[c.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[c.jsxs("button",{className:"btn-secondary",onClick:()=>{var m;return(m=e.state)!=null&&m.fromPackSelect?t("/pack-select"):t(-1)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 16px",background:"var(--color-accent)",color:"white",border:"none",fontWeight:600},children:[c.jsx(HM,{}),"Back"]}),c.jsx("h2",{style:{margin:0},children:"Settings"})]}),c.jsxs("div",{className:"flex-col gap-lg",children:[c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:"Spectrogram Mode"}),c.jsx("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:"Visual difficulty setting"}),c.jsx("div",{className:"flex-row gap-sm",children:["full","fading","none"].map(m=>c.jsx("button",{className:r===m?"btn-primary":"btn-secondary",onClick:()=>n(m),style:{flex:1,textTransform:"capitalize"},children:m},m))})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:"Scroll Speed"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:["How fast tiles move: ",i.toFixed(1),"x"]}),c.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:i,onChange:m=>s(parseFloat(m.target.value)),style:{width:"100%"}})]}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex-row justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h3",{style:{marginBottom:"4px"},children:"High Contrast"}),c.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Enhanced visibility"})]}),c.jsx("button",{className:o?"btn-primary":"btn-secondary",onClick:()=>a(!o),style:{width:"60px"},children:o?"ON":"OFF"})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex-row justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h3",{style:{marginBottom:"4px"},children:"Continuous Play"}),c.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"No timer - play until all clips done"})]}),c.jsx("button",{className:l?"btn-primary":"btn-secondary",onClick:()=>u(!l),style:{width:"60px"},children:l?"ON":"OFF"})]})}),c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex-row justify-between items-center",style:{marginBottom:"8px"},children:[c.jsx("div",{children:c.jsx("h3",{style:{marginBottom:"0"},children:"Analytics"})}),c.jsx("button",{className:h?"btn-primary":"btn-secondary",onClick:()=>f(!h),style:{width:"60px"},children:h?"ON":"OFF"})]}),c.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"I know I'm a stranger, but please accept my cookies! Analytics help me understand how many players I have, which birds everyone loves, and what features are most useful. I promise I'm just adding bird nerds to my LIFE LIST, not stalking you. Your IP is anonymized, no personal data collected, full GDPR/CCPA compliance."})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"8px"},children:"Privacy Policy"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["Learn about how your privacy is protected, what data is collected, and your rights."," ",c.jsx("button",{onClick:()=>t("/privacy"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Privacy Policy "})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"8px"},children:"How to Play"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["New to ChipNotes? Learn about gameplay, scoring, packs, and tips."," ",c.jsx("button",{onClick:()=>t("/help"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Help Guide "})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"8px"},children:"Feedback & Bug Reports"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["Found a bug? Have a feature idea? Email me at"," ",c.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]}),c.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:[c.jsx("span",{style:{color:"var(--color-text)"},children:"Have a bird sound on your phone that you think should be in the game?"})," Send it to me! I'll add it and give you credit in the app."]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"8px"},children:"Support This Project"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["ChipNotes is free, open source, and built as a passion project. If it's helped you level-up your birding skills, consider"," ",c.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"supporting development"})," ","- your donations help me add new species, add features, and do more birding. Now, you go build something cool - it might be easier than you think! ;)"]}),c.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:"Please also consider supporting the organizations that make this possible, and tell them ChipNotes! sent you:"}),c.jsxs("ul",{style:{fontSize:"13px",lineHeight:"1.5",color:"var(--color-text-muted)",marginBottom:"12px"},children:[c.jsxs("li",{style:{marginBottom:"8px"},children:[c.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.birds.cornell.edu/home/support/"})," ","- Incredible bird sound archive"]}),c.jsxs("li",{children:[c.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://xeno-canto.org/about/donate"})," ","- Community-driven bird recording database"]})]}),c.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"Thank you for learning with me! "})]}),c.jsx("div",{className:"card",children:c.jsx("button",{className:"btn-secondary",onClick:p,style:{width:"100%",color:"var(--color-error)"},children:"Reset All Progress"})})]})]})}function HM(){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}const dl=[{code:"NOCA",name:"Northern Cardinal",accuracy:92,attempts:45},{code:"BLJA",name:"Blue Jay",accuracy:88,attempts:38},{code:"CARW",name:"Carolina Wren",accuracy:76,attempts:29},{code:"AMCR",name:"American Crow",accuracy:95,attempts:22},{code:"TUTI",name:"Tufted Titmouse",accuracy:71,attempts:18}];function WM(){const t=Xt(),e=Math.round(dl.reduce((r,n)=>r+n.accuracy,0)/dl.length);return c.jsxs("div",{className:"screen",children:[c.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[c.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:c.jsx($M,{})}),c.jsx("h2",{style:{margin:0},children:"Progress"})]}),c.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"linear-gradient(135deg, rgba(245, 166, 35, 0.15) 0%, rgba(245, 166, 35, 0.05) 100%)",border:"2px solid var(--color-accent)",borderRadius:"12px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:700,color:"var(--color-accent)",marginBottom:"4px"},children:" Coming Soon! "}),c.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.4},children:"Real stats tracking is in development. The data below is a preview of what's coming!"})]}),c.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[c.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Demo Data"}),c.jsxs("div",{className:"flex-row justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Overall Accuracy"}),c.jsxs("div",{style:{fontSize:"32px",fontWeight:700},className:"text-success",children:[e,"%"]})]}),c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Total Attempts"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:600},children:dl.reduce((r,n)=>r+n.attempts,0)})]})]})]}),c.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[c.jsx("h3",{style:{margin:0},children:"This Session"}),c.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),c.jsxs("div",{className:"flex-row justify-between",style:{marginTop:"12px"},children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Rounds"}),c.jsx("div",{style:{fontSize:"20px"},children:"5"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Score"}),c.jsx("div",{style:{fontSize:"20px"},className:"text-accent",children:"12,450"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Best Streak"}),c.jsx("div",{style:{fontSize:"20px"},children:"18"})]})]})]}),c.jsxs("div",{className:"card",style:{opacity:.7},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h3",{style:{margin:0},children:"Species Accuracy"}),c.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),dl.map(r=>c.jsxs("div",{style:{marginBottom:"12px"},children:[c.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[c.jsxs("span",{style:{fontSize:"14px"},children:[r.code," ",c.jsxs("span",{className:"text-muted",children:["(",r.attempts,")"]})]}),c.jsxs("span",{style:{fontSize:"14px"},className:r.accuracy>=80?"text-success":r.accuracy>=60?"text-accent":"text-error",children:[r.accuracy,"%"]})]}),c.jsx("div",{style:{height:"6px",backgroundColor:"var(--color-background)",borderRadius:"3px",overflow:"hidden"},children:c.jsx("div",{style:{width:`${r.accuracy}%`,height:"100%",backgroundColor:r.accuracy>=80?"var(--color-success)":r.accuracy>=60?"var(--color-accent)":"var(--color-error)",borderRadius:"3px"}})})]},r.code))]}),c.jsx("div",{className:"card",style:{marginTop:"24px",opacity:.7},children:c.jsx("button",{className:"btn-secondary",style:{width:"100%",cursor:"not-allowed"},disabled:!0,children:"View Confusion Matrix (Coming Soon)"})})]})}function $M(){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}function VM(){var v;const t=Xt(),e=Qn(),r=["Why Learn Bird Song?","The Basics","Scoring"];(v=e.state)!=null&&v.openVersionHistory&&r.push("Version History"),e.hash==="#training-mode"&&r.push("Training Mode");const[n,i]=b.useState(new Set(r)),[s,o]=b.useState(!1),a=b.useRef(null),l=b.useRef(null),u=b.useRef(!1),h=["Why Learn Bird Song?","The Basics","Scoring","The Packs","The Levels","Tips","Training Mode","Taxonomic Sorting","The 4-Letter Codes","The Spectrograms","About & Credits","Support This Project","Feedback & Bug Reports","Version History"],d=_=>{const x=new Set(n);x.has(_)?x.delete(_):x.add(_),i(x)},f=()=>{n.size===h.length?i(new Set):i(new Set(h))},p=n.size===h.length;b.useEffect(()=>{const _=()=>{!s&&a.current&&a.current.scrollTop>0&&o(!0)},x=a.current;if(x)return x.addEventListener("scroll",_),()=>x.removeEventListener("scroll",_)},[s]),b.useEffect(()=>{var _;(_=e.state)!=null&&_.openVersionHistory&&l.current&&setTimeout(()=>{var x;(x=l.current)==null||x.scrollIntoView({behavior:"smooth",block:"start"})},100)},[e.state]),b.useEffect(()=>{e.hash==="#training-mode"&&!u.current&&(u.current=!0,setTimeout(()=>{const _=document.getElementById("training-mode");_&&_.scrollIntoView({behavior:"smooth",block:"start"})},100))},[e.hash]);const m=()=>{var _;(_=a.current)==null||_.scrollTo({top:0,behavior:"smooth"})};return c.jsxs("div",{ref:a,className:"screen",style:{paddingBottom:"32px",position:"relative"},children:[c.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[c.jsx("button",{className:"btn-icon",onClick:()=>{var _;return(_=e.state)!=null&&_.fromPackSelect?t("/pack-select"):t(-1)},"aria-label":"Back",children:c.jsx(XM,{})}),c.jsx("h2",{style:{margin:0},children:"How to Play"})]}),c.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[c.jsxs(Pt,{title:"Why Learn Bird Song?",isExpanded:n.has("Why Learn Bird Song?"),onToggle:()=>d("Why Learn Bird Song?"),children:[c.jsxs("p",{style:{marginBottom:"12px"},children:["Birds are ",c.jsx("em",{children:"heard"})," way more often than they're ",c.jsx("em",{children:"seen"}),". Once you know the songs, you'll know what to look for - and suddenly your backyard becomes way more interesting."]}),c.jsxs("p",{style:{marginBottom:"12px"},children:[c.jsx("strong",{children:"Why the left/right thing?"}),` It feels like a hearing test because that's birding! In the field, you're constantly triangulating: "Cardinal to my left, chickadee to my right, warbler... somewhere up there?" This game mimics that chaos. Plus, training your ears to separate simultaneous sounds - like a pianist controlling both hands independently - dramatically sharpens your birding skills.`]}),c.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsx("strong",{children:"Need real-time ID?"})," Get Cornell's free ",c.jsx("a",{href:"https://merlin.allaboutbirds.org/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"Merlin app"}),` - it's magic for "what bird is that singing `,c.jsx("em",{children:"right now"}),'?"']})]}),c.jsxs(Pt,{title:"The Basics",isExpanded:n.has("The Basics"),onToggle:()=>d("The Basics"),children:[c.jsx("p",{style:{marginBottom:"12px"},children:c.jsx("strong",{children:"Listen. Identify. Tap."})}),c.jsx("p",{style:{marginBottom:"12px"},children:"Bird sounds play through your left or right ear. Identify which bird is singing and tap its circle on the correct side before the tile passes the scoring zone."}),c.jsx("p",{style:{marginBottom:"12px"},children:"Each round is 30 seconds. Use headphones for the best experience - unless you want everyone to know you're a bird nerd!"}),c.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsx("strong",{children:"Mobile tip:"}),' For fullscreen play on iOS, use Safari. On Android Chrome, tap   "Add to Home screen" and launch from the icon.']})]}),c.jsxs(Pt,{title:"Scoring",isExpanded:n.has("Scoring"),onToggle:()=>d("Scoring"),children:[c.jsx(fl,{label:"Perfect",points:100,description:"Right bird + right ear + great timing",color:"var(--color-success)"}),c.jsx(fl,{label:"Good",points:75,description:"Right bird + right ear",color:"var(--color-success)"}),c.jsx(fl,{label:"Partial",points:25,description:"Right bird, wrong ear",color:"var(--color-accent)"}),c.jsx(fl,{label:"Miss",points:0,description:"Wrong bird or no response",color:"var(--color-error)"})]}),c.jsxs(Pt,{title:"The Packs",isExpanded:n.has("The Packs"),onToggle:()=>d("The Packs"),children:[c.jsx(Yi,{name:"Eastern Backyard Birds",description:"Perfect for beginners. Six distinctive birds you'll hear in your own backyard: American Crow (AMCR), American Robin (AMRO), Blue Jay (BLJA), Carolina Wren (CARW), Northern Cardinal (NOCA), and Tufted Titmouse (TUTI)."}),c.jsx(Yi,{name:"Expanded Eastern US Birds",description:"39 species from the eastern US. Nine birds are selected randomly, and you can shuffle for a new set anytime from the preview screen."}),c.jsx(Yi,{name:"Sparrows",description:"Master the subtle singers! Eight sparrow species with distinctive patterns: White-throated, Song, Chipping, Swamp, Savannah, Field, Lincoln's, and White-crowned."}),c.jsx(Yi,{name:"Woodpeckers",description:"Drums, rattles, and calls. Learn seven species: Downy, Hairy, Red-bellied, Pileated, Yellow-bellied Sapsucker, Northern Flicker, and Red-headed."}),c.jsx(Yi,{name:"Western Backyard Birds",description:"14 common backyard species from western North America: Steller's Jay, Western Scrub-Jay, Black-capped Chickadee, White-crowned Sparrow, Cassin's Finch, Pine Siskin, Evening Grosbeak, and more."}),c.jsx(Yi,{name:"Warbler Academy",description:"For experts! 33 wood-warbler species with their high-pitched, buzzy songs. Nine warblers are selected randomly - shuffle for a new set anytime."}),c.jsxs("p",{style:{marginTop:"16px",fontSize:"13px",color:"var(--color-text-muted)",fontStyle:"italic"},children:["There are 11,000 birds out there, so more are coming soon. Send your suggestions to"," ",c.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"}),"!"]})]}),c.jsxs(Pt,{title:"The Levels",isExpanded:n.has("The Levels"),onToggle:()=>d("The Levels"),children:[c.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Each pack has 6 levels that build your skills:"}),c.jsx(Ki,{level:1,title:"Meet the Birds",description:"One clear recording per bird, single ear. Learn each signature voice."}),c.jsx(Ki,{level:2,title:"Sound Variations",description:"Up to 3 recordings per bird. Same species, different songs."}),c.jsx(Ki,{level:3,title:"Full Repertoire",description:"All recordings in play. Master every variation."}),c.jsx(Ki,{level:4,title:"Both Ears",description:"Sounds from either side. Identify the bird AND the direction."}),c.jsx(Ki,{level:5,title:"Variations + Both Ears",description:"Multiple recordings, either ear. Getting challenging!"}),c.jsx(Ki,{level:6,title:"Master Birder",description:"Everything at once. You're a pro now."})]}),c.jsxs(Pt,{title:"Tips",isExpanded:n.has("Tips"),onToggle:()=>d("Tips"),children:[c.jsx(qi,{children:"Start with the 6 common birds, even if you're eager for more."}),c.jsxs(qi,{children:["Use"," ",c.jsx(ra,{to:"/pack-select#bird-reference",state:{fromHelp:!0},style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Bird Reference"})," ","to preview all sounds included in the game."]}),c.jsx(qi,{children:"Your birds stay the same between rounds. Hit the shuffle button on the preview screen for a fresh set."}),c.jsx(qi,{children:"Don't rush. Let the sound register before you tap."}),c.jsx(qi,{children:"Check the round summary and confusion matrix to see which birds need practice."}),c.jsx(qi,{children:"Adjust tile speed in Settings if things move too fast (or too slow). Once you're an expert, try playing muted using only spectrograms!"})]}),c.jsxs(Pt,{id:"training-mode",title:"Training Mode",isExpanded:n.has("Training Mode"),onToggle:()=>d("Training Mode"),children:[c.jsxs("p",{children:["Toggle the ",c.jsx("strong",{children:"eye icon"})," (next to the back button) during gameplay to enable Training Mode."]}),c.jsx("p",{children:"When active, each tile shows its bird icon and species code alongside the spectrogram. Use this to learn which spectrograms belong to which birds, then toggle off to challenge yourself!"}),c.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[c.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(76, 175, 80, 0.3)",border:"2px solid rgba(76, 175, 80, 0.6)",borderRadius:"50%",color:"#81C784"},children:c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),c.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),c.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Eye icon glows green when Training Mode is ON"})]})]}),c.jsxs(Pt,{title:"Taxonomic Sorting",isExpanded:n.has("Taxonomic Sorting"),onToggle:()=>d("Taxonomic Sorting"),children:[c.jsx("p",{children:"Toggle taxonomic sorting on the preview screen to see birds in phylogenetic order with scientific names - perfect for learning evolutionary relationships! "}),c.jsxs("p",{style:{marginTop:"12px"},children:["When enabled, birds are sorted by their position on the evolutionary tree (using the 2025 eBird/AOS taxonomy) instead of alphabetically. Common names are replaced with ",c.jsx("em",{children:"scientific names in italics"}),"."]}),c.jsx("p",{style:{marginTop:"12px"},children:"This sorting also applies to the species buttons during gameplay, helping you build taxonomic muscle memory as you learn."}),c.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[c.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(100, 181, 246, 0.3)",border:"2px solid rgba(100, 181, 246, 0.6)",borderRadius:"50%",color:"#64B5F6"},children:c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),c.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),c.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),c.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})}),c.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Toggle glows blue when Taxonomic Sorting is ON"})]})]}),c.jsxs(Pt,{title:"The 4-Letter Codes",isExpanded:n.has("The 4-Letter Codes"),onToggle:()=>d("The 4-Letter Codes"),children:[c.jsx("p",{children:`Birders use standardized 4-letter codes (called "Alpha codes") as shorthand for species names. They're easy to learn:`}),c.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"8px",fontSize:"14px",lineHeight:1.6},children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Two-word names:"})," First 2 letters of each word"]}),c.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Northern Cardinal  NO + CA  NOCA"}),c.jsxs("div",{style:{marginTop:"8px"},children:[c.jsx("strong",{children:"Three-word names:"})," 1 + 1 + 2 letters"]}),c.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Red-bellied Woodpecker  R + B + WO  RBWO"}),c.jsxs("div",{style:{marginTop:"12px",fontStyle:"italic",color:"var(--color-text-muted)"},children:["There ",c.jsx("a",{href:"https://www.birdpop.org/pages/birdSpeciesCodes.php",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"are exceptions"}),". Because, ornithology."]})]})]}),c.jsxs(Pt,{title:"The Spectrograms",isExpanded:n.has("The Spectrograms"),onToggle:()=>d("The Spectrograms"),children:[c.jsx("p",{children:"The colorful images on tiles are spectrograms - visual pictures of sound. Time flows left to right, pitch goes bottom to top, and brightness shows volume."}),c.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"14px"},children:"With practice, you'll recognize birds by their visual patterns too!"})]}),c.jsxs(Pt,{title:"About & Credits",isExpanded:n.has("About & Credits"),onToggle:()=>d("About & Credits"),children:[c.jsxs("div",{style:{textAlign:"center",marginBottom:"16px"},children:[c.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"   "}),c.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:"Created by Peter Repetti"}),c.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:"Made with love by bird nerds, for bird nerds"})]}),c.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:[c.jsxs("p",{style:{marginBottom:"12px"},children:[c.jsx("strong",{style:{color:"var(--color-accent)"},children:"Bird sounds:"})," Sourced from"," ",c.jsx("a",{href:"https://xeno-canto.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Xeno-Canto"}),", the"," ",c.jsx("a",{href:"https://www.macaulaylibrary.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Cornell Macaulay Library"})," ","and from user contributions. All sound clips have attribution with XC catalog numbers and recordist names in the Bird Reference (expand any species on the"," ",c.jsx(ra,{to:"/pack-select#bird-reference",state:{fromHelp:!0},style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Pack Select"})," ","screen)."]}),c.jsxs("p",{style:{marginBottom:"12px"},children:[c.jsx("strong",{style:{color:"var(--color-accent)"},children:"The Tech:"})," Built by Claude Code with TypeScript, React, and PixiJS for buttery-smooth scrolling spectrograms. The Web Audio API handles sample-accurate playback with real-time stereo panning - your browser decodes and buffers audio into memory for zero-latency triggering. Vite bundles it all into a PWA (Progressive Web App) that caches sounds as you play them - so load up those birds before your flight to New Zealand takes off ."]}),c.jsxs("p",{style:{marginBottom:"12px"},children:[c.jsx("strong",{style:{color:"var(--color-accent)"},children:"Special thanks:"})," To the global birding community for sharing these recordings."]}),c.jsx("p",{style:{marginTop:"16px",fontSize:"13px",fontStyle:"italic"},children:"Good birding! "})]})]}),c.jsxs(Pt,{title:"Support This Project",isExpanded:n.has("Support This Project"),onToggle:()=>d("Support This Project"),children:[c.jsxs("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:["ChipNotes is free, open source, and built as a passion project. If it's helped you level-up your birding skills, consider"," ",c.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"supporting development"})," ","- your donations help me add new species, add features, and do more birding. Now, you go build something cool - it might be easier than you think! ;)"]}),c.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"8px",fontWeight:600},children:"Please also consider supporting the organizations that make this possible, and tell them ChipNotes! sent you:"}),c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"var(--color-text-muted)",lineHeight:1.8},children:[c.jsxs("li",{children:[c.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.birds.cornell.edu/home/support/"})," ","- Incredible bird sound archive"]}),c.jsxs("li",{children:[c.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://xeno-canto.org/about/donate"})," ","- Community-driven bird recording database"]})]}),c.jsx("p",{style:{marginTop:"16px",fontSize:"14px",fontStyle:"italic",color:"var(--color-text-muted)"},children:"Thank you for learning with me! "})]}),c.jsxs(Pt,{title:"Feedback & Bug Reports",isExpanded:n.has("Feedback & Bug Reports"),onToggle:()=>d("Feedback & Bug Reports"),children:[c.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:"I'd love to hear from you! Found a bug? Have a feature suggestion? Want to share your experience?"}),c.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px",marginBottom:"12px"},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" Email"}),c.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"feedback@chipnotes.app"})]}),c.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px"},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" GitHub Issues"}),c.jsx("a",{href:"https://github.com/chrysogonum/bird-sound-game/issues",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"github.com/chrysogonum/bird-sound-game/issues"})]})]}),c.jsx("div",{ref:l,children:c.jsxs(Pt,{title:"Version History",isExpanded:n.has("Version History"),onToggle:()=>d("Version History"),children:[c.jsx(Ae,{version:"3.38",date:"January 20, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Taxonomy Migration:"})," Updated all bird species codes to 2025 AOS/IBP taxonomy - migrated 5 codes (AMGOAGOL, CEWACEDW, SASPSAVS, WESJCASJ, EWPEEAWP) and fixed species names to match current ornithological standards"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Data Audit System:"})," Added comprehensive species data validation tools to ensure 100% consistency between game data and the authoritative IBP-AOS-list25.csv taxonomy reference"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Bug Fix:"})," Fixed taxonomic sort toggle re-shuffling birds on preview screen - now correctly re-orders existing birds without selecting new random ones"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Preview Screen Redesign:"}),' Completely overhauled "Ready to Play" page for better space efficiency - compact header, side-by-side toggles, larger bird grid visibility, and new tip box explaining grid positions']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Training Mode Visual Update:"})," Training mode toggle now highlights in green (instead of orange) for better visual distinction from other controls"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Sort Button Clarity:"}),' Alphabetical sort now displays as "Sort" by default, switching to "Taxonomic " when phylogenetic ordering is active']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Bird Reference Quick Access:"}),` Added  book icon button on preview screen that jumps directly to the pack's Bird Reference section with auto-expansion - includes "Ready to Play?" button for easy return`]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Help Page Navigation:"}),' Added paired navigation buttons in bottom-right corner: green " Top" for scroll-to-top and orange "Expand/Collapse All" for section management']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Preview Instructions:"}),' Updated preview text to "Tap to preview signature song. Press and hold to get a closer look!" for clearer user guidance']})]})}),c.jsx(Ae,{version:"3.37",date:"January 19, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Help Documentation:"}),' Added dedicated "Taxonomic Sorting" section to Help page - explains phylogenetic ordering, scientific name display, and how the feature works during gameplay']}),c.jsxs("li",{children:[c.jsx("strong",{children:"README Update:"})," Fixed Eastern Backyard Birds species count (56, added Robin) and updated version number"]})]})}),c.jsx(Ae,{version:"3.36",date:"January 19, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Taxonomic Sort Toggle:"})," Added taxonomic/alphabetical sort toggle to pre-round preview screen - when enabled, shows birds in phylogenetic order with scientific names (italicized) instead of common names "]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Button Sort Persistence:"})," Species buttons during gameplay now respect taxonomic sort preference, making it easier for taxonomically-inclined players to build muscle memory"]})]})}),c.jsx(Ae,{version:"3.35",date:"January 19, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"2025 AOS Taxonomy:"})," Updated all 86 species to official 2025 American Ornithological Society (66th Supplement) taxonomic positions - fixes phylogenetic ordering across all families, especially warblers (Swainson's Warbler now correctly appears before Setophaga radiation)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Scientific Names Fix:"})," Corrected numerous errors in displayed scientific names - WEWA now shows ",c.jsx("em",{children:"Helmitheros vermivorum"})," (not ",c.jsx("em",{children:"Setophaga pensylvanica"}),"!), plus 13+ other species fixed to match 2025 AOS data"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Species Data File:"})," Added comprehensive species.json with common names, scientific names, genus, species epithet, and taxonomic order for all birds - auto-generated from authoritative IBP-AOS-list25.csv"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Custom Pack Builder Icons:"})," Replaced generic circles with cute illustrated bird icon images - makes custom pack building more visual and fun!"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Data Source:"})," All taxonomy from The Institute for Bird Populations' official 2025 AOS list (2352 taxa) - scientifically accurate and up-to-date"]})]})}),c.jsx(Ae,{version:"3.34",date:"January 19, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Scientific Names:"})," Bird Reference now shows scientific names (italicized) below common names when sorted taxonomically - perfect for learning phylogenetic relationships!"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Pack Select UX:"}),' Enhanced grasshopper sparrow joke to read "6 levels/packstart @ #1,  sparrow" - more punchy and visual']}),c.jsxs("li",{children:[c.jsx("strong",{children:"OCWA Clips:"})," Added 7 new Orange-crowned Warbler clips from Xeno-Canto (6 songs, 1 call) - all quality A recordings for expanded species coverage"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Audio Quality:"})," Trimmed OCWA_985696 to remove interfering bird vocalization at beginning - now shows clean warbler song only"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Data Fixes:"})," Removed duplicate OCWA_1046368 entry in clips database, set OCWA_976251 as canonical clip, removed low-quality SASP_1060896 clip"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Home Page:"})," Tightened spacing between title and tagline for better visual balance"]})]})}),c.jsx(Ae,{version:"3.33",date:"January 19, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Taxonomic Sort:"})," Bird Reference now supports eBird/Clements 2025 taxonomic order - toggle between alphabetical and phylogenetic sorting with a fun easter egg for the science nerds"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Species Fixes:"})," Corrected Carolina Wren code from CAWR to CARW, and Barred Owl from BADO to BAOW - now matches eBird standard across all packs and data files"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"American Robin:"})," Added AMRO to starter pack (now 6 birds) - merged PR #4 with Cornell/Macaulay Library attribution"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Pack Naming:"}),' Simplified "Common Eastern US Backyard Birds" to just "Eastern Backyard Birds" everywhere']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Help Page Polish:"}),' Alphabetized bird list in pack descriptions, added "There are exceptions. Because, ornithology." note to 4-letter codes section']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Help Navigation Fix:"})," Fixed unwanted auto-scroll when expanding sections after navigating from Pack Select with hash links"]})]})}),c.jsx(Ae,{version:"3.32",date:"January 18, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Pack Select UX:"})," Simplified intro bullets with direct links to Help (Training Mode section) and Settings - reduced text, added helpful navigation"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Back Button Enhancement:"}),' Made back buttons more prominent on Help and Settings pages (orange color, "Back" text instead of just icon) for better PWA navigation visibility']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Settings Copy:"})," Updated Support section with friendlier wording"]})]})}),c.jsx(Ae,{version:"3.31",date:"January 18, 2026",children:c.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:c.jsxs("li",{children:[c.jsx("strong",{children:"Bird Reference Link:"}),' Made "Bird Reference" in Tips section clickable - now all references to Pack Select have proper back navigation in PWA mode!']})})}),c.jsx(Ae,{version:"3.30",date:"January 18, 2026",children:c.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:c.jsxs("li",{children:[c.jsx("strong",{children:"PWA Navigation Fix:"}),` Added "Back to Help" button on Bird Reference screen when navigated from Help page's About & Credits section - complete PWA navigation coverage!`]})})}),c.jsx(Ae,{version:"3.29",date:"January 18, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"PWA Navigation Enhancement:"}),' Added "Back to Level Select" button on Bird Reference screen when navigated from Level Select - no more getting stuck in PWA mode!']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Rejection tracking system:"})," Clips rejected during review are now logged to prevent re-downloading - no more duplicate review efforts!"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Yellow-rumped Warbler (YRWA) quality improvements:"})," Curated down to 2 high-quality clips (from 14 candidates) - improved from Q3 to Q4 with better song/call diversity"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Cedar Waxwing (CEWA) audit:"})," Reviewed and optimized clip selection for better quality and vocalization diversity"]})]})}),c.jsx(Ae,{version:"3.28",date:"January 18, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Bird Reference Navigation:"}),` Added contextual "Bird Reference" link from Level Select screen that jumps directly to the selected pack's bird list - easily review sounds before starting a level`]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Improved Xeno-canto Attribution:"}),' Now displays XC catalog numbers (e.g., "XC1015145 - David A. Brinkman") for proper credit and licensing compliance']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Deep Linking:"})," Navigate directly to Bird Reference section from Help page with smooth scrolling"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Pack Auto-Expansion:"})," When navigating from Level Select, the relevant pack automatically expands in Bird Reference"]})]})}),c.jsx(Ae,{version:"3.27",date:"January 18, 2026",children:c.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:c.jsxs("li",{children:[c.jsx("strong",{children:"Share Card UX:"}),' Improved share instructions with upward arrow emoji and clearer text "Press and hold the image above" to prevent confusion']})})}),c.jsx(Ae,{version:"3.26",date:"January 18, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"PWA Home Screen Fix:"})," Fixed 404 error when adding ChipNotes to iPhone home screen - start_url now correctly points to root path"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Manifest Update:"}),' Updated PWA description to match new tagline "Train your ear. Know the birds."']})]})}),c.jsx(Ae,{version:"3.25",date:"January 18, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Home Screen Refresh:"}),' New tagline "Train your ear. Know the birds." emphasizes the educational journey and real-world birding payoff']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Enhanced Visual Flow:"}),' Added 3-step "Hear  Match  Train" diagram with brain icon to clearly show the learning process']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Cleaner Layout:"})," Redesigned home screen with tighter spacing and more intuitive visual hierarchy"]})]})}),c.jsx(Ae,{version:"3.24",date:"January 18, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Share Card Polish:"})," Refined share card design with circular bird icons and owl mascot, cleaner font hierarchy (removed monospace, reduced bold usage), and improved spacing for better visual balance"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Icon Improvements:"})," Bird icons and owl now display as perfect circles with proper aspect ratio scaling - no more white backgrounds or distortion"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Layout Refinement:"})," Moved Best Streak above bird icons, tightened spacing between pack/level and bird codes, centered text better in available space"]})]})}),c.jsx(Ae,{version:"3.23",date:"January 17, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Share Score Card:"})," New shareable score card feature - download or share your round results with fun bird icons, stats, and confusion matrix highlights"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Custom Domain:"})," ChipNotes now available at ",c.jsx("a",{href:"https://chipnotes.app",style:{color:"var(--color-accent)"},children:"chipnotes.app"})," - easier to remember and share!"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Training Mode indicator:"})," Share cards now show when Training Mode was used during the round"]})]})}),c.jsx(Ae,{version:"3.22",date:"January 17, 2026",children:c.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:c.jsxs("li",{children:[c.jsx("strong",{children:"Version chronology fix:"})," Moved v3.02 and v3.03 to correct position in version history (after v3.13, before v2.0) - no more time-traveling versions!"]})})}),c.jsx(Ae,{version:"3.21",date:"January 17, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"All Birds pack race condition fix:"})," Fixed state management bug where pack JSON loading overwrote the All Birds pack, causing it to disappear - now merges state correctly to preserve all packs"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Clickable version number:"})," Main menu version now links to Version History - auto-expands and scrolls to changelog"]})]})}),c.jsx(Ae,{version:"3.20",date:"January 17, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Service worker cache fix:"}),' Fixed "Twilight Zone" bug where All Birds pack appeared on first load but disappeared after refresh - hashed JS bundles no longer cached, ensuring fresh code always loads']}),c.jsxs("li",{children:[c.jsx("strong",{children:"PWA stability:"})," Installed PWAs now properly update to show latest changes without requiring reinstall"]})]})}),c.jsx(Ae,{version:"3.19",date:"January 17, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Version numbering fix:"})," Renamed v3.4 to v3.19 to maintain sequential ordering - fixes Apple-style confusion where 3.4 appeared after 3.18"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Help page UX:"})," Collapsible sections with floating Expand All button - less scrolling, more scanning"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"All Birds reference:"})," Fixed missing bird icons in Bird Reference pack"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Navigation improvements:"})," Added Back button at bottom of Help page, Help link in Settings for easy cross-navigation"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Support link:"})," Ko-fi donation link added to Settings - buy me a coffee if ChipNotes helps you ID more birds"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Tech description restored:"})," Brought back the detailed tech paragraph about TypeScript, React, PixiJS, and PWA offline caching"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Privacy language:"}),' Updated Settings privacy text to be more neutral and less "we"-focused, "not stalking you" instead of "them"']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Credits update:"})," Added Cornell Macaulay Library, user contributions, and Bird Reference attribution"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Project timeline:"})," Documented creation timeline (Jan 8-11, 2026) and Claude Code collaboration"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Voice consistency:"}),' Changed "we" to "I" in Feedback section']})]})}),c.jsx(Ae,{version:"3.18",date:"January 17, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"UI polish:"})," Streamlined pack selection, tightened layout, less visual clutter"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Custom Pack Builder:"}),' Sticky "Start" button stays visible with iOS keyboard, auto-focus for rapid bird entry, added preview tip']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Help page:"})," Reorganized sections, added creator attribution"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Privacy page:"})," Full privacy policy accessible from Settings"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Analytics fix:"})," Fixed gtag initialization pattern - tracking now works correctly"]})]})}),c.jsx(Ae,{version:"3.17",date:"January 16, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Cookie consent:"})," I know I'm a stranger, but please accept my cookies! It really helps me document how many players I have and which birds everyone loves. (GDPR-compliant banner now appears on first visit)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Privacy controls:"}),' Changed your mind? New "Analytics Cookies" toggle in Settings lets you opt in/out anytime']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Your data is safe:"})," IP anonymization enabled, secure cookie flags set, full GDPR/CCPA compliance - I promise I'm just adding bird nerds to my LIFE LIST, not stalking you"]})]})}),c.jsx(Ae,{version:"3.16",date:"January 16, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Bird Reference enhancement:"})," Separated display species (39) from gameplay rotation (27) for Expanded Eastern US Birds pack - Bird Reference now shows all available species for preview"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"UI improvements:"})," Streamlined pack selection tips, improved Help page tips with confusion matrix mention"]})]})}),c.jsx(Ae,{version:"3.15",date:"January 16, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Xeno-canto attribution:"})," All Xeno-canto recordings now display recordist names for legal compliance (355 recordings attributed to 87+ contributors)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Help page enhancements:"}),' Added "Why Learn Bird Song?" section explaining the educational value of left/right audio training, tech details about PWA offline caching']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Audio curation:"})," Extensive clip review and quality improvements - refined canonical clips, updated vocalization types (call/song/drum), removed low-quality recordings"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"UI improvements:"}),' Moved shuffle button above bird grid for better visibility, added "Coming Soon" banner to Stats screen to clarify demo data']}),c.jsxs("li",{children:[c.jsx("strong",{children:"New bird icons:"})," Added icons for upcoming Macaulay species (ACFL, EAPH, EWPE, WEVI)"]})]})}),c.jsx(Ae,{version:"3.14",date:"January 15, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Analytics:"})," Added Google Analytics 4 tracking for usage insights (page views, pack/level selections, Training Mode adoption)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Data fixes:"})," Restored BCCH, MODO, and WBNU clips lost during Cornell CD processing"]})]})}),c.jsx(Ae,{version:"3.13",date:"January 15, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Western Backyard Birds pack:"})," 14 new species including Steller's Jay, Western Scrub-Jay, Black-capped Chickadee, and more. Fixed to use 9 random birds per round."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Audio improvements:"})," Restored canonical clips for 71+ species, resolved 202 broken audio references, cleaned up duplicate EATO clips (115)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"UI refinements:"})," Black backgrounds on Training Mode labels for better readability, Warbler Academy icon updated to Blackburnian Warbler, improved loading indicators"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Bird Reference enhancements:"})," Collapsible packs with expand/collapse controls, source badges (Xeno-canto, Cornell, contributors), pack cards with representative bird icons"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Fixed blank spectrograms"})," (async texture loading), added pull-to-refresh on main menu, audio preloading on preview screen"]}),c.jsx("li",{children:"Added White-crowned Sparrow to Sparrows pack (now 8 species)"})]})}),c.jsx(Ae,{version:"3.03",date:"January 17, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Quit button:"})," Added X button during gameplay to quit rounds early with confirmation"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Support section:"})," Added Ko-fi donation link and encouragement to support Cornell Macaulay Library and Xeno-Canto"]})]})}),c.jsx(Ae,{version:"3.02",date:"January 17, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Mobile navigation fix:"})," Bottom menu icons now properly visible on both Safari and Chrome mobile browsers"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Fullscreen tip:"})," Added browser guidance for best mobile experience"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"PWA improvements:"})," Enhanced Apple mobile web app support"]})]})}),c.jsx(Ae,{version:"2.0",date:"January 12, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsx("li",{children:"Rebranded to ChipNotes! with Owl Professor mascot"}),c.jsx("li",{children:"Training Mode: Toggle eye icon to show bird labels on tiles"}),c.jsx("li",{children:"Warbler Academy pack: 33 wood-warbler species for experts"}),c.jsx("li",{children:"Complete icon set: Hand-illustrated icons for all 91+ species"}),c.jsx("li",{children:"Added Eastern Towhee to Expanded Backyard pack"}),c.jsx("li",{children:"Birds now persist between rounds by default"}),c.jsx("li",{children:"Fixed scoring to allow full 100 points as documented"}),c.jsx("li",{children:"iOS audio improvements and playback fixes"})]})}),c.jsx(Ae,{version:"1.0",date:"January 11, 2026",children:c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[c.jsx("li",{children:"Initial release with 6 bird packs"}),c.jsx("li",{children:"Pre-round preview screen to hear and see birds before playing"}),c.jsx("li",{children:"Custom pack builder for targeted practice"}),c.jsx("li",{children:"Continuous play mode (untimed, relaxed practice)"}),c.jsx("li",{children:"Enhanced round summary with per-species breakdown"}),c.jsx("li",{children:"Progressive difficulty: 6 levels per pack"}),c.jsx("li",{children:"Real spectrograms for visual learning"}),c.jsx("li",{children:"PWA support for offline play and mobile installation"})]})})]})})]}),s&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>{var _;return(_=e.state)!=null&&_.fromPackSelect?t("/pack-select"):t(-1)},style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",left:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",zIndex:1e3},onMouseEnter:_=>{_.currentTarget.style.transform="scale(1.05)",_.currentTarget.style.background="rgba(255, 152, 0, 0.25)",_.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:_=>{_.currentTarget.style.transform="scale(1)",_.currentTarget.style.background="rgba(255, 152, 0, 0.15)",_.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},"aria-label":"Back",children:[c.jsx("span",{style:{fontSize:"12px"},children:""}),"Back"]}),c.jsxs("div",{style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",right:"24px",display:"flex",gap:"8px",zIndex:1e3},children:[c.jsxs("button",{onClick:f,style:{padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:_=>{_.currentTarget.style.transform="scale(1.05)",_.currentTarget.style.background="rgba(255, 152, 0, 0.25)",_.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:_=>{_.currentTarget.style.transform="scale(1)",_.currentTarget.style.background="rgba(255, 152, 0, 0.15)",_.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},children:[c.jsx("span",{style:{fontSize:"12px"},children:p?"":""}),p?"Collapse All":"Expand All"]}),c.jsxs("button",{onClick:m,style:{padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(76, 175, 80, 0.15)",color:"var(--color-success)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:_=>{_.currentTarget.style.transform="scale(1.05)",_.currentTarget.style.background="rgba(76, 175, 80, 0.25)",_.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:_=>{_.currentTarget.style.transform="scale(1)",_.currentTarget.style.background="rgba(76, 175, 80, 0.15)",_.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},"aria-label":"Scroll to top",children:[c.jsx("span",{style:{fontSize:"12px"},children:""}),"Top"]})]})]})]})}function Pt({id:t,title:e,children:r,isExpanded:n,onToggle:i}){return c.jsxs("div",{id:t,style:{marginBottom:"16px",scrollMarginTop:"20px"},children:[c.jsxs("h3",{onClick:i,style:{fontSize:"16px",fontWeight:600,marginBottom:n?"12px":"0",color:"var(--color-accent)",borderBottom:"1px solid var(--color-surface)",paddingBottom:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"color 0.2s",userSelect:"none"},onMouseEnter:s=>s.currentTarget.style.color="#FFA726",onMouseLeave:s=>s.currentTarget.style.color="var(--color-accent)",children:[c.jsx("span",{style:{fontSize:"14px",width:"14px",textAlign:"center",flexShrink:0},children:n?"":""}),e]}),n&&c.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,color:"var(--color-text)"},children:r})]})}function fl({label:t,points:e,description:r,color:n}){return c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[c.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:n,minWidth:"40px"},children:["+",e]}),c.jsxs("div",{children:[c.jsx("span",{style:{fontWeight:600},children:t}),c.jsx("span",{style:{color:"var(--color-text-muted)",marginLeft:"8px",fontSize:"13px"},children:r})]})]})}function Yi({name:t,description:e}){return c.jsxs("div",{style:{marginBottom:"12px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px"},children:[c.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:t}),c.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:e})]})}function Ki({level:t,title:e,description:r}){return c.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[c.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:"var(--color-accent)",minWidth:"24px"},children:t}),c.jsxs("div",{children:[c.jsx("span",{style:{fontWeight:600},children:e}),c.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:r})]})]})}function qi({children:t}){return c.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px"},children:[c.jsx("span",{style:{color:"var(--color-accent)"},children:""}),c.jsx("span",{children:t})]})}function Ae({version:t,date:e,children:r}){return c.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"8px",marginBottom:"8px"},children:[c.jsxs("span",{style:{fontWeight:700,fontSize:"16px",color:"var(--color-accent)"},children:["v",t]}),c.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:e})]}),r]})}function XM(){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}function YM(){const t=Xt();return c.jsxs("div",{className:"screen",children:[c.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[c.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:c.jsx(KM,{})}),c.jsx("h2",{style:{margin:0},children:"Privacy Policy"})]}),c.jsxs("div",{className:"flex-col gap-lg",style:{maxWidth:"800px"},children:[c.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[c.jsxs("p",{style:{marginBottom:"12px"},children:[c.jsx("strong",{children:"Last Updated:"})," January 17, 2026"]}),c.jsx("p",{style:{marginBottom:"12px"},children:"ChipNotes! is committed to protecting your privacy. This policy explains what data is collected, how it is used, and your rights."})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Data Collection"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[c.jsx("p",{style:{marginBottom:"8px"},children:c.jsx("strong",{children:"Local Data (Always Stored on Your Device):"})}),c.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[c.jsx("li",{children:"Game settings (scroll speed, spectrogram mode, high contrast, continuous play)"}),c.jsx("li",{children:"Custom pack selections (bird species you choose)"}),c.jsx("li",{children:"Round results and scores (not linked to your identity)"}),c.jsx("li",{children:"Cookie consent preference"})]}),c.jsx("p",{style:{marginBottom:"8px"},children:c.jsx("strong",{children:"Analytics Data (Only if You Consent):"})}),c.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[c.jsx("li",{children:"Anonymized usage data via Google Analytics (IP addresses are anonymized)"}),c.jsx("li",{children:"Which features are used and which birds are practiced"}),c.jsx("li",{children:"App performance metrics"})]}),c.jsxs("p",{style:{fontSize:"13px",color:"var(--color-accent)"},children:[c.jsx("strong",{children:"Not collected:"})," Names, email addresses, phone numbers, precise location, or any personally identifiable information. Your game data stays on your device."]})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"How Your Data Is Used"}),c.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:c.jsxs("ul",{style:{marginLeft:"20px"},children:[c.jsx("li",{children:"Local data: Saves your preferences and tracks your progress"}),c.jsx("li",{children:"Analytics data: Used to understand how many players use ChipNotes, which features are popular, and how to improve the app"}),c.jsx("li",{children:"Your data is never sold, rented, or shared with third parties (except Google Analytics if you consent)"})]})})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Third-Party Services"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[c.jsxs("p",{style:{marginBottom:"8px"},children:[c.jsx("strong",{children:"Google Analytics"})," (only if you consent)"]}),c.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[c.jsx("li",{children:"Used to collect anonymized usage statistics"}),c.jsx("li",{children:"IP anonymization enabled"}),c.jsx("li",{children:"No ad personalization or cross-device tracking"}),c.jsxs("li",{children:["Learn more: ",c.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Google Privacy Policy"})]})]}),c.jsx("p",{style:{marginBottom:"8px"},children:c.jsx("strong",{children:"Xeno-Canto Audio"})}),c.jsxs("ul",{style:{marginLeft:"20px"},children:[c.jsx("li",{children:"Bird sound recordings are sourced from Xeno-Canto and cached locally on your device"}),c.jsx("li",{children:"No data is sent to Xeno-Canto when you play sounds offline"})]})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Your Rights"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[c.jsx("p",{style:{marginBottom:"8px"},children:"You have the right to:"}),c.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Access your data:"})," All local data is stored in your browser's localStorage (visible in browser dev tools)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Delete your data:"}),' Use the "Reset All Progress" button in Settings to delete all local data and cache']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Withdraw consent:"}),' Toggle "Analytics" in Settings to disable Google Analytics at any time']}),c.jsxs("li",{children:[c.jsx("strong",{children:"Data portability:"})," Local data can be exported via browser dev tools (localStorage)"]})]}),c.jsx("p",{style:{fontSize:"13px"},children:"Since all game data is stored locally on your device, you have full control. Uninstalling the app or clearing browser data will permanently delete all your data."})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Cookies & Local Storage"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[c.jsx("p",{style:{marginBottom:"8px"},children:c.jsx("strong",{children:"Essential (Always Active):"})}),c.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[c.jsxs("li",{children:[c.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"chipnotes_cookie_consent"})," - Stores your cookie consent choice"]}),c.jsxs("li",{children:[c.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"soundfield_*"})," - Game settings and progress (all stored in localStorage)"]})]}),c.jsx("p",{style:{marginBottom:"8px"},children:c.jsx("strong",{children:"Analytics (Only if You Consent):"})}),c.jsx("ul",{style:{marginLeft:"20px"},children:c.jsxs("li",{children:[c.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga"}),", ",c.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga_*"})," - Google Analytics cookies (2-year expiration)"]})})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Data Security"}),c.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:c.jsxs("ul",{style:{marginLeft:"20px"},children:[c.jsx("li",{children:"All data is stored locally on your device (no cloud servers)"}),c.jsx("li",{children:"HTTPS encryption for all web traffic"}),c.jsx("li",{children:"No user accounts or authentication (no password risks)"}),c.jsx("li",{children:"Service Worker caches audio files for offline use (stored locally)"})]})})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Children's Privacy"}),c.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:c.jsx("p",{children:"ChipNotes does not knowingly collect data from children under 13. The app does not require any personal information, and analytics are opt-in. Parents can disable analytics in Settings."})})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"International Users"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[c.jsx("p",{style:{marginBottom:"8px"},children:"ChipNotes complies with:"}),c.jsxs("ul",{style:{marginLeft:"20px"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"GDPR"})," (European Union) - Right to access, deletion, and data portability"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"CCPA"})," (California) - Right to know and delete personal information"]}),c.jsx("li",{children:"Since no personal information is collected, compliance is straightforward"})]})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Changes to This Policy"}),c.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:c.jsx("p",{children:'This Privacy Policy may be updated from time to time. Changes will be posted on this page with an updated "Last Updated" date. Continued use of the app after changes constitutes acceptance of the updated policy.'})})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{style:{marginBottom:"12px"},children:"Contact Us"}),c.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[c.jsx("p",{style:{marginBottom:"8px"},children:"Questions about this Privacy Policy or your data?"}),c.jsxs("p",{children:["Email:"," ",c.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]})]})]})]})]})}function KM(){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M15 18l-6-6 6-6"})})}const Lh="chipnotes_cookie_consent";function Ry(){if(typeof window>"u")return;if(window.gtag){console.log("Google Analytics already loaded");return}window.dataLayer=window.dataLayer||[],window.gtag=function(){var e;(e=window.dataLayer)==null||e.push(arguments)},window.gtag("js",new Date),window.gtag("config","G-MJXQZYWWZ0",{anonymize_ip:!0,cookie_flags:"SameSite=Lax;Secure",cookie_expires:63072e3,allow_ad_personalization_signals:!1,allow_google_signals:!1});const t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-MJXQZYWWZ0",document.head.appendChild(t),console.log("Google Analytics loading with user consent")}function qM(){const[t,e]=b.useState(!1);b.useEffect(()=>{const i=localStorage.getItem(Lh);i==="accepted"?Ry():i===null&&e(!0)},[]);const r=()=>{localStorage.setItem(Lh,"accepted"),e(!1),Ry(),setTimeout(()=>{window.location.reload()},100)},n=()=>{localStorage.setItem(Lh,"declined"),e(!1),setTimeout(()=>{window.location.reload()},100)};return t?c.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"rgba(26, 26, 46, 0.98)",backdropFilter:"blur(10px)",borderTop:"1px solid var(--color-primary)",padding:"16px",paddingBottom:"calc(16px + var(--safe-area-bottom, 0px))",zIndex:1e4,boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.3)"},children:c.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"12px"},children:[c.jsxs("div",{style:{fontSize:"14px",lineHeight:1.5,color:"var(--color-text)"},children:[c.jsx("strong",{style:{color:"var(--color-accent)"},children:" Cookies & Privacy"}),c.jsxs("p",{style:{margin:"8px 0 0 0",color:"var(--color-text-muted)"},children:["We use Google Analytics to understand how people use ChipNotes and improve the app. This helps us know which features are useful and which birds people practice most. We anonymize your IP address and don't collect personal information."," ",c.jsx("a",{href:"/bird-sound-game/privacy",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Learn more"})]})]}),c.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[c.jsx("button",{onClick:r,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="#3a7332"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-primary)"},children:"Accept Analytics"}),c.jsx("button",{onClick:n,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-surface)",color:"var(--color-text)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="var(--color-background)"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-surface)"},children:"Decline"})]})]})}):null}function QM(){return c.jsxs(c.Fragment,{children:[c.jsxs(_E,{children:[c.jsx(Yt,{path:"/",element:c.jsx(ME,{})}),c.jsx(Yt,{path:"/pack-select",element:c.jsx(GE,{})}),c.jsx(Yt,{path:"/level-select",element:c.jsx(QE,{})}),c.jsx(Yt,{path:"/preview",element:c.jsx(sT,{})}),c.jsx(Yt,{path:"/custom-pack",element:c.jsx(cT,{})}),c.jsx(Yt,{path:"/gameplay",element:c.jsx(FM,{})}),c.jsx(Yt,{path:"/summary",element:c.jsx(DM,{})}),c.jsx(Yt,{path:"/settings",element:c.jsx(GM,{})}),c.jsx(Yt,{path:"/progress",element:c.jsx(WM,{})}),c.jsx(Yt,{path:"/help",element:c.jsx(VM,{})}),c.jsx(Yt,{path:"/privacy",element:c.jsx(YM,{})})]}),c.jsx(qM,{})]})}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{for(const e of t)e.unregister()});Dh.createRoot(document.getElementById("root")).render(c.jsx(Oy.StrictMode,{children:c.jsx(RE,{basename:"/",children:c.jsx(QM,{})})}));
