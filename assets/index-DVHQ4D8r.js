var aw=Object.defineProperty;var lw=(t,e,r)=>e in t?aw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var bn=(t,e,r)=>lw(t,typeof e!="symbol"?e+"":e,r);function cw(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var No=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function uw(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Ly={exports:{}},Lc={},Dy={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wa=Symbol.for("react.element"),dw=Symbol.for("react.portal"),hw=Symbol.for("react.fragment"),pw=Symbol.for("react.strict_mode"),fw=Symbol.for("react.profiler"),mw=Symbol.for("react.provider"),gw=Symbol.for("react.context"),xw=Symbol.for("react.forward_ref"),yw=Symbol.for("react.suspense"),vw=Symbol.for("react.memo"),_w=Symbol.for("react.lazy"),um=Symbol.iterator;function ww(t){return t===null||typeof t!="object"?null:(t=um&&t[um]||t["@@iterator"],typeof t=="function"?t:null)}var Oy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Uy=Object.assign,zy={};function Js(t,e,r){this.props=t,this.context=e,this.refs=zy,this.updater=r||Oy}Js.prototype.isReactComponent={};Js.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Js.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Gy(){}Gy.prototype=Js.prototype;function Dp(t,e,r){this.props=t,this.context=e,this.refs=zy,this.updater=r||Oy}var Op=Dp.prototype=new Gy;Op.constructor=Dp;Uy(Op,Js.prototype);Op.isPureReactComponent=!0;var dm=Array.isArray,Hy=Object.prototype.hasOwnProperty,Up={current:null},$y={key:!0,ref:!0,__self:!0,__source:!0};function Vy(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Hy.call(e,n)&&!$y.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:wa,type:t,key:s,ref:o,props:i,_owner:Up.current}}function Sw(t,e){return{$$typeof:wa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function zp(t){return typeof t=="object"&&t!==null&&t.$$typeof===wa}function bw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var hm=/\/+/g;function yu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?bw(""+t.key):e.toString(36)}function Sl(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case wa:case dw:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+yu(o,0):n,dm(i)?(r="",t!=null&&(r=t.replace(hm,"$&/")+"/"),Sl(i,e,r,"",function(u){return u})):i!=null&&(zp(i)&&(i=Sw(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(hm,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",dm(t))for(var a=0;a<t.length;a++){s=t[a];var c=n+yu(s,a);o+=Sl(s,e,r,c,i)}else if(c=ww(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=n+yu(s,a++),o+=Sl(s,e,r,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ba(t,e,r){if(t==null)return t;var n=[],i=0;return Sl(t,n,"","",function(s){return e.call(r,s,i++)}),n}function Ew(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var jt={current:null},bl={transition:null},Tw={ReactCurrentDispatcher:jt,ReactCurrentBatchConfig:bl,ReactCurrentOwner:Up};function Wy(){throw Error("act(...) is not supported in production builds of React.")}Pe.Children={map:Ba,forEach:function(t,e,r){Ba(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ba(t,function(){e++}),e},toArray:function(t){return Ba(t,function(e){return e})||[]},only:function(t){if(!zp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Pe.Component=Js;Pe.Fragment=hw;Pe.Profiler=fw;Pe.PureComponent=Dp;Pe.StrictMode=pw;Pe.Suspense=yw;Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tw;Pe.act=Wy;Pe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Uy({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Up.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Hy.call(e,c)&&!$y.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:wa,type:t.type,key:i,ref:s,props:n,_owner:o}};Pe.createContext=function(t){return t={$$typeof:gw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:mw,_context:t},t.Consumer=t};Pe.createElement=Vy;Pe.createFactory=function(t){var e=Vy.bind(null,t);return e.type=t,e};Pe.createRef=function(){return{current:null}};Pe.forwardRef=function(t){return{$$typeof:xw,render:t}};Pe.isValidElement=zp;Pe.lazy=function(t){return{$$typeof:_w,_payload:{_status:-1,_result:t},_init:Ew}};Pe.memo=function(t,e){return{$$typeof:vw,type:t,compare:e===void 0?null:e}};Pe.startTransition=function(t){var e=bl.transition;bl.transition={};try{t()}finally{bl.transition=e}};Pe.unstable_act=Wy;Pe.useCallback=function(t,e){return jt.current.useCallback(t,e)};Pe.useContext=function(t){return jt.current.useContext(t)};Pe.useDebugValue=function(){};Pe.useDeferredValue=function(t){return jt.current.useDeferredValue(t)};Pe.useEffect=function(t,e){return jt.current.useEffect(t,e)};Pe.useId=function(){return jt.current.useId()};Pe.useImperativeHandle=function(t,e,r){return jt.current.useImperativeHandle(t,e,r)};Pe.useInsertionEffect=function(t,e){return jt.current.useInsertionEffect(t,e)};Pe.useLayoutEffect=function(t,e){return jt.current.useLayoutEffect(t,e)};Pe.useMemo=function(t,e){return jt.current.useMemo(t,e)};Pe.useReducer=function(t,e,r){return jt.current.useReducer(t,e,r)};Pe.useRef=function(t){return jt.current.useRef(t)};Pe.useState=function(t){return jt.current.useState(t)};Pe.useSyncExternalStore=function(t,e,r){return jt.current.useSyncExternalStore(t,e,r)};Pe.useTransition=function(){return jt.current.useTransition()};Pe.version="18.3.1";Dy.exports=Pe;var S=Dy.exports;const Xy=Lp(S),Aw=cw({__proto__:null,default:Xy},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cw=S,kw=Symbol.for("react.element"),Pw=Symbol.for("react.fragment"),Rw=Object.prototype.hasOwnProperty,Iw=Cw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jw={key:!0,ref:!0,__self:!0,__source:!0};function Yy(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Rw.call(e,n)&&!jw.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:kw,type:t,key:s,ref:o,props:i,_owner:Iw.current}}Lc.Fragment=Pw;Lc.jsx=Yy;Lc.jsxs=Yy;Ly.exports=Lc;var l=Ly.exports,$d={},Ky={exports:{}},Qt={},qy={exports:{}},Jy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(I,j){var A=I.length;I.push(j);e:for(;0<A;){var T=A-1>>>1,H=I[T];if(0<i(H,j))I[T]=j,I[A]=H,A=T;else break e}}function r(I){return I.length===0?null:I[0]}function n(I){if(I.length===0)return null;var j=I[0],A=I.pop();if(A!==j){I[0]=A;e:for(var T=0,H=I.length,X=H>>>1;T<X;){var K=2*(T+1)-1,Te=I[K],z=K+1,Y=I[z];if(0>i(Te,A))z<H&&0>i(Y,Te)?(I[T]=Y,I[z]=A,T=z):(I[T]=Te,I[K]=A,T=K);else if(z<H&&0>i(Y,A))I[T]=Y,I[z]=A,T=z;else break e}}return j}function i(I,j){var A=I.sortIndex-j.sortIndex;return A!==0?A:I.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],u=[],d=1,h=null,p=3,f=!1,m=!1,_=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(I){for(var j=r(u);j!==null;){if(j.callback===null)n(u);else if(j.startTime<=I)n(u),j.sortIndex=j.expirationTime,e(c,j);else break;j=r(u)}}function w(I){if(_=!1,g(I),!m)if(r(c)!==null)m=!0,R(b);else{var j=r(u);j!==null&&F(w,j.startTime-I)}}function b(I,j){m=!1,_&&(_=!1,x(E),E=-1),f=!0;var A=p;try{for(g(j),h=r(c);h!==null&&(!(h.expirationTime>j)||I&&!N());){var T=h.callback;if(typeof T=="function"){h.callback=null,p=h.priorityLevel;var H=T(h.expirationTime<=j);j=t.unstable_now(),typeof H=="function"?h.callback=H:h===r(c)&&n(c),g(j)}else n(c);h=r(c)}if(h!==null)var X=!0;else{var K=r(u);K!==null&&F(w,K.startTime-j),X=!1}return X}finally{h=null,p=A,f=!1}}var P=!1,C=null,E=-1,M=5,B=-1;function N(){return!(t.unstable_now()-B<M)}function D(){if(C!==null){var I=t.unstable_now();B=I;var j=!0;try{j=C(!0,I)}finally{j?k():(P=!1,C=null)}}else P=!1}var k;if(typeof y=="function")k=function(){y(D)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,U=L.port2;L.port1.onmessage=D,k=function(){U.postMessage(null)}}else k=function(){v(D,0)};function R(I){C=I,P||(P=!0,k())}function F(I,j){E=v(function(){I(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,R(b))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(I){switch(p){case 1:case 2:case 3:var j=3;break;default:j=p}var A=p;p=j;try{return I()}finally{p=A}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,j){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var A=p;p=I;try{return j()}finally{p=A}},t.unstable_scheduleCallback=function(I,j,A){var T=t.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?T+A:T):A=T,I){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=A+H,I={id:d++,callback:j,priorityLevel:I,startTime:A,expirationTime:H,sortIndex:-1},A>T?(I.sortIndex=A,e(u,I),r(c)===null&&I===r(u)&&(_?(x(E),E=-1):_=!0,F(w,A-T))):(I.sortIndex=H,e(c,I),m||f||(m=!0,R(b))),I},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(I){var j=p;return function(){var A=p;p=j;try{return I.apply(this,arguments)}finally{p=A}}}})(Jy);qy.exports=Jy;var Mw=qy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bw=S,Jt=Mw;function V(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Qy=new Set,qo={};function Oi(t,e){zs(t,e),zs(t+"Capture",e)}function zs(t,e){for(qo[t]=e,t=0;t<e.length;t++)Qy.add(e[t])}var hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vd=Object.prototype.hasOwnProperty,Nw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pm={},fm={};function Fw(t){return Vd.call(fm,t)?!0:Vd.call(pm,t)?!1:Nw.test(t)?fm[t]=!0:(pm[t]=!0,!1)}function Lw(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Dw(t,e,r,n){if(e===null||typeof e>"u"||Lw(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Mt(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){wt[t]=new Mt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];wt[e]=new Mt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){wt[t]=new Mt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){wt[t]=new Mt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){wt[t]=new Mt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){wt[t]=new Mt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){wt[t]=new Mt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){wt[t]=new Mt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){wt[t]=new Mt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gp=/[\-:]([a-z])/g;function Hp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gp,Hp);wt[e]=new Mt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gp,Hp);wt[e]=new Mt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gp,Hp);wt[e]=new Mt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){wt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){wt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!0,!0)});function $p(t,e,r,n){var i=wt.hasOwnProperty(e)?wt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Dw(e,r,i,n)&&(r=null),n||i===null?Fw(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var yn=Bw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Na=Symbol.for("react.element"),ps=Symbol.for("react.portal"),fs=Symbol.for("react.fragment"),Vp=Symbol.for("react.strict_mode"),Wd=Symbol.for("react.profiler"),Zy=Symbol.for("react.provider"),ev=Symbol.for("react.context"),Wp=Symbol.for("react.forward_ref"),Xd=Symbol.for("react.suspense"),Yd=Symbol.for("react.suspense_list"),Xp=Symbol.for("react.memo"),Rn=Symbol.for("react.lazy"),tv=Symbol.for("react.offscreen"),mm=Symbol.iterator;function oo(t){return t===null||typeof t!="object"?null:(t=mm&&t[mm]||t["@@iterator"],typeof t=="function"?t:null)}var Ke=Object.assign,vu;function bo(t){if(vu===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);vu=e&&e[1]||""}return`
`+vu+t}var _u=!1;function wu(t,e){if(!t||_u)return"";_u=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{_u=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?bo(t):""}function Ow(t){switch(t.tag){case 5:return bo(t.type);case 16:return bo("Lazy");case 13:return bo("Suspense");case 19:return bo("SuspenseList");case 0:case 2:case 15:return t=wu(t.type,!1),t;case 11:return t=wu(t.type.render,!1),t;case 1:return t=wu(t.type,!0),t;default:return""}}function Kd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case fs:return"Fragment";case ps:return"Portal";case Wd:return"Profiler";case Vp:return"StrictMode";case Xd:return"Suspense";case Yd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ev:return(t.displayName||"Context")+".Consumer";case Zy:return(t._context.displayName||"Context")+".Provider";case Wp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Xp:return e=t.displayName||null,e!==null?e:Kd(t.type)||"Memo";case Rn:e=t._payload,t=t._init;try{return Kd(t(e))}catch{}}return null}function Uw(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kd(e);case 8:return e===Vp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zw(t){var e=rv(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fa(t){t._valueTracker||(t._valueTracker=zw(t))}function nv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=rv(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Wl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qd(t,e){var r=e.checked;return Ke({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function gm(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Qn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function iv(t,e){e=e.checked,e!=null&&$p(t,"checked",e,!1)}function Jd(t,e){iv(t,e);var r=Qn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Qd(t,e.type,r):e.hasOwnProperty("defaultValue")&&Qd(t,e.type,Qn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Qd(t,e,r){(e!=="number"||Wl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Eo=Array.isArray;function Cs(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Qn(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Zd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(V(91));return Ke({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ym(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(V(92));if(Eo(r)){if(1<r.length)throw Error(V(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Qn(r)}}function sv(t,e){var r=Qn(e.value),n=Qn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function vm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ov(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function eh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ov(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var La,av=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(La=La||document.createElement("div"),La.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=La.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Jo(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Fo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gw=["Webkit","ms","Moz","O"];Object.keys(Fo).forEach(function(t){Gw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fo[e]=Fo[t]})});function lv(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Fo.hasOwnProperty(t)&&Fo[t]?(""+e).trim():e+"px"}function cv(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=lv(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Hw=Ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function th(t,e){if(e){if(Hw[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(V(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(V(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(V(61))}if(e.style!=null&&typeof e.style!="object")throw Error(V(62))}}function rh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nh=null;function Yp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ih=null,ks=null,Ps=null;function _m(t){if(t=Ea(t)){if(typeof ih!="function")throw Error(V(280));var e=t.stateNode;e&&(e=Gc(e),ih(t.stateNode,t.type,e))}}function uv(t){ks?Ps?Ps.push(t):Ps=[t]:ks=t}function dv(){if(ks){var t=ks,e=Ps;if(Ps=ks=null,_m(t),e)for(t=0;t<e.length;t++)_m(e[t])}}function hv(t,e){return t(e)}function pv(){}var Su=!1;function fv(t,e,r){if(Su)return t(e,r);Su=!0;try{return hv(t,e,r)}finally{Su=!1,(ks!==null||Ps!==null)&&(pv(),dv())}}function Qo(t,e){var r=t.stateNode;if(r===null)return null;var n=Gc(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(V(231,e,typeof r));return r}var sh=!1;if(hn)try{var ao={};Object.defineProperty(ao,"passive",{get:function(){sh=!0}}),window.addEventListener("test",ao,ao),window.removeEventListener("test",ao,ao)}catch{sh=!1}function $w(t,e,r,n,i,s,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var Lo=!1,Xl=null,Yl=!1,oh=null,Vw={onError:function(t){Lo=!0,Xl=t}};function Ww(t,e,r,n,i,s,o,a,c){Lo=!1,Xl=null,$w.apply(Vw,arguments)}function Xw(t,e,r,n,i,s,o,a,c){if(Ww.apply(this,arguments),Lo){if(Lo){var u=Xl;Lo=!1,Xl=null}else throw Error(V(198));Yl||(Yl=!0,oh=u)}}function Ui(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function mv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function wm(t){if(Ui(t)!==t)throw Error(V(188))}function Yw(t){var e=t.alternate;if(!e){if(e=Ui(t),e===null)throw Error(V(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return wm(i),t;if(s===n)return wm(i),e;s=s.sibling}throw Error(V(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(V(189))}}if(r.alternate!==n)throw Error(V(190))}if(r.tag!==3)throw Error(V(188));return r.stateNode.current===r?t:e}function gv(t){return t=Yw(t),t!==null?xv(t):null}function xv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=xv(t);if(e!==null)return e;t=t.sibling}return null}var yv=Jt.unstable_scheduleCallback,Sm=Jt.unstable_cancelCallback,Kw=Jt.unstable_shouldYield,qw=Jt.unstable_requestPaint,nt=Jt.unstable_now,Jw=Jt.unstable_getCurrentPriorityLevel,Kp=Jt.unstable_ImmediatePriority,vv=Jt.unstable_UserBlockingPriority,Kl=Jt.unstable_NormalPriority,Qw=Jt.unstable_LowPriority,_v=Jt.unstable_IdlePriority,Dc=null,Hr=null;function Zw(t){if(Hr&&typeof Hr.onCommitFiberRoot=="function")try{Hr.onCommitFiberRoot(Dc,t,void 0,(t.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:rS,eS=Math.log,tS=Math.LN2;function rS(t){return t>>>=0,t===0?32:31-(eS(t)/tS|0)|0}var Da=64,Oa=4194304;function To(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ql(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=To(a):(s&=o,s!==0&&(n=To(s)))}else o=r&~i,o!==0?n=To(o):s!==0&&(n=To(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-br(e),i=1<<r,n|=t[r],e&=~i;return n}function nS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function iS(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-br(s),a=1<<o,c=i[o];c===-1?(!(a&r)||a&n)&&(i[o]=nS(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function ah(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wv(){var t=Da;return Da<<=1,!(Da&4194240)&&(Da=64),t}function bu(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Sa(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-br(e),t[e]=r}function sS(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-br(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function qp(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-br(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Ne=0;function Sv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var bv,Jp,Ev,Tv,Av,lh=!1,Ua=[],Gn=null,Hn=null,$n=null,Zo=new Map,ea=new Map,Mn=[],oS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bm(t,e){switch(t){case"focusin":case"focusout":Gn=null;break;case"dragenter":case"dragleave":Hn=null;break;case"mouseover":case"mouseout":$n=null;break;case"pointerover":case"pointerout":Zo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(e.pointerId)}}function lo(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ea(e),e!==null&&Jp(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function aS(t,e,r,n,i){switch(e){case"focusin":return Gn=lo(Gn,t,e,r,n,i),!0;case"dragenter":return Hn=lo(Hn,t,e,r,n,i),!0;case"mouseover":return $n=lo($n,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Zo.set(s,lo(Zo.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,ea.set(s,lo(ea.get(s)||null,t,e,r,n,i)),!0}return!1}function Cv(t){var e=Si(t.target);if(e!==null){var r=Ui(e);if(r!==null){if(e=r.tag,e===13){if(e=mv(r),e!==null){t.blockedOn=e,Av(t.priority,function(){Ev(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function El(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=ch(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);nh=n,r.target.dispatchEvent(n),nh=null}else return e=Ea(r),e!==null&&Jp(e),t.blockedOn=r,!1;e.shift()}return!0}function Em(t,e,r){El(t)&&r.delete(e)}function lS(){lh=!1,Gn!==null&&El(Gn)&&(Gn=null),Hn!==null&&El(Hn)&&(Hn=null),$n!==null&&El($n)&&($n=null),Zo.forEach(Em),ea.forEach(Em)}function co(t,e){t.blockedOn===e&&(t.blockedOn=null,lh||(lh=!0,Jt.unstable_scheduleCallback(Jt.unstable_NormalPriority,lS)))}function ta(t){function e(i){return co(i,t)}if(0<Ua.length){co(Ua[0],t);for(var r=1;r<Ua.length;r++){var n=Ua[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Gn!==null&&co(Gn,t),Hn!==null&&co(Hn,t),$n!==null&&co($n,t),Zo.forEach(e),ea.forEach(e),r=0;r<Mn.length;r++)n=Mn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Mn.length&&(r=Mn[0],r.blockedOn===null);)Cv(r),r.blockedOn===null&&Mn.shift()}var Rs=yn.ReactCurrentBatchConfig,Jl=!0;function cS(t,e,r,n){var i=Ne,s=Rs.transition;Rs.transition=null;try{Ne=1,Qp(t,e,r,n)}finally{Ne=i,Rs.transition=s}}function uS(t,e,r,n){var i=Ne,s=Rs.transition;Rs.transition=null;try{Ne=4,Qp(t,e,r,n)}finally{Ne=i,Rs.transition=s}}function Qp(t,e,r,n){if(Jl){var i=ch(t,e,r,n);if(i===null)Mu(t,e,n,Ql,r),bm(t,n);else if(aS(i,t,e,r,n))n.stopPropagation();else if(bm(t,n),e&4&&-1<oS.indexOf(t)){for(;i!==null;){var s=Ea(i);if(s!==null&&bv(s),s=ch(t,e,r,n),s===null&&Mu(t,e,n,Ql,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Mu(t,e,n,null,r)}}var Ql=null;function ch(t,e,r,n){if(Ql=null,t=Yp(n),t=Si(t),t!==null)if(e=Ui(t),e===null)t=null;else if(r=e.tag,r===13){if(t=mv(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ql=t,null}function kv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jw()){case Kp:return 1;case vv:return 4;case Kl:case Qw:return 16;case _v:return 536870912;default:return 16}default:return 16}}var Fn=null,Zp=null,Tl=null;function Pv(){if(Tl)return Tl;var t,e=Zp,r=e.length,n,i="value"in Fn?Fn.value:Fn.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return Tl=i.slice(t,1<n?1-n:void 0)}function Al(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function za(){return!0}function Tm(){return!1}function Zt(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?za:Tm,this.isPropagationStopped=Tm,this}return Ke(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=za)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=za)},persist:function(){},isPersistent:za}),e}var Qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ef=Zt(Qs),ba=Ke({},Qs,{view:0,detail:0}),dS=Zt(ba),Eu,Tu,uo,Oc=Ke({},ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==uo&&(uo&&t.type==="mousemove"?(Eu=t.screenX-uo.screenX,Tu=t.screenY-uo.screenY):Tu=Eu=0,uo=t),Eu)},movementY:function(t){return"movementY"in t?t.movementY:Tu}}),Am=Zt(Oc),hS=Ke({},Oc,{dataTransfer:0}),pS=Zt(hS),fS=Ke({},ba,{relatedTarget:0}),Au=Zt(fS),mS=Ke({},Qs,{animationName:0,elapsedTime:0,pseudoElement:0}),gS=Zt(mS),xS=Ke({},Qs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),yS=Zt(xS),vS=Ke({},Qs,{data:0}),Cm=Zt(vS),_S={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=SS[t])?!!e[t]:!1}function tf(){return bS}var ES=Ke({},ba,{key:function(t){if(t.key){var e=_S[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Al(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tf,charCode:function(t){return t.type==="keypress"?Al(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Al(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),TS=Zt(ES),AS=Ke({},Oc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),km=Zt(AS),CS=Ke({},ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tf}),kS=Zt(CS),PS=Ke({},Qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),RS=Zt(PS),IS=Ke({},Oc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),jS=Zt(IS),MS=[9,13,27,32],rf=hn&&"CompositionEvent"in window,Do=null;hn&&"documentMode"in document&&(Do=document.documentMode);var BS=hn&&"TextEvent"in window&&!Do,Rv=hn&&(!rf||Do&&8<Do&&11>=Do),Pm=" ",Rm=!1;function Iv(t,e){switch(t){case"keyup":return MS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ms=!1;function NS(t,e){switch(t){case"compositionend":return jv(e);case"keypress":return e.which!==32?null:(Rm=!0,Pm);case"textInput":return t=e.data,t===Pm&&Rm?null:t;default:return null}}function FS(t,e){if(ms)return t==="compositionend"||!rf&&Iv(t,e)?(t=Pv(),Tl=Zp=Fn=null,ms=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Rv&&e.locale!=="ko"?null:e.data;default:return null}}var LS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Im(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!LS[t.type]:e==="textarea"}function Mv(t,e,r,n){uv(n),e=Zl(e,"onChange"),0<e.length&&(r=new ef("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Oo=null,ra=null;function DS(t){$v(t,0)}function Uc(t){var e=ys(t);if(nv(e))return t}function OS(t,e){if(t==="change")return e}var Bv=!1;if(hn){var Cu;if(hn){var ku="oninput"in document;if(!ku){var jm=document.createElement("div");jm.setAttribute("oninput","return;"),ku=typeof jm.oninput=="function"}Cu=ku}else Cu=!1;Bv=Cu&&(!document.documentMode||9<document.documentMode)}function Mm(){Oo&&(Oo.detachEvent("onpropertychange",Nv),ra=Oo=null)}function Nv(t){if(t.propertyName==="value"&&Uc(ra)){var e=[];Mv(e,ra,t,Yp(t)),fv(DS,e)}}function US(t,e,r){t==="focusin"?(Mm(),Oo=e,ra=r,Oo.attachEvent("onpropertychange",Nv)):t==="focusout"&&Mm()}function zS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uc(ra)}function GS(t,e){if(t==="click")return Uc(e)}function HS(t,e){if(t==="input"||t==="change")return Uc(e)}function $S(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cr=typeof Object.is=="function"?Object.is:$S;function na(t,e){if(Cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Vd.call(e,i)||!Cr(t[i],e[i]))return!1}return!0}function Bm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Nm(t,e){var r=Bm(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Bm(r)}}function Fv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Fv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Lv(){for(var t=window,e=Wl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Wl(t.document)}return e}function nf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function VS(t){var e=Lv(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Fv(r.ownerDocument.documentElement,r)){if(n!==null&&nf(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Nm(r,s);var o=Nm(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var WS=hn&&"documentMode"in document&&11>=document.documentMode,gs=null,uh=null,Uo=null,dh=!1;function Fm(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;dh||gs==null||gs!==Wl(n)||(n=gs,"selectionStart"in n&&nf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Uo&&na(Uo,n)||(Uo=n,n=Zl(uh,"onSelect"),0<n.length&&(e=new ef("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=gs)))}function Ga(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var xs={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionend:Ga("Transition","TransitionEnd")},Pu={},Dv={};hn&&(Dv=document.createElement("div").style,"AnimationEvent"in window||(delete xs.animationend.animation,delete xs.animationiteration.animation,delete xs.animationstart.animation),"TransitionEvent"in window||delete xs.transitionend.transition);function zc(t){if(Pu[t])return Pu[t];if(!xs[t])return t;var e=xs[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Dv)return Pu[t]=e[r];return t}var Ov=zc("animationend"),Uv=zc("animationiteration"),zv=zc("animationstart"),Gv=zc("transitionend"),Hv=new Map,Lm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ni(t,e){Hv.set(t,e),Oi(e,[t])}for(var Ru=0;Ru<Lm.length;Ru++){var Iu=Lm[Ru],XS=Iu.toLowerCase(),YS=Iu[0].toUpperCase()+Iu.slice(1);ni(XS,"on"+YS)}ni(Ov,"onAnimationEnd");ni(Uv,"onAnimationIteration");ni(zv,"onAnimationStart");ni("dblclick","onDoubleClick");ni("focusin","onFocus");ni("focusout","onBlur");ni(Gv,"onTransitionEnd");zs("onMouseEnter",["mouseout","mouseover"]);zs("onMouseLeave",["mouseout","mouseover"]);zs("onPointerEnter",["pointerout","pointerover"]);zs("onPointerLeave",["pointerout","pointerover"]);Oi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Oi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Oi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Oi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Oi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Oi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ao));function Dm(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Xw(n,e,void 0,t),t.currentTarget=null}function $v(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;Dm(i,a,u),s=c}else for(o=0;o<n.length;o++){if(a=n[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;Dm(i,a,u),s=c}}}if(Yl)throw t=oh,Yl=!1,oh=null,t}function Oe(t,e){var r=e[gh];r===void 0&&(r=e[gh]=new Set);var n=t+"__bubble";r.has(n)||(Vv(e,t,2,!1),r.add(n))}function ju(t,e,r){var n=0;e&&(n|=4),Vv(r,t,n,e)}var Ha="_reactListening"+Math.random().toString(36).slice(2);function ia(t){if(!t[Ha]){t[Ha]=!0,Qy.forEach(function(r){r!=="selectionchange"&&(KS.has(r)||ju(r,!1,t),ju(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ha]||(e[Ha]=!0,ju("selectionchange",!1,e))}}function Vv(t,e,r,n){switch(kv(e)){case 1:var i=cS;break;case 4:i=uS;break;default:i=Qp}r=i.bind(null,e,r,t),i=void 0,!sh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Mu(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Si(a),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}a=a.parentNode}}n=n.return}fv(function(){var u=s,d=Yp(r),h=[];e:{var p=Hv.get(t);if(p!==void 0){var f=ef,m=t;switch(t){case"keypress":if(Al(r)===0)break e;case"keydown":case"keyup":f=TS;break;case"focusin":m="focus",f=Au;break;case"focusout":m="blur",f=Au;break;case"beforeblur":case"afterblur":f=Au;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Am;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=pS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=kS;break;case Ov:case Uv:case zv:f=gS;break;case Gv:f=RS;break;case"scroll":f=dS;break;case"wheel":f=jS;break;case"copy":case"cut":case"paste":f=yS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=km}var _=(e&4)!==0,v=!_&&t==="scroll",x=_?p!==null?p+"Capture":null:p;_=[];for(var y=u,g;y!==null;){g=y;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,x!==null&&(w=Qo(y,x),w!=null&&_.push(sa(y,w,g)))),v)break;y=y.return}0<_.length&&(p=new f(p,m,null,r,d),h.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",p&&r!==nh&&(m=r.relatedTarget||r.fromElement)&&(Si(m)||m[pn]))break e;if((f||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,f?(m=r.relatedTarget||r.toElement,f=u,m=m?Si(m):null,m!==null&&(v=Ui(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(_=Am,w="onMouseLeave",x="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(_=km,w="onPointerLeave",x="onPointerEnter",y="pointer"),v=f==null?p:ys(f),g=m==null?p:ys(m),p=new _(w,y+"leave",f,r,d),p.target=v,p.relatedTarget=g,w=null,Si(d)===u&&(_=new _(x,y+"enter",m,r,d),_.target=g,_.relatedTarget=v,w=_),v=w,f&&m)t:{for(_=f,x=m,y=0,g=_;g;g=Ki(g))y++;for(g=0,w=x;w;w=Ki(w))g++;for(;0<y-g;)_=Ki(_),y--;for(;0<g-y;)x=Ki(x),g--;for(;y--;){if(_===x||x!==null&&_===x.alternate)break t;_=Ki(_),x=Ki(x)}_=null}else _=null;f!==null&&Om(h,p,f,_,!1),m!==null&&v!==null&&Om(h,v,m,_,!0)}}e:{if(p=u?ys(u):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var b=OS;else if(Im(p))if(Bv)b=HS;else{b=zS;var P=US}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(b=GS);if(b&&(b=b(t,u))){Mv(h,b,r,d);break e}P&&P(t,p,u),t==="focusout"&&(P=p._wrapperState)&&P.controlled&&p.type==="number"&&Qd(p,"number",p.value)}switch(P=u?ys(u):window,t){case"focusin":(Im(P)||P.contentEditable==="true")&&(gs=P,uh=u,Uo=null);break;case"focusout":Uo=uh=gs=null;break;case"mousedown":dh=!0;break;case"contextmenu":case"mouseup":case"dragend":dh=!1,Fm(h,r,d);break;case"selectionchange":if(WS)break;case"keydown":case"keyup":Fm(h,r,d)}var C;if(rf)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else ms?Iv(t,r)&&(E="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(Rv&&r.locale!=="ko"&&(ms||E!=="onCompositionStart"?E==="onCompositionEnd"&&ms&&(C=Pv()):(Fn=d,Zp="value"in Fn?Fn.value:Fn.textContent,ms=!0)),P=Zl(u,E),0<P.length&&(E=new Cm(E,t,null,r,d),h.push({event:E,listeners:P}),C?E.data=C:(C=jv(r),C!==null&&(E.data=C)))),(C=BS?NS(t,r):FS(t,r))&&(u=Zl(u,"onBeforeInput"),0<u.length&&(d=new Cm("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=C))}$v(h,e)})}function sa(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Zl(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Qo(t,r),s!=null&&n.unshift(sa(t,s,i)),s=Qo(t,e),s!=null&&n.push(sa(t,s,i))),t=t.return}return n}function Ki(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Om(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,c=a.alternate,u=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&u!==null&&(a=u,i?(c=Qo(r,s),c!=null&&o.unshift(sa(r,c,a))):i||(c=Qo(r,s),c!=null&&o.push(sa(r,c,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var qS=/\r\n?/g,JS=/\u0000|\uFFFD/g;function Um(t){return(typeof t=="string"?t:""+t).replace(qS,`
`).replace(JS,"")}function $a(t,e,r){if(e=Um(e),Um(t)!==e&&r)throw Error(V(425))}function ec(){}var hh=null,ph=null;function fh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var mh=typeof setTimeout=="function"?setTimeout:void 0,QS=typeof clearTimeout=="function"?clearTimeout:void 0,zm=typeof Promise=="function"?Promise:void 0,ZS=typeof queueMicrotask=="function"?queueMicrotask:typeof zm<"u"?function(t){return zm.resolve(null).then(t).catch(eb)}:mh;function eb(t){setTimeout(function(){throw t})}function Bu(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),ta(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ta(e)}function Vn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Gm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Zs=Math.random().toString(36).slice(2),zr="__reactFiber$"+Zs,oa="__reactProps$"+Zs,pn="__reactContainer$"+Zs,gh="__reactEvents$"+Zs,tb="__reactListeners$"+Zs,rb="__reactHandles$"+Zs;function Si(t){var e=t[zr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[pn]||r[zr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Gm(t);t!==null;){if(r=t[zr])return r;t=Gm(t)}return e}t=r,r=t.parentNode}return null}function Ea(t){return t=t[zr]||t[pn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ys(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(V(33))}function Gc(t){return t[oa]||null}var xh=[],vs=-1;function ii(t){return{current:t}}function ze(t){0>vs||(t.current=xh[vs],xh[vs]=null,vs--)}function Le(t,e){vs++,xh[vs]=t.current,t.current=e}var Zn={},kt=ii(Zn),zt=ii(!1),Ri=Zn;function Gs(t,e){var r=t.type.contextTypes;if(!r)return Zn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Gt(t){return t=t.childContextTypes,t!=null}function tc(){ze(zt),ze(kt)}function Hm(t,e,r){if(kt.current!==Zn)throw Error(V(168));Le(kt,e),Le(zt,r)}function Wv(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(V(108,Uw(t)||"Unknown",i));return Ke({},r,n)}function rc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zn,Ri=kt.current,Le(kt,t),Le(zt,zt.current),!0}function $m(t,e,r){var n=t.stateNode;if(!n)throw Error(V(169));r?(t=Wv(t,e,Ri),n.__reactInternalMemoizedMergedChildContext=t,ze(zt),ze(kt),Le(kt,t)):ze(zt),Le(zt,r)}var rn=null,Hc=!1,Nu=!1;function Xv(t){rn===null?rn=[t]:rn.push(t)}function nb(t){Hc=!0,Xv(t)}function si(){if(!Nu&&rn!==null){Nu=!0;var t=0,e=Ne;try{var r=rn;for(Ne=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}rn=null,Hc=!1}catch(i){throw rn!==null&&(rn=rn.slice(t+1)),yv(Kp,si),i}finally{Ne=e,Nu=!1}}return null}var _s=[],ws=0,nc=null,ic=0,nr=[],ir=0,Ii=null,nn=1,sn="";function hi(t,e){_s[ws++]=ic,_s[ws++]=nc,nc=t,ic=e}function Yv(t,e,r){nr[ir++]=nn,nr[ir++]=sn,nr[ir++]=Ii,Ii=t;var n=nn;t=sn;var i=32-br(n)-1;n&=~(1<<i),r+=1;var s=32-br(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,nn=1<<32-br(e)+i|r<<i|n,sn=s+t}else nn=1<<s|r<<i|n,sn=t}function sf(t){t.return!==null&&(hi(t,1),Yv(t,1,0))}function of(t){for(;t===nc;)nc=_s[--ws],_s[ws]=null,ic=_s[--ws],_s[ws]=null;for(;t===Ii;)Ii=nr[--ir],nr[ir]=null,sn=nr[--ir],nr[ir]=null,nn=nr[--ir],nr[ir]=null}var qt=null,Xt=null,He=!1,wr=null;function Kv(t,e){var r=sr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Vm(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,qt=t,Xt=Vn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,qt=t,Xt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ii!==null?{id:nn,overflow:sn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=sr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,qt=t,Xt=null,!0):!1;default:return!1}}function yh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function vh(t){if(He){var e=Xt;if(e){var r=e;if(!Vm(t,e)){if(yh(t))throw Error(V(418));e=Vn(r.nextSibling);var n=qt;e&&Vm(t,e)?Kv(n,r):(t.flags=t.flags&-4097|2,He=!1,qt=t)}}else{if(yh(t))throw Error(V(418));t.flags=t.flags&-4097|2,He=!1,qt=t}}}function Wm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qt=t}function Va(t){if(t!==qt)return!1;if(!He)return Wm(t),He=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!fh(t.type,t.memoizedProps)),e&&(e=Xt)){if(yh(t))throw qv(),Error(V(418));for(;e;)Kv(t,e),e=Vn(e.nextSibling)}if(Wm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(V(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Xt=Vn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Xt=null}}else Xt=qt?Vn(t.stateNode.nextSibling):null;return!0}function qv(){for(var t=Xt;t;)t=Vn(t.nextSibling)}function Hs(){Xt=qt=null,He=!1}function af(t){wr===null?wr=[t]:wr.push(t)}var ib=yn.ReactCurrentBatchConfig;function ho(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(V(309));var n=r.stateNode}if(!n)throw Error(V(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(V(284));if(!r._owner)throw Error(V(290,t))}return t}function Wa(t,e){throw t=Object.prototype.toString.call(e),Error(V(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Xm(t){var e=t._init;return e(t._payload)}function Jv(t){function e(x,y){if(t){var g=x.deletions;g===null?(x.deletions=[y],x.flags|=16):g.push(y)}}function r(x,y){if(!t)return null;for(;y!==null;)e(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function i(x,y){return x=Kn(x,y),x.index=0,x.sibling=null,x}function s(x,y,g){return x.index=g,t?(g=x.alternate,g!==null?(g=g.index,g<y?(x.flags|=2,y):g):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,y,g,w){return y===null||y.tag!==6?(y=Gu(g,x.mode,w),y.return=x,y):(y=i(y,g),y.return=x,y)}function c(x,y,g,w){var b=g.type;return b===fs?d(x,y,g.props.children,w,g.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Rn&&Xm(b)===y.type)?(w=i(y,g.props),w.ref=ho(x,y,g),w.return=x,w):(w=Ml(g.type,g.key,g.props,null,x.mode,w),w.ref=ho(x,y,g),w.return=x,w)}function u(x,y,g,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=Hu(g,x.mode,w),y.return=x,y):(y=i(y,g.children||[]),y.return=x,y)}function d(x,y,g,w,b){return y===null||y.tag!==7?(y=Ai(g,x.mode,w,b),y.return=x,y):(y=i(y,g),y.return=x,y)}function h(x,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Gu(""+y,x.mode,g),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Na:return g=Ml(y.type,y.key,y.props,null,x.mode,g),g.ref=ho(x,null,y),g.return=x,g;case ps:return y=Hu(y,x.mode,g),y.return=x,y;case Rn:var w=y._init;return h(x,w(y._payload),g)}if(Eo(y)||oo(y))return y=Ai(y,x.mode,g,null),y.return=x,y;Wa(x,y)}return null}function p(x,y,g,w){var b=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return b!==null?null:a(x,y,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Na:return g.key===b?c(x,y,g,w):null;case ps:return g.key===b?u(x,y,g,w):null;case Rn:return b=g._init,p(x,y,b(g._payload),w)}if(Eo(g)||oo(g))return b!==null?null:d(x,y,g,w,null);Wa(x,g)}return null}function f(x,y,g,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(g)||null,a(y,x,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Na:return x=x.get(w.key===null?g:w.key)||null,c(y,x,w,b);case ps:return x=x.get(w.key===null?g:w.key)||null,u(y,x,w,b);case Rn:var P=w._init;return f(x,y,g,P(w._payload),b)}if(Eo(w)||oo(w))return x=x.get(g)||null,d(y,x,w,b,null);Wa(y,w)}return null}function m(x,y,g,w){for(var b=null,P=null,C=y,E=y=0,M=null;C!==null&&E<g.length;E++){C.index>E?(M=C,C=null):M=C.sibling;var B=p(x,C,g[E],w);if(B===null){C===null&&(C=M);break}t&&C&&B.alternate===null&&e(x,C),y=s(B,y,E),P===null?b=B:P.sibling=B,P=B,C=M}if(E===g.length)return r(x,C),He&&hi(x,E),b;if(C===null){for(;E<g.length;E++)C=h(x,g[E],w),C!==null&&(y=s(C,y,E),P===null?b=C:P.sibling=C,P=C);return He&&hi(x,E),b}for(C=n(x,C);E<g.length;E++)M=f(C,x,E,g[E],w),M!==null&&(t&&M.alternate!==null&&C.delete(M.key===null?E:M.key),y=s(M,y,E),P===null?b=M:P.sibling=M,P=M);return t&&C.forEach(function(N){return e(x,N)}),He&&hi(x,E),b}function _(x,y,g,w){var b=oo(g);if(typeof b!="function")throw Error(V(150));if(g=b.call(g),g==null)throw Error(V(151));for(var P=b=null,C=y,E=y=0,M=null,B=g.next();C!==null&&!B.done;E++,B=g.next()){C.index>E?(M=C,C=null):M=C.sibling;var N=p(x,C,B.value,w);if(N===null){C===null&&(C=M);break}t&&C&&N.alternate===null&&e(x,C),y=s(N,y,E),P===null?b=N:P.sibling=N,P=N,C=M}if(B.done)return r(x,C),He&&hi(x,E),b;if(C===null){for(;!B.done;E++,B=g.next())B=h(x,B.value,w),B!==null&&(y=s(B,y,E),P===null?b=B:P.sibling=B,P=B);return He&&hi(x,E),b}for(C=n(x,C);!B.done;E++,B=g.next())B=f(C,x,E,B.value,w),B!==null&&(t&&B.alternate!==null&&C.delete(B.key===null?E:B.key),y=s(B,y,E),P===null?b=B:P.sibling=B,P=B);return t&&C.forEach(function(D){return e(x,D)}),He&&hi(x,E),b}function v(x,y,g,w){if(typeof g=="object"&&g!==null&&g.type===fs&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Na:e:{for(var b=g.key,P=y;P!==null;){if(P.key===b){if(b=g.type,b===fs){if(P.tag===7){r(x,P.sibling),y=i(P,g.props.children),y.return=x,x=y;break e}}else if(P.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Rn&&Xm(b)===P.type){r(x,P.sibling),y=i(P,g.props),y.ref=ho(x,P,g),y.return=x,x=y;break e}r(x,P);break}else e(x,P);P=P.sibling}g.type===fs?(y=Ai(g.props.children,x.mode,w,g.key),y.return=x,x=y):(w=Ml(g.type,g.key,g.props,null,x.mode,w),w.ref=ho(x,y,g),w.return=x,x=w)}return o(x);case ps:e:{for(P=g.key;y!==null;){if(y.key===P)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){r(x,y.sibling),y=i(y,g.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else e(x,y);y=y.sibling}y=Hu(g,x.mode,w),y.return=x,x=y}return o(x);case Rn:return P=g._init,v(x,y,P(g._payload),w)}if(Eo(g))return m(x,y,g,w);if(oo(g))return _(x,y,g,w);Wa(x,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(r(x,y.sibling),y=i(y,g),y.return=x,x=y):(r(x,y),y=Gu(g,x.mode,w),y.return=x,x=y),o(x)):r(x,y)}return v}var $s=Jv(!0),Qv=Jv(!1),sc=ii(null),oc=null,Ss=null,lf=null;function cf(){lf=Ss=oc=null}function uf(t){var e=sc.current;ze(sc),t._currentValue=e}function _h(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Is(t,e){oc=t,lf=Ss=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Dt=!0),t.firstContext=null)}function cr(t){var e=t._currentValue;if(lf!==t)if(t={context:t,memoizedValue:e,next:null},Ss===null){if(oc===null)throw Error(V(308));Ss=t,oc.dependencies={lanes:0,firstContext:t}}else Ss=Ss.next=t;return e}var bi=null;function df(t){bi===null?bi=[t]:bi.push(t)}function Zv(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,df(e)):(r.next=i.next,i.next=r),e.interleaved=r,fn(t,n)}function fn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var In=!1;function hf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function e0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function un(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Wn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,je&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,fn(t,r)}return i=n.interleaved,i===null?(e.next=e,df(n)):(e.next=i.next,i.next=e),n.interleaved=e,fn(t,r)}function Cl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,qp(t,r)}}function Ym(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ac(t,e,r,n){var i=t.updateQueue;In=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(s!==null){var h=i.baseState;o=0,d=u=c=null,a=s;do{var p=a.lane,f=a.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,_=a;switch(p=e,f=r,_.tag){case 1:if(m=_.payload,typeof m=="function"){h=m.call(f,h,p);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=_.payload,p=typeof m=="function"?m.call(f,h,p):m,p==null)break e;h=Ke({},h,p);break e;case 2:In=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else f={eventTime:f,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=f,c=h):d=d.next=f,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Mi|=o,t.lanes=o,t.memoizedState=h}}function Km(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(V(191,i));i.call(n)}}}var Ta={},$r=ii(Ta),aa=ii(Ta),la=ii(Ta);function Ei(t){if(t===Ta)throw Error(V(174));return t}function pf(t,e){switch(Le(la,e),Le(aa,t),Le($r,Ta),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:eh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=eh(e,t)}ze($r),Le($r,e)}function Vs(){ze($r),ze(aa),ze(la)}function t0(t){Ei(la.current);var e=Ei($r.current),r=eh(e,t.type);e!==r&&(Le(aa,t),Le($r,r))}function ff(t){aa.current===t&&(ze($r),ze(aa))}var We=ii(0);function lc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fu=[];function mf(){for(var t=0;t<Fu.length;t++)Fu[t]._workInProgressVersionPrimary=null;Fu.length=0}var kl=yn.ReactCurrentDispatcher,Lu=yn.ReactCurrentBatchConfig,ji=0,Ye=null,ct=null,ht=null,cc=!1,zo=!1,ca=0,sb=0;function Tt(){throw Error(V(321))}function gf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Cr(t[r],e[r]))return!1;return!0}function xf(t,e,r,n,i,s){if(ji=s,Ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kl.current=t===null||t.memoizedState===null?cb:ub,t=r(n,i),zo){s=0;do{if(zo=!1,ca=0,25<=s)throw Error(V(301));s+=1,ht=ct=null,e.updateQueue=null,kl.current=db,t=r(n,i)}while(zo)}if(kl.current=uc,e=ct!==null&&ct.next!==null,ji=0,ht=ct=Ye=null,cc=!1,e)throw Error(V(300));return t}function yf(){var t=ca!==0;return ca=0,t}function Lr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Ye.memoizedState=ht=t:ht=ht.next=t,ht}function ur(){if(ct===null){var t=Ye.alternate;t=t!==null?t.memoizedState:null}else t=ct.next;var e=ht===null?Ye.memoizedState:ht.next;if(e!==null)ht=e,ct=t;else{if(t===null)throw Error(V(310));ct=t,t={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},ht===null?Ye.memoizedState=ht=t:ht=ht.next=t}return ht}function ua(t,e){return typeof e=="function"?e(t):e}function Du(t){var e=ur(),r=e.queue;if(r===null)throw Error(V(311));r.lastRenderedReducer=t;var n=ct,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,c=null,u=s;do{var d=u.lane;if((ji&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=h,o=n):c=c.next=h,Ye.lanes|=d,Mi|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=a,Cr(n,e.memoizedState)||(Dt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Ye.lanes|=s,Mi|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Ou(t){var e=ur(),r=e.queue;if(r===null)throw Error(V(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Cr(s,e.memoizedState)||(Dt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function r0(){}function n0(t,e){var r=Ye,n=ur(),i=e(),s=!Cr(n.memoizedState,i);if(s&&(n.memoizedState=i,Dt=!0),n=n.queue,vf(o0.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ht!==null&&ht.memoizedState.tag&1){if(r.flags|=2048,da(9,s0.bind(null,r,n,i,e),void 0,null),ft===null)throw Error(V(349));ji&30||i0(r,e,i)}return i}function i0(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function s0(t,e,r,n){e.value=r,e.getSnapshot=n,a0(e)&&l0(t)}function o0(t,e,r){return r(function(){a0(e)&&l0(t)})}function a0(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Cr(t,r)}catch{return!0}}function l0(t){var e=fn(t,1);e!==null&&Er(e,t,1,-1)}function qm(t){var e=Lr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:t},e.queue=t,t=t.dispatch=lb.bind(null,Ye,t),[e.memoizedState,t]}function da(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function c0(){return ur().memoizedState}function Pl(t,e,r,n){var i=Lr();Ye.flags|=t,i.memoizedState=da(1|e,r,void 0,n===void 0?null:n)}function $c(t,e,r,n){var i=ur();n=n===void 0?null:n;var s=void 0;if(ct!==null){var o=ct.memoizedState;if(s=o.destroy,n!==null&&gf(n,o.deps)){i.memoizedState=da(e,r,s,n);return}}Ye.flags|=t,i.memoizedState=da(1|e,r,s,n)}function Jm(t,e){return Pl(8390656,8,t,e)}function vf(t,e){return $c(2048,8,t,e)}function u0(t,e){return $c(4,2,t,e)}function d0(t,e){return $c(4,4,t,e)}function h0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function p0(t,e,r){return r=r!=null?r.concat([t]):null,$c(4,4,h0.bind(null,e,t),r)}function _f(){}function f0(t,e){var r=ur();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&gf(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function m0(t,e){var r=ur();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&gf(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function g0(t,e,r){return ji&21?(Cr(r,e)||(r=wv(),Ye.lanes|=r,Mi|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Dt=!0),t.memoizedState=r)}function ob(t,e){var r=Ne;Ne=r!==0&&4>r?r:4,t(!0);var n=Lu.transition;Lu.transition={};try{t(!1),e()}finally{Ne=r,Lu.transition=n}}function x0(){return ur().memoizedState}function ab(t,e,r){var n=Yn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},y0(t))v0(e,r);else if(r=Zv(t,e,r,n),r!==null){var i=It();Er(r,t,n,i),_0(r,e,n)}}function lb(t,e,r){var n=Yn(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(y0(t))v0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,Cr(a,o)){var c=e.interleaved;c===null?(i.next=i,df(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=Zv(t,e,i,n),r!==null&&(i=It(),Er(r,t,n,i),_0(r,e,n))}}function y0(t){var e=t.alternate;return t===Ye||e!==null&&e===Ye}function v0(t,e){zo=cc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function _0(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,qp(t,r)}}var uc={readContext:cr,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},cb={readContext:cr,useCallback:function(t,e){return Lr().memoizedState=[t,e===void 0?null:e],t},useContext:cr,useEffect:Jm,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Pl(4194308,4,h0.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Pl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Pl(4,2,t,e)},useMemo:function(t,e){var r=Lr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Lr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=ab.bind(null,Ye,t),[n.memoizedState,t]},useRef:function(t){var e=Lr();return t={current:t},e.memoizedState=t},useState:qm,useDebugValue:_f,useDeferredValue:function(t){return Lr().memoizedState=t},useTransition:function(){var t=qm(!1),e=t[0];return t=ob.bind(null,t[1]),Lr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ye,i=Lr();if(He){if(r===void 0)throw Error(V(407));r=r()}else{if(r=e(),ft===null)throw Error(V(349));ji&30||i0(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Jm(o0.bind(null,n,s,t),[t]),n.flags|=2048,da(9,s0.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Lr(),e=ft.identifierPrefix;if(He){var r=sn,n=nn;r=(n&~(1<<32-br(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=ca++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=sb++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ub={readContext:cr,useCallback:f0,useContext:cr,useEffect:vf,useImperativeHandle:p0,useInsertionEffect:u0,useLayoutEffect:d0,useMemo:m0,useReducer:Du,useRef:c0,useState:function(){return Du(ua)},useDebugValue:_f,useDeferredValue:function(t){var e=ur();return g0(e,ct.memoizedState,t)},useTransition:function(){var t=Du(ua)[0],e=ur().memoizedState;return[t,e]},useMutableSource:r0,useSyncExternalStore:n0,useId:x0,unstable_isNewReconciler:!1},db={readContext:cr,useCallback:f0,useContext:cr,useEffect:vf,useImperativeHandle:p0,useInsertionEffect:u0,useLayoutEffect:d0,useMemo:m0,useReducer:Ou,useRef:c0,useState:function(){return Ou(ua)},useDebugValue:_f,useDeferredValue:function(t){var e=ur();return ct===null?e.memoizedState=t:g0(e,ct.memoizedState,t)},useTransition:function(){var t=Ou(ua)[0],e=ur().memoizedState;return[t,e]},useMutableSource:r0,useSyncExternalStore:n0,useId:x0,unstable_isNewReconciler:!1};function vr(t,e){if(t&&t.defaultProps){e=Ke({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function wh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ke({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Vc={isMounted:function(t){return(t=t._reactInternals)?Ui(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=It(),i=Yn(t),s=un(n,i);s.payload=e,r!=null&&(s.callback=r),e=Wn(t,s,i),e!==null&&(Er(e,t,i,n),Cl(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=It(),i=Yn(t),s=un(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Wn(t,s,i),e!==null&&(Er(e,t,i,n),Cl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=It(),n=Yn(t),i=un(r,n);i.tag=2,e!=null&&(i.callback=e),e=Wn(t,i,n),e!==null&&(Er(e,t,n,r),Cl(e,t,n))}};function Qm(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!na(r,n)||!na(i,s):!0}function w0(t,e,r){var n=!1,i=Zn,s=e.contextType;return typeof s=="object"&&s!==null?s=cr(s):(i=Gt(e)?Ri:kt.current,n=e.contextTypes,s=(n=n!=null)?Gs(t,i):Zn),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Vc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Zm(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Vc.enqueueReplaceState(e,e.state,null)}function Sh(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},hf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=cr(s):(s=Gt(e)?Ri:kt.current,i.context=Gs(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(wh(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Vc.enqueueReplaceState(i,i.state,null),ac(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ws(t,e){try{var r="",n=e;do r+=Ow(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Uu(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function bh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var hb=typeof WeakMap=="function"?WeakMap:Map;function S0(t,e,r){r=un(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){hc||(hc=!0,Mh=n),bh(t,e)},r}function b0(t,e,r){r=un(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){bh(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){bh(t,e),typeof n!="function"&&(Xn===null?Xn=new Set([this]):Xn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function eg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new hb;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=Ab.bind(null,t,e,r),e.then(t,t))}function tg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function rg(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=un(-1,1),e.tag=2,Wn(r,e,1))),r.lanes|=1),t)}var pb=yn.ReactCurrentOwner,Dt=!1;function Pt(t,e,r,n){e.child=t===null?Qv(e,null,r,n):$s(e,t.child,r,n)}function ng(t,e,r,n,i){r=r.render;var s=e.ref;return Is(e,i),n=xf(t,e,r,n,s,i),r=yf(),t!==null&&!Dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,mn(t,e,i)):(He&&r&&sf(e),e.flags|=1,Pt(t,e,n,i),e.child)}function ig(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!kf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,E0(t,e,s,n,i)):(t=Ml(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:na,r(o,n)&&t.ref===e.ref)return mn(t,e,i)}return e.flags|=1,t=Kn(s,n),t.ref=e.ref,t.return=e,e.child=t}function E0(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(na(s,n)&&t.ref===e.ref)if(Dt=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Dt=!0);else return e.lanes=t.lanes,mn(t,e,i)}return Eh(t,e,r,n,i)}function T0(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(Es,Wt),Wt|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Le(Es,Wt),Wt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Le(Es,Wt),Wt|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Le(Es,Wt),Wt|=n;return Pt(t,e,i,r),e.child}function A0(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Eh(t,e,r,n,i){var s=Gt(r)?Ri:kt.current;return s=Gs(e,s),Is(e,i),r=xf(t,e,r,n,s,i),n=yf(),t!==null&&!Dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,mn(t,e,i)):(He&&n&&sf(e),e.flags|=1,Pt(t,e,r,i),e.child)}function sg(t,e,r,n,i){if(Gt(r)){var s=!0;rc(e)}else s=!1;if(Is(e,i),e.stateNode===null)Rl(t,e),w0(e,r,n),Sh(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=cr(u):(u=Gt(r)?Ri:kt.current,u=Gs(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==u)&&Zm(e,o,n,u),In=!1;var p=e.memoizedState;o.state=p,ac(e,n,o,i),c=e.memoizedState,a!==n||p!==c||zt.current||In?(typeof d=="function"&&(wh(e,r,d,n),c=e.memoizedState),(a=In||Qm(e,r,a,n,p,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,e0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:vr(e.type,a),o.props=u,h=e.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=cr(c):(c=Gt(r)?Ri:kt.current,c=Gs(e,c));var f=r.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||p!==c)&&Zm(e,o,n,c),In=!1,p=e.memoizedState,o.state=p,ac(e,n,o,i);var m=e.memoizedState;a!==h||p!==m||zt.current||In?(typeof f=="function"&&(wh(e,r,f,n),m=e.memoizedState),(u=In||Qm(e,r,u,n,p,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return Th(t,e,r,n,s,i)}function Th(t,e,r,n,i,s){A0(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&$m(e,r,!1),mn(t,e,s);n=e.stateNode,pb.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=$s(e,t.child,null,s),e.child=$s(e,null,a,s)):Pt(t,e,a,s),e.memoizedState=n.state,i&&$m(e,r,!0),e.child}function C0(t){var e=t.stateNode;e.pendingContext?Hm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hm(t,e.context,!1),pf(t,e.containerInfo)}function og(t,e,r,n,i){return Hs(),af(i),e.flags|=256,Pt(t,e,r,n),e.child}var Ah={dehydrated:null,treeContext:null,retryLane:0};function Ch(t){return{baseLanes:t,cachePool:null,transitions:null}}function k0(t,e,r){var n=e.pendingProps,i=We.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Le(We,i&1),t===null)return vh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Yc(o,n,0,null),t=Ai(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ch(r),e.memoizedState=Ah,t):wf(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return fb(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Kn(i,c),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Kn(a,s):(s=Ai(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?Ch(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=Ah,n}return s=t.child,t=s.sibling,n=Kn(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function wf(t,e){return e=Yc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xa(t,e,r,n){return n!==null&&af(n),$s(e,t.child,null,r),t=wf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function fb(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=Uu(Error(V(422))),Xa(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Yc({mode:"visible",children:n.children},i,0,null),s=Ai(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&$s(e,t.child,null,o),e.child.memoizedState=Ch(o),e.memoizedState=Ah,s);if(!(e.mode&1))return Xa(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(V(419)),n=Uu(s,n,void 0),Xa(t,e,o,n)}if(a=(o&t.childLanes)!==0,Dt||a){if(n=ft,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,fn(t,i),Er(n,t,i,-1))}return Cf(),n=Uu(Error(V(421))),Xa(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Cb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Xt=Vn(i.nextSibling),qt=e,He=!0,wr=null,t!==null&&(nr[ir++]=nn,nr[ir++]=sn,nr[ir++]=Ii,nn=t.id,sn=t.overflow,Ii=e),e=wf(e,n.children),e.flags|=4096,e)}function ag(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),_h(t.return,e,r)}function zu(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function P0(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Pt(t,e,n.children,r),n=We.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ag(t,r,e);else if(t.tag===19)ag(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Le(We,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&lc(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),zu(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&lc(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}zu(e,!0,r,null,s);break;case"together":zu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function mn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Mi|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(V(153));if(e.child!==null){for(t=e.child,r=Kn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Kn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function mb(t,e,r){switch(e.tag){case 3:C0(e),Hs();break;case 5:t0(e);break;case 1:Gt(e.type)&&rc(e);break;case 4:pf(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Le(sc,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Le(We,We.current&1),e.flags|=128,null):r&e.child.childLanes?k0(t,e,r):(Le(We,We.current&1),t=mn(t,e,r),t!==null?t.sibling:null);Le(We,We.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return P0(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Le(We,We.current),n)break;return null;case 22:case 23:return e.lanes=0,T0(t,e,r)}return mn(t,e,r)}var R0,kh,I0,j0;R0=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};kh=function(){};I0=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Ei($r.current);var s=null;switch(r){case"input":i=qd(t,i),n=qd(t,n),s=[];break;case"select":i=Ke({},i,{value:void 0}),n=Ke({},n,{value:void 0}),s=[];break;case"textarea":i=Zd(t,i),n=Zd(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=ec)}th(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(qo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(a=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(qo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Oe("scroll",t),s||a===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};j0=function(t,e,r,n){r!==n&&(e.flags|=4)};function po(t,e){if(!He)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function At(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function gb(t,e,r){var n=e.pendingProps;switch(of(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(e),null;case 1:return Gt(e.type)&&tc(),At(e),null;case 3:return n=e.stateNode,Vs(),ze(zt),ze(kt),mf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Va(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wr!==null&&(Fh(wr),wr=null))),kh(t,e),At(e),null;case 5:ff(e);var i=Ei(la.current);if(r=e.type,t!==null&&e.stateNode!=null)I0(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(V(166));return At(e),null}if(t=Ei($r.current),Va(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[zr]=e,n[oa]=s,t=(e.mode&1)!==0,r){case"dialog":Oe("cancel",n),Oe("close",n);break;case"iframe":case"object":case"embed":Oe("load",n);break;case"video":case"audio":for(i=0;i<Ao.length;i++)Oe(Ao[i],n);break;case"source":Oe("error",n);break;case"img":case"image":case"link":Oe("error",n),Oe("load",n);break;case"details":Oe("toggle",n);break;case"input":gm(n,s),Oe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Oe("invalid",n);break;case"textarea":ym(n,s),Oe("invalid",n)}th(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&$a(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&$a(n.textContent,a,t),i=["children",""+a]):qo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Oe("scroll",n)}switch(r){case"input":Fa(n),xm(n,s,!0);break;case"textarea":Fa(n),vm(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ec)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ov(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[zr]=e,t[oa]=n,R0(t,e,!1,!1),e.stateNode=t;e:{switch(o=rh(r,n),r){case"dialog":Oe("cancel",t),Oe("close",t),i=n;break;case"iframe":case"object":case"embed":Oe("load",t),i=n;break;case"video":case"audio":for(i=0;i<Ao.length;i++)Oe(Ao[i],t);i=n;break;case"source":Oe("error",t),i=n;break;case"img":case"image":case"link":Oe("error",t),Oe("load",t),i=n;break;case"details":Oe("toggle",t),i=n;break;case"input":gm(t,n),i=qd(t,n),Oe("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ke({},n,{value:void 0}),Oe("invalid",t);break;case"textarea":ym(t,n),i=Zd(t,n),Oe("invalid",t);break;default:i=n}th(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?cv(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&av(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Jo(t,c):typeof c=="number"&&Jo(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(qo.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Oe("scroll",t):c!=null&&$p(t,s,c,o))}switch(r){case"input":Fa(t),xm(t,n,!1);break;case"textarea":Fa(t),vm(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Qn(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Cs(t,!!n.multiple,s,!1):n.defaultValue!=null&&Cs(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ec)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return At(e),null;case 6:if(t&&e.stateNode!=null)j0(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(V(166));if(r=Ei(la.current),Ei($r.current),Va(e)){if(n=e.stateNode,r=e.memoizedProps,n[zr]=e,(s=n.nodeValue!==r)&&(t=qt,t!==null))switch(t.tag){case 3:$a(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$a(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[zr]=e,e.stateNode=n}return At(e),null;case 13:if(ze(We),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(He&&Xt!==null&&e.mode&1&&!(e.flags&128))qv(),Hs(),e.flags|=98560,s=!1;else if(s=Va(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(V(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(V(317));s[zr]=e}else Hs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;At(e),s=!1}else wr!==null&&(Fh(wr),wr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||We.current&1?ut===0&&(ut=3):Cf())),e.updateQueue!==null&&(e.flags|=4),At(e),null);case 4:return Vs(),kh(t,e),t===null&&ia(e.stateNode.containerInfo),At(e),null;case 10:return uf(e.type._context),At(e),null;case 17:return Gt(e.type)&&tc(),At(e),null;case 19:if(ze(We),s=e.memoizedState,s===null)return At(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)po(s,!1);else{if(ut!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=lc(t),o!==null){for(e.flags|=128,po(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Le(We,We.current&1|2),e.child}t=t.sibling}s.tail!==null&&nt()>Xs&&(e.flags|=128,n=!0,po(s,!1),e.lanes=4194304)}else{if(!n)if(t=lc(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),po(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!He)return At(e),null}else 2*nt()-s.renderingStartTime>Xs&&r!==1073741824&&(e.flags|=128,n=!0,po(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=nt(),e.sibling=null,r=We.current,Le(We,n?r&1|2:r&1),e):(At(e),null);case 22:case 23:return Af(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Wt&1073741824&&(At(e),e.subtreeFlags&6&&(e.flags|=8192)):At(e),null;case 24:return null;case 25:return null}throw Error(V(156,e.tag))}function xb(t,e){switch(of(e),e.tag){case 1:return Gt(e.type)&&tc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vs(),ze(zt),ze(kt),mf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ff(e),null;case 13:if(ze(We),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(V(340));Hs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ze(We),null;case 4:return Vs(),null;case 10:return uf(e.type._context),null;case 22:case 23:return Af(),null;case 24:return null;default:return null}}var Ya=!1,Ct=!1,yb=typeof WeakSet=="function"?WeakSet:Set,ee=null;function bs(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ze(t,e,n)}else r.current=null}function Ph(t,e,r){try{r()}catch(n){Ze(t,e,n)}}var lg=!1;function vb(t,e){if(hh=Jl,t=Lv(),nf(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,c=-1,u=0,d=0,h=t,p=null;t:for(;;){for(var f;h!==r||i!==0&&h.nodeType!==3||(a=o+i),h!==s||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)p=h,h=f;for(;;){if(h===t)break t;if(p===r&&++u===i&&(a=o),p===s&&++d===n&&(c=o),(f=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=f}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ph={focusedElem:t,selectionRange:r},Jl=!1,ee=e;ee!==null;)if(e=ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ee=t;else for(;ee!==null;){e=ee;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var _=m.memoizedProps,v=m.memoizedState,x=e.stateNode,y=x.getSnapshotBeforeUpdate(e.elementType===e.type?_:vr(e.type,_),v);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(w){Ze(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ee=t;break}ee=e.return}return m=lg,lg=!1,m}function Go(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Ph(e,r,s)}i=i.next}while(i!==n)}}function Wc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Rh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function M0(t){var e=t.alternate;e!==null&&(t.alternate=null,M0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zr],delete e[oa],delete e[gh],delete e[tb],delete e[rb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function B0(t){return t.tag===5||t.tag===3||t.tag===4}function cg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||B0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ih(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=ec));else if(n!==4&&(t=t.child,t!==null))for(Ih(t,e,r),t=t.sibling;t!==null;)Ih(t,e,r),t=t.sibling}function jh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(jh(t,e,r),t=t.sibling;t!==null;)jh(t,e,r),t=t.sibling}var yt=null,_r=!1;function En(t,e,r){for(r=r.child;r!==null;)N0(t,e,r),r=r.sibling}function N0(t,e,r){if(Hr&&typeof Hr.onCommitFiberUnmount=="function")try{Hr.onCommitFiberUnmount(Dc,r)}catch{}switch(r.tag){case 5:Ct||bs(r,e);case 6:var n=yt,i=_r;yt=null,En(t,e,r),yt=n,_r=i,yt!==null&&(_r?(t=yt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):yt.removeChild(r.stateNode));break;case 18:yt!==null&&(_r?(t=yt,r=r.stateNode,t.nodeType===8?Bu(t.parentNode,r):t.nodeType===1&&Bu(t,r),ta(t)):Bu(yt,r.stateNode));break;case 4:n=yt,i=_r,yt=r.stateNode.containerInfo,_r=!0,En(t,e,r),yt=n,_r=i;break;case 0:case 11:case 14:case 15:if(!Ct&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Ph(r,e,o),i=i.next}while(i!==n)}En(t,e,r);break;case 1:if(!Ct&&(bs(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Ze(r,e,a)}En(t,e,r);break;case 21:En(t,e,r);break;case 22:r.mode&1?(Ct=(n=Ct)||r.memoizedState!==null,En(t,e,r),Ct=n):En(t,e,r);break;default:En(t,e,r)}}function ug(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new yb),e.forEach(function(n){var i=kb.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function fr(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:yt=a.stateNode,_r=!1;break e;case 3:yt=a.stateNode.containerInfo,_r=!0;break e;case 4:yt=a.stateNode.containerInfo,_r=!0;break e}a=a.return}if(yt===null)throw Error(V(160));N0(s,o,i),yt=null,_r=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Ze(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)F0(e,t),e=e.sibling}function F0(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(fr(e,t),Rr(t),n&4){try{Go(3,t,t.return),Wc(3,t)}catch(_){Ze(t,t.return,_)}try{Go(5,t,t.return)}catch(_){Ze(t,t.return,_)}}break;case 1:fr(e,t),Rr(t),n&512&&r!==null&&bs(r,r.return);break;case 5:if(fr(e,t),Rr(t),n&512&&r!==null&&bs(r,r.return),t.flags&32){var i=t.stateNode;try{Jo(i,"")}catch(_){Ze(t,t.return,_)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&iv(i,s),rh(a,o);var u=rh(a,s);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?cv(i,h):d==="dangerouslySetInnerHTML"?av(i,h):d==="children"?Jo(i,h):$p(i,d,h,u)}switch(a){case"input":Jd(i,s);break;case"textarea":sv(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Cs(i,!!s.multiple,f,!1):p!==!!s.multiple&&(s.defaultValue!=null?Cs(i,!!s.multiple,s.defaultValue,!0):Cs(i,!!s.multiple,s.multiple?[]:"",!1))}i[oa]=s}catch(_){Ze(t,t.return,_)}}break;case 6:if(fr(e,t),Rr(t),n&4){if(t.stateNode===null)throw Error(V(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(_){Ze(t,t.return,_)}}break;case 3:if(fr(e,t),Rr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ta(e.containerInfo)}catch(_){Ze(t,t.return,_)}break;case 4:fr(e,t),Rr(t);break;case 13:fr(e,t),Rr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ef=nt())),n&4&&ug(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Ct=(u=Ct)||d,fr(e,t),Ct=u):fr(e,t),Rr(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ee=t,d=t.child;d!==null;){for(h=ee=d;ee!==null;){switch(p=ee,f=p.child,p.tag){case 0:case 11:case 14:case 15:Go(4,p,p.return);break;case 1:bs(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(_){Ze(n,r,_)}}break;case 5:bs(p,p.return);break;case 22:if(p.memoizedState!==null){hg(h);continue}}f!==null?(f.return=p,ee=f):hg(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=lv("display",o))}catch(_){Ze(t,t.return,_)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(_){Ze(t,t.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fr(e,t),Rr(t),n&4&&ug(t);break;case 21:break;default:fr(e,t),Rr(t)}}function Rr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(B0(r)){var n=r;break e}r=r.return}throw Error(V(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Jo(i,""),n.flags&=-33);var s=cg(t);jh(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=cg(t);Ih(t,a,o);break;default:throw Error(V(161))}}catch(c){Ze(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _b(t,e,r){ee=t,L0(t)}function L0(t,e,r){for(var n=(t.mode&1)!==0;ee!==null;){var i=ee,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Ya;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Ct;a=Ya;var u=Ct;if(Ya=o,(Ct=c)&&!u)for(ee=i;ee!==null;)o=ee,c=o.child,o.tag===22&&o.memoizedState!==null?pg(i):c!==null?(c.return=o,ee=c):pg(i);for(;s!==null;)ee=s,L0(s),s=s.sibling;ee=i,Ya=a,Ct=u}dg(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ee=s):dg(t)}}function dg(t){for(;ee!==null;){var e=ee;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ct||Wc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ct)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:vr(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Km(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Km(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&ta(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}Ct||e.flags&512&&Rh(e)}catch(p){Ze(e,e.return,p)}}if(e===t){ee=null;break}if(r=e.sibling,r!==null){r.return=e.return,ee=r;break}ee=e.return}}function hg(t){for(;ee!==null;){var e=ee;if(e===t){ee=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ee=r;break}ee=e.return}}function pg(t){for(;ee!==null;){var e=ee;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Wc(4,e)}catch(c){Ze(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){Ze(e,i,c)}}var s=e.return;try{Rh(e)}catch(c){Ze(e,s,c)}break;case 5:var o=e.return;try{Rh(e)}catch(c){Ze(e,o,c)}}}catch(c){Ze(e,e.return,c)}if(e===t){ee=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ee=a;break}ee=e.return}}var wb=Math.ceil,dc=yn.ReactCurrentDispatcher,Sf=yn.ReactCurrentOwner,lr=yn.ReactCurrentBatchConfig,je=0,ft=null,st=null,_t=0,Wt=0,Es=ii(0),ut=0,ha=null,Mi=0,Xc=0,bf=0,Ho=null,Lt=null,Ef=0,Xs=1/0,en=null,hc=!1,Mh=null,Xn=null,Ka=!1,Ln=null,pc=0,$o=0,Bh=null,Il=-1,jl=0;function It(){return je&6?nt():Il!==-1?Il:Il=nt()}function Yn(t){return t.mode&1?je&2&&_t!==0?_t&-_t:ib.transition!==null?(jl===0&&(jl=wv()),jl):(t=Ne,t!==0||(t=window.event,t=t===void 0?16:kv(t.type)),t):1}function Er(t,e,r,n){if(50<$o)throw $o=0,Bh=null,Error(V(185));Sa(t,r,n),(!(je&2)||t!==ft)&&(t===ft&&(!(je&2)&&(Xc|=r),ut===4&&Bn(t,_t)),Ht(t,n),r===1&&je===0&&!(e.mode&1)&&(Xs=nt()+500,Hc&&si()))}function Ht(t,e){var r=t.callbackNode;iS(t,e);var n=ql(t,t===ft?_t:0);if(n===0)r!==null&&Sm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Sm(r),e===1)t.tag===0?nb(fg.bind(null,t)):Xv(fg.bind(null,t)),ZS(function(){!(je&6)&&si()}),r=null;else{switch(Sv(n)){case 1:r=Kp;break;case 4:r=vv;break;case 16:r=Kl;break;case 536870912:r=_v;break;default:r=Kl}r=V0(r,D0.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function D0(t,e){if(Il=-1,jl=0,je&6)throw Error(V(327));var r=t.callbackNode;if(js()&&t.callbackNode!==r)return null;var n=ql(t,t===ft?_t:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=fc(t,n);else{e=n;var i=je;je|=2;var s=U0();(ft!==t||_t!==e)&&(en=null,Xs=nt()+500,Ti(t,e));do try{Eb();break}catch(a){O0(t,a)}while(!0);cf(),dc.current=s,je=i,st!==null?e=0:(ft=null,_t=0,e=ut)}if(e!==0){if(e===2&&(i=ah(t),i!==0&&(n=i,e=Nh(t,i))),e===1)throw r=ha,Ti(t,0),Bn(t,n),Ht(t,nt()),r;if(e===6)Bn(t,n);else{if(i=t.current.alternate,!(n&30)&&!Sb(i)&&(e=fc(t,n),e===2&&(s=ah(t),s!==0&&(n=s,e=Nh(t,s))),e===1))throw r=ha,Ti(t,0),Bn(t,n),Ht(t,nt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(V(345));case 2:pi(t,Lt,en);break;case 3:if(Bn(t,n),(n&130023424)===n&&(e=Ef+500-nt(),10<e)){if(ql(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){It(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=mh(pi.bind(null,t,Lt,en),e);break}pi(t,Lt,en);break;case 4:if(Bn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-br(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=nt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*wb(n/1960))-n,10<n){t.timeoutHandle=mh(pi.bind(null,t,Lt,en),n);break}pi(t,Lt,en);break;case 5:pi(t,Lt,en);break;default:throw Error(V(329))}}}return Ht(t,nt()),t.callbackNode===r?D0.bind(null,t):null}function Nh(t,e){var r=Ho;return t.current.memoizedState.isDehydrated&&(Ti(t,e).flags|=256),t=fc(t,e),t!==2&&(e=Lt,Lt=r,e!==null&&Fh(e)),t}function Fh(t){Lt===null?Lt=t:Lt.push.apply(Lt,t)}function Sb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Cr(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Bn(t,e){for(e&=~bf,e&=~Xc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-br(e),n=1<<r;t[r]=-1,e&=~n}}function fg(t){if(je&6)throw Error(V(327));js();var e=ql(t,0);if(!(e&1))return Ht(t,nt()),null;var r=fc(t,e);if(t.tag!==0&&r===2){var n=ah(t);n!==0&&(e=n,r=Nh(t,n))}if(r===1)throw r=ha,Ti(t,0),Bn(t,e),Ht(t,nt()),r;if(r===6)throw Error(V(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,pi(t,Lt,en),Ht(t,nt()),null}function Tf(t,e){var r=je;je|=1;try{return t(e)}finally{je=r,je===0&&(Xs=nt()+500,Hc&&si())}}function Bi(t){Ln!==null&&Ln.tag===0&&!(je&6)&&js();var e=je;je|=1;var r=lr.transition,n=Ne;try{if(lr.transition=null,Ne=1,t)return t()}finally{Ne=n,lr.transition=r,je=e,!(je&6)&&si()}}function Af(){Wt=Es.current,ze(Es)}function Ti(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,QS(r)),st!==null)for(r=st.return;r!==null;){var n=r;switch(of(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&tc();break;case 3:Vs(),ze(zt),ze(kt),mf();break;case 5:ff(n);break;case 4:Vs();break;case 13:ze(We);break;case 19:ze(We);break;case 10:uf(n.type._context);break;case 22:case 23:Af()}r=r.return}if(ft=t,st=t=Kn(t.current,null),_t=Wt=e,ut=0,ha=null,bf=Xc=Mi=0,Lt=Ho=null,bi!==null){for(e=0;e<bi.length;e++)if(r=bi[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}bi=null}return t}function O0(t,e){do{var r=st;try{if(cf(),kl.current=uc,cc){for(var n=Ye.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}cc=!1}if(ji=0,ht=ct=Ye=null,zo=!1,ca=0,Sf.current=null,r===null||r.return===null){ut=1,ha=e,st=null;break}e:{var s=t,o=r.return,a=r,c=e;if(e=_t,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=tg(o);if(f!==null){f.flags&=-257,rg(f,o,a,s,e),f.mode&1&&eg(s,u,e),e=f,c=u;var m=e.updateQueue;if(m===null){var _=new Set;_.add(c),e.updateQueue=_}else m.add(c);break e}else{if(!(e&1)){eg(s,u,e),Cf();break e}c=Error(V(426))}}else if(He&&a.mode&1){var v=tg(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),rg(v,o,a,s,e),af(Ws(c,a));break e}}s=c=Ws(c,a),ut!==4&&(ut=2),Ho===null?Ho=[s]:Ho.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=S0(s,c,e);Ym(s,x);break e;case 1:a=c;var y=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Xn===null||!Xn.has(g)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=b0(s,a,e);Ym(s,w);break e}}s=s.return}while(s!==null)}G0(r)}catch(b){e=b,st===r&&r!==null&&(st=r=r.return);continue}break}while(!0)}function U0(){var t=dc.current;return dc.current=uc,t===null?uc:t}function Cf(){(ut===0||ut===3||ut===2)&&(ut=4),ft===null||!(Mi&268435455)&&!(Xc&268435455)||Bn(ft,_t)}function fc(t,e){var r=je;je|=2;var n=U0();(ft!==t||_t!==e)&&(en=null,Ti(t,e));do try{bb();break}catch(i){O0(t,i)}while(!0);if(cf(),je=r,dc.current=n,st!==null)throw Error(V(261));return ft=null,_t=0,ut}function bb(){for(;st!==null;)z0(st)}function Eb(){for(;st!==null&&!Kw();)z0(st)}function z0(t){var e=$0(t.alternate,t,Wt);t.memoizedProps=t.pendingProps,e===null?G0(t):st=e,Sf.current=null}function G0(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=xb(r,e),r!==null){r.flags&=32767,st=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ut=6,st=null;return}}else if(r=gb(r,e,Wt),r!==null){st=r;return}if(e=e.sibling,e!==null){st=e;return}st=e=t}while(e!==null);ut===0&&(ut=5)}function pi(t,e,r){var n=Ne,i=lr.transition;try{lr.transition=null,Ne=1,Tb(t,e,r,n)}finally{lr.transition=i,Ne=n}return null}function Tb(t,e,r,n){do js();while(Ln!==null);if(je&6)throw Error(V(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(V(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(sS(t,s),t===ft&&(st=ft=null,_t=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ka||(Ka=!0,V0(Kl,function(){return js(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=lr.transition,lr.transition=null;var o=Ne;Ne=1;var a=je;je|=4,Sf.current=null,vb(t,r),F0(r,t),VS(ph),Jl=!!hh,ph=hh=null,t.current=r,_b(r),qw(),je=a,Ne=o,lr.transition=s}else t.current=r;if(Ka&&(Ka=!1,Ln=t,pc=i),s=t.pendingLanes,s===0&&(Xn=null),Zw(r.stateNode),Ht(t,nt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(hc)throw hc=!1,t=Mh,Mh=null,t;return pc&1&&t.tag!==0&&js(),s=t.pendingLanes,s&1?t===Bh?$o++:($o=0,Bh=t):$o=0,si(),null}function js(){if(Ln!==null){var t=Sv(pc),e=lr.transition,r=Ne;try{if(lr.transition=null,Ne=16>t?16:t,Ln===null)var n=!1;else{if(t=Ln,Ln=null,pc=0,je&6)throw Error(V(331));var i=je;for(je|=4,ee=t.current;ee!==null;){var s=ee,o=s.child;if(ee.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(ee=u;ee!==null;){var d=ee;switch(d.tag){case 0:case 11:case 15:Go(8,d,s)}var h=d.child;if(h!==null)h.return=d,ee=h;else for(;ee!==null;){d=ee;var p=d.sibling,f=d.return;if(M0(d),d===u){ee=null;break}if(p!==null){p.return=f,ee=p;break}ee=f}}}var m=s.alternate;if(m!==null){var _=m.child;if(_!==null){m.child=null;do{var v=_.sibling;_.sibling=null,_=v}while(_!==null)}}ee=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ee=o;else e:for(;ee!==null;){if(s=ee,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Go(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ee=x;break e}ee=s.return}}var y=t.current;for(ee=y;ee!==null;){o=ee;var g=o.child;if(o.subtreeFlags&2064&&g!==null)g.return=o,ee=g;else e:for(o=y;ee!==null;){if(a=ee,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Wc(9,a)}}catch(b){Ze(a,a.return,b)}if(a===o){ee=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,ee=w;break e}ee=a.return}}if(je=i,si(),Hr&&typeof Hr.onPostCommitFiberRoot=="function")try{Hr.onPostCommitFiberRoot(Dc,t)}catch{}n=!0}return n}finally{Ne=r,lr.transition=e}}return!1}function mg(t,e,r){e=Ws(r,e),e=S0(t,e,1),t=Wn(t,e,1),e=It(),t!==null&&(Sa(t,1,e),Ht(t,e))}function Ze(t,e,r){if(t.tag===3)mg(t,t,r);else for(;e!==null;){if(e.tag===3){mg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Xn===null||!Xn.has(n))){t=Ws(r,t),t=b0(e,t,1),e=Wn(e,t,1),t=It(),e!==null&&(Sa(e,1,t),Ht(e,t));break}}e=e.return}}function Ab(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=It(),t.pingedLanes|=t.suspendedLanes&r,ft===t&&(_t&r)===r&&(ut===4||ut===3&&(_t&130023424)===_t&&500>nt()-Ef?Ti(t,0):bf|=r),Ht(t,e)}function H0(t,e){e===0&&(t.mode&1?(e=Oa,Oa<<=1,!(Oa&130023424)&&(Oa=4194304)):e=1);var r=It();t=fn(t,e),t!==null&&(Sa(t,e,r),Ht(t,r))}function Cb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),H0(t,r)}function kb(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(V(314))}n!==null&&n.delete(e),H0(t,r)}var $0;$0=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||zt.current)Dt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Dt=!1,mb(t,e,r);Dt=!!(t.flags&131072)}else Dt=!1,He&&e.flags&1048576&&Yv(e,ic,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Rl(t,e),t=e.pendingProps;var i=Gs(e,kt.current);Is(e,r),i=xf(null,e,n,t,i,r);var s=yf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Gt(n)?(s=!0,rc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,hf(e),i.updater=Vc,e.stateNode=i,i._reactInternals=e,Sh(e,n,t,r),e=Th(null,e,n,!0,s,r)):(e.tag=0,He&&s&&sf(e),Pt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Rl(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Rb(n),t=vr(n,t),i){case 0:e=Eh(null,e,n,t,r);break e;case 1:e=sg(null,e,n,t,r);break e;case 11:e=ng(null,e,n,t,r);break e;case 14:e=ig(null,e,n,vr(n.type,t),r);break e}throw Error(V(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:vr(n,i),Eh(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:vr(n,i),sg(t,e,n,i,r);case 3:e:{if(C0(e),t===null)throw Error(V(387));n=e.pendingProps,s=e.memoizedState,i=s.element,e0(t,e),ac(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ws(Error(V(423)),e),e=og(t,e,n,r,i);break e}else if(n!==i){i=Ws(Error(V(424)),e),e=og(t,e,n,r,i);break e}else for(Xt=Vn(e.stateNode.containerInfo.firstChild),qt=e,He=!0,wr=null,r=Qv(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Hs(),n===i){e=mn(t,e,r);break e}Pt(t,e,n,r)}e=e.child}return e;case 5:return t0(e),t===null&&vh(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,fh(n,i)?o=null:s!==null&&fh(n,s)&&(e.flags|=32),A0(t,e),Pt(t,e,o,r),e.child;case 6:return t===null&&vh(e),null;case 13:return k0(t,e,r);case 4:return pf(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=$s(e,null,n,r):Pt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:vr(n,i),ng(t,e,n,i,r);case 7:return Pt(t,e,e.pendingProps,r),e.child;case 8:return Pt(t,e,e.pendingProps.children,r),e.child;case 12:return Pt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Le(sc,n._currentValue),n._currentValue=o,s!==null)if(Cr(s.value,o)){if(s.children===i.children&&!zt.current){e=mn(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=un(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),_h(s.return,r,e),a.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(V(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),_h(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Pt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Is(e,r),i=cr(i),n=n(i),e.flags|=1,Pt(t,e,n,r),e.child;case 14:return n=e.type,i=vr(n,e.pendingProps),i=vr(n.type,i),ig(t,e,n,i,r);case 15:return E0(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:vr(n,i),Rl(t,e),e.tag=1,Gt(n)?(t=!0,rc(e)):t=!1,Is(e,r),w0(e,n,i),Sh(e,n,i,r),Th(null,e,n,!0,t,r);case 19:return P0(t,e,r);case 22:return T0(t,e,r)}throw Error(V(156,e.tag))};function V0(t,e){return yv(t,e)}function Pb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sr(t,e,r,n){return new Pb(t,e,r,n)}function kf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Rb(t){if(typeof t=="function")return kf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Wp)return 11;if(t===Xp)return 14}return 2}function Kn(t,e){var r=t.alternate;return r===null?(r=sr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ml(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")kf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case fs:return Ai(r.children,i,s,e);case Vp:o=8,i|=8;break;case Wd:return t=sr(12,r,e,i|2),t.elementType=Wd,t.lanes=s,t;case Xd:return t=sr(13,r,e,i),t.elementType=Xd,t.lanes=s,t;case Yd:return t=sr(19,r,e,i),t.elementType=Yd,t.lanes=s,t;case tv:return Yc(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Zy:o=10;break e;case ev:o=9;break e;case Wp:o=11;break e;case Xp:o=14;break e;case Rn:o=16,n=null;break e}throw Error(V(130,t==null?t:typeof t,""))}return e=sr(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Ai(t,e,r,n){return t=sr(7,t,n,e),t.lanes=r,t}function Yc(t,e,r,n){return t=sr(22,t,n,e),t.elementType=tv,t.lanes=r,t.stateNode={isHidden:!1},t}function Gu(t,e,r){return t=sr(6,t,null,e),t.lanes=r,t}function Hu(t,e,r){return e=sr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ib(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bu(0),this.expirationTimes=bu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bu(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Pf(t,e,r,n,i,s,o,a,c){return t=new Ib(t,e,r,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=sr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},hf(s),t}function jb(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ps,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function W0(t){if(!t)return Zn;t=t._reactInternals;e:{if(Ui(t)!==t||t.tag!==1)throw Error(V(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Gt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(V(171))}if(t.tag===1){var r=t.type;if(Gt(r))return Wv(t,r,e)}return e}function X0(t,e,r,n,i,s,o,a,c){return t=Pf(r,n,!0,t,i,s,o,a,c),t.context=W0(null),r=t.current,n=It(),i=Yn(r),s=un(n,i),s.callback=e??null,Wn(r,s,i),t.current.lanes=i,Sa(t,i,n),Ht(t,n),t}function Kc(t,e,r,n){var i=e.current,s=It(),o=Yn(i);return r=W0(r),e.context===null?e.context=r:e.pendingContext=r,e=un(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Wn(i,e,o),t!==null&&(Er(t,i,o,s),Cl(t,i,o)),o}function mc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Rf(t,e){gg(t,e),(t=t.alternate)&&gg(t,e)}function Mb(){return null}var Y0=typeof reportError=="function"?reportError:function(t){console.error(t)};function If(t){this._internalRoot=t}qc.prototype.render=If.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(V(409));Kc(t,e,null,null)};qc.prototype.unmount=If.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Bi(function(){Kc(null,t,null,null)}),e[pn]=null}};function qc(t){this._internalRoot=t}qc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Tv();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Mn.length&&e!==0&&e<Mn[r].priority;r++);Mn.splice(r,0,t),r===0&&Cv(t)}};function jf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Jc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xg(){}function Bb(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=mc(o);s.call(u)}}var o=X0(e,n,t,0,null,!1,!1,"",xg);return t._reactRootContainer=o,t[pn]=o.current,ia(t.nodeType===8?t.parentNode:t),Bi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var u=mc(c);a.call(u)}}var c=Pf(t,0,!1,null,null,!1,!1,"",xg);return t._reactRootContainer=c,t[pn]=c.current,ia(t.nodeType===8?t.parentNode:t),Bi(function(){Kc(e,c,r,n)}),c}function Qc(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=mc(o);a.call(c)}}Kc(e,o,t,i)}else o=Bb(r,e,t,i,n);return mc(o)}bv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=To(e.pendingLanes);r!==0&&(qp(e,r|1),Ht(e,nt()),!(je&6)&&(Xs=nt()+500,si()))}break;case 13:Bi(function(){var n=fn(t,1);if(n!==null){var i=It();Er(n,t,1,i)}}),Rf(t,1)}};Jp=function(t){if(t.tag===13){var e=fn(t,134217728);if(e!==null){var r=It();Er(e,t,134217728,r)}Rf(t,134217728)}};Ev=function(t){if(t.tag===13){var e=Yn(t),r=fn(t,e);if(r!==null){var n=It();Er(r,t,e,n)}Rf(t,e)}};Tv=function(){return Ne};Av=function(t,e){var r=Ne;try{return Ne=t,e()}finally{Ne=r}};ih=function(t,e,r){switch(e){case"input":if(Jd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Gc(n);if(!i)throw Error(V(90));nv(n),Jd(n,i)}}}break;case"textarea":sv(t,r);break;case"select":e=r.value,e!=null&&Cs(t,!!r.multiple,e,!1)}};hv=Tf;pv=Bi;var Nb={usingClientEntryPoint:!1,Events:[Ea,ys,Gc,uv,dv,Tf]},fo={findFiberByHostInstance:Si,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Fb={bundleType:fo.bundleType,version:fo.version,rendererPackageName:fo.rendererPackageName,rendererConfig:fo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=gv(t),t===null?null:t.stateNode},findFiberByHostInstance:fo.findFiberByHostInstance||Mb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qa.isDisabled&&qa.supportsFiber)try{Dc=qa.inject(Fb),Hr=qa}catch{}}Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nb;Qt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jf(e))throw Error(V(200));return jb(t,e,null,r)};Qt.createRoot=function(t,e){if(!jf(t))throw Error(V(299));var r=!1,n="",i=Y0;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Pf(t,1,!1,null,null,r,!1,n,i),t[pn]=e.current,ia(t.nodeType===8?t.parentNode:t),new If(e)};Qt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(V(188)):(t=Object.keys(t).join(","),Error(V(268,t)));return t=gv(e),t=t===null?null:t.stateNode,t};Qt.flushSync=function(t){return Bi(t)};Qt.hydrate=function(t,e,r){if(!Jc(e))throw Error(V(200));return Qc(null,t,e,!0,r)};Qt.hydrateRoot=function(t,e,r){if(!jf(t))throw Error(V(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=Y0;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=X0(e,null,t,1,r??null,i,!1,s,o),t[pn]=e.current,ia(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new qc(e)};Qt.render=function(t,e,r){if(!Jc(e))throw Error(V(200));return Qc(null,t,e,!1,r)};Qt.unmountComponentAtNode=function(t){if(!Jc(t))throw Error(V(40));return t._reactRootContainer?(Bi(function(){Qc(null,null,t,!1,function(){t._reactRootContainer=null,t[pn]=null})}),!0):!1};Qt.unstable_batchedUpdates=Tf;Qt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Jc(r))throw Error(V(200));if(t==null||t._reactInternals===void 0)throw Error(V(38));return Qc(t,e,r,!1,n)};Qt.version="18.3.1-next-f1338f8080-20240426";function K0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(K0)}catch(t){console.error(t)}}K0(),Ky.exports=Qt;var Lb=Ky.exports,yg=Lb;$d.createRoot=yg.createRoot,$d.hydrateRoot=yg.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pa(){return pa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pa.apply(this,arguments)}var Dn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Dn||(Dn={}));const vg="popstate";function Db(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return Lh("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:gc(i)}return Ub(e,r,null,t)}function ot(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Mf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Ob(){return Math.random().toString(36).substr(2,8)}function _g(t,e){return{usr:t.state,key:t.key,idx:e}}function Lh(t,e,r,n){return r===void 0&&(r=null),pa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?eo(e):e,{state:r,key:e&&e.key||n||Ob()})}function gc(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function eo(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function Ub(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=Dn.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(pa({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){a=Dn.Pop;let v=d(),x=v==null?null:v-u;u=v,c&&c({action:a,location:_.location,delta:x})}function p(v,x){a=Dn.Push;let y=Lh(_.location,v,x);u=d()+1;let g=_g(y,u),w=_.createHref(y);try{o.pushState(g,"",w)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;i.location.assign(w)}s&&c&&c({action:a,location:_.location,delta:1})}function f(v,x){a=Dn.Replace;let y=Lh(_.location,v,x);u=d();let g=_g(y,u),w=_.createHref(y);o.replaceState(g,"",w),s&&c&&c({action:a,location:_.location,delta:0})}function m(v){let x=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof v=="string"?v:gc(v);return y=y.replace(/ $/,"%20"),ot(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let _={get action(){return a},get location(){return t(i,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(vg,h),c=v,()=>{i.removeEventListener(vg,h),c=null}},createHref(v){return e(i,v)},createURL:m,encodeLocation(v){let x=m(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:f,go(v){return o.go(v)}};return _}var wg;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(wg||(wg={}));function zb(t,e,r){return r===void 0&&(r="/"),Gb(t,e,r)}function Gb(t,e,r,n){let i=typeof e=="string"?eo(e):e,s=Bf(i.pathname||"/",r);if(s==null)return null;let o=q0(t);Hb(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let u=tE(s);a=Qb(o[c],u)}return a}function q0(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let c={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(ot(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=qn([n,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(ot(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),q0(s.children,e,d,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:qb(u,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let c of J0(s.path))i(s,o,c)}),e}function J0(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=J0(n.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function Hb(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Jb(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const $b=/^:[\w-]+$/,Vb=3,Wb=2,Xb=1,Yb=10,Kb=-2,Sg=t=>t==="*";function qb(t,e){let r=t.split("/"),n=r.length;return r.some(Sg)&&(n+=Kb),e&&(n+=Wb),r.filter(i=>!Sg(i)).reduce((i,s)=>i+($b.test(s)?Vb:s===""?Xb:Yb),n)}function Jb(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Qb(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let c=n[a],u=a===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",h=Zb({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:qn([s,h.pathname]),pathnameBase:oE(qn([s,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(s=qn([s,h.pathnameBase]))}return o}function Zb(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=eE(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:p,isOptional:f}=d;if(p==="*"){let _=a[h]||"";o=s.slice(0,s.length-_.length).replace(/(.)\/+$/,"$1")}const m=a[h];return f&&!m?u[p]=void 0:u[p]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function eE(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Mf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(n.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function tE(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Bf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const rE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nE=t=>rE.test(t);function iE(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?eo(t):t,s;if(r)if(nE(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Mf(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=bg(r.substring(1),"/"):s=bg(r,e)}else s=e;return{pathname:s,search:aE(n),hash:lE(i)}}function bg(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function $u(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sE(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Q0(t,e){let r=sE(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Z0(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=eo(t):(i=pa({},t),ot(!i.pathname||!i.pathname.includes("?"),$u("?","pathname","search",i)),ot(!i.pathname||!i.pathname.includes("#"),$u("#","pathname","hash",i)),ot(!i.search||!i.search.includes("#"),$u("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),h-=1;i.pathname=p.join("/")}a=h>=0?e[h]:"/"}let c=iE(i,a),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const qn=t=>t.join("/").replace(/\/\/+/g,"/"),oE=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),aE=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,lE=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function cE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const e_=["post","put","patch","delete"];new Set(e_);const uE=["get",...e_];new Set(uE);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fa(){return fa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fa.apply(this,arguments)}const Nf=S.createContext(null),dE=S.createContext(null),zi=S.createContext(null),Zc=S.createContext(null),Gi=S.createContext({outlet:null,matches:[],isDataRoute:!1}),t_=S.createContext(null);function hE(t,e){let{relative:r}=e===void 0?{}:e;Aa()||ot(!1);let{basename:n,navigator:i}=S.useContext(zi),{hash:s,pathname:o,search:a}=n_(t,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:qn([n,o])),i.createHref({pathname:c,search:a,hash:s})}function Aa(){return S.useContext(Zc)!=null}function Hi(){return Aa()||ot(!1),S.useContext(Zc).location}function r_(t){S.useContext(zi).static||S.useLayoutEffect(t)}function er(){let{isDataRoute:t}=S.useContext(Gi);return t?TE():pE()}function pE(){Aa()||ot(!1);let t=S.useContext(Nf),{basename:e,future:r,navigator:n}=S.useContext(zi),{matches:i}=S.useContext(Gi),{pathname:s}=Hi(),o=JSON.stringify(Q0(i,r.v7_relativeSplatPath)),a=S.useRef(!1);return r_(()=>{a.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){n.go(u);return}let h=Z0(u,JSON.parse(o),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:qn([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,o,s,t])}function n_(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=S.useContext(zi),{matches:i}=S.useContext(Gi),{pathname:s}=Hi(),o=JSON.stringify(Q0(i,n.v7_relativeSplatPath));return S.useMemo(()=>Z0(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function fE(t,e){return mE(t,e)}function mE(t,e,r,n){Aa()||ot(!1);let{navigator:i}=S.useContext(zi),{matches:s}=S.useContext(Gi),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Hi(),d;if(e){var h;let v=typeof e=="string"?eo(e):e;c==="/"||(h=v.pathname)!=null&&h.startsWith(c)||ot(!1),d=v}else d=u;let p=d.pathname||"/",f=p;if(c!=="/"){let v=c.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=zb(t,{pathname:f}),_=_E(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},a,v.params),pathname:qn([c,i.encodeLocation?i.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:qn([c,i.encodeLocation?i.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,r,n);return e&&_?S.createElement(Zc.Provider,{value:{location:fa({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Dn.Pop}},_):_}function gE(){let t=EE(),e=cE(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),r?S.createElement("pre",{style:i},r):null,null)}const xE=S.createElement(gE,null);class yE extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?S.createElement(Gi.Provider,{value:this.props.routeContext},S.createElement(t_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vE(t){let{routeContext:e,match:r,children:n}=t,i=S.useContext(Nf);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),S.createElement(Gi.Provider,{value:e},n)}function _E(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let d=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);d>=0||ot(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:p,errors:f}=r,m=h.route.loader&&p[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||m){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,p)=>{let f,m=!1,_=null,v=null;r&&(f=a&&h.route.id?a[h.route.id]:void 0,_=h.route.errorElement||xE,c&&(u<0&&p===0?(AE("route-fallback"),m=!0,v=null):u===p&&(m=!0,v=h.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,p+1)),y=()=>{let g;return f?g=_:m?g=v:h.route.Component?g=S.createElement(h.route.Component,null):h.route.element?g=h.route.element:g=d,S.createElement(vE,{match:h,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:g})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?S.createElement(yE,{location:r.location,revalidation:r.revalidation,component:_,error:f,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var i_=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(i_||{}),s_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(s_||{});function wE(t){let e=S.useContext(Nf);return e||ot(!1),e}function SE(t){let e=S.useContext(dE);return e||ot(!1),e}function bE(t){let e=S.useContext(Gi);return e||ot(!1),e}function o_(t){let e=bE(),r=e.matches[e.matches.length-1];return r.route.id||ot(!1),r.route.id}function EE(){var t;let e=S.useContext(t_),r=SE(),n=o_();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function TE(){let{router:t}=wE(i_.UseNavigateStable),e=o_(s_.UseNavigateStable),r=S.useRef(!1);return r_(()=>{r.current=!0}),S.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,fa({fromRouteId:e},s)))},[t,e])}const Eg={};function AE(t,e,r){Eg[t]||(Eg[t]=!0)}function CE(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function tr(t){ot(!1)}function kE(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Dn.Pop,navigator:s,static:o=!1,future:a}=t;Aa()&&ot(!1);let c=e.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:s,static:o,future:fa({v7_relativeSplatPath:!1},a)}),[c,a,s,o]);typeof n=="string"&&(n=eo(n));let{pathname:d="/",search:h="",hash:p="",state:f=null,key:m="default"}=n,_=S.useMemo(()=>{let v=Bf(d,c);return v==null?null:{location:{pathname:v,search:h,hash:p,state:f,key:m},navigationType:i}},[c,d,h,p,f,m,i]);return _==null?null:S.createElement(zi.Provider,{value:u},S.createElement(Zc.Provider,{children:r,value:_}))}function PE(t){let{children:e,location:r}=t;return fE(Dh(e),r)}new Promise(()=>{});function Dh(t,e){e===void 0&&(e=[]);let r=[];return S.Children.forEach(t,(n,i)=>{if(!S.isValidElement(n))return;let s=[...e,i];if(n.type===S.Fragment){r.push.apply(r,Dh(n.props.children,s));return}n.type!==tr&&ot(!1),!n.props.index||!n.props.children||ot(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Dh(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oh(){return Oh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Oh.apply(this,arguments)}function RE(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function IE(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function jE(t,e){return t.button===0&&(!e||e==="_self")&&!IE(t)}function Uh(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function ME(t,e){let r=Uh(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(s=>{r.append(i,s)})}),r}const BE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],NE="6";try{window.__reactRouterVersion=NE}catch{}const FE="startTransition",Tg=Aw[FE];function LE(t){let{basename:e,children:r,future:n,window:i}=t,s=S.useRef();s.current==null&&(s.current=Db({window:i,v5Compat:!0}));let o=s.current,[a,c]=S.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=S.useCallback(h=>{u&&Tg?Tg(()=>c(h)):c(h)},[c,u]);return S.useLayoutEffect(()=>o.listen(d),[o,d]),S.useEffect(()=>CE(n),[n]),S.createElement(kE,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const DE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ma=S.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,p=RE(e,BE),{basename:f}=S.useContext(zi),m,_=!1;if(typeof u=="string"&&OE.test(u)&&(m=u,DE))try{let g=new URL(window.location.href),w=u.startsWith("//")?new URL(g.protocol+u):new URL(u),b=Bf(w.pathname,f);w.origin===g.origin&&b!=null?u=b+w.search+w.hash:_=!0}catch{}let v=hE(u,{relative:i}),x=UE(u,{replace:o,state:a,target:c,preventScrollReset:d,relative:i,viewTransition:h});function y(g){n&&n(g),g.defaultPrevented||x(g)}return S.createElement("a",Oh({},p,{href:m||v,onClick:_||s?n:y,ref:r,target:c}))});var Ag;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ag||(Ag={}));var Cg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Cg||(Cg={}));function UE(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,c=er(),u=Hi(),d=n_(t,{relative:o});return S.useCallback(h=>{if(jE(h,r)){h.preventDefault();let p=n!==void 0?n:gc(u)===gc(d);c(t,{replace:p,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,c,d,n,i,r,t,s,o,a])}function eu(t){let e=S.useRef(Uh(t)),r=S.useRef(!1),n=Hi(),i=S.useMemo(()=>ME(n.search,r.current?null:e.current),[n.search]),s=er(),o=S.useCallback((a,c)=>{const u=Uh(typeof a=="function"?a(i):a);r.current=!0,s("?"+u,c)},[s,i]);return[i,o]}function zE(){const t=er(),[e,r]=S.useState(0),[n,i]=S.useState(!1),s=S.useRef(null),o=80;return S.useEffect(()=>{const a=s.current;if(!a)return;let c=0,u=0,d=!1;const h=m=>{a.scrollTop===0&&(c=m.touches[0].clientY,d=!0,console.log("Pull-to-refresh: Touch started"))},p=m=>{if(!d)return;u=m.touches[0].clientY;const _=u-c;if(_>0){m.preventDefault();const v=Math.pow(_,.85);r(Math.min(v,o*1.5)),console.log("Pull distance:",Math.min(v,o*1.5).toFixed(0))}},f=()=>{e>o?(i(!0),r(0),setTimeout(()=>{window.location.reload()},400)):r(0),d=!1};return a.addEventListener("touchstart",h,{passive:!0}),a.addEventListener("touchmove",p,{passive:!1}),a.addEventListener("touchend",f),()=>{a.removeEventListener("touchstart",h),a.removeEventListener("touchmove",p),a.removeEventListener("touchend",f)}},[e]),l.jsxs("div",{ref:s,className:"screen screen-center",style:{position:"relative",overflow:"auto"},children:[l.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:`${e}px`,display:"flex",alignItems:"flex-end",justifyContent:"center",paddingBottom:"8px",opacity:Math.min(e/o,1),transition:e===0?"all 0.3s ease":"none",pointerEvents:"none",zIndex:10},children:n?l.jsx("div",{style:{width:"24px",height:"24px",border:"3px solid var(--color-surface)",borderTop:"3px solid var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}):l.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",fontWeight:600},children:e>o?" Release to refresh":" Pull to refresh"})}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",zIndex:1,transform:`translateY(${e}px)`,transition:e===0?"transform 0.3s ease":"none",paddingBottom:"120px"},children:[l.jsx("img",{src:"/data/icons/OwlHeadphones.png",alt:"ChipNotes Owl Professor",style:{width:"180px",height:"180px",borderRadius:"50%",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",marginBottom:"4px"}}),l.jsx("h1",{style:{margin:0,fontSize:"44px",fontWeight:800,letterSpacing:"-1px",background:"linear-gradient(135deg, #FFD54F 0%, #FF8A65 50%, #E57373 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"ChipNotes!"}),l.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"16px",maxWidth:"280px",textAlign:"center",lineHeight:1.4,marginTop:"-4px",fontWeight:600},children:"Train your ear. Know the birds."}),l.jsx("button",{onClick:()=>t("/pack-select"),style:{marginTop:"16px",padding:"18px 64px",fontSize:"20px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"16px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.4)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:a=>{a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow="0 6px 20px rgba(45, 90, 39, 0.5)"},onMouseLeave:a=>{a.currentTarget.style.transform="translateY(0)",a.currentTarget.style.boxShadow="0 4px 16px rgba(45, 90, 39, 0.4)"},children:"Play"}),l.jsx("div",{style:{marginTop:"20px",padding:"16px",background:"var(--color-surface)",borderRadius:"16px",maxWidth:"360px"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px"},children:[l.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[l.jsx("div",{style:{width:"72px",height:"52px",background:"linear-gradient(180deg, #1a1a2e 0%, #0d1520 100%)",borderRadius:"10px",padding:"6px",display:"flex",alignItems:"flex-end",justifyContent:"center",gap:"2px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.3)"},children:l.jsx(GE,{})}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Hear"})]}),l.jsx("div",{style:{color:"var(--color-accent)",fontSize:"24px",marginTop:"-16px"},children:""}),l.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"4px"},children:["NOCA","BLJA","TUTI","CARW"].map((a,c)=>l.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",overflow:"hidden",border:c===0?"2px solid var(--color-accent)":"2px solid transparent",boxShadow:c===0?"0 0 8px rgba(255, 152, 0, 0.4)":"none"},children:l.jsx("img",{src:`/data/icons/${a}.png`,alt:a,style:{width:"100%",height:"100%",objectFit:"cover"}})},a))}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Match"})]}),l.jsx("div",{style:{color:"var(--color-accent)",fontSize:"24px",marginTop:"-16px"},children:""}),l.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[l.jsx("div",{style:{width:"72px",height:"52px",background:"#2a2a3e",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.4)"},children:l.jsx("div",{style:{fontSize:"32px"},children:""})}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Train"})]})]})})]}),l.jsxs("div",{style:{position:"absolute",bottom:"70px",left:0,right:0,display:"flex",justifyContent:"center",gap:"40px",zIndex:1e3},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/help"),"aria-label":"How to Play",children:l.jsx(HE,{})}),l.jsx("button",{className:"btn-icon",onClick:()=>t("/settings"),"aria-label":"Settings",children:l.jsx($E,{})}),l.jsx("button",{className:"btn-icon",onClick:()=>t("/progress"),"aria-label":"Progress",children:l.jsx(VE,{})})]}),l.jsx("button",{onClick:()=>t("/help",{state:{openVersionHistory:!0}}),style:{position:"absolute",bottom:"calc(4px + var(--safe-area-bottom, 0px))",left:0,right:0,textAlign:"center",fontSize:"11px",color:"var(--color-accent)",opacity:.6,background:"none",border:"none",cursor:"pointer",padding:"4px",transition:"opacity 0.2s",zIndex:1001},onMouseEnter:a=>a.currentTarget.style.opacity="1",onMouseLeave:a=>a.currentTarget.style.opacity="0.6","aria-label":"View version history",children:"v3.50"})]})}function GE(){const t=[8,16,24,32,26,34,28,36,20,12,26,32];return l.jsx("svg",{width:"76",height:"40",viewBox:"0 0 76 40",children:t.map((e,r)=>l.jsx("rect",{x:r*6+2,y:40-e,width:"4",height:e,rx:"1.5",fill:`hsl(${30+r*8}, 80%, ${50+r*2}%)`,opacity:.8+r*.015},r))})}function HE(){return l.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),l.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}function $E(){return l.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"3"}),l.jsx("path",{d:"M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"})]})}function VE(){return l.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 3v18h18"}),l.jsx("path",{d:"M7 16l4-4 4 4 6-6"})]})}function Yr(t,e){typeof window.gtag=="function"&&window.gtag("event",t,e)}function WE(t,e){Yr("pack_select",{pack_id:t,pack_name:e})}function XE(t,e,r){Yr("game_start",{pack_id:t,level_id:e,species_count:r})}function YE(t,e,r,n,i){Yr("round_complete",{pack_id:t,level_id:e,score:r,accuracy:n,duration_sec:i})}function KE(t){Yr("training_mode_toggle",{enabled:t})}function qE(t,e,r){Yr("level_select",{pack_id:t,level_id:e,level_title:r})}function a_(t,e){Yr("taxonomic_sort_toggle",{enabled:t,location:e})}function kg(t){Yr("custom_pack_create",{species_count:t})}function Pg(t,e){Yr("custom_pack_save",{pack_name:t,species_count:e})}function JE(t,e){Yr("custom_pack_load",{pack_name:t,species_count:e})}function QE(t){Yr("custom_pack_delete",{pack_name:t})}const Vu=[{id:"starter_birds",name:"Backyard Birds",speciesCount:6,isUnlocked:!0,description:"Start here! Distinctive, bold, recognizable voices."},{id:"expanded_backyard",name:"Eastern Birds",speciesCount:46,isUnlocked:!0,description:"Ready for more feathered friends? 9 random per round."},{id:"sparrows",name:"Sparrows",speciesCount:9,isUnlocked:!0,description:"Master their subtle songs."},{id:"woodpeckers",name:"Woodpeckers",speciesCount:9,isUnlocked:!0,description:"Drums, calls, and rattles."},{id:"western_birds",name:"Western Birds",speciesCount:18,isUnlocked:!0,description:"Frequent flyers from the Pacific coast to the Rockies."},{id:"spring_warblers",name:"Warbler Academy",speciesCount:33,isUnlocked:!0,description:"9 random per round. Custom Pack mode recommended!"}];function ZE(){var k,L,U;const t=er(),e=Hi(),[r]=eu(),[n,i]=S.useState([]),[s,o]=S.useState({}),[a,c]=S.useState(null),[u,d]=S.useState(null),[h,p]=S.useState(new Set),[f,m]=S.useState(!1),[_,v]=S.useState(!1),[x,y]=S.useState(!1),[g,w]=S.useState({}),[b,P]=S.useState({}),[C,E]=S.useState({}),M=S.useRef(null);S.useEffect(()=>{fetch("/data/clips.json").then(R=>R.json()).then(R=>{i(R);const F=Array.from(new Set(R.filter(I=>!I.rejected&&(!I.spectrogram_path||!I.spectrogram_path.includes("spectrograms-rejected"))).map(I=>I.species_code))).sort();o(I=>({...I,all_birds:F}))}).catch(R=>console.error("Failed to load clips:",R))},[]),S.useEffect(()=>{fetch("/data/taxonomic_order.json").then(R=>R.json()).then(R=>{w(R)}).catch(R=>console.error("Failed to load taxonomic order:",R))},[]),S.useEffect(()=>{fetch("/data/species.json").then(R=>R.json()).then(R=>{const F={},I={};R.forEach(j=>{F[j.species_code]=j.scientific_name,I[j.species_code]=j.common_name}),P(F),E(I)}).catch(R=>console.error("Failed to load species metadata:",R))},[]),S.useEffect(()=>{const R=["starter_birds","expanded_backyard","sparrows","woodpeckers","spring_warblers","western_birds"];Promise.all(R.map(F=>fetch(`/data/packs/${F}.json`).then(I=>I.json()).catch(I=>(console.error(`Failed to load pack ${F}:`,I),null)))).then(F=>{const I={};F.forEach((j,A)=>{j&&j.species&&(I[R[A]]=j.display_species||j.species)}),o(j=>({...j,...I}))})},[]);const B=R=>{const I=(s[R]||[]).map(j=>{const A=n.filter(K=>K.species_code===j&&!K.rejected&&(!K.spectrogram_path||!K.spectrogram_path.includes("spectrograms-rejected"))),H=A.find(K=>K.canonical)||A[0],X=A.sort((K,Te)=>K.canonical&&!Te.canonical?-1:!K.canonical&&Te.canonical?1:K.clip_id.localeCompare(Te.clip_id)).map(K=>({id:K.clip_id,path:`/data/clips/${K.file_path.split("/").pop()}`,isCanonical:!!K.canonical,vocalizationType:K.vocalization_type,source:K.source,sourceId:K.source_id,sourceUrl:K.source_url,recordist:K.recordist}));return{code:j,name:C[j]||j,canonicalClipPath:H?`/data/clips/${H.file_path.split("/").pop()}`:null,clipCount:A.length,allClips:X}});return x&&Object.keys(g).length>0?I.sort((j,A)=>{const T=g[j.code]||9999,H=g[A.code]||9999;return T-H}):I.sort((j,A)=>j.code.localeCompare(A.code))},N=R=>{R.isUnlocked&&(WE(R.id,R.name),t(`/level-select?pack=${R.id}`))},D=(R,F)=>{if(M.current&&(M.current.pause(),M.current=null),a===F){c(null);return}const I=new Audio(R);M.current=I,c(F),I.play().catch(j=>console.error("Failed to play audio:",j)),I.onended=()=>{c(null),M.current=null}};return S.useEffect(()=>()=>{M.current&&M.current.pause()},[]),S.useEffect(()=>{const R=r.get("expand")||r.get("expandPack");R&&p(new Set([R])),window.location.hash&&setTimeout(()=>{const F=document.querySelector(window.location.hash);F&&F.scrollIntoView({behavior:"smooth",block:"start"})},100)},[r]),l.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:l.jsx(eT,{})}),l.jsx("h2",{style:{margin:0},children:"Select a Bird Pack"})]}),l.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.6,background:"rgba(70, 70, 90, 0.5)",padding:"16px",borderRadius:"12px"},children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[l.jsx("li",{style:{fontWeight:600},children:"Use  (or not), but do UNmute "}),l.jsx("li",{children:"6 levels per packstart @ #1,  sparrow"}),l.jsxs("li",{children:["Try training mode ()"," ",l.jsx(ma,{to:"/help#training-mode",state:{fromPackSelect:!0},style:{color:"var(--color-accent)"},children:"Help "})]}),l.jsxs("li",{children:["Timer anxiety? Use Continuous Play"," ",l.jsx(ma,{to:"/settings",state:{fromPackSelect:!0},style:{color:"var(--color-accent)"},children:" "})]}),l.jsx("li",{children:" Build and save your own custom pack!"})]})}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"32px"},children:Vu.map(R=>{const F={starter_birds:"linear-gradient(135deg, #2d5a3d 0%, #1a3d2a 100%)",expanded_backyard:"linear-gradient(135deg, #3d5a6e 0%, #2a3d4a 100%)",sparrows:"linear-gradient(135deg, #6b5344 0%, #4a3a2e 100%)",woodpeckers:"linear-gradient(135deg, #6e3d3d 0%, #4a2a2a 100%)",spring_warblers:"linear-gradient(135deg, #7a6b2d 0%, #5a4a1a 100%)",western_birds:"linear-gradient(135deg, #5a4a7a 0%, #3a2a5a 100%)"},I={starter_birds:"NOCA",expanded_backyard:"AMGO",sparrows:"WTSP",woodpeckers:"PIWO",spring_warblers:"BLBW",western_birds:"STJA"};return l.jsxs("button",{onClick:()=>N(R),style:{position:"relative",overflow:"hidden",textAlign:"left",padding:"12px 12px 14px 12px",borderRadius:"16px",border:"none",background:F[R.id]||F.starter_birds,boxShadow:R.isUnlocked?"0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"none",opacity:R.isUnlocked?1:.5,cursor:R.isUnlocked?"pointer":"not-allowed",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:j=>{R.isUnlocked&&(j.currentTarget.style.transform="translateY(-2px)",j.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1)")},onMouseLeave:j=>{j.currentTarget.style.transform="translateY(0)",j.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[l.jsx("img",{src:`/data/icons/${I[R.id]}.png`,alt:"",style:{position:"absolute",right:"-10px",bottom:"-10px",width:"80px",height:"80px",opacity:.3,transform:"rotate(-15deg)",objectFit:"cover"}}),R.isUnlocked&&l.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:2},children:l.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#a8d5a2",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Play ",l.jsx(tT,{})]})}),l.jsxs("div",{style:{position:"relative",zIndex:1},children:[l.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#f5f0e6",lineHeight:1.3,marginBottom:"6px",paddingRight:"50px"},children:R.name}),l.jsx("div",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.6)",lineHeight:1.4,marginBottom:"10px"},children:R.description}),l.jsx("div",{children:l.jsxs("span",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.7)",fontWeight:500},children:[R.speciesCount," species"]})})]})]},R.id)})}),l.jsxs("div",{onClick:()=>t("/custom-pack"),style:{marginBottom:"32px",background:"var(--color-surface)",border:"2px solid var(--color-accent)",borderRadius:"16px",padding:"20px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:R=>{R.currentTarget.style.background="rgba(45, 90, 39, 0.15)",R.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:R=>{R.currentTarget.style.background="var(--color-surface)",R.currentTarget.style.transform="translateY(0)"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[l.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"var(--color-accent)",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:l.jsx(rT,{})}),l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)"},children:"Create Custom Pack"}),l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:"Build your own training session"})]})]}),l.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6},children:[l.jsxs("div",{style:{marginBottom:"8px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Got a nemesis bird? Add it and drill all its variations."]}),l.jsxs("div",{style:{marginBottom:_?"8px":"12px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," A friend's eBird checklist has you jealous? Build their list and practice like you were there."]}),_&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{marginBottom:"8px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Constantly confuse Kinglets, Creepers and Waxwings? Put them head-to-head."]}),l.jsxs("div",{style:{marginBottom:"8px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Warbler Wizard Wannabe? Training starts here!"]}),l.jsxs("div",{style:{marginBottom:"8px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," You think you know your woodpeckers? Try the Pileated vs. Northern Flicker on Level 5."]}),l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Mix species from any pack  your rules, your practice."]})]}),l.jsx("button",{onClick:R=>{R.stopPropagation(),v(!_)},style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",cursor:"pointer",padding:"4px 0",textDecoration:"underline",display:"flex",alignItems:"center",gap:"4px"},children:_?" Show less":"More examples "})]})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",marginTop:"24px",marginBottom:"16px",opacity:.5},children:[l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",textAlign:"center"},children:"Browse all birds below"}),l.jsx("div",{style:{animation:"bounce 2s ease-in-out infinite"},children:l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-text-muted)",strokeWidth:"2",children:l.jsx("path",{d:"M12 5v14M5 12l7 7 7-7"})})})]}),l.jsxs("div",{id:"bird-reference",style:{marginTop:"16px",scrollMarginTop:"20px"},children:[((k=e.state)==null?void 0:k.fromLevelSelect)&&((L=e.state)==null?void 0:L.packId)&&l.jsx("div",{style:{marginBottom:"16px"},children:l.jsxs("button",{onClick:()=>t(`/level-select?pack=${e.state.packId}`),style:{background:"var(--color-accent)",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Level Select",children:[l.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Level Select"]})}),((U=e.state)==null?void 0:U.fromHelp)&&l.jsx("div",{style:{marginBottom:"16px"},children:l.jsxs("button",{onClick:()=>t("/help"),style:{background:"var(--color-accent)",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Help",children:[l.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Help"]})}),l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[l.jsx("h3",{style:{fontSize:"16px",margin:0,color:"var(--color-text-muted)"},children:"Bird Reference"}),l.jsx("button",{onClick:()=>{if(f)p(new Set),m(!1);else{const R=Vu.filter(F=>F.isUnlocked).map(F=>F.id);p(new Set(R)),m(!0)}},style:{fontSize:"12px",padding:"6px 12px",background:f?"var(--color-accent)":"var(--color-surface)",color:f?"#000":"var(--color-text)",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:600},children:f?"Collapse All":"Expand All"})]}),l.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"20px",paddingLeft:"12px",borderLeft:"3px solid var(--color-accent)"},children:"Preview signature sounds for each bird before you play. Click pack names to expand and see all birds, or click individual birds to explore their full library of recordings."}),s.all_birds&&(()=>{var I;const R="all_birds",F=f||h.has(R);return l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("div",{onClick:()=>{const j=new Set(h);j.has(R)?j.delete(R):j.add(R),p(j)},style:{fontSize:"14px",marginBottom:F?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:j=>j.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:j=>j.currentTarget.style.background="var(--color-surface)",children:[l.jsx("span",{style:{fontSize:"14px"},children:F?"":""}),l.jsx("span",{style:{fontWeight:600},children:"All Birds"}),l.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((I=s[R])==null?void 0:I.length)||0," species"]})]}),F&&l.jsxs(l.Fragment,{children:[l.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"rgba(70, 70, 90, 0.3)",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",position:"relative"},children:l.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[l.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"var(--color-text-muted)"},children:"Sort:"}),l.jsx("button",{onClick:()=>{y(!x)},style:{padding:"6px 12px",fontSize:"12px",fontWeight:600,background:x?"var(--color-accent)":"rgba(255,255,255,0.15)",color:x?"#000":"var(--color-text)",border:x?"none":"1.5px solid var(--color-accent)",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s",boxShadow:x?"0 2px 8px rgba(245, 166, 35, 0.3)":"none"},onMouseEnter:j=>{x||(j.currentTarget.style.background="rgba(255,255,255,0.25)",j.currentTarget.style.transform="scale(1.05)")},onMouseLeave:j=>{x||(j.currentTarget.style.background="rgba(255,255,255,0.15)",j.currentTarget.style.transform="scale(1)")},children:x?" Taxonomic":" Species Codes"}),l.jsx("span",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:x?"Phylogenetic (eBird 2025)":"Alphabetical"})]})}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:B(R).map(j=>{const A=u===j.code;return l.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:j.clipCount>1?"pointer":"default"},onClick:()=>{j.clipCount>1&&d(A?null:j.code)},children:[l.jsx(jg,{code:j.code,size:36}),l.jsxs("div",{style:{minWidth:0,flex:1},children:[l.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:j.code}),l.jsx("div",{style:{fontSize:"13px",fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:j.name}),x&&b[j.code]&&l.jsx("div",{style:{fontSize:"11px",fontStyle:"italic",color:"var(--color-text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:b[j.code]})]}),j.canonicalClipPath&&l.jsx("button",{onClick:T=>{T.stopPropagation(),D(j.canonicalClipPath,j.code)},style:{width:"32px",height:"32px",borderRadius:"50%",border:"none",background:a===j.code?"var(--color-accent)":"rgba(255,255,255,0.1)",color:a===j.code?"#000":"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px"},children:a===j.code?"":""}),j.clipCount>1&&l.jsx("span",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:A?"":""})]}),A&&j.allClips.length>0&&l.jsxs("div",{style:{padding:"0 12px 12px 12px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[l.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"8px",marginBottom:"8px",fontWeight:600},children:["All Recordings (",j.allClips.length,")"]}),j.allClips.map((T,H)=>l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",padding:"6px",background:"rgba(0,0,0,0.2)",borderRadius:"6px"},children:[l.jsx("button",{onClick:()=>D(T.path,`${j.code}_${H}`),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===`${j.code}_${H}`?"var(--color-accent)":"rgba(255,255,255,0.1)",color:a===`${j.code}_${H}`?"#000":"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",flexShrink:0},children:a===`${j.code}_${H}`?"":""}),l.jsx("div",{style:{flex:1,fontSize:"11px"},children:l.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",flexWrap:"wrap"},children:[T.isCanonical&&l.jsx("span",{style:{fontSize:"9px",background:"var(--color-accent)",color:"#000",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"SIGNATURE"}),l.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:T.vocalizationType==="song"?"rgba(76, 175, 80, 0.2)":"rgba(245, 166, 35, 0.2)",padding:"2px 6px",borderRadius:"4px",textTransform:"uppercase"},children:T.vocalizationType}),(T.source||T.recordist)&&l.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:T.sourceUrl?l.jsxs("a",{href:T.sourceUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:[T.sourceId,T.recordist?`  ${T.recordist}`:""]}):l.jsxs(l.Fragment,{children:[T.source==="macaulay"?T.sourceId||"Cornell":T.source==="user_recording"?T.recordist||"User":T.sourceId||T.source,T.source!=="user_recording"&&T.recordist&&!T.sourceId&&`  ${T.recordist}`]})})]})})]},T.id))]})]},j.code)})})]})]},R)})(),Vu.filter(R=>R.isUnlocked).map(R=>{var I,j,A;const F=f||h.has(R.id);return l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("div",{onClick:()=>{const T=new Set(h);T.has(R.id)?T.delete(R.id):T.add(R.id),p(T)},style:{fontSize:"14px",marginBottom:F?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:T=>T.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:T=>T.currentTarget.style.background="var(--color-surface)",children:[l.jsx("span",{style:{fontSize:"14px"},children:F?"":""}),l.jsx("span",{style:{fontWeight:600},children:R.name}),l.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((I=s[R.id])==null?void 0:I.length)||0," species"]})]}),F&&((j=e.state)==null?void 0:j.fromPreview)&&((A=e.state)==null?void 0:A.pack)===R.id&&l.jsx("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"flex-end"},children:l.jsx("button",{onClick:()=>{const{pack:T,level:H}=e.state;t(`/preview?pack=${T}&level=${H}`)},style:{padding:"10px 16px",fontSize:"14px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 4px 12px rgba(45, 90, 39, 0.4)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:T=>{T.currentTarget.style.transform="scale(1.05)",T.currentTarget.style.boxShadow="0 6px 16px rgba(45, 90, 39, 0.5)"},onMouseLeave:T=>{T.currentTarget.style.transform="scale(1)",T.currentTarget.style.boxShadow="0 4px 12px rgba(45, 90, 39, 0.4)"},children:"Ready to Play?"})}),F&&l.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"rgba(70, 70, 90, 0.3)",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",position:"relative"},children:l.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[l.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"var(--color-text-muted)"},children:"Sort:"}),l.jsx("button",{onClick:()=>{y(!x)},style:{padding:"6px 12px",fontSize:"12px",fontWeight:600,background:x?"var(--color-accent)":"rgba(255,255,255,0.15)",color:x?"#000":"var(--color-text)",border:x?"none":"1.5px solid var(--color-accent)",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s",boxShadow:x?"0 2px 8px rgba(245, 166, 35, 0.3)":"none"},onMouseEnter:T=>{x||(T.currentTarget.style.background="rgba(255,255,255,0.25)",T.currentTarget.style.transform="scale(1.05)")},onMouseLeave:T=>{x||(T.currentTarget.style.background="rgba(255,255,255,0.15)",T.currentTarget.style.transform="scale(1)")},children:x?" Taxonomic":" Species Codes"}),l.jsx("span",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:x?"Phylogenetic (eBird 2025)":"Alphabetical"})]})}),F&&l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:B(R.id).map(T=>{const H=u===T.code;return l.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:T.clipCount>1?"pointer":"default"},onClick:()=>{T.clipCount>1&&d(H?null:T.code)},children:[l.jsx(jg,{code:T.code,size:36}),l.jsxs("div",{style:{minWidth:0,flex:1},children:[l.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:T.code}),l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:T.name}),x&&b[T.code]&&l.jsx("div",{style:{fontSize:"10px",fontStyle:"italic",color:"var(--color-text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:b[T.code]}),l.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)"},children:[T.clipCount," clip",T.clipCount!==1?"s":"",T.clipCount>1&&l.jsx("span",{style:{marginLeft:"4px",color:"var(--color-accent)"},children:H?"":""})]})]}),l.jsx("button",{onClick:X=>{X.stopPropagation(),T.canonicalClipPath&&D(T.canonicalClipPath,T.code)},disabled:!T.canonicalClipPath,style:{width:"28px",height:"28px",borderRadius:"50%",border:"none",background:a===T.code?"var(--color-accent)":"var(--color-primary)",color:"white",cursor:T.canonicalClipPath?"pointer":"not-allowed",opacity:T.canonicalClipPath?1:.3,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play ${T.name}`,children:a===T.code?l.jsx(Ig,{}):l.jsx(Rg,{})})]}),H&&T.allClips.length>0&&l.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"8px 12px",background:"rgba(0,0,0,0.2)"},children:[l.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"8px"},children:["All ",T.clipCount," clips:"]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:T.allClips.map((X,K)=>l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("button",{onClick:()=>D(X.path,X.id),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===X.id?"var(--color-accent)":"rgba(255,255,255,0.15)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play clip ${K+1}`,children:a===X.id?l.jsx(Ig,{size:8}):l.jsx(Rg,{size:8})}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px",flex:1},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[l.jsx("span",{style:{fontSize:"11px",color:"var(--color-text)"},children:X.sourceId||`Clip ${K+1}`}),X.isCanonical&&l.jsx("span",{style:{fontSize:"9px",color:"#000",background:"var(--color-accent)",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:" SIGNATURE"}),X.vocalizationType&&l.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px",textTransform:"capitalize"},children:X.vocalizationType}),(X.source||X.recordist)&&l.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:X.sourceUrl?l.jsxs("a",{href:X.sourceUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:[X.sourceId,X.recordist?`  ${X.recordist}`:""]}):l.jsxs(l.Fragment,{children:[X.source==="macaulay"?X.sourceId||"Cornell":X.source==="user_recording"?X.recordist||"User":X.sourceId||X.source,X.source!=="user_recording"&&X.recordist&&!X.sourceId&&`  ${X.recordist}`]})})]})})]},X.id))})]})]},T.code)})})]},R.id)})]})]})}function eT(){return l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),l.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function Rg({size:t=14}){return l.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M8 5v14l11-7z"})})}function Ig({size:t=12}){return l.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function tT(){return l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:l.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}function rT(){return l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:l.jsx("path",{d:"M12 5v14M5 12h14"})})}function nT({size:t=80}){return l.jsx("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"currentColor",children:l.jsx("path",{d:"M85 35c-5-3-12-2-18 1-3-8-10-14-19-16 2-3 3-7 2-11-1-5-5-8-9-7s-7 5-6 10c0 2 1 4 2 5-10 3-18 11-21 21-8-1-16 2-21 8-2 2-1 5 1 6s5 0 7-2c3-4 8-5 13-4 0 12 7 23 18 28l-8 12c-2 2-1 5 1 7 2 1 5 1 6-2l10-14c3 1 6 1 9 1 4 0 7-1 10-2l10 14c2 2 5 3 7 1s2-5 0-7l-8-12c11-5 18-16 18-28 5-1 10 0 13 4 2 2 5 3 7 2s3-4 1-6c-5-6-13-9-21-8z"})})}function jg({code:t,size:e=36}){const[r,n]=S.useState(!0),i=`/data/icons/${t}.png`;return r?l.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",flexShrink:0},onError:()=>n(!1)}):l.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-primary)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.4,flexShrink:0},children:l.jsx(nT,{size:e*.7})})}const iT={starter_birds:"Backyard Birds",expanded_backyard:"Eastern Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Birds",custom:"Custom Pack"};function sT(t){return[{level_id:1,pack_id:"custom",mode:"campaign",title:"Meet Your Birds",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:2,pack_id:"custom",mode:"campaign",title:"Sound Variations",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:3,pack_id:"custom",mode:"campaign",title:"Full Repertoire",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:4,pack_id:"custom",mode:"campaign",title:"Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:5,pack_id:"custom",mode:"campaign",title:"Variations + Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:6,pack_id:"custom",mode:"campaign",title:"Master Birder",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"}]}function oT(t){const e=[];return t.clip_selection==="canonical"?e.push("Signature sounds only"):t.clip_selection==="all"?e.push("Full repertoire"):typeof t.clip_selection=="number"&&e.push(`${t.clip_selection} variations per bird`),t.channel_mode==="offset"?e.push("both ears"):e.push("one ear"),e.join("  ")}function aT(t){const e=t.level_id;return e<=2?{label:"Easy",color:"#4CAF50"}:e<=4?{label:"Medium",color:"#FFC107"}:{label:"Hard",color:"#FF5722"}}function lT(){const t=er(),[e]=eu(),r=e.get("pack")||"starter_birds",[n,i]=S.useState([]),[s,o]=S.useState(!0);S.useEffect(()=>{if(r==="custom"){try{const u=localStorage.getItem("soundfield_custom_pack");if(u){const d=JSON.parse(u);if(Array.isArray(d)&&d.length>0){i(sT(d.length)),o(!1);return}}t("/custom-pack",{replace:!0})}catch(u){console.error("Failed to load custom pack:",u),t("/custom-pack",{replace:!0})}return}fetch("/data/levels.json").then(u=>u.json()).then(u=>{const d=u.filter(h=>h.pack_id===r);i(d.sort((h,p)=>h.level_id-p.level_id)),o(!1)}).catch(u=>{console.error("Failed to load levels:",u),o(!1)})},[r,t]);const a=u=>{qE(r,u.level_id,u.title||`Level ${u.level_id}`),t(`/preview?pack=${r}&level=${u.level_id}`)},c=iT[r]||r;return l.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"8px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t(r==="custom"?"/custom-pack":"/pack-select"),"aria-label":"Back",style:{color:"var(--color-accent)"},children:l.jsx(cT,{})}),l.jsxs("div",{style:{flex:1},children:[l.jsx("h2",{style:{margin:0,fontSize:"20px"},children:c}),l.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[l.jsx("span",{children:"Select a level"}),r!=="custom"&&l.jsxs(l.Fragment,{children:[l.jsx("span",{style:{color:"var(--color-surface)"},children:""}),l.jsx(ma,{to:`/pack-select?expand=${r}#bird-reference`,state:{fromLevelSelect:!0,packId:r},style:{color:"var(--color-accent)",textDecoration:"none",fontSize:"12px"},children:"Bird Reference"})]})]})]}),l.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:l.jsx(dT,{})})]}),s?l.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--color-text-muted)"},children:"Loading levels..."}):l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:n.map(u=>{const d=aT(u);return l.jsxs("button",{onClick:()=>a(u),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"var(--color-surface)",border:"none",borderRadius:"12px",cursor:"pointer",textAlign:"left",transition:"transform 0.15s, background 0.15s"},onMouseEnter:h=>{h.currentTarget.style.transform="translateX(4px)",h.currentTarget.style.background="rgba(45, 45, 68, 1)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateX(0)",h.currentTarget.style.background="var(--color-surface)"},children:[l.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:`linear-gradient(135deg, ${d.color}33, ${d.color}11)`,border:`2px solid ${d.color}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"20px",color:d.color,flexShrink:0},children:u.level_id}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:u.title}),l.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:oT(u)})]}),l.jsx("div",{style:{color:"var(--color-text-muted)",flexShrink:0},children:l.jsx(uT,{})})]},u.level_id)})}),l.jsx("div",{style:{marginTop:"24px",padding:"12px 16px",background:"rgba(245, 166, 35, 0.1)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:l.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"Tip:"})," Start with Level 1 to learn each bird's signature sound, then progress to variations and both-ear challenges."]})})]})}function cT(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function uT(){return l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M9 18l6-6-6-6"})})}function dT(){return l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),l.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}const qi=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"],hT={starter_birds:"Backyard Birds",expanded_backyard:"Eastern Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Birds",custom:"Custom Pack"},pT={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function fT(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function mT(t){return t>=4?"offset":"single"}function gT({code:t,size:e=56,color:r}){const[n,i]=S.useState(!0),s=`/data/icons/${t}.png`;return l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",WebkitTapHighlightColor:"transparent"},children:[n&&l.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?l.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",WebkitTapHighlightColor:"transparent"},onError:()=>i(!1)}):l.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"var(--color-surface)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.25,fontWeight:700,color:"#1A1A2E"},children:t})]})}function xT(){const t=er(),[e]=eu(),r=e.get("pack")||"starter_birds",n=parseInt(e.get("level")||"1",10),i=e.get("keepBirds")==="true",[s,o]=S.useState(null),[a,c]=S.useState([]),[u,d]=S.useState([]),[h,p]=S.useState(null),[f,m]=S.useState(!0),[_,v]=S.useState("idle"),[x,y]=S.useState({loaded:0,total:0}),[g,w]=S.useState(()=>{try{return localStorage.getItem("soundfield_training_mode")==="true"}catch{return!1}}),[b,P]=S.useState(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}}),[C,E]=S.useState({}),[M,B]=S.useState({}),[N,D]=S.useState({}),[k,L]=S.useState([]),U=S.useRef(null),R=()=>{const z=!g;w(z);try{localStorage.setItem("soundfield_training_mode",String(z))}catch(Y){console.error("Failed to save training mode:",Y)}},F=()=>{const z=!b;P(z);try{localStorage.setItem("soundfield_taxonomic_sort",String(z)),a_(z,"preview_screen")}catch(Y){console.error("Failed to save taxonomic sort:",Y)}};S.useEffect(()=>{if(u.length===0||Object.keys(C).length===0)return;const z=u.map(q=>q.code),pe=(b?[...z].sort((q,oe)=>{const ye=C[q]||9999,Ee=C[oe]||9999;return ye-Ee}):[...z].sort()).map((q,oe)=>({...u.find(Ee=>Ee.code===q),color:qi[oe%qi.length]}));pe.some((q,oe)=>q.code!==u[oe].code)&&d(pe)},[b,C]),S.useEffect(()=>{Promise.all([fetch("/data/taxonomic_order.json").then(z=>z.json()),fetch("/data/species.json").then(z=>z.json())]).then(([z,Y])=>{E(z);const pe={},de={};Y.forEach(q=>{pe[q.species_code]=q.scientific_name,de[q.species_code]=q.common_name}),B(pe),D(de)}).catch(z=>console.error("Failed to load taxonomy data:",z))},[]);const I=S.useCallback((z,Y)=>[...z].sort().map((de,q)=>{const oe=Y.find(we=>we.species_code===de&&we.canonical&&!we.rejected),ye=Y.find(we=>we.species_code===de&&!we.rejected),Ee=oe||ye;return{code:de,name:N[de]||de,scientificName:M[de],color:qi[q%qi.length],clipPath:Ee?`/data/clips/${Ee.file_path.split("/").pop()}`:null}}),[N,M]),j=S.useCallback((z,Y)=>{const pe=Math.min(9,z.length),q=[...z].sort(()=>Math.random()-.5).slice(0,pe);d(I(q,Y))},[I]),A=S.useCallback((z,Y)=>{const pe=z.species_pool||[],de=z.species_count||pe.length,Ee=[...pe].sort(()=>Math.random()-.5).slice(0,de).sort().map((we,$e)=>{const et=Y.find(fe=>fe.species_code===we&&fe.canonical&&!fe.rejected),O=Y.find(fe=>fe.species_code===we&&!fe.rejected),te=et||O;return{code:we,name:N[we]||we,scientificName:M[we],color:qi[$e%qi.length],clipPath:te?`/data/clips/${te.file_path.split("/").pop()}`:null}});d(Ee)},[N,M]);S.useEffect(()=>{Promise.all([fetch("/data/levels.json").then(z=>z.json()),fetch("/data/clips.json").then(z=>z.json())]).then(([z,Y])=>{if(c(Y),r==="custom"){const de=localStorage.getItem("soundfield_custom_pack");if(de)try{const q=JSON.parse(de);L(q);let oe;if(i){const Ee=sessionStorage.getItem("roundSpecies");if(Ee)try{const we=JSON.parse(Ee),$e=we.filter(et=>q.includes(et));$e.length===we.length?oe=$e:oe=q.length>9?[...q].sort(()=>Math.random()-.5).slice(0,9):q}catch(we){console.error("Failed to parse saved species:",we),oe=q.length>9?[...q].sort(()=>Math.random()-.5).slice(0,9):q}else oe=q.length>9?[...q].sort(()=>Math.random()-.5).slice(0,9):q}else oe=q.length>9?[...q].sort(()=>Math.random()-.5).slice(0,9):q;const ye={level_id:n,pack_id:"custom",mode:"campaign",title:pT[n]||`Level ${n}`,round_duration_sec:30,species_count:oe.length,species_pool:oe,clip_selection:fT(n),channel_mode:mT(n),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"};o(ye),d(I(oe,Y))}catch(q){console.error("Failed to parse custom pack:",q)}m(!1);return}const pe=z.find(de=>de.pack_id===r&&de.level_id===n);if(pe){if(o(pe),i){const de=sessionStorage.getItem("roundSpecies");if(de)try{const q=JSON.parse(de),oe=pe.species_pool||[],ye=q.filter(Ee=>oe.includes(Ee));if(ye.length===q.length){d(I(ye,Y)),m(!1);return}}catch(q){console.error("Failed to parse saved species:",q)}}A(pe,Y)}m(!1)}).catch(z=>{console.error("Failed to load data:",z),m(!1)})},[r,n,i,I,A]),S.useEffect(()=>{if(u.length===0||a.length===0){v("idle");return}const z=u.map(q=>q.code),Y=a.filter(q=>z.includes(q.species_code)&&!q.rejected);if(Y.length===0){v("ready"),y({loaded:0,total:0});return}v("loading"),y({loaded:0,total:Y.length}),console.log(`Preloading ${Y.length} clips for ${z.length} species...`);let pe=0;const de=Y.map(async q=>{const oe=`/${q.file_path}`;try{const ye=await fetch(oe);ye.ok&&await ye.arrayBuffer()}catch(ye){console.warn("Failed to preload:",q.file_path,ye)}finally{pe++,y({loaded:pe,total:Y.length})}});Promise.all(de).then(()=>{console.log("Preloading complete!"),v("ready")})},[u,a]);const T=()=>{s&&a.length>0&&(U.current&&(U.current.pause(),U.current=null,p(null)),v("idle"),A(s,a))},H=()=>{k.length>0&&a.length>0&&(U.current&&(U.current.pause(),U.current=null,p(null)),v("idle"),j(k,a))},X=z=>{if(console.log(`[Preview] Attempting to play: ${z.code}`),console.log(`[Preview] Clip path: ${z.clipPath}`),U.current&&(U.current.pause(),U.current=null),h===z.code){p(null);return}if(!z.clipPath){console.error(`[Preview] No clip path for ${z.code}!`);return}const Y=new Audio(z.clipPath);U.current=Y,p(z.code),Y.play().then(()=>console.log(`[Preview] Playing ${z.code} successfully`)).catch(pe=>{console.error(`[Preview] Failed to play ${z.code}:`,pe),console.error(`[Preview] Clip path was: ${z.clipPath}`)}),Y.onended=()=>{console.log(`[Preview] ${z.code} finished playing`),p(null),U.current=null}},K=()=>{U.current&&U.current.pause();const z=u.map(Y=>Y.code);sessionStorage.setItem("roundSpecies",JSON.stringify(z)),t(`/gameplay?mode=campaign&pack=${r}&level=${n}&preview=true`)};if(S.useEffect(()=>()=>{U.current&&U.current.pause()},[]),f)return l.jsx("div",{className:"screen screen-center",children:l.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading..."})});if(!s)return l.jsxs("div",{className:"screen screen-center",children:[l.jsx("div",{style:{color:"var(--color-error)"},children:"Level not found"}),l.jsx("button",{onClick:()=>t(-1),style:{marginTop:"16px",padding:"8px 16px",background:"var(--color-surface)",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"Go Back"})]});const Te=hT[r]||r;return l.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",paddingTop:"calc(12px + var(--safe-area-top))",paddingBottom:"calc(12px + var(--safe-area-bottom))",paddingLeft:"16px",paddingRight:"16px",gap:"10px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t(`/level-select?pack=${r}`),"aria-label":"Back",style:{flexShrink:0,color:"var(--color-accent)"},children:l.jsx(yT,{})}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"14px",lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:Te}),l.jsxs("div",{style:{fontSize:"12px",color:"var(--color-accent)",lineHeight:1.1},children:["Level ",s.level_id,": ",s.title]})]}),l.jsx("button",{onClick:()=>t(`/pack-select?scrollTo=${r}&expandPack=${r}#bird-reference`,{state:{fromPreview:!0,pack:r,level:n}}),style:{padding:"6px 10px",background:"transparent",border:"1px solid rgba(100, 181, 246, 0.3)",borderRadius:"6px",color:"#64B5F6",fontSize:"15px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",flexShrink:0,whiteSpace:"nowrap"},children:""}),(s.species_pool&&s.species_pool.length>(s.species_count||0)||k.length>9)&&l.jsx("button",{onClick:k.length>9?H:T,style:{padding:"6px 10px",background:"transparent",border:"1px solid var(--color-accent)",borderRadius:"6px",color:"var(--color-accent)",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",flexShrink:0},title:k.length>9?`Re-roll (${k.length} total birds)`:"Shuffle birds",children:l.jsx(vT,{})})]}),l.jsxs("div",{style:{display:"flex",gap:"6px",fontSize:"12px"},children:[l.jsxs("button",{onClick:R,style:{flex:1,padding:"6px 8px",background:g?"rgba(76, 175, 80, 0.25)":"rgba(255, 255, 255, 0.05)",border:g?"2px solid var(--color-success)":"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[l.jsx(_T,{filled:g,color:g?"var(--color-success)":void 0}),l.jsx("span",{style:{fontSize:"11px"},children:"Training"})]}),l.jsxs("button",{onClick:F,style:{flex:1,padding:"6px 8px",background:b?"rgba(100, 181, 246, 0.25)":"rgba(255, 255, 255, 0.05)",border:b?"2px solid #64B5F6":"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[l.jsx("span",{style:{fontSize:"14px"},children:b?"":""}),l.jsx("span",{style:{fontSize:"11px"},children:b?"Taxonomic ":"Sort"})]})]}),_==="loading"&&l.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"6px",padding:"6px 10px"},children:[l.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"4px"},children:["Loading sounds ",x.loaded,"/",x.total]}),l.jsx("div",{style:{width:"100%",height:"3px",background:"rgba(0,0,0,0.2)",borderRadius:"2px",overflow:"hidden"},children:l.jsx("div",{style:{width:`${x.loaded/x.total*100}%`,height:"100%",background:"var(--color-accent)",transition:"width 0.2s ease"}})})]}),l.jsx("div",{style:{background:"rgba(100, 181, 246, 0.1)",border:"1px solid rgba(100, 181, 246, 0.3)",borderRadius:"8px",padding:"10px 12px"},children:l.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text)",lineHeight:1.4,textAlign:"center"},children:[l.jsx("strong",{children:" Study the grid:"})," Each bird will appear in the same position during play. Take a moment to memorize where each species lives on screenand any unfamiliar code names. Use  to mix it up. Engage  for speed-learning."]})}),l.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:0},children:[k.length>9&&l.jsxs("div",{style:{fontSize:"12px",color:"var(--color-accent)",marginBottom:"6px",textAlign:"center",fontWeight:600},children:["Playing 9 of ",k.length," birds"]}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Tap to preview signature song. Press and hold to get a closer look!"}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px",maxWidth:"320px",width:"100%"},children:u.map(z=>l.jsxs("button",{onClick:()=>X(z),disabled:!z.clipPath,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px",padding:"10px 6px",background:h===z.code?`${z.color}33`:"var(--color-surface)",border:`2px solid ${z.color}`,borderRadius:"10px",cursor:z.clipPath?"pointer":"not-allowed",opacity:z.clipPath?1:.5,transition:"transform 0.15s, background 0.15s",WebkitTapHighlightColor:"transparent"},children:[l.jsx("div",{style:{position:"relative",WebkitTapHighlightColor:"transparent"},children:l.jsx(gT,{code:z.code,size:52,color:z.color})}),l.jsx("div",{style:{fontSize:"10px",color:"var(--color-text)",textAlign:"center",lineHeight:1.2,maxWidth:"75px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontStyle:b&&z.scientificName?"italic":"normal"},children:b&&z.scientificName?z.scientificName:z.name})]},z.code))})]}),l.jsx("button",{onClick:K,style:{width:"100%",padding:"12px",fontSize:"15px",fontWeight:700,background:_==="ready"?"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)":"linear-gradient(135deg, #555 0%, #444 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 3px 10px rgba(45, 90, 39, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:_==="ready"?l.jsxs(l.Fragment,{children:["Ready to Play ",l.jsx(Mg,{})]}):_==="loading"?l.jsx(l.Fragment,{children:"Loading..."}):l.jsxs(l.Fragment,{children:["Ready to Play ",l.jsx(Mg,{})]})}),l.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.7; }
        }
        * {
          -webkit-tap-highlight-color: transparent;
        }
      `})]})}function yT(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function vT(){return l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M16 3h5v5"}),l.jsx("path",{d:"M4 20L21 3"}),l.jsx("path",{d:"M21 16v5h-5"}),l.jsx("path",{d:"M15 15l6 6"}),l.jsx("path",{d:"M4 4l5 5"})]})}function Mg(){return l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M8 5v14l11-7z"})})}function _T({filled:t,color:e}){const r=e||(t?"var(--color-accent)":"var(--color-text-muted)");return l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3",fill:t?r:"none"})]})}const mo=30,go="soundfield_custom_pack",Ji="soundfield_saved_packs",xo=10,Bg=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE","#F06292","#64B5F6","#AED581","#FFB74D","#9575CD","#FF7043","#4DD0E1","#DCE775","#C5A880","#EF5350","#42A5F5","#66BB6A","#FFA726","#AB47BC","#FF6F00","#26C6DA","#D4E157","#8D6E63","#EC407A","#29B6F6","#9CCC65"];function wT(){var et;const t=er(),[e,r]=S.useState([]),[n,i]=S.useState([]),[s,o]=S.useState(""),[a,c]=S.useState(null),[u,d]=S.useState(!0),h=S.useRef(null),p=S.useRef(null),f=S.useRef(!1),[m,_]=S.useState(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}}),[v,x]=S.useState({}),[y,g]=S.useState([]),[w,b]=S.useState(!1),[P,C]=S.useState(""),[E,M]=S.useState(!1),[B,N]=S.useState(!1),[D,k]=S.useState(null),[L,U]=S.useState(null),[R,F]=S.useState(""),[I,j]=S.useState(!1),[A,T]=S.useState(!1);S.useEffect(()=>{Promise.all([fetch("/data/clips.json").then(O=>O.json()),fetch("/data/taxonomic_order.json").then(O=>O.json()),fetch("/data/species.json").then(O=>O.json())]).then(([O,te,fe])=>{const me={},De={};for(const Je of fe)me[Je.species_code]=Je.scientific_name,De[Je.species_code]=Je.common_name;const gt=new Map;for(const Je of O)if(!Je.rejected&&!gt.has(Je.species_code)){const no=O.find(hr=>hr.species_code===Je.species_code&&hr.canonical&&!hr.rejected)||O.find(hr=>hr.species_code===Je.species_code&&!hr.rejected)||Je,qr=De[Je.species_code];if(!qr){console.warn(`Skipping ${Je.species_code} - not found in species.json`);continue}gt.set(Je.species_code,{code:Je.species_code,name:qr,clipPath:`/data/clips/${no.file_path.split("/").pop()}`,scientificName:me[Je.species_code]})}const Pr=Array.from(gt.values()).sort((Je,li)=>(Je.name||Je.code).localeCompare(li.name||li.code));r(Pr),x(te),d(!1)}).catch(O=>{console.error("Failed to load data:",O),d(!1)});try{if(sessionStorage.getItem("customPackWasTemporary")==="true")sessionStorage.removeItem("customPackWasTemporary"),localStorage.removeItem(go),console.log("Cleared temporary custom pack after play session");else{const te=localStorage.getItem(go);if(te){const fe=JSON.parse(te);Array.isArray(fe)&&fe.length>0&&i(fe)}}}catch(O){console.error("Failed to load saved pack:",O)}try{const O=localStorage.getItem(Ji);if(O){const te=JSON.parse(O);Array.isArray(te)&&g(te)}}catch(O){console.error("Failed to load saved packs:",O)}},[]),S.useEffect(()=>{if(e.length===0||y.length===0||f.current)return;f.current=!0;const O=new Set(e.map(me=>me.code));let te=!1;const fe=y.map(me=>{me.version||(me.version=1,te=!0);const De=me.species.filter(gt=>O.has(gt));return De.length!==me.species.length?(te=!0,{...me,species:De}):me});if(te){g(fe);try{localStorage.setItem(Ji,JSON.stringify(fe)),console.log("Auto-cleaned saved packs: removed invalid species codes")}catch(me){console.error("Failed to auto-clean saved packs:",me)}}},[e,y]);const H=S.useCallback((O,te)=>{i(fe=>{const me=fe.includes(O),De=fe.length>=mo;return me?fe.filter(gt=>gt!==O):De?fe:(te===1&&o(""),setTimeout(()=>{var gt;(gt=p.current)==null||gt.focus()},0),[...fe,O])})},[]),X=(O,te)=>{if(te.stopPropagation(),h.current&&(h.current.pause(),h.current=null),a===O.code){c(null);return}if(!O.clipPath)return;const fe=new Audio(O.clipPath);h.current=fe,c(O.code),fe.play().catch(me=>console.error("Failed to play:",me)),fe.onended=()=>{c(null),h.current=null}},K=()=>{if(n.length===0)return;!L||!y.some(te=>te.id===L)?j(!0):Te()},Te=()=>{localStorage.setItem(go,JSON.stringify(n)),sessionStorage.setItem("customPackWasTemporary","true"),kg(n.length),t("/level-select?pack=custom")},z=()=>{j(!1),T(!0),b(!0)},Y=()=>{i([]),U(null),F("");try{localStorage.removeItem(go)}catch(O){console.error("Failed to clear custom pack from localStorage:",O)}},pe=()=>{o(""),setTimeout(()=>{var O;(O=p.current)==null||O.focus()},0)},de=()=>{const O=!m;_(O);try{localStorage.setItem("soundfield_taxonomic_sort",String(O)),a_(O,"custom_pack_builder")}catch(te){console.error("Failed to save taxonomic sort:",te)}},q=()=>{if(n.length===0){alert("Please select at least one bird before saving.");return}if(y.length>=xo&&!L){alert(`You can only save up to ${xo} packs. Please delete one first.`);return}L&&R&&C(R),b(!0)},oe=(O=!1)=>{const te=P.trim();if(!te){alert("Please enter a name for your pack.");return}if(L&&!O){const fe=y.map(me=>me.id===L?{...me,name:te,species:[...n],lastModified:new Date().toISOString()}:me);g(fe);try{localStorage.setItem(Ji,JSON.stringify(fe)),Pg(te,n.length)}catch(me){console.error("Failed to update pack:",me),alert("Failed to update pack. Storage may be full.")}F(te)}else{if(y.length>=xo){alert(`You can only save up to ${xo} packs. Please delete one first.`);return}const fe={id:Date.now().toString(),name:te,species:[...n],created:new Date().toISOString(),version:1},me=[...y,fe];g(me);try{localStorage.setItem(Ji,JSON.stringify(me)),Pg(te,n.length)}catch(De){console.error("Failed to save pack:",De),alert("Failed to save pack. Storage may be full.")}U(fe.id),F(fe.name)}b(!1),C(""),A&&(T(!1),localStorage.setItem(go,JSON.stringify(n)),kg(n.length),t("/level-select?pack=custom"))},ye=O=>{const te=new Set(e.map(De=>De.code)),fe=O.species.filter(De=>te.has(De)),me=O.species.length-fe.length;if(me>0){alert(` ${me} bird${me>1?"s":""} in "${O.name}" ${me>1?"are":"is"} no longer available and ${me>1?"were":"was"} removed.

This can happen when bird names are updated to match the latest taxonomy.`);const De={...O,species:fe},gt=y.map(Pr=>Pr.id===O.id?De:Pr);g(gt);try{localStorage.setItem(Ji,JSON.stringify(gt))}catch(Pr){console.error("Failed to update pack:",Pr)}}i(fe),o(""),U(O.id),F(O.name),JE(O.name,fe.length)},Ee=O=>{k(O),N(!0)},we=()=>{var fe;if(!D)return;const O=((fe=y.find(me=>me.id===D))==null?void 0:fe.name)||"unknown",te=y.filter(me=>me.id!==D);g(te);try{localStorage.setItem(Ji,JSON.stringify(te)),QE(O)}catch(me){console.error("Failed to update saved packs:",me)}N(!1),k(null)},$e=(()=>{const O=s?e.filter(te=>te.name.toLowerCase().includes(s.toLowerCase())||te.code.toLowerCase().includes(s.toLowerCase())||te.scientificName&&te.scientificName.toLowerCase().includes(s.toLowerCase())):e;return m&&Object.keys(v).length>0?[...O].sort((te,fe)=>{const me=v[te.code]||9999,De=v[fe.code]||9999;return me-De}):O})();return S.useEffect(()=>()=>{h.current&&h.current.pause()},[]),u?l.jsx("div",{className:"screen screen-center",children:l.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading species..."})}):l.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",overflow:"hidden"},children:[l.jsx("div",{style:{flexShrink:0,marginBottom:"12px"},children:l.jsxs("div",{className:"flex-row items-center gap-md",children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/pack-select"),"aria-label":"Back",children:l.jsx(bT,{})}),l.jsxs("div",{children:[l.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Custom Pack Builder"}),l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:L?l.jsxs("span",{children:["Editing: ",l.jsx("strong",{style:{color:"var(--color-accent)"},children:R})]}):`Select up to ${mo} birds`})]})]})}),y.length>0&&l.jsxs("div",{style:{flexShrink:0,marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[l.jsxs("button",{onClick:()=>M(!E),style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",background:"none",border:"none",color:"var(--color-text)",cursor:"pointer",padding:0},children:[l.jsxs("span",{style:{fontSize:"13px",fontWeight:600},children:[" My Saved Packs (",y.length,"/",xo,")"]}),l.jsx("span",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:E?"":""})]}),E&&l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px",marginTop:"8px"},children:y.map(O=>l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 8px",background:"rgba(100, 181, 246, 0.05)",borderRadius:"6px",border:"1px solid rgba(100, 181, 246, 0.2)",position:"relative"},children:[l.jsxs("button",{onClick:()=>{ye(O),M(!1)},style:{flex:1,textAlign:"left",background:"none",border:"none",color:"var(--color-text)",fontSize:"12px",cursor:"pointer",padding:0},children:[l.jsx("div",{style:{fontWeight:600},children:O.name}),l.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:[O.species.length," bird",O.species.length>1?"s":""]})]}),l.jsx("button",{onPointerDown:te=>{te.stopPropagation(),console.log("Delete button pressed!",O.id),setTimeout(()=>{Ee(O.id)},0)},style:{background:"rgba(229, 115, 115, 0.1)",border:"1px solid rgba(229, 115, 115, 0.3)",borderRadius:"4px",padding:"8px 12px",fontSize:"11px",color:"var(--color-error)",cursor:"pointer",pointerEvents:"auto",position:"relative",zIndex:100,WebkitTapHighlightColor:"rgba(229, 115, 115, 0.3)",touchAction:"manipulation",WebkitUserSelect:"none",userSelect:"none",minWidth:"60px",minHeight:"32px"},"aria-label":`Delete ${O.name}`,children:"Delete"})]},O.id))})]}),l.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",display:"flex",gap:"8px"},children:[l.jsxs("div",{style:{flex:1,position:"relative"},children:[l.jsx("input",{ref:p,type:"text",placeholder:"Search birds...",value:s,onChange:O=>o(O.target.value),style:{width:"100%",padding:"10px 12px",paddingRight:s?"36px":"12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px"}}),s&&l.jsx("button",{onClick:pe,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"var(--color-text-muted)",border:"none",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:0},"aria-label":"Clear search",children:l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-background)",strokeWidth:"3",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),l.jsxs("button",{onClick:de,style:{padding:"10px 14px",background:m?"rgba(100, 181, 246, 0.15)":"var(--color-surface)",border:m?"1px solid #64B5F6":"1px solid var(--color-text-muted)",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"13px",fontWeight:600,whiteSpace:"nowrap"},"aria-label":"Toggle taxonomic sort",children:[l.jsx("span",{children:m?"":""}),l.jsx("span",{children:m?"Taxonomic ":"Sort"})]})]}),l.jsxs("div",{style:{flexShrink:0,marginBottom:"8px",padding:"6px 10px",background:"rgba(45, 90, 39, 0.1)",borderRadius:"8px",fontSize:"12px",color:"var(--color-text-muted)",lineHeight:1.3},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Tap ",l.jsx("strong",{style:{color:"var(--color-text)"},children:""})," to preview, ",l.jsx("strong",{style:{color:"var(--color-text)"},children:"anywhere else on the card"})," to add/remove.",m&&l.jsxs(l.Fragment,{children:[" ",l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Taxonomic mode groups related species together."]})]}),l.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",padding:"8px 12px",background:n.length>0?"rgba(45, 90, 39, 0.2)":"var(--color-surface)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l.jsxs("span",{style:{fontSize:"14px"},children:[l.jsx("span",{style:{fontWeight:700,color:"var(--color-accent)"},children:n.length}),"/",mo," selected"]}),n.length>0&&l.jsxs("div",{style:{display:"flex",gap:"8px"},children:[l.jsx("button",{onClick:q,style:{background:"rgba(45, 90, 39, 0.2)",border:"1px solid var(--color-primary)",borderRadius:"6px",padding:"4px 10px",color:"white",fontSize:"12px",cursor:"pointer",fontWeight:600},children:L?" Update / Save As New":" Save Pack"}),l.jsx("button",{onClick:Y,style:{background:"none",border:"none",color:"var(--color-text-muted)",fontSize:"12px",cursor:"pointer",textDecoration:"underline"},children:"Clear all"})]})]}),l.jsx("div",{style:{flex:1,overflowY:"auto",marginBottom:"12px",paddingBottom:n.length>0?"80px":"0"},children:l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"8px"},children:$e.map(O=>{const te=n.includes(O.code),fe=n.indexOf(O.code),me=te?Bg[fe%Bg.length]:void 0;return l.jsxs("div",{onClick:()=>H(O.code,$e.length),style:{display:"flex",flexDirection:"column",gap:"6px",padding:"8px",background:te?`${me}22`:"var(--color-surface)",border:te?`2px solid ${me}`:"1px solid transparent",borderRadius:"12px",opacity:te||n.length<mo?1:.5,transition:"all 0.15s",cursor:te||n.length<mo?"pointer":"not-allowed"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[l.jsx("button",{onClick:De=>{De.stopPropagation(),X(O,De)},style:{flex:"0 0 44px",width:"44px",height:"44px",borderRadius:"50%",background:a===O.code?"rgba(255, 152, 0, 0.3)":"rgba(255, 152, 0, 0.1)",border:`2px solid ${a===O.code?"var(--color-accent)":"rgba(255, 152, 0, 0.3)"}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.15s",padding:0},"aria-label":`Preview ${O.name}`,children:a===O.code?l.jsx(ET,{color:"var(--color-accent)"}):l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"var(--color-accent)",children:l.jsx("path",{d:"M8 5v14l11-7z"})})}),l.jsxs("div",{style:{flex:"1",display:"flex",alignItems:"center",justifyContent:"center",padding:"4px",position:"relative",pointerEvents:"none"},children:[l.jsx(ST,{code:O.code,size:48}),te&&l.jsx("div",{style:{position:"absolute",top:"0",right:"0",width:"20px",height:"20px",borderRadius:"50%",background:me,display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx(TT,{})})]})]}),l.jsxs("div",{style:{width:"100%",textAlign:"center",pointerEvents:"none"},children:[l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:500,fontStyle:m&&O.scientificName?"italic":"normal"},children:m&&O.scientificName?O.scientificName:O.name}),l.jsx("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginTop:"2px"},children:O.code})]})]},O.code)})})}),n.length>0&&l.jsxs("button",{onClick:K,style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",left:"24px",right:"24px",padding:"14px 20px",fontSize:"16px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",zIndex:1e3},children:[l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M8 5v14l11-7z"})}),"Start with ",n.length," bird",n.length>1?"s":""]}),w&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>b(!1),children:l.jsxs("div",{style:{background:"var(--color-background)",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid var(--color-primary)"},onClick:O=>O.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px"},children:L?"Update or Rename Pack":"Save Custom Pack"}),l.jsx("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"16px"},children:L?"Edit the name or species list. You can update this pack or save as a new one:":"Give your pack a name so you can load it later:"}),l.jsx("input",{type:"text",value:P,onChange:O=>C(O.target.value),onKeyDown:O=>O.key==="Enter"&&oe(!1),placeholder:"e.g., My Backyard, Lake Erie Migrants...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",marginBottom:"16px"}}),L?l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[l.jsxs("button",{onClick:()=>oe(!1),style:{padding:"12px 20px",background:"var(--color-primary)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:[' Update "',R,'"']}),l.jsx("button",{onClick:()=>oe(!0),style:{padding:"12px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Save As New Pack"}),l.jsx("button",{onClick:()=>{b(!1),C("")},style:{padding:"8px 20px",background:"transparent",border:"none",color:"var(--color-text-muted)",fontSize:"13px",cursor:"pointer"},children:"Cancel"})]}):l.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[l.jsx("button",{onClick:()=>{b(!1),C("")},style:{padding:"10px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Cancel"}),l.jsx("button",{onClick:()=>oe(!1),style:{padding:"10px 20px",background:"var(--color-primary)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:" Save Pack"})]})]})}),I&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>j(!1),children:l.jsxs("div",{style:{background:"var(--color-background)",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid var(--color-accent)"},onClick:O=>O.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px"},children:"Save this pack?"}),l.jsx("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.5},children:"Would you like to save this pack before playing? If you save it, you can easily reload and edit it later."}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[l.jsx("button",{onClick:z,style:{padding:"12px 20px",background:"var(--color-primary)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:" Save & Play"}),l.jsx("button",{onClick:()=>{j(!1),Te()},style:{padding:"12px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Just Play (Don't Save)"}),l.jsx("button",{onClick:()=>j(!1),style:{padding:"12px 20px",background:"transparent",border:"none",color:"var(--color-text-muted)",fontSize:"13px",cursor:"pointer"},children:"Cancel"})]})]})}),B&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{N(!1),k(null)},children:l.jsxs("div",{style:{background:"var(--color-background)",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid var(--color-error)"},onClick:O=>O.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"var(--color-error)"},children:"Delete Saved Pack?"}),l.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"16px"},children:['This will permanently delete "',(et=y.find(O=>O.id===D))==null?void 0:et.name,'". This action cannot be undone.']}),l.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[l.jsx("button",{onClick:()=>{N(!1),k(null)},style:{padding:"10px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Cancel"}),l.jsx("button",{onClick:we,style:{padding:"10px 20px",background:"var(--color-error)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Delete Pack"})]})]})})]})}function ST({code:t,size:e=48}){const[r,n]=S.useState(!0),i=`/data/icons/${t}.png`;return r?l.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>n(!1)}):l.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-text-muted)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:700,color:"#FFFFFF"},children:t})}function bT(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function ET({color:t="currentColor"}){return l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:t,children:l.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function TT(){return l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1A1A2E",strokeWidth:"3",children:l.jsx("path",{d:"M20 6L9 17l-5-5"})})}const AT={campaign:"Learn",practice:"Practice",challenge:"Challenge",random:"Random"};function CT({score:t,streak:e,timeRemaining:r,mode:n,levelId:i,levelTitle:s}){const o=Math.floor(r/60),a=r%60,c=`${o}:${a.toString().padStart(2,"0")}`;return l.jsxs("div",{className:"hud",children:[l.jsxs("div",{className:"hud-score",children:[l.jsx("span",{className:"hud-label",children:"Score"}),l.jsx("span",{className:"hud-value",children:t.toLocaleString()})]}),l.jsxs("div",{className:"hud-center",children:[n==="campaign"&&i?l.jsxs("span",{className:"hud-mode",children:["Level ",i,s?`: ${s}`:""]}):n?l.jsx("span",{className:"hud-mode",children:AT[n]||n}):null,l.jsx("div",{className:"hud-streak",children:e===0?l.jsx("span",{className:"streak-dot",children:""}):Array.from({length:e}).map((u,d)=>l.jsx("span",{className:"streak-dot active",children:""},d))})]}),l.jsxs("div",{className:"hud-timer",children:[l.jsx("span",{className:"hud-label",children:"Time"}),l.jsx("span",{className:"hud-value",children:c})]}),l.jsx("style",{children:`
        .hud {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          padding-top: calc(12px + var(--safe-area-top, 0px));
          background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.3) 100%);
          border-bottom: 1px solid var(--color-surface);
        }

        .hud-score, .hud-timer {
          display: flex;
          flex-direction: column;
          align-items: center;
          min-width: 80px;
        }

        .hud-label {
          font-size: 10px;
          text-transform: uppercase;
          color: var(--color-text-muted);
          letter-spacing: 0.5px;
        }

        .hud-value {
          font-family: var(--font-mono);
          font-size: 20px;
          font-weight: 600;
          color: var(--color-accent);
        }

        .hud-center {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 4px;
        }

        .hud-mode {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1px;
          color: var(--color-text-muted);
          padding: 2px 8px;
          border-radius: 4px;
          background: rgba(255, 255, 255, 0.1);
        }

        .hud-streak {
          display: flex;
          gap: 4px;
          font-size: 12px;
        }

        .streak-dot {
          color: var(--color-text-muted);
          transition: color 0.2s, transform 0.2s;
        }

        .streak-dot.active {
          color: var(--color-accent);
          transform: scale(1.2);
        }
      `})]})}const kT=S.memo(CT);var $i=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))($i||{}),l_=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(l_||{}),zh=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(zh||{}),he=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(he||{}),Gr=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(Gr||{}),W=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(W||{}),Ms=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Ms||{}),le=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(le||{}),Q=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(Q||{}),on=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(on||{}),Jn=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Jn||{}),Xr=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Xr||{}),Ot=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Ot||{}),Or=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Or||{}),Ff=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(Ff||{}),or=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(or||{}),lt=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(lt||{}),it=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(it||{}),Vr=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(Vr||{});const PT={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},Z={ADAPTER:PT,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Wu=/iPhone/i,Ng=/iPod/i,Fg=/iPad/i,Lg=/\biOS-universal(?:.+)Mac\b/i,Xu=/\bAndroid(?:.+)Mobile\b/i,Dg=/Android/i,Qi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ja=/Silk/i,Qr=/Windows Phone/i,Og=/\bWindows(?:.+)ARM\b/i,Ug=/BlackBerry/i,zg=/BB10/i,Gg=/Opera Mini/i,Hg=/\b(CriOS|Chrome)(?:.+)Mobile/i,$g=/Mobile(?:.+)Firefox\b/i,Vg=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function RT(t){return function(e){return e.test(t)}}function Wg(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,n=r.split("[FBAN");typeof n[1]<"u"&&(r=n[0]),n=r.split("Twitter"),typeof n[1]<"u"&&(r=n[0]);var i=RT(r),s={apple:{phone:i(Wu)&&!i(Qr),ipod:i(Ng),tablet:!i(Wu)&&(i(Fg)||Vg(e))&&!i(Qr),universal:i(Lg),device:(i(Wu)||i(Ng)||i(Fg)||i(Lg)||Vg(e))&&!i(Qr)},amazon:{phone:i(Qi),tablet:!i(Qi)&&i(Ja),device:i(Qi)||i(Ja)},android:{phone:!i(Qr)&&i(Qi)||!i(Qr)&&i(Xu),tablet:!i(Qr)&&!i(Qi)&&!i(Xu)&&(i(Ja)||i(Dg)),device:!i(Qr)&&(i(Qi)||i(Ja)||i(Xu)||i(Dg))||i(/\bokhttp\b/i)},windows:{phone:i(Qr),tablet:i(Og),device:i(Qr)||i(Og)},other:{blackberry:i(Ug),blackberry10:i(zg),opera:i(Gg),firefox:i($g),chrome:i(Hg),device:i(Ug)||i(zg)||i(Gg)||i($g)||i(Hg)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const IT=Wg.default??Wg,an=IT(globalThis.navigator);Z.RETINA_PREFIX=/@([0-9\.]+)x/;Z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var c_={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,h,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var f=new i(d,h||c,p),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],f]:c._events[m].push(f):(c._events[m]=f,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)e.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},a.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,f=h.length,m=new Array(f);p<f;p++)m[p]=h[p].fn;return m},a.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,d,h,p,f,m){var _=r?r+u:u;if(!this._events[_])return!1;var v=this._events[_],x=arguments.length,y,g;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,h),!0;case 4:return v.fn.call(v.context,d,h,p),!0;case 5:return v.fn.call(v.context,d,h,p,f),!0;case 6:return v.fn.call(v.context,d,h,p,f,m),!0}for(g=1,y=new Array(x-1);g<x;g++)y[g-1]=arguments[g];v.fn.apply(v.context,y)}else{var w=v.length,b;for(g=0;g<w;g++)switch(v[g].once&&this.removeListener(u,v[g].fn,void 0,!0),x){case 1:v[g].fn.call(v[g].context);break;case 2:v[g].fn.call(v[g].context,d);break;case 3:v[g].fn.call(v[g].context,d,h);break;case 4:v[g].fn.call(v[g].context,d,h,p);break;default:if(!y)for(b=1,y=new Array(x-1);b<x;b++)y[b-1]=arguments[b];v[g].fn.apply(v[g].context,y)}}return!0},a.prototype.on=function(u,d,h){return s(this,u,d,h,!1)},a.prototype.once=function(u,d,h){return s(this,u,d,h,!0)},a.prototype.removeListener=function(u,d,h,p){var f=r?r+u:u;if(!this._events[f])return this;if(!d)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===d&&(!p||m.once)&&(!h||m.context===h)&&o(this,f);else{for(var _=0,v=[],x=m.length;_<x;_++)(m[_].fn!==d||p&&!m[_].once||h&&m[_].context!==h)&&v.push(m[_]);v.length?this._events[f]=v.length===1?v[0]:v:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(c_);var jT=c_.exports;const Ca=Lp(jT);var Lf={exports:{}};Lf.exports=tu;Lf.exports.default=tu;function tu(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=u_(t,0,i,r,!0),o=[];if(!s||s.next===s.prev)return o;var a,c,u,d,h,p,f;if(n&&(s=LT(t,e,s,r)),t.length>80*r){a=u=t[0],c=d=t[1];for(var m=r;m<i;m+=r)h=t[m],p=t[m+1],h<a&&(a=h),p<c&&(c=p),h>u&&(u=h),p>d&&(d=p);f=Math.max(u-a,d-c),f=f!==0?32767/f:0}return ga(s,o,r,a,c,f,0),o}function u_(t,e,r,n,i){var s,o;if(i===$h(t,e,r,n)>0)for(s=e;s<r;s+=n)o=Xg(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=Xg(s,t[s],t[s+1],o);return o&&ru(o,o.next)&&(ya(o),o=o.next),o}function Ni(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(ru(r,r.next)||Xe(r.prev,r,r.next)===0)){if(ya(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function ga(t,e,r,n,i,s,o){if(t){!o&&s&&GT(t,n,i,s);for(var a=t,c,u;t.prev!==t.next;){if(c=t.prev,u=t.next,s?BT(t,n,i,s):MT(t)){e.push(c.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),ya(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=NT(Ni(t),e,r),ga(t,e,r,n,i,s,2)):o===2&&FT(t,e,r,n,i,s):ga(Ni(t),e,r,n,i,s,1);break}}}}function MT(t){var e=t.prev,r=t,n=t.next;if(Xe(e,r,n)>=0)return!1;for(var i=e.x,s=r.x,o=n.x,a=e.y,c=r.y,u=n.y,d=i<s?i<o?i:o:s<o?s:o,h=a<c?a<u?a:u:c<u?c:u,p=i>s?i>o?i:o:s>o?s:o,f=a>c?a>u?a:u:c>u?c:u,m=n.next;m!==e;){if(m.x>=d&&m.x<=p&&m.y>=h&&m.y<=f&&Ts(i,a,s,c,o,u,m.x,m.y)&&Xe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function BT(t,e,r,n){var i=t.prev,s=t,o=t.next;if(Xe(i,s,o)>=0)return!1;for(var a=i.x,c=s.x,u=o.x,d=i.y,h=s.y,p=o.y,f=a<c?a<u?a:u:c<u?c:u,m=d<h?d<p?d:p:h<p?h:p,_=a>c?a>u?a:u:c>u?c:u,v=d>h?d>p?d:p:h>p?h:p,x=Gh(f,m,e,r,n),y=Gh(_,v,e,r,n),g=t.prevZ,w=t.nextZ;g&&g.z>=x&&w&&w.z<=y;){if(g.x>=f&&g.x<=_&&g.y>=m&&g.y<=v&&g!==i&&g!==o&&Ts(a,d,c,h,u,p,g.x,g.y)&&Xe(g.prev,g,g.next)>=0||(g=g.prevZ,w.x>=f&&w.x<=_&&w.y>=m&&w.y<=v&&w!==i&&w!==o&&Ts(a,d,c,h,u,p,w.x,w.y)&&Xe(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;g&&g.z>=x;){if(g.x>=f&&g.x<=_&&g.y>=m&&g.y<=v&&g!==i&&g!==o&&Ts(a,d,c,h,u,p,g.x,g.y)&&Xe(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;w&&w.z<=y;){if(w.x>=f&&w.x<=_&&w.y>=m&&w.y<=v&&w!==i&&w!==o&&Ts(a,d,c,h,u,p,w.x,w.y)&&Xe(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function NT(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!ru(i,s)&&d_(i,n,n.next,s)&&xa(i,s)&&xa(s,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(s.i/r|0),ya(n),ya(n.next),n=t=s),n=n.next}while(n!==t);return Ni(n)}function FT(t,e,r,n,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&VT(o,a)){var c=h_(o,a);o=Ni(o,o.next),c=Ni(c,c.next),ga(o,e,r,n,i,s,0),ga(c,e,r,n,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function LT(t,e,r,n){var i=[],s,o,a,c,u;for(s=0,o=e.length;s<o;s++)a=e[s]*n,c=s<o-1?e[s+1]*n:t.length,u=u_(t,a,c,n,!1),u===u.next&&(u.steiner=!0),i.push($T(u));for(i.sort(DT),s=0;s<i.length;s++)r=OT(i[s],r);return r}function DT(t,e){return t.x-e.x}function OT(t,e){var r=UT(t,e);if(!r)return e;var n=h_(r,t);return Ni(n,n.next),Ni(r,r.next)}function UT(t,e){var r=e,n=t.x,i=t.y,s=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s&&(s=a,o=r.x<r.next.x?r:r.next,a===n))return o}r=r.next}while(r!==e);if(!o)return null;var c=o,u=o.x,d=o.y,h=1/0,p;r=o;do n>=r.x&&r.x>=u&&n!==r.x&&Ts(i<d?n:s,i,u,d,i<d?s:n,i,r.x,r.y)&&(p=Math.abs(i-r.y)/(n-r.x),xa(r,t)&&(p<h||p===h&&(r.x>o.x||r.x===o.x&&zT(o,r)))&&(o=r,h=p)),r=r.next;while(r!==c);return o}function zT(t,e){return Xe(t.prev,t,e.prev)<0&&Xe(e.next,t,t.next)<0}function GT(t,e,r,n){var i=t;do i.z===0&&(i.z=Gh(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,HT(i)}function HT(t){var e,r,n,i,s,o,a,c,u=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,n=r,a=0,e=0;e<u&&(a++,n=n.nextZ,!!n);e++);for(c=u;a>0||c>0&&n;)a!==0&&(c===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,c--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n}s.nextZ=null,u*=2}while(o>1);return t}function Gh(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function $T(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Ts(t,e,r,n,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(r-o)*(e-a)&&(r-o)*(s-a)>=(i-o)*(n-a)}function VT(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!WT(t,e)&&(xa(t,e)&&xa(e,t)&&XT(t,e)&&(Xe(t.prev,t,e.prev)||Xe(t,e.prev,e))||ru(t,e)&&Xe(t.prev,t,t.next)>0&&Xe(e.prev,e,e.next)>0)}function Xe(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function ru(t,e){return t.x===e.x&&t.y===e.y}function d_(t,e,r,n){var i=Za(Xe(t,e,r)),s=Za(Xe(t,e,n)),o=Za(Xe(r,n,t)),a=Za(Xe(r,n,e));return!!(i!==s&&o!==a||i===0&&Qa(t,r,e)||s===0&&Qa(t,n,e)||o===0&&Qa(r,t,n)||a===0&&Qa(r,e,n))}function Qa(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Za(t){return t>0?1:t<0?-1:0}function WT(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&d_(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function xa(t,e){return Xe(t.prev,t,t.next)<0?Xe(t,e,t.next)>=0&&Xe(t,t.prev,e)>=0:Xe(t,e,t.prev)<0||Xe(t,t.next,e)<0}function XT(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function h_(t,e){var r=new Hh(t.i,t.x,t.y),n=new Hh(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function Xg(t,e,r,n){var i=new Hh(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ya(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Hh(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}tu.deviation=function(t,e,r,n){var i=e&&e.length,s=i?e[0]*r:t.length,o=Math.abs($h(t,0,s,r));if(i)for(var a=0,c=e.length;a<c;a++){var u=e[a]*r,d=a<c-1?e[a+1]*r:t.length;o-=Math.abs($h(t,u,d,r))}var h=0;for(a=0;a<n.length;a+=3){var p=n[a]*r,f=n[a+1]*r,m=n[a+2]*r;h+=Math.abs((t[p]-t[m])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[m+1]-t[p+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function $h(t,e,r,n){for(var i=0,s=e,o=r-n;s<r;s+=n)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}tu.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[i][s][o]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var YT=Lf.exports;const KT=Lp(YT);var xc={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */xc.exports;(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof No=="object"&&No;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a=2147483647,c=36,u=1,d=26,h=38,p=700,f=72,m=128,_="-",v=/^xn--/,x=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=c-u,b=Math.floor,P=String.fromCharCode,C;function E(A){throw new RangeError(g[A])}function M(A,T){for(var H=A.length,X=[];H--;)X[H]=T(A[H]);return X}function B(A,T){var H=A.split("@"),X="";H.length>1&&(X=H[0]+"@",A=H[1]),A=A.replace(y,".");var K=A.split("."),Te=M(K,T).join(".");return X+Te}function N(A){for(var T=[],H=0,X=A.length,K,Te;H<X;)K=A.charCodeAt(H++),K>=55296&&K<=56319&&H<X?(Te=A.charCodeAt(H++),(Te&64512)==56320?T.push(((K&1023)<<10)+(Te&1023)+65536):(T.push(K),H--)):T.push(K);return T}function D(A){return M(A,function(T){var H="";return T>65535&&(T-=65536,H+=P(T>>>10&1023|55296),T=56320|T&1023),H+=P(T),H}).join("")}function k(A){return A-48<10?A-22:A-65<26?A-65:A-97<26?A-97:c}function L(A,T){return A+22+75*(A<26)-((T!=0)<<5)}function U(A,T,H){var X=0;for(A=H?b(A/p):A>>1,A+=b(A/T);A>w*d>>1;X+=c)A=b(A/w);return b(X+(w+1)*A/(A+h))}function R(A){var T=[],H=A.length,X,K=0,Te=m,z=f,Y,pe,de,q,oe,ye,Ee,we,$e;for(Y=A.lastIndexOf(_),Y<0&&(Y=0),pe=0;pe<Y;++pe)A.charCodeAt(pe)>=128&&E("not-basic"),T.push(A.charCodeAt(pe));for(de=Y>0?Y+1:0;de<H;){for(q=K,oe=1,ye=c;de>=H&&E("invalid-input"),Ee=k(A.charCodeAt(de++)),(Ee>=c||Ee>b((a-K)/oe))&&E("overflow"),K+=Ee*oe,we=ye<=z?u:ye>=z+d?d:ye-z,!(Ee<we);ye+=c)$e=c-we,oe>b(a/$e)&&E("overflow"),oe*=$e;X=T.length+1,z=U(K-q,X,q==0),b(K/X)>a-Te&&E("overflow"),Te+=b(K/X),K%=X,T.splice(K++,0,Te)}return D(T)}function F(A){var T,H,X,K,Te,z,Y,pe,de,q,oe,ye=[],Ee,we,$e,et;for(A=N(A),Ee=A.length,T=m,H=0,Te=f,z=0;z<Ee;++z)oe=A[z],oe<128&&ye.push(P(oe));for(X=K=ye.length,K&&ye.push(_);X<Ee;){for(Y=a,z=0;z<Ee;++z)oe=A[z],oe>=T&&oe<Y&&(Y=oe);for(we=X+1,Y-T>b((a-H)/we)&&E("overflow"),H+=(Y-T)*we,T=Y,z=0;z<Ee;++z)if(oe=A[z],oe<T&&++H>a&&E("overflow"),oe==T){for(pe=H,de=c;q=de<=Te?u:de>=Te+d?d:de-Te,!(pe<q);de+=c)et=pe-q,$e=c-q,ye.push(P(L(q+et%$e,0))),pe=b(et/$e);ye.push(P(L(pe,0))),Te=U(H,we,X==K),H=0,++X}++H,++T}return ye.join("")}function I(A){return B(A,function(T){return v.test(T)?R(T.slice(4).toLowerCase()):T})}function j(A){return B(A,function(T){return x.test(T)?"xn--"+F(T):T})}if(o={version:"1.4.1",ucs2:{decode:N,encode:D},decode:R,encode:F,toASCII:j,toUnicode:I},n&&i)if(t.exports==n)i.exports=o;else for(C in o)o.hasOwnProperty(C)&&(n[C]=o[C]);else r.punycode=o})(No)})(xc,xc.exports);var qT=xc.exports,to=TypeError;const JT={},QT=Object.freeze(Object.defineProperty({__proto__:null,default:JT},Symbol.toStringTag,{value:"Module"})),ZT=uw(QT);var Df=typeof Map=="function"&&Map.prototype,Yu=Object.getOwnPropertyDescriptor&&Df?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,yc=Df&&Yu&&typeof Yu.get=="function"?Yu.get:null,Yg=Df&&Map.prototype.forEach,Of=typeof Set=="function"&&Set.prototype,Ku=Object.getOwnPropertyDescriptor&&Of?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,vc=Of&&Ku&&typeof Ku.get=="function"?Ku.get:null,Kg=Of&&Set.prototype.forEach,eA=typeof WeakMap=="function"&&WeakMap.prototype,Vo=eA?WeakMap.prototype.has:null,tA=typeof WeakSet=="function"&&WeakSet.prototype,Wo=tA?WeakSet.prototype.has:null,rA=typeof WeakRef=="function"&&WeakRef.prototype,qg=rA?WeakRef.prototype.deref:null,nA=Boolean.prototype.valueOf,iA=Object.prototype.toString,sA=Function.prototype.toString,oA=String.prototype.match,Uf=String.prototype.slice,On=String.prototype.replace,aA=String.prototype.toUpperCase,Jg=String.prototype.toLowerCase,p_=RegExp.prototype.test,Qg=Array.prototype.concat,Ur=Array.prototype.join,lA=Array.prototype.slice,Zg=Math.floor,Vh=typeof BigInt=="function"?BigInt.prototype.valueOf:null,qu=Object.getOwnPropertySymbols,Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Xo=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ys||!0)?Symbol.toStringTag:null,f_=Object.prototype.propertyIsEnumerable,ex=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function tx(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||p_.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-Zg(-t):Zg(t);if(n!==t){var i=String(n),s=Uf.call(e,i.length+1);return On.call(i,r,"$&_")+"."+On.call(On.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return On.call(e,r,"$&_")}var Xh=ZT,rx=Xh.custom,nx=x_(rx)?rx:null,m_={__proto__:null,double:'"',single:"'"},cA={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},nu=function t(e,r,n,i){var s=r||{};if(tn(s,"quoteStyle")&&!tn(m_,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(tn(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=tn(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(tn(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(tn(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return v_(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return a?tx(e,c):c}if(typeof e=="bigint"){var u=String(e)+"n";return a?tx(e,u):u}var d=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=d&&d>0&&typeof e=="object")return Yh(e)?"[Array]":"[Object]";var h=CA(s,n);if(typeof i>"u")i=[];else if(y_(i,e)>=0)return"[Circular]";function p(k,L,U){if(L&&(i=lA.call(i),i.push(L)),U){var R={depth:s.depth};return tn(s,"quoteStyle")&&(R.quoteStyle=s.quoteStyle),t(k,R,n+1,i)}return t(k,s,n+1,i)}if(typeof e=="function"&&!ix(e)){var f=yA(e),m=el(e,p);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(m.length>0?" { "+Ur.call(m,", ")+" }":"")}if(x_(e)){var _=Ys?On.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Wh.call(e);return typeof e=="object"&&!Ys?yo(_):_}if(EA(e)){for(var v="<"+Jg.call(String(e.nodeName)),x=e.attributes||[],y=0;y<x.length;y++)v+=" "+x[y].name+"="+g_(uA(x[y].value),"double",s);return v+=">",e.childNodes&&e.childNodes.length&&(v+="..."),v+="</"+Jg.call(String(e.nodeName))+">",v}if(Yh(e)){if(e.length===0)return"[]";var g=el(e,p);return h&&!AA(g)?"["+Kh(g,h)+"]":"[ "+Ur.call(g,", ")+" ]"}if(hA(e)){var w=el(e,p);return!("cause"in Error.prototype)&&"cause"in e&&!f_.call(e,"cause")?"{ ["+String(e)+"] "+Ur.call(Qg.call("[cause]: "+p(e.cause),w),", ")+" }":w.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Ur.call(w,", ")+" }"}if(typeof e=="object"&&o){if(nx&&typeof e[nx]=="function"&&Xh)return Xh(e,{depth:d-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(vA(e)){var b=[];return Yg&&Yg.call(e,function(k,L){b.push(p(L,e,!0)+" => "+p(k,e))}),sx("Map",yc.call(e),b,h)}if(SA(e)){var P=[];return Kg&&Kg.call(e,function(k){P.push(p(k,e))}),sx("Set",vc.call(e),P,h)}if(_A(e))return Ju("WeakMap");if(bA(e))return Ju("WeakSet");if(wA(e))return Ju("WeakRef");if(fA(e))return yo(p(Number(e)));if(gA(e))return yo(p(Vh.call(e)));if(mA(e))return yo(nA.call(e));if(pA(e))return yo(p(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof No<"u"&&e===No)return"{ [object globalThis] }";if(!dA(e)&&!ix(e)){var C=el(e,p),E=ex?ex(e)===Object.prototype:e instanceof Object||e.constructor===Object,M=e instanceof Object?"":"null prototype",B=!E&&Xo&&Object(e)===e&&Xo in e?Uf.call(oi(e),8,-1):M?"Object":"",N=E||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",D=N+(B||M?"["+Ur.call(Qg.call([],B||[],M||[]),": ")+"] ":"");return C.length===0?D+"{}":h?D+"{"+Kh(C,h)+"}":D+"{ "+Ur.call(C,", ")+" }"}return String(e)};function g_(t,e,r){var n=r.quoteStyle||e,i=m_[n];return i+t+i}function uA(t){return On.call(String(t),/"/g,"&quot;")}function Vi(t){return!Xo||!(typeof t=="object"&&(Xo in t||typeof t[Xo]<"u"))}function Yh(t){return oi(t)==="[object Array]"&&Vi(t)}function dA(t){return oi(t)==="[object Date]"&&Vi(t)}function ix(t){return oi(t)==="[object RegExp]"&&Vi(t)}function hA(t){return oi(t)==="[object Error]"&&Vi(t)}function pA(t){return oi(t)==="[object String]"&&Vi(t)}function fA(t){return oi(t)==="[object Number]"&&Vi(t)}function mA(t){return oi(t)==="[object Boolean]"&&Vi(t)}function x_(t){if(Ys)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Wh)return!1;try{return Wh.call(t),!0}catch{}return!1}function gA(t){if(!t||typeof t!="object"||!Vh)return!1;try{return Vh.call(t),!0}catch{}return!1}var xA=Object.prototype.hasOwnProperty||function(t){return t in this};function tn(t,e){return xA.call(t,e)}function oi(t){return iA.call(t)}function yA(t){if(t.name)return t.name;var e=oA.call(sA.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function y_(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function vA(t){if(!yc||!t||typeof t!="object")return!1;try{yc.call(t);try{vc.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function _A(t){if(!Vo||!t||typeof t!="object")return!1;try{Vo.call(t,Vo);try{Wo.call(t,Wo)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function wA(t){if(!qg||!t||typeof t!="object")return!1;try{return qg.call(t),!0}catch{}return!1}function SA(t){if(!vc||!t||typeof t!="object")return!1;try{vc.call(t);try{yc.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function bA(t){if(!Wo||!t||typeof t!="object")return!1;try{Wo.call(t,Wo);try{Vo.call(t,Vo)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function EA(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function v_(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return v_(Uf.call(t,0,e.maxStringLength),e)+n}var i=cA[e.quoteStyle||"single"];i.lastIndex=0;var s=On.call(On.call(t,i,"\\$1"),/[\x00-\x1f]/g,TA);return g_(s,"single",e)}function TA(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+aA.call(e.toString(16))}function yo(t){return"Object("+t+")"}function Ju(t){return t+" { ? }"}function sx(t,e,r,n){var i=n?Kh(r,n):Ur.call(r,", ");return t+" ("+e+") {"+i+"}"}function AA(t){for(var e=0;e<t.length;e++)if(y_(t[e],`
`)>=0)return!1;return!0}function CA(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=Ur.call(Array(t.indent+1)," ");else return null;return{base:r,prev:Ur.call(Array(e+1),r)}}function Kh(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+Ur.call(t,","+r)+`
`+e.prev}function el(t,e){var r=Yh(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=tn(t,i)?e(t[i],t):""}var s=typeof qu=="function"?qu(t):[],o;if(Ys){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var c in t)tn(t,c)&&(r&&String(Number(c))===c&&c<t.length||Ys&&o["$"+c]instanceof Symbol||(p_.call(/[^\w$]/,c)?n.push(e(c,t)+": "+e(t[c],t)):n.push(c+": "+e(t[c],t))));if(typeof qu=="function")for(var u=0;u<s.length;u++)f_.call(t,s[u])&&n.push("["+e(s[u])+"]: "+e(t[s[u]],t));return n}var kA=nu,PA=to,iu=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},RA=function(t,e){if(t){var r=iu(t,e);return r&&r.value}},IA=function(t,e,r){var n=iu(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},jA=function(t,e){return t?!!iu(t,e):!1},MA=function(t,e){if(t)return iu(t,e,!0)},BA=function(){var e,r={assert:function(n){if(!r.has(n))throw new PA("Side channel does not contain "+kA(n))},delete:function(n){var i=e&&e.next,s=MA(e,n);return s&&i&&i===s&&(e=void 0),!!s},get:function(n){return RA(e,n)},has:function(n){return jA(e,n)},set:function(n,i){e||(e={next:void 0}),IA(e,n,i)}};return r},__=Object,NA=Error,FA=EvalError,LA=RangeError,DA=ReferenceError,OA=SyntaxError,UA=URIError,zA=Math.abs,GA=Math.floor,HA=Math.max,$A=Math.min,VA=Math.pow,WA=Math.round,XA=Number.isNaN||function(e){return e!==e},YA=XA,KA=function(e){return YA(e)||e===0?e:e<0?-1:1},qA=Object.getOwnPropertyDescriptor,Bl=qA;if(Bl)try{Bl([],"length")}catch{Bl=null}var w_=Bl,Nl=Object.defineProperty||!1;if(Nl)try{Nl({},"a",{value:1})}catch{Nl=!1}var JA=Nl,Qu,ox;function QA(){return ox||(ox=1,Qu=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),Qu}var Zu,ax;function ZA(){if(ax)return Zu;ax=1;var t=typeof Symbol<"u"&&Symbol,e=QA();return Zu=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Zu}var ed,lx;function S_(){return lx||(lx=1,ed=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),ed}var td,cx;function b_(){if(cx)return td;cx=1;var t=__;return td=t.getPrototypeOf||null,td}var rd,ux;function eC(){if(ux)return rd;ux=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,n="[object Function]",i=function(c,u){for(var d=[],h=0;h<c.length;h+=1)d[h]=c[h];for(var p=0;p<u.length;p+=1)d[p+c.length]=u[p];return d},s=function(c,u){for(var d=[],h=u,p=0;h<c.length;h+=1,p+=1)d[p]=c[h];return d},o=function(a,c){for(var u="",d=0;d<a.length;d+=1)u+=a[d],d+1<a.length&&(u+=c);return u};return rd=function(c){var u=this;if(typeof u!="function"||e.apply(u)!==n)throw new TypeError(t+u);for(var d=s(arguments,1),h,p=function(){if(this instanceof h){var x=u.apply(this,i(d,arguments));return Object(x)===x?x:this}return u.apply(c,i(d,arguments))},f=r(0,u.length-d.length),m=[],_=0;_<f;_++)m[_]="$"+_;if(h=Function("binder","return function ("+o(m,",")+"){ return binder.apply(this,arguments); }")(p),u.prototype){var v=function(){};v.prototype=u.prototype,h.prototype=new v,v.prototype=null}return h},rd}var nd,dx;function su(){if(dx)return nd;dx=1;var t=eC();return nd=Function.prototype.bind||t,nd}var id,hx;function zf(){return hx||(hx=1,id=Function.prototype.call),id}var sd,px;function E_(){return px||(px=1,sd=Function.prototype.apply),sd}var tC=typeof Reflect<"u"&&Reflect&&Reflect.apply,rC=su(),nC=E_(),iC=zf(),sC=tC,oC=sC||rC.call(iC,nC),aC=su(),lC=to,cC=zf(),uC=oC,T_=function(e){if(e.length<1||typeof e[0]!="function")throw new lC("a function is required");return uC(aC,cC,e)},od,fx;function dC(){if(fx)return od;fx=1;var t=T_,e=w_,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return od=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,od}var ad,mx;function hC(){if(mx)return ad;mx=1;var t=S_(),e=b_(),r=dC();return ad=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,ad}var ld,gx;function pC(){if(gx)return ld;gx=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=su();return ld=r.call(t,e),ld}var Ce,fC=__,mC=NA,gC=FA,xC=LA,yC=DA,Ks=OA,Bs=to,vC=UA,_C=zA,wC=GA,SC=HA,bC=$A,EC=VA,TC=WA,AC=KA,A_=Function,cd=function(t){try{return A_('"use strict"; return ('+t+").constructor;")()}catch{}},va=w_,CC=JA,ud=function(){throw new Bs},kC=va?function(){try{return arguments.callee,ud}catch{try{return va(arguments,"callee").get}catch{return ud}}}():ud,Zi=ZA()(),dt=hC(),PC=b_(),RC=S_(),C_=E_(),ka=zf(),os={},IC=typeof Uint8Array>"u"||!dt?Ce:dt(Uint8Array),Ci={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Ce:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Ce:ArrayBuffer,"%ArrayIteratorPrototype%":Zi&&dt?dt([][Symbol.iterator]()):Ce,"%AsyncFromSyncIteratorPrototype%":Ce,"%AsyncFunction%":os,"%AsyncGenerator%":os,"%AsyncGeneratorFunction%":os,"%AsyncIteratorPrototype%":os,"%Atomics%":typeof Atomics>"u"?Ce:Atomics,"%BigInt%":typeof BigInt>"u"?Ce:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Ce:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Ce:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Ce:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":mC,"%eval%":eval,"%EvalError%":gC,"%Float16Array%":typeof Float16Array>"u"?Ce:Float16Array,"%Float32Array%":typeof Float32Array>"u"?Ce:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Ce:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Ce:FinalizationRegistry,"%Function%":A_,"%GeneratorFunction%":os,"%Int8Array%":typeof Int8Array>"u"?Ce:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Ce:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Ce:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Zi&&dt?dt(dt([][Symbol.iterator]())):Ce,"%JSON%":typeof JSON=="object"?JSON:Ce,"%Map%":typeof Map>"u"?Ce:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Zi||!dt?Ce:dt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":fC,"%Object.getOwnPropertyDescriptor%":va,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Ce:Promise,"%Proxy%":typeof Proxy>"u"?Ce:Proxy,"%RangeError%":xC,"%ReferenceError%":yC,"%Reflect%":typeof Reflect>"u"?Ce:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Ce:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Zi||!dt?Ce:dt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Ce:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Zi&&dt?dt(""[Symbol.iterator]()):Ce,"%Symbol%":Zi?Symbol:Ce,"%SyntaxError%":Ks,"%ThrowTypeError%":kC,"%TypedArray%":IC,"%TypeError%":Bs,"%Uint8Array%":typeof Uint8Array>"u"?Ce:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Ce:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Ce:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Ce:Uint32Array,"%URIError%":vC,"%WeakMap%":typeof WeakMap>"u"?Ce:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Ce:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Ce:WeakSet,"%Function.prototype.call%":ka,"%Function.prototype.apply%":C_,"%Object.defineProperty%":CC,"%Object.getPrototypeOf%":PC,"%Math.abs%":_C,"%Math.floor%":wC,"%Math.max%":SC,"%Math.min%":bC,"%Math.pow%":EC,"%Math.round%":TC,"%Math.sign%":AC,"%Reflect.getPrototypeOf%":RC};if(dt)try{null.error}catch(t){var jC=dt(dt(t));Ci["%Error.prototype%"]=jC}var MC=function t(e){var r;if(e==="%AsyncFunction%")r=cd("async function () {}");else if(e==="%GeneratorFunction%")r=cd("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=cd("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&dt&&(r=dt(i.prototype))}return Ci[e]=r,r},xx={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Pa=su(),_c=pC(),BC=Pa.call(ka,Array.prototype.concat),NC=Pa.call(C_,Array.prototype.splice),yx=Pa.call(ka,String.prototype.replace),wc=Pa.call(ka,String.prototype.slice),FC=Pa.call(ka,RegExp.prototype.exec),LC=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,DC=/\\(\\)?/g,OC=function(e){var r=wc(e,0,1),n=wc(e,-1);if(r==="%"&&n!=="%")throw new Ks("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Ks("invalid intrinsic syntax, expected opening `%`");var i=[];return yx(e,LC,function(s,o,a,c){i[i.length]=a?yx(c,DC,"$1"):o||s}),i},UC=function(e,r){var n=e,i;if(_c(xx,n)&&(i=xx[n],n="%"+i[0]+"%"),_c(Ci,n)){var s=Ci[n];if(s===os&&(s=MC(n)),typeof s>"u"&&!r)throw new Bs("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Ks("intrinsic "+e+" does not exist!")},Gf=function(e,r){if(typeof e!="string"||e.length===0)throw new Bs("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Bs('"allowMissing" argument must be a boolean');if(FC(/^%?[^%]*%?$/,e)===null)throw new Ks("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=OC(e),i=n.length>0?n[0]:"",s=UC("%"+i+"%",r),o=s.name,a=s.value,c=!1,u=s.alias;u&&(i=u[0],NC(n,BC([0,1],u)));for(var d=1,h=!0;d<n.length;d+=1){var p=n[d],f=wc(p,0,1),m=wc(p,-1);if((f==='"'||f==="'"||f==="`"||m==='"'||m==="'"||m==="`")&&f!==m)throw new Ks("property names with quotes must have matching quotes");if((p==="constructor"||!h)&&(c=!0),i+="."+p,o="%"+i+"%",_c(Ci,o))a=Ci[o];else if(a!=null){if(!(p in a)){if(!r)throw new Bs("base intrinsic for "+e+" exists, but the property is not available.");return}if(va&&d+1>=n.length){var _=va(a,p);h=!!_,h&&"get"in _&&!("originalValue"in _.get)?a=_.get:a=a[p]}else h=_c(a,p),a=a[p];h&&!c&&(Ci[o]=a)}}return a},k_=Gf,P_=T_,zC=P_([k_("%String.prototype.indexOf%")]),R_=function(e,r){var n=k_(e,!!r);return typeof n=="function"&&zC(e,".prototype.")>-1?P_([n]):n},GC=Gf,Ra=R_,HC=nu,$C=to,vx=GC("%Map%",!0),VC=Ra("Map.prototype.get",!0),WC=Ra("Map.prototype.set",!0),XC=Ra("Map.prototype.has",!0),YC=Ra("Map.prototype.delete",!0),KC=Ra("Map.prototype.size",!0),I_=!!vx&&function(){var e,r={assert:function(n){if(!r.has(n))throw new $C("Side channel does not contain "+HC(n))},delete:function(n){if(e){var i=YC(e,n);return KC(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return VC(e,n)},has:function(n){return e?XC(e,n):!1},set:function(n,i){e||(e=new vx),WC(e,n,i)}};return r},qC=Gf,ou=R_,JC=nu,tl=I_,QC=to,es=qC("%WeakMap%",!0),ZC=ou("WeakMap.prototype.get",!0),e2=ou("WeakMap.prototype.set",!0),t2=ou("WeakMap.prototype.has",!0),r2=ou("WeakMap.prototype.delete",!0),n2=es?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new QC("Side channel does not contain "+JC(i))},delete:function(i){if(es&&i&&(typeof i=="object"||typeof i=="function")){if(e)return r2(e,i)}else if(tl&&r)return r.delete(i);return!1},get:function(i){return es&&i&&(typeof i=="object"||typeof i=="function")&&e?ZC(e,i):r&&r.get(i)},has:function(i){return es&&i&&(typeof i=="object"||typeof i=="function")&&e?t2(e,i):!!r&&r.has(i)},set:function(i,s){es&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new es),e2(e,i,s)):tl&&(r||(r=tl()),r.set(i,s))}};return n}:tl,i2=to,s2=nu,o2=BA,a2=I_,l2=n2,c2=l2||a2||o2,j_=function(){var e,r={assert:function(n){if(!r.has(n))throw new i2("Side channel does not contain "+s2(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=c2()),e.set(n,i)}};return r},u2=String.prototype.replace,d2=/%20/g,dd={RFC1738:"RFC1738",RFC3986:"RFC3986"},Hf={default:dd.RFC3986,formatters:{RFC1738:function(t){return u2.call(t,d2,"+")},RFC3986:function(t){return String(t)}},RFC1738:dd.RFC1738,RFC3986:dd.RFC3986},h2=Hf,p2=j_,hd=Object.prototype.hasOwnProperty,_i=Array.isArray,au=p2(),M_=function(e,r){return au.set(e,r),e},Sc=function(e){return au.has(e)},qh=function(e){return au.get(e)},B_=function(e,r){au.set(e,r)},Ir=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),f2=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(_i(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]<"u"&&i.push(n[s]);r.obj[r.prop]=i}}},$f=function(e,r){for(var n=r&&r.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},m2=function t(e,r,n){if(!r)return e;if(typeof r!="object"&&typeof r!="function"){if(_i(e))e.push(r);else if(e&&typeof e=="object")if(Sc(e)){var i=qh(e)+1;e[i]=r,B_(e,i)}else(n&&(n.plainObjects||n.allowPrototypes)||!hd.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object"){if(Sc(r)){for(var s=Object.keys(r),o=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},a=0;a<s.length;a++){var c=parseInt(s[a],10);o[c+1]=r[s[a]]}return M_(o,qh(r)+1)}return[e].concat(r)}var u=e;return _i(e)&&!_i(r)&&(u=$f(e,n)),_i(e)&&_i(r)?(r.forEach(function(d,h){if(hd.call(e,h)){var p=e[h];p&&typeof p=="object"&&d&&typeof d=="object"?e[h]=t(p,d,n):e.push(d)}else e[h]=d}),e):Object.keys(r).reduce(function(d,h){var p=r[h];return hd.call(d,h)?d[h]=t(d[h],p,n):d[h]=p,d},u)},g2=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},x2=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},pd=1024,y2=function(e,r,n,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var a="",c=0;c<o.length;c+=pd){for(var u=o.length>=pd?o.slice(c,c+pd):o,d=[],h=0;h<u.length;++h){var p=u.charCodeAt(h);if(p===45||p===46||p===95||p===126||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||s===h2.RFC1738&&(p===40||p===41)){d[d.length]=u.charAt(h);continue}if(p<128){d[d.length]=Ir[p];continue}if(p<2048){d[d.length]=Ir[192|p>>6]+Ir[128|p&63];continue}if(p<55296||p>=57344){d[d.length]=Ir[224|p>>12]+Ir[128|p>>6&63]+Ir[128|p&63];continue}h+=1,p=65536+((p&1023)<<10|u.charCodeAt(h)&1023),d[d.length]=Ir[240|p>>18]+Ir[128|p>>12&63]+Ir[128|p>>6&63]+Ir[128|p&63]}a+=d.join("")}return a},v2=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],a=Object.keys(o),c=0;c<a.length;++c){var u=a[c],d=o[u];typeof d=="object"&&d!==null&&n.indexOf(d)===-1&&(r.push({obj:o,prop:u}),n.push(d))}return f2(r),e},_2=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},w2=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},S2=function(e,r,n,i){if(Sc(e)){var s=qh(e)+1;return e[s]=r,B_(e,s),e}var o=[].concat(e,r);return o.length>n?M_($f(o,{plainObjects:i}),o.length-1):o},b2=function(e,r){if(_i(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},N_={arrayToObject:$f,assign:g2,combine:S2,compact:v2,decode:x2,encode:y2,isBuffer:w2,isOverflow:Sc,isRegExp:_2,maybeMap:b2,merge:m2},F_=j_,Fl=N_,Yo=Hf,E2=Object.prototype.hasOwnProperty,L_={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Dr=Array.isArray,T2=Array.prototype.push,D_=function(t,e){T2.apply(t,Dr(e)?e:[e])},A2=Date.prototype.toISOString,_x=Yo.default,at={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Fl.encode,encodeValuesOnly:!1,filter:void 0,format:_x,formatter:Yo.formatters[_x],indices:!1,serializeDate:function(e){return A2.call(e)},skipNulls:!1,strictNullHandling:!1},C2=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},fd={},k2=function t(e,r,n,i,s,o,a,c,u,d,h,p,f,m,_,v,x,y){for(var g=e,w=y,b=0,P=!1;(w=w.get(fd))!==void 0&&!P;){var C=w.get(e);if(b+=1,typeof C<"u"){if(C===b)throw new RangeError("Cyclic object value");P=!0}typeof w.get(fd)>"u"&&(b=0)}if(typeof d=="function"?g=d(r,g):g instanceof Date?g=f(g):n==="comma"&&Dr(g)&&(g=Fl.maybeMap(g,function(A){return A instanceof Date?f(A):A})),g===null){if(o)return u&&!v?u(r,at.encoder,x,"key",m):r;g=""}if(C2(g)||Fl.isBuffer(g)){if(u){var E=v?r:u(r,at.encoder,x,"key",m);return[_(E)+"="+_(u(g,at.encoder,x,"value",m))]}return[_(r)+"="+_(String(g))]}var M=[];if(typeof g>"u")return M;var B;if(n==="comma"&&Dr(g))v&&u&&(g=Fl.maybeMap(g,u)),B=[{value:g.length>0?g.join(",")||null:void 0}];else if(Dr(d))B=d;else{var N=Object.keys(g);B=h?N.sort(h):N}var D=c?String(r).replace(/\./g,"%2E"):String(r),k=i&&Dr(g)&&g.length===1?D+"[]":D;if(s&&Dr(g)&&g.length===0)return k+"[]";for(var L=0;L<B.length;++L){var U=B[L],R=typeof U=="object"&&U&&typeof U.value<"u"?U.value:g[U];if(!(a&&R===null)){var F=p&&c?String(U).replace(/\./g,"%2E"):String(U),I=Dr(g)?typeof n=="function"?n(k,F):k:k+(p?"."+F:"["+F+"]");y.set(e,b);var j=F_();j.set(fd,y),D_(M,t(R,I,n,i,s,o,a,c,n==="comma"&&v&&Dr(g)?null:u,d,h,p,f,m,_,v,x,j))}}return M},P2=function(e){if(!e)return at;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||at.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Yo.default;if(typeof e.format<"u"){if(!E2.call(Yo.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=Yo.formatters[n],s=at.filter;(typeof e.filter=="function"||Dr(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in L_?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=at.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:at.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:at.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:at.allowEmptyArrays,arrayFormat:o,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:at.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?at.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:at.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:at.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:at.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:at.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:at.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:at.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:at.strictNullHandling}},R2=function(t,e){var r=t,n=P2(e),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):Dr(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var a=L_[n.arrayFormat],c=a==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var u=F_(),d=0;d<i.length;++d){var h=i[d],p=r[h];n.skipNulls&&p===null||D_(o,k2(p,h,a,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var f=o.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),f.length>0?m+f:""},ei=N_,Ll=Object.prototype.hasOwnProperty,wx=Array.isArray,Qe={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:ei.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},I2=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},O_=function(t,e,r){if(t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&r>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return t},j2="utf8=%26%2310003%3B",M2="utf8=%E2%9C%93",B2=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,r.throwOnLimitExceeded?s+1:s);if(r.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,c,u=r.charset;if(r.charsetSentinel)for(c=0;c<o.length;++c)o[c].indexOf("utf8=")===0&&(o[c]===M2?u="utf-8":o[c]===j2&&(u="iso-8859-1"),a=c,c=o.length);for(c=0;c<o.length;++c)if(c!==a){var d=o[c],h=d.indexOf("]="),p=h===-1?d.indexOf("="):h+1,f,m;if(p===-1?(f=r.decoder(d,Qe.decoder,u,"key"),m=r.strictNullHandling?null:""):(f=r.decoder(d.slice(0,p),Qe.decoder,u,"key"),f!==null&&(m=ei.maybeMap(O_(d.slice(p+1),r,wx(n[f])?n[f].length:0),function(v){return r.decoder(v,Qe.decoder,u,"value")}))),m&&r.interpretNumericEntities&&u==="iso-8859-1"&&(m=I2(String(m))),d.indexOf("[]=")>-1&&(m=wx(m)?[m]:m),f!==null){var _=Ll.call(n,f);_&&r.duplicates==="combine"?n[f]=ei.combine(n[f],m,r.arrayLimit,r.plainObjects):(!_||r.duplicates==="last")&&(n[f]=m)}}return n},N2=function(t,e,r,n){var i=0;if(t.length>0&&t[t.length-1]==="[]"){var s=t.slice(0,-1).join("");i=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=n?e:O_(e,r,i),a=t.length-1;a>=0;--a){var c,u=t[a];if(u==="[]"&&r.parseArrays)ei.isOverflow(o)?c=o:c=r.allowEmptyArrays&&(o===""||r.strictNullHandling&&o===null)?[]:ei.combine([],o,r.arrayLimit,r.plainObjects);else{c=r.plainObjects?{__proto__:null}:{};var d=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,h=r.decodeDotInKeys?d.replace(/%2E/g,"."):d,p=parseInt(h,10);!r.parseArrays&&h===""?c={0:o}:!isNaN(p)&&u!==h&&String(p)===h&&p>=0&&r.parseArrays&&p<=r.arrayLimit?(c=[],c[p]=o):h!=="__proto__"&&(c[h]=o)}o=c}return o},F2=function(e,r){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e;if(r.depth<=0)return!r.plainObjects&&Ll.call(Object.prototype,n)&&!r.allowPrototypes?void 0:[n];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(n),a=o?n.slice(0,o.index):n,c=[];if(a){if(!r.plainObjects&&Ll.call(Object.prototype,a)&&!r.allowPrototypes)return;c.push(a)}for(var u=0;(o=s.exec(n))!==null&&u<r.depth;){u+=1;var d=o[1].slice(1,-1);if(!r.plainObjects&&Ll.call(Object.prototype,d)&&!r.allowPrototypes)return;c.push(o[1])}if(o){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");c.push("["+n.slice(o.index)+"]")}return c},L2=function(e,r,n,i){if(e){var s=F2(e,n);if(s)return N2(s,r,n,i)}},D2=function(e){if(!e)return Qe;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=typeof e.charset>"u"?Qe.charset:e.charset,n=typeof e.duplicates>"u"?Qe.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Qe.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Qe.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Qe.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Qe.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Qe.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Qe.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Qe.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Qe.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Qe.decoder,delimiter:typeof e.delimiter=="string"||ei.isRegExp(e.delimiter)?e.delimiter:Qe.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Qe.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Qe.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Qe.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Qe.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:Qe.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Qe.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},O2=function(t,e){var r=D2(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?{__proto__:null}:{};for(var n=typeof t=="string"?B2(t,r):t,i=r.plainObjects?{__proto__:null}:{},s=Object.keys(n),o=0;o<s.length;++o){var a=s[o],c=L2(a,n[a],r,typeof t=="string");i=ei.merge(i,c,r)}return r.allowSparse===!0?i:ei.compact(i)},U2=R2,z2=O2,G2=Hf,H2={formats:G2,parse:z2,stringify:U2},$2=qT;function dn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var V2=/^([a-z0-9.+-]+:)/i,W2=/:[0-9]*$/,X2=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Y2=["<",">",'"',"`"," ","\r",`
`,"	"],K2=["{","}","|","\\","^","`"].concat(Y2),Jh=["'"].concat(K2),Sx=["%","/","?",";","#"].concat(Jh),bx=["/","?","#"],q2=255,Ex=/^[+a-z0-9A-Z_-]{0,63}$/,J2=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Q2={javascript:!0,"javascript:":!0},Qh={javascript:!0,"javascript:":!0},Ns={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Zh=H2;function Z2(t,e,r){if(t&&typeof t=="object"&&t instanceof dn)return t;var n=new dn;return n.parse(t,e,r),n}dn.prototype.parse=function(t,e,r){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var a=t;if(a=a.trim(),!r&&t.split("#").length===1){var c=X2.exec(a);if(c)return this.path=a,this.href=a,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=Zh.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=V2.exec(a);if(u){u=u[0];var d=u.toLowerCase();this.protocol=d,a=a.substr(u.length)}if(r||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var h=a.substr(0,2)==="//";h&&!(u&&Qh[u])&&(a=a.substr(2),this.slashes=!0)}if(!Qh[u]&&(h||u&&!Ns[u])){for(var p=-1,f=0;f<bx.length;f++){var m=a.indexOf(bx[f]);m!==-1&&(p===-1||m<p)&&(p=m)}var _,v;p===-1?v=a.lastIndexOf("@"):v=a.lastIndexOf("@",p),v!==-1&&(_=a.slice(0,v),a=a.slice(v+1),this.auth=decodeURIComponent(_)),p=-1;for(var f=0;f<Sx.length;f++){var m=a.indexOf(Sx[f]);m!==-1&&(p===-1||m<p)&&(p=m)}p===-1&&(p=a.length),this.host=a.slice(0,p),a=a.slice(p),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var y=this.hostname.split(/\./),f=0,g=y.length;f<g;f++){var w=y[f];if(w&&!w.match(Ex)){for(var b="",P=0,C=w.length;P<C;P++)w.charCodeAt(P)>127?b+="x":b+=w[P];if(!b.match(Ex)){var E=y.slice(0,f),M=y.slice(f+1),B=w.match(J2);B&&(E.push(B[1]),M.unshift(B[2])),M.length&&(a="/"+M.join(".")+a),this.hostname=E.join(".");break}}}this.hostname.length>q2?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=$2.toASCII(this.hostname));var N=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+N,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Q2[d])for(var f=0,g=Jh.length;f<g;f++){var k=Jh[f];if(a.indexOf(k)!==-1){var L=encodeURIComponent(k);L===k&&(L=escape(k)),a=a.split(k).join(L)}}var U=a.indexOf("#");U!==-1&&(this.hash=a.substr(U),a=a.slice(0,U));var R=a.indexOf("?");if(R!==-1?(this.search=a.substr(R),this.query=a.substr(R+1),e&&(this.query=Zh.parse(this.query)),a=a.slice(0,R)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Ns[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var N=this.pathname||"",F=this.search||"";this.path=N+F}return this.href=this.format(),this};dn.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Zh.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Ns[e])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+r+o+n};dn.prototype.resolve=function(t){return this.resolveObject(Z2(t,!1,!0)).format()};dn.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new dn;e.parse(t,!1,!0),t=e}for(var r=new dn,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var c=o[a];c!=="protocol"&&(r[c]=t[c])}return Ns[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Ns[t.protocol]){for(var u=Object.keys(t),d=0;d<u.length;d++){var h=u[d];r[h]=t[h]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!Qh[t.protocol]){for(var g=(t.pathname||"").split("/");g.length&&!(t.host=g.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),r.pathname=g.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var p=r.pathname||"",f=r.search||"";r.path=p+f}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&r.pathname.charAt(0)==="/",_=t.host||t.pathname&&t.pathname.charAt(0)==="/",v=_||m||r.host&&t.pathname,x=v,y=r.pathname&&r.pathname.split("/")||[],g=t.pathname&&t.pathname.split("/")||[],w=r.protocol&&!Ns[r.protocol];if(w&&(r.hostname="",r.port=null,r.host&&(y[0]===""?y[0]=r.host:y.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(g[0]===""?g[0]=t.host:g.unshift(t.host)),t.host=null),v=v&&(g[0]===""||y[0]==="")),_)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,y=g;else if(g.length)y||(y=[]),y.pop(),y=y.concat(g),r.search=t.search,r.query=t.query;else if(t.search!=null){if(w){r.host=y.shift(),r.hostname=r.host;var b=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;b&&(r.auth=b.shift(),r.hostname=b.shift(),r.host=r.hostname)}return r.search=t.search,r.query=t.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!y.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var P=y.slice(-1)[0],C=(r.host||t.host||y.length>1)&&(P==="."||P==="..")||P==="",E=0,M=y.length;M>=0;M--)P=y[M],P==="."?y.splice(M,1):P===".."?(y.splice(M,1),E++):E&&(y.splice(M,1),E--);if(!v&&!x)for(;E--;E)y.unshift("..");v&&y[0]!==""&&(!y[0]||y[0].charAt(0)!=="/")&&y.unshift(""),C&&y.join("/").substr(-1)!=="/"&&y.push("");var B=y[0]===""||y[0]&&y[0].charAt(0)==="/";if(w){r.hostname=B?"":y.length?y.shift():"",r.host=r.hostname;var b=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;b&&(r.auth=b.shift(),r.hostname=b.shift(),r.host=r.hostname)}return v=v||r.host&&y.length,v&&!B&&y.unshift(""),y.length>0?r.pathname=y.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};dn.prototype.parseHost=function(){var t=this.host,e=W2.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const Tx={};function ke(t,e,r=3){if(Tx[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),Tx[e]=!0}function mr(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function vo(t){return t.split("?")[0].split("#")[0]}function ek(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function tk(t,e,r){return t.replace(new RegExp(ek(e),"g"),r)}function rk(t,e){let r="",n=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const c=r.lastIndexOf("/");if(c!==r.length-1){c===-1?(r="",n=0):(r=r.slice(0,c),n=r.length-1-r.lastIndexOf("/")),i=a,s=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=a,s=0;continue}}}else r.length>0?r+=`/${t.slice(i+1,a)}`:r=t.slice(i+1,a),n=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return r}const mt={toPosix(t){return tk(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){mr(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(mr(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=vo(this.toPosix(e??Z.ADAPTER.getBaseUrl())),i=vo(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?mt.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(mr(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=rk(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return mr(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(mr(n),n.length>0)if(e===void 0)e=n;else{const i=t[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(mr(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){n=a;break}}else i=!1;return n===-1?r?"/":this.isUrl(o)?s+t:s:r&&n===1?"//":s+t.slice(0,n)},rootname(t){mr(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){mr(t),e&&mr(e),t=vo(this.toPosix(t));let r=0,n=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const c=t.charCodeAt(s);if(c===47){if(!i){r=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return r===n?n=a:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){r=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){mr(t),t=vo(this.toPosix(t));let e=-1,r=0,n=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){r=o+1;break}continue}n===-1&&(i=!1,n=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){mr(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=vo(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let i;e.root=this.rootname(t),n||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,a=-1,c=!0,u=t.length-1,d=0;for(;u>=i;--u){if(r=t.charCodeAt(u),r===47){if(!c){o=u+1;break}continue}a===-1&&(c=!1,a=u+1),r===46?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||a===-1||d===0||d===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&n?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&n?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let md;async function nk(){return md??(md=(async()=>{var s;const t=document.createElement("canvas").getContext("webgl");if(!t)return Ot.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return Ot.UNPACK;const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(s=t.getExtension("WEBGL_lose_context"))==null||s.loseContext(),i[0]<=i[3]?Ot.PMA:Ot.UNPACK})()),md}let gd;function ik(){return typeof gd>"u"&&(gd=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:Z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Z.ADAPTER.getWebGLRenderingContext())return!1;const r=Z.ADAPTER.createCanvas();let n=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,i}catch{return!1}}()),gd}var sk={grad:.9,turn:360,rad:360/(2*Math.PI)},Zr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},pt=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},ar=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},U_=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},Ax=function(t){return{r:ar(t.r,0,255),g:ar(t.g,0,255),b:ar(t.b,0,255),a:ar(t.a)}},xd=function(t){return{r:pt(t.r),g:pt(t.g),b:pt(t.b),a:pt(t.a,3)}},ok=/^#([0-9a-f]{3,8})$/i,rl=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},z_=function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=Math.max(e,r,n),o=s-Math.min(e,r,n),a=o?s===e?(r-n)/o:s===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},G_=function(t){var e=t.h,r=t.s,n=t.v,i=t.a;e=e/360*6,r/=100,n/=100;var s=Math.floor(e),o=n*(1-r),a=n*(1-(e-s)*r),c=n*(1-(1-e+s)*r),u=s%6;return{r:255*[n,a,o,o,c,n][u],g:255*[c,n,n,a,o,o][u],b:255*[o,o,c,n,n,a][u],a:i}},Cx=function(t){return{h:U_(t.h),s:ar(t.s,0,100),l:ar(t.l,0,100),a:ar(t.a)}},kx=function(t){return{h:pt(t.h),s:pt(t.s),l:pt(t.l),a:pt(t.a,3)}},Px=function(t){return G_((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},Ko=function(t){return{h:(e=z_(t)).h,s:(i=(200-(r=e.s))*(n=e.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,r,n,i},ak=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lk=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ck=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uk=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ep={string:[[function(t){var e=ok.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?pt(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?pt(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=ck.exec(t)||uk.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:Ax({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=ak.exec(t)||lk.exec(t);if(!e)return null;var r,n,i=Cx({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(sk[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Px(i)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=i===void 0?1:i;return Zr(e)&&Zr(r)&&Zr(n)?Ax({r:Number(e),g:Number(r),b:Number(n),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,i=t.a,s=i===void 0?1:i;if(!Zr(e)||!Zr(r)||!Zr(n))return null;var o=Cx({h:Number(e),s:Number(r),l:Number(n),a:Number(s)});return Px(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,i=t.a,s=i===void 0?1:i;if(!Zr(e)||!Zr(r)||!Zr(n))return null;var o=function(a){return{h:U_(a.h),s:ar(a.s,0,100),v:ar(a.v,0,100),a:ar(a.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(s)});return G_(o)},"hsv"]]},Rx=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},dk=function(t){return typeof t=="string"?Rx(t.trim(),ep.string):typeof t=="object"&&t!==null?Rx(t,ep.object):[null,void 0]},yd=function(t,e){var r=Ko(t);return{h:r.h,s:ar(r.s+100*e,0,100),l:r.l,a:r.a}},vd=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Ix=function(t,e){var r=Ko(t);return{h:r.h,s:r.s,l:ar(r.l+100*e,0,100),a:r.a}},tp=function(){function t(e){this.parsed=dk(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return pt(vd(this.rgba),2)},t.prototype.isDark=function(){return vd(this.rgba)<.5},t.prototype.isLight=function(){return vd(this.rgba)>=.5},t.prototype.toHex=function(){return e=xd(this.rgba),r=e.r,n=e.g,i=e.b,o=(s=e.a)<1?rl(pt(255*s)):"","#"+rl(r)+rl(n)+rl(i)+o;var e,r,n,i,s,o},t.prototype.toRgb=function(){return xd(this.rgba)},t.prototype.toRgbString=function(){return e=xd(this.rgba),r=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+r+", "+n+", "+i+", "+s+")":"rgb("+r+", "+n+", "+i+")";var e,r,n,i,s},t.prototype.toHsl=function(){return kx(Ko(this.rgba))},t.prototype.toHslString=function(){return e=kx(Ko(this.rgba)),r=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+r+", "+n+"%, "+i+"%, "+s+")":"hsl("+r+", "+n+"%, "+i+"%)";var e,r,n,i,s},t.prototype.toHsv=function(){return e=z_(this.rgba),{h:pt(e.h),s:pt(e.s),v:pt(e.v),a:pt(e.a,3)};var e},t.prototype.invert=function(){return jr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),jr(yd(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),jr(yd(this.rgba,-e))},t.prototype.grayscale=function(){return jr(yd(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),jr(Ix(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),jr(Ix(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?jr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):pt(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=Ko(this.rgba);return typeof e=="number"?jr({h:e,s:r.s,l:r.l,a:r.a}):pt(r.h)},t.prototype.isEqual=function(e){return this.toHex()===jr(e).toHex()},t}(),jr=function(t){return t instanceof tp?t:new tp(t)},jx=[],hk=function(t){t.forEach(function(e){jx.indexOf(e)<0&&(e(tp,ep),jx.push(e))})};function pk(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,c,u=n[this.toHex()];if(u)return u;if(o!=null&&o.closest){var d=this.toRgb(),h=1/0,p="black";if(!s.length)for(var f in r)s[f]=new t(r[f]).toRgb();for(var m in r){var _=(a=d,c=s[m],Math.pow(a.r-c.r,2)+Math.pow(a.g-c.g,2)+Math.pow(a.b-c.b,2));_<h&&(h=_,p=m)}return p}},e.string.push([function(o){var a=o.toLowerCase(),c=a==="transparent"?"#0000":r[a];return c?new t(c).toRgb():null},"name"])}hk([pk]);const as=class Dl{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Dl)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,s)=>i===r[s]);if(e!==null&&r!==null){const i=Object.keys(e),s=Object.keys(r);return i.length!==s.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,n,i]=this._components;return{r:e,g:r,b:n,a:i}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,i]=this._components;return e=e??[],e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[r,n,i]=this._components;return e[0]=r,e[1]=n,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,i,s]=Dl.temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return r&&(n=n*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[r,n,i]=this._components;return this._components[0]=Math.round(r*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[r,n,i,s]=this._components;return e[0]=r,e[1]=n,e[2]=i,e[3]=s,e}normalize(e){let r,n,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,i,s=255]=e,r/=255,n/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Dl.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=jr(e);o.isValid()&&({r,g:n,b:i,a:s}=o.rgba,r/=255,n/=255,i/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,r),n)}),e)}};as.shared=new as,as.temp=new as,as.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Ue=as;function fk(t){return ke("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Ue.shared.setValue(t).toHex()}function mk(t){return ke("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Ue.shared.setValue(t).toNumber()}function gk(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[he.NORMAL_NPM]=he.NORMAL,t[he.ADD_NPM]=he.ADD,t[he.SCREEN_NPM]=he.SCREEN,e[he.NORMAL]=he.NORMAL_NPM,e[he.ADD]=he.ADD_NPM,e[he.SCREEN]=he.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}const H_=gk();function $_(t,e){return H_[e?1:0][t]}function xk(t,e=null){const r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let n=0,i=0;n<r;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function V_(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function bc(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function Mx(t){return!(t&t-1)&&!!t}function Bx(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function Fs(t,e,r){const n=t.length;let i;if(e>=n||r===0)return;r=e+r>n?n-e:r;const s=n-r;for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}function Un(t){return t===0?0:t<0?-1:1}let yk=0;function Fi(){return++yk}const rp=class{constructor(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};rp.EMPTY=new rp(0,0,0,0);let Nx=rp;const Fx={},Mr=Object.create(null),Tn=Object.create(null);class vk{constructor(e,r,n){this._canvas=Z.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||Z.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Lx(t,e,r){for(let n=0,i=4*r*e;n<e;++n,i+=4)if(t[i+3]!==0)return!1;return!0}function Dx(t,e,r,n,i){const s=4*e;for(let o=n,a=n*s+4*r;o<=i;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function _k(t){const{width:e,height:r}=t,n=t.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,e,r).data;let s=0,o=0,a=e-1,c=r-1;for(;o<r&&Lx(i,e,o);)++o;if(o===r)return Nx.EMPTY;for(;Lx(i,e,c);)--c;for(;Dx(i,e,s,o,c);)++s;for(;Dx(i,e,a,o,c);)--a;return++a,++c,new Nx(s,o,a,c)}function wk(t){const e=_k(t),{width:r,height:n}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,r,n)}return{width:r,height:n,data:i}}function Sk(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}function gn(t,e=1){var n;const r=(n=Z.RETINA_PREFIX)==null?void 0:n.exec(t);return r?parseFloat(r[1]):e}var J=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(J||{});const np=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Ox=(t,e)=>np(t).priority??e,ne={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(np).forEach(e=>{e.type.forEach(r=>{var n,i;return(i=(n=this._removeHandlers)[r])==null?void 0:i.call(n,e)})}),this},add(...t){return t.map(np).forEach(e=>{e.type.forEach(r=>{var s,o;const n=this._addHandlers,i=this._queue;n[r]?(s=n[r])==null||s.call(n,e):(i[r]=i[r]||[],(o=i[r])==null||o.push(e))})}),this},handle(t,e,r){var o;const n=this._addHandlers,i=this._removeHandlers;if(n[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,i[t]=r;const s=this._queue;return s[t]&&((o=s[t])==null||o.forEach(a=>e(a)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,s)=>Ox(s,r)-Ox(i,r)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}};class ip{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const bk=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Ek(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function Tk(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=bk.replace(/%forloop%/gi,Ek(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}const _d=0,wd=1,Sd=2,bd=3,Ed=4,Td=5;class Kr{constructor(){this.data=0,this.blendMode=he.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<_d)}set blend(e){!!(this.data&1<<_d)!==e&&(this.data^=1<<_d)}get offsets(){return!!(this.data&1<<wd)}set offsets(e){!!(this.data&1<<wd)!==e&&(this.data^=1<<wd)}get culling(){return!!(this.data&1<<Sd)}set culling(e){!!(this.data&1<<Sd)!==e&&(this.data^=1<<Sd)}get depthTest(){return!!(this.data&1<<bd)}set depthTest(e){!!(this.data&1<<bd)!==e&&(this.data^=1<<bd)}get depthMask(){return!!(this.data&1<<Td)}set depthMask(e){!!(this.data&1<<Td)!==e&&(this.data^=1<<Td)}get clockwiseFrontFace(){return!!(this.data&1<<Ed)}set clockwiseFrontFace(e){!!(this.data&1<<Ed)!==e&&(this.data^=1<<Ed)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==he.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Kr;return e.depthTest=!1,e.blend=!0,e}}Kr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const sp=[];function W_(t,e){if(!t)return null;let r="";if(typeof t=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(let n=sp.length-1;n>=0;--n){const i=sp[n];if(i.test&&i.test(t,r))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class Tr{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,n,i,s,o,a,c){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:d}=this;this._aliasCount++;for(let h=0,p=d.length;h<p;h++)d[h][u](e,r,n,i,s,o,a,c);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Tr.prototype,{dispatch:{value:Tr.prototype.emit},run:{value:Tr.prototype.emit}});class _a{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new Tr("setRealSize"),this.onUpdate=new Tr("update"),this.onError=new Tr("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}}class lu extends _a{constructor(e,r){const{width:n,height:i}=r||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=e,this.unpackAlignment=r.unpackAlignment??4}upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Ot.UNPACK);const s=r.realWidth,o=r.realHeight;return n.width===s&&n.height===o?i.texSubImage2D(r.target,0,0,0,s,o,r.format,n.type,this.data):(n.width=s,n.height=o,i.texImage2D(r.target,0,n.internalFormat,s,o,0,r.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const Ak={scaleMode:on.NEAREST,alphaMode:Ot.NPM},op=class ls extends Ca{constructor(e=null,r=null){super(),r=Object.assign({},ls.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:c,wrapMode:u,format:d,type:h,target:p,resolution:f,resourceOptions:m}=r;e&&!(e instanceof _a)&&(e=W_(e,m),e.internal=!0),this.resolution=f||Z.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((c||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=u,this._scaleMode=o,this.format=d,this.type=h,this.target=p,this.alphaMode=n,this.uid=Fi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,r){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,n=!0),n&&this.dirtyStyleId++,this}setSize(e,r,n){return n=n||this.resolution,this.setRealSize(e*n,r*n,n)}setRealSize(e,r,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(r)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Mx(this.realWidth)&&Mx(this.realHeight)}setResolution(e){const r=this.resolution;return r===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*r)/e,this.height=Math.round(this.height*r)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Tn[this.cacheId],delete Mr[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),ls.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,r,n=Z.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Fi()}`}s=e._pixiId}let o=Tn[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new ls(e,r),o.cacheId=s,ls.addToCache(o,s)),o}static fromBuffer(e,r,n,i){e=e||new Float32Array(r*n*4);const s=new lu(e,{width:r,height:n,...i==null?void 0:i.resourceOptions});let o,a;return e instanceof Float32Array?(o=W.RGBA,a=le.FLOAT):e instanceof Int32Array?(o=W.RGBA_INTEGER,a=le.INT):e instanceof Uint32Array?(o=W.RGBA_INTEGER,a=le.UNSIGNED_INT):e instanceof Int16Array?(o=W.RGBA_INTEGER,a=le.SHORT):e instanceof Uint16Array?(o=W.RGBA_INTEGER,a=le.UNSIGNED_SHORT):e instanceof Int8Array?(o=W.RGBA,a=le.BYTE):(o=W.RGBA,a=le.UNSIGNED_BYTE),s.internal=!0,new ls(s,Object.assign({},Ak,{type:a,format:o},i))}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),Tn[r]&&Tn[r]!==e&&console.warn(`BaseTexture added to the cache with an id [${r}] that already had an entry`),Tn[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=Tn[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete Tn[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)delete Tn[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}};op.defaultOptions={mipmap:Xr.POW2,anisotropicLevel:0,scaleMode:on.LINEAR,wrapMode:Jn.CLAMP,alphaMode:Ot.UNPACK,target:Ms.TEXTURE_2D,format:W.RGBA,type:le.UNSIGNED_BYTE},op._globalBatch=0;let ve=op;class ap{constructor(){this.texArray=null,this.blend=0,this.type=Gr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Ck=0;class rt{constructor(e,r=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=r,this.id=Ck++,this.disposeRunner=new Tr("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Vr.ELEMENT_ARRAY_BUFFER:Vr.ARRAY_BUFFER}get index(){return this.type===Vr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new rt(e)}}class Ec{constructor(e,r=0,n=!1,i=le.FLOAT,s,o,a,c=1){this.buffer=e,this.size=r,this.normalized=n,this.type=i,this.stride=s,this.start=o,this.instance=a,this.divisor=c}destroy(){this.buffer=null}static from(e,r,n,i,s){return new Ec(e,r,n,i,s)}}const kk={Float32Array,Uint32Array,Int32Array,Uint8Array};function Pk(t,e){let r=0,n=0;const i={};for(let c=0;c<t.length;c++)n+=e[c],r+=t[c].length;const s=new ArrayBuffer(r*4);let o=null,a=0;for(let c=0;c<t.length;c++){const u=e[c],d=t[c],h=V_(d);i[h]||(i[h]=new kk[h](s)),o=i[h];for(let p=0;p<d.length;p++){const f=(p/u|0)*n+a,m=p%u;o[f+m]=d[p]}a+=u}return new Float32Array(s)}const Ux={5126:4,5123:2,5121:1};let Rk=0;const Ik={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class ti{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=Rk++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Tr("disposeGeometry"),this.refCount=0}addAttribute(e,r,n=0,i=!1,s,o,a,c=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof rt||(r instanceof Array&&(r=new Float32Array(r)),r=new rt(r));const u=e.split("|");if(u.length>1){for(let h=0;h<u.length;h++)this.addAttribute(u[h],r,n,i,s);return this}let d=this.buffers.indexOf(r);return d===-1&&(this.buffers.push(r),d=this.buffers.length-1),this.attributes[e]=new Ec(d,n,i,s,o,a,c),this.instanced=this.instanced||c,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof rt||(e instanceof Array&&(e=new Uint16Array(e)),e=new rt(e)),e.type=Vr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],r=[],n=new rt;let i;for(i in this.attributes){const s=this.attributes[i],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*Ux[s.type]/4),s.buffer=0}for(n.data=Pk(e,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new ti;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new rt(this.buffers[r].data.slice(0));for(const r in this.attributes){const n=this.attributes[r];e.attributes[r]=new Ec(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Vr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const r=new ti,n=[],i=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let c=0;c<o.buffers.length;c++)i[c]=i[c]||0,i[c]+=o.buffers[c].data.length,s[c]=0}for(let a=0;a<o.buffers.length;a++)n[a]=new Ik[V_(o.buffers[a].data)](i[a]),r.buffers[a]=new rt(n[a]);for(let a=0;a<e.length;a++){o=e[a];for(let c=0;c<o.buffers.length;c++)n[c].set(o.buffers[c].data,s[c]),s[c]+=o.buffers[c].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=Vr.ELEMENT_ARRAY_BUFFER;let a=0,c=0,u=0,d=0;for(let h=0;h<o.buffers.length;h++)if(o.buffers[h]!==o.indexBuffer){d=h;break}for(const h in o.attributes){const p=o.attributes[h];(p.buffer|0)===d&&(c+=p.size*Ux[p.type]/4)}for(let h=0;h<e.length;h++){const p=e[h].indexBuffer.data;for(let f=0;f<p.length;f++)r.indexBuffer.data[f+u]+=a;a+=e[h].buffers[d].data.length/c,u+=p.length}}return r}}class X_ extends ti{constructor(e=!1){super(),this._buffer=new rt(null,e,!1),this._indexBuffer=new rt(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,le.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,le.FLOAT).addAttribute("aColor",this._buffer,4,!0,le.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,le.FLOAT).addIndex(this._indexBuffer)}}const Tc=Math.PI*2,jk=180/Math.PI,Mk=Math.PI/180;var vt=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(vt||{});class Ie{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new Ie(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}}Ie.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const nl=[new Ie,new Ie,new Ie,new Ie];class be{constructor(e=0,r=0,n=0,i=0){this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(i),this.type=vt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new be(0,0,0,0)}clone(){return new be(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){const E=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=E)return!1;const M=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>M}const n=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=n||o<=s)return!1;const a=nl[0].set(e.left,e.top),c=nl[1].set(e.left,e.bottom),u=nl[2].set(e.right,e.top),d=nl[3].set(e.right,e.bottom);if(u.x<=a.x||c.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(c,c),r.apply(u,u),r.apply(d,d),Math.max(a.x,c.x,u.x,d.x)<=n||Math.min(a.x,c.x,u.x,d.x)>=i||Math.max(a.y,c.y,u.y,d.y)<=s||Math.min(a.y,c.y,u.y,d.y)>=o))return!1;const p=h*(c.y-a.y),f=h*(a.x-c.x),m=p*n+f*s,_=p*i+f*s,v=p*n+f*o,x=p*i+f*o;if(Math.max(m,_,v,x)<=p*a.x+f*a.y||Math.min(m,_,v,x)>=p*d.x+f*d.y)return!1;const y=h*(a.y-u.y),g=h*(u.x-a.x),w=y*n+g*s,b=y*i+g*s,P=y*n+g*o,C=y*i+g*o;return!(Math.max(w,b,P,C)<=y*a.x+g*a.y||Math.min(w,b,P,C)>=y*d.x+g*d.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,i=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=i,this.height=s-i,this}}be.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class cu{constructor(e=0,r=0,n=0){this.x=e,this.y=r,this.radius=n,this.type=vt.CIRC}clone(){return new cu(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,s=this.y-r;return i*=i,s*=s,i+s<=n}getBounds(){return new be(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}cu.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class uu{constructor(e=0,r=0,n=0,i=0){this.x=e,this.y=r,this.width=n,this.height=i,this.type=vt.ELIP}clone(){return new uu(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,i=(r-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new be(this.x-this.width,this.y-this.height,this.width,this.height)}}uu.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class ki{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let i=0,s=r.length;i<s;i++)n.push(r[i].x,r[i].y);r=n}this.points=r,this.type=vt.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),r=new ki(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let n=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],c=this.points[s*2+1],u=this.points[o*2],d=this.points[o*2+1];c>r!=d>r&&e<(u-a)*((r-c)/(d-c))+a&&(n=!n)}return n}}ki.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class du{constructor(e=0,r=0,n=0,i=0,s=20){this.x=e,this.y=r,this.width=n,this.height=i,this.radius=s,this.type=vt.RREC}clone(){return new du(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),s=r-(this.y+n);const o=n*n;if(i*i+s*s<=o||(i=e-(this.x+this.width-n),i*i+s*s<=o)||(s=r-(this.y+this.height-n),i*i+s*s<=o)||(i=e-(this.x+n),i*i+s*s<=o))return!0}return!1}}du.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Ge{constructor(e=1,r=0,n=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,i,s,o){return this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new Ie;const n=e.x,i=e.y;return r.x=this.a*n+this.c*i+this.tx,r.y=this.b*n+this.d*i+this.ty,r}applyInverse(e,r){r=r||new Ie;const n=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return r.x=this.d*n*i+-this.c*n*s+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*s+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*r-this.b*n,this.b=i*n+this.b*r,this.c=s*r-this.d*n,this.d=s*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,i=this.c,s=this.d;return this.a=e.a*r+e.b*i,this.b=e.a*n+e.b*s,this.c=e.c*r+e.d*i,this.d=e.c*n+e.d*s,this.tx=e.tx*r+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}setTransform(e,r,n,i,s,o,a,c,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-c)*o,this.d=Math.cos(a-c)*o,this.tx=e-(n*this.a+i*this.c),this.ty=r-(n*this.b+i*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),c=Math.atan2(n,r),u=Math.abs(a+c);return u<1e-5||Math.abs(Tc-u)<1e-5?(e.rotation=c,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=c),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*r+o.y*i),e.position.y=this.ty+(o.x*n+o.y*s),e}invert(){const e=this.a,r=this.b,n=this.c,i=this.d,s=this.tx,o=e*i-r*n;return this.a=i/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-i*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Ge;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Ge}static get TEMP_MATRIX(){return new Ge}}Ge.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const fi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],mi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],gi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],xi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],lp=[],Y_=[],il=Math.sign;function Bk(){for(let t=0;t<16;t++){const e=[];lp.push(e);for(let r=0;r<16;r++){const n=il(fi[t]*fi[r]+gi[t]*mi[r]),i=il(mi[t]*fi[r]+xi[t]*mi[r]),s=il(fi[t]*gi[r]+gi[t]*xi[r]),o=il(mi[t]*gi[r]+xi[t]*xi[r]);for(let a=0;a<16;a++)if(fi[a]===n&&mi[a]===i&&gi[a]===s&&xi[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Ge;e.set(fi[t],mi[t],gi[t],xi[t],0,0),Y_.push(e)}}Bk();const Ve={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>fi[t],uY:t=>mi[t],vX:t=>gi[t],vY:t=>xi[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>lp[t][e],sub:(t,e)=>lp[t][Ve.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?Ve.S:Ve.N:Math.abs(e)*2<=Math.abs(t)?t>0?Ve.E:Ve.W:e>0?t>0?Ve.SE:Ve.SW:t>0?Ve.NE:Ve.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const i=Y_[Ve.inv(e)];i.tx=r,i.ty=n,t.append(i)}};class ln{constructor(e,r,n=0,i=0){this._x=n,this._y=i,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new ln(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}ln.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const cp=class{constructor(){this.worldTransform=new Ge,this.localTransform=new Ge,this.position=new ln(this.onChange,this,0,0),this.scale=new ln(this.onChange,this,1,1),this.pivot=new ln(this.onChange,this,0,0),this.skew=new ln(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};cp.IDENTITY=new cp;let Vf=cp;Vf.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var Nk=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Fk=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function zx(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function Ad(t){const e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function K_(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Ad(2*e);case"bvec3":return Ad(3*e);case"bvec4":return Ad(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Ls=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],Lk={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Dk={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Ok(t,e){var n;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const s=e[i];if(!s){((n=t.uniforms[i])==null?void 0:n.group)===!0&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let a=!1;for(let c=0;c<Ls.length;c++)if(Ls[c].test(s,o)){r.push(Ls[c].code(i,o)),a=!0;break}if(!a){const c=(s.size===1&&!s.isArray?Lk:Dk)[s.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${c};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const q_={};let ts=q_;function Uk(){if(ts===q_||ts!=null&&ts.isContextLost()){const t=Z.ADAPTER.createCanvas();let e;Z.PREFER_ENV>=$i.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),ts=e}return ts}let sl;function zk(){if(!sl){sl=or.MEDIUM;const t=Uk();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(sl=e.precision?or.HIGH:or.MEDIUM)}}return sl}function Gx(t,e){const r=t.getShaderSource(e).split(`
`).map((u,d)=>`${d}: ${u}`),n=t.getShaderInfoLog(e),i=n.split(`
`),s={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{r[u-1]=`%c${r[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=r.join(`
`);a[0]=c,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Gk(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||Gx(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||Gx(t,n),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const Hk={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function J_(t){return Hk[t]}let ol=null;const Hx={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Q_(t,e){if(!ol){const r=Object.keys(Hx);ol={};for(let n=0;n<r.length;++n){const i=r[n];ol[t[i]]=Hx[i]}}return ol[e]}function $x(t,e,r){if(t.substring(0,9)!=="precision"){let n=e;return e===or.HIGH&&r!==or.HIGH&&(n=or.MEDIUM),`precision ${n} float;
${t}`}else if(r!==or.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let _o;function $k(){if(typeof _o=="boolean")return _o;try{_o=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{_o=!1}return _o}let Vk=0;const al={},up=class cs{constructor(e,r,n="pixi-shader",i={}){this.extra={},this.id=Vk++,this.vertexSrc=e||cs.defaultVertexSrc,this.fragmentSrc=r||cs.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),al[n]?(al[n]++,n+=`-${al[n]}`):al[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=$x(this.vertexSrc,cs.defaultVertexPrecision,or.HIGH),this.fragmentSrc=$x(this.fragmentSrc,cs.defaultFragmentPrecision,zk())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Fk}static get defaultFragmentSrc(){return Nk}static from(e,r,n){const i=e+r;let s=Fx[i];return s||(Fx[i]=s=new cs(e,r,n)),s}};up.defaultVertexPrecision=or.HIGH,up.defaultFragmentPrecision=an.apple.device?or.HIGH:or.MEDIUM;let cn=up,Wk=0;class Ar{constructor(e,r,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Wk++,this.static=!!r,this.ubo=!!n,e instanceof rt?(this.buffer=e,this.buffer.type=Vr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new rt(new Float32Array(1)),this.buffer.type=Vr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,n){if(!this.ubo)this.uniforms[e]=new Ar(r,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,n){return new Ar(e,r,n)}static uboFrom(e,r){return new Ar(e,r??!0,!0)}}class Wr{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof Ar?this.uniformGroup=r:this.uniformGroup=new Ar(r):this.uniformGroup=new Ar({}),this.disposeRunner=new Tr("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(const n in r.uniforms){const i=r.uniforms[n];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,n){const i=cn.from(e,r);return new Wr(i,n)}}class Xk{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let s=0;s<e;s++)n[s]=s;this.defaultGroupCache[e]=Ar.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new cn(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ge,default:this.defaultGroupCache[e]};return new Wr(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let n=0;n<e;n++)n>0&&(r+=`
else `),n<e-1&&(r+=`if(vTextureId < ${n}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class dp{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function Yk(){return!an.apple.device}function Kk(t){let e=!0;const r=Z.ADAPTER.getNavigator();if(an.tablet||an.phone){if(an.apple.device){const n=r.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(an.android.device){const n=r.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?t:4}class hu{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var qk=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Jk=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Co=class xr extends hu{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=X_,this.vertexSize=6,this.state=Kr.for2d(),this.size=xr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Kk(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Yk(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return ke("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Jk}static get defaultFragmentTemplate(){return qk}setShaderGenerator({vertex:e=xr.defaultVertexSrc,fragment:r=xr.defaultFragmentTemplate}={}){this.shaderGenerator=new Xk(e,r)}contextChange(){const e=this.renderer.gl;Z.PREFER_ENV===$i.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),xr.defaultMaxTextures),this.maxTextures=Tk(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:r}=xr,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;e.length<n;)e.push(new ap);for(;r.length<i;)r.push(new dp);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:r}=this,n=xr._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++ve._globalBatch,c=0,u=n[0],d=0;i.copyBoundTextures(s,r);for(let h=0;h<this._bufferSize;++h){const p=e[h];e[h]=null,p._batchEnabled!==a&&(u.count>=r&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,d,h),d=h,u=n[++c],++a),p._batchEnabled=a,p.touched=o,u.elements[u.count++]=p)}u.count>0&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,d,this._bufferSize),++c,++a);for(let h=0;h<s.length;h++)s[h]=null;ve._globalBatch=a}buildDrawCalls(e,r,n){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,c=xr._drawCallPool;let u=this._dcIndex,d=this._aIndex,h=this._iIndex,p=c[u];p.start=this._iIndex,p.texArray=e;for(let f=r;f<n;++f){const m=i[f],_=m._texture.baseTexture,v=H_[_.alphaMode?1:0][m.blendMode];i[f]=null,r<f&&p.blend!==v&&(p.size=h-p.start,r=f,p=c[++u],p.texArray=e,p.start=h),this.packInterleavedGeometry(m,s,o,d,h),d+=m.vertexData.length/2*a,h+=m.indices.length,p.blend=v}r<n&&(p.size=h-p.start,++u),this._dcIndex=u,this._aIndex=d,this._iIndex=h}bindAndClearTexArray(e){const r=this.renderer.texture;for(let n=0;n<e.count;n++)r.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:r,_indexBuffer:n}=this;xr.canUploadSameBuffer?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:r,state:n}=this.renderer,i=xr._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:c,size:u,start:d,blend:h}=i[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=h,n.set(this.state),r.drawElements(c,u,r.UNSIGNED_SHORT,d*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),xr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const r=bc(Math.ceil(e/8)),n=Bx(r),i=r*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new ip(i*this.vertexSize*4)),s}getIndexBuffer(e){const r=bc(Math.ceil(e/12)),n=Bx(r),i=r*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._iBuffers[n];return s||(this._iBuffers[n]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,r,n,i,s){const{uint32View:o,float32View:a}=r,c=i/this.vertexSize,u=e.uvs,d=e.indices,h=e.vertexData,p=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),m=Ue.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let _=0;_<h.length;_+=2)a[i++]=h[_],a[i++]=h[_+1],a[i++]=u[_],a[i++]=u[_+1],o[i++]=m,a[i++]=p;for(let _=0;_<d.length;_++)n[s++]=c+d[_]}};Co.defaultBatchSize=4096,Co.extension={name:"batch",type:J.RendererPlugin},Co._drawCallPool=[],Co._textureArrayPool=[];let yi=Co;ne.add(yi);var Qk=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Zk=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const hp=class ko extends Wr{constructor(e,r,n){const i=cn.from(e||ko.defaultVertexSrc,r||ko.defaultFragmentSrc);super(i,n),this.padding=0,this.resolution=ko.defaultResolution,this.multisample=ko.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Kr}apply(e,r,n,i,s){e.applyFilter(this,r,n,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return Zk}static get defaultFragmentSrc(){return Qk}};hp.defaultResolution=1,hp.defaultMultisample=it.NONE;let Rt=hp;class Ac{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Ue(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:r,background:n,backgroundAlpha:i}=e,s=n??r;s!==void 0&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Ac.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Ac.extension={type:[J.RendererSystem,J.CanvasRendererSystem],name:"background"};ne.add(Ac);class Z_{constructor(e){this.renderer=e,this.emptyRenderer=new hu(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){const{boundTextures:n}=this.renderer.texture;for(let i=r-1;i>=0;--i)e[i]=n[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,r,n,i){const{elements:s,ids:o,count:a}=e;let c=0;for(let u=0;u<a;u++){const d=s[u],h=d._batchLocation;if(h>=0&&h<i&&r[h]===d){o[u]=h;continue}for(;c<i;){const p=r[c];if(p&&p._batchEnabled===n&&p._batchLocation===c){c++;continue}o[u]=c,d._batchLocation=c,r[c]=d;break}}}destroy(){this.renderer=null}}Z_.extension={type:J.RendererSystem,name:"batch"};ne.add(Z_);let Vx=0;class Cc{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Vx++}init(e){if(e.context)this.initFromContext(e.context);else{const r=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Vx++,this.renderer.runners.contextChange.emit(e);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let n;if(Z.PREFER_ENV>=$i.WEBGL2&&(n=e.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const r=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Cc.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Cc.extension={type:J.RendererSystem,name:"context"};ne.add(Cc);class pp{constructor(e,r){if(this.width=Math.round(e),this.height=Math.round(r),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Tr("disposeFramebuffer"),this.multisample=it.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new ve(null,{scaleMode:on.NEAREST,resolution:1,mipmap:Xr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new ve(null,{scaleMode:on.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Xr.OFF,format:W.DEPTH_COMPONENT,type:le.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!e||!r)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],s=i.resolution;i.setSize(e/s,r/s)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,r/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class e1 extends ve{constructor(e={}){if(typeof e=="number"){const r=arguments[0],n=arguments[1],i=arguments[2],s=arguments[3];e={width:r,height:n,scaleMode:i,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=it.NONE),super(null,e),this.mipmap=Xr.OFF,this.valid=!0,this._clear=new Ue([0,0,0,0]),this.framebuffer=new pp(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class xn extends _a{constructor(e){const r=e,n=r.naturalWidth||r.videoWidth||r.displayWidth||r.width,i=r.naturalHeight||r.videoHeight||r.displayHeight||r.height;super(n,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,n){n===void 0&&!r.startsWith("data:")?e.crossOrigin=Sk(r):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,r,n,i){const s=e.gl,o=r.realWidth,a=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Ot.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&n.width===o&&n.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,n.type,i):(n.width=o,n.height=a,s.texImage2D(r.target,0,n.internalFormat,r.format,n.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),super.update()}dispose(){this.source=null}}class t1 extends xn{constructor(e,r){if(r=r||{},typeof e=="string"){const n=new Image;xn.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??Z.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,n)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{n(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Ot.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,n,this.bitmap),!this.preserveBitmap){let i=!0;const s=r._glTextures;for(const o in s){const a=s[o];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class Wf{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,n){const i=r.width,s=r.height;if(n){const o=e.width/2/i,a=e.height/2/s,c=e.x/i+o,u=e.y/s+a;n=Ve.add(n,Ve.NW),this.x0=c+o*Ve.uX(n),this.y0=u+a*Ve.uY(n),n=Ve.add(n,2),this.x1=c+o*Ve.uX(n),this.y1=u+a*Ve.uY(n),n=Ve.add(n,2),this.x2=c+o*Ve.uX(n),this.y2=u+a*Ve.uY(n),n=Ve.add(n,2),this.x3=c+o*Ve.uX(n),this.y3=u+a*Ve.uY(n)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Wf.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Wx=new Wf;function ll(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class re extends Ca{constructor(e,r,n,i,s,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new be(0,0,1,1)),e instanceof re&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=Wx,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Ie(o.x,o.y):new Ie(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:r}=this.baseTexture;r!=null&&r.url&&Mr[r.url]&&re.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,re.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new re(this.baseTexture,!this.noFrame&&e,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===Wx&&(this._uvs=new Wf),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},n=Z.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else if(e instanceof ve){if(!e.cacheId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${Fi()}`,ve.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Fi()}`}s=e._pixiId}let o=Mr[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof ve)?(r.resolution||(r.resolution=gn(e)),o=new re(new ve(e,r)),o.baseTexture.cacheId=s,ve.addToCache(o.baseTexture,s),re.addToCache(o,s)):!o&&e instanceof ve&&(o=new re(e),re.addToCache(o,s)),o}static fromURL(e,r){const n=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=re.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,r,n,i){return new re(ve.fromBuffer(e,r,n,i))}static fromLoader(e,r,n,i){const s=new ve(e,Object.assign({scaleMode:ve.defaultOptions.scaleMode,resolution:gn(r)},i)),{resource:o}=s;o instanceof t1&&(o.url=r);const a=new re(s);return n||(n=r),ve.addToCache(a.baseTexture,n),re.addToCache(a,n),n!==r&&(ve.addToCache(a.baseTexture,r),re.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(c=>{a.baseTexture.once("loaded",()=>c(a))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),Mr[r]&&Mr[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Mr[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=Mr[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete Mr[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)Mr[e.textureCacheIds[r]]===e&&delete Mr[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:r,y:n,width:i,height:s}=e,o=r+i>this.baseTexture.width,a=n+s>this.baseTexture.height;if(o||a){const c=o&&a?"and":"or",u=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,d=`Y: ${n} + ${s} = ${n+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${c} ${d}`)}this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return re._EMPTY||(re._EMPTY=new re(new ve),ll(re._EMPTY),ll(re._EMPTY.baseTexture)),re._EMPTY}static get WHITE(){if(!re._WHITE){const e=Z.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),re._WHITE=new re(ve.from(e)),ll(re._WHITE),ll(re._WHITE.baseTexture)}return re._WHITE}}class Wi extends re{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,n=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(r*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new Wi(new e1(e))}}class r1{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,n=it.NONE){const i=new e1(Object.assign({width:e,height:r,resolution:1,multisample:n},this.textureOptions));return new Wi(i)}getOptimalTexture(e,r,n=1,i=it.NONE){let s;e=Math.max(Math.ceil(e*n-1e-6),1),r=Math.max(Math.ceil(r*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=bc(e),r=bc(r),s=((e&65535)<<16|r&65535)>>>0,i>1&&(s+=i*4294967296)):s=i>1?-i:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,i)),o.filterPoolKey=s,o.setResolution(n),o}getFilterTexture(e,r,n){const i=this.getOptimalTexture(e.width,e.height,r||e.resolution,n||it.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const r in this.texturePool){const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}r1.SCREEN_KEY=-1;class eP extends ti{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class n1 extends ti{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new rt(this.vertices),this.uvBuffer=new rt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+r.width/e.width,this.uvs[3]=i,this.uvs[4]=n+r.width/e.width,this.uvs[5]=i+r.height/e.height,this.uvs[6]=n,this.uvs[7]=i+r.height/e.height,n=r.x,i=r.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+r.width,this.vertices[3]=i,this.vertices[4]=n+r.width,this.vertices[5]=i+r.height,this.vertices[6]=n,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class tP{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=it.NONE,this.sourceFrame=new be,this.destinationFrame=new be,this.bindingSourceFrame=new be,this.bindingDestinationFrame=new be,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const cl=[new Ie,new Ie,new Ie,new Ie],Cd=new Ge;class i1{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new r1,this.statePool=[],this.quad=new eP,this.quadUv=new n1,this.tempRect=new be,this.activeState={},this.globalUniforms=new Ar({outputFrame:new be,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){const n=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new tP,o=n.renderTexture;let a,c;if(o.current){const v=o.current;a=v.resolution,c=v.multisample}else a=n.resolution,c=n.multisample;let u=r[0].resolution||a,d=r[0].multisample??c,h=r[0].padding,p=r[0].autoFit,f=r[0].legacy??!0;for(let v=1;v<r.length;v++){const x=r[v];u=Math.min(u,x.resolution||a),d=Math.min(d,x.multisample??c),h=this.useMaxPadding?Math.max(h,x.padding):h+x.padding,p=p&&x.autoFit,f=f||(x.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=u,s.multisample=d,s.legacy=f,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(h);const m=this.tempRect.copyFrom(o.sourceFrame);n.projection.transform&&this.transformAABB(Cd.copyFrom(n.projection.transform).invert(),m),p?(s.sourceFrame.fit(m),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(m)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:n.resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,u,d),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const _=this.tempRect;_.x=0,_.y=0,_.width=s.sourceFrame.width,_.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=n.projection.transform,n.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,_),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,r=e.pop(),n=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const s=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*s[2]-.5*o[2],a[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){const u=i.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const c=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,c.renderTexture,Or.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let u=r.renderTexture,d=this.getOptimalFilterTexture(u.width,u.height,r.resolution);d.filterFrame=u.filterFrame;let h=0;for(h=0;h<n.length-1;++h){h===1&&r.multisample>1&&(d=this.getOptimalFilterTexture(u.width,u.height,r.resolution),d.filterFrame=u.filterFrame),n[h].apply(this,u,d,Or.CLEAR,r);const p=u;u=d,d=p}n[h].apply(this,u,c.renderTexture,Or.BLEND,r),h>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(d)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=Or.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,n.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=i.stateId&1||this.forceClear;(r===Or.CLEAR||r===Or.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,n,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(n,i),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Gr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Gr.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:s}=r._texture,o=e.set(i.width,0,0,i.height,n.x,n.y),a=r.worldTransform.copyTo(Ge.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,n=1,i=it.NONE){return this.texturePool.getOptimalTexture(e,r,n,i)}getFilterTexture(e,r,n){if(typeof e=="number"){const s=e;e=r,r=s}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,n||it.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){const n=cl[0],i=cl[1],s=cl[2],o=cl[3];n.set(r.left,r.top),i.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(n,n),e.apply(i,i),e.apply(s,s),e.apply(o,o);const a=Math.min(n.x,i.x,s.x,o.x),c=Math.min(n.y,i.y,s.y,o.y),u=Math.max(n.x,i.x,s.x,o.x),d=Math.max(n.y,i.y,s.y,o.y);r.x=a,r.y=c,r.width=u-a,r.height=d-c}roundFrame(e,r,n,i,s){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(s){const{a:o,b:a,c,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?Cd.copyFrom(s):Cd.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}}i1.extension={type:J.RendererSystem,name:"filter"};ne.add(i1);class rP{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=it.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const nP=new be;class s1{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new pp(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new be,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;Z.PREFER_ENV===$i.WEBGL_LEGACY&&(r=null,n=null),r?e.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,n=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=n),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){const o=r.width>>n,a=r.height>>n,c=o/r.width;this.setViewport(r.x*c,r.y*c,o,a)}else{const o=e.width>>n,a=e.height>>n;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,n,i){const s=this.viewport;e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),(s.width!==n||s.height!==i||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=n,s.height=i,this.gl.viewport(e,r,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,n,i,s=zh.COLOR|zh.DEPTH){const{gl:o}=this;o.clearColor(e,r,n,i),o.clear(s)}initFramebuffer(e){const{gl:r}=this,n=new rP(r.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){r.bindRenderbuffer(r.RENDERBUFFER,n.stencil);let o;this.renderer.context.webGLVersion===1?o=r.DEPTH_STENCIL:e.depth&&e.stencil?o=r.DEPTH24_STENCIL8:e.depth?o=r.DEPTH_COMPONENT24:o=r.STENCIL_INDEX8,n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,o,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let s=i.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=i[o],c=a.parentTextureArray||a;this.renderer.texture.bind(c,0),o===0&&n.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let c=0;c<o;c++){const u=s[c],d=u.parentTextureArray||u;this.renderer.texture.bind(d,0),c===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+c,u.target,d._glTextures[this.CONTEXT_UID].texture,r),a.push(n.COLOR_ATTACHMENT0+c))}if(a.length>1&&n.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const c=e.depthTexture;this.renderer.texture.bind(c,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,c._glTextures[this.CONTEXT_UID].texture,r)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||n.createRenderbuffer();let c,u;this.renderer.context.webGLVersion===1?(c=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH_STENCIL):e.depth&&e.stencil?(c=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH24_STENCIL8):e.depth?(c=n.DEPTH_ATTACHMENT,u=n.DEPTH_COMPONENT24):(c=n.STENCIL_ATTACHMENT,u=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,u,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,u,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,c,n.RENDERBUFFER,i.stencil)}else i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:r}=this;let n=it.NONE;if(e<=1||r===null)return n;for(let i=0;i<r.length;i++)if(r[i]<=e){n=r[i];break}return n===1&&(n=it.NONE),n}blit(e,r,n){const{current:i,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!i)return;const c=i.glFramebuffers[a];if(!c)return;if(!e){if(!c.msaaBuffer)return;const d=i.colorTextures[0];if(!d)return;c.blitFramebuffer||(c.blitFramebuffer=new pp(i.width,i.height),c.blitFramebuffer.addColorTexture(0,d)),e=c.blitFramebuffer,e.colorTextures[0]!==d&&(e.colorTextures[0]=d,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}r||(r=nP,r.width=i.width,r.height=i.height),n||(n=r);const u=r.width===n.width&&r.height===n.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,c.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,r){const n=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,r)}disposeAll(e){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<r.length;n++)this.disposeFramebuffer(r[n],e)}forceStencil(){const e=this.current;if(!e)return;const r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil&&e.stencil)return;e.stencil=!0;const n=e.width,i=e.height,s=this.gl,o=r.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,c;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,c=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,c=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,c=s.STENCIL_INDEX8),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,c,n,i):s.renderbufferStorage(s.RENDERBUFFER,c,n,i),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new be}destroy(){this.renderer=null}}s1.extension={type:J.RendererSystem,name:"framebuffer"};ne.add(s1);const kd={5126:4,5123:2,5121:1};class o1{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;Z.PREFER_ENV===$i.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(i,s)=>n.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,a,c)=>n.drawElementsInstancedANGLE(i,s,o,a,c),e.drawArraysInstanced=(i,s,o,a)=>n.drawArraysInstancedANGLE(i,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;const{gl:n}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,r=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];r.update(i)}}checkCompatibility(e,r){const n=e.attributes,i=r.attributeData;for(const s in i)if(!n[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){const n=e.attributes,i=r.attributeData,s=["g",e.id];for(const o in n)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,r,n=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,a);const c=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let d=u[c];if(d)return u[a.id]=d,d;const h=e.buffers,p=e.attributes,f={},m={};for(const _ in h)f[_]=0,m[_]=0;for(const _ in p)!p[_].size&&a.attributeData[_]?p[_].size=a.attributeData[_].size:p[_].size||console.warn(`PIXI Geometry attribute '${_}' size cannot be determined (likely the bound shader does not have the attribute)`),f[p[_].buffer]+=p[_].size*kd[p[_].type];for(const _ in p){const v=p[_],x=v.size;v.stride===void 0&&(f[v.buffer]===x*kd[v.type]?v.stride=0:v.stride=f[v.buffer]),v.start===void 0&&(v.start=m[v.buffer],m[v.buffer]+=x*kd[v.type])}d=i.createVertexArray(),i.bindVertexArray(d);for(let _=0;_<h.length;_++){const v=h[_];o.bind(v),n&&v._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=d,u[c]=d,i.bindVertexArray(null),o.unbind(Vr.ARRAY_BUFFER),d}disposeGeometry(e,r){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!n){if(o)for(let c=0;c<s.length;c++){const u=s[c]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!r&&o.dispose(s[c],r))}if(!r){for(const c in n)if(c[0]==="g"){const u=n[c];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const r=Object.keys(this.managedGeometries);for(let n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],e)}activateVao(e,r){const n=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let c=null;for(const u in a){const d=a[u],h=o[d.buffer],p=h._glBuffers[i];if(r.attributeData[u]){c!==p&&(s.bind(h),c=p);const f=r.attributeData[u].location;if(n.enableVertexAttribArray(f),n.vertexAttribPointer(f,d.size,d.type||n.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)n.vertexAttribDivisor(f,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,n,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,c=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,c,(n||0)*a,i||1):s.drawElements(e,r||o.indexBuffer.data.length,c,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,n,r||o.getSize(),i||1):s.drawArrays(e,n,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}o1.extension={type:J.RendererSystem,name:"geometry"};ne.add(o1);const Xx=new Ge;class a1{constructor(e,r){this._texture=e,this.mapCoord=new Ge,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];r[i]=s*n.a+o*n.c+n.tx,r[i+1]=s*n.b+o*n.d+n.ty}return r}update(e){const r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const n=r._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=r.orig,s=r.trim;s&&(Xx.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Xx));const o=r.baseTexture,a=this.uClampFrame,c=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(r._frame.x+c+u)/o.width,a[1]=(r._frame.y+c+u)/o.height,a[2]=(r._frame.x+r._frame.width-c+u)/o.width,a[3]=(r._frame.y+r._frame.height-c+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}}var iP=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,sP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class oP extends Rt{constructor(e,r,n){let i=null;typeof e!="string"&&r===void 0&&n===void 0&&(i=e,e=void 0,r=void 0,n=void 0),super(e||sP,r||iP,n),this.maskSprite=i,this.maskMatrix=new Ge}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,n,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new a1(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,n,i))}}class aP{constructor(e=null){this.type=lt.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Rt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=lt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class l1{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let n=r;if(!n.isMaskData){const s=this.maskDataPool.pop()||new aP;s.pooled=!0,s.maskObject=r,n=s}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==lt.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case lt.SCISSOR:this.renderer.scissor.push(n);break;case lt.STENCIL:this.renderer.stencil.push(n);break;case lt.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case lt.COLOR:this.pushColorMask(n);break}n.type===lt.SPRITE&&this.maskStack.push(n)}pop(e){const r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case lt.SCISSOR:this.renderer.scissor.pop(r);break;case lt.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case lt.SPRITE:this.popSpriteMask(r);break;case lt.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===lt.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const r=e.maskObject;r?r.isSprite?e.type=lt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=lt.SCISSOR:e.type=lt.STENCIL:e.type=lt.COLOR}pushSpriteMask(e){const{maskObject:r}=e,n=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new oP])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=r;const s=n.filterArea;n.filterArea=r.getBounds(!0),this.renderer.filter.push(n,i),n.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const r=e._colorMask,n=e._colorMask=r&e.colorMask;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const r=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}l1.extension={type:J.RendererSystem,name:"mask"};ne.add(l1);class c1{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:r}=this.renderer,n=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==n&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Yx=new Ge,Kx=[],u1=class Ol extends c1{constructor(e){super(e),this.glConst=Z.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const r=e._scissorRect,{maskObject:n}=e,{renderer:i}=this,s=i.renderTexture,o=n.getBounds(!0,Kx.pop()??new be);this.roundFrameToPixels(o,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),r&&o.fit(r),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:r,b:n,c:i,d:s}=e;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(r)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:r}=e;if(!r.isFastRect||!r.isFastRect()||Ol.isMatrixRotated(r.worldTransform)||Ol.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const n=e._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(e,r,n,i,s){Ol.isMatrixRotated(s)||(s=s?Yx.copyFrom(s):Yx.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*r),e.y=Math.round(e.y*r),e.width=Math.round(e.width*r),e.height=Math.round(e.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:r}=this.renderer;e._scissorRect||r.enable(r.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:r}=this.renderer;e&&Kx.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():r.disable(r.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let r;this.renderer.renderTexture.current?r=e.y:r=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,r,e.width,e.height)}};u1.extension={type:J.RendererSystem,name:"scissor"};let lP=u1;ne.add(lP);class d1 extends c1{constructor(e){super(e),this.glConst=Z.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const r=e.maskObject,{gl:n}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,n.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(n._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}d1.extension={type:J.RendererSystem,name:"stencil"};ne.add(d1);class h1{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return ke("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return ke("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return ke("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}h1.extension={type:[J.RendererSystem,J.CanvasRendererSystem],name:"_plugin"};ne.add(h1);class p1{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ge,this.transform=null}update(e,r,n,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,n,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}}p1.extension={type:J.RendererSystem,name:"projection"};ne.add(p1);const cP=new Vf,qx=new be;class f1{constructor(e){this.renderer=e,this._tempMatrix=new Ge}generateTexture(e,r){const{region:n,...i}=r||{},s=(n==null?void 0:n.copyTo(qx))||e.getLocalBounds(qx,!0),o=i.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),i.width=s.width,i.height=s.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const a=Wi.create(i);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const c=e.transform;return e.transform=cP,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=c,a}destroy(){}}f1.extension={type:[J.RendererSystem,J.CanvasRendererSystem],name:"textureGenerator"};ne.add(f1);const ui=new be,wo=new be;class m1{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new be,this.destinationFrame=new be,this.viewportFrame=new be}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,r,n){const i=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,r||(ui.width=e.frame.width,ui.height=e.frame.height,r=ui),n||(wo.x=e.frame.x,wo.y=e.frame.y,wo.width=r.width,wo.height=r.height,n=wo),o=s.framebuffer):(a=i.resolution,r||(ui.width=i._view.screen.width,ui.height=i._view.screen.height,r=ui),n||(n=ui,n.width=r.width,n.height=r.height));const c=this.viewportFrame;c.x=n.x*a,c.y=n.y*a,c.width=n.width*a,c.height=n.height*a,e||(c.y=i.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(o,c),this.renderer.projection.update(n,r,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)}clear(e,r){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=Ue.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:c,y:u,width:d,height:h}=this.viewportFrame;c=Math.round(c),u=Math.round(u),d=Math.round(d),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(c,u,d,h)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}m1.extension={type:J.RendererSystem,name:"renderTexture"};ne.add(m1);class uP{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function dP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=Q_(e,s.type),a={type:o,name:s.name,size:J_(o),location:e.getAttribLocation(t,s.name)};r[s.name]=a}return r}function hP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),c=Q_(e,s.type);r[o]={name:o,index:i,type:c,size:s.size,isArray:a,value:K_(c,s.size)}}return r}function pP(t,e){var a;const r=zx(t,t.VERTEX_SHADER,e.vertexSrc),n=zx(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||Gk(t,i,r,n),e.attributeData=dP(i,t),e.uniformData=hP(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const c=Object.keys(e.attributeData);c.sort((u,d)=>u>d?1:-1);for(let u=0;u<c.length;u++)e.attributeData[c[u]].location=u,t.bindAttribLocation(i,u,c[u]);t.linkProgram(i)}t.deleteShader(r),t.deleteShader(n);const o={};for(const c in e.uniformData){const u=e.uniformData[c];o[c]={location:t.getUniformLocation(i,c),value:K_(u.type,u.size)}}return new uP(i,o)}function fP(t,e,r,n,i){r.buffer.update(i)}const mP={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},g1={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function gP(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let r=0,n=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(r=g1[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!==0&&n<16){const a=n%r%16;n+=a,i+=a}n+r>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function xP(t,e){const r=[];for(const n in t)e[n]&&r.push(e[n]);return r.sort((n,i)=>n.index-i.index),r}function yP(t,e){if(!t.autoManage)return{size:0,syncFunc:fP};const r=xP(t.uniforms,e),{uboElements:n,size:i}=gP(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<n.length;o++){const a=n[o],c=t.uniforms[a.data.name],u=a.data.name;let d=!1;for(let h=0;h<Ls.length;h++){const p=Ls[h];if(p.codeUbo&&p.test(a.data,c)){s.push(`offset = ${a.offset/4};`,Ls[h].codeUbo(a.data.name,c)),d=!0;break}}if(!d)if(a.data.size>1){const h=J_(a.data.type),p=Math.max(g1[a.data.type]/16,1),f=h/p,m=(4-f%4)%4;s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*p}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const h=mP[a.data.type];s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${h};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let vP=0;const ul={textureCount:0,uboCount:0};class x1{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=vP++}systemCheck(){if(!$k())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),r||(ul.textureCount=0,ul.uboCount=0,this.syncUniformGroup(e.uniformGroup,ul)),i}setUniforms(e){const r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,r){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,r))}syncUniforms(e,r,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=Ok(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const i=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,r);e.buffer.update(),i(n.uniformData,e.uniforms,this.renderer,ul,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[r])}createSyncBufferGroup(e,r,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(r.program,n);r.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=yP(e,this.shader.program.uniformData)),e.autoManage){const c=new Float32Array(a.size/4);e.buffer.update(c)}return r.uniformGroups[e.id]=a.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,n){const i=e.uniforms,s=[`${n}-`];for(const o in i)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=this.gl,n=e.program,i=pP(r,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}x1.extension={type:J.RendererSystem,name:"shader"};ne.add(x1);class kc{constructor(e){this.renderer=e}run(e){const{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.4.3 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}}kc.defaultOptions={hello:!1},kc.extension={type:[J.RendererSystem,J.CanvasRendererSystem],name:"startup"};ne.add(kc);function _P(t,e=[]){return e[he.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.ADD]=[t.ONE,t.ONE],e[he.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.NONE]=[0,0],e[he.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[he.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[he.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[he.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[he.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[he.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[he.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[he.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[he.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[he.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[he.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const wP=0,SP=1,bP=2,EP=3,TP=4,AP=5,y1=class fp{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=he.NONE,this._blendEq=!1,this.map=[],this.map[wP]=this.setBlend,this.map[SP]=this.setOffset,this.map[bP]=this.setCullFace,this.map[EP]=this.setDepthTest,this.map[TP]=this.setFrontFace,this.map[AP]=this.setDepthMask,this.checks=[],this.defaultState=new Kr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=_P(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let r=this.stateId^e.data,n=0;for(;r;)r&1&&this.map[n].call(this,!!(e.data&1<<n)),r=r>>1,n++;this.stateId=e.data}for(let r=0;r<this.checks.length;r++)this.checks[r](this,e)}forceState(e){e=e||this.defaultState;for(let r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(let r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(fp.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(fp.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const r=this.blendModes[e],n=this.gl;r.length===2?n.blendFunc(r[0],r[1]):n.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,n.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,r){this.gl.polygonOffset(e,r)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,r){const n=this.checks.indexOf(e);r&&n===-1?this.checks.push(e):!r&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,r){e.setBlendMode(r.blendMode)}static checkPolygonOffset(e,r){e.setPolygonOffset(1,r.polygonOffset)}destroy(){this.gl=null}};y1.extension={type:J.RendererSystem,name:"state"};let CP=y1;ne.add(CP);class kP extends Ca{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const r=(e.priority??[]).filter(i=>e.systems[i]),n=[...r,...Object.keys(e.systems).filter(i=>!r.includes(i))];for(const i of n)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(r=>{this.runners[r]=new Tr(r)})}addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(e,r){const n=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=n.find(o=>this._systemsHash[o]===i);i[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const Po=class Ul{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Ul.defaultMaxIdle,this.checkCountMax=Ul.defaultCheckCountMax,this.mode=Ul.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Ff.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,r=e.managedTextures;let n=!1;for(let i=0;i<r.length;i++){const s=r[i];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),r[i]=null,n=!0)}if(n){let i=0;for(let s=0;s<r.length;s++)r[s]!==null&&(r[i++]=r[s]);r.length=i}}unload(e){const r=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&r.destroyTexture(n);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};Po.defaultMode=Ff.AUTO,Po.defaultMaxIdle=60*60,Po.defaultCheckCountMax=60*10,Po.extension={type:J.RendererSystem,name:"textureGC"};let vi=Po;ne.add(vi);class Pd{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=le.UNSIGNED_BYTE,this.internalFormat=W.RGBA,this.samplerType=0}}function PP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:Q.FLOAT,[t.RGBA]:Q.FLOAT,[t.ALPHA]:Q.FLOAT,[t.LUMINANCE]:Q.FLOAT,[t.LUMINANCE_ALPHA]:Q.FLOAT,[t.R8]:Q.FLOAT,[t.R8_SNORM]:Q.FLOAT,[t.RG8]:Q.FLOAT,[t.RG8_SNORM]:Q.FLOAT,[t.RGB8]:Q.FLOAT,[t.RGB8_SNORM]:Q.FLOAT,[t.RGB565]:Q.FLOAT,[t.RGBA4]:Q.FLOAT,[t.RGB5_A1]:Q.FLOAT,[t.RGBA8]:Q.FLOAT,[t.RGBA8_SNORM]:Q.FLOAT,[t.RGB10_A2]:Q.FLOAT,[t.RGB10_A2UI]:Q.FLOAT,[t.SRGB8]:Q.FLOAT,[t.SRGB8_ALPHA8]:Q.FLOAT,[t.R16F]:Q.FLOAT,[t.RG16F]:Q.FLOAT,[t.RGB16F]:Q.FLOAT,[t.RGBA16F]:Q.FLOAT,[t.R32F]:Q.FLOAT,[t.RG32F]:Q.FLOAT,[t.RGB32F]:Q.FLOAT,[t.RGBA32F]:Q.FLOAT,[t.R11F_G11F_B10F]:Q.FLOAT,[t.RGB9_E5]:Q.FLOAT,[t.R8I]:Q.INT,[t.R8UI]:Q.UINT,[t.R16I]:Q.INT,[t.R16UI]:Q.UINT,[t.R32I]:Q.INT,[t.R32UI]:Q.UINT,[t.RG8I]:Q.INT,[t.RG8UI]:Q.UINT,[t.RG16I]:Q.INT,[t.RG16UI]:Q.UINT,[t.RG32I]:Q.INT,[t.RG32UI]:Q.UINT,[t.RGB8I]:Q.INT,[t.RGB8UI]:Q.UINT,[t.RGB16I]:Q.INT,[t.RGB16UI]:Q.UINT,[t.RGB32I]:Q.INT,[t.RGB32UI]:Q.UINT,[t.RGBA8I]:Q.INT,[t.RGBA8UI]:Q.UINT,[t.RGBA16I]:Q.INT,[t.RGBA16UI]:Q.UINT,[t.RGBA32I]:Q.INT,[t.RGBA32UI]:Q.UINT,[t.DEPTH_COMPONENT16]:Q.FLOAT,[t.DEPTH_COMPONENT24]:Q.FLOAT,[t.DEPTH_COMPONENT32F]:Q.FLOAT,[t.DEPTH_STENCIL]:Q.FLOAT,[t.DEPTH24_STENCIL8]:Q.FLOAT,[t.DEPTH32F_STENCIL8]:Q.FLOAT}:e={[t.RGB]:Q.FLOAT,[t.RGBA]:Q.FLOAT,[t.ALPHA]:Q.FLOAT,[t.LUMINANCE]:Q.FLOAT,[t.LUMINANCE_ALPHA]:Q.FLOAT,[t.DEPTH_STENCIL]:Q.FLOAT},e}function RP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[le.UNSIGNED_BYTE]:{[W.RGBA]:t.RGBA8,[W.RGB]:t.RGB8,[W.RG]:t.RG8,[W.RED]:t.R8,[W.RGBA_INTEGER]:t.RGBA8UI,[W.RGB_INTEGER]:t.RGB8UI,[W.RG_INTEGER]:t.RG8UI,[W.RED_INTEGER]:t.R8UI,[W.ALPHA]:t.ALPHA,[W.LUMINANCE]:t.LUMINANCE,[W.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[le.BYTE]:{[W.RGBA]:t.RGBA8_SNORM,[W.RGB]:t.RGB8_SNORM,[W.RG]:t.RG8_SNORM,[W.RED]:t.R8_SNORM,[W.RGBA_INTEGER]:t.RGBA8I,[W.RGB_INTEGER]:t.RGB8I,[W.RG_INTEGER]:t.RG8I,[W.RED_INTEGER]:t.R8I},[le.UNSIGNED_SHORT]:{[W.RGBA_INTEGER]:t.RGBA16UI,[W.RGB_INTEGER]:t.RGB16UI,[W.RG_INTEGER]:t.RG16UI,[W.RED_INTEGER]:t.R16UI,[W.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[le.SHORT]:{[W.RGBA_INTEGER]:t.RGBA16I,[W.RGB_INTEGER]:t.RGB16I,[W.RG_INTEGER]:t.RG16I,[W.RED_INTEGER]:t.R16I},[le.UNSIGNED_INT]:{[W.RGBA_INTEGER]:t.RGBA32UI,[W.RGB_INTEGER]:t.RGB32UI,[W.RG_INTEGER]:t.RG32UI,[W.RED_INTEGER]:t.R32UI,[W.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[le.INT]:{[W.RGBA_INTEGER]:t.RGBA32I,[W.RGB_INTEGER]:t.RGB32I,[W.RG_INTEGER]:t.RG32I,[W.RED_INTEGER]:t.R32I},[le.FLOAT]:{[W.RGBA]:t.RGBA32F,[W.RGB]:t.RGB32F,[W.RG]:t.RG32F,[W.RED]:t.R32F,[W.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[le.HALF_FLOAT]:{[W.RGBA]:t.RGBA16F,[W.RGB]:t.RGB16F,[W.RG]:t.RG16F,[W.RED]:t.R16F},[le.UNSIGNED_SHORT_5_6_5]:{[W.RGB]:t.RGB565},[le.UNSIGNED_SHORT_4_4_4_4]:{[W.RGBA]:t.RGBA4},[le.UNSIGNED_SHORT_5_5_5_1]:{[W.RGBA]:t.RGB5_A1},[le.UNSIGNED_INT_2_10_10_10_REV]:{[W.RGBA]:t.RGB10_A2,[W.RGBA_INTEGER]:t.RGB10_A2UI},[le.UNSIGNED_INT_10F_11F_11F_REV]:{[W.RGB]:t.R11F_G11F_B10F},[le.UNSIGNED_INT_5_9_9_9_REV]:{[W.RGB]:t.RGB9_E5},[le.UNSIGNED_INT_24_8]:{[W.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[le.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[W.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[le.UNSIGNED_BYTE]:{[W.RGBA]:t.RGBA,[W.RGB]:t.RGB,[W.ALPHA]:t.ALPHA,[W.LUMINANCE]:t.LUMINANCE,[W.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[le.UNSIGNED_SHORT_5_6_5]:{[W.RGB]:t.RGB},[le.UNSIGNED_SHORT_4_4_4_4]:{[W.RGBA]:t.RGBA},[le.UNSIGNED_SHORT_5_5_5_1]:{[W.RGBA]:t.RGBA}},e}class v1{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ve,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=RP(e),this.samplerTypes=PP(e);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new Pd(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Pd(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,r=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:r,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}ensureSamplerType(e){const{boundTextures:r,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let s=e-1;s>=0;--s){const o=r[s];o&&o._glTextures[i].samplerType!==Q.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const r=new Pd(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){var n;r.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,r.samplerType=this.samplerTypes[r.internalFormat]??Q.FLOAT,this.webGLVersion===2&&e.type===le.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){var i;const r=e._glTextures[this.CONTEXT_UID];if(!r)return;const n=this.renderer;if(this.initTextureType(e,r),(i=e.resource)==null?void 0:i.upload(n,e,r))r.samplerType!==Q.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=n.gl;(r.width!==s||r.height!==o||r.dirtyId<0)&&(r.width=s,r.height=o,a.texImage2D(e.target,0,r.internalFormat,s,o,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(e);i!==-1&&Fs(this.managedTextures,i,1)}}updateTextureStyle(e){var n;const r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===Xr.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=Jn.CLAMP:r.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){const n=this.gl;if(r.mipmap&&e.mipmap!==Xr.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===on.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===on.LINEAR){const s=Math.min(e.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===on.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===on.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}v1.extension={type:J.RendererSystem,name:"texture"};ne.add(v1);class _1{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){const{gl:n,renderer:i}=this;r&&i.shader.bind(r),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:r,renderer:n,CONTEXT_UID:i}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[i]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(n.buffer.update(a),a._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){const n=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const c=a._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!r&&s.dispose(a,r))}n&&(r||i.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}_1.extension={type:J.RendererSystem,name:"transformFeedback"};ne.add(_1);class Pc{constructor(e){this.renderer=e}init(e){this.screen=new be(0,0,e.width,e.height),this.element=e.view||Z.ADAPTER.createCanvas(),this.resolution=e.resolution||Z.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var r;e&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Pc.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Pc.extension={type:[J.RendererSystem,J.CanvasRendererSystem],name:"_view"};ne.add(Pc);Z.PREFER_ENV=$i.WEBGL2;Z.STRICT_TEXTURE_CACHE=!1;Z.RENDER_OPTIONS={...Cc.defaultOptions,...Ac.defaultOptions,...Pc.defaultOptions,...kc.defaultOptions};Object.defineProperties(Z,{WRAP_MODE:{get(){return ve.defaultOptions.wrapMode},set(t){ke("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),ve.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return ve.defaultOptions.scaleMode},set(t){ke("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),ve.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return ve.defaultOptions.mipmap},set(t){ke("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),ve.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return ve.defaultOptions.anisotropicLevel},set(t){ke("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),ve.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return ke("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Rt.defaultResolution},set(t){Rt.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return ke("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Rt.defaultMultisample},set(t){Rt.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return yi.defaultMaxTextures},set(t){ke("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),yi.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return yi.defaultBatchSize},set(t){ke("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),yi.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return yi.canUploadSameBuffer},set(t){ke("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),yi.canUploadSameBuffer=t}},GC_MODE:{get(){return vi.defaultMode},set(t){ke("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),vi.defaultMode=t}},GC_MAX_IDLE:{get(){return vi.defaultMaxIdle},set(t){ke("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),vi.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return vi.defaultCheckCountMax},set(t){ke("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),vi.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return cn.defaultVertexPrecision},set(t){ke("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),cn.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return cn.defaultFragmentPrecision},set(t){ke("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),cn.defaultFragmentPrecision=t}}});var Li=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Li||{});class Rd{constructor(e,r=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=n,this.once=i}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const w1=class Vt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Rd(null,null,1/0),this.deltaMS=1/Vt.targetFPMS,this.elapsedMS=1/Vt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=Li.NORMAL){return this._addListener(new Rd(e,r,n))}addOnce(e,r,n=Li.NORMAL){return this._addListener(new Rd(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*Vt.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,Vt.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!Vt._shared){const e=Vt._shared=new Vt;e.autoStart=!0,e._protected=!0}return Vt._shared}static get system(){if(!Vt._system){const e=Vt._system=new Vt;e.autoStart=!0,e._protected=!0}return Vt._system}};w1.targetFPMS=.06;let Yt=w1;Object.defineProperties(Z,{TARGET_FPMS:{get(){return Yt.targetFPMS},set(t){ke("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Yt.targetFPMS=t}}});class S1{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Li.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Yt.shared:new Yt,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}S1.extension=J.Application;ne.add(S1);const b1=[];ne.handleByList(J.Renderer,b1);function IP(t){for(const e of b1)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var jP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,MP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const BP=jP,E1=MP;class T1{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}r>=it.HIGH?this.multisample=it.HIGH:r>=it.MEDIUM?this.multisample=it.MEDIUM:r>=it.LOW?this.multisample=it.LOW:this.multisample=it.NONE}destroy(){}}T1.extension={type:J.RendererSystem,name:"_multisample"};ne.add(T1);class NP{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class A1{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);r.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[r]=e,n.bindBufferBase(n.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,n){const{gl:i,CONTEXT_UID:s}=this;n=n||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,o.buffer,n*256,256)}update(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{const s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),n&&(r||i.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const r=Object.keys(this.managedBuffers);for(let n=0;n<r.length;n++)this.dispose(this.managedBuffers[r[n]],e)}createGLBuffer(e){const{CONTEXT_UID:r,gl:n}=this;return e._glBuffers[r]=new NP(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}}A1.extension={type:J.RendererSystem,name:"buffer"};ne.add(A1);class C1{constructor(e){this.renderer=e}render(e,r){const n=this.renderer;let i,s,o,a;if(r&&(i=r.renderTexture,s=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=o,!n.context.isLost){if(i||(this.lastObjectRendered=e),!a){const c=e.enableTempParent();e.updateTransform(),e.disableTempParent(c)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(s??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),i&&(r.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}C1.extension={type:J.RendererSystem,name:"objectRenderer"};ne.add(C1);const zl=class mp extends kP{constructor(e){super(),this.type=l_.WEBGL,e=Object.assign({},Z.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Ar({projectionMatrix:new Ge},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:mp.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in e&&(ke("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=mp.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:ik()}render(e,r){this.objectRenderer.render(e,r)}resize(e,r){this._view.resizeView(e,r)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return ke("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return ke("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return ke("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return ke("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){ke("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return ke("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){ke("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return ke("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,r){return this.textureGenerator.generateTexture(e,r)}};zl.extension={type:J.Renderer,priority:1},zl.__plugins={},zl.__systems={};let Xf=zl;ne.handleByMap(J.RendererPlugin,Xf.__plugins);ne.handleByMap(J.RendererSystem,Xf.__systems);ne.add(Xf);class k1 extends _a{constructor(e,r){const{width:n,height:i}=r||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new ve;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof _a?this.addResourceAt(e[n],n):this.addResourceAt(W_(e[n],r),n))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(e).then(()=>{const{realWidth:r,realHeight:n}=this.items[0];return this.resize(r,n),this.update(),Promise.resolve(this)}),this._load}}class FP extends k1{constructor(e,r){const{width:n,height:i}=r||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:n,height:i}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Ms.TEXTURE_2D_ARRAY}upload(e,r,n){const{length:i,itemDirtyIds:s,items:o}=this,{gl:a}=e;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,r.format,n.type,null);for(let c=0;c<i;c++){const u=o[c];s[c]<u.dirtyId&&(s[c]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,c,u.resource.width,u.resource.height,1,r.format,n.type,u.resource.source))}return!0}}class LP extends xn{constructor(e){super(e)}static test(e){const{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const P1=class Ro extends k1{constructor(e,r){const{width:n,height:i,autoLoad:s,linkBaseTexture:o}=r||{};if(e&&e.length!==Ro.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:n,height:i});for(let a=0;a<Ro.SIDES;a++)this.items[a].target=Ms.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,r),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Ms.TEXTURE_CUBE_MAP}addBaseTextureAt(e,r,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[r])throw new Error(`Index ${r} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Ms.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this}upload(e,r,n){const i=this.itemDirtyIds;for(let s=0;s<Ro.SIDES;s++){const o=this.items[s];(i[s]<o.dirtyId||n.dirtyId<r.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Ro.SIDES}};P1.SIDES=6;let DP=P1;class As extends xn{constructor(e,r){r=r||{};let n,i,s;typeof e=="string"?(n=As.EMPTY,i=e,s=!0):(n=e,i=null,s=!1),super(n),this.url=i,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.ownsImageBitmap=r.ownsImageBitmap??s,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{const n=await Z.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Ot.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(n){if(this.destroyed)return;r(n),this.onError.emit(n)}}),this._load)}upload(e,r,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return As._EMPTY=As._EMPTY??Z.ADAPTER.createCanvas(0,0),As._EMPTY}}const gp=class Gl extends xn{constructor(e,r){r=r||{},super(Z.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},Gl.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;xn.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=r=>{this._resolve&&(e.onerror=null,this.onError.emit(r))},e.onload=()=>{if(!this._resolve)return;const r=e.width,n=e.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=r*this.scale,s=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/n*r,s=this._overrideHeight||this._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);const o=this.source;o.width=i,o.height=s,o._pixiId=`canvas_${Fi()}`,o.getContext("2d").drawImage(e,0,0,r,n,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){const r=Gl.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,r){return r==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Gl.SVG_XML.test(e)}};gp.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,gp.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let xp=gp;class OP extends xn{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const yp=class vp extends xn{constructor(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){const n=document.createElement("video");r.autoLoad!==!1&&n.setAttribute("preload","auto"),r.playsinline!==!1&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),r.muted===!0&&(n.setAttribute("muted",""),n.muted=!0),r.loop===!0&&n.setAttribute("loop",""),r.autoPlay!==!1&&n.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];xn.crossOrigin(n,i,r.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:c}=e[s];if(a=a||e[s],a.startsWith("data:"))c=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const u=a.split("?").shift().toLowerCase(),d=u.slice(u.lastIndexOf(".")+1);c=c||vp.MIME_TYPES[d]||`video/${d}`}o.src=a,c&&(o.type=c),n.appendChild(o)}e=n}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=r.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),r.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const r=Yt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((r,n)=>{this.valid?r(this):(this._resolve=r,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const r=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!r&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Yt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Yt.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Yt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,r){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||vp.TYPES.includes(r)}};yp.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],yp.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let R1=yp;sp.push(As,t1,LP,R1,OP,xp,lu,DP,FP);class Rc{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?be.EMPTY:(e=e||new be(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){const{a:n,b:i,c:s,d:o,tx:a,ty:c}=e,u=n*r.x+s*r.y+a,d=i*r.x+o*r.y+c;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(e){let r=this.minX,n=this.minY,i=this.maxX,s=this.maxY,o=e[0],a=e[1];r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[2],a=e[3],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[4],a=e[5],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[6],a=e[7],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,this.minX=r,this.minY=n,this.maxX=i,this.maxY=s}addFrame(e,r,n,i,s){this.addFrameMatrix(e.worldTransform,r,n,i,s)}addFrameMatrix(e,r,n,i,s){const o=e.a,a=e.b,c=e.c,u=e.d,d=e.tx,h=e.ty;let p=this.minX,f=this.minY,m=this.maxX,_=this.maxY,v=o*r+c*n+d,x=a*r+u*n+h;p=v<p?v:p,f=x<f?x:f,m=v>m?v:m,_=x>_?x:_,v=o*i+c*n+d,x=a*i+u*n+h,p=v<p?v:p,f=x<f?x:f,m=v>m?v:m,_=x>_?x:_,v=o*r+c*s+d,x=a*r+u*s+h,p=v<p?v:p,f=x<f?x:f,m=v>m?v:m,_=x>_?x:_,v=o*i+c*s+d,x=a*i+u*s+h,p=v<p?v:p,f=x<f?x:f,m=v>m?v:m,_=x>_?x:_,this.minX=p,this.minY=f,this.maxX=m,this.maxY=_}addVertexData(e,r,n){let i=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let c=r;c<n;c+=2){const u=e[c],d=e[c+1];i=u<i?u:i,s=d<s?d:s,o=u>o?u:o,a=d>a?d:a}this.minX=i,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,r,n,i){this.addVerticesMatrix(e.worldTransform,r,n,i)}addVerticesMatrix(e,r,n,i,s=0,o=s){const a=e.a,c=e.b,u=e.c,d=e.d,h=e.tx,p=e.ty;let f=this.minX,m=this.minY,_=this.maxX,v=this.maxY;for(let x=n;x<i;x+=2){const y=r[x],g=r[x+1],w=a*y+u*g+h,b=d*g+c*y+p;f=Math.min(f,w-s),_=Math.max(_,w+s),m=Math.min(m,b-o),v=Math.max(v,b+o)}this.minX=f,this.minY=m,this.maxX=_,this.maxY=v}addBounds(e){const r=this.minX,n=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,r){const n=e.minX>r.minX?e.minX:r.minX,i=e.minY>r.minY?e.minY:r.minY,s=e.maxX<r.maxX?e.maxX:r.maxX,o=e.maxY<r.maxY?e.maxY:r.maxY;if(n<=s&&i<=o){const a=this.minX,c=this.minY,u=this.maxX,d=this.maxY;this.minX=n<a?n:a,this.minY=i<c?i:c,this.maxX=s>u?s:u,this.maxY=o>d?o:d}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){const n=e.minX>r.x?e.minX:r.x,i=e.minY>r.y?e.minY:r.y,s=e.maxX<r.x+r.width?e.maxX:r.x+r.width,o=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(n<=s&&i<=o){const a=this.minX,c=this.minY,u=this.maxX,d=this.maxY;this.minX=n<a?n:a,this.minY=i<c?i:c,this.maxX=s>u?s:u,this.maxY=o>d?o:d}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,n,i,s,o){e-=s,r-=o,n+=s,i+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class qe extends Ca{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Vf,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Rc,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.defineProperty(qe.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new be),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new be),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Rc);const r=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(n==null?void 0:n.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=n,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,n,i){return r&&(e=r.toGlobal(e,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,r=0,n=1,i=1,s=0,o=0,a=0,c=0,u=0){return this.position.x=e,this.position.y=r,this.scale.x=n||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=c,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new UP),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*jk}set angle(e){this.transform.rotation=e*Mk}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class UP extends qe{constructor(){super(...arguments),this.sortDirty=null}}qe.prototype.displayObjectUpdateTransform=qe.prototype.updateTransform;const zP=new Ge;function GP(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const I1=class _p extends qe{constructor(){super(),this.children=[],this.sortableChildren=_p.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.addChild(e[r]);else{const r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]}addChildAt(e,r){if(r<0||r>this.children.length)throw new Error(`${e}addChildAt: The index ${r} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e}swapChildren(e,r){if(e===r)return;const n=this.getChildIndex(e),i=this.getChildIndex(r);this.children[n]=r,this.children[i]=e,this.onChildrenChange(n<i?n:i)}getChildIndex(e){const r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r}setChildIndex(e,r){if(r<0||r>=this.children.length)throw new Error(`The index ${r} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(e);Fs(this.children,n,1),this.children.splice(r,0,e),this.onChildrenChange(r)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.removeChild(e[r]);else{const r=e[0],n=this.children.indexOf(r);if(n===-1)return null;r.parent=null,r.transform._parentID=-1,Fs(this.children,n,1),this._boundsID++,this.onChildrenChange(n),r.emit("removed",this),this.emit("childRemoved",r,this,n)}return e[0]}removeChildAt(e){const r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,Fs(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r}removeChildren(e=0,r=this.children.length){const n=e,i=r,s=i-n;let o;if(s>0&&s<=i){o=this.children.splice(n,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let r=0,n=this.children.length;r<n;++r){const i=this.children[r];i._lastSortedIndex=r,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(GP),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,r=this.children.length;e<r;++e){const n=this.children[e];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const r=this.children[e];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){const n=r._mask.isMaskData?r._mask.maskObject:r._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,r=!1){const n=super.getLocalBounds(e);if(!r)for(let i=0,s=this.children.length;i<s;++i){const o=this.children[i];o.visible&&o.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const r=e.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==_p.prototype._render&&(n=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=zP.copyFrom(i),i.prepend(s)):i=s),n&&r.intersects(n,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const c=this.children[o],u=c.cullable;c.cullable=u||!this.cullArea,c.render(e),c.cullable=u}}render(e){var r;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(r=this.filters)!=null&&r.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,i=this.children.length;n<i;++n)this.children[n].render(e)}}renderAdvanced(e){var s,o,a;const r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let c=0;c<r.length;c++)r[c].enabled&&this._enabledFilters.push(r[c])}const i=r&&((s=this._enabledFilters)==null?void 0:s.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==lt.NONE));if(i&&e.batch.flush(),r&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let c=0,u=this.children.length;c<u;++c)this.children[c].render(e)}i&&e.batch.flush(),n&&e.mask.pop(this),r&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const r=typeof e=="boolean"?e:e==null?void 0:e.children,n=this.removeChildren(0,this.children.length);if(r)for(let i=0;i<n.length;++i)n[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const r=this.getLocalBounds().width;r!==0?this.scale.x=e/r:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const r=this.getLocalBounds().height;r!==0?this.scale.y=e/r:this.scale.y=1,this._height=e}};I1.defaultSortableChildren=!1;let $t=I1;$t.prototype.containerUpdateTransform=$t.prototype.updateTransform;Object.defineProperties(Z,{SORTABLE_CHILDREN:{get(){return $t.defaultSortableChildren},set(t){ke("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),$t.defaultSortableChildren=t}}});const So=new Ie,HP=new Uint16Array([0,1,2,0,2,3]);class ri extends $t{constructor(e){super(),this._anchor=new ln(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Ue(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=he.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||re.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=HP,this.pluginName="batch",this.isSprite=!0,this._roundPixels=Z.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Un(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Un(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,c=r.ty,u=this.vertexData,d=e.trim,h=e.orig,p=this._anchor;let f=0,m=0,_=0,v=0;if(d?(m=d.x-p._x*h.width,f=m+d.width,v=d.y-p._y*h.height,_=v+d.height):(m=-p._x*h.width,f=m+h.width,v=-p._y*h.height,_=v+h.height),u[0]=n*m+s*v+a,u[1]=o*v+i*m+c,u[2]=n*f+s*v+a,u[3]=o*v+i*f+c,u[4]=n*f+s*_+a,u[5]=o*_+i*f+c,u[6]=n*m+s*_+a,u[7]=o*_+i*m+c,this._roundPixels){const x=Z.RESOLUTION;for(let y=0;y<u.length;++y)u[y]=Math.round(u[y]*x)/x}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,r=this.vertexTrimmedData,n=e.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,c=s.c,u=s.d,d=s.tx,h=s.ty,p=-i._x*n.width,f=p+n.width,m=-i._y*n.height,_=m+n.height;if(r[0]=o*p+c*m+d,r[1]=u*m+a*p+h,r[2]=o*f+c*m+d,r[3]=u*m+a*f+h,r[4]=o*f+c*_+d,r[5]=u*_+a*f+h,r[6]=o*p+c*_+d,r[7]=u*_+a*p+h,this._roundPixels){const v=Z.RESOLUTION;for(let x=0;x<r.length;++x)r[x]=Math.round(r[x]*v)/v}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Rc),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new be),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,So);const r=this._texture.orig.width,n=this._texture.orig.height,i=-r*this.anchor.x;let s=0;return So.x>=i&&So.x<i+r&&(s=-n*this.anchor.y,So.y>=s&&So.y<s+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const r=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(e,r){const n=e instanceof re?e:re.from(e,r);return new ri(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const r=Un(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const r=Un(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||re.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const j1=new Ge;qe.prototype._cacheAsBitmap=!1;qe.prototype._cacheData=null;qe.prototype._cacheAsBitmapResolution=null;qe.prototype._cacheAsBitmapMultisample=null;class $P{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(qe.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new $P),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});qe.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};qe.prototype._initCachedDisplayObject=function(t){var p,f;if((p=this._cacheData)!=null&&p.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(new be,!0);if((f=this.filters)!=null&&f.length){const m=this.filters[0].padding;r.pad(m)}const n=this.cacheAsBitmapResolution||t.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,c=Wi.create({width:r.width,height:r.height,resolution:n,multisample:this.cacheAsBitmapMultisample??t.multisample}),u=`cacheAsBitmap_${Fi()}`;this._cacheData.textureCacheId=u,ve.addToCache(c.baseTexture,u),re.addToCache(c,u);const d=this.transform.localTransform.copyTo(j1).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const h=new ri(c);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(r.x/r.width),h.anchor.y=-(r.y/r.height),h.alpha=e,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h)};qe.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};qe.prototype._initCachedDisplayObjectCanvas=function(t){var d;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.getLocalBounds(new be,!0),r=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Wi.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${Fi()}`;this._cacheData.textureCacheId=a,ve.addToCache(o.baseTexture,a),re.addToCache(o,a);const c=j1;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=e.x,c.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:c,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const u=new ri(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};qe.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};qe.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};qe.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ve.removeFromCache(this._cacheData.textureCacheId),re.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};qe.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};qe.prototype.name=null;$t.prototype.getChildByName=function(t,e){for(let r=0,n=this.children.length;r<n;r++)if(this.children[r].name===t)return this.children[r];if(e)for(let r=0,n=this.children.length;r<n;r++){const i=this.children[r];if(!i.getChildByName)continue;const s=i.getChildByName(t,!0);if(s)return s}return null};qe.prototype.getGlobalPosition=function(t=new Ie,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var VP=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class WP extends Rt{constructor(e=1){super(BP,VP,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const XP={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},YP=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function KP(t){const e=XP[t],r=e.length;let n=YP,i="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let c=s.replace("%index%",a.toString());o=a,a>=r&&(o=t-a-1),c=c.replace("%value%",e[o].toString()),i+=c,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}const qP=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function JP(t,e){const r=Math.ceil(t/2);let n=qP,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),i+=a,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}class wp extends Rt{constructor(e,r=8,n=4,i=Rt.defaultResolution,s=5){const o=JP(s,e),a=KP(s);super(o,a),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=n,this.blur=r}apply(e,r,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,n,i);else{const s=e.getFilterTexture(),o=e.renderer;let a=r,c=s;this.state.blend=!1,e.applyFilter(this,a,c,Or.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,Or.BLIT),this.uniforms.uSampler=c;const d=c;c=a,a=d,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,c,n,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class QP extends Rt{constructor(e=8,r=4,n=Rt.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new wp(!0,e,r,n,i),this.blurYFilter=new wp(!1,e,r,n,i),this.resolution=n,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,n,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,r,a,Or.CLEAR),this.blurYFilter.apply(e,a,n,i),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,r,n,i):this.blurXFilter.apply(e,r,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var ZP=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Sp extends Rt{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(E1,ZP,e),this.alpha=1}_loadMatrix(e,r=!1){let n=e;r&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,r,n){return e[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],e[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],e[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],e[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],e[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],e[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],e[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],e[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],e[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],e[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],e[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],e[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],e[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],e[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],e[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],e[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],e[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],e[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],e[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],e[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],e}_colorMatrix(e){const r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(e,r){const[n,i,s]=Ue.shared.setValue(e).toArray(),o=[n,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(e,r){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(e){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;const n=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),c=n+(1-n)*o,u=o*(1-n)-a*i,d=o*(1-n)+a*i,h=o*(1-n)+a*i,p=n+o*(1-n),f=o*(1-n)-a*i,m=o*(1-n)-a*i,_=o*(1-n)+a*i,v=n+o*(1-n),x=[c,u,d,0,0,h,p,f,0,0,m,_,v,0,0,0,0,0,1,0];this._loadMatrix(x,r)}contrast(e,r){const n=(e||0)+1,i=-.5*(n-1),s=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(s,r)}saturate(e=0,r){const n=e*2/3+1,i=(n-1)*-.5,s=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(e){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,n,i,s){e=e||.2,r=r||.15,n=n||16770432,i=i||3375104;const o=Ue.shared,[a,c,u]=o.setValue(n).toArray(),[d,h,p]=o.setValue(i).toArray(),f=[.3,.59,.11,0,0,a,c,u,e,0,d,h,p,r,0,a-d,c-h,u-p,0,0];this._loadMatrix(f,s)}night(e,r){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(e,r){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,r)}lsd(e){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}Sp.prototype.grayscale=Sp.prototype.greyscale;var eR=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,tR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class rR extends Rt{constructor(e,r){const n=new Ge;e.renderable=!1,super(tR,eR,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,r==null&&(r=20),this.scale=new Ie(r,r)}apply(e,r,n,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,r,n,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var nR=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,iR=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class sR extends Rt{constructor(){super(iR,nR)}}var oR=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class aR extends Rt{constructor(e=.5,r=Math.random()){super(E1,oR,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const Jx={AlphaFilter:WP,BlurFilter:QP,BlurFilterPass:wp,ColorMatrixFilter:Sp,DisplacementFilter:rR,FXAAFilter:sR,NoiseFilter:aR};Object.entries(Jx).forEach(([t,e])=>{Object.defineProperty(Jx,t,{get(){return ke("7.1.0",`filters.${t} has moved to ${t}`),e}})});class lR{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(Yt.system.add(this.tickerUpdate,this,Li.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Yt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Nn=new lR;class Ia{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Ia.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Ie,this.page=new Ie,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,n,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Ic extends Ia{constructor(){super(...arguments),this.client=new Ie,this.movement=new Ie,this.offset=new Ie,this.global=new Ie,this.screen=new Ie}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,r,n){return e.worldTransform.applyInverse(n||this.global,r)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,n,i,s,o,a,c,u,d,h,p,f,m,_){throw new Error("Method not implemented.")}}class yr extends Ic{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Ds extends Ic{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Ds.DOM_DELTA_PIXEL=0,Ds.DOM_DELTA_LINE=1,Ds.DOM_DELTA_PAGE=2;const cR=2048,uR=new Ie,Id=new Ie;class dR{constructor(e){this.dispatch=new Ca,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const r=this.mappingTable[e.type];if(r)for(let n=0,i=r.length;n<i;n++)r[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){Nn.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[n](this.rootTarget,this.rootTarget.eventMode,uR.set(e,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,r){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=n.length-1;i<s;i++)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(r)?r:[r];for(let s=n.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=n[s],this.notifyTarget(e,o)})}propagationPath(e){const r=[e];for(let n=0;n<cR&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestMoveRecursive(e,r,n,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(Nn.pauseUpdate=!1),e.interactiveChildren&&e.children){const d=e.children;for(let h=d.length-1;h>=0;h--){const p=d[h],f=this.hitTestMoveRecursive(p,this._isInteractive(r)?r:p.eventMode,n,i,s,o||s(e,n));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const m=e.isInteractive();(f.length>0||m)&&(m&&this._allInteractiveElements.push(e),f.push(e)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const c=this._isInteractive(r),u=e.isInteractive();return c&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:c&&!s(e,n)&&i(e,n)?u?[e]:[]:null}hitTestRecursive(e,r,n,i,s){if(this._interactivePrune(e)||s(e,n))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(Nn.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let u=c.length-1;u>=0;u--){const d=c[u],h=this.hitTestRecursive(d,this._isInteractive(r)?r:d.eventMode,n,i,s);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const p=e.isInteractive();return(h.length>0||p)&&h.push(e),h}}}const o=this._isInteractive(r),a=e.isInteractive();return o&&i(e,n)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,r){var n;if(e.hitArea&&(e.worldTransform.applyInverse(r,Id),!e.hitArea.contains(Id.x,Id.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,r)))return!0}return!1}hitTestFn(e,r){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){var s,o;r=r??e.type;const n=`on${r}`;(o=(s=e.currentTarget)[n])==null||o.call(s,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof yr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){var c,u;if(!(e instanceof yr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(((c=i.overTargets)==null?void 0:c.length)>0&&s!==r.target){const d=e.type==="mousemove"?"mouseout":"pointerout",h=this.createPointerEvent(e,d,s);if(this.dispatchEvent(h,"pointerout"),n&&this.dispatchEvent(h,"mouseout"),!r.composedPath().includes(s)){const p=this.createPointerEvent(e,"pointerleave",s);for(p.eventPhase=p.AT_TARGET;p.target&&!r.composedPath().includes(p.target);)p.currentTarget=p.target,this.notifyTarget(p),n&&this.notifyTarget(p,"mouseleave"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(h)}if(s!==r.target){const d=e.type==="mousemove"?"mouseover":"pointerover",h=this.clonePointerEvent(r,d);this.dispatchEvent(h,"pointerover"),n&&this.dispatchEvent(h,"mouseover");let p=s==null?void 0:s.parent;for(;p&&p!==this.rootTarget.parent&&p!==r.target;)p=p.parent;if(!p||p===this.rootTarget.parent){const f=this.clonePointerEvent(r,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==s&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),n&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(h)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),n&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=r.target)==null?void 0:u.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){var o;if(!(e instanceof yr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(o=n.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(n,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof yr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId);if(r.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),n&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof yr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const a=n.button===2;this.dispatchEvent(n,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!n.composedPath().includes(s)){let a=s;for(;a&&!n.composedPath().includes(a);){if(n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const c=n.button===2;this.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(n,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:r});const c=i.clicksByButton[e.button];if(c.target===a.target&&r-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=a.target,c.timeStamp=r,a.detail=c.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof yr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let s=n;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof Ds)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let n=1;n<e.length&&e[n].parent===r;n++)r=e[n];return r}createPointerEvent(e,r,n){const i=this.allocateEvent(yr);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof r=="string"&&(i.type=r),i}createWheelEvent(e){const r=this.allocateEvent(Ds);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){const n=this.allocateEvent(yr);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=r??n.type,n}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof yr&&r instanceof yr&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof Ic&&r instanceof Ic&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.shiftKey=e.shiftKey,r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){const n=e.currentTarget._events[r];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(r,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let i=0,s=n.length;i<s&&!e.propagationImmediatelyStopped;i++)n[i].once&&e.currentTarget.removeListener(r,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,e)}}const hR=1,pR={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},bp=class Ep{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new dR(null),Nn.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new yr(null),this.rootWheelEvent=new Ds(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Ep.defaultEventFeatures},{set:(r,n,i)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),r[n]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,Ep._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=r.length;n<i;n++){const s=r[n],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Nn.pointerMoved();const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let r=e.target;e.composedPath&&e.composedPath().length>0&&(r=e.composedPath()[0]);const n=r!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,i[s]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const r=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(e){this.removeEvents(),this.domElement=e,Nn.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Nn.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Nn.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,r,n){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(r-i.left)*(this.domElement.width/i.width)*s,e.y=(n-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){const r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const s=e.changedTouches[n];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,r.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=hR),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(e);return r}normalizeWheelEvent(e){const r=this.rootWheelEvent;return this.transferMouseData(r,e),r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ,r.deltaMode=e.deltaMode,this.mapPositionToPoint(r.screen,e.clientX,e.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=e,r.type=e.type,r}bootstrapEvent(e,r){return e.originalEvent=null,e.nativeEvent=r,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r),this.mapPositionToPoint(e.screen,r.clientX,r.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=r.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=pR[e.type]||e.type),e}transferMouseData(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=performance.now(),e.type=r.type,e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.relatedTarget=null,e.shiftKey=r.shiftKey}};bp.extension={name:"events",type:[J.RendererSystem,J.CanvasRendererSystem]},bp.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Tp=bp;ne.add(Tp);function Qx(t){return t==="dynamic"||t==="static"}const fR={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Qx(Tp.defaultEventMode)},set interactive(t){ke("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Tp.defaultEventMode},set eventMode(t){this._internalInteractive=Qx(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof r=="object"?r.signal:void 0,s=typeof r=="object"?r.once===!0:!1,o=typeof e=="function"?void 0:e;t=n?`${t}capture`:t;const a=typeof e=="function"?e:e.handleEvent,c=this;i&&i.addEventListener("abort",()=>{c.off(t,a,o)}),s?c.once(t,a,o):c.on(t,a,o)},removeEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof Ia))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};qe.mixin(fR);const mR={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};qe.mixin(mR);const gR=9,dl=100,xR=0,yR=0,Zx=2,ey=1,vR=-1e3,_R=-1e3,wR=2;class M1{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(an.tablet||an.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${dl}px`,r.style.height=`${dl}px`,r.style.position="absolute",r.style.top=`${xR}px`,r.style.left=`${yR}px`,r.style.zIndex=Zx.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${ey}px`,e.style.height=`${ey}px`,e.style.position="absolute",e.style.top=`${vR}px`,e.style.left=`${_R}px`,e.style.zIndex=wR.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const r=e.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const e=performance.now();if(an.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:c}=this.renderer,u=i/o*c,d=s/a*c;let h=this.div;h.style.left=`${r}px`,h.style.top=`${n}px`,h.style.width=`${o}px`,h.style.height=`${a}px`;for(let p=0;p<this.children.length;p++){const f=this.children[p];if(f.renderId!==this.renderId)f._accessibleActive=!1,Fs(this.children,p,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,p--;else{h=f._accessibleDiv;let m=f.hitArea;const _=f.worldTransform;f.hitArea?(h.style.left=`${(_.tx+m.x*_.a)*u}px`,h.style.top=`${(_.ty+m.y*_.d)*d}px`,h.style.width=`${m.width*_.a*u}px`,h.style.height=`${m.height*_.d*d}px`):(m=f.getBounds(),this.capHitArea(m),h.style.left=`${m.x*u}px`,h.style.top=`${m.y*d}px`,h.style.width=`${m.width*u}px`,h.style.height=`${m.height*d}px`,h.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(h.title=f.accessibleTitle),h.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&h.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==h.title||f.tabIndex!==h.tabIndex)&&(h.title=f.accessibleTitle,h.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:r,height:n}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${dl}px`,r.style.height=`${dl}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=Zx.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){const{displayObject:n}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new Ia(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===gR&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}M1.extension={name:"accessibility",type:[J.RendererPlugin,J.CanvasRendererPlugin]};ne.add(M1);const B1=class Ap{constructor(e){this.stage=new $t,e=Object.assign({forceCanvas:!1},e),this.renderer=IP(e),Ap._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,r){const n=Ap._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};B1._plugins=[];let N1=B1;ne.handleByList(J.Application,N1._plugins);class F1{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;r=i,n=s}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}F1.extension=J.Application;ne.add(F1);const ty={loader:J.LoadParser,resolver:J.ResolveParser,cache:J.CacheParser,detection:J.DetectionParser};ne.handle(J.Asset,t=>{const e=t.ref;Object.entries(ty).filter(([r])=>!!e[r]).forEach(([r,n])=>ne.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(ty).filter(r=>!!e[r]).forEach(r=>ne.remove(e[r]))});class SR{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function ro(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function ai(t,e){const r=t.split("?")[0],n=mt.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const Sr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t),Cp=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t};function L1(t,e,r,n,i){const s=e[r];for(let o=0;o<s.length;o++){const a=s[o];r<e.length-1?L1(t.replace(n[r],a),e,r+1,n,i):i.push(t.replace(n[r],a))}}function bR(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const i=[];r.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),L1(t,i,0,r,n)}else n.push(t);return n}const jc=t=>!Array.isArray(t);class ER{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=Sr(e);let i;for(let a=0;a<this.parsers.length;a++){const c=this.parsers[a];if(c.test(r)){i=c.getCacheableAssets(n,r);break}}i||(i={},n.forEach(a=>{i[a]=r}));const s=Object.keys(i),o={cacheKeys:s,keys:n};if(n.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{const c=i?i[a]:r;this._cache.has(a)&&this._cache.get(a)!==c&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),r instanceof re){const a=r;n.forEach(c=>{a.baseTexture!==re.EMPTY.baseTexture&&ve.addToCache(a.baseTexture,c),re.addToCache(a,c)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const wi=new ER;class TR{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{var o,a;let i=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!s){for(let c=0;c<this.parsers.length;c++){const u=this.parsers[c];if(u.load&&((o=u.test)!=null&&o.call(u,e,r,this))){s=u;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,r,this),n.parser=s;for(let c=0;c<this.parsers.length;c++){const u=this.parsers[c];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,i,r,this))&&(i=await u.parse(i,r,this)||i,n.parser=u)}return i})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const i={},s=jc(e),o=Sr(e,u=>({alias:[u],src:u})),a=o.length,c=o.map(async u=>{const d=mt.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,u)),i[u.src]=await this.promiseCache[d].promise,r&&r(++n/a)}catch(h){throw delete this.promiseCache[d],delete i[u.src],new Error(`[Loader.load] Failed to load ${d}.
${h}`)}});return await Promise.all(c),s?i[o[0].src]:i}async unload(e){const r=Sr(e,n=>({alias:[n],src:n})).map(async n=>{var o,a;const i=mt.toAbsolute(n.src),s=this.promiseCache[i];if(s){const c=await s.promise;delete this.promiseCache[i],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,c,n,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(e[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...e,[r.name]:r}),{})}}var kr=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(kr||{});const AR=".json",CR="application/json",kR={extension:{type:J.LoadParser,priority:kr.Low},name:"loadJson",test(t){return ro(t,CR)||ai(t,AR)},async load(t){return await(await Z.ADAPTER.fetch(t)).json()}};ne.add(kR);const PR=".txt",RR="text/plain",IR={name:"loadTxt",extension:{type:J.LoadParser,priority:kr.Low},test(t){return ro(t,RR)||ai(t,PR)},async load(t){return await(await Z.ADAPTER.fetch(t)).text()}};ne.add(IR);const jR=["normal","bold","100","200","300","400","500","600","700","800","900"],MR=[".ttf",".otf",".woff",".woff2"],BR=["font/ttf","font/otf","font/woff","font/woff2"],NR=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function FR(t){const e=mt.extname(t),r=mt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let n=r.length>0;for(const s of r)if(!s.match(NR)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const LR=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function DR(t){return LR.test(t)?t:encodeURI(t)}const OR={extension:{type:J.LoadParser,priority:kr.Low},name:"loadWebFont",test(t){return ro(t,BR)||ai(t,MR)},async load(t,e){var n,i,s;const r=Z.ADAPTER.getFontFaceSet();if(r){const o=[],a=((n=e.data)==null?void 0:n.family)??FR(t),c=((s=(i=e.data)==null?void 0:i.weights)==null?void 0:s.filter(d=>jR.includes(d)))??["normal"],u=e.data??{};for(let d=0;d<c.length;d++){const h=c[d],p=new FontFace(a,`url(${DR(t)})`,{...u,weight:h});await p.load(),r.add(p),o.push(p)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>Z.ADAPTER.getFontFaceSet().delete(e))}};ne.add(OR);const UR=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Os=null,kp=class{constructor(){Os||(Os=URL.createObjectURL(new Blob([UR],{type:"application/javascript"}))),this.worker=new Worker(Os)}};kp.revokeObjectURL=function(){Os&&(URL.revokeObjectURL(Os),Os=null)};const zR=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Us=null;class D1{constructor(){Us||(Us=URL.createObjectURL(new Blob([zR],{type:"application/javascript"}))),this.worker=new Worker(Us)}}D1.revokeObjectURL=function(){Us&&(URL.revokeObjectURL(Us),Us=null)};let ry=0,jd;class GR{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new kp;r.addEventListener("message",n=>{r.terminate(),kp.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){jd===void 0&&(jd=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<jd&&(this._createdWorkers++,e=new D1().worker,e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((i,s)=>{this.queue.push({id:e,arguments:r,resolve:i,reject:s})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const r=this.queue.pop(),n=r.id;this.resolveHash[ry]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:ry++,id:n})}}const ny=new GR;function ja(t,e,r){t.resource.internal=!0;const n=new re(t),i=()=>{delete e.promiseCache[r],wi.has(r)&&wi.remove(r)};return n.baseTexture.once("destroyed",()=>{r in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),n.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const HR=[".jpeg",".jpg",".png",".webp",".avif"],$R=["image/jpeg","image/png","image/webp","image/avif"];async function VR(t){const e=await Z.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}const pu={name:"loadTextures",extension:{type:J.LoadParser,priority:kr.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return ro(t,$R)||ai(t,HR)},async load(t,e,r){var a;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;n?this.config.preferWorkers&&await ny.isImageBitmapSupported()?i=await ny.loadImageBitmap(t):i=await VR(t):i=await new Promise((c,u)=>{const d=new Image;d.crossOrigin=this.config.crossOrigin,d.src=t,d.complete?c(d):(d.onload=()=>c(d),d.onerror=h=>u(h))});const s={...e.data};s.resolution??(s.resolution=gn(t)),n&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new ve(i,s);return o.resource.src=t,ja(o,r,t)},unload(t){t.destroy(!0)}};ne.add(pu);const WR=".svg",XR="image/svg+xml",YR={extension:{type:J.LoadParser,priority:kr.High},name:"loadSVG",test(t){return ro(t,XR)||ai(t,WR)},async testParse(t){return xp.test(t)},async parse(t,e,r){var s;const n=new xp(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await n.load();const i=new ve(n,{resolution:gn(t),...e==null?void 0:e.data});return i.resource.src=e.src,ja(i,r,e.src)},async load(t,e){return(await Z.ADAPTER.fetch(t)).text()},unload:pu.unload};ne.add(YR);const KR=[".mp4",".m4v",".webm",".ogv"],qR=["video/mp4","video/webm","video/ogg"],JR={name:"loadVideo",extension:{type:J.LoadParser,priority:kr.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return ro(t,qR)||ai(t,KR)},async load(t,e,r){var o;let n;const i=await(await Z.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},c=new R1(s,a);await c.load();const u=new ve(c,{alphaMode:await nk(),resolution:gn(t),...e==null?void 0:e.data});u.resource.src=t,n=ja(u,r,t),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return n},unload(t){t.destroy(!0)}};ne.add(JR);class QR{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,name:n,src:i,srcs:s}=e;return Sr(r||n||i||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];Array.isArray(r)?r.forEach(i=>{const s=i.src??i.srcs,o=i.alias??i.name;let a;if(typeof o=="string"){const c=this._createBundleAssetId(e,o);n.push(c),a=[o,c]}else{const c=o.map(u=>this._createBundleAssetId(e,u));n.push(...c),a=[...o,...c]}this.add({...i,alias:a,src:s})}):Object.keys(r).forEach(i=>{const s=[i,this._createBundleAssetId(e,i)];if(typeof r[i]=="string")this.add({alias:s,src:r[i]});else if(Array.isArray(r[i]))this.add({alias:s,src:r[i]});else{const o=r[i],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}n.push(...s)}),this._bundles[e]=n}add(e,r,n,i,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(ke("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:r,data:n,format:i,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=c=>{this.hasKey(c)&&console.warn(`[Resolver] already has key: ${c} overwriting`)},Sr(o).forEach(c=>{const{src:u,srcs:d}=c;let{data:h,format:p,loadParser:f}=c;const m=Sr(u||d).map(x=>typeof x=="string"?bR(x):Array.isArray(x)?x:[x]),_=this.getAlias(c);Array.isArray(_)?_.forEach(a):a(_);const v=[];m.forEach(x=>{x.forEach(y=>{let g={};if(typeof y!="object"){g.src=y;for(let w=0;w<this._parsers.length;w++){const b=this._parsers[w];if(b.test(y)){g=b.parse(y);break}}}else h=y.data??h,p=y.format??p,f=y.loadParser??f,g={...g,...y};if(!_)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this.buildResolvedAsset(g,{aliases:_,data:h,format:p,loadParser:f}),v.push(g)})}),_.forEach(x=>{this._assetMap[x]=v})})}resolveBundle(e){const r=jc(e);e=Sr(e);const n={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const c in o){const u=o[c];a[this._extractAssetIdFromBundle(i,c)]=u}n[i]=a}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const i in r)n[i]=r[i].src;return n}return r.src}resolve(e){const r=jc(e);e=Sr(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(c=>{a.params[c].forEach(u=>{const d=s.filter(h=>h[c]?h[c]===u:!1);d.length&&(s=d)})}),this._resolverHash[i]=s[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}buildResolvedAsset(e,r){const{aliases:n,data:i,loadParser:s,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=mt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??mt.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class ZR{constructor(){this._detections=[],this._initialized=!1,this.resolver=new QR,this.loader=new TR,this.cache=wi,this._backgroundLoader=new SR(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const r=((s=e.texturePreference)==null?void 0:s.resolution)??1,n=typeof r=="number"?[r]:r,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e,r,n,i,s){this.resolver.add(e,r,n,i,s)}async load(e,r){this._initialized||await this.init();const n=jc(e),i=Sr(e).map(a=>{if(typeof a!="string"){const c=this.resolver.getAlias(a);return c.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(c)?c[0]:c}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,r);return n?o[i[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,c=0;const u=()=>{r==null||r(++a/c)},d=o.map(h=>{const p=i[h];return c+=Object.keys(p).length,this._mapLoadToResolve(p,u).then(f=>{s[h]=f})});return await Promise.all(d),n?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return wi.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=wi.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const o={};return n.forEach((a,c)=>{const u=s[a.src],d=[a.src];a.alias&&d.push(...a.alias),o[i[c]]=u,wi.set(d,u)}),o}async unload(e){this._initialized||await this.init();const r=Sr(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=Sr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{wi.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,i)=>r.indexOf(n)===i),r}get detections(){return this._detections}get preferWorkers(){return pu.config.preferWorkers}set preferWorkers(e){ke("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const Io=new ZR;ne.handleByList(J.LoadParser,Io.loader.parsers).handleByList(J.ResolveParser,Io.resolver.parsers).handleByList(J.CacheParser,Io.cache.parsers).handleByList(J.DetectionParser,Io.detections);const eI={extension:J.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof re),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((i,s)=>{r[n+(s===0?"":s+1)]=i})}),r}};ne.add(eI);async function O1(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const tI={extension:{type:J.DetectionParser,priority:1},test:async()=>O1("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};ne.add(tI);const rI={extension:{type:J.DetectionParser,priority:0},test:async()=>O1("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};ne.add(rI);const iy=["png","jpg","jpeg"],nI={extension:{type:J.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...iy],remove:async t=>t.filter(e=>!iy.includes(e))};ne.add(nI);const iI="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Yf(t){return iI?!1:document.createElement("video").canPlayType(t)!==""}const sI={extension:{type:J.DetectionParser,priority:0},test:async()=>Yf("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};ne.add(sI);const oI={extension:{type:J.DetectionParser,priority:0},test:async()=>Yf("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};ne.add(oI);const aI={extension:{type:J.DetectionParser,priority:0},test:async()=>Yf("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};ne.add(aI);const lI={extension:J.ResolveParser,test:pu.test,parse:t=>{var e;return{resolution:parseFloat(((e=Z.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:mt.extname(t).slice(1),src:t}}};ne.add(lI);var xt=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(xt||{});const Mc={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Br,us;function sy(){us={bptc:Br.getExtension("EXT_texture_compression_bptc"),astc:Br.getExtension("WEBGL_compressed_texture_astc"),etc:Br.getExtension("WEBGL_compressed_texture_etc"),s3tc:Br.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Br.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Br.getExtension("WEBGL_compressed_texture_pvrtc")||Br.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Br.getExtension("WEBGL_compressed_texture_etc1"),atc:Br.getExtension("WEBGL_compressed_texture_atc")}}const cI={extension:{type:J.DetectionParser,priority:2},test:async()=>{const t=Z.ADAPTER.createCanvas().getContext("webgl");return t?(Br=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{us||sy();const e=[];for(const r in us)us[r]&&e.push(r);return[...e,...t]},remove:async t=>(us||sy(),t.filter(e=>!(e in us)))};ne.add(cI);class uI extends lu{constructor(e,r={width:1,height:1,autoLoad:!0}){let n,i;typeof e=="string"?(n=e,i=new Uint8Array):(n=null,i=e),super(i,r),this.origin=n,this.buffer=i?new ip(i):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new ip(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class Pi extends uI{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=Pi._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||Pi._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,n){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:c,levelHeight:u,levelBuffer:d}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,c,u,0,d)}return!0}onBlobLoaded(){this._levelBuffers=Pi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,r,n,i,s,o,a){const c=new Array(n);let u=e.byteOffset,d=o,h=a,p=d+i-1&~(i-1),f=h+s-1&~(s-1),m=p*f*Mc[r];for(let _=0;_<n;_++)c[_]={levelID:_,levelWidth:n>1?d:p,levelHeight:n>1?h:f,levelBuffer:new Uint8Array(e.buffer,u,m)},u+=m,d=d>>1||1,h=h>>1||1,p=d+i-1&~(i-1),f=h+s-1&~(s-1),m=p*f*Mc[r];return c}}const Md=4,hl=124,dI=32,oy=20,hI=542327876,pl={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},pI={FOURCC:2},fl={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},fI=1,mI=2,gI=4,xI=64,yI=512,vI=131072,_I=827611204,wI=861165636,SI=894720068,bI=808540228,EI=4,TI={[_I]:xt.COMPRESSED_RGBA_S3TC_DXT1_EXT,[wI]:xt.COMPRESSED_RGBA_S3TC_DXT3_EXT,[SI]:xt.COMPRESSED_RGBA_S3TC_DXT5_EXT},AI={70:xt.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:xt.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:xt.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:xt.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:xt.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:xt.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:xt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:xt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:xt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:xt.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:xt.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:xt.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:xt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function CI(t){const e=new Uint32Array(t);if(e[0]!==hI)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,hl/Uint32Array.BYTES_PER_ELEMENT),n=r[pl.HEIGHT],i=r[pl.WIDTH],s=r[pl.MIPMAP_COUNT],o=new Uint32Array(t,pl.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,dI/Uint32Array.BYTES_PER_ELEMENT),a=o[fI];if(a&gI){const c=o[pI.FOURCC];if(c!==bI){const y=TI[c],g=Md+hl,w=new Uint8Array(t,g);return[new Pi(w,{format:y,width:i,height:n,levels:s})]}const u=Md+hl,d=new Uint32Array(e.buffer,u,oy/Uint32Array.BYTES_PER_ELEMENT),h=d[fl.DXGI_FORMAT],p=d[fl.RESOURCE_DIMENSION],f=d[fl.MISC_FLAG],m=d[fl.ARRAY_SIZE],_=AI[h];if(_===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(f===EI)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");const v=new Array,x=Md+hl+oy;if(m===1)v.push(new Uint8Array(t,x));else{const y=Mc[_];let g=0,w=i,b=n;for(let C=0;C<s;C++){const E=Math.max(1,w+3&-4),M=Math.max(1,b+3&-4),B=E*M*y;g+=B,w=w>>>1,b=b>>>1}let P=x;for(let C=0;C<m;C++)v.push(new Uint8Array(t,P,g)),P+=g}return v.map(y=>new Pi(y,{format:_,width:i,height:n,levels:s}))}throw a&xI?new Error("DDSParser does not support uncompressed texture data."):a&yI?new Error("DDSParser does not supported YUV uncompressed texture data."):a&vI?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&mI?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const ay=[171,75,84,88,32,49,49,187,13,10,26,10],kI=67305985,gr={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Pp=64,ly={[le.UNSIGNED_BYTE]:1,[le.UNSIGNED_SHORT]:2,[le.INT]:4,[le.UNSIGNED_INT]:4,[le.FLOAT]:4,[le.HALF_FLOAT]:8},PI={[W.RGBA]:4,[W.RGB]:3,[W.RG]:2,[W.RED]:1,[W.LUMINANCE]:1,[W.LUMINANCE_ALPHA]:2,[W.ALPHA]:1},RI={[le.UNSIGNED_SHORT_4_4_4_4]:2,[le.UNSIGNED_SHORT_5_5_5_1]:2,[le.UNSIGNED_SHORT_5_6_5]:2};function II(t,e,r=!1){const n=new DataView(e);if(!jI(t,n))return null;const i=n.getUint32(gr.ENDIANNESS,!0)===kI,s=n.getUint32(gr.GL_TYPE,i),o=n.getUint32(gr.GL_FORMAT,i),a=n.getUint32(gr.GL_INTERNAL_FORMAT,i),c=n.getUint32(gr.PIXEL_WIDTH,i),u=n.getUint32(gr.PIXEL_HEIGHT,i)||1,d=n.getUint32(gr.PIXEL_DEPTH,i)||1,h=n.getUint32(gr.NUMBER_OF_ARRAY_ELEMENTS,i)||1,p=n.getUint32(gr.NUMBER_OF_FACES,i),f=n.getUint32(gr.NUMBER_OF_MIPMAP_LEVELS,i),m=n.getUint32(gr.BYTES_OF_KEY_VALUE_DATA,i);if(u===0||d!==1)throw new Error("Only 2D textures are supported");if(p!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");const _=4,v=4,x=c+3&-4,y=u+3&-4,g=new Array(h);let w=c*u;s===0&&(w=x*y);let b;if(s!==0?ly[s]?b=ly[s]*PI[o]:b=RI[s]:b=Mc[a],b===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const P=r?BI(n,m,i):null;let C=w*b,E=c,M=u,B=x,N=y,D=Pp+m;for(let k=0;k<f;k++){const L=n.getUint32(D,i);let U=D+4;for(let R=0;R<h;R++){let F=g[R];F||(F=g[R]=new Array(f)),F[k]={levelID:k,levelWidth:f>1||s!==0?E:B,levelHeight:f>1||s!==0?M:N,levelBuffer:new Uint8Array(e,U,C)},U+=C}D+=L+4,D=D%4!==0?D+4-D%4:D,E=E>>1||1,M=M>>1||1,B=E+_-1&-4,N=M+v-1&-4,C=B*N*b}return s!==0?{uncompressed:g.map(k=>{let L=k[0].levelBuffer,U=!1;return s===le.FLOAT?L=new Float32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4):s===le.UNSIGNED_INT?(U=!0,L=new Uint32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)):s===le.INT&&(U=!0,L=new Int32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)),{resource:new lu(L,{width:k[0].levelWidth,height:k[0].levelHeight}),type:s,format:U?MI(o):o}}),kvData:P}:{compressed:g.map(k=>new Pi(null,{format:a,width:c,height:u,levels:f,levelBuffers:k})),kvData:P}}function jI(t,e){for(let r=0;r<ay.length;r++)if(e.getUint8(r)!==ay[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function MI(t){switch(t){case W.RGBA:return W.RGBA_INTEGER;case W.RGB:return W.RGB_INTEGER;case W.RG:return W.RG_INTEGER;case W.RED:return W.RED_INTEGER;default:return t}}function BI(t,e,r){const n=new Map;let i=0;for(;i<e;){const s=t.getUint32(Pp+i,r),o=Pp+i+4,a=3-(s+3)%4;if(s===0||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<s&&t.getUint8(o+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(t.buffer,o,c)),d=new DataView(t.buffer,o+c+1,s-c-1);n.set(u,d),i+=4+s+a}return n}const NI={extension:{type:J.LoadParser,priority:kr.High},name:"loadDDS",test(t){return ai(t,".dds")},async load(t,e,r){const n=await(await Z.ADAPTER.fetch(t)).arrayBuffer(),i=CI(n).map(s=>{const o=new ve(s,{mipmap:Xr.OFF,alphaMode:Ot.NO_PREMULTIPLIED_ALPHA,resolution:gn(t),...e.data});return ja(o,r,t)});return i.length===1?i[0]:i},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};ne.add(NI);const FI={extension:{type:J.LoadParser,priority:kr.High},name:"loadKTX",test(t){return ai(t,".ktx")},async load(t,e,r){const n=await(await Z.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=II(t,n),a=i??s,c={mipmap:Xr.OFF,alphaMode:Ot.NO_PREMULTIPLIED_ALPHA,resolution:gn(t),...e.data},u=a.map(d=>{a===s&&Object.assign(c,{type:d.type,format:d.format});const h=d.resource??d,p=new ve(h,c);return p.ktxKeyValueData=o,ja(p,r,t)});return u.length===1?u[0]:u},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};ne.add(FI);const LI=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],DI={extension:J.ResolveParser,test:t=>{const e=mt.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var n,i;const e=t.split("."),r=e.pop();if(["ktx","dds"].includes(r)){const s=e.pop();if(LI.includes(s))return{resolution:parseFloat(((n=Z.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:s,src:t}}return{resolution:parseFloat(((i=Z.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:r,src:t}}};ne.add(DI);const ml=new be,OI=4,U1=class jo{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,r,n,i){const s=new Image;return s.src=await this.base64(e,r,n,i),s}async base64(e,r,n,i){const s=this.canvas(e,i);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(c=>{if(!c){a(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>o(u.result),u.onerror=a,u.readAsDataURL(c)},r,n)});if(s.toDataURL!==void 0)return s.toDataURL(r,n);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:r,quality:n});return new Promise((a,c)=>{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=c,u.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);o&&jo._flipY(n,i,s),a&&jo._unpremultiplyAlpha(n);const c=new vk(i,s,1),u=new ImageData(new Uint8ClampedArray(n.buffer),i,s);return c.context.putImageData(u,0,0),c.canvas}pixels(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);return o&&jo._flipY(n,i,s),a&&jo._unpremultiplyAlpha(n),n}_rawPixels(e,r){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let i,s=!1,o=!1,a,c=!1;e&&(e instanceof Wi?a=e:(a=n.generateTexture(e,{region:r,resolution:n.resolution,multisample:n.multisample}),c=!0,r&&(ml.width=r.width,ml.height=r.height,r=ml)));const u=n.gl;if(a){if(i=a.baseTexture.resolution,r=r??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===W.RGBA,!c){n.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[n.CONTEXT_UID];f.blitFramebuffer&&n.framebuffer.bind(f.blitFramebuffer)}}else i=n.resolution,r||(r=ml,r.width=n.width/i,r.height=n.height/i),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const d=Math.max(Math.round(r.width*i),1),h=Math.max(Math.round(r.height*i),1),p=new Uint8Array(OI*d*h);return u.readPixels(Math.round(r.x*i),Math.round(r.y*i),d,h,u.RGBA,u.UNSIGNED_BYTE,p),c&&(a==null||a.destroy(!0)),{pixels:p,width:d,height:h,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,r,n){const i=r<<2,s=n>>1,o=new Uint8Array(i);for(let a=0;a<s;a++){const c=a*i,u=(n-a-1)*i;o.set(e.subarray(c,c+i)),e.copyWithin(c,u,u+i),e.set(o,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const r=e.length;for(let n=0;n<r;n+=4){const i=e[n+3];if(i!==0){const s=255.001/i;e[n]=e[n]*s+.5,e[n+1]=e[n+1]*s+.5,e[n+2]=e[n+2]*s+.5}}}};U1.extension={name:"extract",type:J.RendererSystem};let UI=U1;ne.add(UI);const Bc={build(t){const e=t.points;let r,n,i,s,o,a;if(t.type===vt.CIRC){const m=t.shape;r=m.x,n=m.y,o=a=m.radius,i=s=0}else if(t.type===vt.ELIP){const m=t.shape;r=m.x,n=m.y,o=m.width,a=m.height,i=s=0}else{const m=t.shape,_=m.width/2,v=m.height/2;r=m.x+_,n=m.y+v,o=a=Math.max(0,Math.min(m.radius,Math.min(_,v))),i=_-o,s=v-a}if(!(o>=0&&a>=0&&i>=0&&s>=0)){e.length=0;return}const c=Math.ceil(2.3*Math.sqrt(o+a)),u=c*8+(i?4:0)+(s?4:0);if(e.length=u,u===0)return;if(c===0){e.length=8,e[0]=e[6]=r+i,e[1]=e[3]=n+s,e[2]=e[4]=r-i,e[5]=e[7]=n-s;return}let d=0,h=c*4+(i?2:0)+2,p=h,f=u;{const m=i+o,_=s,v=r+m,x=r-m,y=n+_;if(e[d++]=v,e[d++]=y,e[--h]=y,e[--h]=x,s){const g=n-_;e[p++]=x,e[p++]=g,e[--f]=g,e[--f]=v}}for(let m=1;m<c;m++){const _=Math.PI/2*(m/c),v=i+Math.cos(_)*o,x=s+Math.sin(_)*a,y=r+v,g=r-v,w=n+x,b=n-x;e[d++]=y,e[d++]=w,e[--h]=w,e[--h]=g,e[p++]=g,e[p++]=b,e[--f]=b,e[--f]=y}{const m=i,_=s+a,v=r+m,x=r-m,y=n+_,g=n-_;e[d++]=v,e[d++]=y,e[--f]=g,e[--f]=v,i&&(e[d++]=x,e[d++]=y,e[--f]=g,e[--f]=x)}},triangulate(t,e){const r=t.points,n=e.points,i=e.indices;if(r.length===0)return;let s=n.length/2;const o=s;let a,c;if(t.type!==vt.RREC){const d=t.shape;a=d.x,c=d.y}else{const d=t.shape;a=d.x+d.width/2,c=d.y+d.height/2}const u=t.matrix;n.push(t.matrix?u.a*a+u.c*c+u.tx:a,t.matrix?u.b*a+u.d*c+u.ty:c),s++,n.push(r[0],r[1]);for(let d=2;d<r.length;d+=2)n.push(r[d],r[d+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function cy(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let i=0,s=t[r-2],o=t[r-1];i<r;i+=2){const a=t[i],c=t[i+1];n+=(a-s)*(c+o),s=a,o=c}if(!e&&n>0||e&&n<=0){const i=r/2;for(let s=i+i%2;s<r;s+=2){const o=r-s-2,a=r-s-1,c=s,u=s+1;[t[o],t[c]]=[t[c],t[o]],[t[a],t[u]]=[t[u],t[a]]}}}const z1={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const n=t.holes,i=e.points,s=e.indices;if(r.length>=6){cy(r,!1);const o=[];for(let u=0;u<n.length;u++){const d=n[u];cy(d.points,!0),o.push(r.length/2),r=r.concat(d.points)}const a=KT(r,o,2);if(!a)return;const c=i.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+c),s.push(a[u+1]+c),s.push(a[u+2]+c);for(let u=0;u<r.length;u++)i.push(r[u])}}},zI={build(t){const e=t.shape,r=e.x,n=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(r,n,r+i,n,r+i,n+s,r,n+s)},triangulate(t,e){const r=t.points,n=e.points;if(r.length===0)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},GI={build(t){Bc.build(t)},triangulate(t,e){Bc.triangulate(t,e)}};var rr=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(rr||{}),zn=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(zn||{});const qs={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class uy{static curveTo(e,r,n,i,s,o){const a=o[o.length-2],c=o[o.length-1]-r,u=a-e,d=i-r,h=n-e,p=Math.abs(c*h-u*d);if(p<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==r)&&o.push(e,r),null;const f=c*c+u*u,m=d*d+h*h,_=c*d+u*h,v=s*Math.sqrt(f)/p,x=s*Math.sqrt(m)/p,y=v*_/f,g=x*_/m,w=v*h+x*u,b=v*d+x*c,P=u*(x+y),C=c*(x+y),E=h*(v+g),M=d*(v+g),B=Math.atan2(C-b,P-w),N=Math.atan2(M-b,E-w);return{cx:w+e,cy:b+r,radius:s,startAngle:B,endAngle:N,anticlockwise:u*d>h*c}}static arc(e,r,n,i,s,o,a,c,u){const d=a-o,h=qs._segmentsCount(Math.abs(d)*s,Math.ceil(Math.abs(d)/Tc)*40),p=d/(h*2),f=p*2,m=Math.cos(p),_=Math.sin(p),v=h-1,x=v%1/v;for(let y=0;y<=v;++y){const g=y+x*y,w=p+o+f*g,b=Math.cos(w),P=-Math.sin(w);u.push((m*b+_*P)*s+n,(m*-P+_*b)*s+i)}}}class HI{constructor(){this.reset()}begin(e,r,n){this.reset(),this.style=e,this.start=r,this.attribStart=n}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Kf{static curveLength(e,r,n,i,s,o,a,c){let u=0,d=0,h=0,p=0,f=0,m=0,_=0,v=0,x=0,y=0,g=0,w=e,b=r;for(let P=1;P<=10;++P)d=P/10,h=d*d,p=h*d,f=1-d,m=f*f,_=m*f,v=_*e+3*m*d*n+3*f*h*s+p*a,x=_*r+3*m*d*i+3*f*h*o+p*c,y=w-v,g=b-x,w=v,b=x,u+=Math.sqrt(y*y+g*g);return u}static curveTo(e,r,n,i,s,o,a){const c=a[a.length-2],u=a[a.length-1];a.length-=2;const d=qs._segmentsCount(Kf.curveLength(c,u,e,r,n,i,s,o));let h=0,p=0,f=0,m=0,_=0;a.push(c,u);for(let v=1,x=0;v<=d;++v)x=v/d,h=1-x,p=h*h,f=p*h,m=x*x,_=m*x,a.push(f*c+3*p*x*e+3*h*m*n+_*s,f*u+3*p*x*r+3*h*m*i+_*o)}}function dy(t,e,r,n,i,s,o,a){const c=t-r*i,u=e-n*i,d=t+r*s,h=e+n*s;let p,f;o?(p=n,f=-r):(p=-n,f=r);const m=c+p,_=u+f,v=d+p,x=h+f;return a.push(m,_,v,x),2}function di(t,e,r,n,i,s,o,a){const c=r-t,u=n-e;let d=Math.atan2(c,u),h=Math.atan2(i-t,s-e);a&&d<h?d+=Math.PI*2:!a&&d>h&&(h+=Math.PI*2);let p=d;const f=h-d,m=Math.abs(f),_=Math.sqrt(c*c+u*u),v=(15*m*Math.sqrt(_)/Math.PI>>0)+1,x=f/v;if(p+=x,a){o.push(t,e,r,n);for(let y=1,g=p;y<v;y++,g+=x)o.push(t,e,t+Math.sin(g)*_,e+Math.cos(g)*_);o.push(t,e,i,s)}else{o.push(r,n,t,e);for(let y=1,g=p;y<v;y++,g+=x)o.push(t+Math.sin(g)*_,e+Math.cos(g)*_,t,e);o.push(i,s,t,e)}return v*2}function $I(t,e){const r=t.shape;let n=t.points||r.points.slice();const i=e.closePointEps;if(n.length===0)return;const s=t.lineStyle,o=new Ie(n[0],n[1]),a=new Ie(n[n.length-2],n[n.length-1]),c=r.type!==vt.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(c){n=n.slice(),u&&(n.pop(),n.pop(),a.set(n[n.length-2],n[n.length-1]));const F=(o.x+a.x)*.5,I=(a.y+o.y)*.5;n.unshift(F,I),n.push(F,I)}const d=e.points,h=n.length/2;let p=n.length;const f=d.length/2,m=s.width/2,_=m*m,v=s.miterLimit*s.miterLimit;let x=n[0],y=n[1],g=n[2],w=n[3],b=0,P=0,C=-(y-w),E=x-g,M=0,B=0,N=Math.sqrt(C*C+E*E);C/=N,E/=N,C*=m,E*=m;const D=s.alignment,k=(1-D)*2,L=D*2;c||(s.cap===zn.ROUND?p+=di(x-C*(k-L)*.5,y-E*(k-L)*.5,x-C*k,y-E*k,x+C*L,y+E*L,d,!0)+2:s.cap===zn.SQUARE&&(p+=dy(x,y,C,E,k,L,!0,d))),d.push(x-C*k,y-E*k,x+C*L,y+E*L);for(let F=1;F<h-1;++F){x=n[(F-1)*2],y=n[(F-1)*2+1],g=n[F*2],w=n[F*2+1],b=n[(F+1)*2],P=n[(F+1)*2+1],C=-(y-w),E=x-g,N=Math.sqrt(C*C+E*E),C/=N,E/=N,C*=m,E*=m,M=-(w-P),B=g-b,N=Math.sqrt(M*M+B*B),M/=N,B/=N,M*=m,B*=m;const I=g-x,j=y-w,A=g-b,T=P-w,H=I*A+j*T,X=j*A-T*I,K=X<0;if(Math.abs(X)<.001*Math.abs(H)){d.push(g-C*k,w-E*k,g+C*L,w+E*L),H>=0&&(s.join===rr.ROUND?p+=di(g,w,g-C*k,w-E*k,g-M*k,w-B*k,d,!1)+4:p+=2,d.push(g-M*L,w-B*L,g+M*k,w+B*k));continue}const Te=(-C+x)*(-E+w)-(-C+g)*(-E+y),z=(-M+b)*(-B+w)-(-M+g)*(-B+P),Y=(I*z-A*Te)/X,pe=(T*Te-j*z)/X,de=(Y-g)*(Y-g)+(pe-w)*(pe-w),q=g+(Y-g)*k,oe=w+(pe-w)*k,ye=g-(Y-g)*L,Ee=w-(pe-w)*L,we=Math.min(I*I+j*j,A*A+T*T),$e=K?k:L,et=we+$e*$e*_,O=de<=et;let te=s.join;if(te===rr.MITER&&de/_>v&&(te=rr.BEVEL),O)switch(te){case rr.MITER:{d.push(q,oe,ye,Ee);break}case rr.BEVEL:{K?d.push(q,oe,g+C*L,w+E*L,q,oe,g+M*L,w+B*L):d.push(g-C*k,w-E*k,ye,Ee,g-M*k,w-B*k,ye,Ee),p+=2;break}case rr.ROUND:{K?(d.push(q,oe,g+C*L,w+E*L),p+=di(g,w,g+C*L,w+E*L,g+M*L,w+B*L,d,!0)+4,d.push(q,oe,g+M*L,w+B*L)):(d.push(g-C*k,w-E*k,ye,Ee),p+=di(g,w,g-C*k,w-E*k,g-M*k,w-B*k,d,!1)+4,d.push(g-M*k,w-B*k,ye,Ee));break}}else{switch(d.push(g-C*k,w-E*k,g+C*L,w+E*L),te){case rr.MITER:{K?d.push(ye,Ee,ye,Ee):d.push(q,oe,q,oe),p+=2;break}case rr.ROUND:{K?p+=di(g,w,g+C*L,w+E*L,g+M*L,w+B*L,d,!0)+2:p+=di(g,w,g-C*k,w-E*k,g-M*k,w-B*k,d,!1)+2;break}}d.push(g-M*k,w-B*k,g+M*L,w+B*L),p+=2}}x=n[(h-2)*2],y=n[(h-2)*2+1],g=n[(h-1)*2],w=n[(h-1)*2+1],C=-(y-w),E=x-g,N=Math.sqrt(C*C+E*E),C/=N,E/=N,C*=m,E*=m,d.push(g-C*k,w-E*k,g+C*L,w+E*L),c||(s.cap===zn.ROUND?p+=di(g-C*(k-L)*.5,w-E*(k-L)*.5,g-C*k,w-E*k,g+C*L,w+E*L,d,!1)+2:s.cap===zn.SQUARE&&(p+=dy(g,w,C,E,k,L,!1,d)));const U=e.indices,R=qs.epsilon*qs.epsilon;for(let F=f;F<p+f-2;++F)x=d[F*2],y=d[F*2+1],g=d[(F+1)*2],w=d[(F+1)*2+1],b=d[(F+2)*2],P=d[(F+2)*2+1],!(Math.abs(x*(w-P)+g*(P-y)+b*(y-w))<R)&&U.push(F,F+1,F+2)}function VI(t,e){let r=0;const n=t.shape,i=t.points||n.points,s=n.type!==vt.POLY||n.closeStroke;if(i.length===0)return;const o=e.points,a=e.indices,c=i.length/2,u=o.length/2;let d=u;for(o.push(i[0],i[1]),r=1;r<c;r++)o.push(i[r*2],i[r*2+1]),a.push(d,d+1),d++;s&&a.push(d,u)}function hy(t,e){t.lineStyle.native?VI(t,e):$I(t,e)}class qf{static curveLength(e,r,n,i,s,o){const a=e-2*n+s,c=r-2*i+o,u=2*n-2*e,d=2*i-2*r,h=4*(a*a+c*c),p=4*(a*u+c*d),f=u*u+d*d,m=2*Math.sqrt(h+p+f),_=Math.sqrt(h),v=2*h*_,x=2*Math.sqrt(f),y=p/_;return(v*m+_*p*(m-x)+(4*f*h-p*p)*Math.log((2*_+y+m)/(y+x)))/(4*v)}static curveTo(e,r,n,i,s){const o=s[s.length-2],a=s[s.length-1],c=qs._segmentsCount(qf.curveLength(o,a,e,r,n,i));let u=0,d=0;for(let h=1;h<=c;++h){const p=h/c;u=o+(e-o)*p,d=a+(r-a)*p,s.push(u+(e+(n-e)*p-u)*p,d+(r+(i-r)*p-d)*p)}}}const Bd={[vt.POLY]:z1,[vt.CIRC]:Bc,[vt.ELIP]:Bc,[vt.RECT]:zI,[vt.RREC]:GI},py=[],gl=[];class Nc{constructor(e,r=null,n=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=r,this.matrix=i,this.type=e.type}clone(){return new Nc(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const rs=new Ie,G1=class H1 extends X_{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Rc,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),gl.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r.reset(),py.push(r)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,r=null,n=null,i=null){const s=new Nc(e,r,n,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,r=null){if(!this.graphicsData.length)return null;const n=new Nc(e,null,null,r),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const r=this.graphicsData;for(let n=0;n<r.length;++n){const i=r[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,rs):rs.copyFrom(e),i.shape.contains(rs.x,rs.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(rs.x,rs.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,r=this.graphicsData;let n=null,i=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],i=n.style);for(let c=this.shapeIndex;c<r.length;c++){this.shapeIndex++;const u=r[c],d=u.fillStyle,h=u.lineStyle;Bd[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(d.visible||h.visible)&&this.processHoles(u.holes);for(let p=0;p<2;p++){const f=p===0?d:h;if(!f.visible)continue;const m=f.texture.baseTexture,_=this.indices.length,v=this.points.length/2;m.wrapMode=Jn.REPEAT,p===0?this.processFill(u):this.processLine(u);const x=this.points.length/2-v;x!==0&&(n&&!this._compareStyles(i,f)&&(n.end(_,v),n=null),n||(n=py.pop()||new HI,n.begin(f,_,v),this.batches.push(n),i=f),this.addUvs(this.points,e,f.texture,v,x,f.matrix))}}const s=this.indices.length,o=this.points.length/2;if(n&&n.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,r){return!(!e||!r||e.texture.baseTexture!==r.texture.baseTexture||e.color+e.alpha!==r.color+r.alpha||!!e.native!=!!r.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,r=this.graphicsData.length;e<r;e++){const n=this.graphicsData[e],i=n.fillStyle,s=n.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let r=0,n=e.length;r<n;r++){const i=e[r];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<H1.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++ve._globalBatch;for(let h=0;h<this.drawCalls.length;h++)this.drawCalls[h].texArray.clear(),gl.push(this.drawCalls[h]);this.drawCalls.length=0;const r=this.colors,n=this.textureIds;let i=gl.pop();i||(i=new ap,i.texArray=new dp),i.texArray.count=0,i.start=0,i.size=0,i.type=Gr.TRIANGLES;let s=0,o=null,a=0,c=!1,u=Gr.TRIANGLES,d=0;this.drawCalls.push(i);for(let h=0;h<this.batches.length;h++){const p=this.batches[h],f=8,m=p.style,_=m.texture.baseTexture;c!==!!m.native&&(c=!!m.native,u=c?Gr.LINES:Gr.TRIANGLES,o=null,s=f,e++),o!==_&&(o=_,_._batchEnabled!==e&&(s===f&&(e++,s=0,i.size>0&&(i=gl.pop(),i||(i=new ap,i.texArray=new dp),this.drawCalls.push(i)),i.start=d,i.size=0,i.texArray.count=0,i.type=u),_.touched=1,_._batchEnabled=e,_._batchLocation=s,_.wrapMode=Jn.REPEAT,i.texArray.elements[i.texArray.count++]=_,s++)),i.size+=p.size,d+=p.size,a=_._batchLocation,this.addColors(r,m.color,m.alpha,p.attribSize,p.attribStart),this.addTextureIds(n,a,p.attribSize,p.attribStart)}ve._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,r=this.uvs,n=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let c=0;for(let u=0;u<e.length/2;u++)o[c++]=e[u*2],o[c++]=e[u*2+1],o[c++]=r[u*2],o[c++]=r[u*2+1],a[c++]=n[u],o[c++]=i[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?z1.triangulate(e,this):Bd[e.type].triangulate(e,this)}processLine(e){hy(e,this);for(let r=0;r<e.holes.length;r++)hy(e.holes[r],this)}processHoles(e){for(let r=0;r<e.length;r++){const n=e[r];Bd[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,r){for(let n=0;n<e.length/2;n++){const i=e[n*2],s=e[n*2+1];e[n*2]=r.a*i+r.c*s+r.tx,e[n*2+1]=r.b*i+r.d*s+r.ty}}addColors(e,r,n,i,s=0){const o=Ue.shared.setValue(r).toLittleEndianNumber(),a=Ue.shared.setValue(o).toPremultiplied(n);e.length=Math.max(e.length,s+i);for(let c=0;c<i;c++)e[s+c]=a}addTextureIds(e,r,n,i=0){e.length=Math.max(e.length,i+n);for(let s=0;s<n;s++)e[i+s]=r}addUvs(e,r,n,i,s,o=null){let a=0;const c=r.length,u=n.frame;for(;a<s;){let h=e[(i+a)*2],p=e[(i+a)*2+1];if(o){const f=o.a*h+o.c*p+o.tx;p=o.b*h+o.d*p+o.ty,h=f}a++,r.push(h/u.width,p/u.height)}const d=n.baseTexture;(u.width<d.width||u.height<d.height)&&this.adjustUvs(r,n,c,s)}adjustUvs(e,r,n,i){const s=r.baseTexture,o=1e-6,a=n+i*2,c=r.frame,u=c.width/s.width,d=c.height/s.height;let h=c.x/c.width,p=c.y/c.height,f=Math.floor(e[n]+o),m=Math.floor(e[n+1]+o);for(let _=n+2;_<a;_+=2)f=Math.min(f,Math.floor(e[_]+o)),m=Math.min(m,Math.floor(e[_+1]+o));h-=f,p-=m;for(let _=n;_<a;_+=2)e[_]=(e[_]+h)*u,e[_+1]=(e[_+1]+p)*d}};G1.BATCHABLE_SIZE=100;let WI=G1;class fu{constructor(){this.color=16777215,this.alpha=1,this.texture=re.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new fu;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=re.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Jf extends fu{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=zn.BUTT,this.join=rr.MITER,this.miterLimit=10}clone(){const e=new Jf;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=zn.BUTT,this.join=rr.MITER,this.miterLimit=10}}const Nd={},Rp=class Hl extends $t{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new fu,this._lineStyle=new Jf,this._matrix=null,this._holeMode=!1,this.state=Kr.for2d(),this._geometry=e||new WI,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Ue(16777215),this.blendMode=he.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Hl(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,r=0,n,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:r,alpha:n,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const r={width:0,texture:re.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:zn.BUTT,join:rr.MITER,miterLimit:10};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new ki,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new ki,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this}lineTo(e,r){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,i=n[n.length-2],s=n[n.length-1];return(i!==e||s!==r)&&n.push(e,r),this}_initCurve(e=0,r=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)}quadraticCurveTo(e,r,n,i){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),qf.curveTo(e,r,n,i,s),this}bezierCurveTo(e,r,n,i,s,o){return this._initCurve(),Kf.curveTo(e,r,n,i,s,o,this.currentPath.points),this}arcTo(e,r,n,i,s){this._initCurve(e,r);const o=this.currentPath.points,a=uy.curveTo(e,r,n,i,s,o);if(a){const{cx:c,cy:u,radius:d,startAngle:h,endAngle:p,anticlockwise:f}=a;this.arc(c,u,d,h,p,f)}return this}arc(e,r,n,i,s,o=!1){if(i===s)return this;if(!o&&s<=i?s+=Tc:o&&i<=s&&(i+=Tc),s-i===0)return this;const a=e+Math.cos(i)*n,c=r+Math.sin(i)*n,u=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const h=Math.abs(d[d.length-2]-a),p=Math.abs(d[d.length-1]-c);h<u&&p<u||d.push(a,c)}else this.moveTo(a,c),d=this.currentPath.points;return uy.arc(a,c,e,r,n,i,s,o,d),this}beginFill(e=0,r){return this.beginTextureFill({texture:re.WHITE,color:e,alpha:r})}normalizeColor(e){const r=Ue.shared.setValue(e.color??0);e.color=r.toNumber(),e.alpha??(e.alpha=r.alpha)}beginTextureFill(e){const r={texture:re.WHITE,color:16777215,matrix:null};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,r,n,i){return this.drawShape(new be(e,r,n,i))}drawRoundedRect(e,r,n,i,s){return this.drawShape(new du(e,r,n,i,s))}drawCircle(e,r,n){return this.drawShape(new cu(e,r,n))}drawEllipse(e,r,n,i){return this.drawShape(new uu(e,r,n,i))}drawPolygon(...e){let r,n=!0;const i=e[0];i.points?(n=i.closeStroke,r=i.points):Array.isArray(e[0])?r=e[0]:r=e;const s=new ki(r);return s.closeStroke=n,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===vt.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,r=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let i=0;i<n;i++){const s=e.batches[i],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),c=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),d={vertexData:a,blendMode:r,indices:u,uvs:c,_batchRGB:Ue.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=d}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let r=0,n=this.batches.length;r<n;r++){const i=this.batches[r];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const r=this._resolveDirectShader(e),n=this._geometry,i=this.worldAlpha,s=r.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,Ue.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(r),e.geometry.bind(n,r),e.state.set(this.state);for(let a=0,c=o.length;a<c;a++)this._renderDrawCallDirect(e,n.drawCalls[a])}_renderDrawCallDirect(e,r){const{texArray:n,type:i,size:s,start:o}=r,a=n.count;for(let c=0;c<a;c++)e.texture.bind(n.elements[c],c);e.geometry.draw(i,s,o)}_resolveDirectShader(e){let r=this.shader;const n=this.pluginName;if(!r){if(!Nd[n]){const{maxTextures:i}=e.plugins[n],s=new Int32Array(i);for(let c=0;c<i;c++)s[c]=c;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ge,default:Ar.from({uSamplers:s},!0)},a=e.plugins[n]._shader.program;Nd[n]=new Wr(a,o)}r=Nd[n]}return r}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:r,minY:n,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,r,n,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,Hl._TEMP_POINT),this._geometry.containsPoint(Hl._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r._tintRGB=Ue.shared.setValue(this._tintColor).multiply(r._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,c=r.ty,u=this._geometry.points,d=this.vertexData;let h=0;for(let p=0;p<u.length;p+=2){const f=u[p],m=u[p+1];d[h++]=n*f+s*m+a,d[h++]=o*m+i*f+c}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};Rp.curves=qs,Rp._TEMP_POINT=new Ie;let Kt=Rp;class XI{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const Fd=new Ie,fy=new ki,$1=class V1 extends $t{constructor(e,r,n,i=Gr.TRIANGLES){super(),this.geometry=e,this.shader=r,this.state=n||Kr.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=Z.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Gr.TRIANGLES&&r.length<V1.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const r=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const e=this.geometry.buffers[0],r=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,c=i.d,u=i.tx,d=i.ty,h=this.vertexData;for(let p=0;p<h.length/2;p++){const f=r[p*2],m=r[p*2+1];h[p*2]=s*f+a*m+u,h[p*2+1]=o*f+c*m+d}if(this._roundPixels){const p=Z.RESOLUTION;for(let f=0;f<h.length;++f)h[f]=Math.round(h[f]*p)/p}this.vertexDirty=n}calculateUvs(){const e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new XI(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Fd);const r=this.geometry.getBuffer("aVertexPosition").data,n=fy.points,i=this.geometry.getIndex().data,s=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const c=i[a]*2,u=i[a+1]*2,d=i[a+2]*2;if(n[0]=r[c],n[1]=r[c+1],n[2]=r[u],n[3]=r[u+1],n[4]=r[d],n[5]=r[d+1],fy.contains(Fd.x,Fd.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};$1.BATCHABLE_SIZE=100;let my=$1;class YI extends ti{constructor(e,r,n){super();const i=new rt(e),s=new rt(r,!0),o=new rt(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,le.FLOAT).addAttribute("aTextureCoord",s,2,!1,le.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var KI=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,qI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class gy extends Wr{constructor(e,r){const n={uSampler:e,alpha:1,uTextureMatrix:Ge.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||cn.from(qI,KI),n),this._colorDirty=!1,this.uvMatrix=new a1(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new Ue(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Ue.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class xy{constructor(e,r,n){this.geometry=new ti,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||le.FLOAT,offset:s.offset},r[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let r=0;this.indexBuffer=new rt(xk(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new rt(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new rt(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===le.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===le.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,r,n){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,r,n,s.type===le.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,n){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,r,n,s.type===le.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var JI=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,QI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class W1 extends hu{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Ge,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:le.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Wr.from(QI,JI,{}),this.state=Kr.for2d()}render(e){const r=e.children,n=e._maxSize,i=e._batchSize,s=this.renderer;let o=r.length;if(o===0)return;o>n&&!e.autoResize&&(o=n);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const c=r[0]._texture.baseTexture,u=c.alphaMode>0;this.state.blendMode=$_(e.blendMode,u),s.state.set(this.state);const d=s.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=Ue.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let p=!1;for(let f=0,m=0;f<o;f+=i,m+=1){let _=o-f;_>i&&(_=i),m>=a.length&&a.push(this._generateOneMoreBuffer(e));const v=a[m];v.uploadDynamic(r,f,_);const x=e._bufferUpdateIDs[m]||0;p=p||v._updateID<x,p&&(v._updateID=e._updateID,v.uploadStatic(r,f,_)),s.geometry.bind(v.geometry),d.drawElements(d.TRIANGLES,_*6,d.UNSIGNED_SHORT,0)}}generateBuffers(e){const r=[],n=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<n;o+=i)r.push(new xy(this.properties,s,i));return r}_generateOneMoreBuffer(e){const r=e._batchSize,n=e._properties;return new xy(this.properties,n,r)}uploadVertices(e,r,n,i,s,o){let a=0,c=0,u=0,d=0;for(let h=0;h<n;++h){const p=e[r+h],f=p._texture,m=p.scale.x,_=p.scale.y,v=f.trim,x=f.orig;v?(c=v.x-p.anchor.x*x.width,a=c+v.width,d=v.y-p.anchor.y*x.height,u=d+v.height):(a=x.width*(1-p.anchor.x),c=x.width*-p.anchor.x,u=x.height*(1-p.anchor.y),d=x.height*-p.anchor.y),i[o]=c*m,i[o+1]=d*_,i[o+s]=a*m,i[o+s+1]=d*_,i[o+s*2]=a*m,i[o+s*2+1]=u*_,i[o+s*3]=c*m,i[o+s*3+1]=u*_,o+=s*4}}uploadPosition(e,r,n,i,s,o){for(let a=0;a<n;a++){const c=e[r+a].position;i[o]=c.x,i[o+1]=c.y,i[o+s]=c.x,i[o+s+1]=c.y,i[o+s*2]=c.x,i[o+s*2+1]=c.y,i[o+s*3]=c.x,i[o+s*3+1]=c.y,o+=s*4}}uploadRotation(e,r,n,i,s,o){for(let a=0;a<n;a++){const c=e[r+a].rotation;i[o]=c,i[o+s]=c,i[o+s*2]=c,i[o+s*3]=c,o+=s*4}}uploadUvs(e,r,n,i,s,o){for(let a=0;a<n;++a){const c=e[r+a]._texture._uvs;c?(i[o]=c.x0,i[o+1]=c.y0,i[o+s]=c.x1,i[o+s+1]=c.y1,i[o+s*2]=c.x2,i[o+s*2+1]=c.y2,i[o+s*3]=c.x3,i[o+s*3+1]=c.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}}uploadTint(e,r,n,i,s,o){for(let a=0;a<n;++a){const c=e[r+a],u=Ue.shared.setValue(c._tintRGB).toPremultiplied(c.alpha,c.texture.baseTexture.alphaMode>0);i[o]=u,i[o+s]=u,i[o+s*2]=u,i[o+s*3]=u,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}W1.extension={name:"particle",type:J.RendererPlugin};ne.add(W1);var mu=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(mu||{});const xl={willReadFrequently:!0},Nr=class se{static get experimentalLetterSpacingSupported(){let e=se._experimentalLetterSpacingSupported;if(e!==void 0){const r=Z.ADAPTER.getCanvasRenderingContext2D().prototype;e=se._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,i,s,o,a,c,u){this.text=e,this.style=r,this.width=n,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=c,this.fontProperties=u}static measureText(e,r,n,i=se._canvas){n=n??r.wordWrap;const s=r.toFontString(),o=se.measureFont(s);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const a=i.getContext("2d",xl);a.font=s;const c=(n?se.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),u=new Array(c.length);let d=0;for(let m=0;m<c.length;m++){const _=se._measureText(c[m],r.letterSpacing,a);u[m]=_,d=Math.max(d,_)}let h=d+r.strokeThickness;r.dropShadow&&(h+=r.dropShadowDistance);const p=r.lineHeight||o.fontSize+r.strokeThickness;let f=Math.max(p,o.fontSize+r.strokeThickness*2)+r.leading+(c.length-1)*(p+r.leading);return r.dropShadow&&(f+=r.dropShadowDistance),new se(e,r,h,f,c,u,p+r.leading,d,o)}static _measureText(e,r,n){let i=!1;se.experimentalLetterSpacingSupported&&(se.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let s=n.measureText(e).width;return s>0&&(i?s-=r:s+=(se.graphemeSegmenter(e).length-1)*r),s}static wordWrap(e,r,n=se._canvas){const i=n.getContext("2d",xl);let s=0,o="",a="";const c=Object.create(null),{letterSpacing:u,whiteSpace:d}=r,h=se.collapseSpaces(d),p=se.collapseNewlines(d);let f=!h;const m=r.wordWrapWidth+u,_=se.tokenize(e);for(let v=0;v<_.length;v++){let x=_[v];if(se.isNewline(x)){if(!p){a+=se.addLine(o),f=!h,o="",s=0;continue}x=" "}if(h){const g=se.isBreakingSpace(x),w=se.isBreakingSpace(o[o.length-1]);if(g&&w)continue}const y=se.getFromCache(x,u,c,i);if(y>m)if(o!==""&&(a+=se.addLine(o),o="",s=0),se.canBreakWords(x,r.breakWords)){const g=se.wordWrapSplit(x);for(let w=0;w<g.length;w++){let b=g[w],P=b,C=1;for(;g[w+C];){const M=g[w+C];if(!se.canBreakChars(P,M,x,w,r.breakWords))b+=M;else break;P=M,C++}w+=C-1;const E=se.getFromCache(b,u,c,i);E+s>m&&(a+=se.addLine(o),f=!1,o="",s=0),o+=b,s+=E}}else{o.length>0&&(a+=se.addLine(o),o="",s=0);const g=v===_.length-1;a+=se.addLine(x,!g),f=!1,o="",s=0}else y+s>m&&(f=!1,a+=se.addLine(o),o="",s=0),(o.length>0||!se.isBreakingSpace(x)||f)&&(o+=x,s+=y)}return a+=se.addLine(o,!1),a}static addLine(e,r=!0){return e=se.trimRight(e),e=r?`${e}
`:e,e}static getFromCache(e,r,n,i){let s=n[e];return typeof s!="number"&&(s=se._measureText(e,r,i)+r,n[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!se.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:se._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:se._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(se.isBreakingSpace(s,o)||se.isNewline(s)){n!==""&&(r.push(n),n=""),r.push(s);continue}n+=s}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,i,s){return!0}static wordWrapSplit(e){return se.graphemeSegmenter(e)}static measureFont(e){if(se._fonts[e])return se._fonts[e];const r={ascent:0,descent:0,fontSize:0},n=se._canvas,i=se._context;i.font=e;const s=se.METRICS_STRING+se.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(se.BASELINE_SYMBOL).width);const c=Math.ceil(se.HEIGHT_MULTIPLIER*a);if(a=a*se.BASELINE_MULTIPLIER|0,o===0||c===0)return se._fonts[e]=r,r;n.width=o,n.height=c,i.fillStyle="#f00",i.fillRect(0,0,o,c),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const u=i.getImageData(0,0,o,c).data,d=u.length,h=o*4;let p=0,f=0,m=!1;for(p=0;p<a;++p){for(let _=0;_<h;_+=4)if(u[f+_]!==255){m=!0;break}if(!m)f+=h;else break}for(r.ascent=a-p,f=d-h,m=!1,p=c;p>a;--p){for(let _=0;_<h;_+=4)if(u[f+_]!==255){m=!0;break}if(!m)f-=h;else break}return r.descent=p-a,r.fontSize=r.ascent+r.descent,se._fonts[e]=r,r}static clearMetrics(e=""){e?delete se._fonts[e]:se._fonts={}}static get _canvas(){var e;if(!se.__canvas){let r;try{const n=new OffscreenCanvas(0,0);if((e=n.getContext("2d",xl))!=null&&e.measureText)return se.__canvas=n,n;r=Z.ADAPTER.createCanvas()}catch{r=Z.ADAPTER.createCanvas()}r.width=r.height=10,se.__canvas=r}return se.__canvas}static get _context(){return se.__context||(se.__context=se._canvas.getContext("2d",xl)),se.__context}};Nr.METRICS_STRING="|q",Nr.BASELINE_SYMBOL="M",Nr.BASELINE_MULTIPLIER=1.4,Nr.HEIGHT_MULTIPLIER=2,Nr.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})(),Nr.experimentalLetterSpacing=!1,Nr._fonts={},Nr._newlines=[10,13],Nr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let jn=Nr;const ZI=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],X1=class Mo{constructor(e){this.styleID=0,this.reset(),Dd(this,e,e)}clone(){const e={};return Dd(e,this,Mo.defaultStyle),new Mo(e)}reset(){Dd(this,Mo.defaultStyle,Mo.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const r=Ld(e);this._dropShadowColor!==r&&(this._dropShadowColor=r,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const r=Ld(e);this._fill!==r&&(this._fill=r,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){ej(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const r=Ld(e);this._stroke!==r&&(this._stroke=r,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let r=this.fontFamily;Array.isArray(this.fontFamily)||(r=this.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let i=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!ZI.includes(i)&&(i=`"${i}"`),r[n]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${r.join(",")}`}};X1.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:mu.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let dr=X1;function Ld(t){const e=Ue.shared,r=n=>{const i=e.setValue(n);return i.alpha===1?i.toHex():i.toRgbaString()};return Array.isArray(t)?t.map(r):r(t)}function ej(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function Dd(t,e,r){for(const n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}const tj={texture:!0,children:!1,baseTexture:!0},Y1=class Ip extends ri{constructor(e,r,n){let i=!1;n||(n=Z.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const s=re.from(n);s.orig=new be,s.trim=new be,super(s),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=Ip.defaultResolution??Z.RESOLUTION,this._autoResolution=Ip.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return jn.experimentalLetterSpacing}static set experimentalLetterSpacing(e){ke("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),jn.experimentalLetterSpacing=e}updateText(e){const r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const n=this.context,i=jn.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,a=i.lines,c=i.lineHeight,u=i.lineWidths,d=i.maxLineWidth,h=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;let p,f;const m=r.dropShadow?2:1;for(let _=0;_<m;++_){const v=r.dropShadow&&_===0,x=v?Math.ceil(Math.max(1,o)+r.padding*2):0,y=x*this._resolution;if(v){n.fillStyle="black",n.strokeStyle="black";const w=r.dropShadowColor,b=r.dropShadowBlur*this._resolution,P=r.dropShadowDistance*this._resolution;n.shadowColor=Ue.shared.setValue(w).setAlpha(r.dropShadowAlpha).toRgbaString(),n.shadowBlur=b,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*P,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*P+y}else n.fillStyle=this._generateFillStyle(r,a,i),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let g=(c-h.fontSize)/2;c-h.fontSize<0&&(g=0);for(let w=0;w<a.length;w++)p=r.strokeThickness/2,f=r.strokeThickness/2+w*c+h.ascent+g,r.align==="right"?p+=d-u[w]:r.align==="center"&&(p+=(d-u[w])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(a[w],p+r.padding,f+r.padding-x,!0),r.fill&&this.drawLetterSpacing(a[w],p+r.padding,f+r.padding-x)}this.updateTexture()}drawLetterSpacing(e,r,n,i=!1){const s=this._style.letterSpacing;let o=!1;if(jn.experimentalLetterSpacingSupported&&(jn.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(e,r,n):this.context.fillText(e,r,n);return}let a=r;const c=jn.graphemeSegmenter(e);let u=this.context.measureText(e).width,d=0;for(let h=0;h<c.length;++h){const p=c[h];i?this.context.strokeText(p,a,n):this.context.fillText(p,a,n);let f="";for(let m=h+1;m<c.length;++m)f+=c[m];d=this.context.measureText(f).width,a+=u-d+s,u=d}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=wk(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const r=this._texture,n=this._style,i=n.trim?0:n.padding,s=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-i*2,r.orig.height=r._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,r){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,r)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,r,n){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,c=this.canvas.width/this._resolution-o-a*2,u=this.canvas.height/this._resolution-o-a*2,d=i.slice(),h=e.fillGradientStops.slice();if(!h.length){const p=d.length+1;for(let f=1;f<p;++f)h.push(f/p)}if(d.unshift(i[0]),h.unshift(0),d.push(i[i.length-1]),h.push(1),e.fillGradientType===mu.LINEAR_VERTICAL){s=this.context.createLinearGradient(c/2,a,c/2,u+a);const p=n.fontProperties.fontSize+e.strokeThickness;for(let f=0;f<r.length;f++){const m=n.lineHeight*(f-1)+p,_=n.lineHeight*f;let v=_;f>0&&m>_&&(v=(_+m)/2);const x=_+p,y=n.lineHeight*(f+1);let g=x;f+1<r.length&&y<x&&(g=(x+y)/2);const w=(g-v)/u;for(let b=0;b<d.length;b++){let P=0;typeof h[b]=="number"?P=h[b]:P=b/d.length;let C=Math.min(1,Math.max(0,v/u+P*w));C=Number(C.toFixed(5)),s.addColorStop(C,d[b])}}}else{s=this.context.createLinearGradient(a,u/2,c+a,u/2);const p=d.length+1;let f=1;for(let m=0;m<d.length;m++){let _;typeof h[m]=="number"?_=h[m]:_=f/p,s.addColorStop(_,d[m]),f++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},tj,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const r=Un(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const r=Un(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof dr?this._style=e:this._style=new dr(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};Y1.defaultAutoResolution=!0;let Di=Y1;class rj{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function nj(t,e){var n;let r=!1;if((n=t==null?void 0:t._textures)!=null&&n.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof re){const s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),r=!0)}}return r}function ij(t,e){if(t.baseTexture instanceof ve){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function sj(t,e){if(t._texture&&t._texture instanceof re){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function oj(t,e){return e instanceof Di?(e.updateText(!0),!0):!1}function aj(t,e){if(e instanceof dr){const r=e.toFontString();return jn.measureFont(r),!0}return!1}function lj(t,e){if(t instanceof Di){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function cj(t,e){return t instanceof dr?(e.includes(t)||e.push(t),!0):!1}const K1=class q1{constructor(e){this.limiter=new rj(q1.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(lj),this.registerFindHook(cj),this.registerFindHook(nj),this.registerFindHook(ij),this.registerFindHook(sj),this.registerUploadHook(oj),this.registerUploadHook(aj)}upload(e){return new Promise(r=>{e&&this.add(e),this.queue.length?(this.completes.push(r),this.ticking||(this.ticking=!0,Yt.system.addOnce(this.tick,this,Li.UTILITY))):r()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let r=!1;if(e&&!e._destroyed){for(let n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),r=!0;break}}r||this.queue.shift()}if(this.queue.length)Yt.system.addOnce(this.tick,this,Li.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let r=0,n=e.length;r<n;r++)e[r]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let r=0,n=this.addHooks.length;r<n&&!this.addHooks[r](e,this.queue);r++);if(e instanceof $t)for(let r=e.children.length-1;r>=0;r--)this.add(e.children[r]);return this}destroy(){this.ticking&&Yt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};K1.uploadsPerFrame=4;let jp=K1;Object.defineProperties(Z,{UPLOADS_PER_FRAME:{get(){return jp.uploadsPerFrame},set(t){ke("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),jp.uploadsPerFrame=t}}});function J1(t,e){return e instanceof ve?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function uj(t,e){if(!(e instanceof Kt))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:n}=r;for(let i=0;i<n.length;i++){const{texture:s}=n[i].style;s&&J1(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function dj(t,e){return t instanceof Kt?(e.push(t),!0):!1}class Q1 extends jp{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(dj),this.registerUploadHook(J1),this.registerUploadHook(uj)}}Q1.extension={name:"prepare",type:J.RendererSystem};ne.add(Q1);var hj=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,pj=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,fj=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,yy=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,mj=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const yl=new Ge;class Z1 extends hu{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new n1,this.state=Kr.for2d()}contextChange(){const e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=Wr.from(yy,mj,r),this.shader=e.context.webGLVersion>1?Wr.from(pj,hj,r):Wr.from(yy,fj,r)}render(e){const r=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=n.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,n.invalidate();const a=e._texture,c=a.baseTexture,u=c.alphaMode>0,d=e.tileTransform.localTransform,h=e.uvMatrix;let p=c.isPowerOfTwo&&a.frame.width===c.width&&a.frame.height===c.height;p&&(c._glTextures[r.CONTEXT_UID]?p=c.wrapMode!==Jn.CLAMP:c.wrapMode===Jn.CLAMP&&(c.wrapMode=Jn.REPEAT));const f=p?this.simpleShader:this.shader,m=a.width,_=a.height,v=e._width,x=e._height;yl.set(d.a*m/v,d.b*m/x,d.c*_/v,d.d*_/x,d.tx/v,d.ty/x),yl.invert(),p?yl.prepend(h.mapCoord):(f.uniforms.uMapCoord=h.mapCoord.toArray(!0),f.uniforms.uClampFrame=h.uClampFrame,f.uniforms.uClampOffset=h.uClampOffset),f.uniforms.uTransform=yl.toArray(!0),f.uniforms.uColor=Ue.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,r.shader.bind(f),r.geometry.bind(n),this.state.blendMode=$_(e.blendMode,u),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Z1.extension={name:"tilingSprite",type:J.RendererPlugin};ne.add(Z1);const ew=class Bo{constructor(e,r,n){this.linkedSheets=[],(e instanceof ve||e instanceof re)&&(e={texture:e,data:r,resolutionFilename:n});const{texture:i,data:s,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=i instanceof re?i:null,this.baseTexture=i instanceof ve?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const c=this.baseTexture.resource;this.resolution=this._updateResolution(o||(c?c.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:r}=this.data.meta;let n=gn(e,null);return n===null&&(n=typeof r=="number"?r:parseFloat(r??"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Bo.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=Bo.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const i=this._frameKeys[r],s=this._frames[i],o=s.frame;if(o){let a=null,c=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,d=new be(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new be(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new be(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(c=new be(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new re(this.baseTexture,a,d,c,s.rotated?2:0,s.anchor,s.borders),re.addToCache(this.textures[i],this.cachePrefix+i.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const i=e[r][n];this.animations[r].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Bo.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Bo.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var r;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((r=this._texture)==null||r.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};ew.BATCH_SIZE=1e3;let vy=ew;const gj=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function tw(t,e,r){const n={};if(t.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[`${e.cachePrefix}${i}`]=e.textures[i]}),!r){const i=mt.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(n,tw([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return n}const xj={extension:J.Asset,cache:{test:t=>t instanceof vy,getCacheableAssets:(t,e)=>tw(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&gj.includes(n)},parse:t=>{var r;const e=t.split(".");return{resolution:parseFloat(((r=Z.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:J.LoadParser,priority:kr.Normal},async testParse(t,e){return mt.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){var d,h;const{texture:n,imageFilename:i,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=mt.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(n&&n.baseTexture)a=n;else{const p=Cp(o+(i??t.meta.image),e.src);a=(await r.load([p]))[p]}const c=new vy({texture:a.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await c.parse();const u=(d=t==null?void 0:t.meta)==null?void 0:d.related_multi_packs;if(Array.isArray(u)){const p=[];for(const m of u){if(typeof m!="string")continue;let _=o+m;(h=e.data)!=null&&h.ignoreMultiPack||(_=Cp(_,e.src),p.push(r.load({src:_,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(p);c.linkedSheets=f,f.forEach(m=>{m.linkedSheets=[c].concat(c.linkedSheets.filter(_=>_!==m))})}return c},unload(t){t.destroy(!0)}}};ne.add(xj);class Fc{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class $l{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const r=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in r){const o=r[s].match(/^[a-z]+/gm)[0],a=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(const u in a){const d=a[u].split("="),h=d[0],p=d[1].replace(/"/gm,""),f=parseFloat(p),m=isNaN(f)?p:f;c[h]=m}n[o].push(c)}const i=new Fc;return n.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),n.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),n.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),n.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),n.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),n.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class Mp{static test(e){const r=e;return typeof e!="string"&&"getElementsByTagName"in e&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const r=new Fc,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),c=e.getElementsByTagName("distanceField");for(let u=0;u<n.length;u++)r.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(let u=0;u<i.length;u++)r.common.push({lineHeight:parseInt(i[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)r.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const d=o[u];r.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)r.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<c.length;u++)r.distanceField.push({fieldType:c[u].getAttribute("fieldType"),distanceRange:parseInt(c[u].getAttribute("distanceRange"),10)});return r}}class Bp{static test(e){return typeof e=="string"&&e.includes("<font>")?Mp.test(Z.ADAPTER.parseXML(e)):!1}static parse(e){return Mp.parse(Z.ADAPTER.parseXML(e))}}const Od=[$l,Mp,Bp];function yj(t){for(let e=0;e<Od.length;e++)if(Od[e].test(t))return Od[e];return null}function vj(t,e,r,n,i,s){const o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const c=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,d=t.width/n-c-u*2,h=t.height/n-c-u*2,p=o.slice(),f=r.fillGradientStops.slice();if(!f.length){const m=p.length+1;for(let _=1;_<m;++_)f.push(_/m)}if(p.unshift(o[0]),f.unshift(0),p.push(o[o.length-1]),f.push(1),r.fillGradientType===mu.LINEAR_VERTICAL){a=e.createLinearGradient(d/2,u,d/2,h+u);let m=0;const _=(s.fontProperties.fontSize+r.strokeThickness)/h;for(let v=0;v<i.length;v++){const x=s.lineHeight*v;for(let y=0;y<p.length;y++){let g=0;typeof f[y]=="number"?g=f[y]:g=y/p.length;const w=x/h+g*_;let b=Math.max(m,w);b=Math.min(b,1),a.addColorStop(b,p[y]),m=b}}}else{a=e.createLinearGradient(u,h/2,d+u,h/2);const m=p.length+1;let _=1;for(let v=0;v<p.length;v++){let x;typeof f[v]=="number"?x=f[v]:x=_/m,a.addColorStop(x,p[v]),_++}}return a}function _j(t,e,r,n,i,s,o){const a=r.text,c=r.fontProperties;e.translate(n,i),e.scale(s,s);const u=o.strokeThickness/2,d=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=vj(t,e,o,s,[a],r),e.strokeStyle=o.stroke,o.dropShadow){const h=o.dropShadowColor,p=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor=Ue.shared.setValue(h).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=p,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,d+r.lineHeight-c.descent),o.fill&&e.fillText(a,u,d+r.lineHeight-c.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Vl(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function rw(t){return Array.from?Array.from(t):t.split("")}function wj(t){typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,c=o;a<=c;a++)e.push(String.fromCharCode(a))}else e.push(...rw(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const kn=class Fr{constructor(e,r,n){var d;const[i]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,c=gn(o.file),u={};this._ownsTextures=n,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/c,this.chars={},this.pageTextures=u;for(let h=0;h<e.page.length;h++){const{id:p,file:f}=e.page[h];u[p]=r instanceof Array?r[h]:r[f],a!=null&&a.fieldType&&a.fieldType!=="none"&&(u[p].baseTexture.alphaMode=Ot.NO_PREMULTIPLIED_ALPHA,u[p].baseTexture.mipmap=Xr.OFF)}for(let h=0;h<e.char.length;h++){const{id:p,page:f}=e.char[h];let{x:m,y:_,width:v,height:x,xoffset:y,yoffset:g,xadvance:w}=e.char[h];m/=c,_/=c,v/=c,x/=c,y/=c,g/=c,w/=c;const b=new be(m+u[f].frame.x/c,_+u[f].frame.y/c,v,x);this.chars[p]={xOffset:y,yOffset:g,xAdvance:w,kerning:{},texture:new re(u[f].baseTexture,b),page:f}}for(let h=0;h<e.kerning.length;h++){let{first:p,second:f,amount:m}=e.kerning[h];p/=c,f/=c,m/=c,this.chars[f]&&(this.chars[f].kerning[p]=m)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((d=a==null?void 0:a.fieldType)==null?void 0:d.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,r,n){let i;if(e instanceof Fc)i=e;else{const o=yj(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof re&&(r=[r]);const s=new Fr(i,r,n);return Fr.available[s.font]=s,s}static uninstall(e){const r=Fr.available[e];if(!r)throw new Error(`No font found named '${e}'`);r.destroy(),delete Fr.available[e]}static from(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:c,...u}=Object.assign({},Fr.defaultOptions,n),d=wj(i),h=r instanceof dr?r:new dr(r),p=a,f=new Fc;f.info[0]={face:h.fontFamily,size:h.fontSize},f.common[0]={lineHeight:h.fontSize};let m=0,_=0,v,x,y,g=0;const w=[];for(let P=0;P<d.length;P++){v||(v=Z.ADAPTER.createCanvas(),v.width=a,v.height=c,x=v.getContext("2d"),y=new ve(v,{resolution:o,...u}),w.push(new re(y)),f.page.push({id:w.length-1,file:""}));const C=d[P],E=jn.measureText(C,h,!1,v),M=E.width,B=Math.ceil(E.height),N=Math.ceil((h.fontStyle==="italic"?2:1)*M);if(_>=c-B*o){if(_===0)throw new Error(`[BitmapFont] textureHeight ${c}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${C}')`);--P,v=null,x=null,y=null,_=0,m=0,g=0;continue}if(g=Math.max(B+E.fontProperties.descent,g),N*o+m>=p){if(m===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${C}')`);--P,_+=g*o,_=Math.ceil(_),m=0,g=0;continue}_j(v,x,E,m,_,o,h);const D=Vl(E.text);f.char.push({id:D,page:w.length-1,x:m/o,y:_/o,width:N,height:B,xoffset:0,yoffset:0,xadvance:M-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0)}),m+=(N+2*s)*o,m=Math.ceil(m)}if(!(n!=null&&n.skipKerning))for(let P=0,C=d.length;P<C;P++){const E=d[P];for(let M=0;M<C;M++){const B=d[M],N=x.measureText(E).width,D=x.measureText(B).width,k=x.measureText(E+B).width-(N+D);k&&f.kerning.push({first:Vl(E),second:Vl(B),amount:k})}}const b=new Fr(f,w,!0);return Fr.available[e]!==void 0&&Fr.uninstall(e),Fr.available[e]=b,b}};kn.ALPHA=[["a","z"],["A","Z"]," "],kn.NUMERIC=[["0","9"]],kn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],kn.ASCII=[[" ","~"]],kn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:kn.ALPHANUMERIC},kn.available={};let Pn=kn;var Sj=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,bj=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const _y=[],wy=[],Sy=[],Ej=class nw extends $t{constructor(e,r={}){super();const{align:n,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:c}=Object.assign({},nw.styleDefaults,r);if(!Pn.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new Ue(i),this._font=void 0,this._fontName=a,this._fontSize=c,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new ln(()=>{this.dirty=!0},this,0,0),this._roundPixels=Z.ROUND_PIXELS,this.dirty=!0,this._resolution=Z.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var N;const e=Pn.available[this._fontName],r=this.fontSize,n=r/e.size,i=new Ie,s=[],o=[],a=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=rw(c),d=this._maxWidth*e.size/r,h=e.distanceFieldType==="none"?_y:wy;let p=null,f=0,m=0,_=0,v=-1,x=0,y=0,g=0,w=0;for(let D=0;D<u.length;D++){const k=u[D],L=Vl(k);if(/(?:\s)/.test(k)&&(v=D,x=f,w++),k==="\r"||k===`
`){o.push(f),a.push(-1),m=Math.max(m,f),++_,++y,i.x=0,i.y+=e.lineHeight,p=null,w=0;continue}const U=e.chars[L];if(!U)continue;p&&U.kerning[p]&&(i.x+=U.kerning[p]);const R=Sy.pop()||{texture:re.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ie};R.texture=U.texture,R.line=_,R.charCode=L,R.position.x=Math.round(i.x+U.xOffset+this._letterSpacing/2),R.position.y=Math.round(i.y+U.yOffset),R.prevSpaces=w,s.push(R),f=R.position.x+Math.max(U.xAdvance-U.xOffset,U.texture.orig.width),i.x+=U.xAdvance+this._letterSpacing,g=Math.max(g,U.yOffset+U.texture.height),p=L,v!==-1&&d>0&&i.x>d&&(++y,Fs(s,1+v-y,1+D-v),D=v,v=-1,o.push(x),a.push(s.length>0?s[s.length-1].prevSpaces:0),m=Math.max(m,x),_++,i.x=0,i.y+=e.lineHeight,p=null,w=0)}const b=u[u.length-1];b!=="\r"&&b!==`
`&&(/(?:\s)/.test(b)&&(f=x),o.push(f),m=Math.max(m,f),a.push(-1));const P=[];for(let D=0;D<=_;D++){let k=0;this._align==="right"?k=m-o[D]:this._align==="center"?k=(m-o[D])/2:this._align==="justify"&&(k=a[D]<0?0:(m-o[D])/a[D]),P.push(k)}const C=s.length,E={},M=[],B=this._activePagesMeshData;h.push(...B);for(let D=0;D<C;D++){const k=s[D].texture,L=k.baseTexture.uid;if(!E[L]){let U=h.pop();if(!U){const F=new YI;let I,j;e.distanceFieldType==="none"?(I=new gy(re.EMPTY),j=he.NORMAL):(I=new gy(re.EMPTY,{program:cn.from(bj,Sj),uniforms:{uFWidth:0}}),j=he.NORMAL_NPM);const A=new my(F,I);A.blendMode=j,U={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:A,vertices:null,uvs:null,indices:null}}U.index=0,U.indexCount=0,U.vertexCount=0,U.uvsCount=0,U.total=0;const{_textureCache:R}=this;R[L]=R[L]||new re(k.baseTexture),U.mesh.texture=R[L],U.mesh.tint=this._tintColor.value,M.push(U),E[L]=U}E[L].total++}for(let D=0;D<B.length;D++)M.includes(B[D])||this.removeChild(B[D].mesh);for(let D=0;D<M.length;D++)M[D].mesh.parent!==this&&this.addChild(M[D].mesh);this._activePagesMeshData=M;for(const D in E){const k=E[D],L=k.total;if(!(((N=k.indices)==null?void 0:N.length)>6*L)||k.vertices.length<my.BATCHABLE_SIZE*2)k.vertices=new Float32Array(4*2*L),k.uvs=new Float32Array(4*2*L),k.indices=new Uint16Array(6*L);else{const U=k.total,R=k.vertices;for(let F=U*4*2;F<R.length;F++)R[F]=0}k.mesh.size=6*L}for(let D=0;D<C;D++){const k=s[D];let L=k.position.x+P[k.line]*(this._align==="justify"?k.prevSpaces:1);this._roundPixels&&(L=Math.round(L));const U=L*n,R=k.position.y*n,F=k.texture,I=E[F.baseTexture.uid],j=F.frame,A=F._uvs,T=I.index++;I.indices[T*6+0]=0+T*4,I.indices[T*6+1]=1+T*4,I.indices[T*6+2]=2+T*4,I.indices[T*6+3]=0+T*4,I.indices[T*6+4]=2+T*4,I.indices[T*6+5]=3+T*4,I.vertices[T*8+0]=U,I.vertices[T*8+1]=R,I.vertices[T*8+2]=U+j.width*n,I.vertices[T*8+3]=R,I.vertices[T*8+4]=U+j.width*n,I.vertices[T*8+5]=R+j.height*n,I.vertices[T*8+6]=U,I.vertices[T*8+7]=R+j.height*n,I.uvs[T*8+0]=A.x0,I.uvs[T*8+1]=A.y0,I.uvs[T*8+2]=A.x1,I.uvs[T*8+3]=A.y1,I.uvs[T*8+4]=A.x2,I.uvs[T*8+5]=A.y2,I.uvs[T*8+6]=A.x3,I.uvs[T*8+7]=A.y3}this._textWidth=m*n,this._textHeight=(i.y+e.lineHeight)*n;for(const D in E){const k=E[D];if(this.anchor.x!==0||this.anchor.y!==0){let F=0;const I=this._textWidth*this.anchor.x,j=this._textHeight*this.anchor.y;for(let A=0;A<k.total;A++)k.vertices[F++]-=I,k.vertices[F++]-=j,k.vertices[F++]-=I,k.vertices[F++]-=j,k.vertices[F++]-=I,k.vertices[F++]-=j,k.vertices[F++]-=I,k.vertices[F++]-=j}this._maxLineHeight=g*n;const L=k.mesh.geometry.getBuffer("aVertexPosition"),U=k.mesh.geometry.getBuffer("aTextureCoord"),R=k.mesh.geometry.getIndex();L.data=k.vertices,U.data=k.uvs,R.data=k.indices,L.update(),U.update(),R.update()}for(let D=0;D<s.length;D++)Sy.push(s[D]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:r,distanceFieldType:n,size:i}=Pn.available[this._fontName];if(n!=="none"){const{a:s,b:o,c:a,d:c}=this.worldTransform,u=Math.sqrt(s*s+o*o),d=Math.sqrt(a*a+c*c),h=(Math.abs(u)+Math.abs(d))/2,p=this.fontSize/i,f=e._view.resolution;for(const m of this._activePagesMeshData)m.mesh.shader.uniforms.uFWidth=h*r*p*f}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=Pn.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Pn.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Pn.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:r}=this,n=Pn.available[this._fontName].distanceFieldType==="none"?_y:wy;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>r[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=re.EMPTY});for(const i in r)r[i].destroy(),delete r[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};Ej.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const Tj=[".xml",".fnt"],Aj={extension:{type:J.LoadParser,priority:kr.Normal},name:"loadBitmapFont",test(t){return Tj.includes(mt.extname(t).toLowerCase())},async testParse(t){return $l.test(t)||Bp.test(t)},async parse(t,e,r){const n=$l.test(t)?$l.parse(t):Bp.parse(t),{src:i}=e,{page:s}=n,o=[];for(let u=0;u<s.length;++u){const d=s[u].file;let h=mt.join(mt.dirname(i),d);h=Cp(h,i),o.push(h)}const a=await r.load(o),c=o.map(u=>a[u]);return Pn.install(n,c,!0)},async load(t,e){return(await Z.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};ne.add(Aj);const Np=class ds extends dr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new ds(Object.keys(ds.defaultOptions).reduce((r,n)=>({...r,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete ds.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,r={}){const{availableFonts:n}=ds;if(n[e]){const i=n[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return Z.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,o)=>{const a=URL.createObjectURL(i),c=new FileReader;c.onload=()=>s([a,c.result]),c.onerror=o,c.readAsDataURL(i)})).then(async([i,s])=>{const o=Object.assign({family:mt.basename(e,mt.extname(e)),weight:"normal",style:"normal",display:"auto",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},r);n[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const r=e.filter(n=>!this._overrides.includes(n));r.length>0&&(this._overrides.push(...r),this.styleID++)}removeOverride(...e){const r=e.filter(n=>this._overrides.includes(n));r.length>0&&(this._overrides=this._overrides.filter(n=>!r.includes(n)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,r)=>`${e}
            @font-face {
                font-family: "${r.family}";
                src: url('${r.dataSrc}');
                font-weight: ${r.weight};
                font-style: ${r.style};
                font-display: ${r.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=mk(e)),typeof e=="number"?fk(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const r=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&r<1&&(e+=(r*255|0).toString(16).padStart(2,"0"));const s=`${n}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,ds.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(r=>setTimeout(r,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=Z.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};Np.availableFonts={},Np.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Ud=Np;const vl=class hs extends ri{constructor(e="",r={}){super(re.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,i=re.from(n,{scaleMode:Z.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new be,i.trim=new be,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),c=document.createElementNS(s,"foreignObject"),u=document.createElementNS(o,"div"),d=document.createElementNS(o,"style");c.setAttribute("width","10000"),c.setAttribute("height","10000"),c.style.overflow="hidden",a.appendChild(c),this.maxWidth=hs.defaultMaxWidth,this.maxHeight=hs.defaultMaxHeight,this._domElement=u,this._styleElement=d,this._svgRoot=a,this._foreignObject=c,this._foreignObject.appendChild(d),this._foreignObject.appendChild(u),this._image=n,this._loadImage=new Image,this._autoResolution=hs.defaultAutoResolution,this._resolution=hs.defaultResolution??Z.RESOLUTION,this.text=e,this.style=r}measureText(e){var d,h;const{text:r,style:n,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:r,style:n.toCSS(i)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const c=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",c.toString()),this._svgRoot.setAttribute("height",u.toString()),r!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(d=this._style)==null?void 0:d.toCSS(i)}),this._styleElement.textContent=(h=this._style)==null?void 0:h.toGlobalCSS()),{width:c+n.padding*2,height:u+n.padding*2}}async updateText(e=!0){const{style:r,_image:n,_loadImage:i}=this;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();n.width=i.width=Math.ceil(Math.max(1,s)),n.height=i.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(c=>{i.onload=async()=>{if(a<this._updateID){c();return}await r.onBeforeDraw(),n.src=i.src,i.onload=null,i.src="",this.updateTexture(),c()};const u=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:r,_image:n,resolution:i}=this,{padding:s}=e,{baseTexture:o}=r;r.trim.width=r._frame.width=n.width/i,r.trim.height=r._frame.height=n.height/i,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-s*2,r.orig.height=r._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(n.width,n.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var n,i,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},hs.defaultDestroyOptions,e),super.destroy(e);const r=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=r,(i=this._svgRoot)==null||i.remove(),this._svgRoot=r,(s=this._domElement)==null||s.remove(),this._domElement=r,(o=this._foreignObject)==null||o.remove(),this._foreignObject=r,(a=this._styleElement)==null||a.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const r=Un(this.scale.x)||1;this.scale.x=r*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const r=Un(this.scale.y)||1;this.scale.y=r*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Ud?(this.ownsStyle=!1,this._style=e):e instanceof dr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ud.from(e)):(this.ownsStyle=!0,this._style=new Ud(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};vl.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},vl.defaultMaxWidth=2024,vl.defaultMaxHeight=2024,vl.defaultAutoResolution=!0;const Ut={background:1710638,surface:2960708,hitZone:16098851,laneLeft:2972199,laneRight:4886745,textMuted:10526896,perfect:5025616,partial:16098851,miss:15037299},Cj=.72,zd=85,Fp=.82,by=new Map;async function Ey(t){const e=`/${t}`,r=by.get(t);if(r)return r;const n=(async()=>{try{console.log(`[Texture] Loading: ${e}`);const i=await Io.load(e);return!i||!i.valid?(console.error(`[Texture] Invalid texture loaded: ${t}`,{fullPath:e,texture:i}),null):(console.log(`[Texture] Success: ${t}`),i)}catch(i){return console.error(`[Texture] Failed to load: ${t}`,{fullPath:e,error:i}),null}})();return by.set(t,n),n}function kj({width:t,height:e,scheduledEvents:r,activeEvents:n,roundStartTime:i,roundState:s,scrollSpeed:o,currentFeedback:a,onChannelTap:c,trainingMode:u=!1,spectrogramMode:d="full"}){const h=S.useRef(null),p=S.useRef(null),f=S.useRef(new Map),m=S.useRef(null),_=S.useCallback(v=>{var C;if(!c||!h.current)return;let x;"touches"in v?x=((C=v.touches[0])==null?void 0:C.clientX)??0:x=v.clientX;const y=h.current.getBoundingClientRect(),g=x-y.left,w=y.width/2,b=y.width*.1;if(Math.abs(g-w)<b/2)return;const P=g<w?"left":"right";c(P)},[c]);return S.useEffect(()=>{if(!h.current)return;const v=new N1({width:t,height:e,backgroundColor:Ut.background,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0});h.current.appendChild(v.view),p.current=v,Ay(v,t,e),Cy(v,t,e),ky(v,t,e);const x=new $t;return v.stage.addChild(x),m.current=x,()=>{p.current&&(p.current.destroy(!0,{children:!0}),p.current=null),f.current.clear()}},[t,e]),S.useEffect(()=>{if(p.current){p.current.renderer.resize(t,e);const v=p.current;for(;v.stage.children.length>0;)v.stage.removeChildAt(0);Ay(v,t,e),Cy(v,t,e),ky(v,t,e);const x=new $t;v.stage.addChild(x),m.current=x,f.current.clear()}},[t,e]),S.useEffect(()=>{const v=m.current;if(!v)return;if(s!=="playing"){v.removeChildren(),f.current.clear();return}if(r.length===0)return;const x=t/2,y=x*Cj,g=e*Fp;for(const w of r){if(f.current.has(w.event_id))continue;const b=Pj(w,x,y,zd,g,w.spectrogramPath,u,d);b.container.y=-zd,v.addChild(b.container),f.current.set(w.event_id,b)}},[r,s,t,e,u,d]),S.useEffect(()=>{if(s!=="playing"||!p.current)return;const v=e*Fp;let x;const y=()=>{const g=performance.now(),w=g-i;for(const b of f.current.values())if(b.hasBeenScored&&b.feedbackType){const P=g-b.feedbackStartTime;P>500&&(b.container.alpha=Math.max(0,1-(P-500)/200),b.container.alpha<=0&&(b.container.visible=!1))}else{const P=b.scheduledTimeMs-b.enterTimeMs,C=w-b.enterTimeMs,E=Math.max(0,C/P),M=-zd,B=v;if(b.container.y=M+E*(B-M),d==="fading"){const N=b.container.getChildByName("spectrogram");N&&(E<.3?N.alpha=1:E<.8?N.alpha=1-(E-.3)/.5:N.alpha=0)}b.container.y>v+100&&(b.container.alpha=Math.max(0,1-(b.container.y-v-100)/50))}x=requestAnimationFrame(y)};return x=requestAnimationFrame(y),()=>{cancelAnimationFrame(x)}},[s,i,e,o,d]),S.useEffect(()=>{var v;if(a){for(const x of n)if(x.hasBeenScored&&x.channel===a.channel){const y=f.current.get(x.event_id);y&&!y.feedbackType&&(y.hasBeenScored=!0,y.feedbackType=a.type,y.feedbackStartTime=performance.now(),((v=a.breakdown)==null?void 0:v.speciesCorrect)?(Ty(y,a.type,a.score),y.container.scale.set(1.3),setTimeout(()=>{y.container.visible=!1},400)):Ty(y,a.type,a.score))}}},[a,n]),l.jsx("div",{ref:h,className:"pixi-game-container",onClick:_,onTouchStart:_,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none"}})}function Pj(t,e,r,n,i,s,o=!1,a="full"){const c=new $t,u=t.channel==="left"?e/2:e+e/2;c.x=u;const d=t.channel==="left"?Ut.laneLeft:Ut.laneRight,h=new Kt;h.beginFill(d,.4),h.lineStyle(2,d,.8),h.drawRoundedRect(-r/2,-n/2,r,n,8),h.endFill(),c.addChild(h);const p=a!=="none"&&s;if(p&&Ey(s).then(f=>{if(f&&c.parent){const m=new ri(f);m.anchor.set(.5),m.position.set(0,0);const _=r-16,v=n-16;m.width=_,m.height=v,m.name="spectrogram",c.addChildAt(m,1),console.log(`[Sprite] Added spectrogram to tile: ${s}`)}else f?c.parent||console.warn(`[Sprite] Container removed before sprite could be added: ${s}`):console.error(`[Sprite] Texture null for: ${s}`)}),!p){const f=new Kt;for(let v=0;v<6;v++){const x=-n/2+10+v*10,y=(Math.random()*.4+.4)*r,g=-y/2+(Math.random()-.5)*20;f.beginFill(16777215,.2+Math.random()*.2),f.drawRect(g,x,y,2),f.endFill()}c.addChild(f);const m=new dr({fontFamily:"Inter, sans-serif",fontSize:18,fill:16777215,fontWeight:"700"}),_=new Di("?",m);_.anchor.set(.5),_.position.set(0,0),_.alpha=.4,c.addChild(_)}if(o){const f=new dr({fontFamily:"Inter, sans-serif",fontSize:10,fill:16777215,fontWeight:"700"}),m=new Di(t.species_code,f);m.anchor.set(.5),m.position.set(r/2-20,-n/2+44),m.alpha=.8;const _=new Kt;_.beginFill(0,.7);const v=3,x=m.width+v*2,y=m.height+v*2;_.drawRoundedRect(-x/2,-y/2,x,y,2),_.endFill(),_.position.set(m.position.x,m.position.y),c.addChild(_),c.addChild(m);const g=`data/icons/${t.species_code}.png`;Ey(g).then(w=>{if(w&&c.parent){const b=new ri(w);b.anchor.set(.5),b.width=32,b.height=32,b.position.set(r/2-20,-n/2+20),b.alpha=.9,c.addChild(b)}})}return{container:c,eventId:t.event_id,scheduledTimeMs:t.scheduled_time_ms,enterTimeMs:t.scoring_window_start_ms,channel:t.channel,speciesCode:t.species_code,hasBeenScored:!1,feedbackType:null,feedbackStartTime:0,spectrogramPath:s}}function Ty(t,e,r){const n=t.container,i=e==="perfect"||e==="good"?Ut.perfect:e==="partial"?Ut.partial:Ut.miss,s=new Kt,o=100,a=70;if(s.beginFill(i,.5),s.drawRoundedRect(-o/2,-a/2,o,a,8),s.endFill(),n.addChildAt(s,1),r>0){const c=new dr({fontFamily:"JetBrains Mono, monospace",fontSize:20,fontWeight:"700",fill:i,stroke:0,strokeThickness:3}),u=new Di(`+${r}`,c);u.anchor.set(.5),u.position.set(0,-a/2-15),n.addChild(u)}n.scale.set(1.1),setTimeout(()=>{n.scale.set(1)},100)}function Ay(t,e,r){const n=e/2,i=new Kt;i.beginFill(Ut.background,1),i.drawRect(0,0,n-1,r),i.endFill(),t.stage.addChild(i);const s=new Kt;s.beginFill(Ut.background,1),s.drawRect(n+1,0,n-1,r),s.endFill(),t.stage.addChild(s);const o=new dr({fontFamily:"Inter, sans-serif",fontSize:14,fill:Ut.textMuted,fontWeight:"600"}),a=new Di("LEFT",o);a.anchor.set(.5),a.position.set(n/2,30),a.alpha=.5,t.stage.addChild(a);const c=new Di("RIGHT",o);c.anchor.set(.5),c.position.set(n+n/2,30),c.alpha=.5,t.stage.addChild(c)}function Cy(t,e,r){const n=e/2,i=r*Fp,s=4,o=new Kt;o.beginFill(Ut.hitZone,.8),o.drawRect(20,i,n-40,s),o.endFill(),t.stage.addChild(o);const a=new Kt;a.beginFill(Ut.hitZone,.8),a.drawRect(n+20,i,n-40,s),a.endFill(),t.stage.addChild(a);const c=new Kt;c.beginFill(Ut.hitZone,.2),c.drawRect(20,i-2,n-40,s+4),c.endFill(),t.stage.addChild(c);const u=new Kt;u.beginFill(Ut.hitZone,.2),u.drawRect(n+20,i-2,n-40,s+4),u.endFill(),t.stage.addChild(u)}function ky(t,e,r){const n=e/2,i=new Kt,s=20,o=10;let a=0;for(i.beginFill(Ut.surface,.5);a<r;)i.drawRect(n-1,a,2,s),a+=s+o;i.endFill(),t.stage.addChild(i)}const Rj=S.memo(kj),An={SPECIES_CORRECT:50,CHANNEL_CORRECT:25,TIMING_PERFECT:25,TIMING_PARTIAL:10};class Ij{constructor(e){bn(this,"panner");this.panner=e.createStereoPanner()}get output(){return this.panner}setPan(e){this.panner.pan.value=Math.max(-1,Math.min(1,e))}disconnect(){this.panner.disconnect()}}class Py{constructor(e){bn(this,"ctx");bn(this,"inputGain");bn(this,"leftGain");bn(this,"rightGain");bn(this,"merger");this.ctx=e,this.inputGain=e.createGain(),this.leftGain=e.createGain(),this.rightGain=e.createGain(),this.merger=e.createChannelMerger(2),this.inputGain.connect(this.leftGain),this.inputGain.connect(this.rightGain),this.leftGain.connect(this.merger,0,0),this.rightGain.connect(this.merger,0,1),this.setPan(0)}get output(){return this.inputGain}get destination(){return this.merger}setPan(e){const n=(Math.max(-1,Math.min(1,e))+1)*Math.PI/4,i=Math.cos(n),s=Math.sin(n);this.leftGain.gain.setValueAtTime(i,this.ctx.currentTime),this.rightGain.gain.setValueAtTime(s,this.ctx.currentTime)}disconnect(){this.inputGain.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.merger.disconnect()}}class jj{constructor(){bn(this,"capabilities");this.capabilities=this.detectCapabilities(),console.log("Audio capabilities:",this.capabilities)}detectCapabilities(){const e=navigator.userAgent,r=/iPad|iPhone|iPod/.test(e)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,n=r&&/CriOS/.test(e),i=r&&/FxiOS/.test(e),s=r&&/EdgiOS/.test(e),o=typeof AudioContext<"u"||typeof window.webkitAudioContext<"u",a=o&&typeof StereoPannerNode<"u"&&!n&&!i&&!s;return{supportsStereoPanner:a,supportsWebAudio:o,isIOSChrome:n,isIOS:r,browserInfo:`iOS: ${r}, Chrome: ${n}, StereoPanner: ${a}`}}getCapabilities(){return{...this.capabilities}}supportsStereoPanner(){return this.capabilities.supportsStereoPanner}isIOSChrome(){return this.capabilities.isIOSChrome}createPanner(e){return this.capabilities.supportsStereoPanner?new Ij(e):new Py(e)}createChannelPanner(e,r){const n=this.createPanner(e);return n.setPan(r==="left"?-1:1),n}connectPannerToDestination(e,r){e instanceof Py?e.destination.connect(r):e.output.connect(r)}}let Gd=null;function Ry(){return Gd||(Gd=new jj),Gd}const Iy={low:100,medium:150,high:200},Mj={level_id:1,pack_id:"common_se_birds",mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},Bj={NOCA:"#E57373",CARW:"#81C784",BLJA:"#4FC3F7",AMCR:"#424242",TUTI:"#FFD54F",BEKI:"#00BCD4",RSHA:"#8D6E63",AMGO:"#FFEB3B",CACH:"#B0BEC5",PIWA:"#AED581",WTSP:"#BCAAA4",HOFI:"#EF9A9A",EABL:"#64B5F6",AMRO:"#FF8A65",HETH:"#D7CCC8",BHNU:"#A1887F",BRCR:"#8D6E63",WBNU:"#80CBC4",YBSA:"#FFF59D",RBWO:"#CE93D8",DOWO:"#90A4AE",HAWO:"#CFD8DC",NOFL:"#FFCC80",PIWO:"#B39DDB",BRTH:"#A1887F",GRCA:"#78909C",MODO:"#BCAAA4"};function Nj(t){let e=t;return()=>(e=e*1103515245+12345&2147483647,e/2147483647)}function Fj(t=Mj){const e=S.useRef(null),r=S.useRef(new Map),n=S.useRef(new Map),i=S.useRef(new Map),s=S.useRef(new Map),o=S.useRef(new Map),a=S.useRef(null),[c,u]=S.useState({}),d=S.useMemo(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}},[]),[h,p]=S.useState([]),[f,m]=S.useState([]),[_,v]=S.useState([]);S.useEffect(()=>{console.log("species state changed, now has",_.length,"species:",_.map(G=>G.code))},[_]),S.useEffect(()=>{fetch("/data/taxonomic_order.json").then(G=>G.json()).then(G=>{u(G)}).catch(G=>console.error("Failed to load taxonomic order:",G))},[]);const x=S.useCallback(G=>d&&Object.keys(c).length>0?[...G].sort((ce,ge)=>{const ae=c[ce.code]||9999,xe=c[ge.code]||9999;return ae-xe}):[...G].sort((ce,ge)=>ce.code.localeCompare(ge.code)),[d,c]),[y,g]=S.useState("idle"),[w,b]=S.useState(0),[P,C]=S.useState(0),[E,M]=S.useState(t.round_duration_sec),[B,N]=S.useState(0),[D,k]=S.useState(0),[L,U]=S.useState(0),[R,F]=S.useState(0),[I,j]=S.useState(0),[A,T]=S.useState([]),[H,X]=S.useState([]),[K,Te]=S.useState(0),z=S.useRef(1),Y=S.useRef(typeof window<"u"&&localStorage.getItem("soundfield_continuous_play")==="true"),[pe,de]=S.useState(0),q=5e3,[oe,ye]=S.useState(()=>{const G=Iy[t.event_density]||100,ce=localStorage.getItem("soundfield_scroll_speed"),ge=ce?parseFloat(ce):.5;return z.current=ge,G*ge}),[Ee,we]=S.useState(null),[$e,et]=S.useState(!0),O=S.useRef(null),te=S.useRef([]),fe=S.useRef(0),me=S.useRef([]),De=S.useRef(new Set),gt=S.useRef(0),Pr=S.useRef(0),Je=S.useRef(0),li=S.useRef(0),no=S.useRef(0),qr=S.useRef(0),hr=S.useRef([]),gu=S.useRef([]),Ma=S.useRef(0),vn=S.useRef(null),Bt=S.useRef(null),_n=S.useRef({left:null,right:null}),St=S.useRef({left:null,right:null}),Qf=S.useCallback(async()=>{var G;console.log("loadClips called with level:",{pack_id:t.pack_id,species_pool_length:(G=t.species_pool)==null?void 0:G.length,species_count:t.species_count});try{const ce=await fetch("/data/clips.json");if(!ce.ok)throw new Error("Failed to load clips.json");const ge=await ce.json();p(ge);const ae=t.species_pool,xe=ae?new Set(ae):null,ue=new Map;for(const _e of ge)xe&&!xe.has(_e.species_code)||ue.has(_e.species_code)||ue.set(_e.species_code,{code:_e.species_code,name:_e.common_name,color:Bj[_e.species_code]});const Ae=Array.from(ue.values());m(Ae);const Fe=sessionStorage.getItem("roundSpecies");if(Fe)try{const _e=JSON.parse(Fe),Me=Ae.filter($=>_e.includes($.code)),tt=x(Me);if(tt.length>0){console.log("loadClips: Using pre-selected species:",tt.map($=>$.code)),v(tt);return}}catch(_e){console.error("Failed to parse pre-selected species in loadClips:",_e)}v(Ae)}catch(ce){console.error("Error loading clips:",ce)}},[t.species_pool,t.species_count]),Zf=S.useCallback(async()=>{if(e.current){console.log("initializeAudio: Already initialized, setting isAudioReady"),et(!0);return}try{const G=Ry();console.log("initializeAudio: Browser capabilities:",G.getCapabilities());const ce=new AudioContext;e.current=ce,console.log("initializeAudio: AudioContext created, state:",ce.state),ce.state==="suspended"&&(console.log("initializeAudio: AudioContext suspended, attempting resume..."),await ce.resume(),console.log("initializeAudio: AudioContext resumed, state:",ce.state)),et(!0),console.log("initializeAudio: Audio is ready!")}catch(G){console.error("initializeAudio: Failed to initialize audio:",G),et(!0)}},[]),xu=S.useCallback(async G=>{const ce=e.current;if(!ce)throw new Error("Audio context not initialized");const ge=r.current.get(G);if(ge)return console.log("loadAudioBuffer: Using cached buffer for",G),ge;console.log("loadAudioBuffer: Fetching",G);const ae=await fetch(`/${G}`);if(!ae.ok)throw console.error("loadAudioBuffer: Fetch failed",ae.status,ae.statusText),new Error(`Failed to load audio: ${G}`);console.log("loadAudioBuffer: Fetch OK, decoding...");const xe=await ae.arrayBuffer();try{const ue=await ce.decodeAudioData(xe);return console.log("loadAudioBuffer: Decoded OK, duration:",ue.duration),r.current.set(G,ue),ue}catch(ue){throw console.error(` DECODE FAILED for ${G}:`,ue),console.error("  This file cannot be played in Web Audio API (gameplay)"),console.error("  File size:",xe.byteLength,"bytes"),new Error(`Cannot decode audio file: ${G} - ${ue}`)}},[]),em=S.useCallback(async(G,ce,ge,ae)=>{const xe=e.current;if(!xe){console.error("playAudio: No AudioContext!");return}console.log("playAudio:",G,"ctx.state:",xe.state);try{xe.state==="suspended"&&(console.log("playAudio: Context suspended, trying to resume..."),await xe.resume());const ue=await xu(G);console.log("playAudio: Buffer loaded, duration:",ue.duration);const Ae=Ry();console.log("playAudio: Using adapter, capabilities:",Ae.getCapabilities());const Fe=xe.createBufferSource(),_e=xe.createGain(),Me=Ae.createChannelPanner(xe,ce);_e.gain.value=.05,Fe.buffer=ue,Fe.connect(_e),_e.connect(Me.output),Ae.connectPannerToDestination(Me,xe.destination),Fe.loop=!0,n.current.set(ge,Fe),i.current.set(ge,_e),s.current.set(ge,Me),o.current.set(ge,ae),Fe.onended=()=>{n.current.delete(ge),i.current.delete(ge);const tt=s.current.get(ge);tt&&(tt.disconnect(),s.current.delete(ge)),o.current.delete(ge)},Fe.start(),console.log("playAudio: Started playing")}catch(ue){console.error(" playAudio FAILED for",G),console.error("   Error:",ue),console.error("   This bird will have no audio during gameplay!")}},[xu]),io=S.useCallback(G=>{const ce=n.current.get(G);if(ce)try{ce.stop()}catch{}const ge=s.current.get(G);ge&&ge.disconnect(),n.current.delete(G),i.current.delete(G),s.current.delete(G),o.current.delete(G)},[]),tm=S.useCallback((G,ce,ge,ae)=>{const xe=ce.filter($=>$.species_code===G&&!$.rejected);if(xe.length===0)return[];const ue=xe.filter($=>$.canonical),Ae=xe.filter($=>!$.canonical);if(ge==="canonical")return ue.length>0?ue:xe.slice(0,1);if(ge==="all")return xe;const Fe=ge,_e=[];ue.length>0&&_e.push(...ue);const Me=[...Ae];for(let $=Me.length-1;$>0;$--){const ie=Math.floor(ae()*($+1));[Me[$],Me[ie]]=[Me[ie],Me[$]]}const tt=Fe-_e.length;return _e.push(...Me.slice(0,tt)),_e},[]),rm=S.useCallback(G=>{const ce=[],ge=Date.now(),ae=Nj(ge),xe=t.clip_selection??(t.canonical_only?"canonical":"all");let ue;if(G&&G.length>0)ue=[...G];else if(t.species_pool&&t.species_pool.length>0)ue=[...t.species_pool];else{const $=new Set;for(const Re of h)Re.rejected||$.add(Re.species_code);const ie=Array.from($);for(let Re=ie.length-1;Re>0;Re--){const Be=Math.floor(ae()*(Re+1));[ie[Re],ie[Be]]=[ie[Be],ie[Re]]}ue=ie.slice(0,t.species_count)}const Ae=new Map;for(const $ of ue){const ie=tm($,h,xe,ae);ie.length>0&&Ae.set($,ie)}if(ue=ue.filter($=>Ae.has($)),ue.length===0)return console.error("No species with available clips!"),[];console.log("generateEvents:",{clipSelection:xe,selectedSpecies:ue,clipsPerSpecies:Object.fromEntries(Array.from(Ae.entries()).map(([$,ie])=>[$,ie.map(Re=>Re.clip_id)]))});const Fe=2,_e=new Map,tt=localStorage.getItem("soundfield_continuous_play")==="true"?100:Math.ceil(t.round_duration_sec/2)+5;for(let $=0;$<tt;$++){const ie=ue.filter(Jr=>(Ae.get(Jr)||[]).some(Et=>(_e.get(Et.clip_id)||0)<Fe));let Re;ie.length>0?Re=ie[Math.floor(ae()*ie.length)]:Re=ue[Math.floor(ae()*ue.length)];const Be=Ae.get(Re)||[],bt=Be.filter(Jr=>(_e.get(Jr.clip_id)||0)<Fe);let Nt;if(bt.length>0?Nt=bt[Math.floor(ae()*bt.length)]:Nt=Be.reduce((Jr,Xi)=>{const Et=_e.get(Jr.clip_id)||0;return(_e.get(Xi.clip_id)||0)<Et?Xi:Jr},Be[0]),!Nt)continue;_e.set(Nt.clip_id,(_e.get(Nt.clip_id)||0)+1);const ci=ae()<.5?"left":"right";ce.push({event_id:`evt_${$}_${ge}`,clip_id:Nt.clip_id,species_code:Re,channel:ci,scheduled_time_ms:0,scoring_window_start_ms:0,scoring_window_end_ms:0,duration_ms:Nt.duration_ms,vocalization_type:Nt.vocalization_type})}return ce},[h,t,tm]),nm=S.useCallback(G=>h.find(ce=>ce.clip_id===G),[h]),pr=S.useCallback(G=>{const ce=gu.current,ge=Ma.current,ae=t.channel_mode||"single",xe=q/z.current;if(ge>=ce.length){ae==="single"?vn.current=null:G&&(_n.current[G]=null);return}const ue=performance.now(),Ae=fe.current,Fe=ue-Ae;if(!Y.current&&t.round_duration_sec*1e3-Fe<2e3){ae==="single"?vn.current=null:G&&(_n.current[G]=null);return}const _e=ce[ge];Ma.current=ge+1;let Me;if(ae==="offset"&&G?Me=G:Me=_e.channel,ae==="single")Bt.current!==null&&(clearTimeout(Bt.current),Bt.current=null);else{const Et=St.current[Me];Et!==null&&(clearTimeout(Et),St.current[Me]=null)}const tt=Fe,$=Fe+xe,ie={..._e,channel:Me,scheduled_time_ms:$,scoring_window_start_ms:tt,scoring_window_end_ms:$+500};ae==="single"?vn.current=ie.event_id:_n.current[Me]=ie.event_id;const Re=nm(ie.clip_id);if(!Re){console.error("spawnNextEvent: clip not found for clip_id:",ie.clip_id,"species:",ie.species_code),ae==="single"?pr():G&&pr(G);return}me.current.push(ie);const Be={...ie,spectrogramPath:Re.spectrogram_path||null,filePath:Re.file_path};X(Et=>[...Et,Be]),em(Re.file_path,Me,ie.event_id,ie.scheduled_time_ms),T(Et=>[...Et,{...ie,isActive:!0,hasBeenScored:!1}]);const bt=xe+500,Nt=ie.event_id,ci=Me,Jr=ie.species_code,Xi=window.setTimeout(()=>{if(ae==="single"){if(vn.current!==Nt)return;Bt.current=null}else{if(_n.current[ci]!==Nt)return;St.current[ci]=null}io(Nt),T(Et=>Et.map(Sn=>Sn.event_id===Nt?{...Sn,isActive:!1}:Sn)),T(Et=>{const Sn=Et.find(so=>so.event_id===Nt);if(Sn&&!Sn.hasBeenScored){j(Yi=>Yi+1),no.current+=1,C(0),hr.current.push({expectedSpecies:Jr,guessedSpecies:null,channel:ci});const so={id:`miss_${Date.now()}`,type:"miss",score:0,breakdown:{speciesCorrect:!1,channelCorrect:!1,timingAccuracy:"miss",speciesPoints:0,channelPoints:0,timingPoints:0,totalPoints:0},channel:ci,timestamp:performance.now(),expectedSpecies:Jr};we(so),setTimeout(()=>{we(Yi=>(Yi==null?void 0:Yi.id)===so.id?null:Yi)},1500)}return Et}),window.setTimeout(()=>{ae==="single"?pr():pr(ci)},200)},bt);ae==="single"?Bt.current=Xi:St.current[Me]=Xi},[nm,em,io,t.round_duration_sec,t.channel_mode]),im=S.useCallback((G,ce)=>{if((t.channel_mode||"single")==="single"){if(vn.current!==G)return;Bt.current!==null&&(clearTimeout(Bt.current),Bt.current=null),vn.current=null,io(G),pr()}else{if(_n.current[ce]!==G)return;const ae=St.current[ce];ae!==null&&(clearTimeout(ae),St.current[ce]=null),_n.current[ce]=null,io(G),pr(ce)}},[io,pr,t.channel_mode]),sm=S.useCallback(async()=>{console.log("initialize: Starting...");try{await Promise.all([Qf().catch(G=>console.error("initialize: loadClips failed:",G)),Zf().catch(G=>console.error("initialize: initializeAudio failed:",G))])}catch(G){console.error("initialize: Failed:",G)}et(!0),console.log("initialize: Complete, isAudioReady forced to true")},[Qf,Zf]),om=S.useCallback(async()=>{if(console.log("startRound called, roundState:",y,"clips.length:",h.length),y!=="idle"||h.length===0)return;let G=e.current;if(G||(G=new AudioContext,e.current=G,console.log("AudioContext created during tap")),G.state==="suspended")try{await G.resume(),console.log("AudioContext resumed, state:",G.state)}catch($){console.error("Failed to resume AudioContext:",$)}try{const $="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAYYoRwmHAAAAAAD/+1DEAAAHAAGf9AAAIgAANIAAAARMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7UMQbA8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",ie=new Audio($);ie.volume=.01,await ie.play(),console.log("HTML5 silent audio played to unlock iOS audio session")}catch($){console.error("Failed to play HTML5 silent audio:",$)}console.log("AudioContext state:",G.state),et(!0);const ce=Iy[t.event_density]||100,ge=localStorage.getItem("soundfield_scroll_speed"),ae=ge?parseFloat(ge):.5;z.current=ae,ye(ce*ae),b(0),C(0),N(0),k(0),U(0),F(0),j(0),T([]),X([]),we(null),M(t.round_duration_sec),De.current.clear(),gt.current=0,Pr.current=0,Je.current=0,li.current=0,no.current=0,qr.current=0,hr.current=[],me.current=[];let xe;console.log("startRound: allPoolSpecies.length =",f.length,"species_count =",t.species_count);const ue=sessionStorage.getItem("roundSpecies");if(ue)try{const $=JSON.parse(ue);sessionStorage.removeItem("roundSpecies");const ie=$.filter(Re=>f.some(Be=>Be.code===Re));if(ie.length>0){const Re=f.filter(bt=>ie.includes(bt.code)),Be=x(Re);console.log("Using pre-selected species:",Be.map(bt=>bt.code)),v(Be),xe=Be.map(bt=>bt.code)}}catch($){console.error("Failed to parse pre-selected species:",$),sessionStorage.removeItem("roundSpecies")}if(!xe)if(t.species_count&&f.length>t.species_count){const $=[...f];for(let Be=$.length-1;Be>0;Be--){const bt=Math.floor(Math.random()*(Be+1));[$[Be],$[bt]]=[$[bt],$[Be]]}const ie=$.slice(0,t.species_count),Re=x(ie);console.log("Random selection: setting species to",Re.length,"species:",Re.map(Be=>Be.code)),v(Re),xe=Re.map(Be=>Be.code)}else console.log("Using all pool species:",f.length),v(f),xe=f.map($=>$.code);const Ae=rm(xe);gu.current=Ae,Ma.current=0;const Fe=[...new Set(Ae.map($=>$.clip_id))];console.log("Preloading",Fe.length,"audio clips during tap gesture...");const _e=Fe.map(async $=>{const ie=h.find(Re=>Re.clip_id===$);if(ie)try{await xu(ie.file_path)}catch(Re){console.error("Failed to preload clip:",$,Re)}});await Promise.all(_e),console.log("Audio preloading complete"),vn.current=null,Bt.current!==null&&(clearTimeout(Bt.current),Bt.current=null),_n.current={left:null,right:null},St.current.left!==null&&clearTimeout(St.current.left),St.current.right!==null&&clearTimeout(St.current.right),St.current={left:null,right:null};const Me=performance.now();if(g("playing"),Te(Me),fe.current=Me,(t.channel_mode||"single")==="single")pr();else{pr("left");const ie=window.setTimeout(()=>{pr("right")},1500);te.current.push(ie)}if(Y.current=localStorage.getItem("soundfield_continuous_play")==="true",Y.current)M(0),O.current=window.setInterval(()=>{M($=>$+1)},1e3);else{O.current=window.setInterval(()=>{M(ie=>ie<=1?(wn(),0):ie-1)},1e3);const $=window.setTimeout(()=>{wn()},t.round_duration_sec*1e3);te.current.push($)}},[y,h.length,t.round_duration_sec,t.channel_mode,t.species_count,f,rm,pr]),wn=S.useCallback(()=>{g("ended"),O.current&&(clearInterval(O.current),O.current=null),Bt.current!==null&&(clearTimeout(Bt.current),Bt.current=null),vn.current=null,St.current.left!==null&&clearTimeout(St.current.left),St.current.right!==null&&clearTimeout(St.current.right),St.current={left:null,right:null},_n.current={left:null,right:null};for(const ae of te.current)clearTimeout(ae);te.current=[];for(const ae of n.current.values())try{ae.stop()}catch{}for(const ae of s.current.values())ae.disconnect();n.current.clear(),i.current.clear(),s.current.clear(),o.current.clear();const G={};for(const ae of me.current){const xe=ae.species_code;G[xe]||(G[xe]={total:0,correct:0}),G[xe].total++,De.current.has(ae.event_id)&&G[xe].correct++}const ce=De.current.size,ge={score:Pr.current,eventsScored:ce,totalEvents:me.current.length,speciesCorrect:Je.current,channelCorrect:li.current,perfectCount:gt.current,missCount:no.current,maxStreak:qr.current,speciesResults:G,species:_.map(ae=>({code:ae.code,name:ae.name})),mode:t.mode,packId:t.pack_id,levelId:t.level_id,levelTitle:t.title,confusionData:hr.current};localStorage.setItem("soundfield_round_results",JSON.stringify(ge))},[_,t.mode,t.pack_id,t.level_id,t.title]),am=S.useCallback((G,ce,ge,ae)=>{const xe=ce===G.species_code,ue=ge===G.channel,Ae=G.scheduled_time_ms,Fe=G.scoring_window_start_ms,_e=Ae-Fe,Me=Ae-ae,tt=Math.max(0,Math.min(1,Me/_e));let $;tt>=.5?$="perfect":(tt>=.25,$="partial");const ie=xe?An.SPECIES_CORRECT:0,Re=xe&&ue?An.CHANNEL_CORRECT:0;let Be=0;xe&&ue&&(tt>=.75?Be=An.TIMING_PERFECT:tt>=.5&&(Be=An.TIMING_PARTIAL));const bt=ie+Re+Be;return{speciesPoints:ie,channelPoints:Re,timingPoints:Be,totalPoints:bt,speciesCorrect:xe,channelCorrect:ue,timingAccuracy:$}},[]),lm=S.useCallback((G,ce)=>{if(y!=="playing")return;const ge=performance.now(),ae=ge-fe.current,xe=t.channel_mode||"single",ue=A.find($=>!($.hasBeenScored||ae<$.scoring_window_start_ms||ae>$.scoring_window_end_ms||xe==="offset"&&$.channel!==ce));if(!ue)return;const Ae=am(ue,G,ce,ae);hr.current.push({expectedSpecies:ue.species_code,guessedSpecies:G,channel:ue.channel}),Ae.speciesCorrect&&De.current.add(ue.event_id),im(ue.event_id,ue.channel),T($=>$.map(ie=>ie.event_id===ue.event_id?{...ie,hasBeenScored:!0}:ie)),b($=>$+Ae.totalPoints),Pr.current+=Ae.totalPoints,N($=>$+1),Ae.speciesCorrect&&(k($=>$+1),Je.current+=1),Ae.channelCorrect&&(U($=>$+1),li.current+=1);const Fe=An.SPECIES_CORRECT+An.CHANNEL_CORRECT;Ae.totalPoints===Fe?(F($=>$+1),gt.current+=1,C($=>{const ie=$+1;return qr.current=Math.max(qr.current,ie),ie})):Ae.totalPoints>0?C($=>{const ie=$+1;return qr.current=Math.max(qr.current,ie),ie}):C(0);let _e;const Me=An.SPECIES_CORRECT+An.CHANNEL_CORRECT;Ae.totalPoints===Me?_e="perfect":Ae.speciesCorrect&&Ae.channelCorrect?_e="good":Ae.speciesCorrect?_e="partial":_e="miss";const tt={id:`feedback_${Date.now()}`,type:_e,score:Ae.totalPoints,breakdown:Ae,channel:ue.channel,timestamp:ge,expectedSpecies:_e==="miss"?ue.species_code:void 0};we(tt),setTimeout(()=>{we($=>($==null?void 0:$.id)===tt.id?null:$)},_e==="miss"?1500:500)},[y,A,am,im,t.channel_mode]),cm=S.useCallback(()=>{wn(),g("idle"),b(0),C(0),N(0),k(0),U(0),F(0),j(0),T([]),X([]),Te(0),we(null),M(t.round_duration_sec)},[wn,t.round_duration_sec]);S.useEffect(()=>{if(y!=="playing"){a.current&&(cancelAnimationFrame(a.current),a.current=null);return}const G=()=>{var ae;const ce=performance.now()-fe.current,ge=q/z.current;for(const[xe,ue]of i.current.entries()){const Ae=o.current.get(xe);if(Ae===void 0)continue;const Fe=Ae-ce,Me=.05+Math.max(0,Math.min(1,1-Fe/ge))*.95;ue.gain.setValueAtTime(Me,((ae=e.current)==null?void 0:ae.currentTime)||0)}a.current=requestAnimationFrame(G)};return a.current=requestAnimationFrame(G),()=>{a.current&&cancelAnimationFrame(a.current)}},[y]),S.useEffect(()=>()=>{O.current&&clearInterval(O.current),a.current&&cancelAnimationFrame(a.current);for(const G of te.current)clearTimeout(G);for(const G of n.current.values())try{G.stop()}catch{}},[]),S.useEffect(()=>{if(y!=="playing"||!Y.current)return;const G=gu.current.length,ce=Ma.current;G>0&&ce>=G&&A.length===0&&(console.log("Continuous mode: all events processed, ending round"),wn())},[y,B,I,A.length,wn]);const sw={roundState:y,score:w,streak:P,timeRemaining:E,totalTime:t.round_duration_sec,eventsScored:B,speciesCorrect:D,channelCorrect:L,perfectCount:R,missCount:I,activeEvents:A,scheduledEvents:H,roundStartTime:K,scrollSpeed:oe,currentFeedback:Ee,species:_,isAudioReady:$e},ow=S.useMemo(()=>({initialize:sm,startRound:om,endRound:wn,submitInput:lm,reset:cm}),[sm,om,wn,lm,cm]);return[sw,ow]}function jy({code:t,size:e=32,color:r}){const[n,i]=S.useState(!0),s=`/data/icons/${t}.png`;return l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[n&&l.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?l.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>i(!1)}):l.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"transparent",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.35,fontWeight:700},children:t})]})}const My=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F"],Lj={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function Dj(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function Oj(t){return t>=4?"offset":"single"}const By={campaign:{mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},practice:{mode:"practice",round_duration_sec:60,species_count:3,event_density:"low",overlap_probability:0,scoring_window_ms:3e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},challenge:{mode:"challenge",round_duration_sec:60,species_count:8,event_density:"medium",overlap_probability:0,scoring_window_ms:1500,spectrogram_mode:"fading",clip_selection:"all",channel_mode:"offset"},random:{mode:"random",round_duration_sec:45,species_count:6,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"all",channel_mode:"single"}};function Uj(){const t=er(),[e]=eu(),r=S.useRef(null),[n,i]=S.useState({width:400,height:400}),[s,o]=S.useState(null),[a,c]=S.useState(null),[u,d]=S.useState([]),[h,p]=S.useState(!1),[f,m]=S.useState(()=>localStorage.getItem("soundfield_training_mode")==="true"),_=S.useRef(!1),v=S.useMemo(()=>localStorage.getItem("soundfield_spectrogram_mode")||"full",[]);S.useEffect(()=>{localStorage.setItem("soundfield_training_mode",String(f)),f&&(_.current=!0)},[f]);const x=e.get("mode")||"campaign",y=e.get("pack")||"common_se_birds",g=parseInt(e.get("level")||"1",10);S.useEffect(()=>{console.log("Fetching levels.json..."),fetch("/data/levels.json").then(A=>A.json()).then(A=>{console.log("Loaded",A.length,"levels from levels.json"),d(A)}).catch(A=>{console.error("Failed to load levels.json:",A)})},[]);const w=S.useMemo(()=>{var T;if(console.log("levelConfig useMemo: mode =",x,"packId =",y,"campaignLevels.length =",u.length),y==="custom"){let H=[];try{const X=sessionStorage.getItem("roundSpecies");if(X)H=JSON.parse(X);else{const K=localStorage.getItem("soundfield_custom_pack");K&&(H=JSON.parse(K),sessionStorage.setItem("roundSpecies",K))}}catch(X){console.error("Failed to parse custom species:",X)}return console.log("Custom pack: using species:",H,"for level",g),{level_id:g,pack_id:"custom",mode:"campaign",title:Lj[g]||`Level ${g}`,round_duration_sec:30,species_count:H.length,species_pool:H,clip_selection:Dj(g),channel_mode:Oj(g),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:v}}if(x==="campaign"&&u.length>0){const H=u.find(K=>K.pack_id===y&&K.level_id===g);if(H)return console.log("Found level from levels.json:",H.pack_id,H.title,"species_pool:",(T=H.species_pool)==null?void 0:T.length),{...H,spectrogram_mode:v};const X=u.find(K=>K.pack_id===y);return X?(console.log("Using first level for pack:",X.pack_id,X.title),{...X,spectrogram_mode:v}):(console.log("Ultimate fallback to first level"),{...u[0],spectrogram_mode:v})}console.log("Using hardcoded MODE_CONFIGS (no campaign levels loaded yet)");const A=By[x]||By.campaign;return{level_id:1,pack_id:y,...A,spectrogram_mode:v}},[x,y,g,u,v]),[b,P]=Fj(w),C=S.useRef(null);S.useEffect(()=>{var H,X;if(x==="campaign"&&u.length===0&&y!=="custom"){console.log("Waiting for levels.json to load...");return}const A=((H=w.species_pool)==null?void 0:H.length)??"none",T=`${w.pack_id}-${w.level_id}-${A}`;console.log("Init effect: key =",T,"lastKey =",C.current),C.current!==T&&(C.current=T,console.log("Initializing for",T),P.initialize(),XE(w.pack_id,w.level_id,((X=w.species_pool)==null?void 0:X.length)??0))},[x,u.length,w.pack_id,w.level_id,w.species_pool,P]),S.useEffect(()=>{const A=()=>{if(r.current){const T=r.current.getBoundingClientRect();i({width:T.width,height:T.height})}};return A(),window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[]);const E=S.useRef(P);E.current=P;const M=S.useRef(b.roundState);M.current=b.roundState,S.useEffect(()=>()=>{M.current==="playing"&&E.current.reset()},[]);const B=S.useMemo(()=>localStorage.getItem("soundfield_continuous_play")==="true",[]),N=b.species.map((A,T)=>({code:A.code,name:A.name,color:A.color||My[T%My.length]})),D=S.useCallback(A=>{o(A);const T=document.getElementById(`flash-${A}`);T&&(T.classList.add("active"),setTimeout(()=>T.classList.remove("active"),150)),a&&(P.submitInput(a,A),o(null),c(null))},[a,P]),k=S.useCallback(A=>{c(A),s&&(P.submitInput(A,s),o(null),c(null))},[s,P]);S.useEffect(()=>{const A=T=>{if(b.roundState==="playing"){if(T.key==="a"||T.key==="A"||T.key==="ArrowLeft"||T.key==="1")D("left");else if(T.key==="d"||T.key==="D"||T.key==="ArrowRight"||T.key==="2")D("right");else if(T.key>="3"&&T.key<="9"){const H=parseInt(T.key)-3;H<N.length&&k(N[H].code)}}};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[b.roundState,D,k,N]);const L=S.useCallback(()=>{P.reset(),t(-1)},[t,P]),U=S.useCallback(()=>{p(!0)},[]),R=S.useCallback(()=>{P.reset(),t(-1)},[t,P]),F=S.useCallback(()=>{p(!1)},[]),I=S.useCallback(()=>{console.log("handleStart clicked, isAudioReady:",b.isAudioReady,"species.length:",b.species.length),b.isAudioReady&&b.species.length>0?(console.log("Calling startRound..."),_.current=f,P.startRound()):console.log("Not calling startRound - conditions not met")},[b.isAudioReady,b.species.length,P,f]),j=S.useCallback(()=>{P.endRound();try{const A=localStorage.getItem("soundfield_round_results");if(A){const T=JSON.parse(A);T.usedTrainingMode=_.current,localStorage.setItem("soundfield_round_results",JSON.stringify(T))}}catch(A){console.error("Failed to update results with training mode flag:",A)}t("/summary",{replace:!0})},[t,P]);return S.useEffect(()=>{if(b.roundState==="ended"){try{const A=localStorage.getItem("soundfield_round_results");if(A){const T=JSON.parse(A);T.usedTrainingMode=_.current,localStorage.setItem("soundfield_round_results",JSON.stringify(T));const H=T.correctCount&&T.totalEvents?T.correctCount/T.totalEvents*100:0,X=T.duration??0;YE(w.pack_id,w.level_id,b.score,H,X)}}catch(A){console.error("Failed to update results with training mode flag:",A)}t("/summary",{replace:!0})}},[b.roundState,b.score,w.pack_id,w.level_id,t]),l.jsxs("div",{className:"gameplay-screen",children:[l.jsx(kT,{score:b.score,streak:b.streak,timeRemaining:b.timeRemaining,mode:x,levelId:w.level_id,levelTitle:w.title}),l.jsx("button",{className:"back-button",onClick:L,"aria-label":"Back to menu",children:l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}),b.roundState==="playing"&&l.jsx("button",{className:"quit-button",onClick:U,"aria-label":"Quit round",children:l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),l.jsx("button",{className:`training-toggle ${f?"active":""}`,onClick:()=>{const A=!f;m(A),KE(A)},"aria-label":f?"Disable training mode":"Enable training mode",title:f?"Training Mode ON - Icons visible":"Training Mode OFF",children:l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f?l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]}):l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]})})}),B&&b.roundState==="playing"&&l.jsx("button",{className:"end-round-button",onClick:j,"aria-label":"End round",children:"End Round"}),l.jsxs("div",{ref:r,className:"game-container",children:[l.jsx(Rj,{width:n.width,height:n.height,scheduledEvents:b.scheduledEvents,activeEvents:b.activeEvents,roundStartTime:b.roundStartTime,roundState:b.roundState,scrollSpeed:b.scrollSpeed,currentFeedback:b.currentFeedback,onChannelTap:D,trainingMode:f,spectrogramMode:w.spectrogram_mode}),l.jsx("div",{id:"flash-left",className:"channel-flash left"}),l.jsx("div",{id:"flash-right",className:"channel-flash right"}),s&&l.jsx("div",{className:`channel-indicator ${s}`,children:s.toUpperCase()}),b.roundState==="idle"&&l.jsx("div",{className:"start-overlay",children:l.jsx("button",{className:"start-button",onClick:I,disabled:!b.isAudioReady||b.species.length===0,children:b.isAudioReady&&b.species.length>0?"Start Round":"Loading..."})}),b.currentFeedback&&l.jsxs("div",{className:`feedback-overlay ${b.currentFeedback.type} ${b.currentFeedback.channel}`,children:[l.jsxs("div",{className:"feedback-score",children:["+",b.currentFeedback.score]}),l.jsx("div",{className:"feedback-type",children:b.currentFeedback.type.toUpperCase()}),b.currentFeedback.type==="miss"&&b.currentFeedback.expectedSpecies&&l.jsxs("div",{className:"feedback-correct",children:["Was: ",b.currentFeedback.expectedSpecies]})]})]}),l.jsxs("div",{className:"dual-input-panel",children:[l.jsxs("div",{className:"input-column left",children:[l.jsx("div",{className:"column-label",children:"LEFT EAR"}),l.jsx("div",{className:"species-buttons",children:N.map(A=>l.jsx("button",{className:`species-btn ${a===A.code?"selected":""}`,style:{backgroundColor:a===A.code?A.color:void 0},onClick:()=>{P.submitInput(A.code,"left");const T=document.getElementById("flash-left");T&&(T.classList.add("active"),setTimeout(()=>T.classList.remove("active"),150))},disabled:b.roundState!=="playing",children:l.jsx(jy,{code:A.code,size:36,color:A.color})},A.code))})]}),l.jsxs("div",{className:"input-column right",children:[l.jsx("div",{className:"column-label",children:"RIGHT EAR"}),l.jsx("div",{className:"species-buttons",children:N.map(A=>l.jsx("button",{className:`species-btn ${a===A.code?"selected":""}`,style:{backgroundColor:a===A.code?A.color:void 0},onClick:()=>{P.submitInput(A.code,"right");const T=document.getElementById("flash-right");T&&(T.classList.add("active"),setTimeout(()=>T.classList.remove("active"),150))},disabled:b.roundState!=="playing",children:l.jsx(jy,{code:A.code,size:36,color:A.color})},A.code))})]})]}),h&&l.jsx("div",{className:"quit-modal-overlay",children:l.jsxs("div",{className:"quit-modal",children:[l.jsx("h3",{style:{margin:0,marginBottom:"16px",fontSize:"20px"},children:"Quit Round?"}),l.jsx("p",{style:{margin:0,marginBottom:"24px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Your progress will not be saved."}),l.jsxs("div",{style:{display:"flex",gap:"12px"},children:[l.jsx("button",{className:"btn-secondary",onClick:F,style:{flex:1,padding:"12px"},children:"Cancel"}),l.jsx("button",{className:"btn-primary",onClick:R,style:{flex:1,padding:"12px",background:"var(--color-error)"},children:"Quit"})]})]})}),l.jsx("style",{children:`
        .gameplay-screen {
          display: flex;
          flex-direction: column;
          height: 100%;
          background-color: var(--color-background);
          overflow: hidden;
        }

        .back-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 8px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-accent);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .back-button:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .quit-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 8px;
          width: 40px;
          height: 40px;
          background: rgba(229, 115, 115, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-error);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .quit-button:hover {
          background: rgba(229, 115, 115, 0.5);
        }

        .quit-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        .quit-modal {
          background: var(--color-surface);
          border-radius: 16px;
          padding: 24px;
          max-width: 320px;
          width: 90%;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
          animation: slideUp 0.2s ease-out;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

        .training-toggle {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 56px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: 2px solid transparent;
          border-radius: 50%;
          color: var(--color-text-muted);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: all 0.2s;
        }

        .training-toggle:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .training-toggle.active {
          background: rgba(76, 175, 80, 0.3);
          border-color: rgba(76, 175, 80, 0.6);
          color: #81C784;
        }

        .end-round-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 12px;
          padding: 8px 16px;
          background: rgba(229, 115, 115, 0.8);
          border: none;
          border-radius: 20px;
          color: white;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          z-index: 100;
          transition: background 0.2s;
        }

        .end-round-button:hover {
          background: rgba(229, 115, 115, 1);
        }

        .game-container {
          flex: 1;
          position: relative;
          min-height: 0;
          overflow: hidden;
        }

        .channel-flash {
          position: absolute;
          top: 0;
          bottom: 0;
          width: 50%;
          pointer-events: none;
          background: transparent;
          transition: background 0.1s;
        }

        .channel-flash.left {
          left: 0;
        }

        .channel-flash.right {
          right: 0;
        }

        .channel-flash.active {
          background: rgba(255, 255, 255, 0.1);
        }

        .channel-indicator {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 8px 16px;
          background: var(--color-accent);
          color: var(--color-background);
          font-weight: 700;
          font-size: 14px;
          border-radius: 4px;
          pointer-events: none;
          animation: fadeIn 0.15s ease-out;
        }

        .channel-indicator.left {
          left: 20px;
        }

        .channel-indicator.right {
          right: 20px;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-50%) scale(0.9);
          }
          to {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
        }

        .start-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(0, 0, 0, 0.7);
          z-index: 50;
        }

        .start-button {
          padding: 16px 32px;
          font-size: 18px;
          font-weight: 700;
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: transform 0.2s, background 0.2s;
        }

        .start-button:hover:not(:disabled) {
          transform: scale(1.05);
          background: var(--color-accent);
        }

        .start-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .feedback-overlay {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 12px 20px;
          border-radius: 8px;
          pointer-events: none;
          animation: feedbackPop 0.5s ease-out forwards;
          z-index: 60;
        }

        .feedback-overlay.left {
          left: 20%;
        }

        .feedback-overlay.right {
          right: 20%;
        }

        .feedback-overlay.perfect {
          background: var(--color-success);
        }

        .feedback-overlay.good {
          background: #4CAF50;
        }

        .feedback-overlay.partial {
          background: var(--color-accent);
        }

        .feedback-overlay.miss {
          background: var(--color-error);
          animation: feedbackPopMiss 1.5s ease-out forwards;
        }

        .feedback-score {
          font-family: var(--font-mono);
          font-size: 24px;
          font-weight: 700;
          color: white;
          text-align: center;
        }

        .feedback-type {
          font-size: 12px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          text-align: center;
        }

        .feedback-correct {
          font-size: 14px;
          font-weight: 700;
          color: white;
          text-align: center;
          margin-top: 4px;
          padding-top: 4px;
          border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes feedbackPop {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          20% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          40% {
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-80%) scale(1);
          }
        }

        @keyframes feedbackPopMiss {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          5% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          10% {
            transform: translateY(-50%) scale(1);
          }
          85% {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-70%) scale(1);
          }
        }

        .dual-input-panel {
          display: flex;
          justify-content: space-between;
          padding: 8px 12px;
          padding-bottom: calc(12px + var(--safe-area-bottom, 0px));
          background: linear-gradient(0deg, var(--color-surface) 0%, rgba(26, 26, 46, 0.9) 100%);
          gap: 20px;
        }

        .input-column {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }

        .input-column.left {
          align-items: flex-start;
        }

        .input-column.right {
          align-items: flex-end;
        }

        .column-label {
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          padding: 2px 8px;
          border-radius: 4px;
        }

        .input-column.left .column-label {
          color: #81C784;
          background: rgba(129, 199, 132, 0.15);
        }

        .input-column.right .column-label {
          color: #64B5F6;
          background: rgba(100, 181, 246, 0.15);
        }

        .species-buttons {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
        }

        .input-column.left .species-buttons {
          justify-content: flex-start;
        }

        .input-column.right .species-buttons {
          justify-content: flex-end;
        }

        .species-btn {
          padding: 6px;
          border-radius: 12px;
          border: 2px solid var(--color-text-muted);
          background: var(--color-surface);
          color: var(--color-text);
          font-size: 10px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.15s ease-out;
          touch-action: manipulation;
          -webkit-tap-highlight-color: transparent;
        }

        .species-btn:hover:not(:disabled) {
          transform: scale(1.1);
        }

        .species-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .species-btn.selected {
          color: var(--color-background);
          transform: scale(1.05);
        }

        .species-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }
      `})]})}const iw=S.forwardRef(({score:t,accuracy:e,eventsScored:r,totalEvents:n,maxStreak:i,species:s,packId:o,levelId:a,levelTitle:c,topConfusion:u,usedTrainingMode:d},h)=>{const p=S.useRef(null),[f,m]=S.useState(!1),_=S.useRef(new Map),[v,x]=S.useState(!1),[y,g]=S.useState(!1),w=S.useRef(null);S.useEffect(()=>{(async()=>{const E="/",M=s.map(B=>new Promise((N,D)=>{const k=new Image;k.crossOrigin="anonymous",k.onload=()=>N({code:B.code,img:k}),k.onerror=D,k.src=`${E}data/icons/${B.code}.png`}));try{(await Promise.all(M)).forEach(({code:N,img:D})=>{_.current.set(N,D)}),m(!0)}catch(B){console.error("Failed to load bird icons:",B),m(!0)}})()},[s]),S.useEffect(()=>{(async()=>{const E="/",M=new Image;M.crossOrigin="anonymous",M.onload=()=>{w.current=M,g(!0)},M.onerror=()=>{console.error("Failed to load owl icon"),g(!0)},M.src=`${E}data/icons/OwlHeadphones.png`})()},[]),S.useEffect(()=>{if(!f||!y||!p.current)return;const C=p.current,E=C.getContext("2d");if(!E)return;const M=800,B=800,N=window.devicePixelRatio||1;C.width=M*N,C.height=B*N,C.style.width=`${M}px`,C.style.height=`${B}px`,E.scale(N,N),E.textBaseline="alphabetic";const D=E.createLinearGradient(0,0,0,B);if(D.addColorStop(0,"#f0f4f8"),D.addColorStop(1,"#d9e2ec"),E.fillStyle=D,E.fillRect(0,0,M,B),w.current){E.save(),E.globalAlpha=1;const Y=280,pe=M-Y-20,de=20;E.beginPath(),E.arc(pe+Y/2,de+Y/2,Y/2,0,Math.PI*2),E.clip(),E.drawImage(w.current,pe,de,Y,Y),E.restore()}E.fillStyle="#102a43",E.font="bold 48px -apple-system, system-ui, sans-serif",E.textAlign="center",E.fillText("ChipNotes! ",M/2,80),E.textAlign="left";const k=60;E.font="80px -apple-system, system-ui, sans-serif",E.fillStyle=e>=80?"#6aaa64":e>=60?"#c9b458":"#787c7e",E.fillText("",k,200),E.font="bold 110px -apple-system, system-ui, sans-serif",E.fillText(`${e}%`,k+95,200),E.font="32px -apple-system, system-ui, sans-serif",E.fillStyle="#334e68",E.fillText(`${t} points`,k,245),E.font="22px -apple-system, system-ui, sans-serif",E.fillStyle="#486581",E.fillText(`${r}/${n} birds identified`,k,280),E.textAlign="center",E.font="bold 26px -apple-system, system-ui, sans-serif",E.fillStyle="#d97706",E.fillText(` Best Streak: ${i}`,M/2,320);const U=s.slice(0,4),R=160,F=24,I=U.length*R+(U.length-1)*F,j=(M-I)/2;let A=365;U.forEach((Y,pe)=>{const de=j+pe*(R+F),q=A,oe=_.current.get(Y.code);if(oe){E.save(),E.beginPath(),E.arc(de+R/2,q+R/2,R/2,0,Math.PI*2),E.clip();const ye=oe.width/oe.height;let Ee=R,we=R,$e=0,et=0;ye>1?(Ee=R*ye,$e=-(Ee-R)/2):ye<1&&(we=R/ye,et=-(we-R)/2),E.drawImage(oe,de+$e,q+et,Ee,we),E.restore(),E.strokeStyle="#d3d6da",E.lineWidth=3,E.beginPath(),E.arc(de+R/2,q+R/2,R/2,0,Math.PI*2),E.stroke(),E.font="22px -apple-system, system-ui, sans-serif",E.fillStyle="#102a43",E.fillText(Y.code,de+R/2,q+R+38)}});const T=A+R+100;if(o&&a){const Y=zj(o);E.font="22px -apple-system, system-ui, sans-serif",E.fillStyle="#486581",E.fillText(`${Y}  Level ${a}`,M/2,T)}const H=s.map(Y=>Y.code).join("  ");E.font="18px -apple-system, system-ui, sans-serif",E.fillStyle="#627d98";const X=700,K=H.split(" ");let Te="",z=T+32;for(let Y=0;Y<K.length;Y++){const pe=Te+K[Y]+" ";E.measureText(pe).width>X&&Y>0?(E.fillText(Te.trim(),M/2,z),Te=K[Y]+" ",z+=25):Te=pe}if(E.fillText(Te.trim(),M/2,z),d){const Y=z+35;E.font="18px -apple-system, system-ui, sans-serif",E.fillStyle="#d97706",E.fillText(" Still training. Ready to migrate soon.",M/2,Y)}E.font="bold 26px -apple-system, system-ui, sans-serif",E.fillStyle="#102a43",E.textAlign="center",E.fillText("chipnotes.app",M/2,B-60),E.font="20px -apple-system, system-ui, sans-serif",E.fillStyle="#486581",E.fillText("#chipnotes #birdnerd",M/2,B-30),E.getImageData(0,0,1,1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{x(!0)})})},[f,y,t,e,r,n,i,s,o,a,u,d]);const b=()=>{if(!p.current)return;const C=document.createElement("a");C.download=`chipnotes-${e}pct-${Date.now()}.png`,C.href=p.current.toDataURL("image/png"),C.click()},P=async()=>{if(!p.current||!v)throw new Error("Canvas not ready");const C=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;try{if(C){const E=p.current.toDataURL("image/png"),M=window.open();return M&&(M.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
              <title>ChipNotes Score</title>
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <style>
                body {
                  margin: 0;
                  padding: 20px;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
                  background: #1a1a1a;
                  color: white;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  min-height: 100vh;
                }
                img {
                  max-width: 100%;
                  height: auto;
                  border-radius: 12px;
                  box-shadow: 0 10px 40px rgba(0,0,0,0.5);
                }
                .instructions {
                  margin-top: 20px;
                  padding: 16px;
                  background: rgba(255,255,255,0.1);
                  border-radius: 8px;
                  text-align: center;
                  max-width: 90%;
                }
                .instructions h2 {
                  margin: 0 0 12px 0;
                  font-size: 20px;
                }
                .instructions p {
                  margin: 8px 0;
                  font-size: 16px;
                  opacity: 0.9;
                }
                .highlight {
                  color: #d97706;
                  font-weight: 600;
                }
                .close-btn {
                  position: fixed;
                  top: 20px;
                  left: 20px;
                  width: 48px;
                  height: 48px;
                  border-radius: 50%;
                  background: rgba(255,255,255,0.9);
                  border: 2px solid rgba(0,0,0,0.1);
                  color: #1a1a1a;
                  font-size: 28px;
                  font-weight: bold;
                  cursor: pointer;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  transition: all 0.3s;
                  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                  z-index: 1000;
                }
                .close-btn:hover {
                  background: white;
                  transform: scale(1.1);
                  box-shadow: 0 6px 16px rgba(0,0,0,0.4);
                }
              </style>
            </head>
            <body>
              <button class="close-btn" onclick="window.close(); setTimeout(function() { window.history.back(); }, 100);"></button>
              <img src="${E}" alt="ChipNotes Score">
              <div class="instructions">
                <p> <span class="highlight">Press and hold the image above to share or save</span></p>
              </div>
            </body>
            </html>
          `),M.document.close()),"ios-instructions"}else{const E=await new Promise((B,N)=>{p.current.toBlob(D=>{D?B(D):N(new Error("toBlob failed"))},"image/png",1)}),M=new File([E],"chipnotes-score.png",{type:"image/png"});return navigator.share&&navigator.canShare&&navigator.canShare({files:[M]})?(await navigator.share({title:"ChipNotes! Score",text:`Just identified ${r}/${n} birds with ${e}% accuracy! `,files:[M]}),"shared"):(b(),"downloaded")}}catch(E){return console.error("Share failed:",E),b(),"error-downloaded"}};return S.useImperativeHandle(h,()=>({share:P,download:b,isReady:()=>v}),[v]),l.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px"},children:l.jsx("canvas",{ref:p})})});iw.displayName="ShareCard";function zj(t){return{starter_birds:"Common Backyard",expanded_backyard:"Expanded Backyard",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard"}[t]||t}const Ny=6;function Gj(){const t=er(),e=S.useRef(null),[r,n]=S.useState(null),[i,s]=S.useState([]),[o,a]=S.useState([]),[c,u]=S.useState(!1),[d,h]=S.useState(!1),[p,f]=S.useState(!1),[m,_]=S.useState(null);S.useEffect(()=>{var D;const N=localStorage.getItem("soundfield_round_results");if(N)try{const k=JSON.parse(N);if(n(k),k.mode==="campaign"&&k.levelId){const U="soundfield_progress",R=JSON.parse(localStorage.getItem(U)||"{}"),F=`level_${k.levelId}`,I=((D=R[F])==null?void 0:D.bestScore)||0;R[F]={completed:!0,bestScore:Math.max(I,k.score),accuracy:k.totalEvents>0?Math.round(k.eventsScored/k.totalEvents*100):0},localStorage.setItem(U,JSON.stringify(R))}const L=[];for(const U of k.species){const R=k.speciesResults[U.code]||{total:0,correct:0};R.total>0&&L.push({code:U.code,name:U.name,total:R.total,correct:R.correct,accuracy:Math.round(R.correct/R.total*100)})}if(L.sort((U,R)=>U.accuracy-R.accuracy),s(L),k.confusionData&&k.confusionData.length>0){const U=new Map;for(const F of k.confusionData){if(F.guessedSpecies===F.expectedSpecies)continue;const I=`${F.expectedSpecies}|${F.guessedSpecies??"MISS"}`;U.set(I,(U.get(I)||0)+1)}const R=[];for(const[F,I]of U.entries()){const[j,A]=F.split("|");R.push({expectedSpecies:j,guessedSpecies:A==="MISS"?null:A,count:I})}R.sort((F,I)=>I.count-F.count),a(R)}}catch(k){console.error("Failed to parse round results:",k)}},[]);const v=r&&r.totalEvents>0?Math.round(r.eventsScored/r.totalEvents*100):0,x=(r==null?void 0:r.mode)==="campaign",y=(r==null?void 0:r.levelId)||1,g=(r==null?void 0:r.packId)||"starter_birds",w=y>1,b=y<Ny,P=N=>{if(r!=null&&r.species){const D=r.species.map(k=>k.code);sessionStorage.setItem("roundSpecies",JSON.stringify(D))}t(`/preview?pack=${g}&level=${N}&keepBirds=true`)},C=()=>{t(`/level-select?pack=${g}`)},E=()=>{t("/pack-select")},M=()=>{t("/")};S.useEffect(()=>{const N=setInterval(()=>{var D;(D=e.current)!=null&&D.isReady()&&(f(!0),clearInterval(N))},100);return()=>clearInterval(N)},[r]);const B=async()=>{if(e.current){h(!0),_(null);try{await e.current.share()==="ios-instructions"&&(_("Follow instructions in new tab to save & share! "),setTimeout(()=>_(null),5e3))}catch(N){console.error("Share failed:",N),_("Share failed. Please try again."),setTimeout(()=>_(null),3e3)}finally{h(!1)}}};return l.jsxs("div",{className:"screen",style:{paddingTop:"32px",paddingBottom:"calc(24px + var(--safe-area-bottom, 0px))"},children:[l.jsx("h1",{style:{textAlign:"center",marginBottom:"8px"},children:"ROUND COMPLETE"}),x&&l.jsxs("p",{className:"text-muted",style:{textAlign:"center",marginBottom:"16px"},children:["Level ",y,": ",(r==null?void 0:r.levelTitle)||"Campaign"]}),l.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto 16px"},children:[l.jsxs("button",{className:"btn-primary",onClick:B,disabled:d||!r||!p,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[l.jsx(Vj,{}),d?"Generating...":p?"Share Your Score":"Preparing..."]}),l.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",textAlign:"center",marginTop:"8px",marginBottom:"0",fontStyle:"italic"},children:"Let them Wordle, you already know how to spell."}),m&&l.jsx("p",{style:{fontSize:"14px",color:"var(--color-accent)",textAlign:"center",marginTop:"8px",marginBottom:"0",fontWeight:600,animation:"fadeIn 0.3s ease"},children:m})]}),r&&l.jsx(iw,{ref:e,score:r.score,accuracy:v,eventsScored:r.eventsScored,totalEvents:r.totalEvents,maxStreak:r.maxStreak,species:r.species,packId:r.packId,levelId:r.levelId,levelTitle:r.levelTitle,usedTrainingMode:r.usedTrainingMode,topConfusion:o.length>0&&o[0].guessedSpecies?{from:o[0].expectedSpecies,to:o[0].guessedSpecies}:null}),l.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[l.jsx("span",{children:"Score"}),l.jsx("span",{className:"text-accent",style:{fontFamily:"var(--font-mono)",fontSize:"24px"},children:(r==null?void 0:r.score)||0})]}),l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[l.jsx("span",{children:"Birds Identified"}),l.jsxs("span",{children:[(r==null?void 0:r.eventsScored)||0," / ",(r==null?void 0:r.totalEvents)||0]})]}),l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[l.jsx("span",{children:"Overall Accuracy"}),l.jsxs("span",{className:v>=70?"text-success":v>=50?"text-accent":"text-error",children:[v,"%"]})]}),l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[l.jsx("span",{children:"Perfect Hits"}),l.jsx("span",{className:"text-success",children:(r==null?void 0:r.perfectCount)||0})]}),l.jsxs("div",{className:"flex-row justify-between",children:[l.jsx("span",{children:"Best Streak"}),l.jsx("span",{children:(r==null?void 0:r.maxStreak)||0})]}),(r==null?void 0:r.usedTrainingMode)&&l.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid var(--color-surface)",fontSize:"13px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"Training Mode was used"]})]}),i.length>0&&l.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Species Breakdown"}),i.map(N=>l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[l.jsxs("span",{style:{fontSize:"14px"},children:[N.code," ",l.jsxs("span",{className:"text-muted",children:["(",N.name,")"]})]}),l.jsxs("span",{style:{fontSize:"14px"},children:[N.correct,"/",N.total," (",N.accuracy,"%)"]})]}),l.jsx("div",{style:{height:"8px",backgroundColor:"var(--color-background)",borderRadius:"4px",overflow:"hidden"},children:l.jsx("div",{style:{width:`${N.accuracy}%`,height:"100%",backgroundColor:N.accuracy>=80?"var(--color-success)":N.accuracy>=50?"var(--color-accent)":"var(--color-error)",borderRadius:"4px",transition:"width 0.3s ease"}})})]},N.code))]}),o.length>0&&l.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Confusion Summary"}),o.map((N,D)=>l.jsx("div",{style:{marginBottom:"8px",fontSize:"14px"},children:N.guessedSpecies===null?l.jsxs("span",{children:["Missed ",l.jsx("span",{className:"text-accent",children:N.expectedSpecies}),": ",N.count,"x"]}):l.jsxs("span",{children:[l.jsx("span",{className:"text-accent",children:N.expectedSpecies}),"  ",l.jsx("span",{className:"text-error",children:N.guessedSpecies}),": ",N.count,"x"]})},D))]}),l.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto"},children:[x&&l.jsxs("div",{className:"flex-row gap-md",style:{marginBottom:"12px"},children:[l.jsxs("button",{className:"btn-secondary",onClick:()=>P(y-1),disabled:!w,style:{flex:1,opacity:w?1:.4},children:[l.jsx(Hj,{})," Prev"]}),l.jsxs("button",{className:"btn-secondary",onClick:()=>u(!c),style:{flex:1},children:["Level ",y,"/",Ny]}),l.jsxs("button",{className:"btn-secondary",onClick:()=>P(y+1),disabled:!b,style:{flex:1,opacity:b?1:.4},children:["Next ",l.jsx($j,{})]})]}),c&&l.jsxs("div",{className:"card",style:{marginBottom:"12px",padding:"12px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginBottom:"8px"},children:"Jump to level:"}),l.jsx("div",{className:"flex-row",style:{flexWrap:"wrap",gap:"8px"},children:[1,2,3,4,5,6].map(N=>l.jsx("button",{onClick:()=>{u(!1),P(N)},style:{width:"40px",height:"40px",borderRadius:"8px",border:N===y?"2px solid var(--color-accent)":"1px solid var(--color-text-muted)",background:N===y?"var(--color-accent)":"var(--color-surface)",color:N===y?"var(--color-background)":"var(--color-text)",fontWeight:600,cursor:"pointer"},children:N},N))})]}),l.jsxs("div",{className:"flex-col gap-md",children:[l.jsx("button",{className:"btn-primary",onClick:()=>P(y),style:{width:"100%"},children:"Play Again"}),l.jsxs("div",{className:"flex-row gap-md",children:[l.jsx("button",{className:"btn-secondary",onClick:C,style:{flex:1},children:"Levels"}),l.jsx("button",{className:"btn-secondary",onClick:E,style:{flex:1},children:"Packs"}),l.jsx("button",{className:"btn-secondary",onClick:M,style:{flex:1},children:"Home"})]})]})]})]})}function Hj(){return l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"4px"},children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function $j(){return l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"4px"},children:l.jsx("path",{d:"M9 18l6-6-6-6"})})}function Vj(){return l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"18",cy:"5",r:"3"}),l.jsx("circle",{cx:"6",cy:"12",r:"3"}),l.jsx("circle",{cx:"18",cy:"19",r:"3"}),l.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),l.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]})}const Cn={SCROLL_SPEED:"soundfield_scroll_speed",SPECTROGRAM_MODE:"soundfield_spectrogram_mode",CONTINUOUS_PLAY:"soundfield_continuous_play",COOKIE_CONSENT:"chipnotes_cookie_consent"};function Wj(){const t=er(),[e,r]=S.useState(()=>localStorage.getItem(Cn.SPECTROGRAM_MODE)||"full"),[n,i]=S.useState(()=>{const h=localStorage.getItem(Cn.SCROLL_SPEED);return h?parseFloat(h):.5}),[s,o]=S.useState(()=>localStorage.getItem(Cn.CONTINUOUS_PLAY)==="true"),[a,c]=S.useState(()=>localStorage.getItem(Cn.COOKIE_CONSENT)==="accepted");S.useEffect(()=>{localStorage.setItem(Cn.SPECTROGRAM_MODE,e)},[e]),S.useEffect(()=>{localStorage.setItem(Cn.SCROLL_SPEED,n.toString())},[n]),S.useEffect(()=>{localStorage.setItem(Cn.CONTINUOUS_PLAY,s.toString())},[s]);const u=h=>{c(h),localStorage.setItem(Cn.COOKIE_CONSENT,h?"accepted":"declined"),alert(h?"Analytics enabled. Please refresh the page for changes to take effect.":"Analytics disabled. Please refresh the page for changes to take effect.")},d=()=>{confirm("This will delete ALL your progress, settings, and custom packs. This cannot be undone. Are you sure?")&&(localStorage.clear(),"caches"in window&&caches.keys().then(p=>{p.forEach(f=>{caches.delete(f)})}),alert("All data has been deleted. The app will now reload."),window.location.href=window.location.origin+"/")};return l.jsxs("div",{className:"screen",children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:l.jsx(Xj,{})}),l.jsx("h2",{style:{margin:0},children:"Settings"})]}),l.jsxs("div",{className:"flex-col gap-lg",children:[l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Spectrogram Mode"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:"Visual difficulty setting"}),l.jsx("div",{className:"flex-row gap-sm",children:["full","fading","none"].map(h=>l.jsx("button",{className:e===h?"btn-primary":"btn-secondary",onClick:()=>r(h),style:{flex:1,textTransform:"capitalize"},children:h},h))})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Scroll Speed"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:["How fast tiles move: ",n.toFixed(1),"x"]}),l.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:n,onChange:h=>i(parseFloat(h.target.value)),style:{width:"100%"}})]}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex-row justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h3",{style:{marginBottom:"4px"},children:"Continuous Play"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"No timer - play until all clips done"})]}),l.jsx("button",{className:s?"btn-primary":"btn-secondary",onClick:()=>o(!s),style:{width:"60px"},children:s?"ON":"OFF"})]})}),l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"flex-row justify-between items-center",style:{marginBottom:"8px"},children:[l.jsx("div",{children:l.jsx("h3",{style:{marginBottom:"0"},children:"Analytics"})}),l.jsx("button",{className:a?"btn-primary":"btn-secondary",onClick:()=>u(!a),style:{width:"60px"},children:a?"ON":"OFF"})]}),l.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"I know I'm a stranger, but please accept my cookies! Analytics help me understand how many players I have, which birds everyone loves, and what features are most useful. I promise I'm just adding bird nerds to my LIFE LIST, not stalking you. Your IP is anonymized, no personal data collected, full GDPR/CCPA compliance."})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"8px"},children:"Privacy Policy"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["Learn about how your privacy is protected, what data is collected, and your rights."," ",l.jsx("button",{onClick:()=>t("/privacy"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Privacy Policy "})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"8px"},children:"How to Play"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["New to ChipNotes? Learn about gameplay, scoring, packs, and tips."," ",l.jsx("button",{onClick:()=>t("/help"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Help Guide "})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"8px"},children:"Feedback & Bug Reports"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["Found a bug? Have a feature idea? Email me at"," ",l.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:[l.jsx("span",{style:{color:"var(--color-text)"},children:"Have a bird sound on your phone that you think should be in the game?"})," Send it to me! I'll add it and give you credit in the app."]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"8px"},children:"Support This Project"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["ChipNotes is free, open source, and built as a passion project. If it's helped you level-up your birding skills, consider"," ",l.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"supporting development"})," ","- your donations help me add new species, add features, and do more birding. Now, you go build something cool - it might be easier than you think! ;)"]}),l.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:"Please also consider supporting the organizations that make this possible, and tell them ChipNotes! sent you:"}),l.jsxs("ul",{style:{fontSize:"13px",lineHeight:"1.5",color:"var(--color-text-muted)",marginBottom:"12px"},children:[l.jsxs("li",{style:{marginBottom:"8px"},children:[l.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.birds.cornell.edu/home/support/"})," ","- Incredible bird sound archive"]}),l.jsxs("li",{children:[l.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://xeno-canto.org/about/donate"})," ","- Community-driven bird recording database"]})]}),l.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"Thank you for learning with me! "})]}),l.jsx("div",{className:"card",children:l.jsx("button",{className:"btn-secondary",onClick:d,style:{width:"100%",color:"var(--color-error)"},children:"Reset All Progress"})})]})]})}function Xj(){return l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),l.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}const _l=[{code:"NOCA",name:"Northern Cardinal",accuracy:92,attempts:45},{code:"BLJA",name:"Blue Jay",accuracy:88,attempts:38},{code:"CARW",name:"Carolina Wren",accuracy:76,attempts:29},{code:"AMCR",name:"American Crow",accuracy:95,attempts:22},{code:"TUTI",name:"Tufted Titmouse",accuracy:71,attempts:18}];function Yj(){const t=er(),e=Math.round(_l.reduce((r,n)=>r+n.accuracy,0)/_l.length);return l.jsxs("div",{className:"screen",children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:l.jsx(Kj,{})}),l.jsx("h2",{style:{margin:0},children:"Progress"})]}),l.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"linear-gradient(135deg, rgba(245, 166, 35, 0.15) 0%, rgba(245, 166, 35, 0.05) 100%)",border:"2px solid var(--color-accent)",borderRadius:"12px",textAlign:"center"},children:[l.jsx("div",{style:{fontSize:"16px",fontWeight:700,color:"var(--color-accent)",marginBottom:"4px"},children:" Coming Soon! "}),l.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.4},children:"Real stats tracking is in development. The data below is a preview of what's coming!"})]}),l.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Demo Data"}),l.jsxs("div",{className:"flex-row justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Overall Accuracy"}),l.jsxs("div",{style:{fontSize:"32px",fontWeight:700},className:"text-success",children:[e,"%"]})]}),l.jsxs("div",{style:{textAlign:"right"},children:[l.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Total Attempts"}),l.jsx("div",{style:{fontSize:"24px",fontWeight:600},children:_l.reduce((r,n)=>r+n.attempts,0)})]})]})]}),l.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[l.jsx("h3",{style:{margin:0},children:"This Session"}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),l.jsxs("div",{className:"flex-row justify-between",style:{marginTop:"12px"},children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Rounds"}),l.jsx("div",{style:{fontSize:"20px"},children:"5"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Score"}),l.jsx("div",{style:{fontSize:"20px"},className:"text-accent",children:"12,450"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Best Streak"}),l.jsx("div",{style:{fontSize:"20px"},children:"18"})]})]})]}),l.jsxs("div",{className:"card",style:{opacity:.7},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[l.jsx("h3",{style:{margin:0},children:"Species Accuracy"}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),_l.map(r=>l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[l.jsxs("span",{style:{fontSize:"14px"},children:[r.code," ",l.jsxs("span",{className:"text-muted",children:["(",r.attempts,")"]})]}),l.jsxs("span",{style:{fontSize:"14px"},className:r.accuracy>=80?"text-success":r.accuracy>=60?"text-accent":"text-error",children:[r.accuracy,"%"]})]}),l.jsx("div",{style:{height:"6px",backgroundColor:"var(--color-background)",borderRadius:"3px",overflow:"hidden"},children:l.jsx("div",{style:{width:`${r.accuracy}%`,height:"100%",backgroundColor:r.accuracy>=80?"var(--color-success)":r.accuracy>=60?"var(--color-accent)":"var(--color-error)",borderRadius:"3px"}})})]},r.code))]}),l.jsx("div",{className:"card",style:{marginTop:"24px",opacity:.7},children:l.jsx("button",{className:"btn-secondary",style:{width:"100%",cursor:"not-allowed"},disabled:!0,children:"View Confusion Matrix (Coming Soon)"})})]})}function Kj(){return l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),l.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function qj(){var _;const t=er(),e=Hi(),r=["Why Learn Bird Song?","ChipNotes Basics","Scoring"];(_=e.state)!=null&&_.openVersionHistory&&r.push("Full Version History"),e.hash==="#training-mode"&&r.push("Training Mode");const[n,i]=S.useState(new Set(r)),[s,o]=S.useState(!1),a=S.useRef(null),c=S.useRef(null),u=S.useRef(!1),d=["Why Learn Bird Song?","ChipNotes Basics","Scoring","The Packs","The Levels","Tips","Training Mode","Taxonomic Sorting","The 4-Letter Codes","The Spectrograms","About & Credits","Support This Project","Feedback & Bug Reports","Full Version History"],h=v=>{const x=new Set(n);x.has(v)?x.delete(v):x.add(v),i(x)},p=()=>{n.size===d.length?i(new Set):i(new Set(d))},f=n.size===d.length;S.useEffect(()=>{const v=()=>{!s&&a.current&&a.current.scrollTop>0&&o(!0)},x=a.current;if(x)return x.addEventListener("scroll",v),()=>x.removeEventListener("scroll",v)},[s]),S.useEffect(()=>{var v;(v=e.state)!=null&&v.openVersionHistory&&c.current&&setTimeout(()=>{var x;(x=c.current)==null||x.scrollIntoView({behavior:"smooth",block:"start"})},100)},[e.state]),S.useEffect(()=>{e.hash==="#training-mode"&&!u.current&&(u.current=!0,setTimeout(()=>{const v=document.getElementById("training-mode");v&&v.scrollIntoView({behavior:"smooth",block:"start"})},100))},[e.hash]);const m=()=>{var v;(v=a.current)==null||v.scrollTo({top:0,behavior:"smooth"})};return l.jsxs("div",{ref:a,className:"screen",style:{paddingBottom:"32px",position:"relative"},children:[l.jsxs("button",{onClick:m,style:{position:"fixed",top:"calc(24px + var(--safe-area-top, 0px))",right:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(76, 175, 80, 0.15)",color:"var(--color-success)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",zIndex:1e3},onMouseEnter:v=>{v.currentTarget.style.transform="scale(1.05)",v.currentTarget.style.background="rgba(76, 175, 80, 0.25)",v.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:v=>{v.currentTarget.style.transform="scale(1)",v.currentTarget.style.background="rgba(76, 175, 80, 0.15)",v.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},"aria-label":"Scroll to top",children:[l.jsx("span",{style:{fontSize:"12px"},children:""}),"Top"]}),l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",style:{color:"var(--color-accent)"},children:l.jsx(Jj,{})}),l.jsx("h2",{style:{margin:0,flex:1},children:"How to Play"})]}),l.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[l.jsxs(Ft,{title:"Why Learn Bird Song?",isExpanded:n.has("Why Learn Bird Song?"),onToggle:()=>h("Why Learn Bird Song?"),children:[l.jsxs("p",{style:{marginBottom:"12px"},children:["Birds are ",l.jsx("em",{children:"heard"})," way more than they're ",l.jsx("em",{children:"seen"}),". But once you know the songs, you'll know what to look for - and suddenly your backyard becomes way more interesting."]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{children:"Why the left/right thing?"}),` That's birding! You're constantly triangulating: "Cardinal to my left, chickadee to my right, warbler... somewhere up there?" Training your ears to separate simultaneous sounds - like a pianist controlling both hands - dramatically sharpens your field skills.`]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{children:"Neuroplasticity works:"})," Your brain rewires with practice. These sound patterns feel impossible at first, but repeated exposure trains your auditory cortex faster than you'd think. Give it a few sessions - you'll be amazed what you can hear."]}),l.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsx("strong",{children:"Need real-time ID?"})," Get Cornell's free ",l.jsx("a",{href:"https://merlin.allaboutbirds.org/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"Merlin app"}),` - it's magic for "what bird is that singing `,l.jsx("em",{children:"right now"}),'?"']})]}),l.jsxs(Ft,{title:"ChipNotes Basics",isExpanded:n.has("ChipNotes Basics"),onToggle:()=>h("ChipNotes Basics"),children:[l.jsx("p",{style:{marginBottom:"12px"},children:l.jsx("strong",{children:"Listen. Identify. Tap."})}),l.jsx("p",{style:{marginBottom:"12px"},children:"Bird sounds play through your left or right ear. Identify which bird is singing and tap its circle on the correct side before the tile passes the scoring zone."}),l.jsx("p",{style:{marginBottom:"12px"},children:"Each round is 30 seconds. Use headphones for the best experience - unless you want everyone to know you're a bird nerd!"}),l.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsx("strong",{children:"Mobile tip:"}),' For fullscreen play on iOS, use Safari. On Android Chrome, tap   "Add to Home screen" and launch from the icon.']})]}),l.jsxs(Ft,{title:"Scoring",isExpanded:n.has("Scoring"),onToggle:()=>h("Scoring"),children:[l.jsx(wl,{label:"Perfect",points:100,description:"Right bird + right ear + great timing",color:"var(--color-success)"}),l.jsx(wl,{label:"Good",points:75,description:"Right bird + right ear",color:"var(--color-success)"}),l.jsx(wl,{label:"Partial",points:25,description:"Right bird, wrong ear",color:"var(--color-accent)"}),l.jsx(wl,{label:"Miss",points:0,description:"Wrong bird or no response",color:"var(--color-error)"})]}),l.jsxs(Ft,{title:"The Packs",isExpanded:n.has("The Packs"),onToggle:()=>h("The Packs"),children:[l.jsx(ns,{name:"Backyard Birds",description:"Perfect for beginners. 6 distinctive birds you'll hear in your own backyard: American Crow (AMCR), American Robin (AMRO), Blue Jay (BLJA), Carolina Wren (CARW), Northern Cardinal (NOCA), and Tufted Titmouse (TUTI)."}),l.jsx(ns,{name:"Eastern Birds",description:"46 species from the eastern US. 9 birds are selected randomly, and you can shuffle for a new set anytime from the preview screen."}),l.jsx(ns,{name:"Sparrows",description:"Master the subtle singers! 9 sparrow species with distinctive patterns: White-throated, Song, Chipping, Swamp, Savannah, Field, Lincoln's, White-crowned, and House Sparrow."}),l.jsx(ns,{name:"Woodpeckers",description:"Drums, rattles, and calls. 9 species: Downy, Hairy, Red-bellied, Pileated, Yellow-bellied Sapsucker, Northern Flicker, Red-headed, Acorn, and Lewis's."}),l.jsx(ns,{name:"Western Birds",description:"18 common species from western North America: Steller's Jay, California Scrub-Jay, Black-capped Chickadee, White-crowned Sparrow, Cassin's Finch, Pine Siskin, Evening Grosbeak, and more."}),l.jsx(ns,{name:"Warbler Academy",description:"For experts! 33 wood-warbler species with their high-pitched, buzzy songs. 9 warblers are selected randomlyshuffle for a new set anytime."}),l.jsxs("p",{style:{marginTop:"16px",fontSize:"13px",color:"var(--color-text-muted)",fontStyle:"italic"},children:["There are 11,000 birds out there, so more are coming soon. Send your suggestions to"," ",l.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"}),"!"]})]}),l.jsxs(Ft,{title:"The Levels",isExpanded:n.has("The Levels"),onToggle:()=>h("The Levels"),children:[l.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Each pack has 6 levels that build your skills:"}),l.jsx(is,{level:1,title:"Meet the Birds",description:"One clear recording per bird, single ear. Learn each signature voice."}),l.jsx(is,{level:2,title:"Sound Variations",description:"Up to 3 recordings per bird. Same species, different songs."}),l.jsx(is,{level:3,title:"Full Repertoire",description:"All recordings in play. Master every variation."}),l.jsx(is,{level:4,title:"Both Ears",description:"Sounds from either side. Identify the bird AND the direction."}),l.jsx(is,{level:5,title:"Variations + Both Ears",description:"Multiple recordings, either ear. Getting challenging!"}),l.jsx(is,{level:6,title:"Master Birder",description:"Everything at once. You're a pro now."})]}),l.jsxs(Ft,{title:"Tips",isExpanded:n.has("Tips"),onToggle:()=>h("Tips"),children:[l.jsx(ss,{children:"Start with the 6 common birds, even if you're eager for more."}),l.jsxs(ss,{children:["Use"," ",l.jsx(ma,{to:"/pack-select#bird-reference",state:{fromHelp:!0},style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Bird Reference"})," ","to preview all sounds included in the game."]}),l.jsx(ss,{children:"Your birds stay the same between rounds. Hit the shuffle button on the preview screen for a fresh set."}),l.jsx(ss,{children:"Don't rush. Let the sound register before you tap."}),l.jsx(ss,{children:"Check the round summary and confusion matrix to see which birds need practice."}),l.jsx(ss,{children:"Adjust tile speed in Settings if things move too fast (or too slow). Once you're an expert, try playing muted using only spectrograms!"})]}),l.jsxs(Ft,{id:"training-mode",title:"Training Mode",isExpanded:n.has("Training Mode"),onToggle:()=>h("Training Mode"),children:[l.jsx("p",{children:"Training Mode shows bird icons and species codes on each tile alongside the spectrogram - perfect for learning which sounds belong to which birds."}),l.jsxs("p",{children:["You can enable it on the preview screen before starting a round, or toggle it on/off anytime during gameplay using the ",l.jsx("strong",{children:"eye icon"})," (next to the back button). Start with labels visible, then toggle off to challenge yourself!"]}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(76, 175, 80, 0.3)",border:"2px solid rgba(76, 175, 80, 0.6)",borderRadius:"50%",color:"#81C784"},children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),l.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Eye icon glows green when Training Mode is ON"})]})]}),l.jsxs(Ft,{title:"Taxonomic Sorting",isExpanded:n.has("Taxonomic Sorting"),onToggle:()=>h("Taxonomic Sorting"),children:[l.jsx("p",{children:"Taxonomic sorting can be toggled on and off throughout the game - on the preview screen, in Bird Reference sections, in the Custom Pack Builder, and during gameplay. When enabled, birds appear in phylogenetic order with scientific names instead of alphabetically. "}),l.jsxs("p",{style:{marginTop:"12px"},children:["Birds are sorted by their position on the evolutionary tree (using the 2025 eBird/AOS taxonomy), and common names are replaced with ",l.jsx("em",{children:"scientific names in italics"}),". Perfect for learning evolutionary relationships!"]}),l.jsx("p",{style:{marginTop:"12px"},children:"Most beginners stick with alphabetical sorting during gameplay - it's faster to find birds by their 4-letter codes. But as you advance, you might prefer taxonomic sorting everywhere, building muscle memory based on evolutionary relationships. Either way works - you're training your brain to recognize patterns!"}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(100, 181, 246, 0.3)",border:"2px solid rgba(100, 181, 246, 0.6)",borderRadius:"50%",color:"#64B5F6"},children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),l.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),l.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),l.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})}),l.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Toggle glows blue when Taxonomic Sorting is ON"})]})]}),l.jsxs(Ft,{title:"The 4-Letter Codes",isExpanded:n.has("The 4-Letter Codes"),onToggle:()=>h("The 4-Letter Codes"),children:[l.jsx("p",{children:`Birders use standardized 4-letter codes (called "Alpha codes") as shorthand for species names. They're easy to learn:`}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"8px",fontSize:"14px",lineHeight:1.6},children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Two-word names:"})," First 2 letters of each word"]}),l.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Northern Cardinal  NO + CA  NOCA"}),l.jsxs("div",{style:{marginTop:"8px"},children:[l.jsx("strong",{children:"Three-word names:"})," 1 + 1 + 2 letters"]}),l.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Red-bellied Woodpecker  R + B + WO  RBWO"}),l.jsxs("div",{style:{marginTop:"12px",fontStyle:"italic",color:"var(--color-text-muted)"},children:["There ",l.jsx("a",{href:"https://www.birdpop.org/pages/birdSpeciesCodes.php",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"are exceptions"}),". Because, ornithology."]})]})]}),l.jsxs(Ft,{title:"The Spectrograms",isExpanded:n.has("The Spectrograms"),onToggle:()=>h("The Spectrograms"),children:[l.jsx("p",{children:"The colorful images on tiles are spectrograms - visual pictures of sound. Time flows left to right, pitch goes bottom to top, and brightness shows volume."}),l.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"14px"},children:"With practice, you'll recognize birds by their visual patterns too!"})]}),l.jsxs(Ft,{title:"About & Credits",isExpanded:n.has("About & Credits"),onToggle:()=>h("About & Credits"),children:[l.jsxs("div",{style:{textAlign:"center",marginBottom:"16px"},children:[l.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"   "}),l.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:"Created by Peter Repetti"}),l.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:"Made with love by bird nerds, for bird nerds"})]}),l.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:[l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"Bird sounds:"})," Sourced from"," ",l.jsx("a",{href:"https://xeno-canto.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Xeno-Canto"}),", the"," ",l.jsx("a",{href:"https://www.macaulaylibrary.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Cornell Macaulay Library"})," ","and from user contributions. All sound clips have attribution with XC catalog numbers and recordist names in the Bird Reference (expand any species on the"," ",l.jsx(ma,{to:"/pack-select#bird-reference",state:{fromHelp:!0},style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Pack Select"})," ","screen)."]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"Bird icons:"})," Designed by Peter Repetti with assistance from Claude and ChatGPT (DALL-E 3)."]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"The Tech:"})," Built by Claude Code with TypeScript, React, and PixiJS for buttery-smooth scrolling spectrograms. The Web Audio API handles sample-accurate playback with real-time stereo panning - your browser decodes and buffers audio into memory for zero-latency triggering. Vite bundles it all into a PWA (Progressive Web App) that caches sounds as you play them - so load up those birds before your flight to New Zealand takes off ."]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"Special thanks:"})," To the global birding community for sharing these recordings."]}),l.jsx("p",{style:{marginTop:"16px",fontSize:"13px",fontStyle:"italic"},children:"Good birding! "})]})]}),l.jsxs(Ft,{title:"Support This Project",isExpanded:n.has("Support This Project"),onToggle:()=>h("Support This Project"),children:[l.jsxs("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:["ChipNotes is free, open source, and built as a passion project. If it's helped you level-up your birding skills, consider"," ",l.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"supporting development"})," ","- your donations help me add new species, add features, and do more birding. Now, you go build something cool - it might be easier than you think! ;)"]}),l.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"8px",fontWeight:600},children:"Please also consider supporting the organizations that make this possible, and tell them ChipNotes! sent you:"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"var(--color-text-muted)",lineHeight:1.8},children:[l.jsxs("li",{children:[l.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.birds.cornell.edu/home/support/"})," ","- Incredible bird sound archive"]}),l.jsxs("li",{children:[l.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://xeno-canto.org/about/donate"})," ","- Community-driven bird recording database"]})]}),l.jsx("p",{style:{marginTop:"16px",fontSize:"14px",fontStyle:"italic",color:"var(--color-text-muted)"},children:"Thank you for learning with me! "})]}),l.jsxs(Ft,{title:"Feedback & Bug Reports",isExpanded:n.has("Feedback & Bug Reports"),onToggle:()=>h("Feedback & Bug Reports"),children:[l.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:"I'd love to hear from you! Found a bug? Have a feature suggestion? Want to share your experience?"}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px",marginBottom:"12px"},children:[l.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" Email"}),l.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"feedback@chipnotes.app"})]}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px"},children:[l.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" GitHub Issues"}),l.jsx("a",{href:"https://github.com/chrysogonum/bird-sound-game/issues",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"github.com/chrysogonum/bird-sound-game/issues"})]})]}),l.jsxs("div",{ref:c,children:[l.jsxs("div",{className:"card",style:{marginBottom:"16px",background:"rgba(255, 152, 0, 0.08)",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[l.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"16px",color:"var(--color-accent)"},children:" Recent Updates (v3.23  v3.49)"}),l.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:l.jsxs("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:" 100-Bird Milestone!"}),"  ChipNotes now includes over 100 North American species with curated audio clips and spectrograms"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"New Western Birds"}),"  Western Birds pack expanded from 14 to 18 species including Wrentit, Spotted Towhee, Western Bluebird, and Acorn Woodpecker"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Woodpeckers Pack Expansion"}),"  Added Acorn Woodpecker and Lewis's Woodpecker, growing the pack from 7 to 9 species"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Eastern Birds Pack"}),"  Grew from 40 to 46 species with flycatchers, vireos, and Dark-eyed Junco"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Taxonomic Sorting"}),"  Find and play birds based on how they're related to each other"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder"}),"  Improved search, taxonomic filtering, and ability to save up to 10 named custom packs"]})]})})]}),l.jsxs(Ft,{title:"Full Version History",isExpanded:n.has("Full Version History"),onToggle:()=>h("Full Version History"),children:[l.jsx(Se,{version:"3.50",date:"January 22, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:'Custom Pack: "Save Before Play" Prompt:'}),' When clicking "Start" with an unsaved custom pack, users are now prompted to save before playing. Options include "Save & Play" (opens save dialog then plays), "Just Play" (plays immediately without saving), or "Cancel". Temporary packs are automatically cleared when returning to the builder, providing a clean slate.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack: Rename & Update Improvements:"}),' Redesigned save dialog for editing existing packs. Users can now rename packs by updating the name in the save dialog - the "Update [Pack Name]" button updates the existing pack with the new name and species. Added "Save As New Pack" option to create variants while preserving the original pack.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Navigation Consistency:"})," All back arrows throughout the game are now orange for visual consistency. Gameplay back button now returns to level select (not home page) for better flow. Home icons always return to main menu."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"High Contrast Setting Removed:"})," Removed ineffective high contrast setting from Settings page - the effect was too subtle to be useful for accessibility."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Icon Credits Added:"})," Added attribution for bird icon design in About & Credits section - icons designed by Peter Repetti with assistance from Claude and ChatGPT (DALL-E 3)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"YBSA Canonical Update:"})," Changed Yellow-bellied Sapsucker canonical clip from XC1011116 to XC663258 for improved audio quality."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Select Text Polish:"}),' Changed "6 levels/pack" to "6 levels per pack" for improved readability in Quick Tips section.']})]})}),l.jsx(Se,{version:"3.49",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:'Custom Pack "Play Again" Fix:'}),' Fixed Custom Pack behavior to match regular packs - clicking "Play Again" after completing a round now keeps the same 9 birds instead of shuffling to a new random selection. Previously, custom packs with more than 9 birds would re-shuffle on every "Play Again", breaking the practice loop.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Navigation Consistency:"})," Unified navigation across all screens with orange home icons - Pack Select, Settings, Help, Progress, and Level Select pages now all feature consistent small orange home icons in upper corners for quick navigation back to menu or pack selection."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Page Restructure:"}),' "Recent Updates" card now always visible at top of Help page, with "Full Version History" collapsible below. Improved discoverability of latest features without requiring users to expand sections.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Text Improvements:"}),' Pack descriptions updated for grammatical consistency (numeric formatting, removed redundant words). Section renamed from "The Basics" to "ChipNotes Basics" throughout Help page.']})]})}),l.jsx(Se,{version:"3.48",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Western Birds Pack Expansion:"})," Western Birds pack expanded from 14 to 18 species with Wrentit, Spotted Towhee, Western Bluebird, and Acorn Woodpecker (14 new audio clips and spectrograms). Pack now includes distinctive western species across jays, finches, towhees, bluebirds, and woodpeckers."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Display Fix:"})," Fixed Western Birds levels to display 9 species on wheel (randomly selected from full pool of 18), matching behavior of other large packs like Eastern Birds. Previously showed all 17 species causing UI overflow."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Schema Updates:"})," Increased level schema maximum species_count from 12 to 20 to accommodate growing pack sizes while maintaining 9-species wheel limit for optimal gameplay."]})]})}),l.jsx(Se,{version:"3.47",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Two New Woodpeckers Added:"})," Woodpeckers pack expanded from 7 to 9 species with Acorn Woodpecker and Lewis's Woodpecker. Both western species with distinctive vocalizations."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Select UX Improvements:"})," Added fifth tip bullet pointing users to custom pack builder feature below with pointing emoji. Updated timer anxiety tip for clarity. Pack descriptions updated to reflect new species counts."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Merge Candidates Script Fix:"})," Fixed ",l.jsx("code",{children:"merge_candidates.py"})," to generate proper hash-based clip_ids (matching existing pattern) instead of flawed XC-based IDs. Future bird additions will now have correct unique identifiers from the start."]})]})}),l.jsx(Se,{version:"3.46",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"House Sparrow Added:"})," Sparrows pack now includes 9 species with House Sparrow (3 new audio clips and spectrograms). Common urban sparrow found across North America."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio Clip Curation:"})," Trimmed Swamp Sparrow canonical song clip to remove interfering bird at end. Updated canonical clip selection for improved audio quality."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Critical Safety Improvements:"})," Deleted dangerous ",l.jsx("code",{children:"audio_tagger.py"})," script that destroyed curated metadata. All workflows now use safe ",l.jsx("code",{children:"merge_candidates.py"})," for adding clips. Updated ",l.jsx("code",{children:"/add-bird"})," workflow with auto-updating species_count and stronger warnings about following documented steps."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Workflow Documentation:"})," Added prominent warnings to ",l.jsx("code",{children:"/add-bird"})," command documenting common failure modes (missing species_count updates, UI pack count mismatches, browser cache issues)."]})]})}),l.jsx(Se,{version:"3.45",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Red-eyed Vireo Added:"})," Eastern Birds pack now includes 46 species with Red-eyed Vireo (5 new audio clips and spectrograms). One of the most common forest songbirds in eastern North America."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Add-Bird Workflow Improvements:"})," New automated pack count validation tool prevents UI species count mismatches. Script detects and auto-fixes hardcoded counts in PackSelect and Help screens with ",l.jsx("code",{children:"--fix"})," flag, integrated into add-bird workflow as Step 6c."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Attribution Bug Fix:"})," Fixed merge_candidates.py to generate clickable Xeno-canto source URLs for all new bird additions. Recordist names now appear as proper links in Bird Reference."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Data Consistency:"})," Synced species arrays in expanded_backyard pack definition for clearer data structure (species and display_species now both contain all 46 birds)."]})]})}),l.jsx(Se,{version:"3.44",date:"January 21, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"Documentation Updates:"})," Updated Eastern Birds pack count from 40 to 45 in Help page, and clarified Training Mode can be enabled before or during gameplay."]})})}),l.jsx(Se,{version:"3.43",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference Attribution Overhaul:"}),' Improved clip source attribution system with clear categorization (Xeno-canto, Cornell Macaulay, User-contributed). Compact display format shows "XC667361  Nick Komar" with clickable links to original Xeno-canto recordings. Recovered 363 lost recordist attributions and corrected 78 vocalization type errors from earlier data migration.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Source Transparency:"})," Every clip now clearly shows its origin - Xeno-canto (with catalog number link), Cornell CD track number, or user-contributed recordings. Enables proper attribution to recordists and easy access to original recordings for deeper learning."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Metadata Protection:"})," Enhanced git pre-commit hooks now protect recordist attributions and vocalization type classifications (song/call/drum) in addition to canonical flags, preventing future accidental data loss during bulk operations."]})]})}),l.jsx(Se,{version:"3.42",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"5 New Eastern Birds:"})," Eastern Birds pack from 40 to 45 species with White-eyed Vireo, Acadian Flycatcher, Eastern Phoebe, Great Crested Flycatcher, and Eastern Wood-Pewee (24 new audio clips and spectrograms)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data Integrity Safeguards:"})," Added comprehensive protection for canonical clip flags (Bird Reference signature indicators) including git pre-commit hooks, extensive documentation, and automated validation to prevent accidental data loss."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio Quality Improvements:"})," Trimmed dead space from multiple clips for cleaner, more focused bird vocalizations."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Count Corrections:"})," Updated Eastern Birds pack display to correctly show 45 species across all UI locations."]})]})}),l.jsx(Se,{version:"3.41",date:"January 20, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Dark-eyed Junco added:"})," Eastern Birds pack now includes 40 species (previously 39) with Dark-eyed Junco clips and spectrograms."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Level rotation fix:"})," Fixed bug where newly added species appeared in pack definitions but not in gameplay rotation - Dark-eyed Junco now appears in all 6 levels."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Species count corrections:"})," Updated pack selection and help text to reflect accurate species counts."]})]})}),l.jsx(Se,{version:"3.40",date:"January 20, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Editing:"}),' Load, edit, and update existing saved packs! When you load a pack and modify it, you can choose to update the original pack or save as a new one. Visual indicator shows "Editing: [Pack Name]" at the top of the builder.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Expansion:"}),' Increased max pack size from 9 to 30 birds! For packs with 10+ birds, the game randomly selects 9 for each round with a re-roll button to shuffle the selection. Perfect for creating comprehensive regional packs like "All Midwest Warblers" or "Backyard Regulars."']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack UX:"}),' Made entire bird card clickable (not just the icon) for easier selection, added 4-letter species codes below bird names in taxonomic sort mode, and improved button labels to show "Update / Save As New" when editing.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Spectrogram Fix:"})," Fixed missing spectrograms for species updated in 2025 AOS taxonomy (American Goldfinch, Cedar Waxwing, California Scrub-Jay, Savannah Sparrow) - all 415 clips now have working visual tiles."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Preview Screen UX:"})," Made Training Mode and Taxonomic Sort toggle boxes more visible with subtle background and borders in inactive state."]})]})}),l.jsx(Se,{version:"3.39",date:"January 20, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Separated Controls:"})," Redesigned bird cards with distinct touch areas - play button () on left for audio preview, bird icon on right for add/remove. No more overlapping actions!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Saved Packs:"}),' Save up to 10 named custom packs (e.g., "My Backyard", "Lake Erie Migrants") with persistent localStorage storage. Saved packs appear in a collapsible section with load/delete buttons for easy management across sessions.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Pack Validation & Versioning:"})," Saved packs now auto-validate species codes on load - if birds are removed from the game due to taxonomy updates, you'll see a friendly warning and the pack auto-cleans invalid entries. Includes version field for future migrations and backward compatibility with legacy packs."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Mobile Touch Fix:"})," Fixed delete button not working on mobile devices - replaced native browser confirm() dialog (which was being blocked on touch) with custom modal dialog that works reliably across all devices and screen sizes."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Taxonomic Sorting:"})," Added taxonomic sort toggle ( Taxonomic ) to group birds by evolutionary relationships - perfect for adding related species like all woodpeckers, corvids, or comparing warbler genera. Displays scientific names in italic when active."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Smart Search:"}),' Search behavior now adapts - single match (e.g., "cardinal") auto-clears for next search; multiple matches (e.g., "warbler") keeps filter active so you can select multiple birds from the same group']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Page Navigation:"}),' Repositioned floating buttons for better UX - small " Back" button on bottom left, "Expand/Collapse All" and " Top" grouped on bottom right. All buttons now consistently styled and only appear after scrolling.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Suggestions:"}),' Added note in Packs section: "There are 11,000 birds out there, so more are coming soon" with feedback email link']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Branding Consistency:"}),' Standardized "ChipNotes!" (with !) for logos/titles/first mentions, "ChipNotes" (no !) for prose and mid-sentence references']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Support Section Harmonized:"}),' Updated Help and Settings "Support This Project" sections with consistent messaging emphasizing open source nature and attribution to Cornell/Xeno-Canto']}),l.jsxs("li",{children:[l.jsx("strong",{children:"PWA Safe Area Fix:"})," Fixed content bleeding into iOS status bar on PreRoundPreview screen when installed as home screen app"]})]})}),l.jsx(Se,{version:"3.38",date:"January 20, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Taxonomy Migration:"})," Updated all bird species codes to 2025 AOS/IBP taxonomy - migrated 5 codes (AMGOAGOL, CEWACEDW, SASPSAVS, WESJCASJ, EWPEEAWP) and fixed species names to match current ornithological standards"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data Audit System:"})," Added comprehensive species data validation tools to ensure 100% consistency between game data and the authoritative IBP-AOS-list25.csv taxonomy reference"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Bug Fix:"})," Fixed taxonomic sort toggle re-shuffling birds on preview screen - now correctly re-orders existing birds without selecting new random ones"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Preview Screen Redesign:"}),' Completely overhauled "Ready to Play" page for better space efficiency - compact header, side-by-side toggles, larger bird grid visibility, and new tip box explaining grid positions']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Training Mode Visual Update:"})," Training mode toggle now highlights in green (instead of orange) for better visual distinction from other controls"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Sort Button Clarity:"}),' Alphabetical sort now displays as "Sort" by default, switching to "Taxonomic " when phylogenetic ordering is active']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference Quick Access:"}),` Added  book icon button on preview screen that jumps directly to the pack's Bird Reference section with auto-expansion - includes "Ready to Play?" button for easy return`]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Page Navigation:"}),' Added paired navigation buttons in bottom-right corner: green " Top" for scroll-to-top and orange "Expand/Collapse All" for section management']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Preview Instructions:"}),' Updated preview text to "Tap to preview signature song. Press and hold to get a closer look!" for clearer user guidance']})]})}),l.jsx(Se,{version:"3.37",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Help Documentation:"}),' Added dedicated "Taxonomic Sorting" section to Help page - explains phylogenetic ordering, scientific name display, and how the feature works during gameplay']}),l.jsxs("li",{children:[l.jsx("strong",{children:"README Update:"})," Fixed Backyard Birds species count (56, added Robin) and updated version number"]})]})}),l.jsx(Se,{version:"3.36",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Taxonomic Sort Toggle:"})," Added taxonomic/alphabetical sort toggle to pre-round preview screen - when enabled, shows birds in phylogenetic order with scientific names (italicized) instead of common names "]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Button Sort Persistence:"})," Species buttons during gameplay now respect taxonomic sort preference, making it easier for taxonomically-inclined players to build muscle memory"]})]})}),l.jsx(Se,{version:"3.35",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"2025 AOS Taxonomy:"})," Updated all 86 species to official 2025 American Ornithological Society (66th Supplement) taxonomic positions - fixes phylogenetic ordering across all families, especially warblers (Swainson's Warbler now correctly appears before Setophaga radiation)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Scientific Names Fix:"})," Corrected numerous errors in displayed scientific names - WEWA now shows ",l.jsx("em",{children:"Helmitheros vermivorum"})," (not ",l.jsx("em",{children:"Setophaga pensylvanica"}),"!), plus 13+ other species fixed to match 2025 AOS data"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Species Data File:"})," Added comprehensive species.json with common names, scientific names, genus, species epithet, and taxonomic order for all birds - auto-generated from authoritative IBP-AOS-list25.csv"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder Icons:"})," Replaced generic circles with cute illustrated bird icon images - makes custom pack building more visual and fun!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data Source:"})," All taxonomy from The Institute for Bird Populations' official 2025 AOS list (2352 taxa) - scientifically accurate and up-to-date"]})]})}),l.jsx(Se,{version:"3.34",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Scientific Names:"})," Bird Reference now shows scientific names (italicized) below common names when sorted taxonomically - perfect for learning phylogenetic relationships!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Select UX:"}),' Enhanced grasshopper sparrow joke to read "6 levels/packstart @ #1,  sparrow" - more punchy and visual']}),l.jsxs("li",{children:[l.jsx("strong",{children:"OCWA Clips:"})," Added 7 new Orange-crowned Warbler clips from Xeno-Canto (6 songs, 1 call) - all quality A recordings for expanded species coverage"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio Quality:"})," Trimmed OCWA_985696 to remove interfering bird vocalization at beginning - now shows clean warbler song only"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data Fixes:"})," Removed duplicate OCWA_1046368 entry in clips database, set OCWA_976251 as canonical clip, removed low-quality SASP_1060896 clip"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Home Page:"})," Tightened spacing between title and tagline for better visual balance"]})]})}),l.jsx(Se,{version:"3.33",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Taxonomic Sort:"})," Bird Reference now supports eBird/Clements 2025 taxonomic order - toggle between alphabetical and phylogenetic sorting with a fun easter egg for the science nerds"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Species Fixes:"})," Corrected Carolina Wren code from CAWR to CARW, and Barred Owl from BADO to BAOW - now matches eBird standard across all packs and data files"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"American Robin:"})," Added AMRO to starter pack (now 6 birds) - merged PR #4 with Cornell/Macaulay Library attribution"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Naming:"}),' Simplified "Common Eastern US Backyard Birds" to just "Backyard Birds" everywhere']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Page Polish:"}),' Alphabetized bird list in pack descriptions, added "There are exceptions. Because, ornithology." note to 4-letter codes section']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Navigation Fix:"})," Fixed unwanted auto-scroll when expanding sections after navigating from Pack Select with hash links"]})]})}),l.jsx(Se,{version:"3.32",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Select UX:"})," Simplified intro bullets with direct links to Help (Training Mode section) and Settings - reduced text, added helpful navigation"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Back Button Enhancement:"}),' Made back buttons more prominent on Help and Settings pages (orange color, "Back" text instead of just icon) for better PWA navigation visibility']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Settings Copy:"})," Updated Support section with friendlier wording"]})]})}),l.jsx(Se,{version:"3.31",date:"January 18, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference Link:"}),' Made "Bird Reference" in Tips section clickable - now all references to Pack Select have proper back navigation in PWA mode!']})})}),l.jsx(Se,{version:"3.30",date:"January 18, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"PWA Navigation Fix:"}),` Added "Back to Help" button on Bird Reference screen when navigated from Help page's About & Credits section - complete PWA navigation coverage!`]})})}),l.jsx(Se,{version:"3.29",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"PWA Navigation Enhancement:"}),' Added "Back to Level Select" button on Bird Reference screen when navigated from Level Select - no more getting stuck in PWA mode!']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Rejection tracking system:"})," Clips rejected during review are now logged to prevent re-downloading - no more duplicate review efforts!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Yellow-rumped Warbler (YRWA) quality improvements:"})," Curated down to 2 high-quality clips (from 14 candidates) - improved from Q3 to Q4 with better song/call diversity"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Cedar Waxwing (CEWA) audit:"})," Reviewed and optimized clip selection for better quality and vocalization diversity"]})]})}),l.jsx(Se,{version:"3.28",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference Navigation:"}),` Added contextual "Bird Reference" link from Level Select screen that jumps directly to the selected pack's bird list - easily review sounds before starting a level`]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Improved Xeno-canto Attribution:"}),' Now displays XC catalog numbers (e.g., "XC1015145 - David A. Brinkman") for proper credit and licensing compliance']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Deep Linking:"})," Navigate directly to Bird Reference section from Help page with smooth scrolling"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Auto-Expansion:"})," When navigating from Level Select, the relevant pack automatically expands in Bird Reference"]})]})}),l.jsx(Se,{version:"3.27",date:"January 18, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"Share Card UX:"}),' Improved share instructions with upward arrow emoji and clearer text "Press and hold the image above" to prevent confusion']})})}),l.jsx(Se,{version:"3.26",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"PWA Home Screen Fix:"})," Fixed 404 error when adding ChipNotes to iPhone home screen - start_url now correctly points to root path"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Manifest Update:"}),' Updated PWA description to match new tagline "Train your ear. Know the birds."']})]})}),l.jsx(Se,{version:"3.25",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Home Screen Refresh:"}),' New tagline "Train your ear. Know the birds." emphasizes the educational journey and real-world birding payoff']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Enhanced Visual Flow:"}),' Added 3-step "Hear  Match  Train" diagram with brain icon to clearly show the learning process']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Cleaner Layout:"})," Redesigned home screen with tighter spacing and more intuitive visual hierarchy"]})]})}),l.jsx(Se,{version:"3.24",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Share Card Polish:"})," Refined share card design with circular bird icons and owl mascot, cleaner font hierarchy (removed monospace, reduced bold usage), and improved spacing for better visual balance"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Icon Improvements:"})," Bird icons and owl now display as perfect circles with proper aspect ratio scaling - no more white backgrounds or distortion"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Layout Refinement:"})," Moved Best Streak above bird icons, tightened spacing between pack/level and bird codes, centered text better in available space"]})]})}),l.jsx(Se,{version:"3.23",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Share Score Card:"})," New shareable score card feature - download or share your round results with fun bird icons, stats, and confusion matrix highlights"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Domain:"})," ChipNotes now available at ",l.jsx("a",{href:"https://chipnotes.app",style:{color:"var(--color-accent)"},children:"chipnotes.app"})," - easier to remember and share!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Training Mode indicator:"})," Share cards now show when Training Mode was used during the round"]})]})}),l.jsx(Se,{version:"3.22",date:"January 17, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"Version chronology fix:"})," Moved v3.02 and v3.03 to correct position in version history (after v3.13, before v2.0) - no more time-traveling versions!"]})})}),l.jsx(Se,{version:"3.21",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"All Birds pack race condition fix:"})," Fixed state management bug where pack JSON loading overwrote the All Birds pack, causing it to disappear - now merges state correctly to preserve all packs"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Clickable version number:"})," Main menu version now links to Version History - auto-expands and scrolls to changelog"]})]})}),l.jsx(Se,{version:"3.20",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Service worker cache fix:"}),' Fixed "Twilight Zone" bug where All Birds pack appeared on first load but disappeared after refresh - hashed JS bundles no longer cached, ensuring fresh code always loads']}),l.jsxs("li",{children:[l.jsx("strong",{children:"PWA stability:"})," Installed PWAs now properly update to show latest changes without requiring reinstall"]})]})}),l.jsx(Se,{version:"3.19",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Version numbering fix:"})," Renamed v3.4 to v3.19 to maintain sequential ordering - fixes Apple-style confusion where 3.4 appeared after 3.18"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help page UX:"})," Collapsible sections with floating Expand All button - less scrolling, more scanning"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"All Birds reference:"})," Fixed missing bird icons in Bird Reference pack"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Navigation improvements:"})," Added Back button at bottom of Help page, Help link in Settings for easy cross-navigation"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Support link:"})," Ko-fi donation link added to Settings - buy me a coffee if ChipNotes helps you ID more birds"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Tech description restored:"})," Brought back the detailed tech paragraph about TypeScript, React, PixiJS, and PWA offline caching"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Privacy language:"}),' Updated Settings privacy text to be more neutral and less "we"-focused, "not stalking you" instead of "them"']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Credits update:"})," Added Cornell Macaulay Library, user contributions, and Bird Reference attribution"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Project timeline:"})," Documented creation timeline (Jan 8-11, 2026) and Claude Code collaboration"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Voice consistency:"}),' Changed "we" to "I" in Feedback section']})]})}),l.jsx(Se,{version:"3.18",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"UI polish:"})," Streamlined pack selection, tightened layout, less visual clutter"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder:"}),' Sticky "Start" button stays visible with iOS keyboard, auto-focus for rapid bird entry, added preview tip']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help page:"})," Reorganized sections, added creator attribution"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Privacy page:"})," Full privacy policy accessible from Settings"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Analytics fix:"})," Fixed gtag initialization pattern - tracking now works correctly"]})]})}),l.jsx(Se,{version:"3.17",date:"January 16, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Cookie consent:"})," I know I'm a stranger, but please accept my cookies! It really helps me document how many players I have and which birds everyone loves. (GDPR-compliant banner now appears on first visit)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Privacy controls:"}),' Changed your mind? New "Analytics Cookies" toggle in Settings lets you opt in/out anytime']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Your data is safe:"})," IP anonymization enabled, secure cookie flags set, full GDPR/CCPA compliance - I promise I'm just adding bird nerds to my LIFE LIST, not stalking you"]})]})}),l.jsx(Se,{version:"3.16",date:"January 16, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference enhancement:"})," Separated display species (40) from gameplay rotation (28) for Eastern Birds pack - Bird Reference now shows all available species for preview"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"UI improvements:"})," Streamlined pack selection tips, improved Help page tips with confusion matrix mention"]})]})}),l.jsx(Se,{version:"3.15",date:"January 16, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Xeno-canto attribution:"})," All Xeno-canto recordings now display recordist names for legal compliance (355 recordings attributed to 87+ contributors)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help page enhancements:"}),' Added "Why Learn Bird Song?" section explaining the educational value of left/right audio training, tech details about PWA offline caching']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio curation:"})," Extensive clip review and quality improvements - refined canonical clips, updated vocalization types (call/song/drum), removed low-quality recordings"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"UI improvements:"}),' Moved shuffle button above bird grid for better visibility, added "Coming Soon" banner to Stats screen to clarify demo data']}),l.jsxs("li",{children:[l.jsx("strong",{children:"New bird icons:"})," Added icons for upcoming Macaulay species (ACFL, EAPH, EWPE, WEVI)"]})]})}),l.jsx(Se,{version:"3.14",date:"January 15, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Analytics:"})," Added Google Analytics 4 tracking for usage insights (page views, pack/level selections, Training Mode adoption)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data fixes:"})," Restored BCCH, MODO, and WBNU clips lost during Cornell CD processing"]})]})}),l.jsx(Se,{version:"3.13",date:"January 15, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Western Birds pack:"})," 14 new species including Steller's Jay, California Scrub-Jay, Black-capped Chickadee, and more. Fixed to use 9 random birds per round."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio improvements:"})," Restored canonical clips for 71+ species, resolved 202 broken audio references, cleaned up duplicate EATO clips (115)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"UI refinements:"})," Black backgrounds on Training Mode labels for better readability, Warbler Academy icon updated to Blackburnian Warbler, improved loading indicators"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference enhancements:"})," Collapsible packs with expand/collapse controls, source badges (Xeno-canto, Cornell, contributors), pack cards with representative bird icons"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Fixed blank spectrograms"})," (async texture loading), added pull-to-refresh on main menu, audio preloading on preview screen"]}),l.jsx("li",{children:"Added White-crowned Sparrow to Sparrows pack (now 9 species)"})]})}),l.jsx(Se,{version:"3.03",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Quit button:"})," Added X button during gameplay to quit rounds early with confirmation"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Support section:"})," Added Ko-fi donation link and encouragement to support Cornell Macaulay Library and Xeno-Canto"]})]})}),l.jsx(Se,{version:"3.02",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Mobile navigation fix:"})," Bottom menu icons now properly visible on both Safari and Chrome mobile browsers"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Fullscreen tip:"})," Added browser guidance for best mobile experience"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"PWA improvements:"})," Enhanced Apple mobile web app support"]})]})}),l.jsx(Se,{version:"2.0",date:"January 12, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsx("li",{children:"Rebranded to ChipNotes! with Owl Professor mascot"}),l.jsx("li",{children:"Training Mode: Toggle eye icon to show bird labels on tiles"}),l.jsx("li",{children:"Warbler Academy pack: 33 wood-warbler species for experts"}),l.jsx("li",{children:"Complete icon set: Hand-illustrated icons for all 91+ species"}),l.jsx("li",{children:"Added Eastern Towhee to Expanded Backyard pack"}),l.jsx("li",{children:"Birds now persist between rounds by default"}),l.jsx("li",{children:"Fixed scoring to allow full 100 points as documented"}),l.jsx("li",{children:"iOS audio improvements and playback fixes"})]})}),l.jsx(Se,{version:"1.0",date:"January 11, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsx("li",{children:"Initial release with 6 bird packs"}),l.jsx("li",{children:"Pre-round preview screen to hear and see birds before playing"}),l.jsx("li",{children:"Custom pack builder for targeted practice"}),l.jsx("li",{children:"Continuous play mode (untimed, relaxed practice)"}),l.jsx("li",{children:"Enhanced round summary with per-species breakdown"}),l.jsx("li",{children:"Progressive difficulty: 6 levels per pack"}),l.jsx("li",{children:"Real spectrograms for visual learning"}),l.jsx("li",{children:"PWA support for offline play and mobile installation"})]})})]})]}),l.jsx("div",{style:{height:"120px"}})]}),s&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>{var v;return(v=e.state)!=null&&v.fromPackSelect?t("/pack-select"):t(-1)},style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",left:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",zIndex:1e3},onMouseEnter:v=>{v.currentTarget.style.transform="scale(1.05)",v.currentTarget.style.background="rgba(255, 152, 0, 0.25)",v.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:v=>{v.currentTarget.style.transform="scale(1)",v.currentTarget.style.background="rgba(255, 152, 0, 0.15)",v.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},"aria-label":"Back",children:[l.jsx("span",{style:{fontSize:"12px"},children:""}),"Back"]}),l.jsxs("button",{onClick:p,style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",right:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",zIndex:1e3},onMouseEnter:v=>{v.currentTarget.style.transform="scale(1.05)",v.currentTarget.style.background="rgba(255, 152, 0, 0.25)",v.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:v=>{v.currentTarget.style.transform="scale(1)",v.currentTarget.style.background="rgba(255, 152, 0, 0.15)",v.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},children:[l.jsx("span",{style:{fontSize:"12px"},children:f?"":""}),f?"Collapse All":"Expand All"]})]})]})}function Ft({id:t,title:e,children:r,isExpanded:n,onToggle:i}){return l.jsxs("div",{id:t,style:{marginBottom:"16px",scrollMarginTop:"20px"},children:[l.jsxs("h3",{onClick:i,style:{fontSize:"16px",fontWeight:600,marginBottom:n?"12px":"0",color:"var(--color-accent)",borderBottom:"1px solid var(--color-surface)",paddingBottom:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"color 0.2s",userSelect:"none"},onMouseEnter:s=>s.currentTarget.style.color="#FFA726",onMouseLeave:s=>s.currentTarget.style.color="var(--color-accent)",children:[l.jsx("span",{style:{fontSize:"14px",width:"14px",textAlign:"center",flexShrink:0},children:n?"":""}),e]}),n&&l.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,color:"var(--color-text)"},children:r})]})}function wl({label:t,points:e,description:r,color:n}){return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[l.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:n,minWidth:"40px"},children:["+",e]}),l.jsxs("div",{children:[l.jsx("span",{style:{fontWeight:600},children:t}),l.jsx("span",{style:{color:"var(--color-text-muted)",marginLeft:"8px",fontSize:"13px"},children:r})]})]})}function ns({name:t,description:e}){return l.jsxs("div",{style:{marginBottom:"12px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px"},children:[l.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:t}),l.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:e})]})}function is({level:t,title:e,description:r}){return l.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[l.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:"var(--color-accent)",minWidth:"24px"},children:t}),l.jsxs("div",{children:[l.jsx("span",{style:{fontWeight:600},children:e}),l.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:r})]})]})}function ss({children:t}){return l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""}),l.jsx("span",{children:t})]})}function Se({version:t,date:e,children:r}){return l.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"8px",marginBottom:"8px"},children:[l.jsxs("span",{style:{fontWeight:700,fontSize:"16px",color:"var(--color-accent)"},children:["v",t]}),l.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:e})]}),r]})}function Jj(){return l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),l.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function Qj(){const t=er();return l.jsxs("div",{className:"screen",children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:l.jsx(Zj,{})}),l.jsx("h2",{style:{margin:0},children:"Privacy Policy"})]}),l.jsxs("div",{className:"flex-col gap-lg",style:{maxWidth:"800px"},children:[l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{children:"Last Updated:"})," January 20, 2026"]}),l.jsx("p",{style:{marginBottom:"12px"},children:"ChipNotes! is committed to protecting your privacy. This policy explains what data is collected, how it is used, and your rights."})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Data Collection"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Local Data (Always Stored on Your Device):"})}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsx("li",{children:"Game settings (scroll speed, spectrogram mode, high contrast, continuous play)"}),l.jsx("li",{children:"Custom pack selections (bird species you choose) and saved custom packs (pack names you create, up to 10 packs)"}),l.jsx("li",{children:"Round results and scores (not linked to your identity)"}),l.jsx("li",{children:"Cookie consent preference"})]}),l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Analytics Data (Only if You Consent):"})}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsx("li",{children:"Anonymized usage data via Google Analytics (IP addresses are anonymized)"}),l.jsx("li",{children:"Which features are used and which birds are practiced"}),l.jsx("li",{children:"App performance metrics"})]}),l.jsxs("p",{style:{fontSize:"13px",color:"var(--color-accent)"},children:[l.jsx("strong",{children:"Not collected:"})," Names, email addresses, phone numbers, precise location, or any personally identifiable information. Your game data stays on your device."]})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"How Your Data Is Used"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:l.jsxs("ul",{style:{marginLeft:"20px"},children:[l.jsx("li",{children:"Local data: Saves your preferences and tracks your progress"}),l.jsx("li",{children:"Analytics data: Used to understand how many players use ChipNotes, which features are popular, and how to improve the app"}),l.jsx("li",{children:"Your data is never sold, rented, or shared with third parties (except Google Analytics if you consent)"})]})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Third-Party Services"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsxs("p",{style:{marginBottom:"8px"},children:[l.jsx("strong",{children:"Google Analytics"})," (only if you consent)"]}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsx("li",{children:"Used to collect anonymized usage statistics"}),l.jsx("li",{children:"IP anonymization enabled"}),l.jsx("li",{children:"No ad personalization or cross-device tracking"}),l.jsxs("li",{children:["Learn more: ",l.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Google Privacy Policy"})]})]}),l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Xeno-Canto Audio"})}),l.jsxs("ul",{style:{marginLeft:"20px"},children:[l.jsx("li",{children:"Bird sound recordings are sourced from Xeno-Canto and cached locally on your device"}),l.jsx("li",{children:"No data is sent to Xeno-Canto when you play sounds offline"})]})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Your Rights"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:"You have the right to:"}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Access your data:"})," All local data is stored in your browser's localStorage (visible in browser dev tools)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Delete your data:"}),' Delete individual saved custom packs using the Delete button in Custom Pack Builder, or use the "Reset All Progress" button in Settings to delete all local data and cache']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Withdraw consent:"}),' Toggle "Analytics" in Settings to disable Google Analytics at any time']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data portability:"})," Local data can be exported via browser dev tools (localStorage)"]})]}),l.jsx("p",{style:{fontSize:"13px"},children:"Since all game data is stored locally on your device, you have full control. Uninstalling the app or clearing browser data will permanently delete all your data."})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Cookies & Local Storage"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Essential (Always Active):"})}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsxs("li",{children:[l.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"chipnotes_cookie_consent"})," - Stores your cookie consent choice"]}),l.jsxs("li",{children:[l.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"soundfield_*"})," - Game settings and progress (all stored in localStorage)"]})]}),l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Analytics (Only if You Consent):"})}),l.jsx("ul",{style:{marginLeft:"20px"},children:l.jsxs("li",{children:[l.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga"}),", ",l.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga_*"})," - Google Analytics cookies (2-year expiration)"]})})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Data Security"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:l.jsxs("ul",{style:{marginLeft:"20px"},children:[l.jsx("li",{children:"All data is stored locally on your device (no cloud servers)"}),l.jsx("li",{children:"HTTPS encryption for all web traffic"}),l.jsx("li",{children:"No user accounts or authentication (no password risks)"}),l.jsx("li",{children:"Service Worker caches audio files for offline use (stored locally)"})]})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Children's Privacy"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:l.jsx("p",{children:"ChipNotes does not knowingly collect data from children under 13. The app does not require any personal information, and analytics are opt-in. Parents can disable analytics in Settings."})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"International Users"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:"ChipNotes complies with:"}),l.jsxs("ul",{style:{marginLeft:"20px"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"GDPR"})," (European Union) - Right to access, deletion, and data portability"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"CCPA"})," (California) - Right to know and delete personal information"]}),l.jsx("li",{children:"Since no personal information is collected, compliance is straightforward"})]})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Changes to This Policy"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:l.jsx("p",{children:'This Privacy Policy may be updated from time to time. Changes will be posted on this page with an updated "Last Updated" date. Continued use of the app after changes constitutes acceptance of the updated policy.'})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Contact Us"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:"Questions about this Privacy Policy or your data?"}),l.jsxs("p",{children:["Email:"," ",l.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]})]})]})]})]})}function Zj(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}const Hd="chipnotes_cookie_consent";function Fy(){if(typeof window>"u")return;if(window.gtag){console.log("Google Analytics already loaded");return}window.dataLayer=window.dataLayer||[],window.gtag=function(){var e;(e=window.dataLayer)==null||e.push(arguments)},window.gtag("js",new Date),window.gtag("config","G-MJXQZYWWZ0",{anonymize_ip:!0,cookie_flags:"SameSite=Lax;Secure",cookie_expires:63072e3,allow_ad_personalization_signals:!1,allow_google_signals:!1});const t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-MJXQZYWWZ0",document.head.appendChild(t),console.log("Google Analytics loading with user consent")}function eM(){const[t,e]=S.useState(!1);S.useEffect(()=>{const i=localStorage.getItem(Hd);i==="accepted"?Fy():i===null&&e(!0)},[]);const r=()=>{localStorage.setItem(Hd,"accepted"),e(!1),Fy(),setTimeout(()=>{window.location.reload()},100)},n=()=>{localStorage.setItem(Hd,"declined"),e(!1),setTimeout(()=>{window.location.reload()},100)};return t?l.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"rgba(26, 26, 46, 0.98)",backdropFilter:"blur(10px)",borderTop:"1px solid var(--color-primary)",padding:"16px",paddingBottom:"calc(16px + var(--safe-area-bottom, 0px))",zIndex:1e4,boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.3)"},children:l.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"12px"},children:[l.jsxs("div",{style:{fontSize:"14px",lineHeight:1.5,color:"var(--color-text)"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:" Cookies & Privacy"}),l.jsxs("p",{style:{margin:"8px 0 0 0",color:"var(--color-text-muted)"},children:["We use Google Analytics to understand how people use ChipNotes and improve the app. This helps us know which features are useful and which birds people practice most. We anonymize your IP address and don't collect personal information."," ",l.jsx("a",{href:"/bird-sound-game/privacy",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Learn more"})]})]}),l.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[l.jsx("button",{onClick:r,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="#3a7332"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-primary)"},children:"Accept Analytics"}),l.jsx("button",{onClick:n,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-surface)",color:"var(--color-text)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="var(--color-background)"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-surface)"},children:"Decline"})]})]})}):null}function tM(){return l.jsxs(l.Fragment,{children:[l.jsxs(PE,{children:[l.jsx(tr,{path:"/",element:l.jsx(zE,{})}),l.jsx(tr,{path:"/pack-select",element:l.jsx(ZE,{})}),l.jsx(tr,{path:"/level-select",element:l.jsx(lT,{})}),l.jsx(tr,{path:"/preview",element:l.jsx(xT,{})}),l.jsx(tr,{path:"/custom-pack",element:l.jsx(wT,{})}),l.jsx(tr,{path:"/gameplay",element:l.jsx(Uj,{})}),l.jsx(tr,{path:"/summary",element:l.jsx(Gj,{})}),l.jsx(tr,{path:"/settings",element:l.jsx(Wj,{})}),l.jsx(tr,{path:"/progress",element:l.jsx(Yj,{})}),l.jsx(tr,{path:"/help",element:l.jsx(qj,{})}),l.jsx(tr,{path:"/privacy",element:l.jsx(Qj,{})})]}),l.jsx(eM,{})]})}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{for(const e of t)e.unregister()});$d.createRoot(document.getElementById("root")).render(l.jsx(Xy.StrictMode,{children:l.jsx(LE,{basename:"/",children:l.jsx(tM,{})})}));
