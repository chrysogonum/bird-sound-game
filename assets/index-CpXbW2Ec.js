var tw=Object.defineProperty;var rw=(t,e,r)=>e in t?tw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var vn=(t,e,r)=>rw(t,typeof e!="symbol"?e+"":e,r);function nw(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Ro=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function iw(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Iy={exports:{}},jc={},My={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ga=Symbol.for("react.element"),sw=Symbol.for("react.portal"),ow=Symbol.for("react.fragment"),aw=Symbol.for("react.strict_mode"),lw=Symbol.for("react.profiler"),cw=Symbol.for("react.provider"),uw=Symbol.for("react.context"),dw=Symbol.for("react.forward_ref"),hw=Symbol.for("react.suspense"),fw=Symbol.for("react.memo"),pw=Symbol.for("react.lazy"),am=Symbol.iterator;function mw(t){return t===null||typeof t!="object"?null:(t=am&&t[am]||t["@@iterator"],typeof t=="function"?t:null)}var jy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},By=Object.assign,Ny={};function Ys(t,e,r){this.props=t,this.context=e,this.refs=Ny,this.updater=r||jy}Ys.prototype.isReactComponent={};Ys.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ys.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Fy(){}Fy.prototype=Ys.prototype;function Ff(t,e,r){this.props=t,this.context=e,this.refs=Ny,this.updater=r||jy}var Lf=Ff.prototype=new Fy;Lf.constructor=Ff;By(Lf,Ys.prototype);Lf.isPureReactComponent=!0;var lm=Array.isArray,Ly=Object.prototype.hasOwnProperty,Df={current:null},Dy={key:!0,ref:!0,__self:!0,__source:!0};function Oy(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Ly.call(e,n)&&!Dy.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:ga,type:t,key:s,ref:o,props:i,_owner:Df.current}}function gw(t,e){return{$$typeof:ga,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Of(t){return typeof t=="object"&&t!==null&&t.$$typeof===ga}function xw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var cm=/\/+/g;function xu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?xw(""+t.key):e.toString(36)}function yl(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ga:case sw:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+xu(o,0):n,lm(i)?(r="",t!=null&&(r=t.replace(cm,"$&/")+"/"),yl(i,e,r,"",function(u){return u})):i!=null&&(Of(i)&&(i=gw(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(cm,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",lm(t))for(var a=0;a<t.length;a++){s=t[a];var c=n+xu(s,a);o+=yl(s,e,r,c,i)}else if(c=mw(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=n+xu(s,a++),o+=yl(s,e,r,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ra(t,e,r){if(t==null)return t;var n=[],i=0;return yl(t,n,"","",function(s){return e.call(r,s,i++)}),n}function yw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kt={current:null},vl={transition:null},vw={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:vl,ReactCurrentOwner:Df};function Uy(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:Ra,forEach:function(t,e,r){Ra(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ra(t,function(){e++}),e},toArray:function(t){return Ra(t,function(e){return e})||[]},only:function(t){if(!Of(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ae.Component=Ys;Ae.Fragment=ow;Ae.Profiler=lw;Ae.PureComponent=Ff;Ae.StrictMode=aw;Ae.Suspense=hw;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vw;Ae.act=Uy;Ae.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=By({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Df.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Ly.call(e,c)&&!Dy.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:ga,type:t.type,key:i,ref:s,props:n,_owner:o}};Ae.createContext=function(t){return t={$$typeof:uw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:cw,_context:t},t.Consumer=t};Ae.createElement=Oy;Ae.createFactory=function(t){var e=Oy.bind(null,t);return e.type=t,e};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(t){return{$$typeof:dw,render:t}};Ae.isValidElement=Of;Ae.lazy=function(t){return{$$typeof:pw,_payload:{_status:-1,_result:t},_init:yw}};Ae.memo=function(t,e){return{$$typeof:fw,type:t,compare:e===void 0?null:e}};Ae.startTransition=function(t){var e=vl.transition;vl.transition={};try{t()}finally{vl.transition=e}};Ae.unstable_act=Uy;Ae.useCallback=function(t,e){return kt.current.useCallback(t,e)};Ae.useContext=function(t){return kt.current.useContext(t)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(t){return kt.current.useDeferredValue(t)};Ae.useEffect=function(t,e){return kt.current.useEffect(t,e)};Ae.useId=function(){return kt.current.useId()};Ae.useImperativeHandle=function(t,e,r){return kt.current.useImperativeHandle(t,e,r)};Ae.useInsertionEffect=function(t,e){return kt.current.useInsertionEffect(t,e)};Ae.useLayoutEffect=function(t,e){return kt.current.useLayoutEffect(t,e)};Ae.useMemo=function(t,e){return kt.current.useMemo(t,e)};Ae.useReducer=function(t,e,r){return kt.current.useReducer(t,e,r)};Ae.useRef=function(t){return kt.current.useRef(t)};Ae.useState=function(t){return kt.current.useState(t)};Ae.useSyncExternalStore=function(t,e,r){return kt.current.useSyncExternalStore(t,e,r)};Ae.useTransition=function(){return kt.current.useTransition()};Ae.version="18.3.1";My.exports=Ae;var S=My.exports;const zy=Nf(S),_w=nw({__proto__:null,default:zy},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ww=S,Sw=Symbol.for("react.element"),bw=Symbol.for("react.fragment"),Ew=Object.prototype.hasOwnProperty,Tw=ww.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Aw={key:!0,ref:!0,__self:!0,__source:!0};function Gy(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Ew.call(e,n)&&!Aw.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Sw,type:t,key:s,ref:o,props:i,_owner:Tw.current}}jc.Fragment=bw;jc.jsx=Gy;jc.jsxs=Gy;Iy.exports=jc;var l=Iy.exports,zd={},Hy={exports:{}},Yt={},$y={exports:{}},Vy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(k,U){var R=k.length;k.push(U);e:for(;0<R;){var E=R-1>>>1,F=k[E];if(0<i(F,U))k[E]=U,k[R]=F,R=E;else break e}}function r(k){return k.length===0?null:k[0]}function n(k){if(k.length===0)return null;var U=k[0],R=k.pop();if(R!==U){k[0]=R;e:for(var E=0,F=k.length,j=F>>>1;E<j;){var q=2*(E+1)-1,J=k[q],B=q+1,Y=k[B];if(0>i(J,R))B<F&&0>i(Y,J)?(k[E]=Y,k[B]=R,E=B):(k[E]=J,k[q]=R,E=q);else if(B<F&&0>i(Y,R))k[E]=Y,k[B]=R,E=B;else break e}}return U}function i(k,U){var R=k.sortIndex-U.sortIndex;return R!==0?R:k.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(k){for(var U=r(u);U!==null;){if(U.callback===null)n(u);else if(U.startTime<=k)n(u),U.sortIndex=U.expirationTime,e(c,U);else break;U=r(u)}}function w(k){if(v=!1,g(k),!m)if(r(c)!==null)m=!0,H(T);else{var U=r(u);U!==null&&W(w,U.startTime-k)}}function T(k,U){m=!1,v&&(v=!1,y(b),b=-1),p=!0;var R=f;try{for(g(U),h=r(c);h!==null&&(!(h.expirationTime>U)||k&&!L());){var E=h.callback;if(typeof E=="function"){h.callback=null,f=h.priorityLevel;var F=E(h.expirationTime<=U);U=t.unstable_now(),typeof F=="function"?h.callback=F:h===r(c)&&n(c),g(U)}else n(c);h=r(c)}if(h!==null)var j=!0;else{var q=r(u);q!==null&&W(w,q.startTime-U),j=!1}return j}finally{h=null,f=R,p=!1}}var A=!1,C=null,b=-1,I=5,N=-1;function L(){return!(t.unstable_now()-N<I)}function D(){if(C!==null){var k=t.unstable_now();N=k;var U=!0;try{U=C(!0,k)}finally{U?P():(A=!1,C=null)}}else A=!1}var P;if(typeof x=="function")P=function(){x(D)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,z=O.port2;O.port1.onmessage=D,P=function(){z.postMessage(null)}}else P=function(){_(D,0)};function H(k){C=k,A||(A=!0,P())}function W(k,U){b=_(function(){k(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(k){k.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,H(T))},t.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<k?Math.floor(1e3/k):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(k){switch(f){case 1:case 2:case 3:var U=3;break;default:U=f}var R=f;f=U;try{return k()}finally{f=R}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(k,U){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var R=f;f=k;try{return U()}finally{f=R}},t.unstable_scheduleCallback=function(k,U,R){var E=t.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?E+R:E):R=E,k){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=R+F,k={id:d++,callback:U,priorityLevel:k,startTime:R,expirationTime:F,sortIndex:-1},R>E?(k.sortIndex=R,e(u,k),r(c)===null&&k===r(u)&&(v?(y(b),b=-1):v=!0,W(w,R-E))):(k.sortIndex=F,e(c,k),m||p||(m=!0,H(T))),k},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(k){var U=f;return function(){var R=f;f=U;try{return k.apply(this,arguments)}finally{f=R}}}})(Vy);$y.exports=Vy;var Cw=$y.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kw=S,Xt=Cw;function V(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wy=new Set,Vo={};function Bi(t,e){Ds(t,e),Ds(t+"Capture",e)}function Ds(t,e){for(Vo[t]=e,t=0;t<e.length;t++)Wy.add(e[t])}var an=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gd=Object.prototype.hasOwnProperty,Pw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,um={},dm={};function Rw(t){return Gd.call(dm,t)?!0:Gd.call(um,t)?!1:Pw.test(t)?dm[t]=!0:(um[t]=!0,!1)}function Iw(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Mw(t,e,r,n){if(e===null||typeof e>"u"||Iw(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pt(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xt[t]=new Pt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xt[e]=new Pt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xt[t]=new Pt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xt[t]=new Pt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xt[t]=new Pt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xt[t]=new Pt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xt[t]=new Pt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xt[t]=new Pt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xt[t]=new Pt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Uf=/[\-:]([a-z])/g;function zf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Uf,zf);xt[e]=new Pt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Uf,zf);xt[e]=new Pt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Uf,zf);xt[e]=new Pt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xt[t]=new Pt(t,1,!1,t.toLowerCase(),null,!1,!1)});xt.xlinkHref=new Pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xt[t]=new Pt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Gf(t,e,r,n){var i=xt.hasOwnProperty(e)?xt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Mw(e,r,i,n)&&(r=null),n||i===null?Rw(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var fn=kw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ia=Symbol.for("react.element"),us=Symbol.for("react.portal"),ds=Symbol.for("react.fragment"),Hf=Symbol.for("react.strict_mode"),Hd=Symbol.for("react.profiler"),Xy=Symbol.for("react.provider"),Yy=Symbol.for("react.context"),$f=Symbol.for("react.forward_ref"),$d=Symbol.for("react.suspense"),Vd=Symbol.for("react.suspense_list"),Vf=Symbol.for("react.memo"),Tn=Symbol.for("react.lazy"),Ky=Symbol.for("react.offscreen"),hm=Symbol.iterator;function ro(t){return t===null||typeof t!="object"?null:(t=hm&&t[hm]||t["@@iterator"],typeof t=="function"?t:null)}var Xe=Object.assign,yu;function yo(t){if(yu===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);yu=e&&e[1]||""}return`
`+yu+t}var vu=!1;function _u(t,e){if(!t||vu)return"";vu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{vu=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?yo(t):""}function jw(t){switch(t.tag){case 5:return yo(t.type);case 16:return yo("Lazy");case 13:return yo("Suspense");case 19:return yo("SuspenseList");case 0:case 2:case 15:return t=_u(t.type,!1),t;case 11:return t=_u(t.type.render,!1),t;case 1:return t=_u(t.type,!0),t;default:return""}}function Wd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ds:return"Fragment";case us:return"Portal";case Hd:return"Profiler";case Hf:return"StrictMode";case $d:return"Suspense";case Vd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Yy:return(t.displayName||"Context")+".Consumer";case Xy:return(t._context.displayName||"Context")+".Provider";case $f:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Vf:return e=t.displayName||null,e!==null?e:Wd(t.type)||"Memo";case Tn:e=t._payload,t=t._init;try{return Wd(t(e))}catch{}}return null}function Bw(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wd(e);case 8:return e===Hf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Nw(t){var e=qy(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ma(t){t._valueTracker||(t._valueTracker=Nw(t))}function Jy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=qy(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Gl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Xd(t,e){var r=e.checked;return Xe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function fm(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Xn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Qy(t,e){e=e.checked,e!=null&&Gf(t,"checked",e,!1)}function Yd(t,e){Qy(t,e);var r=Xn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kd(t,e.type,r):e.hasOwnProperty("defaultValue")&&Kd(t,e.type,Xn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Kd(t,e,r){(e!=="number"||Gl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var vo=Array.isArray;function Es(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Xn(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function qd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(V(91));return Xe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mm(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(V(92));if(vo(r)){if(1<r.length)throw Error(V(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Xn(r)}}function Zy(t,e){var r=Xn(e.value),n=Xn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function gm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ev(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ev(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ja,tv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ja=ja||document.createElement("div"),ja.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ja.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Wo(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Io={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fw=["Webkit","ms","Moz","O"];Object.keys(Io).forEach(function(t){Fw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Io[e]=Io[t]})});function rv(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Io.hasOwnProperty(t)&&Io[t]?(""+e).trim():e+"px"}function nv(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=rv(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Lw=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qd(t,e){if(e){if(Lw[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(V(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(V(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(V(61))}if(e.style!=null&&typeof e.style!="object")throw Error(V(62))}}function Zd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eh=null;function Wf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var th=null,Ts=null,As=null;function xm(t){if(t=va(t)){if(typeof th!="function")throw Error(V(280));var e=t.stateNode;e&&(e=Dc(e),th(t.stateNode,t.type,e))}}function iv(t){Ts?As?As.push(t):As=[t]:Ts=t}function sv(){if(Ts){var t=Ts,e=As;if(As=Ts=null,xm(t),e)for(t=0;t<e.length;t++)xm(e[t])}}function ov(t,e){return t(e)}function av(){}var wu=!1;function lv(t,e,r){if(wu)return t(e,r);wu=!0;try{return ov(t,e,r)}finally{wu=!1,(Ts!==null||As!==null)&&(av(),sv())}}function Xo(t,e){var r=t.stateNode;if(r===null)return null;var n=Dc(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(V(231,e,typeof r));return r}var rh=!1;if(an)try{var no={};Object.defineProperty(no,"passive",{get:function(){rh=!0}}),window.addEventListener("test",no,no),window.removeEventListener("test",no,no)}catch{rh=!1}function Dw(t,e,r,n,i,s,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var Mo=!1,Hl=null,$l=!1,nh=null,Ow={onError:function(t){Mo=!0,Hl=t}};function Uw(t,e,r,n,i,s,o,a,c){Mo=!1,Hl=null,Dw.apply(Ow,arguments)}function zw(t,e,r,n,i,s,o,a,c){if(Uw.apply(this,arguments),Mo){if(Mo){var u=Hl;Mo=!1,Hl=null}else throw Error(V(198));$l||($l=!0,nh=u)}}function Ni(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function cv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ym(t){if(Ni(t)!==t)throw Error(V(188))}function Gw(t){var e=t.alternate;if(!e){if(e=Ni(t),e===null)throw Error(V(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return ym(i),t;if(s===n)return ym(i),e;s=s.sibling}throw Error(V(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(V(189))}}if(r.alternate!==n)throw Error(V(190))}if(r.tag!==3)throw Error(V(188));return r.stateNode.current===r?t:e}function uv(t){return t=Gw(t),t!==null?dv(t):null}function dv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=dv(t);if(e!==null)return e;t=t.sibling}return null}var hv=Xt.unstable_scheduleCallback,vm=Xt.unstable_cancelCallback,Hw=Xt.unstable_shouldYield,$w=Xt.unstable_requestPaint,Ze=Xt.unstable_now,Vw=Xt.unstable_getCurrentPriorityLevel,Xf=Xt.unstable_ImmediatePriority,fv=Xt.unstable_UserBlockingPriority,Vl=Xt.unstable_NormalPriority,Ww=Xt.unstable_LowPriority,pv=Xt.unstable_IdlePriority,Bc=null,Or=null;function Xw(t){if(Or&&typeof Or.onCommitFiberRoot=="function")try{Or.onCommitFiberRoot(Bc,t,void 0,(t.current.flags&128)===128)}catch{}}var yr=Math.clz32?Math.clz32:qw,Yw=Math.log,Kw=Math.LN2;function qw(t){return t>>>=0,t===0?32:31-(Yw(t)/Kw|0)|0}var Ba=64,Na=4194304;function _o(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wl(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=_o(a):(s&=o,s!==0&&(n=_o(s)))}else o=r&~i,o!==0?n=_o(o):s!==0&&(n=_o(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-yr(e),i=1<<r,n|=t[r],e&=~i;return n}function Jw(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qw(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-yr(s),a=1<<o,c=i[o];c===-1?(!(a&r)||a&n)&&(i[o]=Jw(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function ih(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function mv(){var t=Ba;return Ba<<=1,!(Ba&4194240)&&(Ba=64),t}function Su(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function xa(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-yr(e),t[e]=r}function Zw(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-yr(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Yf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-yr(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Be=0;function gv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var xv,Kf,yv,vv,_v,sh=!1,Fa=[],Ln=null,Dn=null,On=null,Yo=new Map,Ko=new Map,kn=[],eS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _m(t,e){switch(t){case"focusin":case"focusout":Ln=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":On=null;break;case"pointerover":case"pointerout":Yo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ko.delete(e.pointerId)}}function io(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=va(e),e!==null&&Kf(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function tS(t,e,r,n,i){switch(e){case"focusin":return Ln=io(Ln,t,e,r,n,i),!0;case"dragenter":return Dn=io(Dn,t,e,r,n,i),!0;case"mouseover":return On=io(On,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Yo.set(s,io(Yo.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Ko.set(s,io(Ko.get(s)||null,t,e,r,n,i)),!0}return!1}function wv(t){var e=xi(t.target);if(e!==null){var r=Ni(e);if(r!==null){if(e=r.tag,e===13){if(e=cv(r),e!==null){t.blockedOn=e,_v(t.priority,function(){yv(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _l(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=oh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);eh=n,r.target.dispatchEvent(n),eh=null}else return e=va(r),e!==null&&Kf(e),t.blockedOn=r,!1;e.shift()}return!0}function wm(t,e,r){_l(t)&&r.delete(e)}function rS(){sh=!1,Ln!==null&&_l(Ln)&&(Ln=null),Dn!==null&&_l(Dn)&&(Dn=null),On!==null&&_l(On)&&(On=null),Yo.forEach(wm),Ko.forEach(wm)}function so(t,e){t.blockedOn===e&&(t.blockedOn=null,sh||(sh=!0,Xt.unstable_scheduleCallback(Xt.unstable_NormalPriority,rS)))}function qo(t){function e(i){return so(i,t)}if(0<Fa.length){so(Fa[0],t);for(var r=1;r<Fa.length;r++){var n=Fa[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ln!==null&&so(Ln,t),Dn!==null&&so(Dn,t),On!==null&&so(On,t),Yo.forEach(e),Ko.forEach(e),r=0;r<kn.length;r++)n=kn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<kn.length&&(r=kn[0],r.blockedOn===null);)wv(r),r.blockedOn===null&&kn.shift()}var Cs=fn.ReactCurrentBatchConfig,Xl=!0;function nS(t,e,r,n){var i=Be,s=Cs.transition;Cs.transition=null;try{Be=1,qf(t,e,r,n)}finally{Be=i,Cs.transition=s}}function iS(t,e,r,n){var i=Be,s=Cs.transition;Cs.transition=null;try{Be=4,qf(t,e,r,n)}finally{Be=i,Cs.transition=s}}function qf(t,e,r,n){if(Xl){var i=oh(t,e,r,n);if(i===null)Mu(t,e,n,Yl,r),_m(t,n);else if(tS(i,t,e,r,n))n.stopPropagation();else if(_m(t,n),e&4&&-1<eS.indexOf(t)){for(;i!==null;){var s=va(i);if(s!==null&&xv(s),s=oh(t,e,r,n),s===null&&Mu(t,e,n,Yl,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Mu(t,e,n,null,r)}}var Yl=null;function oh(t,e,r,n){if(Yl=null,t=Wf(n),t=xi(t),t!==null)if(e=Ni(t),e===null)t=null;else if(r=e.tag,r===13){if(t=cv(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yl=t,null}function Sv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vw()){case Xf:return 1;case fv:return 4;case Vl:case Ww:return 16;case pv:return 536870912;default:return 16}default:return 16}}var In=null,Jf=null,wl=null;function bv(){if(wl)return wl;var t,e=Jf,r=e.length,n,i="value"in In?In.value:In.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return wl=i.slice(t,1<n?1-n:void 0)}function Sl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function La(){return!0}function Sm(){return!1}function Kt(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?La:Sm,this.isPropagationStopped=Sm,this}return Xe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=La)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=La)},persist:function(){},isPersistent:La}),e}var Ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qf=Kt(Ks),ya=Xe({},Ks,{view:0,detail:0}),sS=Kt(ya),bu,Eu,oo,Nc=Xe({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==oo&&(oo&&t.type==="mousemove"?(bu=t.screenX-oo.screenX,Eu=t.screenY-oo.screenY):Eu=bu=0,oo=t),bu)},movementY:function(t){return"movementY"in t?t.movementY:Eu}}),bm=Kt(Nc),oS=Xe({},Nc,{dataTransfer:0}),aS=Kt(oS),lS=Xe({},ya,{relatedTarget:0}),Tu=Kt(lS),cS=Xe({},Ks,{animationName:0,elapsedTime:0,pseudoElement:0}),uS=Kt(cS),dS=Xe({},Ks,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),hS=Kt(dS),fS=Xe({},Ks,{data:0}),Em=Kt(fS),pS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=gS[t])?!!e[t]:!1}function Zf(){return xS}var yS=Xe({},ya,{key:function(t){if(t.key){var e=pS[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Sl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?mS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zf,charCode:function(t){return t.type==="keypress"?Sl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Sl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),vS=Kt(yS),_S=Xe({},Nc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tm=Kt(_S),wS=Xe({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zf}),SS=Kt(wS),bS=Xe({},Ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),ES=Kt(bS),TS=Xe({},Nc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),AS=Kt(TS),CS=[9,13,27,32],ep=an&&"CompositionEvent"in window,jo=null;an&&"documentMode"in document&&(jo=document.documentMode);var kS=an&&"TextEvent"in window&&!jo,Ev=an&&(!ep||jo&&8<jo&&11>=jo),Am=" ",Cm=!1;function Tv(t,e){switch(t){case"keyup":return CS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Av(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var hs=!1;function PS(t,e){switch(t){case"compositionend":return Av(e);case"keypress":return e.which!==32?null:(Cm=!0,Am);case"textInput":return t=e.data,t===Am&&Cm?null:t;default:return null}}function RS(t,e){if(hs)return t==="compositionend"||!ep&&Tv(t,e)?(t=bv(),wl=Jf=In=null,hs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ev&&e.locale!=="ko"?null:e.data;default:return null}}var IS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function km(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!IS[t.type]:e==="textarea"}function Cv(t,e,r,n){iv(n),e=Kl(e,"onChange"),0<e.length&&(r=new Qf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Bo=null,Jo=null;function MS(t){Dv(t,0)}function Fc(t){var e=ms(t);if(Jy(e))return t}function jS(t,e){if(t==="change")return e}var kv=!1;if(an){var Au;if(an){var Cu="oninput"in document;if(!Cu){var Pm=document.createElement("div");Pm.setAttribute("oninput","return;"),Cu=typeof Pm.oninput=="function"}Au=Cu}else Au=!1;kv=Au&&(!document.documentMode||9<document.documentMode)}function Rm(){Bo&&(Bo.detachEvent("onpropertychange",Pv),Jo=Bo=null)}function Pv(t){if(t.propertyName==="value"&&Fc(Jo)){var e=[];Cv(e,Jo,t,Wf(t)),lv(MS,e)}}function BS(t,e,r){t==="focusin"?(Rm(),Bo=e,Jo=r,Bo.attachEvent("onpropertychange",Pv)):t==="focusout"&&Rm()}function NS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Fc(Jo)}function FS(t,e){if(t==="click")return Fc(e)}function LS(t,e){if(t==="input"||t==="change")return Fc(e)}function DS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Sr=typeof Object.is=="function"?Object.is:DS;function Qo(t,e){if(Sr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Gd.call(e,i)||!Sr(t[i],e[i]))return!1}return!0}function Im(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Mm(t,e){var r=Im(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Im(r)}}function Rv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Rv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Iv(){for(var t=window,e=Gl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Gl(t.document)}return e}function tp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function OS(t){var e=Iv(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Rv(r.ownerDocument.documentElement,r)){if(n!==null&&tp(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Mm(r,s);var o=Mm(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var US=an&&"documentMode"in document&&11>=document.documentMode,fs=null,ah=null,No=null,lh=!1;function jm(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lh||fs==null||fs!==Gl(n)||(n=fs,"selectionStart"in n&&tp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),No&&Qo(No,n)||(No=n,n=Kl(ah,"onSelect"),0<n.length&&(e=new Qf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=fs)))}function Da(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ps={animationend:Da("Animation","AnimationEnd"),animationiteration:Da("Animation","AnimationIteration"),animationstart:Da("Animation","AnimationStart"),transitionend:Da("Transition","TransitionEnd")},ku={},Mv={};an&&(Mv=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function Lc(t){if(ku[t])return ku[t];if(!ps[t])return t;var e=ps[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Mv)return ku[t]=e[r];return t}var jv=Lc("animationend"),Bv=Lc("animationiteration"),Nv=Lc("animationstart"),Fv=Lc("transitionend"),Lv=new Map,Bm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qn(t,e){Lv.set(t,e),Bi(e,[t])}for(var Pu=0;Pu<Bm.length;Pu++){var Ru=Bm[Pu],zS=Ru.toLowerCase(),GS=Ru[0].toUpperCase()+Ru.slice(1);Qn(zS,"on"+GS)}Qn(jv,"onAnimationEnd");Qn(Bv,"onAnimationIteration");Qn(Nv,"onAnimationStart");Qn("dblclick","onDoubleClick");Qn("focusin","onFocus");Qn("focusout","onBlur");Qn(Fv,"onTransitionEnd");Ds("onMouseEnter",["mouseout","mouseover"]);Ds("onMouseLeave",["mouseout","mouseover"]);Ds("onPointerEnter",["pointerout","pointerover"]);Ds("onPointerLeave",["pointerout","pointerover"]);Bi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HS=new Set("cancel close invalid load scroll toggle".split(" ").concat(wo));function Nm(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,zw(n,e,void 0,t),t.currentTarget=null}function Dv(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;Nm(i,a,u),s=c}else for(o=0;o<n.length;o++){if(a=n[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;Nm(i,a,u),s=c}}}if($l)throw t=nh,$l=!1,nh=null,t}function De(t,e){var r=e[fh];r===void 0&&(r=e[fh]=new Set);var n=t+"__bubble";r.has(n)||(Ov(e,t,2,!1),r.add(n))}function Iu(t,e,r){var n=0;e&&(n|=4),Ov(r,t,n,e)}var Oa="_reactListening"+Math.random().toString(36).slice(2);function Zo(t){if(!t[Oa]){t[Oa]=!0,Wy.forEach(function(r){r!=="selectionchange"&&(HS.has(r)||Iu(r,!1,t),Iu(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Oa]||(e[Oa]=!0,Iu("selectionchange",!1,e))}}function Ov(t,e,r,n){switch(Sv(e)){case 1:var i=nS;break;case 4:i=iS;break;default:i=qf}r=i.bind(null,e,r,t),i=void 0,!rh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Mu(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=xi(a),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}a=a.parentNode}}n=n.return}lv(function(){var u=s,d=Wf(r),h=[];e:{var f=Lv.get(t);if(f!==void 0){var p=Qf,m=t;switch(t){case"keypress":if(Sl(r)===0)break e;case"keydown":case"keyup":p=vS;break;case"focusin":m="focus",p=Tu;break;case"focusout":m="blur",p=Tu;break;case"beforeblur":case"afterblur":p=Tu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=bm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=aS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=SS;break;case jv:case Bv:case Nv:p=uS;break;case Fv:p=ES;break;case"scroll":p=sS;break;case"wheel":p=AS;break;case"copy":case"cut":case"paste":p=hS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Tm}var v=(e&4)!==0,_=!v&&t==="scroll",y=v?f!==null?f+"Capture":null:f;v=[];for(var x=u,g;x!==null;){g=x;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,y!==null&&(w=Xo(x,y),w!=null&&v.push(ea(x,w,g)))),_)break;x=x.return}0<v.length&&(f=new p(f,m,null,r,d),h.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&r!==eh&&(m=r.relatedTarget||r.fromElement)&&(xi(m)||m[ln]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?xi(m):null,m!==null&&(_=Ni(m),m!==_||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(v=bm,w="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(v=Tm,w="onPointerLeave",y="onPointerEnter",x="pointer"),_=p==null?f:ms(p),g=m==null?f:ms(m),f=new v(w,x+"leave",p,r,d),f.target=_,f.relatedTarget=g,w=null,xi(d)===u&&(v=new v(y,x+"enter",m,r,d),v.target=g,v.relatedTarget=_,w=v),_=w,p&&m)t:{for(v=p,y=m,x=0,g=v;g;g=Wi(g))x++;for(g=0,w=y;w;w=Wi(w))g++;for(;0<x-g;)v=Wi(v),x--;for(;0<g-x;)y=Wi(y),g--;for(;x--;){if(v===y||y!==null&&v===y.alternate)break t;v=Wi(v),y=Wi(y)}v=null}else v=null;p!==null&&Fm(h,f,p,v,!1),m!==null&&_!==null&&Fm(h,_,m,v,!0)}}e:{if(f=u?ms(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var T=jS;else if(km(f))if(kv)T=LS;else{T=NS;var A=BS}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=FS);if(T&&(T=T(t,u))){Cv(h,T,r,d);break e}A&&A(t,f,u),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&Kd(f,"number",f.value)}switch(A=u?ms(u):window,t){case"focusin":(km(A)||A.contentEditable==="true")&&(fs=A,ah=u,No=null);break;case"focusout":No=ah=fs=null;break;case"mousedown":lh=!0;break;case"contextmenu":case"mouseup":case"dragend":lh=!1,jm(h,r,d);break;case"selectionchange":if(US)break;case"keydown":case"keyup":jm(h,r,d)}var C;if(ep)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else hs?Tv(t,r)&&(b="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(b="onCompositionStart");b&&(Ev&&r.locale!=="ko"&&(hs||b!=="onCompositionStart"?b==="onCompositionEnd"&&hs&&(C=bv()):(In=d,Jf="value"in In?In.value:In.textContent,hs=!0)),A=Kl(u,b),0<A.length&&(b=new Em(b,t,null,r,d),h.push({event:b,listeners:A}),C?b.data=C:(C=Av(r),C!==null&&(b.data=C)))),(C=kS?PS(t,r):RS(t,r))&&(u=Kl(u,"onBeforeInput"),0<u.length&&(d=new Em("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=C))}Dv(h,e)})}function ea(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Kl(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Xo(t,r),s!=null&&n.unshift(ea(t,s,i)),s=Xo(t,e),s!=null&&n.push(ea(t,s,i))),t=t.return}return n}function Wi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Fm(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,c=a.alternate,u=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&u!==null&&(a=u,i?(c=Xo(r,s),c!=null&&o.unshift(ea(r,c,a))):i||(c=Xo(r,s),c!=null&&o.push(ea(r,c,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var $S=/\r\n?/g,VS=/\u0000|\uFFFD/g;function Lm(t){return(typeof t=="string"?t:""+t).replace($S,`
`).replace(VS,"")}function Ua(t,e,r){if(e=Lm(e),Lm(t)!==e&&r)throw Error(V(425))}function ql(){}var ch=null,uh=null;function dh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var hh=typeof setTimeout=="function"?setTimeout:void 0,WS=typeof clearTimeout=="function"?clearTimeout:void 0,Dm=typeof Promise=="function"?Promise:void 0,XS=typeof queueMicrotask=="function"?queueMicrotask:typeof Dm<"u"?function(t){return Dm.resolve(null).then(t).catch(YS)}:hh;function YS(t){setTimeout(function(){throw t})}function ju(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),qo(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);qo(e)}function Un(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Om(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var qs=Math.random().toString(36).slice(2),Lr="__reactFiber$"+qs,ta="__reactProps$"+qs,ln="__reactContainer$"+qs,fh="__reactEvents$"+qs,KS="__reactListeners$"+qs,qS="__reactHandles$"+qs;function xi(t){var e=t[Lr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ln]||r[Lr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Om(t);t!==null;){if(r=t[Lr])return r;t=Om(t)}return e}t=r,r=t.parentNode}return null}function va(t){return t=t[Lr]||t[ln],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ms(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(V(33))}function Dc(t){return t[ta]||null}var ph=[],gs=-1;function Zn(t){return{current:t}}function Ue(t){0>gs||(t.current=ph[gs],ph[gs]=null,gs--)}function Fe(t,e){gs++,ph[gs]=t.current,t.current=e}var Yn={},Et=Zn(Yn),Lt=Zn(!1),Ti=Yn;function Os(t,e){var r=t.type.contextTypes;if(!r)return Yn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Dt(t){return t=t.childContextTypes,t!=null}function Jl(){Ue(Lt),Ue(Et)}function Um(t,e,r){if(Et.current!==Yn)throw Error(V(168));Fe(Et,e),Fe(Lt,r)}function Uv(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(V(108,Bw(t)||"Unknown",i));return Xe({},r,n)}function Ql(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Yn,Ti=Et.current,Fe(Et,t),Fe(Lt,Lt.current),!0}function zm(t,e,r){var n=t.stateNode;if(!n)throw Error(V(169));r?(t=Uv(t,e,Ti),n.__reactInternalMemoizedMergedChildContext=t,Ue(Lt),Ue(Et),Fe(Et,t)):Ue(Lt),Fe(Lt,r)}var Jr=null,Oc=!1,Bu=!1;function zv(t){Jr===null?Jr=[t]:Jr.push(t)}function JS(t){Oc=!0,zv(t)}function ei(){if(!Bu&&Jr!==null){Bu=!0;var t=0,e=Be;try{var r=Jr;for(Be=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Jr=null,Oc=!1}catch(i){throw Jr!==null&&(Jr=Jr.slice(t+1)),hv(Xf,ei),i}finally{Be=e,Bu=!1}}return null}var xs=[],ys=0,Zl=null,ec=0,Zt=[],er=0,Ai=null,Qr=1,Zr="";function ai(t,e){xs[ys++]=ec,xs[ys++]=Zl,Zl=t,ec=e}function Gv(t,e,r){Zt[er++]=Qr,Zt[er++]=Zr,Zt[er++]=Ai,Ai=t;var n=Qr;t=Zr;var i=32-yr(n)-1;n&=~(1<<i),r+=1;var s=32-yr(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Qr=1<<32-yr(e)+i|r<<i|n,Zr=s+t}else Qr=1<<s|r<<i|n,Zr=t}function rp(t){t.return!==null&&(ai(t,1),Gv(t,1,0))}function np(t){for(;t===Zl;)Zl=xs[--ys],xs[ys]=null,ec=xs[--ys],xs[ys]=null;for(;t===Ai;)Ai=Zt[--er],Zt[er]=null,Zr=Zt[--er],Zt[er]=null,Qr=Zt[--er],Zt[er]=null}var Wt=null,Ht=null,Ge=!1,gr=null;function Hv(t,e){var r=tr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Gm(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wt=t,Ht=Un(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wt=t,Ht=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ai!==null?{id:Qr,overflow:Zr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=tr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Wt=t,Ht=null,!0):!1;default:return!1}}function mh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gh(t){if(Ge){var e=Ht;if(e){var r=e;if(!Gm(t,e)){if(mh(t))throw Error(V(418));e=Un(r.nextSibling);var n=Wt;e&&Gm(t,e)?Hv(n,r):(t.flags=t.flags&-4097|2,Ge=!1,Wt=t)}}else{if(mh(t))throw Error(V(418));t.flags=t.flags&-4097|2,Ge=!1,Wt=t}}}function Hm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wt=t}function za(t){if(t!==Wt)return!1;if(!Ge)return Hm(t),Ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!dh(t.type,t.memoizedProps)),e&&(e=Ht)){if(mh(t))throw $v(),Error(V(418));for(;e;)Hv(t,e),e=Un(e.nextSibling)}if(Hm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(V(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ht=Un(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ht=null}}else Ht=Wt?Un(t.stateNode.nextSibling):null;return!0}function $v(){for(var t=Ht;t;)t=Un(t.nextSibling)}function Us(){Ht=Wt=null,Ge=!1}function ip(t){gr===null?gr=[t]:gr.push(t)}var QS=fn.ReactCurrentBatchConfig;function ao(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(V(309));var n=r.stateNode}if(!n)throw Error(V(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(V(284));if(!r._owner)throw Error(V(290,t))}return t}function Ga(t,e){throw t=Object.prototype.toString.call(e),Error(V(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function $m(t){var e=t._init;return e(t._payload)}function Vv(t){function e(y,x){if(t){var g=y.deletions;g===null?(y.deletions=[x],y.flags|=16):g.push(x)}}function r(y,x){if(!t)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function n(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function i(y,x){return y=$n(y,x),y.index=0,y.sibling=null,y}function s(y,x,g){return y.index=g,t?(g=y.alternate,g!==null?(g=g.index,g<x?(y.flags|=2,x):g):(y.flags|=2,x)):(y.flags|=1048576,x)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,x,g,w){return x===null||x.tag!==6?(x=zu(g,y.mode,w),x.return=y,x):(x=i(x,g),x.return=y,x)}function c(y,x,g,w){var T=g.type;return T===ds?d(y,x,g.props.children,w,g.key):x!==null&&(x.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Tn&&$m(T)===x.type)?(w=i(x,g.props),w.ref=ao(y,x,g),w.return=y,w):(w=Pl(g.type,g.key,g.props,null,y.mode,w),w.ref=ao(y,x,g),w.return=y,w)}function u(y,x,g,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==g.containerInfo||x.stateNode.implementation!==g.implementation?(x=Gu(g,y.mode,w),x.return=y,x):(x=i(x,g.children||[]),x.return=y,x)}function d(y,x,g,w,T){return x===null||x.tag!==7?(x=wi(g,y.mode,w,T),x.return=y,x):(x=i(x,g),x.return=y,x)}function h(y,x,g){if(typeof x=="string"&&x!==""||typeof x=="number")return x=zu(""+x,y.mode,g),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ia:return g=Pl(x.type,x.key,x.props,null,y.mode,g),g.ref=ao(y,null,x),g.return=y,g;case us:return x=Gu(x,y.mode,g),x.return=y,x;case Tn:var w=x._init;return h(y,w(x._payload),g)}if(vo(x)||ro(x))return x=wi(x,y.mode,g,null),x.return=y,x;Ga(y,x)}return null}function f(y,x,g,w){var T=x!==null?x.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return T!==null?null:a(y,x,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ia:return g.key===T?c(y,x,g,w):null;case us:return g.key===T?u(y,x,g,w):null;case Tn:return T=g._init,f(y,x,T(g._payload),w)}if(vo(g)||ro(g))return T!==null?null:d(y,x,g,w,null);Ga(y,g)}return null}function p(y,x,g,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(g)||null,a(x,y,""+w,T);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ia:return y=y.get(w.key===null?g:w.key)||null,c(x,y,w,T);case us:return y=y.get(w.key===null?g:w.key)||null,u(x,y,w,T);case Tn:var A=w._init;return p(y,x,g,A(w._payload),T)}if(vo(w)||ro(w))return y=y.get(g)||null,d(x,y,w,T,null);Ga(x,w)}return null}function m(y,x,g,w){for(var T=null,A=null,C=x,b=x=0,I=null;C!==null&&b<g.length;b++){C.index>b?(I=C,C=null):I=C.sibling;var N=f(y,C,g[b],w);if(N===null){C===null&&(C=I);break}t&&C&&N.alternate===null&&e(y,C),x=s(N,x,b),A===null?T=N:A.sibling=N,A=N,C=I}if(b===g.length)return r(y,C),Ge&&ai(y,b),T;if(C===null){for(;b<g.length;b++)C=h(y,g[b],w),C!==null&&(x=s(C,x,b),A===null?T=C:A.sibling=C,A=C);return Ge&&ai(y,b),T}for(C=n(y,C);b<g.length;b++)I=p(C,y,b,g[b],w),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?b:I.key),x=s(I,x,b),A===null?T=I:A.sibling=I,A=I);return t&&C.forEach(function(L){return e(y,L)}),Ge&&ai(y,b),T}function v(y,x,g,w){var T=ro(g);if(typeof T!="function")throw Error(V(150));if(g=T.call(g),g==null)throw Error(V(151));for(var A=T=null,C=x,b=x=0,I=null,N=g.next();C!==null&&!N.done;b++,N=g.next()){C.index>b?(I=C,C=null):I=C.sibling;var L=f(y,C,N.value,w);if(L===null){C===null&&(C=I);break}t&&C&&L.alternate===null&&e(y,C),x=s(L,x,b),A===null?T=L:A.sibling=L,A=L,C=I}if(N.done)return r(y,C),Ge&&ai(y,b),T;if(C===null){for(;!N.done;b++,N=g.next())N=h(y,N.value,w),N!==null&&(x=s(N,x,b),A===null?T=N:A.sibling=N,A=N);return Ge&&ai(y,b),T}for(C=n(y,C);!N.done;b++,N=g.next())N=p(C,y,b,N.value,w),N!==null&&(t&&N.alternate!==null&&C.delete(N.key===null?b:N.key),x=s(N,x,b),A===null?T=N:A.sibling=N,A=N);return t&&C.forEach(function(D){return e(y,D)}),Ge&&ai(y,b),T}function _(y,x,g,w){if(typeof g=="object"&&g!==null&&g.type===ds&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Ia:e:{for(var T=g.key,A=x;A!==null;){if(A.key===T){if(T=g.type,T===ds){if(A.tag===7){r(y,A.sibling),x=i(A,g.props.children),x.return=y,y=x;break e}}else if(A.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Tn&&$m(T)===A.type){r(y,A.sibling),x=i(A,g.props),x.ref=ao(y,A,g),x.return=y,y=x;break e}r(y,A);break}else e(y,A);A=A.sibling}g.type===ds?(x=wi(g.props.children,y.mode,w,g.key),x.return=y,y=x):(w=Pl(g.type,g.key,g.props,null,y.mode,w),w.ref=ao(y,x,g),w.return=y,y=w)}return o(y);case us:e:{for(A=g.key;x!==null;){if(x.key===A)if(x.tag===4&&x.stateNode.containerInfo===g.containerInfo&&x.stateNode.implementation===g.implementation){r(y,x.sibling),x=i(x,g.children||[]),x.return=y,y=x;break e}else{r(y,x);break}else e(y,x);x=x.sibling}x=Gu(g,y.mode,w),x.return=y,y=x}return o(y);case Tn:return A=g._init,_(y,x,A(g._payload),w)}if(vo(g))return m(y,x,g,w);if(ro(g))return v(y,x,g,w);Ga(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,x!==null&&x.tag===6?(r(y,x.sibling),x=i(x,g),x.return=y,y=x):(r(y,x),x=zu(g,y.mode,w),x.return=y,y=x),o(y)):r(y,x)}return _}var zs=Vv(!0),Wv=Vv(!1),tc=Zn(null),rc=null,vs=null,sp=null;function op(){sp=vs=rc=null}function ap(t){var e=tc.current;Ue(tc),t._currentValue=e}function xh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ks(t,e){rc=t,sp=vs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Bt=!0),t.firstContext=null)}function sr(t){var e=t._currentValue;if(sp!==t)if(t={context:t,memoizedValue:e,next:null},vs===null){if(rc===null)throw Error(V(308));vs=t,rc.dependencies={lanes:0,firstContext:t}}else vs=vs.next=t;return e}var yi=null;function lp(t){yi===null?yi=[t]:yi.push(t)}function Xv(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,lp(e)):(r.next=i.next,i.next=r),e.interleaved=r,cn(t,n)}function cn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var An=!1;function cp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function sn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Re&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,cn(t,r)}return i=n.interleaved,i===null?(e.next=e,lp(n)):(e.next=i.next,i.next=e),n.interleaved=e,cn(t,r)}function bl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Yf(t,r)}}function Vm(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function nc(t,e,r,n){var i=t.updateQueue;An=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(s!==null){var h=i.baseState;o=0,d=u=c=null,a=s;do{var f=a.lane,p=a.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,v=a;switch(f=e,p=r,v.tag){case 1:if(m=v.payload,typeof m=="function"){h=m.call(p,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,f=typeof m=="function"?m.call(p,h,f):m,f==null)break e;h=Xe({},h,f);break e;case 2:An=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ki|=o,t.lanes=o,t.memoizedState=h}}function Wm(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(V(191,i));i.call(n)}}}var _a={},Ur=Zn(_a),ra=Zn(_a),na=Zn(_a);function vi(t){if(t===_a)throw Error(V(174));return t}function up(t,e){switch(Fe(na,e),Fe(ra,t),Fe(Ur,_a),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Jd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Jd(e,t)}Ue(Ur),Fe(Ur,e)}function Gs(){Ue(Ur),Ue(ra),Ue(na)}function Kv(t){vi(na.current);var e=vi(Ur.current),r=Jd(e,t.type);e!==r&&(Fe(ra,t),Fe(Ur,r))}function dp(t){ra.current===t&&(Ue(Ur),Ue(ra))}var $e=Zn(0);function ic(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Nu=[];function hp(){for(var t=0;t<Nu.length;t++)Nu[t]._workInProgressVersionPrimary=null;Nu.length=0}var El=fn.ReactCurrentDispatcher,Fu=fn.ReactCurrentBatchConfig,Ci=0,We=null,ot=null,ct=null,sc=!1,Fo=!1,ia=0,ZS=0;function wt(){throw Error(V(321))}function fp(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Sr(t[r],e[r]))return!1;return!0}function pp(t,e,r,n,i,s){if(Ci=s,We=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,El.current=t===null||t.memoizedState===null?nb:ib,t=r(n,i),Fo){s=0;do{if(Fo=!1,ia=0,25<=s)throw Error(V(301));s+=1,ct=ot=null,e.updateQueue=null,El.current=sb,t=r(n,i)}while(Fo)}if(El.current=oc,e=ot!==null&&ot.next!==null,Ci=0,ct=ot=We=null,sc=!1,e)throw Error(V(300));return t}function mp(){var t=ia!==0;return ia=0,t}function jr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?We.memoizedState=ct=t:ct=ct.next=t,ct}function or(){if(ot===null){var t=We.alternate;t=t!==null?t.memoizedState:null}else t=ot.next;var e=ct===null?We.memoizedState:ct.next;if(e!==null)ct=e,ot=t;else{if(t===null)throw Error(V(310));ot=t,t={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},ct===null?We.memoizedState=ct=t:ct=ct.next=t}return ct}function sa(t,e){return typeof e=="function"?e(t):e}function Lu(t){var e=or(),r=e.queue;if(r===null)throw Error(V(311));r.lastRenderedReducer=t;var n=ot,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,c=null,u=s;do{var d=u.lane;if((Ci&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=h,o=n):c=c.next=h,We.lanes|=d,ki|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=a,Sr(n,e.memoizedState)||(Bt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,We.lanes|=s,ki|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Du(t){var e=or(),r=e.queue;if(r===null)throw Error(V(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Sr(s,e.memoizedState)||(Bt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function qv(){}function Jv(t,e){var r=We,n=or(),i=e(),s=!Sr(n.memoizedState,i);if(s&&(n.memoizedState=i,Bt=!0),n=n.queue,gp(e0.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ct!==null&&ct.memoizedState.tag&1){if(r.flags|=2048,oa(9,Zv.bind(null,r,n,i,e),void 0,null),dt===null)throw Error(V(349));Ci&30||Qv(r,e,i)}return i}function Qv(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Zv(t,e,r,n){e.value=r,e.getSnapshot=n,t0(e)&&r0(t)}function e0(t,e,r){return r(function(){t0(e)&&r0(t)})}function t0(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Sr(t,r)}catch{return!0}}function r0(t){var e=cn(t,1);e!==null&&vr(e,t,1,-1)}function Xm(t){var e=jr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:t},e.queue=t,t=t.dispatch=rb.bind(null,We,t),[e.memoizedState,t]}function oa(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function n0(){return or().memoizedState}function Tl(t,e,r,n){var i=jr();We.flags|=t,i.memoizedState=oa(1|e,r,void 0,n===void 0?null:n)}function Uc(t,e,r,n){var i=or();n=n===void 0?null:n;var s=void 0;if(ot!==null){var o=ot.memoizedState;if(s=o.destroy,n!==null&&fp(n,o.deps)){i.memoizedState=oa(e,r,s,n);return}}We.flags|=t,i.memoizedState=oa(1|e,r,s,n)}function Ym(t,e){return Tl(8390656,8,t,e)}function gp(t,e){return Uc(2048,8,t,e)}function i0(t,e){return Uc(4,2,t,e)}function s0(t,e){return Uc(4,4,t,e)}function o0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function a0(t,e,r){return r=r!=null?r.concat([t]):null,Uc(4,4,o0.bind(null,e,t),r)}function xp(){}function l0(t,e){var r=or();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&fp(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function c0(t,e){var r=or();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&fp(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function u0(t,e,r){return Ci&21?(Sr(r,e)||(r=mv(),We.lanes|=r,ki|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Bt=!0),t.memoizedState=r)}function eb(t,e){var r=Be;Be=r!==0&&4>r?r:4,t(!0);var n=Fu.transition;Fu.transition={};try{t(!1),e()}finally{Be=r,Fu.transition=n}}function d0(){return or().memoizedState}function tb(t,e,r){var n=Hn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},h0(t))f0(e,r);else if(r=Xv(t,e,r,n),r!==null){var i=Ct();vr(r,t,n,i),p0(r,e,n)}}function rb(t,e,r){var n=Hn(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(h0(t))f0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,Sr(a,o)){var c=e.interleaved;c===null?(i.next=i,lp(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=Xv(t,e,i,n),r!==null&&(i=Ct(),vr(r,t,n,i),p0(r,e,n))}}function h0(t){var e=t.alternate;return t===We||e!==null&&e===We}function f0(t,e){Fo=sc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function p0(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Yf(t,r)}}var oc={readContext:sr,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},nb={readContext:sr,useCallback:function(t,e){return jr().memoizedState=[t,e===void 0?null:e],t},useContext:sr,useEffect:Ym,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Tl(4194308,4,o0.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Tl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Tl(4,2,t,e)},useMemo:function(t,e){var r=jr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=jr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=tb.bind(null,We,t),[n.memoizedState,t]},useRef:function(t){var e=jr();return t={current:t},e.memoizedState=t},useState:Xm,useDebugValue:xp,useDeferredValue:function(t){return jr().memoizedState=t},useTransition:function(){var t=Xm(!1),e=t[0];return t=eb.bind(null,t[1]),jr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=We,i=jr();if(Ge){if(r===void 0)throw Error(V(407));r=r()}else{if(r=e(),dt===null)throw Error(V(349));Ci&30||Qv(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Ym(e0.bind(null,n,s,t),[t]),n.flags|=2048,oa(9,Zv.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=jr(),e=dt.identifierPrefix;if(Ge){var r=Zr,n=Qr;r=(n&~(1<<32-yr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=ia++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=ZS++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ib={readContext:sr,useCallback:l0,useContext:sr,useEffect:gp,useImperativeHandle:a0,useInsertionEffect:i0,useLayoutEffect:s0,useMemo:c0,useReducer:Lu,useRef:n0,useState:function(){return Lu(sa)},useDebugValue:xp,useDeferredValue:function(t){var e=or();return u0(e,ot.memoizedState,t)},useTransition:function(){var t=Lu(sa)[0],e=or().memoizedState;return[t,e]},useMutableSource:qv,useSyncExternalStore:Jv,useId:d0,unstable_isNewReconciler:!1},sb={readContext:sr,useCallback:l0,useContext:sr,useEffect:gp,useImperativeHandle:a0,useInsertionEffect:i0,useLayoutEffect:s0,useMemo:c0,useReducer:Du,useRef:n0,useState:function(){return Du(sa)},useDebugValue:xp,useDeferredValue:function(t){var e=or();return ot===null?e.memoizedState=t:u0(e,ot.memoizedState,t)},useTransition:function(){var t=Du(sa)[0],e=or().memoizedState;return[t,e]},useMutableSource:qv,useSyncExternalStore:Jv,useId:d0,unstable_isNewReconciler:!1};function pr(t,e){if(t&&t.defaultProps){e=Xe({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function yh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Xe({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var zc={isMounted:function(t){return(t=t._reactInternals)?Ni(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ct(),i=Hn(t),s=sn(n,i);s.payload=e,r!=null&&(s.callback=r),e=zn(t,s,i),e!==null&&(vr(e,t,i,n),bl(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ct(),i=Hn(t),s=sn(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=zn(t,s,i),e!==null&&(vr(e,t,i,n),bl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ct(),n=Hn(t),i=sn(r,n);i.tag=2,e!=null&&(i.callback=e),e=zn(t,i,n),e!==null&&(vr(e,t,n,r),bl(e,t,n))}};function Km(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Qo(r,n)||!Qo(i,s):!0}function m0(t,e,r){var n=!1,i=Yn,s=e.contextType;return typeof s=="object"&&s!==null?s=sr(s):(i=Dt(e)?Ti:Et.current,n=e.contextTypes,s=(n=n!=null)?Os(t,i):Yn),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function qm(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&zc.enqueueReplaceState(e,e.state,null)}function vh(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},cp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=sr(s):(s=Dt(e)?Ti:Et.current,i.context=Os(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(yh(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&zc.enqueueReplaceState(i,i.state,null),nc(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Hs(t,e){try{var r="",n=e;do r+=jw(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ou(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function _h(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var ob=typeof WeakMap=="function"?WeakMap:Map;function g0(t,e,r){r=sn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){lc||(lc=!0,Rh=n),_h(t,e)},r}function x0(t,e,r){r=sn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){_h(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){_h(t,e),typeof n!="function"&&(Gn===null?Gn=new Set([this]):Gn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Jm(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new ob;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=_b.bind(null,t,e,r),e.then(t,t))}function Qm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zm(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=sn(-1,1),e.tag=2,zn(r,e,1))),r.lanes|=1),t)}var ab=fn.ReactCurrentOwner,Bt=!1;function Tt(t,e,r,n){e.child=t===null?Wv(e,null,r,n):zs(e,t.child,r,n)}function eg(t,e,r,n,i){r=r.render;var s=e.ref;return ks(e,i),n=pp(t,e,r,n,s,i),r=mp(),t!==null&&!Bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,un(t,e,i)):(Ge&&r&&rp(e),e.flags|=1,Tt(t,e,n,i),e.child)}function tg(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!Tp(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,y0(t,e,s,n,i)):(t=Pl(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Qo,r(o,n)&&t.ref===e.ref)return un(t,e,i)}return e.flags|=1,t=$n(s,n),t.ref=e.ref,t.return=e,e.child=t}function y0(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Qo(s,n)&&t.ref===e.ref)if(Bt=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Bt=!0);else return e.lanes=t.lanes,un(t,e,i)}return wh(t,e,r,n,i)}function v0(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(ws,Gt),Gt|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Fe(ws,Gt),Gt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Fe(ws,Gt),Gt|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Fe(ws,Gt),Gt|=n;return Tt(t,e,i,r),e.child}function _0(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function wh(t,e,r,n,i){var s=Dt(r)?Ti:Et.current;return s=Os(e,s),ks(e,i),r=pp(t,e,r,n,s,i),n=mp(),t!==null&&!Bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,un(t,e,i)):(Ge&&n&&rp(e),e.flags|=1,Tt(t,e,r,i),e.child)}function rg(t,e,r,n,i){if(Dt(r)){var s=!0;Ql(e)}else s=!1;if(ks(e,i),e.stateNode===null)Al(t,e),m0(e,r,n),vh(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=sr(u):(u=Dt(r)?Ti:Et.current,u=Os(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==u)&&qm(e,o,n,u),An=!1;var f=e.memoizedState;o.state=f,nc(e,n,o,i),c=e.memoizedState,a!==n||f!==c||Lt.current||An?(typeof d=="function"&&(yh(e,r,d,n),c=e.memoizedState),(a=An||Km(e,r,a,n,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Yv(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:pr(e.type,a),o.props=u,h=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=sr(c):(c=Dt(r)?Ti:Et.current,c=Os(e,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==c)&&qm(e,o,n,c),An=!1,f=e.memoizedState,o.state=f,nc(e,n,o,i);var m=e.memoizedState;a!==h||f!==m||Lt.current||An?(typeof p=="function"&&(yh(e,r,p,n),m=e.memoizedState),(u=An||Km(e,r,u,n,f,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return Sh(t,e,r,n,s,i)}function Sh(t,e,r,n,i,s){_0(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&zm(e,r,!1),un(t,e,s);n=e.stateNode,ab.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=zs(e,t.child,null,s),e.child=zs(e,null,a,s)):Tt(t,e,a,s),e.memoizedState=n.state,i&&zm(e,r,!0),e.child}function w0(t){var e=t.stateNode;e.pendingContext?Um(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Um(t,e.context,!1),up(t,e.containerInfo)}function ng(t,e,r,n,i){return Us(),ip(i),e.flags|=256,Tt(t,e,r,n),e.child}var bh={dehydrated:null,treeContext:null,retryLane:0};function Eh(t){return{baseLanes:t,cachePool:null,transitions:null}}function S0(t,e,r){var n=e.pendingProps,i=$e.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Fe($e,i&1),t===null)return gh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=$c(o,n,0,null),t=wi(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Eh(r),e.memoizedState=bh,t):yp(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return lb(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=$n(i,c),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=$n(a,s):(s=wi(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?Eh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=bh,n}return s=t.child,t=s.sibling,n=$n(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function yp(t,e){return e=$c({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ha(t,e,r,n){return n!==null&&ip(n),zs(e,t.child,null,r),t=yp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lb(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=Ou(Error(V(422))),Ha(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=$c({mode:"visible",children:n.children},i,0,null),s=wi(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&zs(e,t.child,null,o),e.child.memoizedState=Eh(o),e.memoizedState=bh,s);if(!(e.mode&1))return Ha(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(V(419)),n=Ou(s,n,void 0),Ha(t,e,o,n)}if(a=(o&t.childLanes)!==0,Bt||a){if(n=dt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,cn(t,i),vr(n,t,i,-1))}return Ep(),n=Ou(Error(V(421))),Ha(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=wb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ht=Un(i.nextSibling),Wt=e,Ge=!0,gr=null,t!==null&&(Zt[er++]=Qr,Zt[er++]=Zr,Zt[er++]=Ai,Qr=t.id,Zr=t.overflow,Ai=e),e=yp(e,n.children),e.flags|=4096,e)}function ig(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),xh(t.return,e,r)}function Uu(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function b0(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Tt(t,e,n.children,r),n=$e.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ig(t,r,e);else if(t.tag===19)ig(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Fe($e,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&ic(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Uu(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ic(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Uu(e,!0,r,null,s);break;case"together":Uu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Al(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function un(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ki|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(V(153));if(e.child!==null){for(t=e.child,r=$n(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=$n(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function cb(t,e,r){switch(e.tag){case 3:w0(e),Us();break;case 5:Kv(e);break;case 1:Dt(e.type)&&Ql(e);break;case 4:up(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Fe(tc,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Fe($e,$e.current&1),e.flags|=128,null):r&e.child.childLanes?S0(t,e,r):(Fe($e,$e.current&1),t=un(t,e,r),t!==null?t.sibling:null);Fe($e,$e.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return b0(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Fe($e,$e.current),n)break;return null;case 22:case 23:return e.lanes=0,v0(t,e,r)}return un(t,e,r)}var E0,Th,T0,A0;E0=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Th=function(){};T0=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,vi(Ur.current);var s=null;switch(r){case"input":i=Xd(t,i),n=Xd(t,n),s=[];break;case"select":i=Xe({},i,{value:void 0}),n=Xe({},n,{value:void 0}),s=[];break;case"textarea":i=qd(t,i),n=qd(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=ql)}Qd(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Vo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(a=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Vo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&De("scroll",t),s||a===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};A0=function(t,e,r,n){r!==n&&(e.flags|=4)};function lo(t,e){if(!Ge)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function St(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function ub(t,e,r){var n=e.pendingProps;switch(np(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(e),null;case 1:return Dt(e.type)&&Jl(),St(e),null;case 3:return n=e.stateNode,Gs(),Ue(Lt),Ue(Et),hp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(za(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gr!==null&&(jh(gr),gr=null))),Th(t,e),St(e),null;case 5:dp(e);var i=vi(na.current);if(r=e.type,t!==null&&e.stateNode!=null)T0(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(V(166));return St(e),null}if(t=vi(Ur.current),za(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Lr]=e,n[ta]=s,t=(e.mode&1)!==0,r){case"dialog":De("cancel",n),De("close",n);break;case"iframe":case"object":case"embed":De("load",n);break;case"video":case"audio":for(i=0;i<wo.length;i++)De(wo[i],n);break;case"source":De("error",n);break;case"img":case"image":case"link":De("error",n),De("load",n);break;case"details":De("toggle",n);break;case"input":fm(n,s),De("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},De("invalid",n);break;case"textarea":mm(n,s),De("invalid",n)}Qd(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ua(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ua(n.textContent,a,t),i=["children",""+a]):Vo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&De("scroll",n)}switch(r){case"input":Ma(n),pm(n,s,!0);break;case"textarea":Ma(n),gm(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ql)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ev(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Lr]=e,t[ta]=n,E0(t,e,!1,!1),e.stateNode=t;e:{switch(o=Zd(r,n),r){case"dialog":De("cancel",t),De("close",t),i=n;break;case"iframe":case"object":case"embed":De("load",t),i=n;break;case"video":case"audio":for(i=0;i<wo.length;i++)De(wo[i],t);i=n;break;case"source":De("error",t),i=n;break;case"img":case"image":case"link":De("error",t),De("load",t),i=n;break;case"details":De("toggle",t),i=n;break;case"input":fm(t,n),i=Xd(t,n),De("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Xe({},n,{value:void 0}),De("invalid",t);break;case"textarea":mm(t,n),i=qd(t,n),De("invalid",t);break;default:i=n}Qd(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?nv(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&tv(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Wo(t,c):typeof c=="number"&&Wo(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Vo.hasOwnProperty(s)?c!=null&&s==="onScroll"&&De("scroll",t):c!=null&&Gf(t,s,c,o))}switch(r){case"input":Ma(t),pm(t,n,!1);break;case"textarea":Ma(t),gm(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Xn(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Es(t,!!n.multiple,s,!1):n.defaultValue!=null&&Es(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ql)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return St(e),null;case 6:if(t&&e.stateNode!=null)A0(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(V(166));if(r=vi(na.current),vi(Ur.current),za(e)){if(n=e.stateNode,r=e.memoizedProps,n[Lr]=e,(s=n.nodeValue!==r)&&(t=Wt,t!==null))switch(t.tag){case 3:Ua(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ua(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Lr]=e,e.stateNode=n}return St(e),null;case 13:if(Ue($e),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ge&&Ht!==null&&e.mode&1&&!(e.flags&128))$v(),Us(),e.flags|=98560,s=!1;else if(s=za(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(V(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(V(317));s[Lr]=e}else Us(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;St(e),s=!1}else gr!==null&&(jh(gr),gr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||$e.current&1?at===0&&(at=3):Ep())),e.updateQueue!==null&&(e.flags|=4),St(e),null);case 4:return Gs(),Th(t,e),t===null&&Zo(e.stateNode.containerInfo),St(e),null;case 10:return ap(e.type._context),St(e),null;case 17:return Dt(e.type)&&Jl(),St(e),null;case 19:if(Ue($e),s=e.memoizedState,s===null)return St(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)lo(s,!1);else{if(at!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ic(t),o!==null){for(e.flags|=128,lo(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Fe($e,$e.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ze()>$s&&(e.flags|=128,n=!0,lo(s,!1),e.lanes=4194304)}else{if(!n)if(t=ic(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),lo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ge)return St(e),null}else 2*Ze()-s.renderingStartTime>$s&&r!==1073741824&&(e.flags|=128,n=!0,lo(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ze(),e.sibling=null,r=$e.current,Fe($e,n?r&1|2:r&1),e):(St(e),null);case 22:case 23:return bp(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Gt&1073741824&&(St(e),e.subtreeFlags&6&&(e.flags|=8192)):St(e),null;case 24:return null;case 25:return null}throw Error(V(156,e.tag))}function db(t,e){switch(np(e),e.tag){case 1:return Dt(e.type)&&Jl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Gs(),Ue(Lt),Ue(Et),hp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return dp(e),null;case 13:if(Ue($e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(V(340));Us()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ue($e),null;case 4:return Gs(),null;case 10:return ap(e.type._context),null;case 22:case 23:return bp(),null;case 24:return null;default:return null}}var $a=!1,bt=!1,hb=typeof WeakSet=="function"?WeakSet:Set,re=null;function _s(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){qe(t,e,n)}else r.current=null}function Ah(t,e,r){try{r()}catch(n){qe(t,e,n)}}var sg=!1;function fb(t,e){if(ch=Xl,t=Iv(),tp(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==r||i!==0&&h.nodeType!==3||(a=o+i),h!==s||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===r&&++u===i&&(a=o),f===s&&++d===n&&(c=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(uh={focusedElem:t,selectionRange:r},Xl=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,_=m.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?v:pr(e.type,v),_);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(w){qe(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return m=sg,sg=!1,m}function Lo(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Ah(e,r,s)}i=i.next}while(i!==n)}}function Gc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Ch(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function C0(t){var e=t.alternate;e!==null&&(t.alternate=null,C0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Lr],delete e[ta],delete e[fh],delete e[KS],delete e[qS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function k0(t){return t.tag===5||t.tag===3||t.tag===4}function og(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||k0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function kh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=ql));else if(n!==4&&(t=t.child,t!==null))for(kh(t,e,r),t=t.sibling;t!==null;)kh(t,e,r),t=t.sibling}function Ph(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Ph(t,e,r),t=t.sibling;t!==null;)Ph(t,e,r),t=t.sibling}var pt=null,mr=!1;function _n(t,e,r){for(r=r.child;r!==null;)P0(t,e,r),r=r.sibling}function P0(t,e,r){if(Or&&typeof Or.onCommitFiberUnmount=="function")try{Or.onCommitFiberUnmount(Bc,r)}catch{}switch(r.tag){case 5:bt||_s(r,e);case 6:var n=pt,i=mr;pt=null,_n(t,e,r),pt=n,mr=i,pt!==null&&(mr?(t=pt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):pt.removeChild(r.stateNode));break;case 18:pt!==null&&(mr?(t=pt,r=r.stateNode,t.nodeType===8?ju(t.parentNode,r):t.nodeType===1&&ju(t,r),qo(t)):ju(pt,r.stateNode));break;case 4:n=pt,i=mr,pt=r.stateNode.containerInfo,mr=!0,_n(t,e,r),pt=n,mr=i;break;case 0:case 11:case 14:case 15:if(!bt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Ah(r,e,o),i=i.next}while(i!==n)}_n(t,e,r);break;case 1:if(!bt&&(_s(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){qe(r,e,a)}_n(t,e,r);break;case 21:_n(t,e,r);break;case 22:r.mode&1?(bt=(n=bt)||r.memoizedState!==null,_n(t,e,r),bt=n):_n(t,e,r);break;default:_n(t,e,r)}}function ag(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new hb),e.forEach(function(n){var i=Sb.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function cr(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:pt=a.stateNode,mr=!1;break e;case 3:pt=a.stateNode.containerInfo,mr=!0;break e;case 4:pt=a.stateNode.containerInfo,mr=!0;break e}a=a.return}if(pt===null)throw Error(V(160));P0(s,o,i),pt=null,mr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){qe(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)R0(e,t),e=e.sibling}function R0(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(cr(e,t),Tr(t),n&4){try{Lo(3,t,t.return),Gc(3,t)}catch(v){qe(t,t.return,v)}try{Lo(5,t,t.return)}catch(v){qe(t,t.return,v)}}break;case 1:cr(e,t),Tr(t),n&512&&r!==null&&_s(r,r.return);break;case 5:if(cr(e,t),Tr(t),n&512&&r!==null&&_s(r,r.return),t.flags&32){var i=t.stateNode;try{Wo(i,"")}catch(v){qe(t,t.return,v)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Qy(i,s),Zd(a,o);var u=Zd(a,s);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?nv(i,h):d==="dangerouslySetInnerHTML"?tv(i,h):d==="children"?Wo(i,h):Gf(i,d,h,u)}switch(a){case"input":Yd(i,s);break;case"textarea":Zy(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Es(i,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?Es(i,!!s.multiple,s.defaultValue,!0):Es(i,!!s.multiple,s.multiple?[]:"",!1))}i[ta]=s}catch(v){qe(t,t.return,v)}}break;case 6:if(cr(e,t),Tr(t),n&4){if(t.stateNode===null)throw Error(V(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){qe(t,t.return,v)}}break;case 3:if(cr(e,t),Tr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qo(e.containerInfo)}catch(v){qe(t,t.return,v)}break;case 4:cr(e,t),Tr(t);break;case 13:cr(e,t),Tr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(wp=Ze())),n&4&&ag(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(bt=(u=bt)||d,cr(e,t),bt=u):cr(e,t),Tr(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(re=t,d=t.child;d!==null;){for(h=re=d;re!==null;){switch(f=re,p=f.child,f.tag){case 0:case 11:case 14:case 15:Lo(4,f,f.return);break;case 1:_s(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){qe(n,r,v)}}break;case 5:_s(f,f.return);break;case 22:if(f.memoizedState!==null){cg(h);continue}}p!==null?(p.return=f,re=p):cg(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=rv("display",o))}catch(v){qe(t,t.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){qe(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:cr(e,t),Tr(t),n&4&&ag(t);break;case 21:break;default:cr(e,t),Tr(t)}}function Tr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(k0(r)){var n=r;break e}r=r.return}throw Error(V(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Wo(i,""),n.flags&=-33);var s=og(t);Ph(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=og(t);kh(t,a,o);break;default:throw Error(V(161))}}catch(c){qe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function pb(t,e,r){re=t,I0(t)}function I0(t,e,r){for(var n=(t.mode&1)!==0;re!==null;){var i=re,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||$a;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||bt;a=$a;var u=bt;if($a=o,(bt=c)&&!u)for(re=i;re!==null;)o=re,c=o.child,o.tag===22&&o.memoizedState!==null?ug(i):c!==null?(c.return=o,re=c):ug(i);for(;s!==null;)re=s,I0(s),s=s.sibling;re=i,$a=a,bt=u}lg(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,re=s):lg(t)}}function lg(t){for(;re!==null;){var e=re;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bt||Gc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!bt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:pr(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Wm(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Wm(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&qo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}bt||e.flags&512&&Ch(e)}catch(f){qe(e,e.return,f)}}if(e===t){re=null;break}if(r=e.sibling,r!==null){r.return=e.return,re=r;break}re=e.return}}function cg(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var r=e.sibling;if(r!==null){r.return=e.return,re=r;break}re=e.return}}function ug(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Gc(4,e)}catch(c){qe(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){qe(e,i,c)}}var s=e.return;try{Ch(e)}catch(c){qe(e,s,c)}break;case 5:var o=e.return;try{Ch(e)}catch(c){qe(e,o,c)}}}catch(c){qe(e,e.return,c)}if(e===t){re=null;break}var a=e.sibling;if(a!==null){a.return=e.return,re=a;break}re=e.return}}var mb=Math.ceil,ac=fn.ReactCurrentDispatcher,vp=fn.ReactCurrentOwner,ir=fn.ReactCurrentBatchConfig,Re=0,dt=null,rt=null,gt=0,Gt=0,ws=Zn(0),at=0,aa=null,ki=0,Hc=0,_p=0,Do=null,jt=null,wp=0,$s=1/0,Kr=null,lc=!1,Rh=null,Gn=null,Va=!1,Mn=null,cc=0,Oo=0,Ih=null,Cl=-1,kl=0;function Ct(){return Re&6?Ze():Cl!==-1?Cl:Cl=Ze()}function Hn(t){return t.mode&1?Re&2&&gt!==0?gt&-gt:QS.transition!==null?(kl===0&&(kl=mv()),kl):(t=Be,t!==0||(t=window.event,t=t===void 0?16:Sv(t.type)),t):1}function vr(t,e,r,n){if(50<Oo)throw Oo=0,Ih=null,Error(V(185));xa(t,r,n),(!(Re&2)||t!==dt)&&(t===dt&&(!(Re&2)&&(Hc|=r),at===4&&Pn(t,gt)),Ot(t,n),r===1&&Re===0&&!(e.mode&1)&&($s=Ze()+500,Oc&&ei()))}function Ot(t,e){var r=t.callbackNode;Qw(t,e);var n=Wl(t,t===dt?gt:0);if(n===0)r!==null&&vm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&vm(r),e===1)t.tag===0?JS(dg.bind(null,t)):zv(dg.bind(null,t)),XS(function(){!(Re&6)&&ei()}),r=null;else{switch(gv(n)){case 1:r=Xf;break;case 4:r=fv;break;case 16:r=Vl;break;case 536870912:r=pv;break;default:r=Vl}r=O0(r,M0.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function M0(t,e){if(Cl=-1,kl=0,Re&6)throw Error(V(327));var r=t.callbackNode;if(Ps()&&t.callbackNode!==r)return null;var n=Wl(t,t===dt?gt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=uc(t,n);else{e=n;var i=Re;Re|=2;var s=B0();(dt!==t||gt!==e)&&(Kr=null,$s=Ze()+500,_i(t,e));do try{yb();break}catch(a){j0(t,a)}while(!0);op(),ac.current=s,Re=i,rt!==null?e=0:(dt=null,gt=0,e=at)}if(e!==0){if(e===2&&(i=ih(t),i!==0&&(n=i,e=Mh(t,i))),e===1)throw r=aa,_i(t,0),Pn(t,n),Ot(t,Ze()),r;if(e===6)Pn(t,n);else{if(i=t.current.alternate,!(n&30)&&!gb(i)&&(e=uc(t,n),e===2&&(s=ih(t),s!==0&&(n=s,e=Mh(t,s))),e===1))throw r=aa,_i(t,0),Pn(t,n),Ot(t,Ze()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(V(345));case 2:li(t,jt,Kr);break;case 3:if(Pn(t,n),(n&130023424)===n&&(e=wp+500-Ze(),10<e)){if(Wl(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ct(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=hh(li.bind(null,t,jt,Kr),e);break}li(t,jt,Kr);break;case 4:if(Pn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-yr(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=Ze()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*mb(n/1960))-n,10<n){t.timeoutHandle=hh(li.bind(null,t,jt,Kr),n);break}li(t,jt,Kr);break;case 5:li(t,jt,Kr);break;default:throw Error(V(329))}}}return Ot(t,Ze()),t.callbackNode===r?M0.bind(null,t):null}function Mh(t,e){var r=Do;return t.current.memoizedState.isDehydrated&&(_i(t,e).flags|=256),t=uc(t,e),t!==2&&(e=jt,jt=r,e!==null&&jh(e)),t}function jh(t){jt===null?jt=t:jt.push.apply(jt,t)}function gb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Sr(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pn(t,e){for(e&=~_p,e&=~Hc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-yr(e),n=1<<r;t[r]=-1,e&=~n}}function dg(t){if(Re&6)throw Error(V(327));Ps();var e=Wl(t,0);if(!(e&1))return Ot(t,Ze()),null;var r=uc(t,e);if(t.tag!==0&&r===2){var n=ih(t);n!==0&&(e=n,r=Mh(t,n))}if(r===1)throw r=aa,_i(t,0),Pn(t,e),Ot(t,Ze()),r;if(r===6)throw Error(V(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,li(t,jt,Kr),Ot(t,Ze()),null}function Sp(t,e){var r=Re;Re|=1;try{return t(e)}finally{Re=r,Re===0&&($s=Ze()+500,Oc&&ei())}}function Pi(t){Mn!==null&&Mn.tag===0&&!(Re&6)&&Ps();var e=Re;Re|=1;var r=ir.transition,n=Be;try{if(ir.transition=null,Be=1,t)return t()}finally{Be=n,ir.transition=r,Re=e,!(Re&6)&&ei()}}function bp(){Gt=ws.current,Ue(ws)}function _i(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,WS(r)),rt!==null)for(r=rt.return;r!==null;){var n=r;switch(np(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Jl();break;case 3:Gs(),Ue(Lt),Ue(Et),hp();break;case 5:dp(n);break;case 4:Gs();break;case 13:Ue($e);break;case 19:Ue($e);break;case 10:ap(n.type._context);break;case 22:case 23:bp()}r=r.return}if(dt=t,rt=t=$n(t.current,null),gt=Gt=e,at=0,aa=null,_p=Hc=ki=0,jt=Do=null,yi!==null){for(e=0;e<yi.length;e++)if(r=yi[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}yi=null}return t}function j0(t,e){do{var r=rt;try{if(op(),El.current=oc,sc){for(var n=We.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}sc=!1}if(Ci=0,ct=ot=We=null,Fo=!1,ia=0,vp.current=null,r===null||r.return===null){at=1,aa=e,rt=null;break}e:{var s=t,o=r.return,a=r,c=e;if(e=gt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Qm(o);if(p!==null){p.flags&=-257,Zm(p,o,a,s,e),p.mode&1&&Jm(s,u,e),e=p,c=u;var m=e.updateQueue;if(m===null){var v=new Set;v.add(c),e.updateQueue=v}else m.add(c);break e}else{if(!(e&1)){Jm(s,u,e),Ep();break e}c=Error(V(426))}}else if(Ge&&a.mode&1){var _=Qm(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Zm(_,o,a,s,e),ip(Hs(c,a));break e}}s=c=Hs(c,a),at!==4&&(at=2),Do===null?Do=[s]:Do.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=g0(s,c,e);Vm(s,y);break e;case 1:a=c;var x=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Gn===null||!Gn.has(g)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=x0(s,a,e);Vm(s,w);break e}}s=s.return}while(s!==null)}F0(r)}catch(T){e=T,rt===r&&r!==null&&(rt=r=r.return);continue}break}while(!0)}function B0(){var t=ac.current;return ac.current=oc,t===null?oc:t}function Ep(){(at===0||at===3||at===2)&&(at=4),dt===null||!(ki&268435455)&&!(Hc&268435455)||Pn(dt,gt)}function uc(t,e){var r=Re;Re|=2;var n=B0();(dt!==t||gt!==e)&&(Kr=null,_i(t,e));do try{xb();break}catch(i){j0(t,i)}while(!0);if(op(),Re=r,ac.current=n,rt!==null)throw Error(V(261));return dt=null,gt=0,at}function xb(){for(;rt!==null;)N0(rt)}function yb(){for(;rt!==null&&!Hw();)N0(rt)}function N0(t){var e=D0(t.alternate,t,Gt);t.memoizedProps=t.pendingProps,e===null?F0(t):rt=e,vp.current=null}function F0(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=db(r,e),r!==null){r.flags&=32767,rt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{at=6,rt=null;return}}else if(r=ub(r,e,Gt),r!==null){rt=r;return}if(e=e.sibling,e!==null){rt=e;return}rt=e=t}while(e!==null);at===0&&(at=5)}function li(t,e,r){var n=Be,i=ir.transition;try{ir.transition=null,Be=1,vb(t,e,r,n)}finally{ir.transition=i,Be=n}return null}function vb(t,e,r,n){do Ps();while(Mn!==null);if(Re&6)throw Error(V(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(V(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Zw(t,s),t===dt&&(rt=dt=null,gt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Va||(Va=!0,O0(Vl,function(){return Ps(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ir.transition,ir.transition=null;var o=Be;Be=1;var a=Re;Re|=4,vp.current=null,fb(t,r),R0(r,t),OS(uh),Xl=!!ch,uh=ch=null,t.current=r,pb(r),$w(),Re=a,Be=o,ir.transition=s}else t.current=r;if(Va&&(Va=!1,Mn=t,cc=i),s=t.pendingLanes,s===0&&(Gn=null),Xw(r.stateNode),Ot(t,Ze()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(lc)throw lc=!1,t=Rh,Rh=null,t;return cc&1&&t.tag!==0&&Ps(),s=t.pendingLanes,s&1?t===Ih?Oo++:(Oo=0,Ih=t):Oo=0,ei(),null}function Ps(){if(Mn!==null){var t=gv(cc),e=ir.transition,r=Be;try{if(ir.transition=null,Be=16>t?16:t,Mn===null)var n=!1;else{if(t=Mn,Mn=null,cc=0,Re&6)throw Error(V(331));var i=Re;for(Re|=4,re=t.current;re!==null;){var s=re,o=s.child;if(re.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(re=u;re!==null;){var d=re;switch(d.tag){case 0:case 11:case 15:Lo(8,d,s)}var h=d.child;if(h!==null)h.return=d,re=h;else for(;re!==null;){d=re;var f=d.sibling,p=d.return;if(C0(d),d===u){re=null;break}if(f!==null){f.return=p,re=f;break}re=p}}}var m=s.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}re=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,re=o;else e:for(;re!==null;){if(s=re,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Lo(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,re=y;break e}re=s.return}}var x=t.current;for(re=x;re!==null;){o=re;var g=o.child;if(o.subtreeFlags&2064&&g!==null)g.return=o,re=g;else e:for(o=x;re!==null;){if(a=re,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Gc(9,a)}}catch(T){qe(a,a.return,T)}if(a===o){re=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,re=w;break e}re=a.return}}if(Re=i,ei(),Or&&typeof Or.onPostCommitFiberRoot=="function")try{Or.onPostCommitFiberRoot(Bc,t)}catch{}n=!0}return n}finally{Be=r,ir.transition=e}}return!1}function hg(t,e,r){e=Hs(r,e),e=g0(t,e,1),t=zn(t,e,1),e=Ct(),t!==null&&(xa(t,1,e),Ot(t,e))}function qe(t,e,r){if(t.tag===3)hg(t,t,r);else for(;e!==null;){if(e.tag===3){hg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Gn===null||!Gn.has(n))){t=Hs(r,t),t=x0(e,t,1),e=zn(e,t,1),t=Ct(),e!==null&&(xa(e,1,t),Ot(e,t));break}}e=e.return}}function _b(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ct(),t.pingedLanes|=t.suspendedLanes&r,dt===t&&(gt&r)===r&&(at===4||at===3&&(gt&130023424)===gt&&500>Ze()-wp?_i(t,0):_p|=r),Ot(t,e)}function L0(t,e){e===0&&(t.mode&1?(e=Na,Na<<=1,!(Na&130023424)&&(Na=4194304)):e=1);var r=Ct();t=cn(t,e),t!==null&&(xa(t,e,r),Ot(t,r))}function wb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),L0(t,r)}function Sb(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(V(314))}n!==null&&n.delete(e),L0(t,r)}var D0;D0=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Lt.current)Bt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Bt=!1,cb(t,e,r);Bt=!!(t.flags&131072)}else Bt=!1,Ge&&e.flags&1048576&&Gv(e,ec,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Al(t,e),t=e.pendingProps;var i=Os(e,Et.current);ks(e,r),i=pp(null,e,n,t,i,r);var s=mp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Dt(n)?(s=!0,Ql(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,cp(e),i.updater=zc,e.stateNode=i,i._reactInternals=e,vh(e,n,t,r),e=Sh(null,e,n,!0,s,r)):(e.tag=0,Ge&&s&&rp(e),Tt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Al(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Eb(n),t=pr(n,t),i){case 0:e=wh(null,e,n,t,r);break e;case 1:e=rg(null,e,n,t,r);break e;case 11:e=eg(null,e,n,t,r);break e;case 14:e=tg(null,e,n,pr(n.type,t),r);break e}throw Error(V(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pr(n,i),wh(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pr(n,i),rg(t,e,n,i,r);case 3:e:{if(w0(e),t===null)throw Error(V(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Yv(t,e),nc(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Hs(Error(V(423)),e),e=ng(t,e,n,r,i);break e}else if(n!==i){i=Hs(Error(V(424)),e),e=ng(t,e,n,r,i);break e}else for(Ht=Un(e.stateNode.containerInfo.firstChild),Wt=e,Ge=!0,gr=null,r=Wv(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Us(),n===i){e=un(t,e,r);break e}Tt(t,e,n,r)}e=e.child}return e;case 5:return Kv(e),t===null&&gh(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,dh(n,i)?o=null:s!==null&&dh(n,s)&&(e.flags|=32),_0(t,e),Tt(t,e,o,r),e.child;case 6:return t===null&&gh(e),null;case 13:return S0(t,e,r);case 4:return up(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=zs(e,null,n,r):Tt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pr(n,i),eg(t,e,n,i,r);case 7:return Tt(t,e,e.pendingProps,r),e.child;case 8:return Tt(t,e,e.pendingProps.children,r),e.child;case 12:return Tt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Fe(tc,n._currentValue),n._currentValue=o,s!==null)if(Sr(s.value,o)){if(s.children===i.children&&!Lt.current){e=un(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=sn(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),xh(s.return,r,e),a.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(V(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),xh(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Tt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,ks(e,r),i=sr(i),n=n(i),e.flags|=1,Tt(t,e,n,r),e.child;case 14:return n=e.type,i=pr(n,e.pendingProps),i=pr(n.type,i),tg(t,e,n,i,r);case 15:return y0(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pr(n,i),Al(t,e),e.tag=1,Dt(n)?(t=!0,Ql(e)):t=!1,ks(e,r),m0(e,n,i),vh(e,n,i,r),Sh(null,e,n,!0,t,r);case 19:return b0(t,e,r);case 22:return v0(t,e,r)}throw Error(V(156,e.tag))};function O0(t,e){return hv(t,e)}function bb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tr(t,e,r,n){return new bb(t,e,r,n)}function Tp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Eb(t){if(typeof t=="function")return Tp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$f)return 11;if(t===Vf)return 14}return 2}function $n(t,e){var r=t.alternate;return r===null?(r=tr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Pl(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")Tp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ds:return wi(r.children,i,s,e);case Hf:o=8,i|=8;break;case Hd:return t=tr(12,r,e,i|2),t.elementType=Hd,t.lanes=s,t;case $d:return t=tr(13,r,e,i),t.elementType=$d,t.lanes=s,t;case Vd:return t=tr(19,r,e,i),t.elementType=Vd,t.lanes=s,t;case Ky:return $c(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Xy:o=10;break e;case Yy:o=9;break e;case $f:o=11;break e;case Vf:o=14;break e;case Tn:o=16,n=null;break e}throw Error(V(130,t==null?t:typeof t,""))}return e=tr(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function wi(t,e,r,n){return t=tr(7,t,n,e),t.lanes=r,t}function $c(t,e,r,n){return t=tr(22,t,n,e),t.elementType=Ky,t.lanes=r,t.stateNode={isHidden:!1},t}function zu(t,e,r){return t=tr(6,t,null,e),t.lanes=r,t}function Gu(t,e,r){return e=tr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Tb(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Su(0),this.expirationTimes=Su(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Su(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ap(t,e,r,n,i,s,o,a,c){return t=new Tb(t,e,r,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=tr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},cp(s),t}function Ab(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:us,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function U0(t){if(!t)return Yn;t=t._reactInternals;e:{if(Ni(t)!==t||t.tag!==1)throw Error(V(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Dt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(V(171))}if(t.tag===1){var r=t.type;if(Dt(r))return Uv(t,r,e)}return e}function z0(t,e,r,n,i,s,o,a,c){return t=Ap(r,n,!0,t,i,s,o,a,c),t.context=U0(null),r=t.current,n=Ct(),i=Hn(r),s=sn(n,i),s.callback=e??null,zn(r,s,i),t.current.lanes=i,xa(t,i,n),Ot(t,n),t}function Vc(t,e,r,n){var i=e.current,s=Ct(),o=Hn(i);return r=U0(r),e.context===null?e.context=r:e.pendingContext=r,e=sn(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=zn(i,e,o),t!==null&&(vr(t,i,o,s),bl(t,i,o)),o}function dc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Cp(t,e){fg(t,e),(t=t.alternate)&&fg(t,e)}function Cb(){return null}var G0=typeof reportError=="function"?reportError:function(t){console.error(t)};function kp(t){this._internalRoot=t}Wc.prototype.render=kp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(V(409));Vc(t,e,null,null)};Wc.prototype.unmount=kp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Pi(function(){Vc(null,t,null,null)}),e[ln]=null}};function Wc(t){this._internalRoot=t}Wc.prototype.unstable_scheduleHydration=function(t){if(t){var e=vv();t={blockedOn:null,target:t,priority:e};for(var r=0;r<kn.length&&e!==0&&e<kn[r].priority;r++);kn.splice(r,0,t),r===0&&wv(t)}};function Pp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Xc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pg(){}function kb(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=dc(o);s.call(u)}}var o=z0(e,n,t,0,null,!1,!1,"",pg);return t._reactRootContainer=o,t[ln]=o.current,Zo(t.nodeType===8?t.parentNode:t),Pi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var u=dc(c);a.call(u)}}var c=Ap(t,0,!1,null,null,!1,!1,"",pg);return t._reactRootContainer=c,t[ln]=c.current,Zo(t.nodeType===8?t.parentNode:t),Pi(function(){Vc(e,c,r,n)}),c}function Yc(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=dc(o);a.call(c)}}Vc(e,o,t,i)}else o=kb(r,e,t,i,n);return dc(o)}xv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=_o(e.pendingLanes);r!==0&&(Yf(e,r|1),Ot(e,Ze()),!(Re&6)&&($s=Ze()+500,ei()))}break;case 13:Pi(function(){var n=cn(t,1);if(n!==null){var i=Ct();vr(n,t,1,i)}}),Cp(t,1)}};Kf=function(t){if(t.tag===13){var e=cn(t,134217728);if(e!==null){var r=Ct();vr(e,t,134217728,r)}Cp(t,134217728)}};yv=function(t){if(t.tag===13){var e=Hn(t),r=cn(t,e);if(r!==null){var n=Ct();vr(r,t,e,n)}Cp(t,e)}};vv=function(){return Be};_v=function(t,e){var r=Be;try{return Be=t,e()}finally{Be=r}};th=function(t,e,r){switch(e){case"input":if(Yd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Dc(n);if(!i)throw Error(V(90));Jy(n),Yd(n,i)}}}break;case"textarea":Zy(t,r);break;case"select":e=r.value,e!=null&&Es(t,!!r.multiple,e,!1)}};ov=Sp;av=Pi;var Pb={usingClientEntryPoint:!1,Events:[va,ms,Dc,iv,sv,Sp]},co={findFiberByHostInstance:xi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rb={bundleType:co.bundleType,version:co.version,rendererPackageName:co.rendererPackageName,rendererConfig:co.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=uv(t),t===null?null:t.stateNode},findFiberByHostInstance:co.findFiberByHostInstance||Cb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wa.isDisabled&&Wa.supportsFiber)try{Bc=Wa.inject(Rb),Or=Wa}catch{}}Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pb;Yt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pp(e))throw Error(V(200));return Ab(t,e,null,r)};Yt.createRoot=function(t,e){if(!Pp(t))throw Error(V(299));var r=!1,n="",i=G0;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Ap(t,1,!1,null,null,r,!1,n,i),t[ln]=e.current,Zo(t.nodeType===8?t.parentNode:t),new kp(e)};Yt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(V(188)):(t=Object.keys(t).join(","),Error(V(268,t)));return t=uv(e),t=t===null?null:t.stateNode,t};Yt.flushSync=function(t){return Pi(t)};Yt.hydrate=function(t,e,r){if(!Xc(e))throw Error(V(200));return Yc(null,t,e,!0,r)};Yt.hydrateRoot=function(t,e,r){if(!Pp(t))throw Error(V(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=G0;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=z0(e,null,t,1,r??null,i,!1,s,o),t[ln]=e.current,Zo(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Wc(e)};Yt.render=function(t,e,r){if(!Xc(e))throw Error(V(200));return Yc(null,t,e,!1,r)};Yt.unmountComponentAtNode=function(t){if(!Xc(t))throw Error(V(40));return t._reactRootContainer?(Pi(function(){Yc(null,null,t,!1,function(){t._reactRootContainer=null,t[ln]=null})}),!0):!1};Yt.unstable_batchedUpdates=Sp;Yt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Xc(r))throw Error(V(200));if(t==null||t._reactInternals===void 0)throw Error(V(38));return Yc(t,e,r,!1,n)};Yt.version="18.3.1-next-f1338f8080-20240426";function H0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H0)}catch(t){console.error(t)}}H0(),Hy.exports=Yt;var Ib=Hy.exports,mg=Ib;zd.createRoot=mg.createRoot,zd.hydrateRoot=mg.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function la(){return la=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},la.apply(this,arguments)}var jn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(jn||(jn={}));const gg="popstate";function Mb(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return Bh("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:hc(i)}return Bb(e,r,null,t)}function nt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Rp(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function jb(){return Math.random().toString(36).substr(2,8)}function xg(t,e){return{usr:t.state,key:t.key,idx:e}}function Bh(t,e,r,n){return r===void 0&&(r=null),la({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Js(e):e,{state:r,key:e&&e.key||n||jb()})}function hc(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Js(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function Bb(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=jn.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(la({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){a=jn.Pop;let _=d(),y=_==null?null:_-u;u=_,c&&c({action:a,location:v.location,delta:y})}function f(_,y){a=jn.Push;let x=Bh(v.location,_,y);u=d()+1;let g=xg(x,u),w=v.createHref(x);try{o.pushState(g,"",w)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(w)}s&&c&&c({action:a,location:v.location,delta:1})}function p(_,y){a=jn.Replace;let x=Bh(v.location,_,y);u=d();let g=xg(x,u),w=v.createHref(x);o.replaceState(g,"",w),s&&c&&c({action:a,location:v.location,delta:0})}function m(_){let y=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof _=="string"?_:hc(_);return x=x.replace(/ $/,"%20"),nt(y,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,y)}let v={get action(){return a},get location(){return t(i,o)},listen(_){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(gg,h),c=_,()=>{i.removeEventListener(gg,h),c=null}},createHref(_){return e(i,_)},createURL:m,encodeLocation(_){let y=m(_);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:p,go(_){return o.go(_)}};return v}var yg;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(yg||(yg={}));function Nb(t,e,r){return r===void 0&&(r="/"),Fb(t,e,r)}function Fb(t,e,r,n){let i=typeof e=="string"?Js(e):e,s=Ip(i.pathname||"/",r);if(s==null)return null;let o=$0(t);Lb(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let u=Kb(s);a=Wb(o[c],u)}return a}function $0(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let c={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(nt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Vn([n,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(nt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),$0(s.children,e,d,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:$b(u,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let c of V0(s.path))i(s,o,c)}),e}function V0(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=V0(n.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function Lb(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Vb(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Db=/^:[\w-]+$/,Ob=3,Ub=2,zb=1,Gb=10,Hb=-2,vg=t=>t==="*";function $b(t,e){let r=t.split("/"),n=r.length;return r.some(vg)&&(n+=Hb),e&&(n+=Ub),r.filter(i=>!vg(i)).reduce((i,s)=>i+(Db.test(s)?Ob:s===""?zb:Gb),n)}function Vb(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Wb(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let c=n[a],u=a===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",h=Xb({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Vn([s,h.pathname]),pathnameBase:eE(Vn([s,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(s=Vn([s,h.pathnameBase]))}return o}function Xb(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=Yb(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let v=a[h]||"";o=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const m=a[h];return p&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function Yb(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Rp(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(n.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function Kb(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Rp(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ip(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const qb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jb=t=>qb.test(t);function Qb(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Js(t):t,s;if(r)if(Jb(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Rp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=_g(r.substring(1),"/"):s=_g(r,e)}else s=e;return{pathname:s,search:tE(n),hash:rE(i)}}function _g(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Hu(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Zb(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function W0(t,e){let r=Zb(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function X0(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Js(t):(i=la({},t),nt(!i.pathname||!i.pathname.includes("?"),Hu("?","pathname","search",i)),nt(!i.pathname||!i.pathname.includes("#"),Hu("#","pathname","hash",i)),nt(!i.search||!i.search.includes("#"),Hu("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;i.pathname=f.join("/")}a=h>=0?e[h]:"/"}let c=Qb(i,a),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Vn=t=>t.join("/").replace(/\/\/+/g,"/"),eE=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),tE=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,rE=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function nE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Y0=["post","put","patch","delete"];new Set(Y0);const iE=["get",...Y0];new Set(iE);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ca(){return ca=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ca.apply(this,arguments)}const Mp=S.createContext(null),sE=S.createContext(null),Fi=S.createContext(null),Kc=S.createContext(null),Li=S.createContext({outlet:null,matches:[],isDataRoute:!1}),K0=S.createContext(null);function oE(t,e){let{relative:r}=e===void 0?{}:e;wa()||nt(!1);let{basename:n,navigator:i}=S.useContext(Fi),{hash:s,pathname:o,search:a}=J0(t,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:Vn([n,o])),i.createHref({pathname:c,search:a,hash:s})}function wa(){return S.useContext(Kc)!=null}function ti(){return wa()||nt(!1),S.useContext(Kc).location}function q0(t){S.useContext(Fi).static||S.useLayoutEffect(t)}function qt(){let{isDataRoute:t}=S.useContext(Li);return t?vE():aE()}function aE(){wa()||nt(!1);let t=S.useContext(Mp),{basename:e,future:r,navigator:n}=S.useContext(Fi),{matches:i}=S.useContext(Li),{pathname:s}=ti(),o=JSON.stringify(W0(i,r.v7_relativeSplatPath)),a=S.useRef(!1);return q0(()=>{a.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){n.go(u);return}let h=X0(u,JSON.parse(o),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Vn([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,o,s,t])}function J0(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=S.useContext(Fi),{matches:i}=S.useContext(Li),{pathname:s}=ti(),o=JSON.stringify(W0(i,n.v7_relativeSplatPath));return S.useMemo(()=>X0(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function lE(t,e){return cE(t,e)}function cE(t,e,r,n){wa()||nt(!1);let{navigator:i}=S.useContext(Fi),{matches:s}=S.useContext(Li),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=ti(),d;if(e){var h;let _=typeof e=="string"?Js(e):e;c==="/"||(h=_.pathname)!=null&&h.startsWith(c)||nt(!1),d=_}else d=u;let f=d.pathname||"/",p=f;if(c!=="/"){let _=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(_.length).join("/")}let m=Nb(t,{pathname:p}),v=pE(m&&m.map(_=>Object.assign({},_,{params:Object.assign({},a,_.params),pathname:Vn([c,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?c:Vn([c,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,r,n);return e&&v?S.createElement(Kc.Provider,{value:{location:ca({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:jn.Pop}},v):v}function uE(){let t=yE(),e=nE(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),r?S.createElement("pre",{style:i},r):null,null)}const dE=S.createElement(uE,null);class hE extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?S.createElement(Li.Provider,{value:this.props.routeContext},S.createElement(K0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fE(t){let{routeContext:e,match:r,children:n}=t,i=S.useContext(Mp);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),S.createElement(Li.Provider,{value:e},n)}function pE(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let d=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);d>=0||nt(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=r,m=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||m){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let p,m=!1,v=null,_=null;r&&(p=a&&h.route.id?a[h.route.id]:void 0,v=h.route.errorElement||dE,c&&(u<0&&f===0?(_E("route-fallback"),m=!0,_=null):u===f&&(m=!0,_=h.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,f+1)),x=()=>{let g;return p?g=v:m?g=_:h.route.Component?g=S.createElement(h.route.Component,null):h.route.element?g=h.route.element:g=d,S.createElement(fE,{match:h,routeContext:{outlet:d,matches:y,isDataRoute:r!=null},children:g})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?S.createElement(hE,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}var Q0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Q0||{}),Z0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Z0||{});function mE(t){let e=S.useContext(Mp);return e||nt(!1),e}function gE(t){let e=S.useContext(sE);return e||nt(!1),e}function xE(t){let e=S.useContext(Li);return e||nt(!1),e}function e_(t){let e=xE(),r=e.matches[e.matches.length-1];return r.route.id||nt(!1),r.route.id}function yE(){var t;let e=S.useContext(K0),r=gE(),n=e_();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function vE(){let{router:t}=mE(Q0.UseNavigateStable),e=e_(Z0.UseNavigateStable),r=S.useRef(!1);return q0(()=>{r.current=!0}),S.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,ca({fromRouteId:e},s)))},[t,e])}const wg={};function _E(t,e,r){wg[t]||(wg[t]=!0)}function wE(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Jt(t){nt(!1)}function SE(t){let{basename:e="/",children:r=null,location:n,navigationType:i=jn.Pop,navigator:s,static:o=!1,future:a}=t;wa()&&nt(!1);let c=e.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:s,static:o,future:ca({v7_relativeSplatPath:!1},a)}),[c,a,s,o]);typeof n=="string"&&(n=Js(n));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:m="default"}=n,v=S.useMemo(()=>{let _=Ip(d,c);return _==null?null:{location:{pathname:_,search:h,hash:f,state:p,key:m},navigationType:i}},[c,d,h,f,p,m,i]);return v==null?null:S.createElement(Fi.Provider,{value:u},S.createElement(Kc.Provider,{children:r,value:v}))}function bE(t){let{children:e,location:r}=t;return lE(Nh(e),r)}new Promise(()=>{});function Nh(t,e){e===void 0&&(e=[]);let r=[];return S.Children.forEach(t,(n,i)=>{if(!S.isValidElement(n))return;let s=[...e,i];if(n.type===S.Fragment){r.push.apply(r,Nh(n.props.children,s));return}n.type!==Jt&&nt(!1),!n.props.index||!n.props.children||nt(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Nh(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fh(){return Fh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Fh.apply(this,arguments)}function EE(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function TE(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function AE(t,e){return t.button===0&&(!e||e==="_self")&&!TE(t)}function Lh(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function CE(t,e){let r=Lh(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(s=>{r.append(i,s)})}),r}const kE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],PE="6";try{window.__reactRouterVersion=PE}catch{}const RE="startTransition",Sg=_w[RE];function IE(t){let{basename:e,children:r,future:n,window:i}=t,s=S.useRef();s.current==null&&(s.current=Mb({window:i,v5Compat:!0}));let o=s.current,[a,c]=S.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=S.useCallback(h=>{u&&Sg?Sg(()=>c(h)):c(h)},[c,u]);return S.useLayoutEffect(()=>o.listen(d),[o,d]),S.useEffect(()=>wE(n),[n]),S.createElement(SE,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const ME=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",jE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ua=S.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,f=EE(e,kE),{basename:p}=S.useContext(Fi),m,v=!1;if(typeof u=="string"&&jE.test(u)&&(m=u,ME))try{let g=new URL(window.location.href),w=u.startsWith("//")?new URL(g.protocol+u):new URL(u),T=Ip(w.pathname,p);w.origin===g.origin&&T!=null?u=T+w.search+w.hash:v=!0}catch{}let _=oE(u,{relative:i}),y=BE(u,{replace:o,state:a,target:c,preventScrollReset:d,relative:i,viewTransition:h});function x(g){n&&n(g),g.defaultPrevented||y(g)}return S.createElement("a",Fh({},f,{href:m||_,onClick:v||s?n:x,ref:r,target:c}))});var bg;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(bg||(bg={}));var Eg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Eg||(Eg={}));function BE(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,c=qt(),u=ti(),d=J0(t,{relative:o});return S.useCallback(h=>{if(AE(h,r)){h.preventDefault();let f=n!==void 0?n:hc(u)===hc(d);c(t,{replace:f,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,c,d,n,i,r,t,s,o,a])}function qc(t){let e=S.useRef(Lh(t)),r=S.useRef(!1),n=ti(),i=S.useMemo(()=>CE(n.search,r.current?null:e.current),[n.search]),s=qt(),o=S.useCallback((a,c)=>{const u=Lh(typeof a=="function"?a(i):a);r.current=!0,s("?"+u,c)},[s,i]);return[i,o]}function NE(){const t=qt(),[e,r]=S.useState(0),[n,i]=S.useState(!1),s=S.useRef(null),o=80;return S.useEffect(()=>{const a=s.current;if(!a)return;let c=0,u=0,d=!1;const h=m=>{a.scrollTop===0&&(c=m.touches[0].clientY,d=!0,console.log("Pull-to-refresh: Touch started"))},f=m=>{if(!d)return;u=m.touches[0].clientY;const v=u-c;if(v>0){m.preventDefault();const _=Math.pow(v,.85);r(Math.min(_,o*1.5)),console.log("Pull distance:",Math.min(_,o*1.5).toFixed(0))}},p=()=>{e>o?(i(!0),r(0),setTimeout(()=>{window.location.reload()},400)):r(0),d=!1};return a.addEventListener("touchstart",h,{passive:!0}),a.addEventListener("touchmove",f,{passive:!1}),a.addEventListener("touchend",p),()=>{a.removeEventListener("touchstart",h),a.removeEventListener("touchmove",f),a.removeEventListener("touchend",p)}},[e]),l.jsxs("div",{ref:s,className:"screen screen-center",style:{position:"relative",overflow:"auto"},children:[l.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:`${e}px`,display:"flex",alignItems:"flex-end",justifyContent:"center",paddingBottom:"8px",opacity:Math.min(e/o,1),transition:e===0?"all 0.3s ease":"none",pointerEvents:"none",zIndex:10},children:n?l.jsx("div",{style:{width:"24px",height:"24px",border:"3px solid var(--color-surface)",borderTop:"3px solid var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}):l.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",fontWeight:600},children:e>o?" Release to refresh":" Pull to refresh"})}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",zIndex:1,transform:`translateY(${e}px)`,transition:e===0?"transform 0.3s ease":"none",paddingBottom:"120px"},children:[l.jsx("img",{src:"/data/icons/OwlHeadphones.png",alt:"ChipNotes Owl Professor",style:{width:"180px",height:"180px",borderRadius:"50%",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",marginBottom:"4px"}}),l.jsx("h1",{style:{margin:0,fontSize:"44px",fontWeight:800,letterSpacing:"-1px",background:"linear-gradient(135deg, #FFD54F 0%, #FF8A65 50%, #E57373 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"ChipNotes!"}),l.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"16px",maxWidth:"280px",textAlign:"center",lineHeight:1.4,marginTop:"-4px",fontWeight:600},children:"Train your ear. Know the birds."}),l.jsx("button",{onClick:()=>t("/pack-select"),style:{marginTop:"16px",padding:"18px 64px",fontSize:"20px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"16px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.4)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:a=>{a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow="0 6px 20px rgba(45, 90, 39, 0.5)"},onMouseLeave:a=>{a.currentTarget.style.transform="translateY(0)",a.currentTarget.style.boxShadow="0 4px 16px rgba(45, 90, 39, 0.4)"},children:"Play"}),l.jsx("div",{style:{marginTop:"20px",padding:"16px",background:"var(--color-surface)",borderRadius:"16px",maxWidth:"360px"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px"},children:[l.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[l.jsx("div",{style:{width:"72px",height:"52px",background:"linear-gradient(180deg, #1a1a2e 0%, #0d1520 100%)",borderRadius:"10px",padding:"6px",display:"flex",alignItems:"flex-end",justifyContent:"center",gap:"2px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.3)"},children:l.jsx(FE,{})}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Hear"})]}),l.jsx("div",{style:{color:"var(--color-accent)",fontSize:"24px",marginTop:"-16px"},children:""}),l.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"4px"},children:["NOCA","BLJA","TUTI","CARW"].map((a,c)=>l.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",overflow:"hidden",border:c===0?"2px solid var(--color-accent)":"2px solid transparent",boxShadow:c===0?"0 0 8px rgba(255, 152, 0, 0.4)":"none"},children:l.jsx("img",{src:`/data/icons/${a}.png`,alt:a,style:{width:"100%",height:"100%",objectFit:"cover"}})},a))}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Match"})]}),l.jsx("div",{style:{color:"var(--color-accent)",fontSize:"24px",marginTop:"-16px"},children:""}),l.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto"},children:[l.jsx("div",{style:{width:"72px",height:"52px",background:"#2a2a3e",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.4)"},children:l.jsx("div",{style:{fontSize:"32px"},children:""})}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"6px"},children:"Train"})]})]})})]}),l.jsxs("div",{style:{position:"absolute",bottom:"70px",left:0,right:0,display:"flex",justifyContent:"center",gap:"40px",zIndex:1e3},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/help"),"aria-label":"How to Play",children:l.jsx(LE,{})}),l.jsx("button",{className:"btn-icon",onClick:()=>t("/settings"),"aria-label":"Settings",children:l.jsx(DE,{})}),l.jsx("button",{className:"btn-icon",onClick:()=>t("/progress"),"aria-label":"Progress",children:l.jsx(OE,{})})]}),l.jsx("button",{onClick:()=>t("/help",{state:{openVersionHistory:!0}}),style:{position:"absolute",bottom:"calc(4px + var(--safe-area-bottom, 0px))",left:0,right:0,textAlign:"center",fontSize:"11px",color:"var(--color-text-muted)",opacity:.6,background:"none",border:"none",cursor:"pointer",padding:"4px",transition:"opacity 0.2s",zIndex:1001},onMouseEnter:a=>a.currentTarget.style.opacity="1",onMouseLeave:a=>a.currentTarget.style.opacity="0.6","aria-label":"View version history",children:"v3.45"})]})}function FE(){const t=[8,16,24,32,26,34,28,36,20,12,26,32];return l.jsx("svg",{width:"76",height:"40",viewBox:"0 0 76 40",children:t.map((e,r)=>l.jsx("rect",{x:r*6+2,y:40-e,width:"4",height:e,rx:"1.5",fill:`hsl(${30+r*8}, 80%, ${50+r*2}%)`,opacity:.8+r*.015},r))})}function LE(){return l.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),l.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}function DE(){return l.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"3"}),l.jsx("path",{d:"M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"})]})}function OE(){return l.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 3v18h18"}),l.jsx("path",{d:"M7 16l4-4 4 4 6-6"})]})}function $r(t,e){typeof window.gtag=="function"&&window.gtag("event",t,e)}function UE(t,e){$r("pack_select",{pack_id:t,pack_name:e})}function zE(t,e,r){$r("game_start",{pack_id:t,level_id:e,species_count:r})}function GE(t,e,r,n,i){$r("round_complete",{pack_id:t,level_id:e,score:r,accuracy:n,duration_sec:i})}function HE(t){$r("training_mode_toggle",{enabled:t})}function $E(t,e,r){$r("level_select",{pack_id:t,level_id:e,level_title:r})}function t_(t,e){$r("taxonomic_sort_toggle",{enabled:t,location:e})}function VE(t){$r("custom_pack_create",{species_count:t})}function Tg(t,e){$r("custom_pack_save",{pack_name:t,species_count:e})}function WE(t,e){$r("custom_pack_load",{pack_name:t,species_count:e})}function XE(t){$r("custom_pack_delete",{pack_name:t})}const $u=[{id:"starter_birds",name:"Eastern Backyard Birds",speciesCount:6,isUnlocked:!0,description:"Start here! Distinctive, bold, recognizable voices."},{id:"expanded_backyard",name:"Expanded Eastern Birds",speciesCount:46,isUnlocked:!0,description:"Ready for more? 9 random per round."},{id:"sparrows",name:"Sparrows",speciesCount:8,isUnlocked:!0,description:"Master their subtle songs."},{id:"woodpeckers",name:"Woodpeckers",speciesCount:7,isUnlocked:!0,description:"Drums, calls, and rattles."},{id:"western_birds",name:"Western Backyard Birds",speciesCount:14,isUnlocked:!0,description:"Pacific coast to the Rockies."},{id:"spring_warblers",name:"Warbler Academy",speciesCount:33,isUnlocked:!0,description:"9 random per round. Custom Pack mode recommended!"}];function YE(){var z,H,W;const t=qt(),e=ti(),[r]=qc(),[n,i]=S.useState([]),[s,o]=S.useState({}),[a,c]=S.useState(null),[u,d]=S.useState(null),[h,f]=S.useState(new Set),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[y,x]=S.useState(!1),[g,w]=S.useState(!1),[T,A]=S.useState({}),[C,b]=S.useState({}),[I,N]=S.useState({}),L=S.useRef(null);S.useEffect(()=>{fetch("/data/clips.json").then(k=>k.json()).then(k=>{i(k);const U=Array.from(new Set(k.filter(R=>!R.rejected&&(!R.spectrogram_path||!R.spectrogram_path.includes("spectrograms-rejected"))).map(R=>R.species_code))).sort();o(R=>({...R,all_birds:U}))}).catch(k=>console.error("Failed to load clips:",k))},[]),S.useEffect(()=>{fetch("/data/taxonomic_order.json").then(k=>k.json()).then(k=>{A(k)}).catch(k=>console.error("Failed to load taxonomic order:",k))},[]),S.useEffect(()=>{fetch("/data/species.json").then(k=>k.json()).then(k=>{const U={},R={};k.forEach(E=>{U[E.species_code]=E.scientific_name,R[E.species_code]=E.common_name}),b(U),N(R)}).catch(k=>console.error("Failed to load species metadata:",k))},[]),S.useEffect(()=>{const k=["starter_birds","expanded_backyard","sparrows","woodpeckers","spring_warblers","western_birds"];Promise.all(k.map(U=>fetch(`/data/packs/${U}.json`).then(R=>R.json()).catch(R=>(console.error(`Failed to load pack ${U}:`,R),null)))).then(U=>{const R={};U.forEach((E,F)=>{E&&E.species&&(R[k[F]]=E.display_species||E.species)}),o(E=>({...E,...R}))})},[]);const D=k=>{const R=(s[k]||[]).map(E=>{const F=n.filter(B=>B.species_code===E&&!B.rejected&&(!B.spectrogram_path||!B.spectrogram_path.includes("spectrograms-rejected"))),q=F.find(B=>B.canonical)||F[0],J=F.sort((B,Y)=>B.canonical&&!Y.canonical?-1:!B.canonical&&Y.canonical?1:B.clip_id.localeCompare(Y.clip_id)).map(B=>({id:B.clip_id,path:`/data/clips/${B.file_path.split("/").pop()}`,isCanonical:!!B.canonical,vocalizationType:B.vocalization_type,source:B.source,sourceId:B.source_id,sourceUrl:B.source_url,recordist:B.recordist}));return{code:E,name:I[E]||E,canonicalClipPath:q?`/data/clips/${q.file_path.split("/").pop()}`:null,clipCount:F.length,allClips:J}});return k==="all_birds"&&y&&Object.keys(T).length>0?R.sort((E,F)=>{const j=T[E.code]||9999,q=T[F.code]||9999;return j-q}):R.sort((E,F)=>E.code.localeCompare(F.code))},P=k=>{k.isUnlocked&&(UE(k.id,k.name),t(`/level-select?pack=${k.id}`))},O=(k,U)=>{if(L.current&&(L.current.pause(),L.current=null),a===U){c(null);return}const R=new Audio(k);L.current=R,c(U),R.play().catch(E=>console.error("Failed to play audio:",E)),R.onended=()=>{c(null),L.current=null}};return S.useEffect(()=>()=>{L.current&&L.current.pause()},[]),S.useEffect(()=>{const k=r.get("expand")||r.get("expandPack");k&&f(new Set([k])),window.location.hash&&setTimeout(()=>{const U=document.querySelector(window.location.hash);U&&U.scrollIntoView({behavior:"smooth",block:"start"})},100)},[r]),l.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/"),"aria-label":"Home",children:l.jsx(KE,{})}),l.jsx("h2",{style:{margin:0},children:"Select a Bird Pack"})]}),l.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"20px",lineHeight:1.6,background:"rgba(70, 70, 90, 0.5)",padding:"16px",borderRadius:"12px"},children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[l.jsx("li",{style:{fontWeight:600},children:"Use  (or not), but do UNmute "}),l.jsx("li",{children:"6 levels/packstart @ #1,  sparrow"}),l.jsxs("li",{children:["Try training mode ()"," ",l.jsx(ua,{to:"/help#training-mode",state:{fromPackSelect:!0},style:{color:"var(--color-accent)"},children:"Help "})]}),l.jsxs("li",{children:["Timer anxiety? Continuous Play"," ",l.jsx(ua,{to:"/settings",state:{fromPackSelect:!0},style:{color:"var(--color-accent)"},children:" "})]})]})}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"32px"},children:$u.map(k=>{const U={starter_birds:"linear-gradient(135deg, #2d5a3d 0%, #1a3d2a 100%)",expanded_backyard:"linear-gradient(135deg, #3d5a6e 0%, #2a3d4a 100%)",sparrows:"linear-gradient(135deg, #6b5344 0%, #4a3a2e 100%)",woodpeckers:"linear-gradient(135deg, #6e3d3d 0%, #4a2a2a 100%)",spring_warblers:"linear-gradient(135deg, #7a6b2d 0%, #5a4a1a 100%)",western_birds:"linear-gradient(135deg, #5a4a7a 0%, #3a2a5a 100%)"},R={starter_birds:"NOCA",expanded_backyard:"AMGO",sparrows:"WTSP",woodpeckers:"PIWO",spring_warblers:"BLBW",western_birds:"STJA"};return l.jsxs("button",{onClick:()=>P(k),style:{position:"relative",overflow:"hidden",textAlign:"left",padding:"12px 12px 14px 12px",borderRadius:"16px",border:"none",background:U[k.id]||U.starter_birds,boxShadow:k.isUnlocked?"0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"none",opacity:k.isUnlocked?1:.5,cursor:k.isUnlocked?"pointer":"not-allowed",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:E=>{k.isUnlocked&&(E.currentTarget.style.transform="translateY(-2px)",E.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1)")},onMouseLeave:E=>{E.currentTarget.style.transform="translateY(0)",E.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[l.jsx("img",{src:`/data/icons/${R[k.id]}.png`,alt:"",style:{position:"absolute",right:"-10px",bottom:"-10px",width:"80px",height:"80px",opacity:.3,transform:"rotate(-15deg)",objectFit:"cover"}}),k.isUnlocked&&l.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:2},children:l.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#a8d5a2",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Play ",l.jsx(qE,{})]})}),l.jsxs("div",{style:{position:"relative",zIndex:1},children:[l.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#f5f0e6",lineHeight:1.3,marginBottom:"6px",paddingRight:"50px"},children:k.name}),l.jsx("div",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.6)",lineHeight:1.4,marginBottom:"10px"},children:k.description}),l.jsx("div",{children:l.jsxs("span",{style:{fontSize:"12px",color:"rgba(245, 240, 230, 0.7)",fontWeight:500},children:[k.speciesCount," species"]})})]})]},k.id)})}),l.jsxs("div",{onClick:()=>t("/custom-pack"),style:{marginBottom:"32px",background:"var(--color-surface)",border:"2px solid var(--color-accent)",borderRadius:"16px",padding:"20px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:k=>{k.currentTarget.style.background="rgba(45, 90, 39, 0.15)",k.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:k=>{k.currentTarget.style.background="var(--color-surface)",k.currentTarget.style.transform="translateY(0)"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[l.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"var(--color-accent)",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:l.jsx(JE,{})}),l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)"},children:"Create Custom Pack"}),l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:"Build your own training session"})]})]}),l.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6},children:[l.jsxs("div",{style:{marginBottom:"8px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Got a nemesis bird? Add it and drill all its variations."]}),l.jsxs("div",{style:{marginBottom:v?"8px":"12px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," A friend's eBird checklist has you jealous? Build their list and practice like you were there."]}),v&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{marginBottom:"8px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Constantly confuse Kinglets, Creepers and Waxwings? Put them head-to-head."]}),l.jsxs("div",{style:{marginBottom:"8px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Warbler Wizard Wannabe? Training starts here!"]}),l.jsxs("div",{style:{marginBottom:"8px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," You think you know your woodpeckers? Try the Pileated vs. Northern Flicker on Level 5."]}),l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Mix species from any pack  your rules, your practice."]})]}),l.jsx("button",{onClick:k=>{k.stopPropagation(),_(!v)},style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",cursor:"pointer",padding:"4px 0",textDecoration:"underline",display:"flex",alignItems:"center",gap:"4px"},children:v?" Show less":"More examples "})]})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",marginTop:"24px",marginBottom:"16px",opacity:.5},children:[l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",textAlign:"center"},children:"Browse all birds below"}),l.jsx("div",{style:{animation:"bounce 2s ease-in-out infinite"},children:l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-text-muted)",strokeWidth:"2",children:l.jsx("path",{d:"M12 5v14M5 12l7 7 7-7"})})})]}),l.jsxs("div",{id:"bird-reference",style:{marginTop:"16px",scrollMarginTop:"20px"},children:[((z=e.state)==null?void 0:z.fromLevelSelect)&&((H=e.state)==null?void 0:H.packId)&&l.jsx("div",{style:{marginBottom:"16px"},children:l.jsxs("button",{onClick:()=>t(`/level-select?pack=${e.state.packId}`),style:{background:"var(--color-accent)",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Level Select",children:[l.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Level Select"]})}),((W=e.state)==null?void 0:W.fromHelp)&&l.jsx("div",{style:{marginBottom:"16px"},children:l.jsxs("button",{onClick:()=>t("/help"),style:{background:"var(--color-accent)",color:"var(--color-background)",border:"none",borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},"aria-label":"Back to Help",children:[l.jsx("span",{style:{fontSize:"18px"},children:""}),"Back to Help"]})}),l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[l.jsx("h3",{style:{fontSize:"16px",margin:0,color:"var(--color-text-muted)"},children:"Bird Reference"}),l.jsx("button",{onClick:()=>{if(p)f(new Set),m(!1);else{const k=$u.filter(U=>U.isUnlocked).map(U=>U.id);f(new Set(k)),m(!0)}},style:{fontSize:"12px",padding:"6px 12px",background:p?"var(--color-accent)":"var(--color-surface)",color:p?"#000":"var(--color-text)",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:600},children:p?"Collapse All":"Expand All"})]}),l.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"20px",paddingLeft:"12px",borderLeft:"3px solid var(--color-accent)"},children:"Preview signature sounds for each bird before you play. Click pack names to expand and see all birds, or click individual birds to explore their full library of recordings."}),s.all_birds&&(()=>{var R;const k="all_birds",U=p||h.has(k);return l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("div",{onClick:()=>{const E=new Set(h);E.has(k)?E.delete(k):E.add(k),f(E)},style:{fontSize:"14px",marginBottom:U?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:E=>E.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:E=>E.currentTarget.style.background="var(--color-surface)",children:[l.jsx("span",{style:{fontSize:"14px"},children:U?"":""}),l.jsx("span",{style:{fontWeight:600},children:"All Birds"}),l.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((R=s[k])==null?void 0:R.length)||0," species"]})]}),U&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{marginBottom:"12px",padding:"10px",background:"rgba(70, 70, 90, 0.3)",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",position:"relative"},children:[l.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[l.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"var(--color-text-muted)"},children:"Sort:"}),l.jsx("button",{onClick:()=>{const E=!y;x(E),E&&(w(!0),setTimeout(()=>w(!1),1400))},style:{padding:"6px 12px",fontSize:"12px",fontWeight:600,background:y?"var(--color-accent)":"rgba(255,255,255,0.15)",color:y?"#000":"var(--color-text)",border:y?"none":"1.5px solid var(--color-accent)",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s",boxShadow:y?"0 2px 8px rgba(245, 166, 35, 0.3)":"none"},onMouseEnter:E=>{y||(E.currentTarget.style.background="rgba(255,255,255,0.25)",E.currentTarget.style.transform="scale(1.05)")},onMouseLeave:E=>{y||(E.currentTarget.style.background="rgba(255,255,255,0.15)",E.currentTarget.style.transform="scale(1)")},children:y?" Taxonomic":" A-Z"}),l.jsx("span",{style:{fontSize:"11px",color:"var(--color-text-muted)",flex:"1",minWidth:"180px"},children:y?"Phylogenetic (eBird 2025)":"Species codes"})]}),g&&l.jsx("div",{style:{position:"absolute",top:"15px",left:"70%",transform:"translateX(-50%)",background:"rgba(245, 166, 35, 1.0)",color:"#000",padding:"6px 20px",borderRadius:"16px",fontSize:"13px",fontWeight:600,boxShadow:"0 2px 8px rgba(245, 166, 35, 0.3)",animation:"floatPop 1.4s ease-out forwards",zIndex:1e3,pointerEvents:"none",whiteSpace:"nowrap"},children:" nerd alert!"})]}),l.jsx("style",{children:`
                  @keyframes floatPop {
                    0% {
                      opacity: 0;
                      transform: translateX(-50%) translateY(0) scale(0.8);
                    }
                    15% {
                      opacity: 0.75;
                      transform: translateX(-50%) translateY(-5px) scale(1);
                    }
                    80% {
                      opacity: 0.75;
                      transform: translateX(-50%) translateY(-35px) scale(1);
                    }
                    90% {
                      opacity: 0.5;
                      transform: translateX(-50%) translateY(-40px) scale(1.05);
                    }
                    100% {
                      opacity: 0;
                      transform: translateX(-50%) translateY(-45px) scale(0.6);
                    }
                  }
                `}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:D(k).map(E=>{const F=u===E.code;return l.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:E.clipCount>1?"pointer":"default"},onClick:()=>{E.clipCount>1&&d(F?null:E.code)},children:[l.jsx(kg,{code:E.code,size:36}),l.jsxs("div",{style:{minWidth:0,flex:1},children:[l.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:E.code}),l.jsx("div",{style:{fontSize:"13px",fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:E.name}),y&&C[E.code]&&l.jsx("div",{style:{fontSize:"11px",fontStyle:"italic",color:"var(--color-text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:C[E.code]})]}),E.canonicalClipPath&&l.jsx("button",{onClick:j=>{j.stopPropagation(),O(E.canonicalClipPath,E.code)},style:{width:"32px",height:"32px",borderRadius:"50%",border:"none",background:a===E.code?"var(--color-accent)":"rgba(255,255,255,0.1)",color:a===E.code?"#000":"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px"},children:a===E.code?"":""}),E.clipCount>1&&l.jsx("span",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:F?"":""})]}),F&&E.allClips.length>0&&l.jsxs("div",{style:{padding:"0 12px 12px 12px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[l.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginTop:"8px",marginBottom:"8px",fontWeight:600},children:["All Recordings (",E.allClips.length,")"]}),E.allClips.map((j,q)=>l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",padding:"6px",background:"rgba(0,0,0,0.2)",borderRadius:"6px"},children:[l.jsx("button",{onClick:()=>O(j.path,`${E.code}_${q}`),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===`${E.code}_${q}`?"var(--color-accent)":"rgba(255,255,255,0.1)",color:a===`${E.code}_${q}`?"#000":"var(--color-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",flexShrink:0},children:a===`${E.code}_${q}`?"":""}),l.jsx("div",{style:{flex:1,fontSize:"11px"},children:l.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",flexWrap:"wrap"},children:[j.isCanonical&&l.jsx("span",{style:{fontSize:"9px",background:"var(--color-accent)",color:"#000",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"SIGNATURE"}),l.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:j.vocalizationType==="song"?"rgba(76, 175, 80, 0.2)":"rgba(245, 166, 35, 0.2)",padding:"2px 6px",borderRadius:"4px",textTransform:"uppercase"},children:j.vocalizationType}),(j.source||j.recordist)&&l.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:j.sourceUrl?l.jsxs("a",{href:j.sourceUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit",textDecoration:"none"},children:[j.sourceId,j.recordist?`  ${j.recordist}`:""]}):l.jsxs(l.Fragment,{children:[j.source==="macaulay"?j.sourceId||"Cornell":j.source==="user_recording"?j.recordist||"User":j.sourceId||j.source,j.source!=="user_recording"&&j.recordist&&!j.sourceId&&`  ${j.recordist}`]})})]})})]},j.id))]})]},E.code)})})]})]},k)})(),$u.filter(k=>k.isUnlocked).map(k=>{var R,E,F;const U=p||h.has(k.id);return l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("div",{onClick:()=>{const j=new Set(h);j.has(k.id)?j.delete(k.id):j.add(k.id),f(j)},style:{fontSize:"14px",marginBottom:U?"12px":"0",color:"var(--color-accent)",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px",transition:"background 0.15s"},onMouseEnter:j=>j.currentTarget.style.background="rgba(45, 45, 68, 1)",onMouseLeave:j=>j.currentTarget.style.background="var(--color-surface)",children:[l.jsx("span",{style:{fontSize:"14px"},children:U?"":""}),l.jsx("span",{style:{fontWeight:600},children:k.name}),l.jsxs("span",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginLeft:"auto"},children:[((R=s[k.id])==null?void 0:R.length)||0," species"]})]}),U&&((E=e.state)==null?void 0:E.fromPreview)&&((F=e.state)==null?void 0:F.pack)===k.id&&l.jsx("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"flex-end"},children:l.jsx("button",{onClick:()=>{const{pack:j,level:q}=e.state;t(`/preview?pack=${j}&level=${q}`)},style:{padding:"10px 16px",fontSize:"14px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 4px 12px rgba(45, 90, 39, 0.4)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:j=>{j.currentTarget.style.transform="scale(1.05)",j.currentTarget.style.boxShadow="0 6px 16px rgba(45, 90, 39, 0.5)"},onMouseLeave:j=>{j.currentTarget.style.transform="scale(1)",j.currentTarget.style.boxShadow="0 4px 12px rgba(45, 90, 39, 0.4)"},children:"Ready to Play?"})}),U&&l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:D(k.id).map(j=>{const q=u===j.code;return l.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"8px",overflow:"hidden"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",cursor:j.clipCount>1?"pointer":"default"},onClick:()=>{j.clipCount>1&&d(q?null:j.code)},children:[l.jsx(kg,{code:j.code,size:36}),l.jsxs("div",{style:{minWidth:0,flex:1},children:[l.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"var(--color-accent)"},children:j.code}),l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:j.name}),l.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)"},children:[j.clipCount," clip",j.clipCount!==1?"s":"",j.clipCount>1&&l.jsx("span",{style:{marginLeft:"4px",color:"var(--color-accent)"},children:q?"":""})]})]}),l.jsx("button",{onClick:J=>{J.stopPropagation(),j.canonicalClipPath&&O(j.canonicalClipPath,j.code)},disabled:!j.canonicalClipPath,style:{width:"28px",height:"28px",borderRadius:"50%",border:"none",background:a===j.code?"var(--color-accent)":"var(--color-primary)",color:"white",cursor:j.canonicalClipPath?"pointer":"not-allowed",opacity:j.canonicalClipPath?1:.3,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play ${j.name}`,children:a===j.code?l.jsx(Cg,{}):l.jsx(Ag,{})})]}),q&&j.allClips.length>0&&l.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"8px 12px",background:"rgba(0,0,0,0.2)"},children:[l.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"8px"},children:["All ",j.clipCount," clips:"]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:j.allClips.map((J,B)=>l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("button",{onClick:()=>O(J.path,J.id),style:{width:"24px",height:"24px",borderRadius:"50%",border:"none",background:a===J.id?"var(--color-accent)":"rgba(255,255,255,0.15)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},"aria-label":`Play clip ${B+1}`,children:a===J.id?l.jsx(Cg,{size:8}):l.jsx(Ag,{size:8})}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px",flex:1},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[l.jsx("span",{style:{fontSize:"11px",color:"var(--color-text)"},children:J.sourceId||`Clip ${B+1}`}),J.isCanonical&&l.jsx("span",{style:{fontSize:"9px",color:"#000",background:"var(--color-accent)",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:" SIGNATURE"}),J.vocalizationType&&l.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px",textTransform:"capitalize"},children:J.vocalizationType}),(J.source||J.recordist)&&l.jsx("span",{style:{fontSize:"9px",color:"var(--color-text-muted)",background:"rgba(255,255,255,0.1)",padding:"2px 6px",borderRadius:"4px"},children:J.sourceUrl?l.jsxs("a",{href:J.sourceUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit",textDecoration:"none"},children:[J.sourceId,J.recordist?`  ${J.recordist}`:""]}):l.jsxs(l.Fragment,{children:[J.source==="macaulay"?J.sourceId||"Cornell":J.source==="user_recording"?J.recordist||"User":J.sourceId||J.source,J.source!=="user_recording"&&J.recordist&&!J.sourceId&&`  ${J.recordist}`]})})]})})]},J.id))})]})]},j.code)})})]},k.id)})]})]})}function KE(){return l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),l.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function Ag({size:t=14}){return l.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M8 5v14l11-7z"})})}function Cg({size:t=12}){return l.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function qE(){return l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:l.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}function JE(){return l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:l.jsx("path",{d:"M12 5v14M5 12h14"})})}function QE({size:t=80}){return l.jsx("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"currentColor",children:l.jsx("path",{d:"M85 35c-5-3-12-2-18 1-3-8-10-14-19-16 2-3 3-7 2-11-1-5-5-8-9-7s-7 5-6 10c0 2 1 4 2 5-10 3-18 11-21 21-8-1-16 2-21 8-2 2-1 5 1 6s5 0 7-2c3-4 8-5 13-4 0 12 7 23 18 28l-8 12c-2 2-1 5 1 7 2 1 5 1 6-2l10-14c3 1 6 1 9 1 4 0 7-1 10-2l10 14c2 2 5 3 7 1s2-5 0-7l-8-12c11-5 18-16 18-28 5-1 10 0 13 4 2 2 5 3 7 2s3-4 1-6c-5-6-13-9-21-8z"})})}function kg({code:t,size:e=36}){const[r,n]=S.useState(!0),i=`/data/icons/${t}.png`;return r?l.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",flexShrink:0},onError:()=>n(!1)}):l.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-primary)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.4,flexShrink:0},children:l.jsx(QE,{size:e*.7})})}const ZE={starter_birds:"Eastern Backyard Birds",expanded_backyard:"Expanded Eastern US Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard Birds",custom:"Custom Pack"};function eT(t){return[{level_id:1,pack_id:"custom",mode:"campaign",title:"Meet Your Birds",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:2,pack_id:"custom",mode:"campaign",title:"Sound Variations",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:3,pack_id:"custom",mode:"campaign",title:"Full Repertoire",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"single",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:4,pack_id:"custom",mode:"campaign",title:"Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"canonical",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:5,pack_id:"custom",mode:"campaign",title:"Variations + Both Ears",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:3,channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},{level_id:6,pack_id:"custom",mode:"campaign",title:"Master Birder",round_duration_sec:30,species_count:t,species_pool:[],clip_selection:"all",channel_mode:"offset",event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"}]}function tT(t){const e=[];return t.clip_selection==="canonical"?e.push("Signature sounds only"):t.clip_selection==="all"?e.push("Full repertoire"):typeof t.clip_selection=="number"&&e.push(`${t.clip_selection} variations per bird`),t.channel_mode==="offset"?e.push("both ears"):e.push("one ear"),e.join("  ")}function rT(t){const e=t.level_id;return e<=2?{label:"Easy",color:"#4CAF50"}:e<=4?{label:"Medium",color:"#FFC107"}:{label:"Hard",color:"#FF5722"}}function nT(){const t=qt(),[e]=qc(),r=e.get("pack")||"starter_birds",[n,i]=S.useState([]),[s,o]=S.useState(!0);S.useEffect(()=>{if(r==="custom"){try{const u=localStorage.getItem("soundfield_custom_pack");if(u){const d=JSON.parse(u);if(Array.isArray(d)&&d.length>0){i(eT(d.length)),o(!1);return}}t("/custom-pack",{replace:!0})}catch(u){console.error("Failed to load custom pack:",u),t("/custom-pack",{replace:!0})}return}fetch("/data/levels.json").then(u=>u.json()).then(u=>{const d=u.filter(h=>h.pack_id===r);i(d.sort((h,f)=>h.level_id-f.level_id)),o(!1)}).catch(u=>{console.error("Failed to load levels:",u),o(!1)})},[r,t]);const a=u=>{$E(r,u.level_id,u.title||`Level ${u.level_id}`),t(`/preview?pack=${r}&level=${u.level_id}`)},c=ZE[r]||r;return l.jsxs("div",{className:"screen",style:{paddingBottom:"24px"},children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"8px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t(r==="custom"?"/custom-pack":"/pack-select"),"aria-label":"Back",children:l.jsx(iT,{})}),l.jsxs("div",{style:{flex:1},children:[l.jsx("h2",{style:{margin:0,fontSize:"20px"},children:c}),l.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[l.jsx("span",{children:"Select a level"}),r!=="custom"&&l.jsxs(l.Fragment,{children:[l.jsx("span",{style:{color:"var(--color-surface)"},children:""}),l.jsx(ua,{to:`/pack-select?expand=${r}#bird-reference`,state:{fromLevelSelect:!0,packId:r},style:{color:"var(--color-accent)",textDecoration:"none",fontSize:"12px"},children:"Bird Reference"})]})]})]})]}),s?l.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--color-text-muted)"},children:"Loading levels..."}):l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:n.map(u=>{const d=rT(u);return l.jsxs("button",{onClick:()=>a(u),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"var(--color-surface)",border:"none",borderRadius:"12px",cursor:"pointer",textAlign:"left",transition:"transform 0.15s, background 0.15s"},onMouseEnter:h=>{h.currentTarget.style.transform="translateX(4px)",h.currentTarget.style.background="rgba(45, 45, 68, 1)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateX(0)",h.currentTarget.style.background="var(--color-surface)"},children:[l.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:`linear-gradient(135deg, ${d.color}33, ${d.color}11)`,border:`2px solid ${d.color}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"20px",color:d.color,flexShrink:0},children:u.level_id}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:u.title}),l.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:tT(u)})]}),l.jsx("div",{style:{color:"var(--color-text-muted)",flexShrink:0},children:l.jsx(sT,{})})]},u.level_id)})}),l.jsx("div",{style:{marginTop:"24px",padding:"12px 16px",background:"rgba(245, 166, 35, 0.1)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:l.jsxs("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.5},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"Tip:"})," Start with Level 1 to learn each bird's signature sound, then progress to variations and both-ear challenges."]})})]})}function iT(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function sT(){return l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M9 18l6-6-6-6"})})}const Xi=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE"],oT={starter_birds:"Eastern Backyard Birds",expanded_backyard:"Expanded Eastern US Birds",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard Birds",custom:"Custom Pack"},aT={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function lT(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function cT(t){return t>=4?"offset":"single"}function uT({code:t,size:e=56,color:r}){const[n,i]=S.useState(!0),s=`/data/icons/${t}.png`;return l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",WebkitTapHighlightColor:"transparent"},children:[n&&l.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?l.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover",WebkitTapHighlightColor:"transparent"},onError:()=>i(!1)}):l.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"var(--color-surface)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.25,fontWeight:700,color:"#1A1A2E"},children:t})]})}function dT(){const t=qt(),[e]=qc(),r=e.get("pack")||"starter_birds",n=parseInt(e.get("level")||"1",10),i=e.get("keepBirds")==="true",[s,o]=S.useState(null),[a,c]=S.useState([]),[u,d]=S.useState([]),[h,f]=S.useState(null),[p,m]=S.useState(!0),[v,_]=S.useState("idle"),[y,x]=S.useState({loaded:0,total:0}),[g,w]=S.useState(()=>{try{return localStorage.getItem("soundfield_training_mode")==="true"}catch{return!1}}),[T,A]=S.useState(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}}),[C,b]=S.useState({}),[I,N]=S.useState({}),[L,D]=S.useState({}),[P,O]=S.useState([]),z=S.useRef(null),H=()=>{const B=!g;w(B);try{localStorage.setItem("soundfield_training_mode",String(B))}catch(Y){console.error("Failed to save training mode:",Y)}},W=()=>{const B=!T;A(B);try{localStorage.setItem("soundfield_taxonomic_sort",String(B)),t_(B,"preview_screen")}catch(Y){console.error("Failed to save taxonomic sort:",Y)}};S.useEffect(()=>{if(u.length===0||Object.keys(C).length===0)return;const B=u.map(te=>te.code),ge=(T?[...B].sort((te,fe)=>{const M=C[te]||9999,K=C[fe]||9999;return M-K}):[...B].sort()).map((te,fe)=>({...u.find(K=>K.code===te),color:Xi[fe%Xi.length]}));ge.some((te,fe)=>te.code!==u[fe].code)&&d(ge)},[T,C]),S.useEffect(()=>{Promise.all([fetch("/data/taxonomic_order.json").then(B=>B.json()),fetch("/data/species.json").then(B=>B.json())]).then(([B,Y])=>{b(B);const ge={},pe={};Y.forEach(te=>{ge[te.species_code]=te.scientific_name,pe[te.species_code]=te.common_name}),N(ge),D(pe)}).catch(B=>console.error("Failed to load taxonomy data:",B))},[]);const k=S.useCallback((B,Y)=>[...B].sort().map((pe,te)=>{const fe=Y.find(ne=>ne.species_code===pe&&ne.canonical&&!ne.rejected),M=Y.find(ne=>ne.species_code===pe&&!ne.rejected),K=fe||M;return{code:pe,name:L[pe]||pe,scientificName:I[pe],color:Xi[te%Xi.length],clipPath:K?`/data/clips/${K.file_path.split("/").pop()}`:null}}),[L,I]),U=S.useCallback((B,Y)=>{const ge=Math.min(9,B.length),te=[...B].sort(()=>Math.random()-.5).slice(0,ge);d(k(te,Y))},[k]),R=S.useCallback((B,Y)=>{const ge=B.species_pool||[],pe=B.species_count||ge.length,K=[...ge].sort(()=>Math.random()-.5).slice(0,pe).sort().map((ne,ue)=>{const ke=Y.find(Me=>Me.species_code===ne&&Me.canonical&&!Me.rejected),Le=Y.find(Me=>Me.species_code===ne&&!Me.rejected),et=ke||Le;return{code:ne,name:L[ne]||ne,scientificName:I[ne],color:Xi[ue%Xi.length],clipPath:et?`/data/clips/${et.file_path.split("/").pop()}`:null}});d(K)},[L,I]);S.useEffect(()=>{Promise.all([fetch("/data/levels.json").then(B=>B.json()),fetch("/data/clips.json").then(B=>B.json())]).then(([B,Y])=>{if(c(Y),r==="custom"){const pe=localStorage.getItem("soundfield_custom_pack");if(pe)try{const te=JSON.parse(pe);O(te);const fe=te.length>9?[...te].sort(()=>Math.random()-.5).slice(0,9):te,M={level_id:n,pack_id:"custom",mode:"campaign",title:aT[n]||`Level ${n}`,round_duration_sec:30,species_count:fe.length,species_pool:fe,clip_selection:lT(n),channel_mode:cT(n),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"};o(M),d(k(fe,Y))}catch(te){console.error("Failed to parse custom pack:",te)}m(!1);return}const ge=B.find(pe=>pe.pack_id===r&&pe.level_id===n);if(ge){if(o(ge),i){const pe=sessionStorage.getItem("roundSpecies");if(pe)try{const te=JSON.parse(pe),fe=ge.species_pool||[],M=te.filter(K=>fe.includes(K));if(M.length===te.length){d(k(M,Y)),m(!1);return}}catch(te){console.error("Failed to parse saved species:",te)}}R(ge,Y)}m(!1)}).catch(B=>{console.error("Failed to load data:",B),m(!1)})},[r,n,i,k,R]),S.useEffect(()=>{if(u.length===0||a.length===0){_("idle");return}const B=u.map(te=>te.code),Y=a.filter(te=>B.includes(te.species_code)&&!te.rejected);if(Y.length===0){_("ready"),x({loaded:0,total:0});return}_("loading"),x({loaded:0,total:Y.length}),console.log(`Preloading ${Y.length} clips for ${B.length} species...`);let ge=0;const pe=Y.map(async te=>{const fe=`/${te.file_path}`;try{const M=await fetch(fe);M.ok&&await M.arrayBuffer()}catch(M){console.warn("Failed to preload:",te.file_path,M)}finally{ge++,x({loaded:ge,total:Y.length})}});Promise.all(pe).then(()=>{console.log("Preloading complete!"),_("ready")})},[u,a]);const E=()=>{s&&a.length>0&&(z.current&&(z.current.pause(),z.current=null,f(null)),_("idle"),R(s,a))},F=()=>{P.length>0&&a.length>0&&(z.current&&(z.current.pause(),z.current=null,f(null)),_("idle"),U(P,a))},j=B=>{if(console.log(`[Preview] Attempting to play: ${B.code}`),console.log(`[Preview] Clip path: ${B.clipPath}`),z.current&&(z.current.pause(),z.current=null),h===B.code){f(null);return}if(!B.clipPath){console.error(`[Preview] No clip path for ${B.code}!`);return}const Y=new Audio(B.clipPath);z.current=Y,f(B.code),Y.play().then(()=>console.log(`[Preview] Playing ${B.code} successfully`)).catch(ge=>{console.error(`[Preview] Failed to play ${B.code}:`,ge),console.error(`[Preview] Clip path was: ${B.clipPath}`)}),Y.onended=()=>{console.log(`[Preview] ${B.code} finished playing`),f(null),z.current=null}},q=()=>{z.current&&z.current.pause();const B=u.map(Y=>Y.code);sessionStorage.setItem("roundSpecies",JSON.stringify(B)),t(`/gameplay?mode=campaign&pack=${r}&level=${n}&preview=true`)};if(S.useEffect(()=>()=>{z.current&&z.current.pause()},[]),p)return l.jsx("div",{className:"screen screen-center",children:l.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading..."})});if(!s)return l.jsxs("div",{className:"screen screen-center",children:[l.jsx("div",{style:{color:"var(--color-error)"},children:"Level not found"}),l.jsx("button",{onClick:()=>t(-1),style:{marginTop:"16px",padding:"8px 16px",background:"var(--color-surface)",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"Go Back"})]});const J=oT[r]||r;return l.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",paddingTop:"calc(12px + var(--safe-area-top))",paddingBottom:"calc(12px + var(--safe-area-bottom))",paddingLeft:"16px",paddingRight:"16px",gap:"10px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t(`/level-select?pack=${r}`),"aria-label":"Back",style:{flexShrink:0},children:l.jsx(hT,{})}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"14px",lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:J}),l.jsxs("div",{style:{fontSize:"12px",color:"var(--color-accent)",lineHeight:1.1},children:["Level ",s.level_id,": ",s.title]})]}),l.jsx("button",{onClick:()=>t(`/pack-select?scrollTo=${r}&expandPack=${r}#bird-reference`,{state:{fromPreview:!0,pack:r,level:n}}),style:{padding:"6px 10px",background:"transparent",border:"1px solid rgba(100, 181, 246, 0.3)",borderRadius:"6px",color:"#64B5F6",fontSize:"15px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",flexShrink:0,whiteSpace:"nowrap"},children:""}),(s.species_pool&&s.species_pool.length>(s.species_count||0)||P.length>9)&&l.jsx("button",{onClick:P.length>9?F:E,style:{padding:"6px 10px",background:"transparent",border:"1px solid var(--color-accent)",borderRadius:"6px",color:"var(--color-accent)",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",flexShrink:0},title:P.length>9?`Re-roll (${P.length} total birds)`:"Shuffle birds",children:l.jsx(fT,{})})]}),l.jsxs("div",{style:{display:"flex",gap:"6px",fontSize:"12px"},children:[l.jsxs("button",{onClick:H,style:{flex:1,padding:"6px 8px",background:g?"rgba(76, 175, 80, 0.25)":"rgba(255, 255, 255, 0.05)",border:g?"2px solid var(--color-success)":"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[l.jsx(pT,{filled:g,color:g?"var(--color-success)":void 0}),l.jsx("span",{style:{fontSize:"11px"},children:"Training"})]}),l.jsxs("button",{onClick:W,style:{flex:1,padding:"6px 8px",background:T?"rgba(100, 181, 246, 0.25)":"rgba(255, 255, 255, 0.05)",border:T?"2px solid #64B5F6":"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[l.jsx("span",{style:{fontSize:"14px"},children:T?"":""}),l.jsx("span",{style:{fontSize:"11px"},children:T?"Taxonomic ":"Sort"})]})]}),v==="loading"&&l.jsxs("div",{style:{background:"var(--color-surface)",borderRadius:"6px",padding:"6px 10px"},children:[l.jsxs("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginBottom:"4px"},children:["Loading sounds ",y.loaded,"/",y.total]}),l.jsx("div",{style:{width:"100%",height:"3px",background:"rgba(0,0,0,0.2)",borderRadius:"2px",overflow:"hidden"},children:l.jsx("div",{style:{width:`${y.loaded/y.total*100}%`,height:"100%",background:"var(--color-accent)",transition:"width 0.2s ease"}})})]}),l.jsx("div",{style:{background:"rgba(100, 181, 246, 0.1)",border:"1px solid rgba(100, 181, 246, 0.3)",borderRadius:"8px",padding:"10px 12px"},children:l.jsxs("div",{style:{fontSize:"12px",color:"var(--color-text)",lineHeight:1.4,textAlign:"center"},children:[l.jsx("strong",{children:" Study the grid:"})," Each bird will appear in the same position during play. Take a moment to memorize where each species lives on screenand any unfamiliar code names. Use  to mix it up. Engage  for speed-learning."]})}),l.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:0},children:[P.length>9&&l.jsxs("div",{style:{fontSize:"12px",color:"var(--color-accent)",marginBottom:"6px",textAlign:"center",fontWeight:600},children:["Playing 9 of ",P.length," birds"]}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Tap to preview signature song. Press and hold to get a closer look!"}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px",maxWidth:"320px",width:"100%"},children:u.map(B=>l.jsxs("button",{onClick:()=>j(B),disabled:!B.clipPath,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px",padding:"10px 6px",background:h===B.code?`${B.color}33`:"var(--color-surface)",border:`2px solid ${B.color}`,borderRadius:"10px",cursor:B.clipPath?"pointer":"not-allowed",opacity:B.clipPath?1:.5,transition:"transform 0.15s, background 0.15s",WebkitTapHighlightColor:"transparent"},children:[l.jsx("div",{style:{position:"relative",WebkitTapHighlightColor:"transparent"},children:l.jsx(uT,{code:B.code,size:52,color:B.color})}),l.jsx("div",{style:{fontSize:"10px",color:"var(--color-text)",textAlign:"center",lineHeight:1.2,maxWidth:"75px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontStyle:T&&B.scientificName?"italic":"normal"},children:T&&B.scientificName?B.scientificName:B.name})]},B.code))})]}),l.jsx("button",{onClick:q,style:{width:"100%",padding:"12px",fontSize:"15px",fontWeight:700,background:v==="ready"?"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)":"linear-gradient(135deg, #555 0%, #444 100%)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 3px 10px rgba(45, 90, 39, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:v==="ready"?l.jsxs(l.Fragment,{children:["Ready to Play ",l.jsx(Pg,{})]}):v==="loading"?l.jsx(l.Fragment,{children:"Loading..."}):l.jsxs(l.Fragment,{children:["Ready to Play ",l.jsx(Pg,{})]})}),l.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.7; }
        }
        * {
          -webkit-tap-highlight-color: transparent;
        }
      `})]})}function hT(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function fT(){return l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M16 3h5v5"}),l.jsx("path",{d:"M4 20L21 3"}),l.jsx("path",{d:"M21 16v5h-5"}),l.jsx("path",{d:"M15 15l6 6"}),l.jsx("path",{d:"M4 4l5 5"})]})}function Pg(){return l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M8 5v14l11-7z"})})}function pT({filled:t,color:e}){const r=e||(t?"var(--color-accent)":"var(--color-text-muted)");return l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3",fill:t?r:"none"})]})}const uo=30,Vu="soundfield_custom_pack",Yi="soundfield_saved_packs",ho=10,Rg=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F","#90A4AE","#F06292","#64B5F6","#AED581","#FFB74D","#9575CD","#FF7043","#4DD0E1","#DCE775","#C5A880","#EF5350","#42A5F5","#66BB6A","#FFA726","#AB47BC","#FF6F00","#26C6DA","#D4E157","#8D6E63","#EC407A","#29B6F6","#9CCC65"];function mT(){var fe;const t=qt(),[e,r]=S.useState([]),[n,i]=S.useState([]),[s,o]=S.useState(""),[a,c]=S.useState(null),[u,d]=S.useState(!0),h=S.useRef(null),f=S.useRef(null),p=S.useRef(!1),[m,v]=S.useState(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}}),[_,y]=S.useState({}),[x,g]=S.useState([]),[w,T]=S.useState(!1),[A,C]=S.useState(""),[b,I]=S.useState(!1),[N,L]=S.useState(!1),[D,P]=S.useState(null),[O,z]=S.useState(null),[H,W]=S.useState("");S.useEffect(()=>{Promise.all([fetch("/data/clips.json").then(M=>M.json()),fetch("/data/taxonomic_order.json").then(M=>M.json()),fetch("/data/species.json").then(M=>M.json())]).then(([M,K,ne])=>{const ue={},ke={};for(const Me of ne)ue[Me.species_code]=Me.scientific_name,ke[Me.species_code]=Me.common_name;const Le=new Map;for(const Me of M)if(!Me.rejected&&!Le.has(Me.species_code)){const zi=M.find(Er=>Er.species_code===Me.species_code&&Er.canonical&&!Er.rejected)||M.find(Er=>Er.species_code===Me.species_code&&!Er.rejected)||Me,Gi=ke[Me.species_code];if(!Gi){console.warn(`Skipping ${Me.species_code} - not found in species.json`);continue}Le.set(Me.species_code,{code:Me.species_code,name:Gi,clipPath:`/data/clips/${zi.file_path.split("/").pop()}`,scientificName:ue[Me.species_code]})}const et=Array.from(Le.values()).sort((Me,pn)=>(Me.name||Me.code).localeCompare(pn.name||pn.code));r(et),y(K),d(!1)}).catch(M=>{console.error("Failed to load data:",M),d(!1)});try{const M=localStorage.getItem(Vu);if(M){const K=JSON.parse(M);Array.isArray(K)&&K.length>0&&i(K)}}catch(M){console.error("Failed to load saved pack:",M)}try{const M=localStorage.getItem(Yi);if(M){const K=JSON.parse(M);Array.isArray(K)&&g(K)}}catch(M){console.error("Failed to load saved packs:",M)}},[]),S.useEffect(()=>{if(e.length===0||x.length===0||p.current)return;p.current=!0;const M=new Set(e.map(ue=>ue.code));let K=!1;const ne=x.map(ue=>{ue.version||(ue.version=1,K=!0);const ke=ue.species.filter(Le=>M.has(Le));return ke.length!==ue.species.length?(K=!0,{...ue,species:ke}):ue});if(K){g(ne);try{localStorage.setItem(Yi,JSON.stringify(ne)),console.log("Auto-cleaned saved packs: removed invalid species codes")}catch(ue){console.error("Failed to auto-clean saved packs:",ue)}}},[e,x]);const k=S.useCallback((M,K)=>{i(ne=>{const ue=ne.includes(M),ke=ne.length>=uo;return ue?ne.filter(Le=>Le!==M):ke?ne:(K===1&&o(""),setTimeout(()=>{var Le;(Le=f.current)==null||Le.focus()},0),[...ne,M])})},[]),U=(M,K)=>{if(K.stopPropagation(),h.current&&(h.current.pause(),h.current=null),a===M.code){c(null);return}if(!M.clipPath)return;const ne=new Audio(M.clipPath);h.current=ne,c(M.code),ne.play().catch(ue=>console.error("Failed to play:",ue)),ne.onended=()=>{c(null),h.current=null}},R=()=>{n.length!==0&&(localStorage.setItem(Vu,JSON.stringify(n)),VE(n.length),t("/level-select?pack=custom"))},E=()=>{i([]),z(null),W("");try{localStorage.removeItem(Vu)}catch(M){console.error("Failed to clear custom pack from localStorage:",M)}},F=()=>{o(""),setTimeout(()=>{var M;(M=f.current)==null||M.focus()},0)},j=()=>{const M=!m;v(M);try{localStorage.setItem("soundfield_taxonomic_sort",String(M)),t_(M,"custom_pack_builder")}catch(K){console.error("Failed to save taxonomic sort:",K)}},q=()=>{if(n.length===0){alert("Please select at least one bird before saving.");return}if(O){if(confirm(`You're editing "${H}".

Click OK to update "${H}"
Click Cancel to save as a new pack`))J();else{if(x.length>=ho){alert(`You can only save up to ${ho} packs. Please delete one first.`);return}z(null),W(""),T(!0)}return}if(x.length>=ho){alert(`You can only save up to ${ho} packs. Please delete one first.`);return}T(!0)},J=()=>{if(!O)return;const M=x.map(K=>K.id===O?{...K,species:[...n],lastModified:new Date().toISOString()}:K);g(M);try{localStorage.setItem(Yi,JSON.stringify(M)),alert(` "${H}" updated successfully!`),Tg(H,n.length)}catch(K){console.error("Failed to update pack:",K),alert("Failed to update pack. Storage may be full.")}},B=()=>{const M=A.trim();if(!M){alert("Please enter a name for your pack.");return}const K={id:Date.now().toString(),name:M,species:[...n],created:new Date().toISOString(),version:1},ne=[...x,K];g(ne);try{localStorage.setItem(Yi,JSON.stringify(ne)),Tg(M,n.length)}catch(ue){console.error("Failed to save pack:",ue),alert("Failed to save pack. Storage may be full.")}T(!1),C(""),z(K.id),W(K.name)},Y=M=>{const K=new Set(e.map(ke=>ke.code)),ne=M.species.filter(ke=>K.has(ke)),ue=M.species.length-ne.length;if(ue>0){alert(` ${ue} bird${ue>1?"s":""} in "${M.name}" ${ue>1?"are":"is"} no longer available and ${ue>1?"were":"was"} removed.

This can happen when bird names are updated to match the latest taxonomy.`);const ke={...M,species:ne},Le=x.map(et=>et.id===M.id?ke:et);g(Le);try{localStorage.setItem(Yi,JSON.stringify(Le))}catch(et){console.error("Failed to update pack:",et)}}i(ne),o(""),z(M.id),W(M.name),WE(M.name,ne.length)},ge=M=>{P(M),L(!0)},pe=()=>{var ne;if(!D)return;const M=((ne=x.find(ue=>ue.id===D))==null?void 0:ne.name)||"unknown",K=x.filter(ue=>ue.id!==D);g(K);try{localStorage.setItem(Yi,JSON.stringify(K)),XE(M)}catch(ue){console.error("Failed to update saved packs:",ue)}L(!1),P(null)},te=(()=>{const M=s?e.filter(K=>K.name.toLowerCase().includes(s.toLowerCase())||K.code.toLowerCase().includes(s.toLowerCase())||K.scientificName&&K.scientificName.toLowerCase().includes(s.toLowerCase())):e;return m&&Object.keys(_).length>0?[...M].sort((K,ne)=>{const ue=_[K.code]||9999,ke=_[ne.code]||9999;return ue-ke}):M})();return S.useEffect(()=>()=>{h.current&&h.current.pause()},[]),u?l.jsx("div",{className:"screen screen-center",children:l.jsx("div",{style:{color:"var(--color-text-muted)"},children:"Loading species..."})}):l.jsxs("div",{className:"screen",style:{display:"flex",flexDirection:"column",overflow:"hidden"},children:[l.jsx("div",{style:{flexShrink:0,marginBottom:"12px"},children:l.jsxs("div",{className:"flex-row items-center gap-md",children:[l.jsx("button",{className:"btn-icon",onClick:()=>t("/pack-select"),"aria-label":"Back",children:l.jsx(xT,{})}),l.jsxs("div",{children:[l.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Custom Pack Builder"}),l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:O?l.jsxs("span",{children:["Editing: ",l.jsx("strong",{style:{color:"var(--color-accent)"},children:H})]}):`Select up to ${uo} birds`})]})]})}),x.length>0&&l.jsxs("div",{style:{flexShrink:0,marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[l.jsxs("button",{onClick:()=>I(!b),style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",background:"none",border:"none",color:"var(--color-text)",cursor:"pointer",padding:0},children:[l.jsxs("span",{style:{fontSize:"13px",fontWeight:600},children:[" My Saved Packs (",x.length,"/",ho,")"]}),l.jsx("span",{style:{fontSize:"12px",color:"var(--color-text-muted)"},children:b?"":""})]}),b&&l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px",marginTop:"8px"},children:x.map(M=>l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 8px",background:"rgba(100, 181, 246, 0.05)",borderRadius:"6px",border:"1px solid rgba(100, 181, 246, 0.2)",position:"relative"},children:[l.jsxs("button",{onClick:()=>{Y(M),I(!1)},style:{flex:1,textAlign:"left",background:"none",border:"none",color:"var(--color-text)",fontSize:"12px",cursor:"pointer",padding:0},children:[l.jsx("div",{style:{fontWeight:600},children:M.name}),l.jsxs("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:[M.species.length," bird",M.species.length>1?"s":""]})]}),l.jsx("button",{onPointerDown:K=>{K.stopPropagation(),console.log("Delete button pressed!",M.id),setTimeout(()=>{ge(M.id)},0)},style:{background:"rgba(229, 115, 115, 0.1)",border:"1px solid rgba(229, 115, 115, 0.3)",borderRadius:"4px",padding:"8px 12px",fontSize:"11px",color:"var(--color-error)",cursor:"pointer",pointerEvents:"auto",position:"relative",zIndex:100,WebkitTapHighlightColor:"rgba(229, 115, 115, 0.3)",touchAction:"manipulation",WebkitUserSelect:"none",userSelect:"none",minWidth:"60px",minHeight:"32px"},"aria-label":`Delete ${M.name}`,children:"Delete"})]},M.id))})]}),l.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",display:"flex",gap:"8px"},children:[l.jsxs("div",{style:{flex:1,position:"relative"},children:[l.jsx("input",{ref:f,type:"text",placeholder:"Search birds...",value:s,onChange:M=>o(M.target.value),style:{width:"100%",padding:"10px 12px",paddingRight:s?"36px":"12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px"}}),s&&l.jsx("button",{onClick:F,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"var(--color-text-muted)",border:"none",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:0},"aria-label":"Clear search",children:l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-background)",strokeWidth:"3",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),l.jsxs("button",{onClick:j,style:{padding:"10px 14px",background:m?"rgba(100, 181, 246, 0.15)":"var(--color-surface)",border:m?"1px solid #64B5F6":"1px solid var(--color-text-muted)",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"13px",fontWeight:600,whiteSpace:"nowrap"},"aria-label":"Toggle taxonomic sort",children:[l.jsx("span",{children:m?"":""}),l.jsx("span",{children:m?"Taxonomic ":"Sort"})]})]}),l.jsxs("div",{style:{flexShrink:0,marginBottom:"8px",padding:"6px 10px",background:"rgba(45, 90, 39, 0.1)",borderRadius:"8px",fontSize:"12px",color:"var(--color-text-muted)",lineHeight:1.3},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Tap ",l.jsx("strong",{style:{color:"var(--color-text)"},children:""})," to preview, ",l.jsx("strong",{style:{color:"var(--color-text)"},children:"anywhere else on the card"})," to add/remove.",m&&l.jsxs(l.Fragment,{children:[" ",l.jsx("span",{style:{color:"var(--color-accent)"},children:""})," Taxonomic mode groups related species together."]})]}),l.jsxs("div",{style:{flexShrink:0,marginBottom:"12px",padding:"8px 12px",background:n.length>0?"rgba(45, 90, 39, 0.2)":"var(--color-surface)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l.jsxs("span",{style:{fontSize:"14px"},children:[l.jsx("span",{style:{fontWeight:700,color:"var(--color-accent)"},children:n.length}),"/",uo," selected"]}),n.length>0&&l.jsxs("div",{style:{display:"flex",gap:"8px"},children:[l.jsx("button",{onClick:q,style:{background:"rgba(45, 90, 39, 0.2)",border:"1px solid var(--color-primary)",borderRadius:"6px",padding:"4px 10px",color:"white",fontSize:"12px",cursor:"pointer",fontWeight:600},children:O?" Update / Save As New":" Save Pack"}),l.jsx("button",{onClick:E,style:{background:"none",border:"none",color:"var(--color-text-muted)",fontSize:"12px",cursor:"pointer",textDecoration:"underline"},children:"Clear all"})]})]}),l.jsx("div",{style:{flex:1,overflowY:"auto",marginBottom:"12px",paddingBottom:n.length>0?"80px":"0"},children:l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"8px"},children:te.map(M=>{const K=n.includes(M.code),ne=n.indexOf(M.code),ue=K?Rg[ne%Rg.length]:void 0;return l.jsxs("div",{onClick:()=>k(M.code,te.length),style:{display:"flex",flexDirection:"column",gap:"6px",padding:"8px",background:K?`${ue}22`:"var(--color-surface)",border:K?`2px solid ${ue}`:"1px solid transparent",borderRadius:"12px",opacity:K||n.length<uo?1:.5,transition:"all 0.15s",cursor:K||n.length<uo?"pointer":"not-allowed"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[l.jsx("button",{onClick:ke=>{ke.stopPropagation(),U(M,ke)},style:{flex:"0 0 44px",width:"44px",height:"44px",borderRadius:"50%",background:a===M.code?"rgba(255, 152, 0, 0.3)":"rgba(255, 152, 0, 0.1)",border:`2px solid ${a===M.code?"var(--color-accent)":"rgba(255, 152, 0, 0.3)"}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.15s",padding:0},"aria-label":`Preview ${M.name}`,children:a===M.code?l.jsx(yT,{color:"var(--color-accent)"}):l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"var(--color-accent)",children:l.jsx("path",{d:"M8 5v14l11-7z"})})}),l.jsxs("div",{style:{flex:"1",display:"flex",alignItems:"center",justifyContent:"center",padding:"4px",position:"relative",pointerEvents:"none"},children:[l.jsx(gT,{code:M.code,size:48}),K&&l.jsx("div",{style:{position:"absolute",top:"0",right:"0",width:"20px",height:"20px",borderRadius:"50%",background:ue,display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx(vT,{})})]})]}),l.jsxs("div",{style:{width:"100%",textAlign:"center",pointerEvents:"none"},children:[l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:500,fontStyle:m&&M.scientificName?"italic":"normal"},children:m&&M.scientificName?M.scientificName:M.name}),l.jsx("div",{style:{fontSize:"10px",color:"var(--color-text-muted)",marginTop:"2px"},children:M.code})]})]},M.code)})})}),n.length>0&&l.jsxs("button",{onClick:R,style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",left:"24px",right:"24px",padding:"14px 20px",fontSize:"16px",fontWeight:700,background:"linear-gradient(135deg, var(--color-primary) 0%, #3a7332 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",boxShadow:"0 4px 16px rgba(45, 90, 39, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",zIndex:1e3},children:[l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M8 5v14l11-7z"})}),"Start with ",n.length," bird",n.length>1?"s":""]}),w&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>T(!1),children:l.jsxs("div",{style:{background:"var(--color-background)",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid var(--color-primary)"},onClick:M=>M.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px"},children:"Save Custom Pack"}),l.jsx("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"16px"},children:"Give your pack a name so you can load it later:"}),l.jsx("input",{type:"text",value:A,onChange:M=>C(M.target.value),onKeyDown:M=>M.key==="Enter"&&B(),placeholder:"e.g., My Backyard, Lake Erie Migrants...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",marginBottom:"16px"}}),l.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[l.jsx("button",{onClick:()=>{T(!1),C("")},style:{padding:"10px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Cancel"}),l.jsx("button",{onClick:B,style:{padding:"10px 20px",background:"var(--color-primary)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:" Save Pack"})]})]})}),N&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{L(!1),P(null)},children:l.jsxs("div",{style:{background:"var(--color-background)",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid var(--color-error)"},onClick:M=>M.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"var(--color-error)"},children:"Delete Saved Pack?"}),l.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)",marginBottom:"16px"},children:['This will permanently delete "',(fe=x.find(M=>M.id===D))==null?void 0:fe.name,'". This action cannot be undone.']}),l.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[l.jsx("button",{onClick:()=>{L(!1),P(null)},style:{padding:"10px 20px",background:"var(--color-surface)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",color:"var(--color-text)",fontSize:"14px",cursor:"pointer"},children:"Cancel"}),l.jsx("button",{onClick:pe,style:{padding:"10px 20px",background:"var(--color-error)",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Delete Pack"})]})]})})]})}function gT({code:t,size:e=48}){const[r,n]=S.useState(!0),i=`/data/icons/${t}.png`;return r?l.jsx("img",{src:i,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>n(!1)}):l.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:"var(--color-text-muted)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:700,color:"#FFFFFF"},children:t})}function xT(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function yT({color:t="currentColor"}){return l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:t,children:l.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})}function vT(){return l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1A1A2E",strokeWidth:"3",children:l.jsx("path",{d:"M20 6L9 17l-5-5"})})}const _T={campaign:"Learn",practice:"Practice",challenge:"Challenge",random:"Random"};function wT({score:t,streak:e,timeRemaining:r,mode:n,levelId:i,levelTitle:s}){const o=Math.floor(r/60),a=r%60,c=`${o}:${a.toString().padStart(2,"0")}`;return l.jsxs("div",{className:"hud",children:[l.jsxs("div",{className:"hud-score",children:[l.jsx("span",{className:"hud-label",children:"Score"}),l.jsx("span",{className:"hud-value",children:t.toLocaleString()})]}),l.jsxs("div",{className:"hud-center",children:[n==="campaign"&&i?l.jsxs("span",{className:"hud-mode",children:["Level ",i,s?`: ${s}`:""]}):n?l.jsx("span",{className:"hud-mode",children:_T[n]||n}):null,l.jsx("div",{className:"hud-streak",children:e===0?l.jsx("span",{className:"streak-dot",children:""}):Array.from({length:e}).map((u,d)=>l.jsx("span",{className:"streak-dot active",children:""},d))})]}),l.jsxs("div",{className:"hud-timer",children:[l.jsx("span",{className:"hud-label",children:"Time"}),l.jsx("span",{className:"hud-value",children:c})]}),l.jsx("style",{children:`
        .hud {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          padding-top: calc(12px + var(--safe-area-top, 0px));
          background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.3) 100%);
          border-bottom: 1px solid var(--color-surface);
        }

        .hud-score, .hud-timer {
          display: flex;
          flex-direction: column;
          align-items: center;
          min-width: 80px;
        }

        .hud-label {
          font-size: 10px;
          text-transform: uppercase;
          color: var(--color-text-muted);
          letter-spacing: 0.5px;
        }

        .hud-value {
          font-family: var(--font-mono);
          font-size: 20px;
          font-weight: 600;
          color: var(--color-accent);
        }

        .hud-center {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 4px;
        }

        .hud-mode {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1px;
          color: var(--color-text-muted);
          padding: 2px 8px;
          border-radius: 4px;
          background: rgba(255, 255, 255, 0.1);
        }

        .hud-streak {
          display: flex;
          gap: 4px;
          font-size: 12px;
        }

        .streak-dot {
          color: var(--color-text-muted);
          transition: color 0.2s, transform 0.2s;
        }

        .streak-dot.active {
          color: var(--color-accent);
          transform: scale(1.2);
        }
      `})]})}const ST=S.memo(wT);var Di=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(Di||{}),r_=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(r_||{}),Dh=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Dh||{}),me=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(me||{}),Dr=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(Dr||{}),X=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(X||{}),Rs=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Rs||{}),ce=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(ce||{}),Z=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(Z||{}),en=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(en||{}),Wn=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Wn||{}),Hr=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Hr||{}),Nt=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Nt||{}),Nr=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Nr||{}),jp=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(jp||{}),rr=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(rr||{}),st=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(st||{}),tt=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(tt||{}),zr=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(zr||{});const bT={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},ee={ADAPTER:bT,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Wu=/iPhone/i,Ig=/iPod/i,Mg=/iPad/i,jg=/\biOS-universal(?:.+)Mac\b/i,Xu=/\bAndroid(?:.+)Mobile\b/i,Bg=/Android/i,Ki=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Xa=/Silk/i,Xr=/Windows Phone/i,Ng=/\bWindows(?:.+)ARM\b/i,Fg=/BlackBerry/i,Lg=/BB10/i,Dg=/Opera Mini/i,Og=/\b(CriOS|Chrome)(?:.+)Mobile/i,Ug=/Mobile(?:.+)Firefox\b/i,zg=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function ET(t){return function(e){return e.test(t)}}function Gg(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,n=r.split("[FBAN");typeof n[1]<"u"&&(r=n[0]),n=r.split("Twitter"),typeof n[1]<"u"&&(r=n[0]);var i=ET(r),s={apple:{phone:i(Wu)&&!i(Xr),ipod:i(Ig),tablet:!i(Wu)&&(i(Mg)||zg(e))&&!i(Xr),universal:i(jg),device:(i(Wu)||i(Ig)||i(Mg)||i(jg)||zg(e))&&!i(Xr)},amazon:{phone:i(Ki),tablet:!i(Ki)&&i(Xa),device:i(Ki)||i(Xa)},android:{phone:!i(Xr)&&i(Ki)||!i(Xr)&&i(Xu),tablet:!i(Xr)&&!i(Ki)&&!i(Xu)&&(i(Xa)||i(Bg)),device:!i(Xr)&&(i(Ki)||i(Xa)||i(Xu)||i(Bg))||i(/\bokhttp\b/i)},windows:{phone:i(Xr),tablet:i(Ng),device:i(Xr)||i(Ng)},other:{blackberry:i(Fg),blackberry10:i(Lg),opera:i(Dg),firefox:i(Ug),chrome:i(Og),device:i(Fg)||i(Lg)||i(Dg)||i(Ug)||i(Og)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const TT=Gg.default??Gg,tn=TT(globalThis.navigator);ee.RETINA_PREFIX=/@([0-9\.]+)x/;ee.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var n_={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,h,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,h||c,f),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)e.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},a.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,p=h.length,m=new Array(p);f<p;f++)m[f]=h[f].fn;return m},a.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,d,h,f,p,m){var v=r?r+u:u;if(!this._events[v])return!1;var _=this._events[v],y=arguments.length,x,g;if(_.fn){switch(_.once&&this.removeListener(u,_.fn,void 0,!0),y){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,d),!0;case 3:return _.fn.call(_.context,d,h),!0;case 4:return _.fn.call(_.context,d,h,f),!0;case 5:return _.fn.call(_.context,d,h,f,p),!0;case 6:return _.fn.call(_.context,d,h,f,p,m),!0}for(g=1,x=new Array(y-1);g<y;g++)x[g-1]=arguments[g];_.fn.apply(_.context,x)}else{var w=_.length,T;for(g=0;g<w;g++)switch(_[g].once&&this.removeListener(u,_[g].fn,void 0,!0),y){case 1:_[g].fn.call(_[g].context);break;case 2:_[g].fn.call(_[g].context,d);break;case 3:_[g].fn.call(_[g].context,d,h);break;case 4:_[g].fn.call(_[g].context,d,h,f);break;default:if(!x)for(T=1,x=new Array(y-1);T<y;T++)x[T-1]=arguments[T];_[g].fn.apply(_[g].context,x)}}return!0},a.prototype.on=function(u,d,h){return s(this,u,d,h,!1)},a.prototype.once=function(u,d,h){return s(this,u,d,h,!0)},a.prototype.removeListener=function(u,d,h,f){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return o(this,p),this;var m=this._events[p];if(m.fn)m.fn===d&&(!f||m.once)&&(!h||m.context===h)&&o(this,p);else{for(var v=0,_=[],y=m.length;v<y;v++)(m[v].fn!==d||f&&!m[v].once||h&&m[v].context!==h)&&_.push(m[v]);_.length?this._events[p]=_.length===1?_[0]:_:o(this,p)}return this},a.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(n_);var AT=n_.exports;const Sa=Nf(AT);var Bp={exports:{}};Bp.exports=Jc;Bp.exports.default=Jc;function Jc(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=i_(t,0,i,r,!0),o=[];if(!s||s.next===s.prev)return o;var a,c,u,d,h,f,p;if(n&&(s=IT(t,e,s,r)),t.length>80*r){a=u=t[0],c=d=t[1];for(var m=r;m<i;m+=r)h=t[m],f=t[m+1],h<a&&(a=h),f<c&&(c=f),h>u&&(u=h),f>d&&(d=f);p=Math.max(u-a,d-c),p=p!==0?32767/p:0}return da(s,o,r,a,c,p,0),o}function i_(t,e,r,n,i){var s,o;if(i===zh(t,e,r,n)>0)for(s=e;s<r;s+=n)o=Hg(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=Hg(s,t[s],t[s+1],o);return o&&Qc(o,o.next)&&(fa(o),o=o.next),o}function Ri(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Qc(r,r.next)||Ve(r.prev,r,r.next)===0)){if(fa(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function da(t,e,r,n,i,s,o){if(t){!o&&s&&FT(t,n,i,s);for(var a=t,c,u;t.prev!==t.next;){if(c=t.prev,u=t.next,s?kT(t,n,i,s):CT(t)){e.push(c.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),fa(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=PT(Ri(t),e,r),da(t,e,r,n,i,s,2)):o===2&&RT(t,e,r,n,i,s):da(Ri(t),e,r,n,i,s,1);break}}}}function CT(t){var e=t.prev,r=t,n=t.next;if(Ve(e,r,n)>=0)return!1;for(var i=e.x,s=r.x,o=n.x,a=e.y,c=r.y,u=n.y,d=i<s?i<o?i:o:s<o?s:o,h=a<c?a<u?a:u:c<u?c:u,f=i>s?i>o?i:o:s>o?s:o,p=a>c?a>u?a:u:c>u?c:u,m=n.next;m!==e;){if(m.x>=d&&m.x<=f&&m.y>=h&&m.y<=p&&Ss(i,a,s,c,o,u,m.x,m.y)&&Ve(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function kT(t,e,r,n){var i=t.prev,s=t,o=t.next;if(Ve(i,s,o)>=0)return!1;for(var a=i.x,c=s.x,u=o.x,d=i.y,h=s.y,f=o.y,p=a<c?a<u?a:u:c<u?c:u,m=d<h?d<f?d:f:h<f?h:f,v=a>c?a>u?a:u:c>u?c:u,_=d>h?d>f?d:f:h>f?h:f,y=Oh(p,m,e,r,n),x=Oh(v,_,e,r,n),g=t.prevZ,w=t.nextZ;g&&g.z>=y&&w&&w.z<=x;){if(g.x>=p&&g.x<=v&&g.y>=m&&g.y<=_&&g!==i&&g!==o&&Ss(a,d,c,h,u,f,g.x,g.y)&&Ve(g.prev,g,g.next)>=0||(g=g.prevZ,w.x>=p&&w.x<=v&&w.y>=m&&w.y<=_&&w!==i&&w!==o&&Ss(a,d,c,h,u,f,w.x,w.y)&&Ve(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;g&&g.z>=y;){if(g.x>=p&&g.x<=v&&g.y>=m&&g.y<=_&&g!==i&&g!==o&&Ss(a,d,c,h,u,f,g.x,g.y)&&Ve(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;w&&w.z<=x;){if(w.x>=p&&w.x<=v&&w.y>=m&&w.y<=_&&w!==i&&w!==o&&Ss(a,d,c,h,u,f,w.x,w.y)&&Ve(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function PT(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!Qc(i,s)&&s_(i,n,n.next,s)&&ha(i,s)&&ha(s,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(s.i/r|0),fa(n),fa(n.next),n=t=s),n=n.next}while(n!==t);return Ri(n)}function RT(t,e,r,n,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&OT(o,a)){var c=o_(o,a);o=Ri(o,o.next),c=Ri(c,c.next),da(o,e,r,n,i,s,0),da(c,e,r,n,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function IT(t,e,r,n){var i=[],s,o,a,c,u;for(s=0,o=e.length;s<o;s++)a=e[s]*n,c=s<o-1?e[s+1]*n:t.length,u=i_(t,a,c,n,!1),u===u.next&&(u.steiner=!0),i.push(DT(u));for(i.sort(MT),s=0;s<i.length;s++)r=jT(i[s],r);return r}function MT(t,e){return t.x-e.x}function jT(t,e){var r=BT(t,e);if(!r)return e;var n=o_(r,t);return Ri(n,n.next),Ri(r,r.next)}function BT(t,e){var r=e,n=t.x,i=t.y,s=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s&&(s=a,o=r.x<r.next.x?r:r.next,a===n))return o}r=r.next}while(r!==e);if(!o)return null;var c=o,u=o.x,d=o.y,h=1/0,f;r=o;do n>=r.x&&r.x>=u&&n!==r.x&&Ss(i<d?n:s,i,u,d,i<d?s:n,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(n-r.x),ha(r,t)&&(f<h||f===h&&(r.x>o.x||r.x===o.x&&NT(o,r)))&&(o=r,h=f)),r=r.next;while(r!==c);return o}function NT(t,e){return Ve(t.prev,t,e.prev)<0&&Ve(e.next,t,t.next)<0}function FT(t,e,r,n){var i=t;do i.z===0&&(i.z=Oh(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,LT(i)}function LT(t){var e,r,n,i,s,o,a,c,u=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,n=r,a=0,e=0;e<u&&(a++,n=n.nextZ,!!n);e++);for(c=u;a>0||c>0&&n;)a!==0&&(c===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,c--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n}s.nextZ=null,u*=2}while(o>1);return t}function Oh(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function DT(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Ss(t,e,r,n,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(r-o)*(e-a)&&(r-o)*(s-a)>=(i-o)*(n-a)}function OT(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!UT(t,e)&&(ha(t,e)&&ha(e,t)&&zT(t,e)&&(Ve(t.prev,t,e.prev)||Ve(t,e.prev,e))||Qc(t,e)&&Ve(t.prev,t,t.next)>0&&Ve(e.prev,e,e.next)>0)}function Ve(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Qc(t,e){return t.x===e.x&&t.y===e.y}function s_(t,e,r,n){var i=Ka(Ve(t,e,r)),s=Ka(Ve(t,e,n)),o=Ka(Ve(r,n,t)),a=Ka(Ve(r,n,e));return!!(i!==s&&o!==a||i===0&&Ya(t,r,e)||s===0&&Ya(t,n,e)||o===0&&Ya(r,t,n)||a===0&&Ya(r,e,n))}function Ya(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ka(t){return t>0?1:t<0?-1:0}function UT(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&s_(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function ha(t,e){return Ve(t.prev,t,t.next)<0?Ve(t,e,t.next)>=0&&Ve(t,t.prev,e)>=0:Ve(t,e,t.prev)<0||Ve(t,t.next,e)<0}function zT(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function o_(t,e){var r=new Uh(t.i,t.x,t.y),n=new Uh(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function Hg(t,e,r,n){var i=new Uh(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function fa(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Uh(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Jc.deviation=function(t,e,r,n){var i=e&&e.length,s=i?e[0]*r:t.length,o=Math.abs(zh(t,0,s,r));if(i)for(var a=0,c=e.length;a<c;a++){var u=e[a]*r,d=a<c-1?e[a+1]*r:t.length;o-=Math.abs(zh(t,u,d,r))}var h=0;for(a=0;a<n.length;a+=3){var f=n[a]*r,p=n[a+1]*r,m=n[a+2]*r;h+=Math.abs((t[f]-t[m])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[m+1]-t[f+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function zh(t,e,r,n){for(var i=0,s=e,o=r-n;s<r;s+=n)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}Jc.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[i][s][o]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var GT=Bp.exports;const HT=Nf(GT);var fc={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */fc.exports;(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof Ro=="object"&&Ro;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a=2147483647,c=36,u=1,d=26,h=38,f=700,p=72,m=128,v="-",_=/^xn--/,y=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=c-u,T=Math.floor,A=String.fromCharCode,C;function b(R){throw new RangeError(g[R])}function I(R,E){for(var F=R.length,j=[];F--;)j[F]=E(R[F]);return j}function N(R,E){var F=R.split("@"),j="";F.length>1&&(j=F[0]+"@",R=F[1]),R=R.replace(x,".");var q=R.split("."),J=I(q,E).join(".");return j+J}function L(R){for(var E=[],F=0,j=R.length,q,J;F<j;)q=R.charCodeAt(F++),q>=55296&&q<=56319&&F<j?(J=R.charCodeAt(F++),(J&64512)==56320?E.push(((q&1023)<<10)+(J&1023)+65536):(E.push(q),F--)):E.push(q);return E}function D(R){return I(R,function(E){var F="";return E>65535&&(E-=65536,F+=A(E>>>10&1023|55296),E=56320|E&1023),F+=A(E),F}).join("")}function P(R){return R-48<10?R-22:R-65<26?R-65:R-97<26?R-97:c}function O(R,E){return R+22+75*(R<26)-((E!=0)<<5)}function z(R,E,F){var j=0;for(R=F?T(R/f):R>>1,R+=T(R/E);R>w*d>>1;j+=c)R=T(R/w);return T(j+(w+1)*R/(R+h))}function H(R){var E=[],F=R.length,j,q=0,J=m,B=p,Y,ge,pe,te,fe,M,K,ne,ue;for(Y=R.lastIndexOf(v),Y<0&&(Y=0),ge=0;ge<Y;++ge)R.charCodeAt(ge)>=128&&b("not-basic"),E.push(R.charCodeAt(ge));for(pe=Y>0?Y+1:0;pe<F;){for(te=q,fe=1,M=c;pe>=F&&b("invalid-input"),K=P(R.charCodeAt(pe++)),(K>=c||K>T((a-q)/fe))&&b("overflow"),q+=K*fe,ne=M<=B?u:M>=B+d?d:M-B,!(K<ne);M+=c)ue=c-ne,fe>T(a/ue)&&b("overflow"),fe*=ue;j=E.length+1,B=z(q-te,j,te==0),T(q/j)>a-J&&b("overflow"),J+=T(q/j),q%=j,E.splice(q++,0,J)}return D(E)}function W(R){var E,F,j,q,J,B,Y,ge,pe,te,fe,M=[],K,ne,ue,ke;for(R=L(R),K=R.length,E=m,F=0,J=p,B=0;B<K;++B)fe=R[B],fe<128&&M.push(A(fe));for(j=q=M.length,q&&M.push(v);j<K;){for(Y=a,B=0;B<K;++B)fe=R[B],fe>=E&&fe<Y&&(Y=fe);for(ne=j+1,Y-E>T((a-F)/ne)&&b("overflow"),F+=(Y-E)*ne,E=Y,B=0;B<K;++B)if(fe=R[B],fe<E&&++F>a&&b("overflow"),fe==E){for(ge=F,pe=c;te=pe<=J?u:pe>=J+d?d:pe-J,!(ge<te);pe+=c)ke=ge-te,ue=c-te,M.push(A(O(te+ke%ue,0))),ge=T(ke/ue);M.push(A(O(ge,0))),J=z(F,ne,j==q),F=0,++j}++F,++E}return M.join("")}function k(R){return N(R,function(E){return _.test(E)?H(E.slice(4).toLowerCase()):E})}function U(R){return N(R,function(E){return y.test(E)?"xn--"+W(E):E})}if(o={version:"1.4.1",ucs2:{decode:L,encode:D},decode:H,encode:W,toASCII:U,toUnicode:k},n&&i)if(t.exports==n)i.exports=o;else for(C in o)o.hasOwnProperty(C)&&(n[C]=o[C]);else r.punycode=o})(Ro)})(fc,fc.exports);var $T=fc.exports,Qs=TypeError;const VT={},WT=Object.freeze(Object.defineProperty({__proto__:null,default:VT},Symbol.toStringTag,{value:"Module"})),XT=iw(WT);var Np=typeof Map=="function"&&Map.prototype,Yu=Object.getOwnPropertyDescriptor&&Np?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,pc=Np&&Yu&&typeof Yu.get=="function"?Yu.get:null,$g=Np&&Map.prototype.forEach,Fp=typeof Set=="function"&&Set.prototype,Ku=Object.getOwnPropertyDescriptor&&Fp?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,mc=Fp&&Ku&&typeof Ku.get=="function"?Ku.get:null,Vg=Fp&&Set.prototype.forEach,YT=typeof WeakMap=="function"&&WeakMap.prototype,Uo=YT?WeakMap.prototype.has:null,KT=typeof WeakSet=="function"&&WeakSet.prototype,zo=KT?WeakSet.prototype.has:null,qT=typeof WeakRef=="function"&&WeakRef.prototype,Wg=qT?WeakRef.prototype.deref:null,JT=Boolean.prototype.valueOf,QT=Object.prototype.toString,ZT=Function.prototype.toString,eA=String.prototype.match,Lp=String.prototype.slice,Bn=String.prototype.replace,tA=String.prototype.toUpperCase,Xg=String.prototype.toLowerCase,a_=RegExp.prototype.test,Yg=Array.prototype.concat,Fr=Array.prototype.join,rA=Array.prototype.slice,Kg=Math.floor,Gh=typeof BigInt=="function"?BigInt.prototype.valueOf:null,qu=Object.getOwnPropertySymbols,Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Go=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Vs||!0)?Symbol.toStringTag:null,l_=Object.prototype.propertyIsEnumerable,qg=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Jg(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||a_.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-Kg(-t):Kg(t);if(n!==t){var i=String(n),s=Lp.call(e,i.length+1);return Bn.call(i,r,"$&_")+"."+Bn.call(Bn.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Bn.call(e,r,"$&_")}var $h=XT,Qg=$h.custom,Zg=d_(Qg)?Qg:null,c_={__proto__:null,double:'"',single:"'"},nA={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},Zc=function t(e,r,n,i){var s=r||{};if(qr(s,"quoteStyle")&&!qr(c_,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(qr(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=qr(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(qr(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(qr(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return f_(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return a?Jg(e,c):c}if(typeof e=="bigint"){var u=String(e)+"n";return a?Jg(e,u):u}var d=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=d&&d>0&&typeof e=="object")return Vh(e)?"[Array]":"[Object]";var h=wA(s,n);if(typeof i>"u")i=[];else if(h_(i,e)>=0)return"[Circular]";function f(P,O,z){if(O&&(i=rA.call(i),i.push(O)),z){var H={depth:s.depth};return qr(s,"quoteStyle")&&(H.quoteStyle=s.quoteStyle),t(P,H,n+1,i)}return t(P,s,n+1,i)}if(typeof e=="function"&&!ex(e)){var p=hA(e),m=qa(e,f);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(m.length>0?" { "+Fr.call(m,", ")+" }":"")}if(d_(e)){var v=Vs?Bn.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Hh.call(e);return typeof e=="object"&&!Vs?fo(v):v}if(yA(e)){for(var _="<"+Xg.call(String(e.nodeName)),y=e.attributes||[],x=0;x<y.length;x++)_+=" "+y[x].name+"="+u_(iA(y[x].value),"double",s);return _+=">",e.childNodes&&e.childNodes.length&&(_+="..."),_+="</"+Xg.call(String(e.nodeName))+">",_}if(Vh(e)){if(e.length===0)return"[]";var g=qa(e,f);return h&&!_A(g)?"["+Wh(g,h)+"]":"[ "+Fr.call(g,", ")+" ]"}if(oA(e)){var w=qa(e,f);return!("cause"in Error.prototype)&&"cause"in e&&!l_.call(e,"cause")?"{ ["+String(e)+"] "+Fr.call(Yg.call("[cause]: "+f(e.cause),w),", ")+" }":w.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Fr.call(w,", ")+" }"}if(typeof e=="object"&&o){if(Zg&&typeof e[Zg]=="function"&&$h)return $h(e,{depth:d-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(fA(e)){var T=[];return $g&&$g.call(e,function(P,O){T.push(f(O,e,!0)+" => "+f(P,e))}),tx("Map",pc.call(e),T,h)}if(gA(e)){var A=[];return Vg&&Vg.call(e,function(P){A.push(f(P,e))}),tx("Set",mc.call(e),A,h)}if(pA(e))return Ju("WeakMap");if(xA(e))return Ju("WeakSet");if(mA(e))return Ju("WeakRef");if(lA(e))return fo(f(Number(e)));if(uA(e))return fo(f(Gh.call(e)));if(cA(e))return fo(JT.call(e));if(aA(e))return fo(f(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof Ro<"u"&&e===Ro)return"{ [object globalThis] }";if(!sA(e)&&!ex(e)){var C=qa(e,f),b=qg?qg(e)===Object.prototype:e instanceof Object||e.constructor===Object,I=e instanceof Object?"":"null prototype",N=!b&&Go&&Object(e)===e&&Go in e?Lp.call(ri(e),8,-1):I?"Object":"",L=b||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",D=L+(N||I?"["+Fr.call(Yg.call([],N||[],I||[]),": ")+"] ":"");return C.length===0?D+"{}":h?D+"{"+Wh(C,h)+"}":D+"{ "+Fr.call(C,", ")+" }"}return String(e)};function u_(t,e,r){var n=r.quoteStyle||e,i=c_[n];return i+t+i}function iA(t){return Bn.call(String(t),/"/g,"&quot;")}function Oi(t){return!Go||!(typeof t=="object"&&(Go in t||typeof t[Go]<"u"))}function Vh(t){return ri(t)==="[object Array]"&&Oi(t)}function sA(t){return ri(t)==="[object Date]"&&Oi(t)}function ex(t){return ri(t)==="[object RegExp]"&&Oi(t)}function oA(t){return ri(t)==="[object Error]"&&Oi(t)}function aA(t){return ri(t)==="[object String]"&&Oi(t)}function lA(t){return ri(t)==="[object Number]"&&Oi(t)}function cA(t){return ri(t)==="[object Boolean]"&&Oi(t)}function d_(t){if(Vs)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Hh)return!1;try{return Hh.call(t),!0}catch{}return!1}function uA(t){if(!t||typeof t!="object"||!Gh)return!1;try{return Gh.call(t),!0}catch{}return!1}var dA=Object.prototype.hasOwnProperty||function(t){return t in this};function qr(t,e){return dA.call(t,e)}function ri(t){return QT.call(t)}function hA(t){if(t.name)return t.name;var e=eA.call(ZT.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function h_(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function fA(t){if(!pc||!t||typeof t!="object")return!1;try{pc.call(t);try{mc.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function pA(t){if(!Uo||!t||typeof t!="object")return!1;try{Uo.call(t,Uo);try{zo.call(t,zo)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function mA(t){if(!Wg||!t||typeof t!="object")return!1;try{return Wg.call(t),!0}catch{}return!1}function gA(t){if(!mc||!t||typeof t!="object")return!1;try{mc.call(t);try{pc.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function xA(t){if(!zo||!t||typeof t!="object")return!1;try{zo.call(t,zo);try{Uo.call(t,Uo)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function yA(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function f_(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return f_(Lp.call(t,0,e.maxStringLength),e)+n}var i=nA[e.quoteStyle||"single"];i.lastIndex=0;var s=Bn.call(Bn.call(t,i,"\\$1"),/[\x00-\x1f]/g,vA);return u_(s,"single",e)}function vA(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+tA.call(e.toString(16))}function fo(t){return"Object("+t+")"}function Ju(t){return t+" { ? }"}function tx(t,e,r,n){var i=n?Wh(r,n):Fr.call(r,", ");return t+" ("+e+") {"+i+"}"}function _A(t){for(var e=0;e<t.length;e++)if(h_(t[e],`
`)>=0)return!1;return!0}function wA(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=Fr.call(Array(t.indent+1)," ");else return null;return{base:r,prev:Fr.call(Array(e+1),r)}}function Wh(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+Fr.call(t,","+r)+`
`+e.prev}function qa(t,e){var r=Vh(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=qr(t,i)?e(t[i],t):""}var s=typeof qu=="function"?qu(t):[],o;if(Vs){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var c in t)qr(t,c)&&(r&&String(Number(c))===c&&c<t.length||Vs&&o["$"+c]instanceof Symbol||(a_.call(/[^\w$]/,c)?n.push(e(c,t)+": "+e(t[c],t)):n.push(c+": "+e(t[c],t))));if(typeof qu=="function")for(var u=0;u<s.length;u++)l_.call(t,s[u])&&n.push("["+e(s[u])+"]: "+e(t[s[u]],t));return n}var SA=Zc,bA=Qs,eu=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},EA=function(t,e){if(t){var r=eu(t,e);return r&&r.value}},TA=function(t,e,r){var n=eu(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},AA=function(t,e){return t?!!eu(t,e):!1},CA=function(t,e){if(t)return eu(t,e,!0)},kA=function(){var e,r={assert:function(n){if(!r.has(n))throw new bA("Side channel does not contain "+SA(n))},delete:function(n){var i=e&&e.next,s=CA(e,n);return s&&i&&i===s&&(e=void 0),!!s},get:function(n){return EA(e,n)},has:function(n){return AA(e,n)},set:function(n,i){e||(e={next:void 0}),TA(e,n,i)}};return r},p_=Object,PA=Error,RA=EvalError,IA=RangeError,MA=ReferenceError,jA=SyntaxError,BA=URIError,NA=Math.abs,FA=Math.floor,LA=Math.max,DA=Math.min,OA=Math.pow,UA=Math.round,zA=Number.isNaN||function(e){return e!==e},GA=zA,HA=function(e){return GA(e)||e===0?e:e<0?-1:1},$A=Object.getOwnPropertyDescriptor,Rl=$A;if(Rl)try{Rl([],"length")}catch{Rl=null}var m_=Rl,Il=Object.defineProperty||!1;if(Il)try{Il({},"a",{value:1})}catch{Il=!1}var VA=Il,Qu,rx;function WA(){return rx||(rx=1,Qu=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),Qu}var Zu,nx;function XA(){if(nx)return Zu;nx=1;var t=typeof Symbol<"u"&&Symbol,e=WA();return Zu=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Zu}var ed,ix;function g_(){return ix||(ix=1,ed=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),ed}var td,sx;function x_(){if(sx)return td;sx=1;var t=p_;return td=t.getPrototypeOf||null,td}var YA="Function.prototype.bind called on incompatible ",KA=Object.prototype.toString,qA=Math.max,JA="[object Function]",ox=function(e,r){for(var n=[],i=0;i<e.length;i+=1)n[i]=e[i];for(var s=0;s<r.length;s+=1)n[s+e.length]=r[s];return n},QA=function(e,r){for(var n=[],i=r,s=0;i<e.length;i+=1,s+=1)n[s]=e[i];return n},ZA=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},eC=function(e){var r=this;if(typeof r!="function"||KA.apply(r)!==JA)throw new TypeError(YA+r);for(var n=QA(arguments,1),i,s=function(){if(this instanceof i){var d=r.apply(this,ox(n,arguments));return Object(d)===d?d:this}return r.apply(e,ox(n,arguments))},o=qA(0,r.length-n.length),a=[],c=0;c<o;c++)a[c]="$"+c;if(i=Function("binder","return function ("+ZA(a,",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var u=function(){};u.prototype=r.prototype,i.prototype=new u,u.prototype=null}return i},tC=eC,tu=Function.prototype.bind||tC,Dp=Function.prototype.call,rd,ax;function y_(){return ax||(ax=1,rd=Function.prototype.apply),rd}var rC=typeof Reflect<"u"&&Reflect&&Reflect.apply,nC=tu,iC=y_(),sC=Dp,oC=rC,aC=oC||nC.call(sC,iC),lC=tu,cC=Qs,uC=Dp,dC=aC,v_=function(e){if(e.length<1||typeof e[0]!="function")throw new cC("a function is required");return dC(lC,uC,e)},nd,lx;function hC(){if(lx)return nd;lx=1;var t=v_,e=m_,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return nd=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,nd}var id,cx;function fC(){if(cx)return id;cx=1;var t=g_(),e=x_(),r=hC();return id=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,id}var sd,ux;function pC(){if(ux)return sd;ux=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=tu;return sd=r.call(t,e),sd}var Ee,mC=p_,gC=PA,xC=RA,yC=IA,vC=MA,Ws=jA,Is=Qs,_C=BA,wC=NA,SC=FA,bC=LA,EC=DA,TC=OA,AC=UA,CC=HA,__=Function,od=function(t){try{return __('"use strict"; return ('+t+").constructor;")()}catch{}},pa=m_,kC=VA,ad=function(){throw new Is},PC=pa?function(){try{return arguments.callee,ad}catch{try{return pa(arguments,"callee").get}catch{return ad}}}():ad,qi=XA()(),lt=fC(),RC=x_(),IC=g_(),w_=y_(),ba=Dp,ns={},MC=typeof Uint8Array>"u"||!lt?Ee:lt(Uint8Array),Si={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Ee:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Ee:ArrayBuffer,"%ArrayIteratorPrototype%":qi&&lt?lt([][Symbol.iterator]()):Ee,"%AsyncFromSyncIteratorPrototype%":Ee,"%AsyncFunction%":ns,"%AsyncGenerator%":ns,"%AsyncGeneratorFunction%":ns,"%AsyncIteratorPrototype%":ns,"%Atomics%":typeof Atomics>"u"?Ee:Atomics,"%BigInt%":typeof BigInt>"u"?Ee:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Ee:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Ee:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Ee:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":gC,"%eval%":eval,"%EvalError%":xC,"%Float16Array%":typeof Float16Array>"u"?Ee:Float16Array,"%Float32Array%":typeof Float32Array>"u"?Ee:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Ee:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Ee:FinalizationRegistry,"%Function%":__,"%GeneratorFunction%":ns,"%Int8Array%":typeof Int8Array>"u"?Ee:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Ee:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Ee:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":qi&&lt?lt(lt([][Symbol.iterator]())):Ee,"%JSON%":typeof JSON=="object"?JSON:Ee,"%Map%":typeof Map>"u"?Ee:Map,"%MapIteratorPrototype%":typeof Map>"u"||!qi||!lt?Ee:lt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":mC,"%Object.getOwnPropertyDescriptor%":pa,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Ee:Promise,"%Proxy%":typeof Proxy>"u"?Ee:Proxy,"%RangeError%":yC,"%ReferenceError%":vC,"%Reflect%":typeof Reflect>"u"?Ee:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Ee:Set,"%SetIteratorPrototype%":typeof Set>"u"||!qi||!lt?Ee:lt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Ee:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":qi&&lt?lt(""[Symbol.iterator]()):Ee,"%Symbol%":qi?Symbol:Ee,"%SyntaxError%":Ws,"%ThrowTypeError%":PC,"%TypedArray%":MC,"%TypeError%":Is,"%Uint8Array%":typeof Uint8Array>"u"?Ee:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Ee:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Ee:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Ee:Uint32Array,"%URIError%":_C,"%WeakMap%":typeof WeakMap>"u"?Ee:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Ee:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Ee:WeakSet,"%Function.prototype.call%":ba,"%Function.prototype.apply%":w_,"%Object.defineProperty%":kC,"%Object.getPrototypeOf%":RC,"%Math.abs%":wC,"%Math.floor%":SC,"%Math.max%":bC,"%Math.min%":EC,"%Math.pow%":TC,"%Math.round%":AC,"%Math.sign%":CC,"%Reflect.getPrototypeOf%":IC};if(lt)try{null.error}catch(t){var jC=lt(lt(t));Si["%Error.prototype%"]=jC}var BC=function t(e){var r;if(e==="%AsyncFunction%")r=od("async function () {}");else if(e==="%GeneratorFunction%")r=od("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=od("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&lt&&(r=lt(i.prototype))}return Si[e]=r,r},dx={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ea=tu,gc=pC(),NC=Ea.call(ba,Array.prototype.concat),FC=Ea.call(w_,Array.prototype.splice),hx=Ea.call(ba,String.prototype.replace),xc=Ea.call(ba,String.prototype.slice),LC=Ea.call(ba,RegExp.prototype.exec),DC=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,OC=/\\(\\)?/g,UC=function(e){var r=xc(e,0,1),n=xc(e,-1);if(r==="%"&&n!=="%")throw new Ws("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Ws("invalid intrinsic syntax, expected opening `%`");var i=[];return hx(e,DC,function(s,o,a,c){i[i.length]=a?hx(c,OC,"$1"):o||s}),i},zC=function(e,r){var n=e,i;if(gc(dx,n)&&(i=dx[n],n="%"+i[0]+"%"),gc(Si,n)){var s=Si[n];if(s===ns&&(s=BC(n)),typeof s>"u"&&!r)throw new Is("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Ws("intrinsic "+e+" does not exist!")},Op=function(e,r){if(typeof e!="string"||e.length===0)throw new Is("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Is('"allowMissing" argument must be a boolean');if(LC(/^%?[^%]*%?$/,e)===null)throw new Ws("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=UC(e),i=n.length>0?n[0]:"",s=zC("%"+i+"%",r),o=s.name,a=s.value,c=!1,u=s.alias;u&&(i=u[0],FC(n,NC([0,1],u)));for(var d=1,h=!0;d<n.length;d+=1){var f=n[d],p=xc(f,0,1),m=xc(f,-1);if((p==='"'||p==="'"||p==="`"||m==='"'||m==="'"||m==="`")&&p!==m)throw new Ws("property names with quotes must have matching quotes");if((f==="constructor"||!h)&&(c=!0),i+="."+f,o="%"+i+"%",gc(Si,o))a=Si[o];else if(a!=null){if(!(f in a)){if(!r)throw new Is("base intrinsic for "+e+" exists, but the property is not available.");return}if(pa&&d+1>=n.length){var v=pa(a,f);h=!!v,h&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else h=gc(a,f),a=a[f];h&&!c&&(Si[o]=a)}}return a},S_=Op,b_=v_,GC=b_([S_("%String.prototype.indexOf%")]),E_=function(e,r){var n=S_(e,!!r);return typeof n=="function"&&GC(e,".prototype.")>-1?b_([n]):n},HC=Op,Ta=E_,$C=Zc,VC=Qs,fx=HC("%Map%",!0),WC=Ta("Map.prototype.get",!0),XC=Ta("Map.prototype.set",!0),YC=Ta("Map.prototype.has",!0),KC=Ta("Map.prototype.delete",!0),qC=Ta("Map.prototype.size",!0),T_=!!fx&&function(){var e,r={assert:function(n){if(!r.has(n))throw new VC("Side channel does not contain "+$C(n))},delete:function(n){if(e){var i=KC(e,n);return qC(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return WC(e,n)},has:function(n){return e?YC(e,n):!1},set:function(n,i){e||(e=new fx),XC(e,n,i)}};return r},JC=Op,ru=E_,QC=Zc,Ja=T_,ZC=Qs,Ji=JC("%WeakMap%",!0),e2=ru("WeakMap.prototype.get",!0),t2=ru("WeakMap.prototype.set",!0),r2=ru("WeakMap.prototype.has",!0),n2=ru("WeakMap.prototype.delete",!0),i2=Ji?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new ZC("Side channel does not contain "+QC(i))},delete:function(i){if(Ji&&i&&(typeof i=="object"||typeof i=="function")){if(e)return n2(e,i)}else if(Ja&&r)return r.delete(i);return!1},get:function(i){return Ji&&i&&(typeof i=="object"||typeof i=="function")&&e?e2(e,i):r&&r.get(i)},has:function(i){return Ji&&i&&(typeof i=="object"||typeof i=="function")&&e?r2(e,i):!!r&&r.has(i)},set:function(i,s){Ji&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new Ji),t2(e,i,s)):Ja&&(r||(r=Ja()),r.set(i,s))}};return n}:Ja,s2=Qs,o2=Zc,a2=kA,l2=T_,c2=i2,u2=c2||l2||a2,A_=function(){var e,r={assert:function(n){if(!r.has(n))throw new s2("Side channel does not contain "+o2(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=u2()),e.set(n,i)}};return r},d2=String.prototype.replace,h2=/%20/g,ld={RFC1738:"RFC1738",RFC3986:"RFC3986"},Up={default:ld.RFC3986,formatters:{RFC1738:function(t){return d2.call(t,h2,"+")},RFC3986:function(t){return String(t)}},RFC1738:ld.RFC1738,RFC3986:ld.RFC3986},f2=Up,p2=A_,cd=Object.prototype.hasOwnProperty,mi=Array.isArray,nu=p2(),C_=function(e,r){return nu.set(e,r),e},yc=function(e){return nu.has(e)},Xh=function(e){return nu.get(e)},k_=function(e,r){nu.set(e,r)},Ar=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),m2=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(mi(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]<"u"&&i.push(n[s]);r.obj[r.prop]=i}}},zp=function(e,r){for(var n=r&&r.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},g2=function t(e,r,n){if(!r)return e;if(typeof r!="object"&&typeof r!="function"){if(mi(e))e.push(r);else if(e&&typeof e=="object")if(yc(e)){var i=Xh(e)+1;e[i]=r,k_(e,i)}else(n&&(n.plainObjects||n.allowPrototypes)||!cd.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object"){if(yc(r)){for(var s=Object.keys(r),o=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},a=0;a<s.length;a++){var c=parseInt(s[a],10);o[c+1]=r[s[a]]}return C_(o,Xh(r)+1)}return[e].concat(r)}var u=e;return mi(e)&&!mi(r)&&(u=zp(e,n)),mi(e)&&mi(r)?(r.forEach(function(d,h){if(cd.call(e,h)){var f=e[h];f&&typeof f=="object"&&d&&typeof d=="object"?e[h]=t(f,d,n):e.push(d)}else e[h]=d}),e):Object.keys(r).reduce(function(d,h){var f=r[h];return cd.call(d,h)?d[h]=t(d[h],f,n):d[h]=f,d},u)},x2=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},y2=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},ud=1024,v2=function(e,r,n,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(p){return"%26%23"+parseInt(p.slice(2),16)+"%3B"});for(var a="",c=0;c<o.length;c+=ud){for(var u=o.length>=ud?o.slice(c,c+ud):o,d=[],h=0;h<u.length;++h){var f=u.charCodeAt(h);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||s===f2.RFC1738&&(f===40||f===41)){d[d.length]=u.charAt(h);continue}if(f<128){d[d.length]=Ar[f];continue}if(f<2048){d[d.length]=Ar[192|f>>6]+Ar[128|f&63];continue}if(f<55296||f>=57344){d[d.length]=Ar[224|f>>12]+Ar[128|f>>6&63]+Ar[128|f&63];continue}h+=1,f=65536+((f&1023)<<10|u.charCodeAt(h)&1023),d[d.length]=Ar[240|f>>18]+Ar[128|f>>12&63]+Ar[128|f>>6&63]+Ar[128|f&63]}a+=d.join("")}return a},_2=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],a=Object.keys(o),c=0;c<a.length;++c){var u=a[c],d=o[u];typeof d=="object"&&d!==null&&n.indexOf(d)===-1&&(r.push({obj:o,prop:u}),n.push(d))}return m2(r),e},w2=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},S2=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},b2=function(e,r,n,i){if(yc(e)){var s=Xh(e)+1;return e[s]=r,k_(e,s),e}var o=[].concat(e,r);return o.length>n?C_(zp(o,{plainObjects:i}),o.length-1):o},E2=function(e,r){if(mi(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},P_={arrayToObject:zp,assign:x2,combine:b2,compact:_2,decode:y2,encode:v2,isBuffer:S2,isOverflow:yc,isRegExp:w2,maybeMap:E2,merge:g2},R_=A_,Ml=P_,Ho=Up,T2=Object.prototype.hasOwnProperty,I_={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Br=Array.isArray,A2=Array.prototype.push,M_=function(t,e){A2.apply(t,Br(e)?e:[e])},C2=Date.prototype.toISOString,px=Ho.default,it={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Ml.encode,encodeValuesOnly:!1,filter:void 0,format:px,formatter:Ho.formatters[px],indices:!1,serializeDate:function(e){return C2.call(e)},skipNulls:!1,strictNullHandling:!1},k2=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},dd={},P2=function t(e,r,n,i,s,o,a,c,u,d,h,f,p,m,v,_,y,x){for(var g=e,w=x,T=0,A=!1;(w=w.get(dd))!==void 0&&!A;){var C=w.get(e);if(T+=1,typeof C<"u"){if(C===T)throw new RangeError("Cyclic object value");A=!0}typeof w.get(dd)>"u"&&(T=0)}if(typeof d=="function"?g=d(r,g):g instanceof Date?g=p(g):n==="comma"&&Br(g)&&(g=Ml.maybeMap(g,function(R){return R instanceof Date?p(R):R})),g===null){if(o)return u&&!_?u(r,it.encoder,y,"key",m):r;g=""}if(k2(g)||Ml.isBuffer(g)){if(u){var b=_?r:u(r,it.encoder,y,"key",m);return[v(b)+"="+v(u(g,it.encoder,y,"value",m))]}return[v(r)+"="+v(String(g))]}var I=[];if(typeof g>"u")return I;var N;if(n==="comma"&&Br(g))_&&u&&(g=Ml.maybeMap(g,u)),N=[{value:g.length>0?g.join(",")||null:void 0}];else if(Br(d))N=d;else{var L=Object.keys(g);N=h?L.sort(h):L}var D=c?String(r).replace(/\./g,"%2E"):String(r),P=i&&Br(g)&&g.length===1?D+"[]":D;if(s&&Br(g)&&g.length===0)return P+"[]";for(var O=0;O<N.length;++O){var z=N[O],H=typeof z=="object"&&z&&typeof z.value<"u"?z.value:g[z];if(!(a&&H===null)){var W=f&&c?String(z).replace(/\./g,"%2E"):String(z),k=Br(g)?typeof n=="function"?n(P,W):P:P+(f?"."+W:"["+W+"]");x.set(e,T);var U=R_();U.set(dd,x),M_(I,t(H,k,n,i,s,o,a,c,n==="comma"&&_&&Br(g)?null:u,d,h,f,p,m,v,_,y,U))}}return I},R2=function(e){if(!e)return it;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||it.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Ho.default;if(typeof e.format<"u"){if(!T2.call(Ho.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=Ho.formatters[n],s=it.filter;(typeof e.filter=="function"||Br(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in I_?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=it.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:it.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:it.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:it.allowEmptyArrays,arrayFormat:o,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:it.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?it.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:it.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:it.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:it.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:it.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:it.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:it.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:it.strictNullHandling}},I2=function(t,e){var r=t,n=R2(e),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):Br(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var a=I_[n.arrayFormat],c=a==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var u=R_(),d=0;d<i.length;++d){var h=i[d],f=r[h];n.skipNulls&&f===null||M_(o,P2(f,h,a,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var p=o.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),p.length>0?m+p:""},Kn=P_,jl=Object.prototype.hasOwnProperty,mx=Array.isArray,Ke={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Kn.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},M2=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},j_=function(t,e,r){if(t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&r>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return t},j2="utf8=%26%2310003%3B",B2="utf8=%E2%9C%93",N2=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,r.throwOnLimitExceeded?s+1:s);if(r.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,c,u=r.charset;if(r.charsetSentinel)for(c=0;c<o.length;++c)o[c].indexOf("utf8=")===0&&(o[c]===B2?u="utf-8":o[c]===j2&&(u="iso-8859-1"),a=c,c=o.length);for(c=0;c<o.length;++c)if(c!==a){var d=o[c],h=d.indexOf("]="),f=h===-1?d.indexOf("="):h+1,p,m;if(f===-1?(p=r.decoder(d,Ke.decoder,u,"key"),m=r.strictNullHandling?null:""):(p=r.decoder(d.slice(0,f),Ke.decoder,u,"key"),p!==null&&(m=Kn.maybeMap(j_(d.slice(f+1),r,mx(n[p])?n[p].length:0),function(_){return r.decoder(_,Ke.decoder,u,"value")}))),m&&r.interpretNumericEntities&&u==="iso-8859-1"&&(m=M2(String(m))),d.indexOf("[]=")>-1&&(m=mx(m)?[m]:m),p!==null){var v=jl.call(n,p);v&&r.duplicates==="combine"?n[p]=Kn.combine(n[p],m,r.arrayLimit,r.plainObjects):(!v||r.duplicates==="last")&&(n[p]=m)}}return n},F2=function(t,e,r,n){var i=0;if(t.length>0&&t[t.length-1]==="[]"){var s=t.slice(0,-1).join("");i=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=n?e:j_(e,r,i),a=t.length-1;a>=0;--a){var c,u=t[a];if(u==="[]"&&r.parseArrays)Kn.isOverflow(o)?c=o:c=r.allowEmptyArrays&&(o===""||r.strictNullHandling&&o===null)?[]:Kn.combine([],o,r.arrayLimit,r.plainObjects);else{c=r.plainObjects?{__proto__:null}:{};var d=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,h=r.decodeDotInKeys?d.replace(/%2E/g,"."):d,f=parseInt(h,10);!r.parseArrays&&h===""?c={0:o}:!isNaN(f)&&u!==h&&String(f)===h&&f>=0&&r.parseArrays&&f<=r.arrayLimit?(c=[],c[f]=o):h!=="__proto__"&&(c[h]=o)}o=c}return o},L2=function(e,r){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e;if(r.depth<=0)return!r.plainObjects&&jl.call(Object.prototype,n)&&!r.allowPrototypes?void 0:[n];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(n),a=o?n.slice(0,o.index):n,c=[];if(a){if(!r.plainObjects&&jl.call(Object.prototype,a)&&!r.allowPrototypes)return;c.push(a)}for(var u=0;(o=s.exec(n))!==null&&u<r.depth;){u+=1;var d=o[1].slice(1,-1);if(!r.plainObjects&&jl.call(Object.prototype,d)&&!r.allowPrototypes)return;c.push(o[1])}if(o){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");c.push("["+n.slice(o.index)+"]")}return c},D2=function(e,r,n,i){if(e){var s=L2(e,n);if(s)return F2(s,r,n,i)}},O2=function(e){if(!e)return Ke;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=typeof e.charset>"u"?Ke.charset:e.charset,n=typeof e.duplicates>"u"?Ke.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Ke.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ke.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Ke.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Ke.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Ke.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ke.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Ke.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Ke.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Ke.decoder,delimiter:typeof e.delimiter=="string"||Kn.isRegExp(e.delimiter)?e.delimiter:Ke.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Ke.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Ke.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Ke.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Ke.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:Ke.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ke.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},U2=function(t,e){var r=O2(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?{__proto__:null}:{};for(var n=typeof t=="string"?N2(t,r):t,i=r.plainObjects?{__proto__:null}:{},s=Object.keys(n),o=0;o<s.length;++o){var a=s[o],c=D2(a,n[a],r,typeof t=="string");i=Kn.merge(i,c,r)}return r.allowSparse===!0?i:Kn.compact(i)},z2=I2,G2=U2,H2=Up,$2={formats:H2,parse:G2,stringify:z2},V2=$T;function on(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var W2=/^([a-z0-9.+-]+:)/i,X2=/:[0-9]*$/,Y2=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,K2=["<",">",'"',"`"," ","\r",`
`,"	"],q2=["{","}","|","\\","^","`"].concat(K2),Yh=["'"].concat(q2),gx=["%","/","?",";","#"].concat(Yh),xx=["/","?","#"],J2=255,yx=/^[+a-z0-9A-Z_-]{0,63}$/,Q2=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Z2={javascript:!0,"javascript:":!0},Kh={javascript:!0,"javascript:":!0},Ms={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},qh=$2;function ek(t,e,r){if(t&&typeof t=="object"&&t instanceof on)return t;var n=new on;return n.parse(t,e,r),n}on.prototype.parse=function(t,e,r){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var a=t;if(a=a.trim(),!r&&t.split("#").length===1){var c=Y2.exec(a);if(c)return this.path=a,this.href=a,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=qh.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=W2.exec(a);if(u){u=u[0];var d=u.toLowerCase();this.protocol=d,a=a.substr(u.length)}if(r||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var h=a.substr(0,2)==="//";h&&!(u&&Kh[u])&&(a=a.substr(2),this.slashes=!0)}if(!Kh[u]&&(h||u&&!Ms[u])){for(var f=-1,p=0;p<xx.length;p++){var m=a.indexOf(xx[p]);m!==-1&&(f===-1||m<f)&&(f=m)}var v,_;f===-1?_=a.lastIndexOf("@"):_=a.lastIndexOf("@",f),_!==-1&&(v=a.slice(0,_),a=a.slice(_+1),this.auth=decodeURIComponent(v)),f=-1;for(var p=0;p<gx.length;p++){var m=a.indexOf(gx[p]);m!==-1&&(f===-1||m<f)&&(f=m)}f===-1&&(f=a.length),this.host=a.slice(0,f),a=a.slice(f),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var x=this.hostname.split(/\./),p=0,g=x.length;p<g;p++){var w=x[p];if(w&&!w.match(yx)){for(var T="",A=0,C=w.length;A<C;A++)w.charCodeAt(A)>127?T+="x":T+=w[A];if(!T.match(yx)){var b=x.slice(0,p),I=x.slice(p+1),N=w.match(Q2);N&&(b.push(N[1]),I.unshift(N[2])),I.length&&(a="/"+I.join(".")+a),this.hostname=b.join(".");break}}}this.hostname.length>J2?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=V2.toASCII(this.hostname));var L=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+L,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Z2[d])for(var p=0,g=Yh.length;p<g;p++){var P=Yh[p];if(a.indexOf(P)!==-1){var O=encodeURIComponent(P);O===P&&(O=escape(P)),a=a.split(P).join(O)}}var z=a.indexOf("#");z!==-1&&(this.hash=a.substr(z),a=a.slice(0,z));var H=a.indexOf("?");if(H!==-1?(this.search=a.substr(H),this.query=a.substr(H+1),e&&(this.query=qh.parse(this.query)),a=a.slice(0,H)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Ms[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",W=this.search||"";this.path=L+W}return this.href=this.format(),this};on.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=qh.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Ms[e])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+r+o+n};on.prototype.resolve=function(t){return this.resolveObject(ek(t,!1,!0)).format()};on.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new on;e.parse(t,!1,!0),t=e}for(var r=new on,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var c=o[a];c!=="protocol"&&(r[c]=t[c])}return Ms[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Ms[t.protocol]){for(var u=Object.keys(t),d=0;d<u.length;d++){var h=u[d];r[h]=t[h]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!Kh[t.protocol]){for(var g=(t.pathname||"").split("/");g.length&&!(t.host=g.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),r.pathname=g.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var f=r.pathname||"",p=r.search||"";r.path=f+p}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&r.pathname.charAt(0)==="/",v=t.host||t.pathname&&t.pathname.charAt(0)==="/",_=v||m||r.host&&t.pathname,y=_,x=r.pathname&&r.pathname.split("/")||[],g=t.pathname&&t.pathname.split("/")||[],w=r.protocol&&!Ms[r.protocol];if(w&&(r.hostname="",r.port=null,r.host&&(x[0]===""?x[0]=r.host:x.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(g[0]===""?g[0]=t.host:g.unshift(t.host)),t.host=null),_=_&&(g[0]===""||x[0]==="")),v)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,x=g;else if(g.length)x||(x=[]),x.pop(),x=x.concat(g),r.search=t.search,r.query=t.query;else if(t.search!=null){if(w){r.host=x.shift(),r.hostname=r.host;var T=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;T&&(r.auth=T.shift(),r.hostname=T.shift(),r.host=r.hostname)}return r.search=t.search,r.query=t.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!x.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var A=x.slice(-1)[0],C=(r.host||t.host||x.length>1)&&(A==="."||A==="..")||A==="",b=0,I=x.length;I>=0;I--)A=x[I],A==="."?x.splice(I,1):A===".."?(x.splice(I,1),b++):b&&(x.splice(I,1),b--);if(!_&&!y)for(;b--;b)x.unshift("..");_&&x[0]!==""&&(!x[0]||x[0].charAt(0)!=="/")&&x.unshift(""),C&&x.join("/").substr(-1)!=="/"&&x.push("");var N=x[0]===""||x[0]&&x[0].charAt(0)==="/";if(w){r.hostname=N?"":x.length?x.shift():"",r.host=r.hostname;var T=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;T&&(r.auth=T.shift(),r.hostname=T.shift(),r.host=r.hostname)}return _=_||r.host&&x.length,_&&!N&&x.unshift(""),x.length>0?r.pathname=x.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};on.prototype.parseHost=function(){var t=this.host,e=X2.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const vx={};function Te(t,e,r=3){if(vx[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),vx[e]=!0}function ur(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function po(t){return t.split("?")[0].split("#")[0]}function tk(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function rk(t,e,r){return t.replace(new RegExp(tk(e),"g"),r)}function nk(t,e){let r="",n=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const c=r.lastIndexOf("/");if(c!==r.length-1){c===-1?(r="",n=0):(r=r.slice(0,c),n=r.length-1-r.lastIndexOf("/")),i=a,s=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=a,s=0;continue}}}else r.length>0?r+=`/${t.slice(i+1,a)}`:r=t.slice(i+1,a),n=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return r}const ht={toPosix(t){return rk(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){ur(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const r=/^[^/:]+:\/{0,2}/.exec(t);return r?r[0]:""},toAbsolute(t,e,r){if(ur(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const n=po(this.toPosix(e??ee.ADAPTER.getBaseUrl())),i=po(this.toPosix(r??this.rootname(n)));return t=this.toPosix(t),t.startsWith("/")?ht.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(ur(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=nk(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return ur(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(ur(n),n.length>0)if(e===void 0)e=n;else{const i=t[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(ur(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){n=a;break}}else i=!1;return n===-1?r?"/":this.isUrl(o)?s+t:s:r&&n===1?"//":s+t.slice(0,n)},rootname(t){ur(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){ur(t),e&&ur(e),t=po(this.toPosix(t));let r=0,n=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const c=t.charCodeAt(s);if(c===47){if(!i){r=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return r===n?n=a:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){r=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){ur(t),t=po(this.toPosix(t));let e=-1,r=0,n=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){r=o+1;break}continue}n===-1&&(i=!1,n=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){ur(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=po(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let i;e.root=this.rootname(t),n||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,a=-1,c=!0,u=t.length-1,d=0;for(;u>=i;--u){if(r=t.charCodeAt(u),r===47){if(!c){o=u+1;break}continue}a===-1&&(c=!1,a=u+1),r===46?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||a===-1||d===0||d===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&n?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&n?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let hd;async function ik(){return hd??(hd=(async()=>{var s;const t=document.createElement("canvas").getContext("webgl");if(!t)return Nt.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return Nt.UNPACK;const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(s=t.getExtension("WEBGL_lose_context"))==null||s.loseContext(),i[0]<=i[3]?Nt.PMA:Nt.UNPACK})()),hd}let fd;function sk(){return typeof fd>"u"&&(fd=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:ee.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ee.ADAPTER.getWebGLRenderingContext())return!1;const r=ee.ADAPTER.createCanvas();let n=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,i}catch{return!1}}()),fd}var ok={grad:.9,turn:360,rad:360/(2*Math.PI)},Yr=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},ut=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},nr=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},B_=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},_x=function(t){return{r:nr(t.r,0,255),g:nr(t.g,0,255),b:nr(t.b,0,255),a:nr(t.a)}},pd=function(t){return{r:ut(t.r),g:ut(t.g),b:ut(t.b),a:ut(t.a,3)}},ak=/^#([0-9a-f]{3,8})$/i,Qa=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},N_=function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=Math.max(e,r,n),o=s-Math.min(e,r,n),a=o?s===e?(r-n)/o:s===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},F_=function(t){var e=t.h,r=t.s,n=t.v,i=t.a;e=e/360*6,r/=100,n/=100;var s=Math.floor(e),o=n*(1-r),a=n*(1-(e-s)*r),c=n*(1-(1-e+s)*r),u=s%6;return{r:255*[n,a,o,o,c,n][u],g:255*[c,n,n,a,o,o][u],b:255*[o,o,c,n,n,a][u],a:i}},wx=function(t){return{h:B_(t.h),s:nr(t.s,0,100),l:nr(t.l,0,100),a:nr(t.a)}},Sx=function(t){return{h:ut(t.h),s:ut(t.s),l:ut(t.l),a:ut(t.a,3)}},bx=function(t){return F_((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},$o=function(t){return{h:(e=N_(t)).h,s:(i=(200-(r=e.s))*(n=e.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,r,n,i},lk=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ck=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uk=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,dk=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Jh={string:[[function(t){var e=ak.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?ut(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?ut(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=uk.exec(t)||dk.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:_x({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=lk.exec(t)||ck.exec(t);if(!e)return null;var r,n,i=wx({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(ok[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return bx(i)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,i=t.a,s=i===void 0?1:i;return Yr(e)&&Yr(r)&&Yr(n)?_x({r:Number(e),g:Number(r),b:Number(n),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,i=t.a,s=i===void 0?1:i;if(!Yr(e)||!Yr(r)||!Yr(n))return null;var o=wx({h:Number(e),s:Number(r),l:Number(n),a:Number(s)});return bx(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,i=t.a,s=i===void 0?1:i;if(!Yr(e)||!Yr(r)||!Yr(n))return null;var o=function(a){return{h:B_(a.h),s:nr(a.s,0,100),v:nr(a.v,0,100),a:nr(a.a)}}({h:Number(e),s:Number(r),v:Number(n),a:Number(s)});return F_(o)},"hsv"]]},Ex=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},hk=function(t){return typeof t=="string"?Ex(t.trim(),Jh.string):typeof t=="object"&&t!==null?Ex(t,Jh.object):[null,void 0]},md=function(t,e){var r=$o(t);return{h:r.h,s:nr(r.s+100*e,0,100),l:r.l,a:r.a}},gd=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Tx=function(t,e){var r=$o(t);return{h:r.h,s:r.s,l:nr(r.l+100*e,0,100),a:r.a}},Qh=function(){function t(e){this.parsed=hk(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return ut(gd(this.rgba),2)},t.prototype.isDark=function(){return gd(this.rgba)<.5},t.prototype.isLight=function(){return gd(this.rgba)>=.5},t.prototype.toHex=function(){return e=pd(this.rgba),r=e.r,n=e.g,i=e.b,o=(s=e.a)<1?Qa(ut(255*s)):"","#"+Qa(r)+Qa(n)+Qa(i)+o;var e,r,n,i,s,o},t.prototype.toRgb=function(){return pd(this.rgba)},t.prototype.toRgbString=function(){return e=pd(this.rgba),r=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+r+", "+n+", "+i+", "+s+")":"rgb("+r+", "+n+", "+i+")";var e,r,n,i,s},t.prototype.toHsl=function(){return Sx($o(this.rgba))},t.prototype.toHslString=function(){return e=Sx($o(this.rgba)),r=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+r+", "+n+"%, "+i+"%, "+s+")":"hsl("+r+", "+n+"%, "+i+"%)";var e,r,n,i,s},t.prototype.toHsv=function(){return e=N_(this.rgba),{h:ut(e.h),s:ut(e.s),v:ut(e.v),a:ut(e.a,3)};var e},t.prototype.invert=function(){return kr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),kr(md(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),kr(md(this.rgba,-e))},t.prototype.grayscale=function(){return kr(md(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),kr(Tx(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),kr(Tx(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?kr({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):ut(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=$o(this.rgba);return typeof e=="number"?kr({h:e,s:r.s,l:r.l,a:r.a}):ut(r.h)},t.prototype.isEqual=function(e){return this.toHex()===kr(e).toHex()},t}(),kr=function(t){return t instanceof Qh?t:new Qh(t)},Ax=[],fk=function(t){t.forEach(function(e){Ax.indexOf(e)<0&&(e(Qh,Jh),Ax.push(e))})};function pk(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,c,u=n[this.toHex()];if(u)return u;if(o!=null&&o.closest){var d=this.toRgb(),h=1/0,f="black";if(!s.length)for(var p in r)s[p]=new t(r[p]).toRgb();for(var m in r){var v=(a=d,c=s[m],Math.pow(a.r-c.r,2)+Math.pow(a.g-c.g,2)+Math.pow(a.b-c.b,2));v<h&&(h=v,f=m)}return f}},e.string.push([function(o){var a=o.toLowerCase(),c=a==="transparent"?"#0000":r[a];return c?new t(c).toRgb():null},"name"])}fk([pk]);const is=class Bl{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Bl)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,r){const n=typeof e;if(n!==typeof r)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===r;if(Array.isArray(e)&&Array.isArray(r)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(r))return e.length!==r.length?!1:e.every((i,s)=>i===r[s]);if(e!==null&&r!==null){const i=Object.keys(e),s=Object.keys(r);return i.length!==s.length?!1:i.every(o=>e[o]===r[o])}return e===r}toRgba(){const[e,r,n,i]=this._components;return{r:e,g:r,b:n,a:i}}toRgb(){const[e,r,n]=this._components;return{r:e,g:r,b:n}}toRgbaString(){const[e,r,n]=this.toUint8RgbArray();return`rgba(${e},${r},${n},${this.alpha})`}toUint8RgbArray(e){const[r,n,i]=this._components;return e=e??[],e[0]=Math.round(r*255),e[1]=Math.round(n*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[r,n,i]=this._components;return e[0]=r,e[1]=n,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[r,n,i,s]=Bl.temp.setValue(e)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,r=!0){return r&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,r=!0){if(e===1)return(255<<24)+this._int;if(e===0)return r?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return r&&(n=n*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[r,n,i]=this._components;return this._components[0]=Math.round(r*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[r,n,i,s]=this._components;return e[0]=r,e[1]=n,e[2]=i,e[3]=s,e}normalize(e){let r,n,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;r=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[r,n,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[r,n,i,s=255]=e,r/=255,n/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Bl.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=kr(e);o.isValid()&&({r,g:n,b:i,a:s}=o.rgba,r/=255,n/=255,i/=255)}if(r!==void 0)this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,r,n]=this._components;this._int=(e*255<<16)+(r*255<<8)+(n*255|0)}_clamp(e,r=0,n=1){return typeof e=="number"?Math.min(Math.max(e,r),n):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,r),n)}),e)}};is.shared=new is,is.temp=new is,is.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Oe=is;function mk(t){return Te("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Oe.shared.setValue(t).toHex()}function gk(t){return Te("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Oe.shared.setValue(t).toNumber()}function xk(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[me.NORMAL_NPM]=me.NORMAL,t[me.ADD_NPM]=me.ADD,t[me.SCREEN_NPM]=me.SCREEN,e[me.NORMAL]=me.NORMAL_NPM,e[me.ADD]=me.ADD_NPM,e[me.SCREEN]=me.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}const L_=xk();function D_(t,e){return L_[e?1:0][t]}function yk(t,e=null){const r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let n=0,i=0;n<r;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function O_(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function vc(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function Cx(t){return!(t&t-1)&&!!t}function kx(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function js(t,e,r){const n=t.length;let i;if(e>=n||r===0)return;r=e+r>n?n-e:r;const s=n-r;for(i=e;i<s;++i)t[i]=t[i+r];t.length=s}function Nn(t){return t===0?0:t<0?-1:1}let vk=0;function Ii(){return++vk}const Zh=class{constructor(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Zh.EMPTY=new Zh(0,0,0,0);let Px=Zh;const Rx={},Pr=Object.create(null),wn=Object.create(null);class _k{constructor(e,r,n){this._canvas=ee.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||ee.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Ix(t,e,r){for(let n=0,i=4*r*e;n<e;++n,i+=4)if(t[i+3]!==0)return!1;return!0}function Mx(t,e,r,n,i){const s=4*e;for(let o=n,a=n*s+4*r;o<=i;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function wk(t){const{width:e,height:r}=t,n=t.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,e,r).data;let s=0,o=0,a=e-1,c=r-1;for(;o<r&&Ix(i,e,o);)++o;if(o===r)return Px.EMPTY;for(;Ix(i,e,c);)--c;for(;Mx(i,e,s,o,c);)++s;for(;Mx(i,e,a,o,c);)--a;return++a,++c,new Px(s,o,a,c)}function Sk(t){const e=wk(t),{width:r,height:n}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,r,n)}return{width:r,height:n,data:i}}function bk(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const r=new URL(t,document.baseURI);return r.hostname!==e.hostname||r.port!==e.port||r.protocol!==e.protocol?"anonymous":""}function dn(t,e=1){var n;const r=(n=ee.RETINA_PREFIX)==null?void 0:n.exec(t);return r?parseFloat(r[1]):e}var Q=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(Q||{});const ef=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},jx=(t,e)=>ef(t).priority??e,se={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(ef).forEach(e=>{e.type.forEach(r=>{var n,i;return(i=(n=this._removeHandlers)[r])==null?void 0:i.call(n,e)})}),this},add(...t){return t.map(ef).forEach(e=>{e.type.forEach(r=>{var s,o;const n=this._addHandlers,i=this._queue;n[r]?(s=n[r])==null||s.call(n,e):(i[r]=i[r]||[],(o=i[r])==null||o.push(e))})}),this},handle(t,e,r){var o;const n=this._addHandlers,i=this._removeHandlers;if(n[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,i[t]=r;const s=this._queue;return s[t]&&((o=s[t])==null||o.forEach(a=>e(a)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{r.name&&(e[r.name]=r.ref)},r=>{r.name&&delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,s)=>jx(s,r)-jx(i,r)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}};class tf{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const Ek=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Tk(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function Ak(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=Ek.replace(/%forloop%/gi,Tk(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}const xd=0,yd=1,vd=2,_d=3,wd=4,Sd=5;class Vr{constructor(){this.data=0,this.blendMode=me.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<xd)}set blend(e){!!(this.data&1<<xd)!==e&&(this.data^=1<<xd)}get offsets(){return!!(this.data&1<<yd)}set offsets(e){!!(this.data&1<<yd)!==e&&(this.data^=1<<yd)}get culling(){return!!(this.data&1<<vd)}set culling(e){!!(this.data&1<<vd)!==e&&(this.data^=1<<vd)}get depthTest(){return!!(this.data&1<<_d)}set depthTest(e){!!(this.data&1<<_d)!==e&&(this.data^=1<<_d)}get depthMask(){return!!(this.data&1<<Sd)}set depthMask(e){!!(this.data&1<<Sd)!==e&&(this.data^=1<<Sd)}get clockwiseFrontFace(){return!!(this.data&1<<wd)}set clockwiseFrontFace(e){!!(this.data&1<<wd)!==e&&(this.data^=1<<wd)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==me.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Vr;return e.depthTest=!1,e.blend=!0,e}}Vr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const rf=[];function U_(t,e){if(!t)return null;let r="";if(typeof t=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(let n=rf.length-1;n>=0;--n){const i=rf[n];if(i.test&&i.test(t,r))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class _r{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,n,i,s,o,a,c){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:d}=this;this._aliasCount++;for(let h=0,f=d.length;h<f;h++)d[h][u](e,r,n,i,s,o,a,c);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(_r.prototype,{dispatch:{value:_r.prototype.emit},run:{value:_r.prototype.emit}});class ma{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new _r("setRealSize"),this.onUpdate=new _r("update"),this.onError=new _r("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}}class iu extends ma{constructor(e,r){const{width:n,height:i}=r||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=e,this.unpackAlignment=r.unpackAlignment??4}upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Nt.UNPACK);const s=r.realWidth,o=r.realHeight;return n.width===s&&n.height===o?i.texSubImage2D(r.target,0,0,0,s,o,r.format,n.type,this.data):(n.width=s,n.height=o,i.texImage2D(r.target,0,n.internalFormat,s,o,0,r.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const Ck={scaleMode:en.NEAREST,alphaMode:Nt.NPM},nf=class ss extends Sa{constructor(e=null,r=null){super(),r=Object.assign({},ss.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:c,wrapMode:u,format:d,type:h,target:f,resolution:p,resourceOptions:m}=r;e&&!(e instanceof ma)&&(e=U_(e,m),e.internal=!0),this.resolution=p||ee.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((c||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=u,this._scaleMode=o,this.format=d,this.type=h,this.target=f,this.alphaMode=n,this.uid=Ii(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,r){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,n=!0),n&&this.dirtyStyleId++,this}setSize(e,r,n){return n=n||this.resolution,this.setRealSize(e*n,r*n,n)}setRealSize(e,r,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(r)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Cx(this.realWidth)&&Cx(this.realHeight)}setResolution(e){const r=this.resolution;return r===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*r)/e,this.height=Math.round(this.height*r)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete wn[this.cacheId],delete Pr[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),ss.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,r,n=ee.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Ii()}`}s=e._pixiId}let o=wn[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new ss(e,r),o.cacheId=s,ss.addToCache(o,s)),o}static fromBuffer(e,r,n,i){e=e||new Float32Array(r*n*4);const s=new iu(e,{width:r,height:n,...i==null?void 0:i.resourceOptions});let o,a;return e instanceof Float32Array?(o=X.RGBA,a=ce.FLOAT):e instanceof Int32Array?(o=X.RGBA_INTEGER,a=ce.INT):e instanceof Uint32Array?(o=X.RGBA_INTEGER,a=ce.UNSIGNED_INT):e instanceof Int16Array?(o=X.RGBA_INTEGER,a=ce.SHORT):e instanceof Uint16Array?(o=X.RGBA_INTEGER,a=ce.UNSIGNED_SHORT):e instanceof Int8Array?(o=X.RGBA,a=ce.BYTE):(o=X.RGBA,a=ce.UNSIGNED_BYTE),s.internal=!0,new ss(s,Object.assign({},Ck,{type:a,format:o},i))}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),wn[r]&&wn[r]!==e&&console.warn(`BaseTexture added to the cache with an id [${r}] that already had an entry`),wn[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=wn[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete wn[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)delete wn[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}};nf.defaultOptions={mipmap:Hr.POW2,anisotropicLevel:0,scaleMode:en.LINEAR,wrapMode:Wn.CLAMP,alphaMode:Nt.UNPACK,target:Rs.TEXTURE_2D,format:X.RGBA,type:ce.UNSIGNED_BYTE},nf._globalBatch=0;let ve=nf;class sf{constructor(){this.texArray=null,this.blend=0,this.type=Dr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let kk=0;class Qe{constructor(e,r=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=r,this.id=kk++,this.disposeRunner=new _r("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?zr.ELEMENT_ARRAY_BUFFER:zr.ARRAY_BUFFER}get index(){return this.type===zr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Qe(e)}}class _c{constructor(e,r=0,n=!1,i=ce.FLOAT,s,o,a,c=1){this.buffer=e,this.size=r,this.normalized=n,this.type=i,this.stride=s,this.start=o,this.instance=a,this.divisor=c}destroy(){this.buffer=null}static from(e,r,n,i,s){return new _c(e,r,n,i,s)}}const Pk={Float32Array,Uint32Array,Int32Array,Uint8Array};function Rk(t,e){let r=0,n=0;const i={};for(let c=0;c<t.length;c++)n+=e[c],r+=t[c].length;const s=new ArrayBuffer(r*4);let o=null,a=0;for(let c=0;c<t.length;c++){const u=e[c],d=t[c],h=O_(d);i[h]||(i[h]=new Pk[h](s)),o=i[h];for(let f=0;f<d.length;f++){const p=(f/u|0)*n+a,m=f%u;o[p+m]=d[f]}a+=u}return new Float32Array(s)}const Bx={5126:4,5123:2,5121:1};let Ik=0;const Mk={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class qn{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=Ik++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new _r("disposeGeometry"),this.refCount=0}addAttribute(e,r,n=0,i=!1,s,o,a,c=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof Qe||(r instanceof Array&&(r=new Float32Array(r)),r=new Qe(r));const u=e.split("|");if(u.length>1){for(let h=0;h<u.length;h++)this.addAttribute(u[h],r,n,i,s);return this}let d=this.buffers.indexOf(r);return d===-1&&(this.buffers.push(r),d=this.buffers.length-1),this.attributes[e]=new _c(d,n,i,s,o,a,c),this.instanced=this.instanced||c,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Qe||(e instanceof Array&&(e=new Uint16Array(e)),e=new Qe(e)),e.type=zr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],r=[],n=new Qe;let i;for(i in this.attributes){const s=this.attributes[i],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*Bx[s.type]/4),s.buffer=0}for(n.data=Rk(e,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new qn;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new Qe(this.buffers[r].data.slice(0));for(const r in this.attributes){const n=this.attributes[r];e.attributes[r]=new _c(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=zr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const r=new qn,n=[],i=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let c=0;c<o.buffers.length;c++)i[c]=i[c]||0,i[c]+=o.buffers[c].data.length,s[c]=0}for(let a=0;a<o.buffers.length;a++)n[a]=new Mk[O_(o.buffers[a].data)](i[a]),r.buffers[a]=new Qe(n[a]);for(let a=0;a<e.length;a++){o=e[a];for(let c=0;c<o.buffers.length;c++)n[c].set(o.buffers[c].data,s[c]),s[c]+=o.buffers[c].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=zr.ELEMENT_ARRAY_BUFFER;let a=0,c=0,u=0,d=0;for(let h=0;h<o.buffers.length;h++)if(o.buffers[h]!==o.indexBuffer){d=h;break}for(const h in o.attributes){const f=o.attributes[h];(f.buffer|0)===d&&(c+=f.size*Bx[f.type]/4)}for(let h=0;h<e.length;h++){const f=e[h].indexBuffer.data;for(let p=0;p<f.length;p++)r.indexBuffer.data[p+u]+=a;a+=e[h].buffers[d].data.length/c,u+=f.length}}return r}}class z_ extends qn{constructor(e=!1){super(),this._buffer=new Qe(null,e,!1),this._indexBuffer=new Qe(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,ce.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,ce.FLOAT).addAttribute("aColor",this._buffer,4,!0,ce.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,ce.FLOAT).addIndex(this._indexBuffer)}}const wc=Math.PI*2,jk=180/Math.PI,Bk=Math.PI/180;var mt=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(mt||{});class Pe{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new Pe(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}}Pe.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Za=[new Pe,new Pe,new Pe,new Pe];class we{constructor(e=0,r=0,n=0,i=0){this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(i),this.type=mt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new we(0,0,0,0)}clone(){return new we(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){const b=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=b)return!1;const I=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>I}const n=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=n||o<=s)return!1;const a=Za[0].set(e.left,e.top),c=Za[1].set(e.left,e.bottom),u=Za[2].set(e.right,e.top),d=Za[3].set(e.right,e.bottom);if(u.x<=a.x||c.y<=a.y)return!1;const h=Math.sign(r.a*r.d-r.b*r.c);if(h===0||(r.apply(a,a),r.apply(c,c),r.apply(u,u),r.apply(d,d),Math.max(a.x,c.x,u.x,d.x)<=n||Math.min(a.x,c.x,u.x,d.x)>=i||Math.max(a.y,c.y,u.y,d.y)<=s||Math.min(a.y,c.y,u.y,d.y)>=o))return!1;const f=h*(c.y-a.y),p=h*(a.x-c.x),m=f*n+p*s,v=f*i+p*s,_=f*n+p*o,y=f*i+p*o;if(Math.max(m,v,_,y)<=f*a.x+p*a.y||Math.min(m,v,_,y)>=f*d.x+p*d.y)return!1;const x=h*(a.y-u.y),g=h*(u.x-a.x),w=x*n+g*s,T=x*i+g*s,A=x*n+g*o,C=x*i+g*o;return!(Math.max(w,T,A,C)<=x*a.x+g*a.y||Math.min(w,T,A,C)>=x*d.x+g*d.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,i=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=i,this.height=s-i,this}}we.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class su{constructor(e=0,r=0,n=0){this.x=e,this.y=r,this.radius=n,this.type=mt.CIRC}clone(){return new su(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,s=this.y-r;return i*=i,s*=s,i+s<=n}getBounds(){return new we(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}su.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class ou{constructor(e=0,r=0,n=0,i=0){this.x=e,this.y=r,this.width=n,this.height=i,this.type=mt.ELIP}clone(){return new ou(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,i=(r-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new we(this.x-this.width,this.y-this.height,this.width,this.height)}}ou.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class bi{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let i=0,s=r.length;i<s;i++)n.push(r[i].x,r[i].y);r=n}this.points=r,this.type=mt.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),r=new bi(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let n=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],c=this.points[s*2+1],u=this.points[o*2],d=this.points[o*2+1];c>r!=d>r&&e<(u-a)*((r-c)/(d-c))+a&&(n=!n)}return n}}bi.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class au{constructor(e=0,r=0,n=0,i=0,s=20){this.x=e,this.y=r,this.width=n,this.height=i,this.radius=s,this.type=mt.RREC}clone(){return new au(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),s=r-(this.y+n);const o=n*n;if(i*i+s*s<=o||(i=e-(this.x+this.width-n),i*i+s*s<=o)||(s=r-(this.y+this.height-n),i*i+s*s<=o)||(i=e-(this.x+n),i*i+s*s<=o))return!0}return!1}}au.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class ze{constructor(e=1,r=0,n=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,i,s,o){return this.a=e,this.b=r,this.c=n,this.d=i,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new Pe;const n=e.x,i=e.y;return r.x=this.a*n+this.c*i+this.tx,r.y=this.b*n+this.d*i+this.ty,r}applyInverse(e,r){r=r||new Pe;const n=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return r.x=this.d*n*i+-this.c*n*s+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*s+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*r-this.b*n,this.b=i*n+this.b*r,this.c=s*r-this.d*n,this.d=s*n+this.d*r,this.tx=o*r-this.ty*n,this.ty=o*n+this.ty*r,this}append(e){const r=this.a,n=this.b,i=this.c,s=this.d;return this.a=e.a*r+e.b*i,this.b=e.a*n+e.b*s,this.c=e.c*r+e.d*i,this.d=e.c*n+e.d*s,this.tx=e.tx*r+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}setTransform(e,r,n,i,s,o,a,c,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-c)*o,this.d=Math.cos(a-c)*o,this.tx=e-(n*this.a+i*this.c),this.ty=r-(n*this.b+i*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),c=Math.atan2(n,r),u=Math.abs(a+c);return u<1e-5||Math.abs(wc-u)<1e-5?(e.rotation=c,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=c),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*r+o.y*i),e.position.y=this.ty+(o.x*n+o.y*s),e}invert(){const e=this.a,r=this.b,n=this.c,i=this.d,s=this.tx,o=e*i-r*n;return this.a=i/o,this.b=-r/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-i*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ze;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new ze}static get TEMP_MATRIX(){return new ze}}ze.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const ci=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ui=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],di=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],hi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],of=[],G_=[],el=Math.sign;function Nk(){for(let t=0;t<16;t++){const e=[];of.push(e);for(let r=0;r<16;r++){const n=el(ci[t]*ci[r]+di[t]*ui[r]),i=el(ui[t]*ci[r]+hi[t]*ui[r]),s=el(ci[t]*di[r]+di[t]*hi[r]),o=el(ui[t]*di[r]+hi[t]*hi[r]);for(let a=0;a<16;a++)if(ci[a]===n&&ui[a]===i&&di[a]===s&&hi[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new ze;e.set(ci[t],ui[t],di[t],hi[t],0,0),G_.push(e)}}Nk();const He={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>ci[t],uY:t=>ui[t],vX:t=>di[t],vY:t=>hi[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>of[t][e],sub:(t,e)=>of[t][He.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?He.S:He.N:Math.abs(e)*2<=Math.abs(t)?t>0?He.E:He.W:e>0?t>0?He.SE:He.SW:t>0?He.NE:He.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const i=G_[He.inv(e)];i.tx=r,i.ty=n,t.append(i)}};class rn{constructor(e,r,n=0,i=0){this._x=n,this._y=i,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new rn(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}rn.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const af=class{constructor(){this.worldTransform=new ze,this.localTransform=new ze,this.position=new rn(this.onChange,this,0,0),this.scale=new rn(this.onChange,this,1,1),this.pivot=new rn(this.onChange,this,0,0),this.skew=new rn(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};af.IDENTITY=new af;let Gp=af;Gp.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var Fk=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Lk=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Nx(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function bd(t){const e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function H_(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return bd(2*e);case"bvec3":return bd(3*e);case"bvec4":return bd(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Bs=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],Dk={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Ok={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Uk(t,e){var n;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const s=e[i];if(!s){((n=t.uniforms[i])==null?void 0:n.group)===!0&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let a=!1;for(let c=0;c<Bs.length;c++)if(Bs[c].test(s,o)){r.push(Bs[c].code(i,o)),a=!0;break}if(!a){const c=(s.size===1&&!s.isArray?Dk:Ok)[s.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${c};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const $_={};let Qi=$_;function zk(){if(Qi===$_||Qi!=null&&Qi.isContextLost()){const t=ee.ADAPTER.createCanvas();let e;ee.PREFER_ENV>=Di.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Qi=e}return Qi}let tl;function Gk(){if(!tl){tl=rr.MEDIUM;const t=zk();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(tl=e.precision?rr.HIGH:rr.MEDIUM)}}return tl}function Fx(t,e){const r=t.getShaderSource(e).split(`
`).map((u,d)=>`${d}: ${u}`),n=t.getShaderInfoLog(e),i=n.split(`
`),s={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{r[u-1]=`%c${r[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=r.join(`
`);a[0]=c,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Hk(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||Fx(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||Fx(t,n),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const $k={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function V_(t){return $k[t]}let rl=null;const Lx={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function W_(t,e){if(!rl){const r=Object.keys(Lx);rl={};for(let n=0;n<r.length;++n){const i=r[n];rl[t[i]]=Lx[i]}}return rl[e]}function Dx(t,e,r){if(t.substring(0,9)!=="precision"){let n=e;return e===rr.HIGH&&r!==rr.HIGH&&(n=rr.MEDIUM),`precision ${n} float;
${t}`}else if(r!==rr.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let mo;function Vk(){if(typeof mo=="boolean")return mo;try{mo=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{mo=!1}return mo}let Wk=0;const nl={},lf=class os{constructor(e,r,n="pixi-shader",i={}){this.extra={},this.id=Wk++,this.vertexSrc=e||os.defaultVertexSrc,this.fragmentSrc=r||os.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),nl[n]?(nl[n]++,n+=`-${nl[n]}`):nl[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=Dx(this.vertexSrc,os.defaultVertexPrecision,rr.HIGH),this.fragmentSrc=Dx(this.fragmentSrc,os.defaultFragmentPrecision,Gk())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Lk}static get defaultFragmentSrc(){return Fk}static from(e,r,n){const i=e+r;let s=Rx[i];return s||(Rx[i]=s=new os(e,r,n)),s}};lf.defaultVertexPrecision=rr.HIGH,lf.defaultFragmentPrecision=tn.apple.device?rr.HIGH:rr.MEDIUM;let nn=lf,Xk=0;class wr{constructor(e,r,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Xk++,this.static=!!r,this.ubo=!!n,e instanceof Qe?(this.buffer=e,this.buffer.type=zr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Qe(new Float32Array(1)),this.buffer.type=zr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,n){if(!this.ubo)this.uniforms[e]=new wr(r,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,n){return new wr(e,r,n)}static uboFrom(e,r){return new wr(e,r??!0,!0)}}class Gr{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof wr?this.uniformGroup=r:this.uniformGroup=new wr(r):this.uniformGroup=new wr({}),this.disposeRunner=new _r("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(const n in r.uniforms){const i=r.uniforms[n];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,n){const i=nn.from(e,r);return new Gr(i,n)}}class Yk{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let s=0;s<e;s++)n[s]=s;this.defaultGroupCache[e]=wr.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new nn(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new ze,default:this.defaultGroupCache[e]};return new Gr(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let n=0;n<e;n++)n>0&&(r+=`
else `),n<e-1&&(r+=`if(vTextureId < ${n}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class cf{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function Kk(){return!tn.apple.device}function qk(t){let e=!0;const r=ee.ADAPTER.getNavigator();if(tn.tablet||tn.phone){if(tn.apple.device){const n=r.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(tn.android.device){const n=r.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?t:4}class lu{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var Jk=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Qk=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const So=class hr extends lu{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=z_,this.vertexSize=6,this.state=Vr.for2d(),this.size=hr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??qk(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Kk(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Te("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Qk}static get defaultFragmentTemplate(){return Jk}setShaderGenerator({vertex:e=hr.defaultVertexSrc,fragment:r=hr.defaultFragmentTemplate}={}){this.shaderGenerator=new Yk(e,r)}contextChange(){const e=this.renderer.gl;ee.PREFER_ENV===Di.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),hr.defaultMaxTextures),this.maxTextures=Ak(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:r}=hr,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;e.length<n;)e.push(new sf);for(;r.length<i;)r.push(new cf);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:r}=this,n=hr._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++ve._globalBatch,c=0,u=n[0],d=0;i.copyBoundTextures(s,r);for(let h=0;h<this._bufferSize;++h){const f=e[h];e[h]=null,f._batchEnabled!==a&&(u.count>=r&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,d,h),d=h,u=n[++c],++a),f._batchEnabled=a,f.touched=o,u.elements[u.count++]=f)}u.count>0&&(i.boundArray(u,s,a,r),this.buildDrawCalls(u,d,this._bufferSize),++c,++a);for(let h=0;h<s.length;h++)s[h]=null;ve._globalBatch=a}buildDrawCalls(e,r,n){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,c=hr._drawCallPool;let u=this._dcIndex,d=this._aIndex,h=this._iIndex,f=c[u];f.start=this._iIndex,f.texArray=e;for(let p=r;p<n;++p){const m=i[p],v=m._texture.baseTexture,_=L_[v.alphaMode?1:0][m.blendMode];i[p]=null,r<p&&f.blend!==_&&(f.size=h-f.start,r=p,f=c[++u],f.texArray=e,f.start=h),this.packInterleavedGeometry(m,s,o,d,h),d+=m.vertexData.length/2*a,h+=m.indices.length,f.blend=_}r<n&&(f.size=h-f.start,++u),this._dcIndex=u,this._aIndex=d,this._iIndex=h}bindAndClearTexArray(e){const r=this.renderer.texture;for(let n=0;n<e.count;n++)r.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:r,_indexBuffer:n}=this;hr.canUploadSameBuffer?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:r,state:n}=this.renderer,i=hr._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:c,size:u,start:d,blend:h}=i[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=h,n.set(this.state),r.drawElements(c,u,r.UNSIGNED_SHORT,d*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),hr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const r=vc(Math.ceil(e/8)),n=kx(r),i=r*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new tf(i*this.vertexSize*4)),s}getIndexBuffer(e){const r=vc(Math.ceil(e/12)),n=kx(r),i=r*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let s=this._iBuffers[n];return s||(this._iBuffers[n]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,r,n,i,s){const{uint32View:o,float32View:a}=r,c=i/this.vertexSize,u=e.uvs,d=e.indices,h=e.vertexData,f=e._texture.baseTexture._batchLocation,p=Math.min(e.worldAlpha,1),m=Oe.shared.setValue(e._tintRGB).toPremultiplied(p,e._texture.baseTexture.alphaMode>0);for(let v=0;v<h.length;v+=2)a[i++]=h[v],a[i++]=h[v+1],a[i++]=u[v],a[i++]=u[v+1],o[i++]=m,a[i++]=f;for(let v=0;v<d.length;v++)n[s++]=c+d[v]}};So.defaultBatchSize=4096,So.extension={name:"batch",type:Q.RendererPlugin},So._drawCallPool=[],So._textureArrayPool=[];let fi=So;se.add(fi);var Zk=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,eP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const uf=class bo extends Gr{constructor(e,r,n){const i=nn.from(e||bo.defaultVertexSrc,r||bo.defaultFragmentSrc);super(i,n),this.padding=0,this.resolution=bo.defaultResolution,this.multisample=bo.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Vr}apply(e,r,n,i,s){e.applyFilter(this,r,n,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return eP}static get defaultFragmentSrc(){return Zk}};uf.defaultResolution=1,uf.defaultMultisample=tt.NONE;let At=uf;class Sc{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Oe(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:r,background:n,backgroundAlpha:i}=e,s=n??r;s!==void 0&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Sc.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Sc.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"background"};se.add(Sc);class X_{constructor(e){this.renderer=e,this.emptyRenderer=new lu(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){const{boundTextures:n}=this.renderer.texture;for(let i=r-1;i>=0;--i)e[i]=n[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,r,n,i){const{elements:s,ids:o,count:a}=e;let c=0;for(let u=0;u<a;u++){const d=s[u],h=d._batchLocation;if(h>=0&&h<i&&r[h]===d){o[u]=h;continue}for(;c<i;){const f=r[c];if(f&&f._batchEnabled===n&&f._batchLocation===c){c++;continue}o[u]=c,d._batchLocation=c,r[c]=d;break}}}destroy(){this.renderer=null}}X_.extension={type:Q.RendererSystem,name:"batch"};se.add(X_);let Ox=0;class bc{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Ox++}init(e){if(e.context)this.initFromContext(e.context);else{const r=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Ox++,this.renderer.runners.contextChange.emit(e);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let n;if(ee.PREFER_ENV>=Di.WEBGL2&&(n=e.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const r=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}bc.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},bc.extension={type:Q.RendererSystem,name:"context"};se.add(bc);class df{constructor(e,r){if(this.width=Math.round(e),this.height=Math.round(r),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new _r("disposeFramebuffer"),this.multisample=tt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new ve(null,{scaleMode:en.NEAREST,resolution:1,mipmap:Hr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new ve(null,{scaleMode:en.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Hr.OFF,format:X.DEPTH_COMPONENT,type:ce.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!e||!r)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],s=i.resolution;i.setSize(e/s,r/s)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,r/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Y_ extends ve{constructor(e={}){if(typeof e=="number"){const r=arguments[0],n=arguments[1],i=arguments[2],s=arguments[3];e={width:r,height:n,scaleMode:i,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=tt.NONE),super(null,e),this.mipmap=Hr.OFF,this.valid=!0,this._clear=new Oe([0,0,0,0]),this.framebuffer=new df(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class hn extends ma{constructor(e){const r=e,n=r.naturalWidth||r.videoWidth||r.displayWidth||r.width,i=r.naturalHeight||r.videoHeight||r.displayHeight||r.height;super(n,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,n){n===void 0&&!r.startsWith("data:")?e.crossOrigin=bk(r):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,r,n,i){const s=e.gl,o=r.realWidth,a=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Nt.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&n.width===o&&n.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,n.type,i):(n.width=o,n.height=a,s.texImage2D(r.target,0,n.internalFormat,r.format,n.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),super.update()}dispose(){this.source=null}}class K_ extends hn{constructor(e,r){if(r=r||{},typeof e=="string"){const n=new Image;hn.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??ee.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,n)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{n(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Nt.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,n,this.bitmap),!this.preserveBitmap){let i=!0;const s=r._glTextures;for(const o in s){const a=s[o];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class Hp{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,n){const i=r.width,s=r.height;if(n){const o=e.width/2/i,a=e.height/2/s,c=e.x/i+o,u=e.y/s+a;n=He.add(n,He.NW),this.x0=c+o*He.uX(n),this.y0=u+a*He.uY(n),n=He.add(n,2),this.x1=c+o*He.uX(n),this.y1=u+a*He.uY(n),n=He.add(n,2),this.x2=c+o*He.uX(n),this.y2=u+a*He.uY(n),n=He.add(n,2),this.x3=c+o*He.uX(n),this.y3=u+a*He.uY(n)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Hp.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Ux=new Hp;function il(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class ie extends Sa{constructor(e,r,n,i,s,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new we(0,0,1,1)),e instanceof ie&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=Ux,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Pe(o.x,o.y):new Pe(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:r}=this.baseTexture;r!=null&&r.url&&Pr[r.url]&&ie.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ie.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new ie(this.baseTexture,!this.noFrame&&e,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===Ux&&(this._uvs=new Hp),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},n=ee.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else if(e instanceof ve){if(!e.cacheId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${Ii()}`,ve.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Ii()}`}s=e._pixiId}let o=Pr[s];if(i&&n&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof ve)?(r.resolution||(r.resolution=dn(e)),o=new ie(new ve(e,r)),o.baseTexture.cacheId=s,ve.addToCache(o.baseTexture,s),ie.addToCache(o,s)):!o&&e instanceof ve&&(o=new ie(e),ie.addToCache(o,s)),o}static fromURL(e,r){const n=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=ie.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,r,n,i){return new ie(ve.fromBuffer(e,r,n,i))}static fromLoader(e,r,n,i){const s=new ve(e,Object.assign({scaleMode:ve.defaultOptions.scaleMode,resolution:dn(r)},i)),{resource:o}=s;o instanceof K_&&(o.url=r);const a=new ie(s);return n||(n=r),ve.addToCache(a.baseTexture,n),ie.addToCache(a,n),n!==r&&(ve.addToCache(a.baseTexture,r),ie.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(c=>{a.baseTexture.once("loaded",()=>c(a))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),Pr[r]&&Pr[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Pr[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=Pr[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete Pr[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)Pr[e.textureCacheIds[r]]===e&&delete Pr[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:r,y:n,width:i,height:s}=e,o=r+i>this.baseTexture.width,a=n+s>this.baseTexture.height;if(o||a){const c=o&&a?"and":"or",u=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,d=`Y: ${n} + ${s} = ${n+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${c} ${d}`)}this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ie._EMPTY||(ie._EMPTY=new ie(new ve),il(ie._EMPTY),il(ie._EMPTY.baseTexture)),ie._EMPTY}static get WHITE(){if(!ie._WHITE){const e=ee.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),ie._WHITE=new ie(ve.from(e)),il(ie._WHITE),il(ie._WHITE.baseTexture)}return ie._WHITE}}class Ui extends ie{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,n=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(r*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new Ui(new Y_(e))}}class q_{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,n=tt.NONE){const i=new Y_(Object.assign({width:e,height:r,resolution:1,multisample:n},this.textureOptions));return new Ui(i)}getOptimalTexture(e,r,n=1,i=tt.NONE){let s;e=Math.max(Math.ceil(e*n-1e-6),1),r=Math.max(Math.ceil(r*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=vc(e),r=vc(r),s=((e&65535)<<16|r&65535)>>>0,i>1&&(s+=i*4294967296)):s=i>1?-i:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,i)),o.filterPoolKey=s,o.setResolution(n),o}getFilterTexture(e,r,n){const i=this.getOptimalTexture(e.width,e.height,r||e.resolution,n||tt.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const r in this.texturePool){const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}q_.SCREEN_KEY=-1;class tP extends qn{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class J_ extends qn{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Qe(this.vertices),this.uvBuffer=new Qe(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+r.width/e.width,this.uvs[3]=i,this.uvs[4]=n+r.width/e.width,this.uvs[5]=i+r.height/e.height,this.uvs[6]=n,this.uvs[7]=i+r.height/e.height,n=r.x,i=r.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+r.width,this.vertices[3]=i,this.vertices[4]=n+r.width,this.vertices[5]=i+r.height,this.vertices[6]=n,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class rP{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=tt.NONE,this.sourceFrame=new we,this.destinationFrame=new we,this.bindingSourceFrame=new we,this.bindingDestinationFrame=new we,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const sl=[new Pe,new Pe,new Pe,new Pe],Ed=new ze;class Q_{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new q_,this.statePool=[],this.quad=new tP,this.quadUv=new J_,this.tempRect=new we,this.activeState={},this.globalUniforms=new wr({outputFrame:new we,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){const n=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new rP,o=n.renderTexture;let a,c;if(o.current){const _=o.current;a=_.resolution,c=_.multisample}else a=n.resolution,c=n.multisample;let u=r[0].resolution||a,d=r[0].multisample??c,h=r[0].padding,f=r[0].autoFit,p=r[0].legacy??!0;for(let _=1;_<r.length;_++){const y=r[_];u=Math.min(u,y.resolution||a),d=Math.min(d,y.multisample??c),h=this.useMaxPadding?Math.max(h,y.padding):h+y.padding,f=f&&y.autoFit,p=p||(y.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=u,s.multisample=d,s.legacy=p,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(h);const m=this.tempRect.copyFrom(o.sourceFrame);n.projection.transform&&this.transformAABB(Ed.copyFrom(n.projection.transform).invert(),m),f?(s.sourceFrame.fit(m),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(m)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:n.resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,u,d),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const v=this.tempRect;v.x=0,v.y=0,v.width=s.sourceFrame.width,v.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=n.projection.transform,n.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,v),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,r=e.pop(),n=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const s=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*s[2]-.5*o[2],a[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){const u=i.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const c=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,c.renderTexture,Nr.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let u=r.renderTexture,d=this.getOptimalFilterTexture(u.width,u.height,r.resolution);d.filterFrame=u.filterFrame;let h=0;for(h=0;h<n.length-1;++h){h===1&&r.multisample>1&&(d=this.getOptimalFilterTexture(u.width,u.height,r.resolution),d.filterFrame=u.filterFrame),n[h].apply(this,u,d,Nr.CLEAR,r);const f=u;u=d,d=f}n[h].apply(this,u,c.renderTexture,Nr.BLEND,r),h>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(d)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=Nr.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,n.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=i.stateId&1||this.forceClear;(r===Nr.CLEAR||r===Nr.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,n,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(n,i),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Dr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Dr.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:s}=r._texture,o=e.set(i.width,0,0,i.height,n.x,n.y),a=r.worldTransform.copyTo(ze.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,n=1,i=tt.NONE){return this.texturePool.getOptimalTexture(e,r,n,i)}getFilterTexture(e,r,n){if(typeof e=="number"){const s=e;e=r,r=s}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,n||tt.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){const n=sl[0],i=sl[1],s=sl[2],o=sl[3];n.set(r.left,r.top),i.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(n,n),e.apply(i,i),e.apply(s,s),e.apply(o,o);const a=Math.min(n.x,i.x,s.x,o.x),c=Math.min(n.y,i.y,s.y,o.y),u=Math.max(n.x,i.x,s.x,o.x),d=Math.max(n.y,i.y,s.y,o.y);r.x=a,r.y=c,r.width=u-a,r.height=d-c}roundFrame(e,r,n,i,s){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(s){const{a:o,b:a,c,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?Ed.copyFrom(s):Ed.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}}Q_.extension={type:Q.RendererSystem,name:"filter"};se.add(Q_);class nP{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=tt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const iP=new we;class Z_{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new df(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new we,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;ee.PREFER_ENV===Di.WEBGL_LEGACY&&(r=null,n=null),r?e.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,n=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=n),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){const o=r.width>>n,a=r.height>>n,c=o/r.width;this.setViewport(r.x*c,r.y*c,o,a)}else{const o=e.width>>n,a=e.height>>n;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,n,i){const s=this.viewport;e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),(s.width!==n||s.height!==i||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=n,s.height=i,this.gl.viewport(e,r,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,n,i,s=Dh.COLOR|Dh.DEPTH){const{gl:o}=this;o.clearColor(e,r,n,i),o.clear(s)}initFramebuffer(e){const{gl:r}=this,n=new nP(r.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){r.bindRenderbuffer(r.RENDERBUFFER,n.stencil);let o;this.renderer.context.webGLVersion===1?o=r.DEPTH_STENCIL:e.depth&&e.stencil?o=r.DEPTH24_STENCIL8:e.depth?o=r.DEPTH_COMPONENT24:o=r.STENCIL_INDEX8,n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,o,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let s=i.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=i[o],c=a.parentTextureArray||a;this.renderer.texture.bind(c,0),o===0&&n.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let c=0;c<o;c++){const u=s[c],d=u.parentTextureArray||u;this.renderer.texture.bind(d,0),c===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+c,u.target,d._glTextures[this.CONTEXT_UID].texture,r),a.push(n.COLOR_ATTACHMENT0+c))}if(a.length>1&&n.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const c=e.depthTexture;this.renderer.texture.bind(c,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,c._glTextures[this.CONTEXT_UID].texture,r)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||n.createRenderbuffer();let c,u;this.renderer.context.webGLVersion===1?(c=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH_STENCIL):e.depth&&e.stencil?(c=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH24_STENCIL8):e.depth?(c=n.DEPTH_ATTACHMENT,u=n.DEPTH_COMPONENT24):(c=n.STENCIL_ATTACHMENT,u=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,u,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,u,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,c,n.RENDERBUFFER,i.stencil)}else i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:r}=this;let n=tt.NONE;if(e<=1||r===null)return n;for(let i=0;i<r.length;i++)if(r[i]<=e){n=r[i];break}return n===1&&(n=tt.NONE),n}blit(e,r,n){const{current:i,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!i)return;const c=i.glFramebuffers[a];if(!c)return;if(!e){if(!c.msaaBuffer)return;const d=i.colorTextures[0];if(!d)return;c.blitFramebuffer||(c.blitFramebuffer=new df(i.width,i.height),c.blitFramebuffer.addColorTexture(0,d)),e=c.blitFramebuffer,e.colorTextures[0]!==d&&(e.colorTextures[0]=d,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}r||(r=iP,r.width=i.width,r.height=i.height),n||(n=r);const u=r.width===n.width&&r.height===n.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,c.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,r){const n=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,r)}disposeAll(e){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<r.length;n++)this.disposeFramebuffer(r[n],e)}forceStencil(){const e=this.current;if(!e)return;const r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil&&e.stencil)return;e.stencil=!0;const n=e.width,i=e.height,s=this.gl,o=r.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,c;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,c=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,c=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,c=s.STENCIL_INDEX8),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,c,n,i):s.renderbufferStorage(s.RENDERBUFFER,c,n,i),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new we}destroy(){this.renderer=null}}Z_.extension={type:Q.RendererSystem,name:"framebuffer"};se.add(Z_);const Td={5126:4,5123:2,5121:1};class e1{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;ee.PREFER_ENV===Di.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(i,s)=>n.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,a,c)=>n.drawElementsInstancedANGLE(i,s,o,a,c),e.drawArraysInstanced=(i,s,o,a)=>n.drawArraysInstancedANGLE(i,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;const{gl:n}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,r=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];r.update(i)}}checkCompatibility(e,r){const n=e.attributes,i=r.attributeData;for(const s in i)if(!n[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){const n=e.attributes,i=r.attributeData,s=["g",e.id];for(const o in n)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,r,n=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,a);const c=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let d=u[c];if(d)return u[a.id]=d,d;const h=e.buffers,f=e.attributes,p={},m={};for(const v in h)p[v]=0,m[v]=0;for(const v in f)!f[v].size&&a.attributeData[v]?f[v].size=a.attributeData[v].size:f[v].size||console.warn(`PIXI Geometry attribute '${v}' size cannot be determined (likely the bound shader does not have the attribute)`),p[f[v].buffer]+=f[v].size*Td[f[v].type];for(const v in f){const _=f[v],y=_.size;_.stride===void 0&&(p[_.buffer]===y*Td[_.type]?_.stride=0:_.stride=p[_.buffer]),_.start===void 0&&(_.start=m[_.buffer],m[_.buffer]+=y*Td[_.type])}d=i.createVertexArray(),i.bindVertexArray(d);for(let v=0;v<h.length;v++){const _=h[v];o.bind(_),n&&_._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=d,u[c]=d,i.bindVertexArray(null),o.unbind(zr.ARRAY_BUFFER),d}disposeGeometry(e,r){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!n){if(o)for(let c=0;c<s.length;c++){const u=s[c]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!r&&o.dispose(s[c],r))}if(!r){for(const c in n)if(c[0]==="g"){const u=n[c];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const r=Object.keys(this.managedGeometries);for(let n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],e)}activateVao(e,r){const n=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let c=null;for(const u in a){const d=a[u],h=o[d.buffer],f=h._glBuffers[i];if(r.attributeData[u]){c!==f&&(s.bind(h),c=f);const p=r.attributeData[u].location;if(n.enableVertexAttribArray(p),n.vertexAttribPointer(p,d.size,d.type||n.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)n.vertexAttribDivisor(p,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,n,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,c=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,c,(n||0)*a,i||1):s.drawElements(e,r||o.indexBuffer.data.length,c,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,n,r||o.getSize(),i||1):s.drawArrays(e,n,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}e1.extension={type:Q.RendererSystem,name:"geometry"};se.add(e1);const zx=new ze;class t1{constructor(e,r){this._texture=e,this.mapCoord=new ze,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];r[i]=s*n.a+o*n.c+n.tx,r[i+1]=s*n.b+o*n.d+n.ty}return r}update(e){const r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const n=r._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=r.orig,s=r.trim;s&&(zx.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(zx));const o=r.baseTexture,a=this.uClampFrame,c=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(r._frame.x+c+u)/o.width,a[1]=(r._frame.y+c+u)/o.height,a[2]=(r._frame.x+r._frame.width-c+u)/o.width,a[3]=(r._frame.y+r._frame.height-c+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}}var sP=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,oP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class aP extends At{constructor(e,r,n){let i=null;typeof e!="string"&&r===void 0&&n===void 0&&(i=e,e=void 0,r=void 0,n=void 0),super(e||oP,r||sP,n),this.maskSprite=i,this.maskMatrix=new ze}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,n,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new t1(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,n,i))}}class lP{constructor(e=null){this.type=st.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=At.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=st.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class r1{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let n=r;if(!n.isMaskData){const s=this.maskDataPool.pop()||new lP;s.pooled=!0,s.maskObject=r,n=s}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==st.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case st.SCISSOR:this.renderer.scissor.push(n);break;case st.STENCIL:this.renderer.stencil.push(n);break;case st.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case st.COLOR:this.pushColorMask(n);break}n.type===st.SPRITE&&this.maskStack.push(n)}pop(e){const r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case st.SCISSOR:this.renderer.scissor.pop(r);break;case st.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case st.SPRITE:this.popSpriteMask(r);break;case st.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===st.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const r=e.maskObject;r?r.isSprite?e.type=st.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=st.SCISSOR:e.type=st.STENCIL:e.type=st.COLOR}pushSpriteMask(e){const{maskObject:r}=e,n=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new aP])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=r;const s=n.filterArea;n.filterArea=r.getBounds(!0),this.renderer.filter.push(n,i),n.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const r=e._colorMask,n=e._colorMask=r&e.colorMask;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const r=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}r1.extension={type:Q.RendererSystem,name:"mask"};se.add(r1);class n1{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:r}=this.renderer,n=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==n&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Gx=new ze,Hx=[],i1=class Nl extends n1{constructor(e){super(e),this.glConst=ee.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const r=e._scissorRect,{maskObject:n}=e,{renderer:i}=this,s=i.renderTexture,o=n.getBounds(!0,Hx.pop()??new we);this.roundFrameToPixels(o,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),r&&o.fit(r),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:r,b:n,c:i,d:s}=e;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(r)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:r}=e;if(!r.isFastRect||!r.isFastRect()||Nl.isMatrixRotated(r.worldTransform)||Nl.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const n=e._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(e,r,n,i,s){Nl.isMatrixRotated(s)||(s=s?Gx.copyFrom(s):Gx.identity(),s.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*r),e.y=Math.round(e.y*r),e.width=Math.round(e.width*r),e.height=Math.round(e.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:r}=this.renderer;e._scissorRect||r.enable(r.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:r}=this.renderer;e&&Hx.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():r.disable(r.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let r;this.renderer.renderTexture.current?r=e.y:r=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,r,e.width,e.height)}};i1.extension={type:Q.RendererSystem,name:"scissor"};let cP=i1;se.add(cP);class s1 extends n1{constructor(e){super(e),this.glConst=ee.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const r=e.maskObject,{gl:n}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,n.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(n._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}s1.extension={type:Q.RendererSystem,name:"stencil"};se.add(s1);class o1{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Te("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return Te("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return Te("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}o1.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"_plugin"};se.add(o1);class a1{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new ze,this.transform=null}update(e,r,n,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,n,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}}a1.extension={type:Q.RendererSystem,name:"projection"};se.add(a1);const uP=new Gp,$x=new we;class l1{constructor(e){this.renderer=e,this._tempMatrix=new ze}generateTexture(e,r){const{region:n,...i}=r||{},s=(n==null?void 0:n.copyTo($x))||e.getLocalBounds($x,!0),o=i.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),i.width=s.width,i.height=s.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const a=Ui.create(i);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const c=e.transform;return e.transform=uP,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=c,a}destroy(){}}l1.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"textureGenerator"};se.add(l1);const si=new we,go=new we;class c1{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new we,this.destinationFrame=new we,this.viewportFrame=new we}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,r,n){const i=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,r||(si.width=e.frame.width,si.height=e.frame.height,r=si),n||(go.x=e.frame.x,go.y=e.frame.y,go.width=r.width,go.height=r.height,n=go),o=s.framebuffer):(a=i.resolution,r||(si.width=i._view.screen.width,si.height=i._view.screen.height,r=si),n||(n=si,n.width=r.width,n.height=r.height));const c=this.viewportFrame;c.x=n.x*a,c.y=n.y*a,c.width=n.width*a,c.height=n.height*a,e||(c.y=i.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(o,c),this.renderer.projection.update(n,r,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)}clear(e,r){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=Oe.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:c,y:u,width:d,height:h}=this.viewportFrame;c=Math.round(c),u=Math.round(u),d=Math.round(d),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(c,u,d,h)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}c1.extension={type:Q.RendererSystem,name:"renderTexture"};se.add(c1);class dP{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function hP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=W_(e,s.type),a={type:o,name:s.name,size:V_(o),location:e.getAttribLocation(t,s.name)};r[s.name]=a}return r}function fP(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),c=W_(e,s.type);r[o]={name:o,index:i,type:c,size:s.size,isArray:a,value:H_(c,s.size)}}return r}function pP(t,e){var a;const r=Nx(t,t.VERTEX_SHADER,e.vertexSrc),n=Nx(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||Hk(t,i,r,n),e.attributeData=hP(i,t),e.uniformData=fP(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const c=Object.keys(e.attributeData);c.sort((u,d)=>u>d?1:-1);for(let u=0;u<c.length;u++)e.attributeData[c[u]].location=u,t.bindAttribLocation(i,u,c[u]);t.linkProgram(i)}t.deleteShader(r),t.deleteShader(n);const o={};for(const c in e.uniformData){const u=e.uniformData[c];o[c]={location:t.getUniformLocation(i,c),value:H_(u.type,u.size)}}return new dP(i,o)}function mP(t,e,r,n,i){r.buffer.update(i)}const gP={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},u1={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function xP(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let r=0,n=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(r=u1[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!==0&&n<16){const a=n%r%16;n+=a,i+=a}n+r>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function yP(t,e){const r=[];for(const n in t)e[n]&&r.push(e[n]);return r.sort((n,i)=>n.index-i.index),r}function vP(t,e){if(!t.autoManage)return{size:0,syncFunc:mP};const r=yP(t.uniforms,e),{uboElements:n,size:i}=xP(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<n.length;o++){const a=n[o],c=t.uniforms[a.data.name],u=a.data.name;let d=!1;for(let h=0;h<Bs.length;h++){const f=Bs[h];if(f.codeUbo&&f.test(a.data,c)){s.push(`offset = ${a.offset/4};`,Bs[h].codeUbo(a.data.name,c)),d=!0;break}}if(!d)if(a.data.size>1){const h=V_(a.data.type),f=Math.max(u1[a.data.type]/16,1),p=h/f,m=(4-p%4)%4;s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*f}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const h=gP[a.data.type];s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${h};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let _P=0;const ol={textureCount:0,uboCount:0};class d1{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=_P++}systemCheck(){if(!Vk())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),r||(ol.textureCount=0,ol.uboCount=0,this.syncUniformGroup(e.uniformGroup,ol)),i}setUniforms(e){const r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,r){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,r))}syncUniforms(e,r,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=Uk(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const i=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,r);e.buffer.update(),i(n.uniformData,e.uniforms,this.renderer,ol,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[r])}createSyncBufferGroup(e,r,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(r.program,n);r.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=vP(e,this.shader.program.uniformData)),e.autoManage){const c=new Float32Array(a.size/4);e.buffer.update(c)}return r.uniformGroups[e.id]=a.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,n){const i=e.uniforms,s=[`${n}-`];for(const o in i)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=this.gl,n=e.program,i=pP(r,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}d1.extension={type:Q.RendererSystem,name:"shader"};se.add(d1);class Ec{constructor(e){this.renderer=e}run(e){const{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.4.3 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}}Ec.defaultOptions={hello:!1},Ec.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"startup"};se.add(Ec);function wP(t,e=[]){return e[me.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.ADD]=[t.ONE,t.ONE],e[me.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.NONE]=[0,0],e[me.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[me.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[me.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[me.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[me.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[me.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[me.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[me.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[me.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[me.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[me.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const SP=0,bP=1,EP=2,TP=3,AP=4,CP=5,h1=class hf{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=me.NONE,this._blendEq=!1,this.map=[],this.map[SP]=this.setBlend,this.map[bP]=this.setOffset,this.map[EP]=this.setCullFace,this.map[TP]=this.setDepthTest,this.map[AP]=this.setFrontFace,this.map[CP]=this.setDepthMask,this.checks=[],this.defaultState=new Vr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=wP(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let r=this.stateId^e.data,n=0;for(;r;)r&1&&this.map[n].call(this,!!(e.data&1<<n)),r=r>>1,n++;this.stateId=e.data}for(let r=0;r<this.checks.length;r++)this.checks[r](this,e)}forceState(e){e=e||this.defaultState;for(let r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(let r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(hf.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(hf.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const r=this.blendModes[e],n=this.gl;r.length===2?n.blendFunc(r[0],r[1]):n.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,n.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,r){this.gl.polygonOffset(e,r)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,r){const n=this.checks.indexOf(e);r&&n===-1?this.checks.push(e):!r&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,r){e.setBlendMode(r.blendMode)}static checkPolygonOffset(e,r){e.setPolygonOffset(1,r.polygonOffset)}destroy(){this.gl=null}};h1.extension={type:Q.RendererSystem,name:"state"};let kP=h1;se.add(kP);class PP extends Sa{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const r=(e.priority??[]).filter(i=>e.systems[i]),n=[...r,...Object.keys(e.systems).filter(i=>!r.includes(i))];for(const i of n)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(r=>{this.runners[r]=new _r(r)})}addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(e,r){const n=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=n.find(o=>this._systemsHash[o]===i);i[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const Eo=class Fl{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Fl.defaultMaxIdle,this.checkCountMax=Fl.defaultCheckCountMax,this.mode=Fl.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==jp.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,r=e.managedTextures;let n=!1;for(let i=0;i<r.length;i++){const s=r[i];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),r[i]=null,n=!0)}if(n){let i=0;for(let s=0;s<r.length;s++)r[s]!==null&&(r[i++]=r[s]);r.length=i}}unload(e){const r=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&r.destroyTexture(n);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};Eo.defaultMode=jp.AUTO,Eo.defaultMaxIdle=60*60,Eo.defaultCheckCountMax=60*10,Eo.extension={type:Q.RendererSystem,name:"textureGC"};let pi=Eo;se.add(pi);class Ad{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=ce.UNSIGNED_BYTE,this.internalFormat=X.RGBA,this.samplerType=0}}function RP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:Z.FLOAT,[t.RGBA]:Z.FLOAT,[t.ALPHA]:Z.FLOAT,[t.LUMINANCE]:Z.FLOAT,[t.LUMINANCE_ALPHA]:Z.FLOAT,[t.R8]:Z.FLOAT,[t.R8_SNORM]:Z.FLOAT,[t.RG8]:Z.FLOAT,[t.RG8_SNORM]:Z.FLOAT,[t.RGB8]:Z.FLOAT,[t.RGB8_SNORM]:Z.FLOAT,[t.RGB565]:Z.FLOAT,[t.RGBA4]:Z.FLOAT,[t.RGB5_A1]:Z.FLOAT,[t.RGBA8]:Z.FLOAT,[t.RGBA8_SNORM]:Z.FLOAT,[t.RGB10_A2]:Z.FLOAT,[t.RGB10_A2UI]:Z.FLOAT,[t.SRGB8]:Z.FLOAT,[t.SRGB8_ALPHA8]:Z.FLOAT,[t.R16F]:Z.FLOAT,[t.RG16F]:Z.FLOAT,[t.RGB16F]:Z.FLOAT,[t.RGBA16F]:Z.FLOAT,[t.R32F]:Z.FLOAT,[t.RG32F]:Z.FLOAT,[t.RGB32F]:Z.FLOAT,[t.RGBA32F]:Z.FLOAT,[t.R11F_G11F_B10F]:Z.FLOAT,[t.RGB9_E5]:Z.FLOAT,[t.R8I]:Z.INT,[t.R8UI]:Z.UINT,[t.R16I]:Z.INT,[t.R16UI]:Z.UINT,[t.R32I]:Z.INT,[t.R32UI]:Z.UINT,[t.RG8I]:Z.INT,[t.RG8UI]:Z.UINT,[t.RG16I]:Z.INT,[t.RG16UI]:Z.UINT,[t.RG32I]:Z.INT,[t.RG32UI]:Z.UINT,[t.RGB8I]:Z.INT,[t.RGB8UI]:Z.UINT,[t.RGB16I]:Z.INT,[t.RGB16UI]:Z.UINT,[t.RGB32I]:Z.INT,[t.RGB32UI]:Z.UINT,[t.RGBA8I]:Z.INT,[t.RGBA8UI]:Z.UINT,[t.RGBA16I]:Z.INT,[t.RGBA16UI]:Z.UINT,[t.RGBA32I]:Z.INT,[t.RGBA32UI]:Z.UINT,[t.DEPTH_COMPONENT16]:Z.FLOAT,[t.DEPTH_COMPONENT24]:Z.FLOAT,[t.DEPTH_COMPONENT32F]:Z.FLOAT,[t.DEPTH_STENCIL]:Z.FLOAT,[t.DEPTH24_STENCIL8]:Z.FLOAT,[t.DEPTH32F_STENCIL8]:Z.FLOAT}:e={[t.RGB]:Z.FLOAT,[t.RGBA]:Z.FLOAT,[t.ALPHA]:Z.FLOAT,[t.LUMINANCE]:Z.FLOAT,[t.LUMINANCE_ALPHA]:Z.FLOAT,[t.DEPTH_STENCIL]:Z.FLOAT},e}function IP(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[ce.UNSIGNED_BYTE]:{[X.RGBA]:t.RGBA8,[X.RGB]:t.RGB8,[X.RG]:t.RG8,[X.RED]:t.R8,[X.RGBA_INTEGER]:t.RGBA8UI,[X.RGB_INTEGER]:t.RGB8UI,[X.RG_INTEGER]:t.RG8UI,[X.RED_INTEGER]:t.R8UI,[X.ALPHA]:t.ALPHA,[X.LUMINANCE]:t.LUMINANCE,[X.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[ce.BYTE]:{[X.RGBA]:t.RGBA8_SNORM,[X.RGB]:t.RGB8_SNORM,[X.RG]:t.RG8_SNORM,[X.RED]:t.R8_SNORM,[X.RGBA_INTEGER]:t.RGBA8I,[X.RGB_INTEGER]:t.RGB8I,[X.RG_INTEGER]:t.RG8I,[X.RED_INTEGER]:t.R8I},[ce.UNSIGNED_SHORT]:{[X.RGBA_INTEGER]:t.RGBA16UI,[X.RGB_INTEGER]:t.RGB16UI,[X.RG_INTEGER]:t.RG16UI,[X.RED_INTEGER]:t.R16UI,[X.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[ce.SHORT]:{[X.RGBA_INTEGER]:t.RGBA16I,[X.RGB_INTEGER]:t.RGB16I,[X.RG_INTEGER]:t.RG16I,[X.RED_INTEGER]:t.R16I},[ce.UNSIGNED_INT]:{[X.RGBA_INTEGER]:t.RGBA32UI,[X.RGB_INTEGER]:t.RGB32UI,[X.RG_INTEGER]:t.RG32UI,[X.RED_INTEGER]:t.R32UI,[X.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[ce.INT]:{[X.RGBA_INTEGER]:t.RGBA32I,[X.RGB_INTEGER]:t.RGB32I,[X.RG_INTEGER]:t.RG32I,[X.RED_INTEGER]:t.R32I},[ce.FLOAT]:{[X.RGBA]:t.RGBA32F,[X.RGB]:t.RGB32F,[X.RG]:t.RG32F,[X.RED]:t.R32F,[X.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[ce.HALF_FLOAT]:{[X.RGBA]:t.RGBA16F,[X.RGB]:t.RGB16F,[X.RG]:t.RG16F,[X.RED]:t.R16F},[ce.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:t.RGB565},[ce.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:t.RGBA4},[ce.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:t.RGB5_A1},[ce.UNSIGNED_INT_2_10_10_10_REV]:{[X.RGBA]:t.RGB10_A2,[X.RGBA_INTEGER]:t.RGB10_A2UI},[ce.UNSIGNED_INT_10F_11F_11F_REV]:{[X.RGB]:t.R11F_G11F_B10F},[ce.UNSIGNED_INT_5_9_9_9_REV]:{[X.RGB]:t.RGB9_E5},[ce.UNSIGNED_INT_24_8]:{[X.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[ce.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[X.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[ce.UNSIGNED_BYTE]:{[X.RGBA]:t.RGBA,[X.RGB]:t.RGB,[X.ALPHA]:t.ALPHA,[X.LUMINANCE]:t.LUMINANCE,[X.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[ce.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:t.RGB},[ce.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:t.RGBA},[ce.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:t.RGBA}},e}class f1{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ve,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=IP(e),this.samplerTypes=RP(e);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new Ad(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Ad(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,r=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:r,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}ensureSamplerType(e){const{boundTextures:r,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let s=e-1;s>=0;--s){const o=r[s];o&&o._glTextures[i].samplerType!==Z.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const r=new Ad(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){var n;r.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,r.samplerType=this.samplerTypes[r.internalFormat]??Z.FLOAT,this.webGLVersion===2&&e.type===ce.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){var i;const r=e._glTextures[this.CONTEXT_UID];if(!r)return;const n=this.renderer;if(this.initTextureType(e,r),(i=e.resource)==null?void 0:i.upload(n,e,r))r.samplerType!==Z.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=n.gl;(r.width!==s||r.height!==o||r.dirtyId<0)&&(r.width=s,r.height=o,a.texImage2D(e.target,0,r.internalFormat,s,o,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(e);i!==-1&&js(this.managedTextures,i,1)}}updateTextureStyle(e){var n;const r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===Hr.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=Wn.CLAMP:r.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){const n=this.gl;if(r.mipmap&&e.mipmap!==Hr.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===en.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===en.LINEAR){const s=Math.min(e.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===en.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===en.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}f1.extension={type:Q.RendererSystem,name:"texture"};se.add(f1);class p1{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){const{gl:n,renderer:i}=this;r&&i.shader.bind(r),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:r,renderer:n,CONTEXT_UID:i}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[i]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(n.buffer.update(a),a._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){const n=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const c=a._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!r&&s.dispose(a,r))}n&&(r||i.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}p1.extension={type:Q.RendererSystem,name:"transformFeedback"};se.add(p1);class Tc{constructor(e){this.renderer=e}init(e){this.screen=new we(0,0,e.width,e.height),this.element=e.view||ee.ADAPTER.createCanvas(),this.resolution=e.resolution||ee.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var r;e&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Tc.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Tc.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"_view"};se.add(Tc);ee.PREFER_ENV=Di.WEBGL2;ee.STRICT_TEXTURE_CACHE=!1;ee.RENDER_OPTIONS={...bc.defaultOptions,...Sc.defaultOptions,...Tc.defaultOptions,...Ec.defaultOptions};Object.defineProperties(ee,{WRAP_MODE:{get(){return ve.defaultOptions.wrapMode},set(t){Te("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),ve.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return ve.defaultOptions.scaleMode},set(t){Te("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),ve.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return ve.defaultOptions.mipmap},set(t){Te("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),ve.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return ve.defaultOptions.anisotropicLevel},set(t){Te("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),ve.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return Te("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),At.defaultResolution},set(t){At.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return Te("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),At.defaultMultisample},set(t){At.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return fi.defaultMaxTextures},set(t){Te("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),fi.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return fi.defaultBatchSize},set(t){Te("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),fi.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return fi.canUploadSameBuffer},set(t){Te("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),fi.canUploadSameBuffer=t}},GC_MODE:{get(){return pi.defaultMode},set(t){Te("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),pi.defaultMode=t}},GC_MAX_IDLE:{get(){return pi.defaultMaxIdle},set(t){Te("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),pi.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return pi.defaultCheckCountMax},set(t){Te("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),pi.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return nn.defaultVertexPrecision},set(t){Te("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),nn.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return nn.defaultFragmentPrecision},set(t){Te("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),nn.defaultFragmentPrecision=t}}});var Mi=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Mi||{});class Cd{constructor(e,r=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=n,this.once=i}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const m1=class zt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Cd(null,null,1/0),this.deltaMS=1/zt.targetFPMS,this.elapsedMS=1/zt.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,r,n=Mi.NORMAL){return this._addListener(new Cd(e,r,n))}addOnce(e,r,n=Mi.NORMAL){return this._addListener(new Cd(e,r,n,!0))}_addListener(e){let r=this._head.next,n=this._head;if(!r)e.connect(n);else{for(;r;){if(e.priority>r.priority){e.connect(n);break}n=r,r=r.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,r){let n=this._head.next;for(;n;)n.match(e,r)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,r=this._head;for(;r=r.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let r;if(e>this.lastTime){if(r=this.elapsedMS=e-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*zt.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const r=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,r)/1e3,zt.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const r=Math.max(this.minFPS,e);this._minElapsedMS=1/(r/1e3)}}static get shared(){if(!zt._shared){const e=zt._shared=new zt;e.autoStart=!0,e._protected=!0}return zt._shared}static get system(){if(!zt._system){const e=zt._system=new zt;e.autoStart=!0,e._protected=!0}return zt._system}};m1.targetFPMS=.06;let $t=m1;Object.defineProperties(ee,{TARGET_FPMS:{get(){return $t.targetFPMS},set(t){Te("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),$t.targetFPMS=t}}});class g1{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Mi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?$t.shared:new $t,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}g1.extension=Q.Application;se.add(g1);const x1=[];se.handleByList(Q.Renderer,x1);function MP(t){for(const e of x1)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var jP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,BP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const NP=jP,y1=BP;class v1{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}r>=tt.HIGH?this.multisample=tt.HIGH:r>=tt.MEDIUM?this.multisample=tt.MEDIUM:r>=tt.LOW?this.multisample=tt.LOW:this.multisample=tt.NONE}destroy(){}}v1.extension={type:Q.RendererSystem,name:"_multisample"};se.add(v1);class FP{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class _1{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);r.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[r]=e,n.bindBufferBase(n.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,n){const{gl:i,CONTEXT_UID:s}=this;n=n||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,o.buffer,n*256,256)}update(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{const s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),n&&(r||i.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const r=Object.keys(this.managedBuffers);for(let n=0;n<r.length;n++)this.dispose(this.managedBuffers[r[n]],e)}createGLBuffer(e){const{CONTEXT_UID:r,gl:n}=this;return e._glBuffers[r]=new FP(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}}_1.extension={type:Q.RendererSystem,name:"buffer"};se.add(_1);class w1{constructor(e){this.renderer=e}render(e,r){const n=this.renderer;let i,s,o,a;if(r&&(i=r.renderTexture,s=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=o,!n.context.isLost){if(i||(this.lastObjectRendered=e),!a){const c=e.enableTempParent();e.updateTransform(),e.disableTempParent(c)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(s??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),i&&(r.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}w1.extension={type:Q.RendererSystem,name:"objectRenderer"};se.add(w1);const Ll=class ff extends PP{constructor(e){super(),this.type=r_.WEBGL,e=Object.assign({},ee.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new wr({projectionMatrix:new ze},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:ff.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in e&&(Te("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=ff.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:sk()}render(e,r){this.objectRenderer.render(e,r)}resize(e,r){this._view.resizeView(e,r)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Te("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Te("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Te("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Te("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Te("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Te("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Te("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Te("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,r){return this.textureGenerator.generateTexture(e,r)}};Ll.extension={type:Q.Renderer,priority:1},Ll.__plugins={},Ll.__systems={};let $p=Ll;se.handleByMap(Q.RendererPlugin,$p.__plugins);se.handleByMap(Q.RendererSystem,$p.__systems);se.add($p);class S1 extends ma{constructor(e,r){const{width:n,height:i}=r||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new ve;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof ma?this.addResourceAt(e[n],n):this.addResourceAt(U_(e[n],r),n))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(e).then(()=>{const{realWidth:r,realHeight:n}=this.items[0];return this.resize(r,n),this.update(),Promise.resolve(this)}),this._load}}class LP extends S1{constructor(e,r){const{width:n,height:i}=r||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:n,height:i}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Rs.TEXTURE_2D_ARRAY}upload(e,r,n){const{length:i,itemDirtyIds:s,items:o}=this,{gl:a}=e;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,r.format,n.type,null);for(let c=0;c<i;c++){const u=o[c];s[c]<u.dirtyId&&(s[c]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,c,u.resource.width,u.resource.height,1,r.format,n.type,u.resource.source))}return!0}}class DP extends hn{constructor(e){super(e)}static test(e){const{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const b1=class To extends S1{constructor(e,r){const{width:n,height:i,autoLoad:s,linkBaseTexture:o}=r||{};if(e&&e.length!==To.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:n,height:i});for(let a=0;a<To.SIDES;a++)this.items[a].target=Rs.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,r),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Rs.TEXTURE_CUBE_MAP}addBaseTextureAt(e,r,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[r])throw new Error(`Index ${r} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Rs.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this}upload(e,r,n){const i=this.itemDirtyIds;for(let s=0;s<To.SIDES;s++){const o=this.items[s];(i[s]<o.dirtyId||n.dirtyId<r.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===To.SIDES}};b1.SIDES=6;let OP=b1;class bs extends hn{constructor(e,r){r=r||{};let n,i,s;typeof e=="string"?(n=bs.EMPTY,i=e,s=!0):(n=e,i=null,s=!1),super(n),this.url=i,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.ownsImageBitmap=r.ownsImageBitmap??s,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{const n=await ee.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Nt.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(n){if(this.destroyed)return;r(n),this.onError.emit(n)}}),this._load)}upload(e,r,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return bs._EMPTY=bs._EMPTY??ee.ADAPTER.createCanvas(0,0),bs._EMPTY}}const pf=class Dl extends hn{constructor(e,r){r=r||{},super(ee.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},Dl.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;hn.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=r=>{this._resolve&&(e.onerror=null,this.onError.emit(r))},e.onload=()=>{if(!this._resolve)return;const r=e.width,n=e.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=r*this.scale,s=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/n*r,s=this._overrideHeight||this._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);const o=this.source;o.width=i,o.height=s,o._pixiId=`canvas_${Ii()}`,o.getContext("2d").drawImage(e,0,0,r,n,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){const r=Dl.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,r){return r==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Dl.SVG_XML.test(e)}};pf.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,pf.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let mf=pf;class UP extends hn{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const gf=class xf extends hn{constructor(e,r){if(r=r||{},!(e instanceof HTMLVideoElement)){const n=document.createElement("video");r.autoLoad!==!1&&n.setAttribute("preload","auto"),r.playsinline!==!1&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),r.muted===!0&&(n.setAttribute("muted",""),n.muted=!0),r.loop===!0&&n.setAttribute("loop",""),r.autoPlay!==!1&&n.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];hn.crossOrigin(n,i,r.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:c}=e[s];if(a=a||e[s],a.startsWith("data:"))c=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const u=a.split("?").shift().toLowerCase(),d=u.slice(u.lastIndexOf(".")+1);c=c||xf.MIME_TYPES[d]||`video/${d}`}o.src=a,c&&(o.type=c),n.appendChild(o)}e=n}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=r.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),r.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const r=$t.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((r,n)=>{this.valid?r(this):(this._resolve=r,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const r=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!r&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&($t.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||($t.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&($t.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,r){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||xf.TYPES.includes(r)}};gf.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],gf.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let E1=gf;rf.push(bs,K_,DP,E1,UP,mf,iu,OP,LP);class Ac{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?we.EMPTY:(e=e||new we(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){const{a:n,b:i,c:s,d:o,tx:a,ty:c}=e,u=n*r.x+s*r.y+a,d=i*r.x+o*r.y+c;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(e){let r=this.minX,n=this.minY,i=this.maxX,s=this.maxY,o=e[0],a=e[1];r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[2],a=e[3],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[4],a=e[5],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,o=e[6],a=e[7],r=o<r?o:r,n=a<n?a:n,i=o>i?o:i,s=a>s?a:s,this.minX=r,this.minY=n,this.maxX=i,this.maxY=s}addFrame(e,r,n,i,s){this.addFrameMatrix(e.worldTransform,r,n,i,s)}addFrameMatrix(e,r,n,i,s){const o=e.a,a=e.b,c=e.c,u=e.d,d=e.tx,h=e.ty;let f=this.minX,p=this.minY,m=this.maxX,v=this.maxY,_=o*r+c*n+d,y=a*r+u*n+h;f=_<f?_:f,p=y<p?y:p,m=_>m?_:m,v=y>v?y:v,_=o*i+c*n+d,y=a*i+u*n+h,f=_<f?_:f,p=y<p?y:p,m=_>m?_:m,v=y>v?y:v,_=o*r+c*s+d,y=a*r+u*s+h,f=_<f?_:f,p=y<p?y:p,m=_>m?_:m,v=y>v?y:v,_=o*i+c*s+d,y=a*i+u*s+h,f=_<f?_:f,p=y<p?y:p,m=_>m?_:m,v=y>v?y:v,this.minX=f,this.minY=p,this.maxX=m,this.maxY=v}addVertexData(e,r,n){let i=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let c=r;c<n;c+=2){const u=e[c],d=e[c+1];i=u<i?u:i,s=d<s?d:s,o=u>o?u:o,a=d>a?d:a}this.minX=i,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,r,n,i){this.addVerticesMatrix(e.worldTransform,r,n,i)}addVerticesMatrix(e,r,n,i,s=0,o=s){const a=e.a,c=e.b,u=e.c,d=e.d,h=e.tx,f=e.ty;let p=this.minX,m=this.minY,v=this.maxX,_=this.maxY;for(let y=n;y<i;y+=2){const x=r[y],g=r[y+1],w=a*x+u*g+h,T=d*g+c*x+f;p=Math.min(p,w-s),v=Math.max(v,w+s),m=Math.min(m,T-o),_=Math.max(_,T+o)}this.minX=p,this.minY=m,this.maxX=v,this.maxY=_}addBounds(e){const r=this.minX,n=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,r){const n=e.minX>r.minX?e.minX:r.minX,i=e.minY>r.minY?e.minY:r.minY,s=e.maxX<r.maxX?e.maxX:r.maxX,o=e.maxY<r.maxY?e.maxY:r.maxY;if(n<=s&&i<=o){const a=this.minX,c=this.minY,u=this.maxX,d=this.maxY;this.minX=n<a?n:a,this.minY=i<c?i:c,this.maxX=s>u?s:u,this.maxY=o>d?o:d}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){const n=e.minX>r.x?e.minX:r.x,i=e.minY>r.y?e.minY:r.y,s=e.maxX<r.x+r.width?e.maxX:r.x+r.width,o=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(n<=s&&i<=o){const a=this.minX,c=this.minY,u=this.maxX,d=this.maxY;this.minX=n<a?n:a,this.minY=i<c?i:c,this.maxX=s>u?s:u,this.maxY=o>d?o:d}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,n,i,s,o){e-=s,r-=o,n+=s,i+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class Ye extends Sa{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Gp,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Ac,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.defineProperty(Ye.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new we),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new we),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Ac);const r=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(n==null?void 0:n.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=n,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,n,i){return r&&(e=r.toGlobal(e,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,r=0,n=1,i=1,s=0,o=0,a=0,c=0,u=0){return this.position.x=e,this.position.y=r,this.scale.x=n||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=c,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new zP),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*jk}set angle(e){this.transform.rotation=e*Bk}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class zP extends Ye{constructor(){super(...arguments),this.sortDirty=null}}Ye.prototype.displayObjectUpdateTransform=Ye.prototype.updateTransform;const GP=new ze;function HP(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const T1=class yf extends Ye{constructor(){super(),this.children=[],this.sortableChildren=yf.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.addChild(e[r]);else{const r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]}addChildAt(e,r){if(r<0||r>this.children.length)throw new Error(`${e}addChildAt: The index ${r} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e}swapChildren(e,r){if(e===r)return;const n=this.getChildIndex(e),i=this.getChildIndex(r);this.children[n]=r,this.children[i]=e,this.onChildrenChange(n<i?n:i)}getChildIndex(e){const r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r}setChildIndex(e,r){if(r<0||r>=this.children.length)throw new Error(`The index ${r} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(e);js(this.children,n,1),this.children.splice(r,0,e),this.onChildrenChange(r)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let r=0;r<e.length;r++)this.removeChild(e[r]);else{const r=e[0],n=this.children.indexOf(r);if(n===-1)return null;r.parent=null,r.transform._parentID=-1,js(this.children,n,1),this._boundsID++,this.onChildrenChange(n),r.emit("removed",this),this.emit("childRemoved",r,this,n)}return e[0]}removeChildAt(e){const r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,js(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r}removeChildren(e=0,r=this.children.length){const n=e,i=r,s=i-n;let o;if(s>0&&s<=i){o=this.children.splice(n,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let r=0,n=this.children.length;r<n;++r){const i=this.children[r];i._lastSortedIndex=r,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(HP),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,r=this.children.length;e<r;++e){const n=this.children[e];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const r=this.children[e];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){const n=r._mask.isMaskData?r._mask.maskObject:r._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,r=!1){const n=super.getLocalBounds(e);if(!r)for(let i=0,s=this.children.length;i<s;++i){const o=this.children[i];o.visible&&o.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const r=e.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==yf.prototype._render&&(n=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=GP.copyFrom(i),i.prepend(s)):i=s),n&&r.intersects(n,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const c=this.children[o],u=c.cullable;c.cullable=u||!this.cullArea,c.render(e),c.cullable=u}}render(e){var r;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(r=this.filters)!=null&&r.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,i=this.children.length;n<i;++n)this.children[n].render(e)}}renderAdvanced(e){var s,o,a;const r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let c=0;c<r.length;c++)r[c].enabled&&this._enabledFilters.push(r[c])}const i=r&&((s=this._enabledFilters)==null?void 0:s.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==st.NONE));if(i&&e.batch.flush(),r&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let c=0,u=this.children.length;c<u;++c)this.children[c].render(e)}i&&e.batch.flush(),n&&e.mask.pop(this),r&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const r=typeof e=="boolean"?e:e==null?void 0:e.children,n=this.removeChildren(0,this.children.length);if(r)for(let i=0;i<n.length;++i)n[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const r=this.getLocalBounds().width;r!==0?this.scale.x=e/r:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const r=this.getLocalBounds().height;r!==0?this.scale.y=e/r:this.scale.y=1,this._height=e}};T1.defaultSortableChildren=!1;let Ut=T1;Ut.prototype.containerUpdateTransform=Ut.prototype.updateTransform;Object.defineProperties(ee,{SORTABLE_CHILDREN:{get(){return Ut.defaultSortableChildren},set(t){Te("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Ut.defaultSortableChildren=t}}});const xo=new Pe,$P=new Uint16Array([0,1,2,0,2,3]);class Jn extends Ut{constructor(e){super(),this._anchor=new rn(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Oe(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=me.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||ie.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=$P,this.pluginName="batch",this.isSprite=!0,this._roundPixels=ee.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Nn(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Nn(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,c=r.ty,u=this.vertexData,d=e.trim,h=e.orig,f=this._anchor;let p=0,m=0,v=0,_=0;if(d?(m=d.x-f._x*h.width,p=m+d.width,_=d.y-f._y*h.height,v=_+d.height):(m=-f._x*h.width,p=m+h.width,_=-f._y*h.height,v=_+h.height),u[0]=n*m+s*_+a,u[1]=o*_+i*m+c,u[2]=n*p+s*_+a,u[3]=o*_+i*p+c,u[4]=n*p+s*v+a,u[5]=o*v+i*p+c,u[6]=n*m+s*v+a,u[7]=o*v+i*m+c,this._roundPixels){const y=ee.RESOLUTION;for(let x=0;x<u.length;++x)u[x]=Math.round(u[x]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,r=this.vertexTrimmedData,n=e.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,c=s.c,u=s.d,d=s.tx,h=s.ty,f=-i._x*n.width,p=f+n.width,m=-i._y*n.height,v=m+n.height;if(r[0]=o*f+c*m+d,r[1]=u*m+a*f+h,r[2]=o*p+c*m+d,r[3]=u*m+a*p+h,r[4]=o*p+c*v+d,r[5]=u*v+a*p+h,r[6]=o*f+c*v+d,r[7]=u*v+a*f+h,this._roundPixels){const _=ee.RESOLUTION;for(let y=0;y<r.length;++y)r[y]=Math.round(r[y]*_)/_}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Ac),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new we),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,xo);const r=this._texture.orig.width,n=this._texture.orig.height,i=-r*this.anchor.x;let s=0;return xo.x>=i&&xo.x<i+r&&(s=-n*this.anchor.y,xo.y>=s&&xo.y<s+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const r=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(e,r){const n=e instanceof ie?e:ie.from(e,r);return new Jn(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const r=Nn(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const r=Nn(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||ie.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const A1=new ze;Ye.prototype._cacheAsBitmap=!1;Ye.prototype._cacheData=null;Ye.prototype._cacheAsBitmapResolution=null;Ye.prototype._cacheAsBitmapMultisample=null;class VP{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Ye.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new VP),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});Ye.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Ye.prototype._initCachedDisplayObject=function(t){var f,p;if((f=this._cacheData)!=null&&f.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(new we,!0);if((p=this.filters)!=null&&p.length){const m=this.filters[0].padding;r.pad(m)}const n=this.cacheAsBitmapResolution||t.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,c=Ui.create({width:r.width,height:r.height,resolution:n,multisample:this.cacheAsBitmapMultisample??t.multisample}),u=`cacheAsBitmap_${Ii()}`;this._cacheData.textureCacheId=u,ve.addToCache(c.baseTexture,u),ie.addToCache(c,u);const d=this.transform.localTransform.copyTo(A1).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const h=new Jn(c);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(r.x/r.width),h.anchor.y=-(r.y/r.height),h.alpha=e,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h)};Ye.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Ye.prototype._initCachedDisplayObjectCanvas=function(t){var d;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.getLocalBounds(new we,!0),r=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Ui.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${Ii()}`;this._cacheData.textureCacheId=a,ve.addToCache(o.baseTexture,a),ie.addToCache(o,a);const c=A1;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=e.x,c.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:c,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const u=new Jn(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};Ye.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Ye.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Ye.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ve.removeFromCache(this._cacheData.textureCacheId),ie.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Ye.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Ye.prototype.name=null;Ut.prototype.getChildByName=function(t,e){for(let r=0,n=this.children.length;r<n;r++)if(this.children[r].name===t)return this.children[r];if(e)for(let r=0,n=this.children.length;r<n;r++){const i=this.children[r];if(!i.getChildByName)continue;const s=i.getChildByName(t,!0);if(s)return s}return null};Ye.prototype.getGlobalPosition=function(t=new Pe,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var WP=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class XP extends At{constructor(e=1){super(NP,WP,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const YP={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},KP=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function qP(t){const e=YP[t],r=e.length;let n=KP,i="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let c=s.replace("%index%",a.toString());o=a,a>=r&&(o=t-a-1),c=c.replace("%value%",e[o].toString()),i+=c,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}const JP=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function QP(t,e){const r=Math.ceil(t/2);let n=JP,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),i+=a,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}class vf extends At{constructor(e,r=8,n=4,i=At.defaultResolution,s=5){const o=QP(s,e),a=qP(s);super(o,a),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=n,this.blur=r}apply(e,r,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,n,i);else{const s=e.getFilterTexture(),o=e.renderer;let a=r,c=s;this.state.blend=!1,e.applyFilter(this,a,c,Nr.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,Nr.BLIT),this.uniforms.uSampler=c;const d=c;c=a,a=d,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,c,n,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class ZP extends At{constructor(e=8,r=4,n=At.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new vf(!0,e,r,n,i),this.blurYFilter=new vf(!1,e,r,n,i),this.resolution=n,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,n,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,r,a,Nr.CLEAR),this.blurYFilter.apply(e,a,n,i),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,r,n,i):this.blurXFilter.apply(e,r,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var eR=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class _f extends At{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(y1,eR,e),this.alpha=1}_loadMatrix(e,r=!1){let n=e;r&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,r,n){return e[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],e[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],e[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],e[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],e[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],e[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],e[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],e[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],e[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],e[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],e[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],e[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],e[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],e[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],e[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],e[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],e[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],e[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],e[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],e[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],e}_colorMatrix(e){const r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(e,r){const[n,i,s]=Oe.shared.setValue(e).toArray(),o=[n,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(e,r){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(e){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;const n=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),c=n+(1-n)*o,u=o*(1-n)-a*i,d=o*(1-n)+a*i,h=o*(1-n)+a*i,f=n+o*(1-n),p=o*(1-n)-a*i,m=o*(1-n)-a*i,v=o*(1-n)+a*i,_=n+o*(1-n),y=[c,u,d,0,0,h,f,p,0,0,m,v,_,0,0,0,0,0,1,0];this._loadMatrix(y,r)}contrast(e,r){const n=(e||0)+1,i=-.5*(n-1),s=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(s,r)}saturate(e=0,r){const n=e*2/3+1,i=(n-1)*-.5,s=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(e){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,n,i,s){e=e||.2,r=r||.15,n=n||16770432,i=i||3375104;const o=Oe.shared,[a,c,u]=o.setValue(n).toArray(),[d,h,f]=o.setValue(i).toArray(),p=[.3,.59,.11,0,0,a,c,u,e,0,d,h,f,r,0,a-d,c-h,u-f,0,0];this._loadMatrix(p,s)}night(e,r){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(e,r){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,r)}lsd(e){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}_f.prototype.grayscale=_f.prototype.greyscale;var tR=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,rR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class nR extends At{constructor(e,r){const n=new ze;e.renderable=!1,super(rR,tR,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,r==null&&(r=20),this.scale=new Pe(r,r)}apply(e,r,n,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,r,n,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var iR=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,sR=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class oR extends At{constructor(){super(sR,iR)}}var aR=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class lR extends At{constructor(e=.5,r=Math.random()){super(y1,aR,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const Vx={AlphaFilter:XP,BlurFilter:ZP,BlurFilterPass:vf,ColorMatrixFilter:_f,DisplacementFilter:nR,FXAAFilter:oR,NoiseFilter:lR};Object.entries(Vx).forEach(([t,e])=>{Object.defineProperty(Vx,t,{get(){return Te("7.1.0",`filters.${t} has moved to ${t}`),e}})});class cR{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||($t.system.add(this.tickerUpdate,this,Mi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&($t.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Rn=new cR;class Aa{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Aa.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Pe,this.page=new Pe,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,n,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Cc extends Aa{constructor(){super(...arguments),this.client=new Pe,this.movement=new Pe,this.offset=new Pe,this.global=new Pe,this.screen=new Pe}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,r,n){return e.worldTransform.applyInverse(n||this.global,r)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,n,i,s,o,a,c,u,d,h,f,p,m,v){throw new Error("Method not implemented.")}}class fr extends Cc{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Ns extends Cc{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Ns.DOM_DELTA_PIXEL=0,Ns.DOM_DELTA_LINE=1,Ns.DOM_DELTA_PAGE=2;const uR=2048,dR=new Pe,kd=new Pe;class hR{constructor(e){this.dispatch=new Sa,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const r=this.mappingTable[e.type];if(r)for(let n=0,i=r.length;n<i;n++)r[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){Rn.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[n](this.rootTarget,this.rootTarget.eventMode,dR.set(e,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,r){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=n.length-1;i<s;i++)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(r)?r:[r];for(let s=n.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=n[s],this.notifyTarget(e,o)})}propagationPath(e){const r=[e];for(let n=0;n<uR&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestMoveRecursive(e,r,n,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(Rn.pauseUpdate=!1),e.interactiveChildren&&e.children){const d=e.children;for(let h=d.length-1;h>=0;h--){const f=d[h],p=this.hitTestMoveRecursive(f,this._isInteractive(r)?r:f.eventMode,n,i,s,o||s(e,n));if(p){if(p.length>0&&!p[p.length-1].parent)continue;const m=e.isInteractive();(p.length>0||m)&&(m&&this._allInteractiveElements.push(e),p.push(e)),this._hitElements.length===0&&(this._hitElements=p),a=!0}}}const c=this._isInteractive(r),u=e.isInteractive();return c&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:c&&!s(e,n)&&i(e,n)?u?[e]:[]:null}hitTestRecursive(e,r,n,i,s){if(this._interactivePrune(e)||s(e,n))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(Rn.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let u=c.length-1;u>=0;u--){const d=c[u],h=this.hitTestRecursive(d,this._isInteractive(r)?r:d.eventMode,n,i,s);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const f=e.isInteractive();return(h.length>0||f)&&h.push(e),h}}}const o=this._isInteractive(r),a=e.isInteractive();return o&&i(e,n)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,r){var n;if(e.hitArea&&(e.worldTransform.applyInverse(r,kd),!e.hitArea.contains(kd.x,kd.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,r)))return!0}return!1}hitTestFn(e,r){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){var s,o;r=r??e.type;const n=`on${r}`;(o=(s=e.currentTarget)[n])==null||o.call(s,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof fr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){var c,u;if(!(e instanceof fr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(((c=i.overTargets)==null?void 0:c.length)>0&&s!==r.target){const d=e.type==="mousemove"?"mouseout":"pointerout",h=this.createPointerEvent(e,d,s);if(this.dispatchEvent(h,"pointerout"),n&&this.dispatchEvent(h,"mouseout"),!r.composedPath().includes(s)){const f=this.createPointerEvent(e,"pointerleave",s);for(f.eventPhase=f.AT_TARGET;f.target&&!r.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),n&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(h)}if(s!==r.target){const d=e.type==="mousemove"?"mouseover":"pointerover",h=this.clonePointerEvent(r,d);this.dispatchEvent(h,"pointerover"),n&&this.dispatchEvent(h,"mouseover");let f=s==null?void 0:s.parent;for(;f&&f!==this.rootTarget.parent&&f!==r.target;)f=f.parent;if(!f||f===this.rootTarget.parent){const p=this.clonePointerEvent(r,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==s&&p.target!==this.rootTarget.parent;)p.currentTarget=p.target,this.notifyTarget(p),n&&this.notifyTarget(p,"mouseenter"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(h)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),n&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=r.target)==null?void 0:u.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){var o;if(!(e instanceof fr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(o=n.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(n,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof fr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId);if(r.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),n&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof fr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const a=n.button===2;this.dispatchEvent(n,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!n.composedPath().includes(s)){let a=s;for(;a&&!n.composedPath().includes(a);){if(n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const c=n.button===2;this.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(n,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:r});const c=i.clicksByButton[e.button];if(c.target===a.target&&r-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=a.target,c.timeStamp=r,a.detail=c.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof fr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let s=n;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof Ns)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let n=1;n<e.length&&e[n].parent===r;n++)r=e[n];return r}createPointerEvent(e,r,n){const i=this.allocateEvent(fr);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof r=="string"&&(i.type=r),i}createWheelEvent(e){const r=this.allocateEvent(Ns);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){const n=this.allocateEvent(fr);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=r??n.type,n}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof fr&&r instanceof fr&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof Cc&&r instanceof Cc&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.shiftKey=e.shiftKey,r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){const n=e.currentTarget._events[r];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(r,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let i=0,s=n.length;i<s&&!e.propagationImmediatelyStopped;i++)n[i].once&&e.currentTarget.removeListener(r,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,e)}}const fR=1,pR={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},wf=class Sf{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new hR(null),Rn.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new fr(null),this.rootWheelEvent=new Ns(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Sf.defaultEventFeatures},{set:(r,n,i)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),r[n]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,Sf._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=r.length;n<i;n++){const s=r[n],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Rn.pointerMoved();const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let r=e.target;e.composedPath&&e.composedPath().length>0&&(r=e.composedPath()[0]);const n=r!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,i[s]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const s=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const r=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(e){this.removeEvents(),this.domElement=e,Rn.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Rn.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Rn.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,r,n){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(r-i.left)*(this.domElement.width/i.width)*s,e.y=(n-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){const r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const s=e.changedTouches[n];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,r.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=fR),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(e);return r}normalizeWheelEvent(e){const r=this.rootWheelEvent;return this.transferMouseData(r,e),r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ,r.deltaMode=e.deltaMode,this.mapPositionToPoint(r.screen,e.clientX,e.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=e,r.type=e.type,r}bootstrapEvent(e,r){return e.originalEvent=null,e.nativeEvent=r,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r),this.mapPositionToPoint(e.screen,r.clientX,r.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=r.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=pR[e.type]||e.type),e}transferMouseData(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=performance.now(),e.type=r.type,e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.relatedTarget=null,e.shiftKey=r.shiftKey}};wf.extension={name:"events",type:[Q.RendererSystem,Q.CanvasRendererSystem]},wf.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let bf=wf;se.add(bf);function Wx(t){return t==="dynamic"||t==="static"}const mR={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Wx(bf.defaultEventMode)},set interactive(t){Te("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??bf.defaultEventMode},set eventMode(t){this._internalInteractive=Wx(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof r=="object"?r.signal:void 0,s=typeof r=="object"?r.once===!0:!1,o=typeof e=="function"?void 0:e;t=n?`${t}capture`:t;const a=typeof e=="function"?e:e.handleEvent,c=this;i&&i.addEventListener("abort",()=>{c.off(t,a,o)}),s?c.once(t,a,o):c.on(t,a,o)},removeEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof Aa))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};Ye.mixin(mR);const gR={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Ye.mixin(gR);const xR=9,al=100,yR=0,vR=0,Xx=2,Yx=1,_R=-1e3,wR=-1e3,SR=2;class C1{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(tn.tablet||tn.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${al}px`,r.style.height=`${al}px`,r.style.position="absolute",r.style.top=`${yR}px`,r.style.left=`${vR}px`,r.style.zIndex=Xx.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${Yx}px`,e.style.height=`${Yx}px`,e.style.position="absolute",e.style.top=`${_R}px`,e.style.left=`${wR}px`,e.style.zIndex=SR.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const r=e.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const e=performance.now();if(tn.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:c}=this.renderer,u=i/o*c,d=s/a*c;let h=this.div;h.style.left=`${r}px`,h.style.top=`${n}px`,h.style.width=`${o}px`,h.style.height=`${a}px`;for(let f=0;f<this.children.length;f++){const p=this.children[f];if(p.renderId!==this.renderId)p._accessibleActive=!1,js(this.children,f,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,f--;else{h=p._accessibleDiv;let m=p.hitArea;const v=p.worldTransform;p.hitArea?(h.style.left=`${(v.tx+m.x*v.a)*u}px`,h.style.top=`${(v.ty+m.y*v.d)*d}px`,h.style.width=`${m.width*v.a*u}px`,h.style.height=`${m.height*v.d*d}px`):(m=p.getBounds(),this.capHitArea(m),h.style.left=`${m.x*u}px`,h.style.top=`${m.y*d}px`,h.style.width=`${m.width*u}px`,h.style.height=`${m.height*d}px`,h.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(h.title=p.accessibleTitle),h.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&h.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==h.title||p.tabIndex!==h.tabIndex)&&(h.title=p.accessibleTitle,h.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:r,height:n}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${al}px`,r.style.height=`${al}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=Xx.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){const{displayObject:n}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new Aa(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===xR&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}C1.extension={name:"accessibility",type:[Q.RendererPlugin,Q.CanvasRendererPlugin]};se.add(C1);const k1=class Ef{constructor(e){this.stage=new Ut,e=Object.assign({forceCanvas:!1},e),this.renderer=MP(e),Ef._plugins.forEach(r=>{r.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,r){const n=Ef._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null}};k1._plugins=[];let P1=k1;se.handleByList(Q.Application,P1._plugins);class R1{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;r=i,n=s}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}R1.extension=Q.Application;se.add(R1);const Kx={loader:Q.LoadParser,resolver:Q.ResolveParser,cache:Q.CacheParser,detection:Q.DetectionParser};se.handle(Q.Asset,t=>{const e=t.ref;Object.entries(Kx).filter(([r])=>!!e[r]).forEach(([r,n])=>se.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(Kx).filter(r=>!!e[r]).forEach(r=>se.remove(e[r]))});class bR{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Zs(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function ni(t,e){const r=t.split("?")[0],n=ht.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const xr=(t,e,r=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>typeof n=="string"||r?e(n):n):t),Tf=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t};function I1(t,e,r,n,i){const s=e[r];for(let o=0;o<s.length;o++){const a=s[o];r<e.length-1?I1(t.replace(n[r],a),e,r+1,n,i):i.push(t.replace(n[r],a))}}function ER(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const i=[];r.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),I1(t,i,0,r,n)}else n.push(t);return n}const kc=t=>!Array.isArray(t);class TR{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=xr(e);let i;for(let a=0;a<this.parsers.length;a++){const c=this.parsers[a];if(c.test(r)){i=c.getCacheableAssets(n,r);break}}i||(i={},n.forEach(a=>{i[a]=r}));const s=Object.keys(i),o={cacheKeys:s,keys:n};if(n.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{const c=i?i[a]:r;this._cache.has(a)&&this._cache.get(a)!==c&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),r instanceof ie){const a=r;n.forEach(c=>{a.baseTexture!==ie.EMPTY.baseTexture&&ve.addToCache(a.baseTexture,c),ie.addToCache(a,c)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const gi=new TR;class AR{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,n)=>(this._parsersValidated=!1,e[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{var o,a;let i=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!s){for(let c=0;c<this.parsers.length;c++){const u=this.parsers[c];if(u.load&&((o=u.test)!=null&&o.call(u,e,r,this))){s=u;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,r,this),n.parser=s;for(let c=0;c<this.parsers.length;c++){const u=this.parsers[c];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,i,r,this))&&(i=await u.parse(i,r,this)||i,n.parser=u)}return i})(),n}async load(e,r){this._parsersValidated||this._validateParsers();let n=0;const i={},s=kc(e),o=xr(e,u=>({alias:[u],src:u})),a=o.length,c=o.map(async u=>{const d=ht.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,u)),i[u.src]=await this.promiseCache[d].promise,r&&r(++n/a)}catch(h){throw delete this.promiseCache[d],delete i[u.src],new Error(`[Loader.load] Failed to load ${d}.
${h}`)}});return await Promise.all(c),s?i[o[0].src]:i}async unload(e){const r=xr(e,n=>({alias:[n],src:n})).map(async n=>{var o,a;const i=ht.toAbsolute(n.src),s=this.promiseCache[i];if(s){const c=await s.promise;delete this.promiseCache[i],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,c,n,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(e[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...e,[r.name]:r}),{})}}var br=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(br||{});const CR=".json",kR="application/json",PR={extension:{type:Q.LoadParser,priority:br.Low},name:"loadJson",test(t){return Zs(t,kR)||ni(t,CR)},async load(t){return await(await ee.ADAPTER.fetch(t)).json()}};se.add(PR);const RR=".txt",IR="text/plain",MR={name:"loadTxt",extension:{type:Q.LoadParser,priority:br.Low},test(t){return Zs(t,IR)||ni(t,RR)},async load(t){return await(await ee.ADAPTER.fetch(t)).text()}};se.add(MR);const jR=["normal","bold","100","200","300","400","500","600","700","800","900"],BR=[".ttf",".otf",".woff",".woff2"],NR=["font/ttf","font/otf","font/woff","font/woff2"],FR=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function LR(t){const e=ht.extname(t),r=ht.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let n=r.length>0;for(const s of r)if(!s.match(FR)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const DR=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function OR(t){return DR.test(t)?t:encodeURI(t)}const UR={extension:{type:Q.LoadParser,priority:br.Low},name:"loadWebFont",test(t){return Zs(t,NR)||ni(t,BR)},async load(t,e){var n,i,s;const r=ee.ADAPTER.getFontFaceSet();if(r){const o=[],a=((n=e.data)==null?void 0:n.family)??LR(t),c=((s=(i=e.data)==null?void 0:i.weights)==null?void 0:s.filter(d=>jR.includes(d)))??["normal"],u=e.data??{};for(let d=0;d<c.length;d++){const h=c[d],f=new FontFace(a,`url(${OR(t)})`,{...u,weight:h});await f.load(),r.add(f),o.push(f)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>ee.ADAPTER.getFontFaceSet().delete(e))}};se.add(UR);const zR=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Fs=null,Af=class{constructor(){Fs||(Fs=URL.createObjectURL(new Blob([zR],{type:"application/javascript"}))),this.worker=new Worker(Fs)}};Af.revokeObjectURL=function(){Fs&&(URL.revokeObjectURL(Fs),Fs=null)};const GR=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Ls=null;class M1{constructor(){Ls||(Ls=URL.createObjectURL(new Blob([GR],{type:"application/javascript"}))),this.worker=new Worker(Ls)}}M1.revokeObjectURL=function(){Ls&&(URL.revokeObjectURL(Ls),Ls=null)};let qx=0,Pd;class HR{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:r}=new Af;r.addEventListener("message",n=>{r.terminate(),Af.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Pd===void 0&&(Pd=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<Pd&&(this._createdWorkers++,e=new M1().worker,e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((i,s)=>{this.queue.push({id:e,arguments:r,resolve:i,reject:s})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const r=this.queue.pop(),n=r.id;this.resolveHash[qx]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:qx++,id:n})}}const Jx=new HR;function Ca(t,e,r){t.resource.internal=!0;const n=new ie(t),i=()=>{delete e.promiseCache[r],gi.has(r)&&gi.remove(r)};return n.baseTexture.once("destroyed",()=>{r in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),n.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const $R=[".jpeg",".jpg",".png",".webp",".avif"],VR=["image/jpeg","image/png","image/webp","image/avif"];async function WR(t){const e=await ee.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}const cu={name:"loadTextures",extension:{type:Q.LoadParser,priority:br.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return Zs(t,VR)||ni(t,$R)},async load(t,e,r){var a;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;n?this.config.preferWorkers&&await Jx.isImageBitmapSupported()?i=await Jx.loadImageBitmap(t):i=await WR(t):i=await new Promise((c,u)=>{const d=new Image;d.crossOrigin=this.config.crossOrigin,d.src=t,d.complete?c(d):(d.onload=()=>c(d),d.onerror=h=>u(h))});const s={...e.data};s.resolution??(s.resolution=dn(t)),n&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new ve(i,s);return o.resource.src=t,Ca(o,r,t)},unload(t){t.destroy(!0)}};se.add(cu);const XR=".svg",YR="image/svg+xml",KR={extension:{type:Q.LoadParser,priority:br.High},name:"loadSVG",test(t){return Zs(t,YR)||ni(t,XR)},async testParse(t){return mf.test(t)},async parse(t,e,r){var s;const n=new mf(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await n.load();const i=new ve(n,{resolution:dn(t),...e==null?void 0:e.data});return i.resource.src=e.src,Ca(i,r,e.src)},async load(t,e){return(await ee.ADAPTER.fetch(t)).text()},unload:cu.unload};se.add(KR);const qR=[".mp4",".m4v",".webm",".ogv"],JR=["video/mp4","video/webm","video/ogg"],QR={name:"loadVideo",extension:{type:Q.LoadParser,priority:br.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return Zs(t,JR)||ni(t,qR)},async load(t,e,r){var o;let n;const i=await(await ee.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},c=new E1(s,a);await c.load();const u=new ve(c,{alphaMode:await ik(),resolution:dn(t),...e==null?void 0:e.data});u.resource.src=t,n=Ca(u,r,t),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return n},unload(t){t.destroy(!0)}};se.add(QR);class ZR{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(e){const{alias:r,name:n,src:i,srcs:s}=e;return xr(r||n||i||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];Array.isArray(r)?r.forEach(i=>{const s=i.src??i.srcs,o=i.alias??i.name;let a;if(typeof o=="string"){const c=this._createBundleAssetId(e,o);n.push(c),a=[o,c]}else{const c=o.map(u=>this._createBundleAssetId(e,u));n.push(...c),a=[...o,...c]}this.add({...i,alias:a,src:s})}):Object.keys(r).forEach(i=>{const s=[i,this._createBundleAssetId(e,i)];if(typeof r[i]=="string")this.add({alias:s,src:r[i]});else if(Array.isArray(r[i]))this.add({alias:s,src:r[i]});else{const o=r[i],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}n.push(...s)}),this._bundles[e]=n}add(e,r,n,i,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(Te("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:r,data:n,format:i,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=c=>{this.hasKey(c)&&console.warn(`[Resolver] already has key: ${c} overwriting`)},xr(o).forEach(c=>{const{src:u,srcs:d}=c;let{data:h,format:f,loadParser:p}=c;const m=xr(u||d).map(y=>typeof y=="string"?ER(y):Array.isArray(y)?y:[y]),v=this.getAlias(c);Array.isArray(v)?v.forEach(a):a(v);const _=[];m.forEach(y=>{y.forEach(x=>{let g={};if(typeof x!="object"){g.src=x;for(let w=0;w<this._parsers.length;w++){const T=this._parsers[w];if(T.test(x)){g=T.parse(x);break}}}else h=x.data??h,f=x.format??f,p=x.loadParser??p,g={...g,...x};if(!v)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this.buildResolvedAsset(g,{aliases:v,data:h,format:f,loadParser:p}),_.push(g)})}),v.forEach(y=>{this._assetMap[y]=_})})}resolveBundle(e){const r=kc(e);e=xr(e);const n={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const c in o){const u=o[c];a[this._extractAssetIdFromBundle(i,c)]=u}n[i]=a}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const i in r)n[i]=r[i].src;return n}return r.src}resolve(e){const r=kc(e);e=xr(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(c=>{a.params[c].forEach(u=>{const d=s.filter(h=>h[c]?h[c]===u:!1);d.length&&(s=d)})}),this._resolverHash[i]=s[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),r?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}buildResolvedAsset(e,r){const{aliases:n,data:i,loadParser:s,format:o}=r;return(this._basePath||this._rootPath)&&(e.src=ht.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??ht.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class eI{constructor(){this._detections=[],this._initialized=!1,this.resolver=new ZR,this.loader=new AR,this.cache=gi,this._backgroundLoader=new bR(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const r=((s=e.texturePreference)==null?void 0:s.resolution)??1,n=typeof r=="number"?[r]:r,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e,r,n,i,s){this.resolver.add(e,r,n,i,s)}async load(e,r){this._initialized||await this.init();const n=kc(e),i=xr(e).map(a=>{if(typeof a!="string"){const c=this.resolver.getAlias(a);return c.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(c)?c[0]:c}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,r);return n?o[i[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,c=0;const u=()=>{r==null||r(++a/c)},d=o.map(h=>{const f=i[h];return c+=Object.keys(f).length,this._mapLoadToResolve(f,u).then(p=>{s[h]=p})});return await Promise.all(d),n?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return gi.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=gi.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(n,r);this._backgroundLoader.active=!0;const o={};return n.forEach((a,c)=>{const u=s[a.src],d=[a.src];a.alias&&d.push(...a.alias),o[i[c]]=u,gi.set(d,u)}),o}async unload(e){this._initialized||await this.init();const r=xr(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=xr(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{gi.remove(n.src)}),await this.loader.unload(r)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?r=await n.add(r):e.skipDetections||(r=await n.remove(r));return r=r.filter((n,i)=>r.indexOf(n)===i),r}get detections(){return this._detections}get preferWorkers(){return cu.config.preferWorkers}set preferWorkers(e){Te("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in e).forEach(n=>{r.config[n]=e[n]})})}}const Ao=new eI;se.handleByList(Q.LoadParser,Ao.loader.parsers).handleByList(Q.ResolveParser,Ao.resolver.parsers).handleByList(Q.CacheParser,Ao.cache.parsers).handleByList(Q.DetectionParser,Ao.detections);const tI={extension:Q.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof ie),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((i,s)=>{r[n+(s===0?"":s+1)]=i})}),r}};se.add(tI);async function j1(t){if("Image"in globalThis)return new Promise(e=>{const r=new Image;r.onload=()=>{e(!0)},r.onerror=()=>{e(!1)},r.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const rI={extension:{type:Q.DetectionParser,priority:1},test:async()=>j1("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};se.add(rI);const nI={extension:{type:Q.DetectionParser,priority:0},test:async()=>j1("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};se.add(nI);const Qx=["png","jpg","jpeg"],iI={extension:{type:Q.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...Qx],remove:async t=>t.filter(e=>!Qx.includes(e))};se.add(iI);const sI="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Vp(t){return sI?!1:document.createElement("video").canPlayType(t)!==""}const oI={extension:{type:Q.DetectionParser,priority:0},test:async()=>Vp("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};se.add(oI);const aI={extension:{type:Q.DetectionParser,priority:0},test:async()=>Vp("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};se.add(aI);const lI={extension:{type:Q.DetectionParser,priority:0},test:async()=>Vp("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};se.add(lI);const cI={extension:Q.ResolveParser,test:cu.test,parse:t=>{var e;return{resolution:parseFloat(((e=ee.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:ht.extname(t).slice(1),src:t}}};se.add(cI);var ft=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(ft||{});const Pc={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Rr,as;function Zx(){as={bptc:Rr.getExtension("EXT_texture_compression_bptc"),astc:Rr.getExtension("WEBGL_compressed_texture_astc"),etc:Rr.getExtension("WEBGL_compressed_texture_etc"),s3tc:Rr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Rr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Rr.getExtension("WEBGL_compressed_texture_pvrtc")||Rr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Rr.getExtension("WEBGL_compressed_texture_etc1"),atc:Rr.getExtension("WEBGL_compressed_texture_atc")}}const uI={extension:{type:Q.DetectionParser,priority:2},test:async()=>{const t=ee.ADAPTER.createCanvas().getContext("webgl");return t?(Rr=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{as||Zx();const e=[];for(const r in as)as[r]&&e.push(r);return[...e,...t]},remove:async t=>(as||Zx(),t.filter(e=>!(e in as)))};se.add(uI);class dI extends iu{constructor(e,r={width:1,height:1,autoLoad:!0}){let n,i;typeof e=="string"?(n=e,i=new Uint8Array):(n=null,i=e),super(i,r),this.origin=n,this.buffer=i?new tf(i):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new tf(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class Ei extends dI{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=Ei._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||Ei._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,n){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:c,levelHeight:u,levelBuffer:d}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,c,u,0,d)}return!0}onBlobLoaded(){this._levelBuffers=Ei._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,r,n,i,s,o,a){const c=new Array(n);let u=e.byteOffset,d=o,h=a,f=d+i-1&~(i-1),p=h+s-1&~(s-1),m=f*p*Pc[r];for(let v=0;v<n;v++)c[v]={levelID:v,levelWidth:n>1?d:f,levelHeight:n>1?h:p,levelBuffer:new Uint8Array(e.buffer,u,m)},u+=m,d=d>>1||1,h=h>>1||1,f=d+i-1&~(i-1),p=h+s-1&~(s-1),m=f*p*Pc[r];return c}}const Rd=4,ll=124,hI=32,ey=20,fI=542327876,cl={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},pI={FOURCC:2},ul={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},mI=1,gI=2,xI=4,yI=64,vI=512,_I=131072,wI=827611204,SI=861165636,bI=894720068,EI=808540228,TI=4,AI={[wI]:ft.COMPRESSED_RGBA_S3TC_DXT1_EXT,[SI]:ft.COMPRESSED_RGBA_S3TC_DXT3_EXT,[bI]:ft.COMPRESSED_RGBA_S3TC_DXT5_EXT},CI={70:ft.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:ft.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:ft.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:ft.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:ft.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:ft.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:ft.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:ft.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:ft.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:ft.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:ft.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:ft.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:ft.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function kI(t){const e=new Uint32Array(t);if(e[0]!==fI)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,ll/Uint32Array.BYTES_PER_ELEMENT),n=r[cl.HEIGHT],i=r[cl.WIDTH],s=r[cl.MIPMAP_COUNT],o=new Uint32Array(t,cl.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,hI/Uint32Array.BYTES_PER_ELEMENT),a=o[mI];if(a&xI){const c=o[pI.FOURCC];if(c!==EI){const x=AI[c],g=Rd+ll,w=new Uint8Array(t,g);return[new Ei(w,{format:x,width:i,height:n,levels:s})]}const u=Rd+ll,d=new Uint32Array(e.buffer,u,ey/Uint32Array.BYTES_PER_ELEMENT),h=d[ul.DXGI_FORMAT],f=d[ul.RESOURCE_DIMENSION],p=d[ul.MISC_FLAG],m=d[ul.ARRAY_SIZE],v=CI[h];if(v===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(p===TI)throw new Error("DDSParser does not support cubemap textures");if(f===6)throw new Error("DDSParser does not supported 3D texture data");const _=new Array,y=Rd+ll+ey;if(m===1)_.push(new Uint8Array(t,y));else{const x=Pc[v];let g=0,w=i,T=n;for(let C=0;C<s;C++){const b=Math.max(1,w+3&-4),I=Math.max(1,T+3&-4),N=b*I*x;g+=N,w=w>>>1,T=T>>>1}let A=y;for(let C=0;C<m;C++)_.push(new Uint8Array(t,A,g)),A+=g}return _.map(x=>new Ei(x,{format:v,width:i,height:n,levels:s}))}throw a&yI?new Error("DDSParser does not support uncompressed texture data."):a&vI?new Error("DDSParser does not supported YUV uncompressed texture data."):a&_I?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&gI?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const ty=[171,75,84,88,32,49,49,187,13,10,26,10],PI=67305985,dr={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Cf=64,ry={[ce.UNSIGNED_BYTE]:1,[ce.UNSIGNED_SHORT]:2,[ce.INT]:4,[ce.UNSIGNED_INT]:4,[ce.FLOAT]:4,[ce.HALF_FLOAT]:8},RI={[X.RGBA]:4,[X.RGB]:3,[X.RG]:2,[X.RED]:1,[X.LUMINANCE]:1,[X.LUMINANCE_ALPHA]:2,[X.ALPHA]:1},II={[ce.UNSIGNED_SHORT_4_4_4_4]:2,[ce.UNSIGNED_SHORT_5_5_5_1]:2,[ce.UNSIGNED_SHORT_5_6_5]:2};function MI(t,e,r=!1){const n=new DataView(e);if(!jI(t,n))return null;const i=n.getUint32(dr.ENDIANNESS,!0)===PI,s=n.getUint32(dr.GL_TYPE,i),o=n.getUint32(dr.GL_FORMAT,i),a=n.getUint32(dr.GL_INTERNAL_FORMAT,i),c=n.getUint32(dr.PIXEL_WIDTH,i),u=n.getUint32(dr.PIXEL_HEIGHT,i)||1,d=n.getUint32(dr.PIXEL_DEPTH,i)||1,h=n.getUint32(dr.NUMBER_OF_ARRAY_ELEMENTS,i)||1,f=n.getUint32(dr.NUMBER_OF_FACES,i),p=n.getUint32(dr.NUMBER_OF_MIPMAP_LEVELS,i),m=n.getUint32(dr.BYTES_OF_KEY_VALUE_DATA,i);if(u===0||d!==1)throw new Error("Only 2D textures are supported");if(f!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");const v=4,_=4,y=c+3&-4,x=u+3&-4,g=new Array(h);let w=c*u;s===0&&(w=y*x);let T;if(s!==0?ry[s]?T=ry[s]*RI[o]:T=II[s]:T=Pc[a],T===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const A=r?NI(n,m,i):null;let C=w*T,b=c,I=u,N=y,L=x,D=Cf+m;for(let P=0;P<p;P++){const O=n.getUint32(D,i);let z=D+4;for(let H=0;H<h;H++){let W=g[H];W||(W=g[H]=new Array(p)),W[P]={levelID:P,levelWidth:p>1||s!==0?b:N,levelHeight:p>1||s!==0?I:L,levelBuffer:new Uint8Array(e,z,C)},z+=C}D+=O+4,D=D%4!==0?D+4-D%4:D,b=b>>1||1,I=I>>1||1,N=b+v-1&-4,L=I+_-1&-4,C=N*L*T}return s!==0?{uncompressed:g.map(P=>{let O=P[0].levelBuffer,z=!1;return s===ce.FLOAT?O=new Float32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4):s===ce.UNSIGNED_INT?(z=!0,O=new Uint32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)):s===ce.INT&&(z=!0,O=new Int32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)),{resource:new iu(O,{width:P[0].levelWidth,height:P[0].levelHeight}),type:s,format:z?BI(o):o}}),kvData:A}:{compressed:g.map(P=>new Ei(null,{format:a,width:c,height:u,levels:p,levelBuffers:P})),kvData:A}}function jI(t,e){for(let r=0;r<ty.length;r++)if(e.getUint8(r)!==ty[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function BI(t){switch(t){case X.RGBA:return X.RGBA_INTEGER;case X.RGB:return X.RGB_INTEGER;case X.RG:return X.RG_INTEGER;case X.RED:return X.RED_INTEGER;default:return t}}function NI(t,e,r){const n=new Map;let i=0;for(;i<e;){const s=t.getUint32(Cf+i,r),o=Cf+i+4,a=3-(s+3)%4;if(s===0||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<s&&t.getUint8(o+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(t.buffer,o,c)),d=new DataView(t.buffer,o+c+1,s-c-1);n.set(u,d),i+=4+s+a}return n}const FI={extension:{type:Q.LoadParser,priority:br.High},name:"loadDDS",test(t){return ni(t,".dds")},async load(t,e,r){const n=await(await ee.ADAPTER.fetch(t)).arrayBuffer(),i=kI(n).map(s=>{const o=new ve(s,{mipmap:Hr.OFF,alphaMode:Nt.NO_PREMULTIPLIED_ALPHA,resolution:dn(t),...e.data});return Ca(o,r,t)});return i.length===1?i[0]:i},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};se.add(FI);const LI={extension:{type:Q.LoadParser,priority:br.High},name:"loadKTX",test(t){return ni(t,".ktx")},async load(t,e,r){const n=await(await ee.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=MI(t,n),a=i??s,c={mipmap:Hr.OFF,alphaMode:Nt.NO_PREMULTIPLIED_ALPHA,resolution:dn(t),...e.data},u=a.map(d=>{a===s&&Object.assign(c,{type:d.type,format:d.format});const h=d.resource??d,f=new ve(h,c);return f.ktxKeyValueData=o,Ca(f,r,t)});return u.length===1?u[0]:u},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};se.add(LI);const DI=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],OI={extension:Q.ResolveParser,test:t=>{const e=ht.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var n,i;const e=t.split("."),r=e.pop();if(["ktx","dds"].includes(r)){const s=e.pop();if(DI.includes(s))return{resolution:parseFloat(((n=ee.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:s,src:t}}return{resolution:parseFloat(((i=ee.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:r,src:t}}};se.add(OI);const dl=new we,UI=4,B1=class Co{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var r;const e=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,r,n,i){const s=new Image;return s.src=await this.base64(e,r,n,i),s}async base64(e,r,n,i){const s=this.canvas(e,i);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(c=>{if(!c){a(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>o(u.result),u.onerror=a,u.readAsDataURL(c)},r,n)});if(s.toDataURL!==void 0)return s.toDataURL(r,n);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:r,quality:n});return new Promise((a,c)=>{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=c,u.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);o&&Co._flipY(n,i,s),a&&Co._unpremultiplyAlpha(n);const c=new _k(i,s,1),u=new ImageData(new Uint8ClampedArray(n.buffer),i,s);return c.context.putImageData(u,0,0),c.canvas}pixels(e,r){const{pixels:n,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,r);return o&&Co._flipY(n,i,s),a&&Co._unpremultiplyAlpha(n),n}_rawPixels(e,r){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let i,s=!1,o=!1,a,c=!1;e&&(e instanceof Ui?a=e:(a=n.generateTexture(e,{region:r,resolution:n.resolution,multisample:n.multisample}),c=!0,r&&(dl.width=r.width,dl.height=r.height,r=dl)));const u=n.gl;if(a){if(i=a.baseTexture.resolution,r=r??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===X.RGBA,!c){n.renderTexture.bind(a);const p=a.framebuffer.glFramebuffers[n.CONTEXT_UID];p.blitFramebuffer&&n.framebuffer.bind(p.blitFramebuffer)}}else i=n.resolution,r||(r=dl,r.width=n.width/i,r.height=n.height/i),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const d=Math.max(Math.round(r.width*i),1),h=Math.max(Math.round(r.height*i),1),f=new Uint8Array(UI*d*h);return u.readPixels(Math.round(r.x*i),Math.round(r.y*i),d,h,u.RGBA,u.UNSIGNED_BYTE,f),c&&(a==null||a.destroy(!0)),{pixels:f,width:d,height:h,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,r,n){const i=r<<2,s=n>>1,o=new Uint8Array(i);for(let a=0;a<s;a++){const c=a*i,u=(n-a-1)*i;o.set(e.subarray(c,c+i)),e.copyWithin(c,u,u+i),e.set(o,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const r=e.length;for(let n=0;n<r;n+=4){const i=e[n+3];if(i!==0){const s=255.001/i;e[n]=e[n]*s+.5,e[n+1]=e[n+1]*s+.5,e[n+2]=e[n+2]*s+.5}}}};B1.extension={name:"extract",type:Q.RendererSystem};let zI=B1;se.add(zI);const Rc={build(t){const e=t.points;let r,n,i,s,o,a;if(t.type===mt.CIRC){const m=t.shape;r=m.x,n=m.y,o=a=m.radius,i=s=0}else if(t.type===mt.ELIP){const m=t.shape;r=m.x,n=m.y,o=m.width,a=m.height,i=s=0}else{const m=t.shape,v=m.width/2,_=m.height/2;r=m.x+v,n=m.y+_,o=a=Math.max(0,Math.min(m.radius,Math.min(v,_))),i=v-o,s=_-a}if(!(o>=0&&a>=0&&i>=0&&s>=0)){e.length=0;return}const c=Math.ceil(2.3*Math.sqrt(o+a)),u=c*8+(i?4:0)+(s?4:0);if(e.length=u,u===0)return;if(c===0){e.length=8,e[0]=e[6]=r+i,e[1]=e[3]=n+s,e[2]=e[4]=r-i,e[5]=e[7]=n-s;return}let d=0,h=c*4+(i?2:0)+2,f=h,p=u;{const m=i+o,v=s,_=r+m,y=r-m,x=n+v;if(e[d++]=_,e[d++]=x,e[--h]=x,e[--h]=y,s){const g=n-v;e[f++]=y,e[f++]=g,e[--p]=g,e[--p]=_}}for(let m=1;m<c;m++){const v=Math.PI/2*(m/c),_=i+Math.cos(v)*o,y=s+Math.sin(v)*a,x=r+_,g=r-_,w=n+y,T=n-y;e[d++]=x,e[d++]=w,e[--h]=w,e[--h]=g,e[f++]=g,e[f++]=T,e[--p]=T,e[--p]=x}{const m=i,v=s+a,_=r+m,y=r-m,x=n+v,g=n-v;e[d++]=_,e[d++]=x,e[--p]=g,e[--p]=_,i&&(e[d++]=y,e[d++]=x,e[--p]=g,e[--p]=y)}},triangulate(t,e){const r=t.points,n=e.points,i=e.indices;if(r.length===0)return;let s=n.length/2;const o=s;let a,c;if(t.type!==mt.RREC){const d=t.shape;a=d.x,c=d.y}else{const d=t.shape;a=d.x+d.width/2,c=d.y+d.height/2}const u=t.matrix;n.push(t.matrix?u.a*a+u.c*c+u.tx:a,t.matrix?u.b*a+u.d*c+u.ty:c),s++,n.push(r[0],r[1]);for(let d=2;d<r.length;d+=2)n.push(r[d],r[d+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function ny(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let i=0,s=t[r-2],o=t[r-1];i<r;i+=2){const a=t[i],c=t[i+1];n+=(a-s)*(c+o),s=a,o=c}if(!e&&n>0||e&&n<=0){const i=r/2;for(let s=i+i%2;s<r;s+=2){const o=r-s-2,a=r-s-1,c=s,u=s+1;[t[o],t[c]]=[t[c],t[o]],[t[a],t[u]]=[t[u],t[a]]}}}const N1={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const n=t.holes,i=e.points,s=e.indices;if(r.length>=6){ny(r,!1);const o=[];for(let u=0;u<n.length;u++){const d=n[u];ny(d.points,!0),o.push(r.length/2),r=r.concat(d.points)}const a=HT(r,o,2);if(!a)return;const c=i.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+c),s.push(a[u+1]+c),s.push(a[u+2]+c);for(let u=0;u<r.length;u++)i.push(r[u])}}},GI={build(t){const e=t.shape,r=e.x,n=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(r,n,r+i,n,r+i,n+s,r,n+s)},triangulate(t,e){const r=t.points,n=e.points;if(r.length===0)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},HI={build(t){Rc.build(t)},triangulate(t,e){Rc.triangulate(t,e)}};var Qt=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Qt||{}),Fn=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(Fn||{});const Xs={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class iy{static curveTo(e,r,n,i,s,o){const a=o[o.length-2],c=o[o.length-1]-r,u=a-e,d=i-r,h=n-e,f=Math.abs(c*h-u*d);if(f<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==r)&&o.push(e,r),null;const p=c*c+u*u,m=d*d+h*h,v=c*d+u*h,_=s*Math.sqrt(p)/f,y=s*Math.sqrt(m)/f,x=_*v/p,g=y*v/m,w=_*h+y*u,T=_*d+y*c,A=u*(y+x),C=c*(y+x),b=h*(_+g),I=d*(_+g),N=Math.atan2(C-T,A-w),L=Math.atan2(I-T,b-w);return{cx:w+e,cy:T+r,radius:s,startAngle:N,endAngle:L,anticlockwise:u*d>h*c}}static arc(e,r,n,i,s,o,a,c,u){const d=a-o,h=Xs._segmentsCount(Math.abs(d)*s,Math.ceil(Math.abs(d)/wc)*40),f=d/(h*2),p=f*2,m=Math.cos(f),v=Math.sin(f),_=h-1,y=_%1/_;for(let x=0;x<=_;++x){const g=x+y*x,w=f+o+p*g,T=Math.cos(w),A=-Math.sin(w);u.push((m*T+v*A)*s+n,(m*-A+v*T)*s+i)}}}class $I{constructor(){this.reset()}begin(e,r,n){this.reset(),this.style=e,this.start=r,this.attribStart=n}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Wp{static curveLength(e,r,n,i,s,o,a,c){let u=0,d=0,h=0,f=0,p=0,m=0,v=0,_=0,y=0,x=0,g=0,w=e,T=r;for(let A=1;A<=10;++A)d=A/10,h=d*d,f=h*d,p=1-d,m=p*p,v=m*p,_=v*e+3*m*d*n+3*p*h*s+f*a,y=v*r+3*m*d*i+3*p*h*o+f*c,x=w-_,g=T-y,w=_,T=y,u+=Math.sqrt(x*x+g*g);return u}static curveTo(e,r,n,i,s,o,a){const c=a[a.length-2],u=a[a.length-1];a.length-=2;const d=Xs._segmentsCount(Wp.curveLength(c,u,e,r,n,i,s,o));let h=0,f=0,p=0,m=0,v=0;a.push(c,u);for(let _=1,y=0;_<=d;++_)y=_/d,h=1-y,f=h*h,p=f*h,m=y*y,v=m*y,a.push(p*c+3*f*y*e+3*h*m*n+v*s,p*u+3*f*y*r+3*h*m*i+v*o)}}function sy(t,e,r,n,i,s,o,a){const c=t-r*i,u=e-n*i,d=t+r*s,h=e+n*s;let f,p;o?(f=n,p=-r):(f=-n,p=r);const m=c+f,v=u+p,_=d+f,y=h+p;return a.push(m,v,_,y),2}function oi(t,e,r,n,i,s,o,a){const c=r-t,u=n-e;let d=Math.atan2(c,u),h=Math.atan2(i-t,s-e);a&&d<h?d+=Math.PI*2:!a&&d>h&&(h+=Math.PI*2);let f=d;const p=h-d,m=Math.abs(p),v=Math.sqrt(c*c+u*u),_=(15*m*Math.sqrt(v)/Math.PI>>0)+1,y=p/_;if(f+=y,a){o.push(t,e,r,n);for(let x=1,g=f;x<_;x++,g+=y)o.push(t,e,t+Math.sin(g)*v,e+Math.cos(g)*v);o.push(t,e,i,s)}else{o.push(r,n,t,e);for(let x=1,g=f;x<_;x++,g+=y)o.push(t+Math.sin(g)*v,e+Math.cos(g)*v,t,e);o.push(i,s,t,e)}return _*2}function VI(t,e){const r=t.shape;let n=t.points||r.points.slice();const i=e.closePointEps;if(n.length===0)return;const s=t.lineStyle,o=new Pe(n[0],n[1]),a=new Pe(n[n.length-2],n[n.length-1]),c=r.type!==mt.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(c){n=n.slice(),u&&(n.pop(),n.pop(),a.set(n[n.length-2],n[n.length-1]));const W=(o.x+a.x)*.5,k=(a.y+o.y)*.5;n.unshift(W,k),n.push(W,k)}const d=e.points,h=n.length/2;let f=n.length;const p=d.length/2,m=s.width/2,v=m*m,_=s.miterLimit*s.miterLimit;let y=n[0],x=n[1],g=n[2],w=n[3],T=0,A=0,C=-(x-w),b=y-g,I=0,N=0,L=Math.sqrt(C*C+b*b);C/=L,b/=L,C*=m,b*=m;const D=s.alignment,P=(1-D)*2,O=D*2;c||(s.cap===Fn.ROUND?f+=oi(y-C*(P-O)*.5,x-b*(P-O)*.5,y-C*P,x-b*P,y+C*O,x+b*O,d,!0)+2:s.cap===Fn.SQUARE&&(f+=sy(y,x,C,b,P,O,!0,d))),d.push(y-C*P,x-b*P,y+C*O,x+b*O);for(let W=1;W<h-1;++W){y=n[(W-1)*2],x=n[(W-1)*2+1],g=n[W*2],w=n[W*2+1],T=n[(W+1)*2],A=n[(W+1)*2+1],C=-(x-w),b=y-g,L=Math.sqrt(C*C+b*b),C/=L,b/=L,C*=m,b*=m,I=-(w-A),N=g-T,L=Math.sqrt(I*I+N*N),I/=L,N/=L,I*=m,N*=m;const k=g-y,U=x-w,R=g-T,E=A-w,F=k*R+U*E,j=U*R-E*k,q=j<0;if(Math.abs(j)<.001*Math.abs(F)){d.push(g-C*P,w-b*P,g+C*O,w+b*O),F>=0&&(s.join===Qt.ROUND?f+=oi(g,w,g-C*P,w-b*P,g-I*P,w-N*P,d,!1)+4:f+=2,d.push(g-I*O,w-N*O,g+I*P,w+N*P));continue}const J=(-C+y)*(-b+w)-(-C+g)*(-b+x),B=(-I+T)*(-N+w)-(-I+g)*(-N+A),Y=(k*B-R*J)/j,ge=(E*J-U*B)/j,pe=(Y-g)*(Y-g)+(ge-w)*(ge-w),te=g+(Y-g)*P,fe=w+(ge-w)*P,M=g-(Y-g)*O,K=w-(ge-w)*O,ne=Math.min(k*k+U*U,R*R+E*E),ue=q?P:O,ke=ne+ue*ue*v,Le=pe<=ke;let et=s.join;if(et===Qt.MITER&&pe/v>_&&(et=Qt.BEVEL),Le)switch(et){case Qt.MITER:{d.push(te,fe,M,K);break}case Qt.BEVEL:{q?d.push(te,fe,g+C*O,w+b*O,te,fe,g+I*O,w+N*O):d.push(g-C*P,w-b*P,M,K,g-I*P,w-N*P,M,K),f+=2;break}case Qt.ROUND:{q?(d.push(te,fe,g+C*O,w+b*O),f+=oi(g,w,g+C*O,w+b*O,g+I*O,w+N*O,d,!0)+4,d.push(te,fe,g+I*O,w+N*O)):(d.push(g-C*P,w-b*P,M,K),f+=oi(g,w,g-C*P,w-b*P,g-I*P,w-N*P,d,!1)+4,d.push(g-I*P,w-N*P,M,K));break}}else{switch(d.push(g-C*P,w-b*P,g+C*O,w+b*O),et){case Qt.MITER:{q?d.push(M,K,M,K):d.push(te,fe,te,fe),f+=2;break}case Qt.ROUND:{q?f+=oi(g,w,g+C*O,w+b*O,g+I*O,w+N*O,d,!0)+2:f+=oi(g,w,g-C*P,w-b*P,g-I*P,w-N*P,d,!1)+2;break}}d.push(g-I*P,w-N*P,g+I*O,w+N*O),f+=2}}y=n[(h-2)*2],x=n[(h-2)*2+1],g=n[(h-1)*2],w=n[(h-1)*2+1],C=-(x-w),b=y-g,L=Math.sqrt(C*C+b*b),C/=L,b/=L,C*=m,b*=m,d.push(g-C*P,w-b*P,g+C*O,w+b*O),c||(s.cap===Fn.ROUND?f+=oi(g-C*(P-O)*.5,w-b*(P-O)*.5,g-C*P,w-b*P,g+C*O,w+b*O,d,!1)+2:s.cap===Fn.SQUARE&&(f+=sy(g,w,C,b,P,O,!1,d)));const z=e.indices,H=Xs.epsilon*Xs.epsilon;for(let W=p;W<f+p-2;++W)y=d[W*2],x=d[W*2+1],g=d[(W+1)*2],w=d[(W+1)*2+1],T=d[(W+2)*2],A=d[(W+2)*2+1],!(Math.abs(y*(w-A)+g*(A-x)+T*(x-w))<H)&&z.push(W,W+1,W+2)}function WI(t,e){let r=0;const n=t.shape,i=t.points||n.points,s=n.type!==mt.POLY||n.closeStroke;if(i.length===0)return;const o=e.points,a=e.indices,c=i.length/2,u=o.length/2;let d=u;for(o.push(i[0],i[1]),r=1;r<c;r++)o.push(i[r*2],i[r*2+1]),a.push(d,d+1),d++;s&&a.push(d,u)}function oy(t,e){t.lineStyle.native?WI(t,e):VI(t,e)}class Xp{static curveLength(e,r,n,i,s,o){const a=e-2*n+s,c=r-2*i+o,u=2*n-2*e,d=2*i-2*r,h=4*(a*a+c*c),f=4*(a*u+c*d),p=u*u+d*d,m=2*Math.sqrt(h+f+p),v=Math.sqrt(h),_=2*h*v,y=2*Math.sqrt(p),x=f/v;return(_*m+v*f*(m-y)+(4*p*h-f*f)*Math.log((2*v+x+m)/(x+y)))/(4*_)}static curveTo(e,r,n,i,s){const o=s[s.length-2],a=s[s.length-1],c=Xs._segmentsCount(Xp.curveLength(o,a,e,r,n,i));let u=0,d=0;for(let h=1;h<=c;++h){const f=h/c;u=o+(e-o)*f,d=a+(r-a)*f,s.push(u+(e+(n-e)*f-u)*f,d+(r+(i-r)*f-d)*f)}}}const Id={[mt.POLY]:N1,[mt.CIRC]:Rc,[mt.ELIP]:Rc,[mt.RECT]:GI,[mt.RREC]:HI},ay=[],hl=[];class Ic{constructor(e,r=null,n=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=r,this.matrix=i,this.type=e.type}clone(){return new Ic(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Zi=new Pe,F1=class L1 extends z_{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Ac,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),hl.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r.reset(),ay.push(r)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,r=null,n=null,i=null){const s=new Ic(e,r,n,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,r=null){if(!this.graphicsData.length)return null;const n=new Ic(e,null,null,r),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const r=this.graphicsData;for(let n=0;n<r.length;++n){const i=r[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,Zi):Zi.copyFrom(e),i.shape.contains(Zi.x,Zi.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Zi.x,Zi.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,r=this.graphicsData;let n=null,i=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],i=n.style);for(let c=this.shapeIndex;c<r.length;c++){this.shapeIndex++;const u=r[c],d=u.fillStyle,h=u.lineStyle;Id[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(d.visible||h.visible)&&this.processHoles(u.holes);for(let f=0;f<2;f++){const p=f===0?d:h;if(!p.visible)continue;const m=p.texture.baseTexture,v=this.indices.length,_=this.points.length/2;m.wrapMode=Wn.REPEAT,f===0?this.processFill(u):this.processLine(u);const y=this.points.length/2-_;y!==0&&(n&&!this._compareStyles(i,p)&&(n.end(v,_),n=null),n||(n=ay.pop()||new $I,n.begin(p,v,_),this.batches.push(n),i=p),this.addUvs(this.points,e,p.texture,_,y,p.matrix))}}const s=this.indices.length,o=this.points.length/2;if(n&&n.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,r){return!(!e||!r||e.texture.baseTexture!==r.texture.baseTexture||e.color+e.alpha!==r.color+r.alpha||!!e.native!=!!r.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,r=this.graphicsData.length;e<r;e++){const n=this.graphicsData[e],i=n.fillStyle,s=n.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let r=0,n=e.length;r<n;r++){const i=e[r];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<L1.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++ve._globalBatch;for(let h=0;h<this.drawCalls.length;h++)this.drawCalls[h].texArray.clear(),hl.push(this.drawCalls[h]);this.drawCalls.length=0;const r=this.colors,n=this.textureIds;let i=hl.pop();i||(i=new sf,i.texArray=new cf),i.texArray.count=0,i.start=0,i.size=0,i.type=Dr.TRIANGLES;let s=0,o=null,a=0,c=!1,u=Dr.TRIANGLES,d=0;this.drawCalls.push(i);for(let h=0;h<this.batches.length;h++){const f=this.batches[h],p=8,m=f.style,v=m.texture.baseTexture;c!==!!m.native&&(c=!!m.native,u=c?Dr.LINES:Dr.TRIANGLES,o=null,s=p,e++),o!==v&&(o=v,v._batchEnabled!==e&&(s===p&&(e++,s=0,i.size>0&&(i=hl.pop(),i||(i=new sf,i.texArray=new cf),this.drawCalls.push(i)),i.start=d,i.size=0,i.texArray.count=0,i.type=u),v.touched=1,v._batchEnabled=e,v._batchLocation=s,v.wrapMode=Wn.REPEAT,i.texArray.elements[i.texArray.count++]=v,s++)),i.size+=f.size,d+=f.size,a=v._batchLocation,this.addColors(r,m.color,m.alpha,f.attribSize,f.attribStart),this.addTextureIds(n,a,f.attribSize,f.attribStart)}ve._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,r=this.uvs,n=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let c=0;for(let u=0;u<e.length/2;u++)o[c++]=e[u*2],o[c++]=e[u*2+1],o[c++]=r[u*2],o[c++]=r[u*2+1],a[c++]=n[u],o[c++]=i[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?N1.triangulate(e,this):Id[e.type].triangulate(e,this)}processLine(e){oy(e,this);for(let r=0;r<e.holes.length;r++)oy(e.holes[r],this)}processHoles(e){for(let r=0;r<e.length;r++){const n=e[r];Id[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,r){for(let n=0;n<e.length/2;n++){const i=e[n*2],s=e[n*2+1];e[n*2]=r.a*i+r.c*s+r.tx,e[n*2+1]=r.b*i+r.d*s+r.ty}}addColors(e,r,n,i,s=0){const o=Oe.shared.setValue(r).toLittleEndianNumber(),a=Oe.shared.setValue(o).toPremultiplied(n);e.length=Math.max(e.length,s+i);for(let c=0;c<i;c++)e[s+c]=a}addTextureIds(e,r,n,i=0){e.length=Math.max(e.length,i+n);for(let s=0;s<n;s++)e[i+s]=r}addUvs(e,r,n,i,s,o=null){let a=0;const c=r.length,u=n.frame;for(;a<s;){let h=e[(i+a)*2],f=e[(i+a)*2+1];if(o){const p=o.a*h+o.c*f+o.tx;f=o.b*h+o.d*f+o.ty,h=p}a++,r.push(h/u.width,f/u.height)}const d=n.baseTexture;(u.width<d.width||u.height<d.height)&&this.adjustUvs(r,n,c,s)}adjustUvs(e,r,n,i){const s=r.baseTexture,o=1e-6,a=n+i*2,c=r.frame,u=c.width/s.width,d=c.height/s.height;let h=c.x/c.width,f=c.y/c.height,p=Math.floor(e[n]+o),m=Math.floor(e[n+1]+o);for(let v=n+2;v<a;v+=2)p=Math.min(p,Math.floor(e[v]+o)),m=Math.min(m,Math.floor(e[v+1]+o));h-=p,f-=m;for(let v=n;v<a;v+=2)e[v]=(e[v]+h)*u,e[v+1]=(e[v+1]+f)*d}};F1.BATCHABLE_SIZE=100;let XI=F1;class uu{constructor(){this.color=16777215,this.alpha=1,this.texture=ie.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new uu;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=ie.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Yp extends uu{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Fn.BUTT,this.join=Qt.MITER,this.miterLimit=10}clone(){const e=new Yp;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Fn.BUTT,this.join=Qt.MITER,this.miterLimit=10}}const Md={},kf=class Ol extends Ut{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new uu,this._lineStyle=new Yp,this._matrix=null,this._holeMode=!1,this.state=Vr.for2d(),this._geometry=e||new XI,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Oe(16777215),this.blendMode=me.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Ol(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,r=0,n,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:r,alpha:n,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const r={width:0,texture:ie.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Fn.BUTT,join:Qt.MITER,miterLimit:10};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new bi,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new bi,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this}lineTo(e,r){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,i=n[n.length-2],s=n[n.length-1];return(i!==e||s!==r)&&n.push(e,r),this}_initCurve(e=0,r=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)}quadraticCurveTo(e,r,n,i){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),Xp.curveTo(e,r,n,i,s),this}bezierCurveTo(e,r,n,i,s,o){return this._initCurve(),Wp.curveTo(e,r,n,i,s,o,this.currentPath.points),this}arcTo(e,r,n,i,s){this._initCurve(e,r);const o=this.currentPath.points,a=iy.curveTo(e,r,n,i,s,o);if(a){const{cx:c,cy:u,radius:d,startAngle:h,endAngle:f,anticlockwise:p}=a;this.arc(c,u,d,h,f,p)}return this}arc(e,r,n,i,s,o=!1){if(i===s)return this;if(!o&&s<=i?s+=wc:o&&i<=s&&(i+=wc),s-i===0)return this;const a=e+Math.cos(i)*n,c=r+Math.sin(i)*n,u=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const h=Math.abs(d[d.length-2]-a),f=Math.abs(d[d.length-1]-c);h<u&&f<u||d.push(a,c)}else this.moveTo(a,c),d=this.currentPath.points;return iy.arc(a,c,e,r,n,i,s,o,d),this}beginFill(e=0,r){return this.beginTextureFill({texture:ie.WHITE,color:e,alpha:r})}normalizeColor(e){const r=Oe.shared.setValue(e.color??0);e.color=r.toNumber(),e.alpha??(e.alpha=r.alpha)}beginTextureFill(e){const r={texture:ie.WHITE,color:16777215,matrix:null};e=Object.assign(r,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,r,n,i){return this.drawShape(new we(e,r,n,i))}drawRoundedRect(e,r,n,i,s){return this.drawShape(new au(e,r,n,i,s))}drawCircle(e,r,n){return this.drawShape(new su(e,r,n))}drawEllipse(e,r,n,i){return this.drawShape(new ou(e,r,n,i))}drawPolygon(...e){let r,n=!0;const i=e[0];i.points?(n=i.closeStroke,r=i.points):Array.isArray(e[0])?r=e[0]:r=e;const s=new bi(r);return s.closeStroke=n,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===mt.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,r=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let i=0;i<n;i++){const s=e.batches[i],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),c=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),d={vertexData:a,blendMode:r,indices:u,uvs:c,_batchRGB:Oe.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=d}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let r=0,n=this.batches.length;r<n;r++){const i=this.batches[r];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const r=this._resolveDirectShader(e),n=this._geometry,i=this.worldAlpha,s=r.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,Oe.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(r),e.geometry.bind(n,r),e.state.set(this.state);for(let a=0,c=o.length;a<c;a++)this._renderDrawCallDirect(e,n.drawCalls[a])}_renderDrawCallDirect(e,r){const{texArray:n,type:i,size:s,start:o}=r,a=n.count;for(let c=0;c<a;c++)e.texture.bind(n.elements[c],c);e.geometry.draw(i,s,o)}_resolveDirectShader(e){let r=this.shader;const n=this.pluginName;if(!r){if(!Md[n]){const{maxTextures:i}=e.plugins[n],s=new Int32Array(i);for(let c=0;c<i;c++)s[c]=c;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new ze,default:wr.from({uSamplers:s},!0)},a=e.plugins[n]._shader.program;Md[n]=new Gr(a,o)}r=Md[n]}return r}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:r,minY:n,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,r,n,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,Ol._TEMP_POINT),this._geometry.containsPoint(Ol._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const r=this.batches[e];r._tintRGB=Oe.shared.setValue(this._tintColor).multiply(r._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const r=this.transform.worldTransform,n=r.a,i=r.b,s=r.c,o=r.d,a=r.tx,c=r.ty,u=this._geometry.points,d=this.vertexData;let h=0;for(let f=0;f<u.length;f+=2){const p=u[f],m=u[f+1];d[h++]=n*p+s*m+a,d[h++]=o*m+i*p+c}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};kf.curves=Xs,kf._TEMP_POINT=new Pe;let Vt=kf;class YI{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const jd=new Pe,ly=new bi,D1=class O1 extends Ut{constructor(e,r,n,i=Dr.TRIANGLES){super(),this.geometry=e,this.shader=r,this.state=n||Vr.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=ee.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Dr.TRIANGLES&&r.length<O1.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const r=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const e=this.geometry.buffers[0],r=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,c=i.d,u=i.tx,d=i.ty,h=this.vertexData;for(let f=0;f<h.length/2;f++){const p=r[f*2],m=r[f*2+1];h[f*2]=s*p+a*m+u,h[f*2+1]=o*p+c*m+d}if(this._roundPixels){const f=ee.RESOLUTION;for(let p=0;p<h.length;++p)h[p]=Math.round(h[p]*f)/f}this.vertexDirty=n}calculateUvs(){const e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new YI(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,jd);const r=this.geometry.getBuffer("aVertexPosition").data,n=ly.points,i=this.geometry.getIndex().data,s=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const c=i[a]*2,u=i[a+1]*2,d=i[a+2]*2;if(n[0]=r[c],n[1]=r[c+1],n[2]=r[u],n[3]=r[u+1],n[4]=r[d],n[5]=r[d+1],ly.contains(jd.x,jd.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};D1.BATCHABLE_SIZE=100;let cy=D1;class KI extends qn{constructor(e,r,n){super();const i=new Qe(e),s=new Qe(r,!0),o=new Qe(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,ce.FLOAT).addAttribute("aTextureCoord",s,2,!1,ce.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var qI=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,JI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class uy extends Gr{constructor(e,r){const n={uSampler:e,alpha:1,uTextureMatrix:ze.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||nn.from(JI,qI),n),this._colorDirty=!1,this.uvMatrix=new t1(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new Oe(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Oe.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class dy{constructor(e,r,n){this.geometry=new qn,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||ce.FLOAT,offset:s.offset},r[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let r=0;this.indexBuffer=new Qe(yk(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Qe(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Qe(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===ce.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===ce.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,r,n){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,r,n,s.type===ce.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,n){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,r,n,s.type===ce.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var QI=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,ZI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class U1 extends lu{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new ze,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:ce.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Gr.from(ZI,QI,{}),this.state=Vr.for2d()}render(e){const r=e.children,n=e._maxSize,i=e._batchSize,s=this.renderer;let o=r.length;if(o===0)return;o>n&&!e.autoResize&&(o=n);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const c=r[0]._texture.baseTexture,u=c.alphaMode>0;this.state.blendMode=D_(e.blendMode,u),s.state.set(this.state);const d=s.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=Oe.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let f=!1;for(let p=0,m=0;p<o;p+=i,m+=1){let v=o-p;v>i&&(v=i),m>=a.length&&a.push(this._generateOneMoreBuffer(e));const _=a[m];_.uploadDynamic(r,p,v);const y=e._bufferUpdateIDs[m]||0;f=f||_._updateID<y,f&&(_._updateID=e._updateID,_.uploadStatic(r,p,v)),s.geometry.bind(_.geometry),d.drawElements(d.TRIANGLES,v*6,d.UNSIGNED_SHORT,0)}}generateBuffers(e){const r=[],n=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<n;o+=i)r.push(new dy(this.properties,s,i));return r}_generateOneMoreBuffer(e){const r=e._batchSize,n=e._properties;return new dy(this.properties,n,r)}uploadVertices(e,r,n,i,s,o){let a=0,c=0,u=0,d=0;for(let h=0;h<n;++h){const f=e[r+h],p=f._texture,m=f.scale.x,v=f.scale.y,_=p.trim,y=p.orig;_?(c=_.x-f.anchor.x*y.width,a=c+_.width,d=_.y-f.anchor.y*y.height,u=d+_.height):(a=y.width*(1-f.anchor.x),c=y.width*-f.anchor.x,u=y.height*(1-f.anchor.y),d=y.height*-f.anchor.y),i[o]=c*m,i[o+1]=d*v,i[o+s]=a*m,i[o+s+1]=d*v,i[o+s*2]=a*m,i[o+s*2+1]=u*v,i[o+s*3]=c*m,i[o+s*3+1]=u*v,o+=s*4}}uploadPosition(e,r,n,i,s,o){for(let a=0;a<n;a++){const c=e[r+a].position;i[o]=c.x,i[o+1]=c.y,i[o+s]=c.x,i[o+s+1]=c.y,i[o+s*2]=c.x,i[o+s*2+1]=c.y,i[o+s*3]=c.x,i[o+s*3+1]=c.y,o+=s*4}}uploadRotation(e,r,n,i,s,o){for(let a=0;a<n;a++){const c=e[r+a].rotation;i[o]=c,i[o+s]=c,i[o+s*2]=c,i[o+s*3]=c,o+=s*4}}uploadUvs(e,r,n,i,s,o){for(let a=0;a<n;++a){const c=e[r+a]._texture._uvs;c?(i[o]=c.x0,i[o+1]=c.y0,i[o+s]=c.x1,i[o+s+1]=c.y1,i[o+s*2]=c.x2,i[o+s*2+1]=c.y2,i[o+s*3]=c.x3,i[o+s*3+1]=c.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}}uploadTint(e,r,n,i,s,o){for(let a=0;a<n;++a){const c=e[r+a],u=Oe.shared.setValue(c._tintRGB).toPremultiplied(c.alpha,c.texture.baseTexture.alphaMode>0);i[o]=u,i[o+s]=u,i[o+s*2]=u,i[o+s*3]=u,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}U1.extension={name:"particle",type:Q.RendererPlugin};se.add(U1);var du=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(du||{});const fl={willReadFrequently:!0},Ir=class ae{static get experimentalLetterSpacingSupported(){let e=ae._experimentalLetterSpacingSupported;if(e!==void 0){const r=ee.ADAPTER.getCanvasRenderingContext2D().prototype;e=ae._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return e}constructor(e,r,n,i,s,o,a,c,u){this.text=e,this.style=r,this.width=n,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=c,this.fontProperties=u}static measureText(e,r,n,i=ae._canvas){n=n??r.wordWrap;const s=r.toFontString(),o=ae.measureFont(s);o.fontSize===0&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);const a=i.getContext("2d",fl);a.font=s;const c=(n?ae.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),u=new Array(c.length);let d=0;for(let m=0;m<c.length;m++){const v=ae._measureText(c[m],r.letterSpacing,a);u[m]=v,d=Math.max(d,v)}let h=d+r.strokeThickness;r.dropShadow&&(h+=r.dropShadowDistance);const f=r.lineHeight||o.fontSize+r.strokeThickness;let p=Math.max(f,o.fontSize+r.strokeThickness*2)+r.leading+(c.length-1)*(f+r.leading);return r.dropShadow&&(p+=r.dropShadowDistance),new ae(e,r,h,p,c,u,f+r.leading,d,o)}static _measureText(e,r,n){let i=!1;ae.experimentalLetterSpacingSupported&&(ae.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let s=n.measureText(e).width;return s>0&&(i?s-=r:s+=(ae.graphemeSegmenter(e).length-1)*r),s}static wordWrap(e,r,n=ae._canvas){const i=n.getContext("2d",fl);let s=0,o="",a="";const c=Object.create(null),{letterSpacing:u,whiteSpace:d}=r,h=ae.collapseSpaces(d),f=ae.collapseNewlines(d);let p=!h;const m=r.wordWrapWidth+u,v=ae.tokenize(e);for(let _=0;_<v.length;_++){let y=v[_];if(ae.isNewline(y)){if(!f){a+=ae.addLine(o),p=!h,o="",s=0;continue}y=" "}if(h){const g=ae.isBreakingSpace(y),w=ae.isBreakingSpace(o[o.length-1]);if(g&&w)continue}const x=ae.getFromCache(y,u,c,i);if(x>m)if(o!==""&&(a+=ae.addLine(o),o="",s=0),ae.canBreakWords(y,r.breakWords)){const g=ae.wordWrapSplit(y);for(let w=0;w<g.length;w++){let T=g[w],A=T,C=1;for(;g[w+C];){const I=g[w+C];if(!ae.canBreakChars(A,I,y,w,r.breakWords))T+=I;else break;A=I,C++}w+=C-1;const b=ae.getFromCache(T,u,c,i);b+s>m&&(a+=ae.addLine(o),p=!1,o="",s=0),o+=T,s+=b}}else{o.length>0&&(a+=ae.addLine(o),o="",s=0);const g=_===v.length-1;a+=ae.addLine(y,!g),p=!1,o="",s=0}else x+s>m&&(p=!1,a+=ae.addLine(o),o="",s=0),(o.length>0||!ae.isBreakingSpace(y)||p)&&(o+=y,s+=x)}return a+=ae.addLine(o,!1),a}static addLine(e,r=!0){return e=ae.trimRight(e),e=r?`${e}
`:e,e}static getFromCache(e,r,n,i){let s=n[e];return typeof s!="number"&&(s=ae._measureText(e,r,i)+r,n[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let r=e.length-1;r>=0;r--){const n=e[r];if(!ae.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:ae._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,r){return typeof e!="string"?!1:ae._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const r=[];let n="";if(typeof e!="string")return r;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(ae.isBreakingSpace(s,o)||ae.isNewline(s)){n!==""&&(r.push(n),n=""),r.push(s);continue}n+=s}return n!==""&&r.push(n),r}static canBreakWords(e,r){return r}static canBreakChars(e,r,n,i,s){return!0}static wordWrapSplit(e){return ae.graphemeSegmenter(e)}static measureFont(e){if(ae._fonts[e])return ae._fonts[e];const r={ascent:0,descent:0,fontSize:0},n=ae._canvas,i=ae._context;i.font=e;const s=ae.METRICS_STRING+ae.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(ae.BASELINE_SYMBOL).width);const c=Math.ceil(ae.HEIGHT_MULTIPLIER*a);if(a=a*ae.BASELINE_MULTIPLIER|0,o===0||c===0)return ae._fonts[e]=r,r;n.width=o,n.height=c,i.fillStyle="#f00",i.fillRect(0,0,o,c),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const u=i.getImageData(0,0,o,c).data,d=u.length,h=o*4;let f=0,p=0,m=!1;for(f=0;f<a;++f){for(let v=0;v<h;v+=4)if(u[p+v]!==255){m=!0;break}if(!m)p+=h;else break}for(r.ascent=a-f,p=d-h,m=!1,f=c;f>a;--f){for(let v=0;v<h;v+=4)if(u[p+v]!==255){m=!0;break}if(!m)p-=h;else break}return r.descent=f-a,r.fontSize=r.ascent+r.descent,ae._fonts[e]=r,r}static clearMetrics(e=""){e?delete ae._fonts[e]:ae._fonts={}}static get _canvas(){var e;if(!ae.__canvas){let r;try{const n=new OffscreenCanvas(0,0);if((e=n.getContext("2d",fl))!=null&&e.measureText)return ae.__canvas=n,n;r=ee.ADAPTER.createCanvas()}catch{r=ee.ADAPTER.createCanvas()}r.width=r.height=10,ae.__canvas=r}return ae.__canvas}static get _context(){return ae.__context||(ae.__context=ae._canvas.getContext("2d",fl)),ae.__context}};Ir.METRICS_STRING="|q",Ir.BASELINE_SYMBOL="M",Ir.BASELINE_MULTIPLIER=1.4,Ir.HEIGHT_MULTIPLIER=2,Ir.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})(),Ir.experimentalLetterSpacing=!1,Ir._fonts={},Ir._newlines=[10,13],Ir._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Cn=Ir;const eM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],z1=class ko{constructor(e){this.styleID=0,this.reset(),Nd(this,e,e)}clone(){const e={};return Nd(e,this,ko.defaultStyle),new ko(e)}reset(){Nd(this,ko.defaultStyle,ko.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const r=Bd(e);this._dropShadowColor!==r&&(this._dropShadowColor=r,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const r=Bd(e);this._fill!==r&&(this._fill=r,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){tM(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const r=Bd(e);this._stroke!==r&&(this._stroke=r,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let r=this.fontFamily;Array.isArray(this.fontFamily)||(r=this.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let i=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!eM.includes(i)&&(i=`"${i}"`),r[n]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${r.join(",")}`}};z1.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:du.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ar=z1;function Bd(t){const e=Oe.shared,r=n=>{const i=e.setValue(n);return i.alpha===1?i.toHex():i.toRgbaString()};return Array.isArray(t)?t.map(r):r(t)}function tM(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function Nd(t,e,r){for(const n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}const rM={texture:!0,children:!1,baseTexture:!0},G1=class Pf extends Jn{constructor(e,r,n){let i=!1;n||(n=ee.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const s=ie.from(n);s.orig=new we,s.trim=new we,super(s),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=Pf.defaultResolution??ee.RESOLUTION,this._autoResolution=Pf.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return Cn.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Te("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Cn.experimentalLetterSpacing=e}updateText(e){const r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const n=this.context,i=Cn.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,a=i.lines,c=i.lineHeight,u=i.lineWidths,d=i.maxLineWidth,h=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;let f,p;const m=r.dropShadow?2:1;for(let v=0;v<m;++v){const _=r.dropShadow&&v===0,y=_?Math.ceil(Math.max(1,o)+r.padding*2):0,x=y*this._resolution;if(_){n.fillStyle="black",n.strokeStyle="black";const w=r.dropShadowColor,T=r.dropShadowBlur*this._resolution,A=r.dropShadowDistance*this._resolution;n.shadowColor=Oe.shared.setValue(w).setAlpha(r.dropShadowAlpha).toRgbaString(),n.shadowBlur=T,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*A,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*A+x}else n.fillStyle=this._generateFillStyle(r,a,i),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let g=(c-h.fontSize)/2;c-h.fontSize<0&&(g=0);for(let w=0;w<a.length;w++)f=r.strokeThickness/2,p=r.strokeThickness/2+w*c+h.ascent+g,r.align==="right"?f+=d-u[w]:r.align==="center"&&(f+=(d-u[w])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(a[w],f+r.padding,p+r.padding-y,!0),r.fill&&this.drawLetterSpacing(a[w],f+r.padding,p+r.padding-y)}this.updateTexture()}drawLetterSpacing(e,r,n,i=!1){const s=this._style.letterSpacing;let o=!1;if(Cn.experimentalLetterSpacingSupported&&(Cn.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(e,r,n):this.context.fillText(e,r,n);return}let a=r;const c=Cn.graphemeSegmenter(e);let u=this.context.measureText(e).width,d=0;for(let h=0;h<c.length;++h){const f=c[h];i?this.context.strokeText(f,a,n):this.context.fillText(f,a,n);let p="";for(let m=h+1;m<c.length;++m)p+=c[m];d=this.context.measureText(p).width,a+=u-d+s,u=d}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=Sk(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const r=this._texture,n=this._style,i=n.trim?0:n.padding,s=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-i*2,r.orig.height=r._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,r){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,r)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,r,n){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,c=this.canvas.width/this._resolution-o-a*2,u=this.canvas.height/this._resolution-o-a*2,d=i.slice(),h=e.fillGradientStops.slice();if(!h.length){const f=d.length+1;for(let p=1;p<f;++p)h.push(p/f)}if(d.unshift(i[0]),h.unshift(0),d.push(i[i.length-1]),h.push(1),e.fillGradientType===du.LINEAR_VERTICAL){s=this.context.createLinearGradient(c/2,a,c/2,u+a);const f=n.fontProperties.fontSize+e.strokeThickness;for(let p=0;p<r.length;p++){const m=n.lineHeight*(p-1)+f,v=n.lineHeight*p;let _=v;p>0&&m>v&&(_=(v+m)/2);const y=v+f,x=n.lineHeight*(p+1);let g=y;p+1<r.length&&x<y&&(g=(y+x)/2);const w=(g-_)/u;for(let T=0;T<d.length;T++){let A=0;typeof h[T]=="number"?A=h[T]:A=T/d.length;let C=Math.min(1,Math.max(0,_/u+A*w));C=Number(C.toFixed(5)),s.addColorStop(C,d[T])}}}else{s=this.context.createLinearGradient(a,u/2,c+a,u/2);const f=d.length+1;let p=1;for(let m=0;m<d.length;m++){let v;typeof h[m]=="number"?v=h[m]:v=p/f,s.addColorStop(v,d[m]),p++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},rM,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const r=Nn(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const r=Nn(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof ar?this._style=e:this._style=new ar(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};G1.defaultAutoResolution=!0;let ji=G1;class nM{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function iM(t,e){var n;let r=!1;if((n=t==null?void 0:t._textures)!=null&&n.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof ie){const s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),r=!0)}}return r}function sM(t,e){if(t.baseTexture instanceof ve){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function oM(t,e){if(t._texture&&t._texture instanceof ie){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function aM(t,e){return e instanceof ji?(e.updateText(!0),!0):!1}function lM(t,e){if(e instanceof ar){const r=e.toFontString();return Cn.measureFont(r),!0}return!1}function cM(t,e){if(t instanceof ji){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function uM(t,e){return t instanceof ar?(e.includes(t)||e.push(t),!0):!1}const H1=class $1{constructor(e){this.limiter=new nM($1.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(cM),this.registerFindHook(uM),this.registerFindHook(iM),this.registerFindHook(sM),this.registerFindHook(oM),this.registerUploadHook(aM),this.registerUploadHook(lM)}upload(e){return new Promise(r=>{e&&this.add(e),this.queue.length?(this.completes.push(r),this.ticking||(this.ticking=!0,$t.system.addOnce(this.tick,this,Mi.UTILITY))):r()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let r=!1;if(e&&!e._destroyed){for(let n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),r=!0;break}}r||this.queue.shift()}if(this.queue.length)$t.system.addOnce(this.tick,this,Mi.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let r=0,n=e.length;r<n;r++)e[r]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let r=0,n=this.addHooks.length;r<n&&!this.addHooks[r](e,this.queue);r++);if(e instanceof Ut)for(let r=e.children.length-1;r>=0;r--)this.add(e.children[r]);return this}destroy(){this.ticking&&$t.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};H1.uploadsPerFrame=4;let Rf=H1;Object.defineProperties(ee,{UPLOADS_PER_FRAME:{get(){return Rf.uploadsPerFrame},set(t){Te("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Rf.uploadsPerFrame=t}}});function V1(t,e){return e instanceof ve?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function dM(t,e){if(!(e instanceof Vt))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:n}=r;for(let i=0;i<n.length;i++){const{texture:s}=n[i].style;s&&V1(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function hM(t,e){return t instanceof Vt?(e.push(t),!0):!1}class W1 extends Rf{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(hM),this.registerUploadHook(V1),this.registerUploadHook(dM)}}W1.extension={name:"prepare",type:Q.RendererSystem};se.add(W1);var fM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,pM=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,mM=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,hy=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,gM=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const pl=new ze;class X1 extends lu{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new J_,this.state=Vr.for2d()}contextChange(){const e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=Gr.from(hy,gM,r),this.shader=e.context.webGLVersion>1?Gr.from(pM,fM,r):Gr.from(hy,mM,r)}render(e){const r=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=n.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,n.invalidate();const a=e._texture,c=a.baseTexture,u=c.alphaMode>0,d=e.tileTransform.localTransform,h=e.uvMatrix;let f=c.isPowerOfTwo&&a.frame.width===c.width&&a.frame.height===c.height;f&&(c._glTextures[r.CONTEXT_UID]?f=c.wrapMode!==Wn.CLAMP:c.wrapMode===Wn.CLAMP&&(c.wrapMode=Wn.REPEAT));const p=f?this.simpleShader:this.shader,m=a.width,v=a.height,_=e._width,y=e._height;pl.set(d.a*m/_,d.b*m/y,d.c*v/_,d.d*v/y,d.tx/_,d.ty/y),pl.invert(),f?pl.prepend(h.mapCoord):(p.uniforms.uMapCoord=h.mapCoord.toArray(!0),p.uniforms.uClampFrame=h.uClampFrame,p.uniforms.uClampOffset=h.uClampOffset),p.uniforms.uTransform=pl.toArray(!0),p.uniforms.uColor=Oe.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(p.uniforms.uColor),p.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),p.uniforms.uSampler=a,r.shader.bind(p),r.geometry.bind(n),this.state.blendMode=D_(e.blendMode,u),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}X1.extension={name:"tilingSprite",type:Q.RendererPlugin};se.add(X1);const Y1=class Po{constructor(e,r,n){this.linkedSheets=[],(e instanceof ve||e instanceof ie)&&(e={texture:e,data:r,resolutionFilename:n});const{texture:i,data:s,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=i instanceof ie?i:null,this.baseTexture=i instanceof ve?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const c=this.baseTexture.resource;this.resolution=this._updateResolution(o||(c?c.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:r}=this.data.meta;let n=dn(e,null);return n===null&&(n=typeof r=="number"?r:parseFloat(r??"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Po.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let r=e;const n=Po.BATCH_SIZE;for(;r-e<n&&r<this._frameKeys.length;){const i=this._frameKeys[r],s=this._frames[i],o=s.frame;if(o){let a=null,c=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,d=new we(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new we(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new we(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(c=new we(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new ie(this.baseTexture,a,d,c,s.rotated?2:0,s.anchor,s.borders),ie.addToCache(this.textures[i],this.cachePrefix+i.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const r in e){this.animations[r]=[];for(let n=0;n<e[r].length;n++){const i=e[r][n];this.animations[r].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Po.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Po.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var r;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((r=this._texture)==null||r.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};Y1.BATCH_SIZE=1e3;let fy=Y1;const xM=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function K1(t,e,r){const n={};if(t.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[`${e.cachePrefix}${i}`]=e.textures[i]}),!r){const i=ht.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(n,K1([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return n}const yM={extension:Q.Asset,cache:{test:t=>t instanceof fy,getCacheableAssets:(t,e)=>K1(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&xM.includes(n)},parse:t=>{var r;const e=t.split(".");return{resolution:parseFloat(((r=ee.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:Q.LoadParser,priority:br.Normal},async testParse(t,e){return ht.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){var d,h;const{texture:n,imageFilename:i,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=ht.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(n&&n.baseTexture)a=n;else{const f=Tf(o+(i??t.meta.image),e.src);a=(await r.load([f]))[f]}const c=new fy({texture:a.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await c.parse();const u=(d=t==null?void 0:t.meta)==null?void 0:d.related_multi_packs;if(Array.isArray(u)){const f=[];for(const m of u){if(typeof m!="string")continue;let v=o+m;(h=e.data)!=null&&h.ignoreMultiPack||(v=Tf(v,e.src),f.push(r.load({src:v,data:{ignoreMultiPack:!0}})))}const p=await Promise.all(f);c.linkedSheets=p,p.forEach(m=>{m.linkedSheets=[c].concat(c.linkedSheets.filter(v=>v!==m))})}return c},unload(t){t.destroy(!0)}}};se.add(yM);class Mc{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Ul{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const r=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in r){const o=r[s].match(/^[a-z]+/gm)[0],a=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(const u in a){const d=a[u].split("="),h=d[0],f=d[1].replace(/"/gm,""),p=parseFloat(f),m=isNaN(p)?f:p;c[h]=m}n[o].push(c)}const i=new Mc;return n.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),n.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),n.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),n.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),n.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),n.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class If{static test(e){const r=e;return typeof e!="string"&&"getElementsByTagName"in e&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const r=new Mc,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),c=e.getElementsByTagName("distanceField");for(let u=0;u<n.length;u++)r.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(let u=0;u<i.length;u++)r.common.push({lineHeight:parseInt(i[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)r.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const d=o[u];r.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)r.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<c.length;u++)r.distanceField.push({fieldType:c[u].getAttribute("fieldType"),distanceRange:parseInt(c[u].getAttribute("distanceRange"),10)});return r}}class Mf{static test(e){return typeof e=="string"&&e.includes("<font>")?If.test(ee.ADAPTER.parseXML(e)):!1}static parse(e){return If.parse(ee.ADAPTER.parseXML(e))}}const Fd=[Ul,If,Mf];function vM(t){for(let e=0;e<Fd.length;e++)if(Fd[e].test(t))return Fd[e];return null}function _M(t,e,r,n,i,s){const o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const c=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,d=t.width/n-c-u*2,h=t.height/n-c-u*2,f=o.slice(),p=r.fillGradientStops.slice();if(!p.length){const m=f.length+1;for(let v=1;v<m;++v)p.push(v/m)}if(f.unshift(o[0]),p.unshift(0),f.push(o[o.length-1]),p.push(1),r.fillGradientType===du.LINEAR_VERTICAL){a=e.createLinearGradient(d/2,u,d/2,h+u);let m=0;const v=(s.fontProperties.fontSize+r.strokeThickness)/h;for(let _=0;_<i.length;_++){const y=s.lineHeight*_;for(let x=0;x<f.length;x++){let g=0;typeof p[x]=="number"?g=p[x]:g=x/f.length;const w=y/h+g*v;let T=Math.max(m,w);T=Math.min(T,1),a.addColorStop(T,f[x]),m=T}}}else{a=e.createLinearGradient(u,h/2,d+u,h/2);const m=f.length+1;let v=1;for(let _=0;_<f.length;_++){let y;typeof p[_]=="number"?y=p[_]:y=v/m,a.addColorStop(y,f[_]),v++}}return a}function wM(t,e,r,n,i,s,o){const a=r.text,c=r.fontProperties;e.translate(n,i),e.scale(s,s);const u=o.strokeThickness/2,d=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=_M(t,e,o,s,[a],r),e.strokeStyle=o.stroke,o.dropShadow){const h=o.dropShadowColor,f=o.dropShadowBlur*s,p=o.dropShadowDistance*s;e.shadowColor=Oe.shared.setValue(h).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=f,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,d+r.lineHeight-c.descent),o.fill&&e.fillText(a,u,d+r.lineHeight-c.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function zl(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function q1(t){return Array.from?Array.from(t):t.split("")}function SM(t){typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,c=o;a<=c;a++)e.push(String.fromCharCode(a))}else e.push(...q1(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const bn=class Mr{constructor(e,r,n){var d;const[i]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,c=dn(o.file),u={};this._ownsTextures=n,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/c,this.chars={},this.pageTextures=u;for(let h=0;h<e.page.length;h++){const{id:f,file:p}=e.page[h];u[f]=r instanceof Array?r[h]:r[p],a!=null&&a.fieldType&&a.fieldType!=="none"&&(u[f].baseTexture.alphaMode=Nt.NO_PREMULTIPLIED_ALPHA,u[f].baseTexture.mipmap=Hr.OFF)}for(let h=0;h<e.char.length;h++){const{id:f,page:p}=e.char[h];let{x:m,y:v,width:_,height:y,xoffset:x,yoffset:g,xadvance:w}=e.char[h];m/=c,v/=c,_/=c,y/=c,x/=c,g/=c,w/=c;const T=new we(m+u[p].frame.x/c,v+u[p].frame.y/c,_,y);this.chars[f]={xOffset:x,yOffset:g,xAdvance:w,kerning:{},texture:new ie(u[p].baseTexture,T),page:p}}for(let h=0;h<e.kerning.length;h++){let{first:f,second:p,amount:m}=e.kerning[h];f/=c,p/=c,m/=c,this.chars[p]&&(this.chars[p].kerning[f]=m)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((d=a==null?void 0:a.fieldType)==null?void 0:d.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,r,n){let i;if(e instanceof Mc)i=e;else{const o=vM(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof ie&&(r=[r]);const s=new Mr(i,r,n);return Mr.available[s.font]=s,s}static uninstall(e){const r=Mr.available[e];if(!r)throw new Error(`No font found named '${e}'`);r.destroy(),delete Mr.available[e]}static from(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:c,...u}=Object.assign({},Mr.defaultOptions,n),d=SM(i),h=r instanceof ar?r:new ar(r),f=a,p=new Mc;p.info[0]={face:h.fontFamily,size:h.fontSize},p.common[0]={lineHeight:h.fontSize};let m=0,v=0,_,y,x,g=0;const w=[];for(let A=0;A<d.length;A++){_||(_=ee.ADAPTER.createCanvas(),_.width=a,_.height=c,y=_.getContext("2d"),x=new ve(_,{resolution:o,...u}),w.push(new ie(x)),p.page.push({id:w.length-1,file:""}));const C=d[A],b=Cn.measureText(C,h,!1,_),I=b.width,N=Math.ceil(b.height),L=Math.ceil((h.fontStyle==="italic"?2:1)*I);if(v>=c-N*o){if(v===0)throw new Error(`[BitmapFont] textureHeight ${c}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${C}')`);--A,_=null,y=null,x=null,v=0,m=0,g=0;continue}if(g=Math.max(N+b.fontProperties.descent,g),L*o+m>=f){if(m===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${h.fontFamily}', fontSize: ${h.fontSize}px, char: '${C}')`);--A,v+=g*o,v=Math.ceil(v),m=0,g=0;continue}wM(_,y,b,m,v,o,h);const D=zl(b.text);p.char.push({id:D,page:w.length-1,x:m/o,y:v/o,width:L,height:N,xoffset:0,yoffset:0,xadvance:I-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0)}),m+=(L+2*s)*o,m=Math.ceil(m)}if(!(n!=null&&n.skipKerning))for(let A=0,C=d.length;A<C;A++){const b=d[A];for(let I=0;I<C;I++){const N=d[I],L=y.measureText(b).width,D=y.measureText(N).width,P=y.measureText(b+N).width-(L+D);P&&p.kerning.push({first:zl(b),second:zl(N),amount:P})}}const T=new Mr(p,w,!0);return Mr.available[e]!==void 0&&Mr.uninstall(e),Mr.available[e]=T,T}};bn.ALPHA=[["a","z"],["A","Z"]," "],bn.NUMERIC=[["0","9"]],bn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],bn.ASCII=[[" ","~"]],bn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:bn.ALPHANUMERIC},bn.available={};let En=bn;var bM=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,EM=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const py=[],my=[],gy=[],TM=class J1 extends Ut{constructor(e,r={}){super();const{align:n,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:c}=Object.assign({},J1.styleDefaults,r);if(!En.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new Oe(i),this._font=void 0,this._fontName=a,this._fontSize=c,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new rn(()=>{this.dirty=!0},this,0,0),this._roundPixels=ee.ROUND_PIXELS,this.dirty=!0,this._resolution=ee.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var L;const e=En.available[this._fontName],r=this.fontSize,n=r/e.size,i=new Pe,s=[],o=[],a=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=q1(c),d=this._maxWidth*e.size/r,h=e.distanceFieldType==="none"?py:my;let f=null,p=0,m=0,v=0,_=-1,y=0,x=0,g=0,w=0;for(let D=0;D<u.length;D++){const P=u[D],O=zl(P);if(/(?:\s)/.test(P)&&(_=D,y=p,w++),P==="\r"||P===`
`){o.push(p),a.push(-1),m=Math.max(m,p),++v,++x,i.x=0,i.y+=e.lineHeight,f=null,w=0;continue}const z=e.chars[O];if(!z)continue;f&&z.kerning[f]&&(i.x+=z.kerning[f]);const H=gy.pop()||{texture:ie.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Pe};H.texture=z.texture,H.line=v,H.charCode=O,H.position.x=Math.round(i.x+z.xOffset+this._letterSpacing/2),H.position.y=Math.round(i.y+z.yOffset),H.prevSpaces=w,s.push(H),p=H.position.x+Math.max(z.xAdvance-z.xOffset,z.texture.orig.width),i.x+=z.xAdvance+this._letterSpacing,g=Math.max(g,z.yOffset+z.texture.height),f=O,_!==-1&&d>0&&i.x>d&&(++x,js(s,1+_-x,1+D-_),D=_,_=-1,o.push(y),a.push(s.length>0?s[s.length-1].prevSpaces:0),m=Math.max(m,y),v++,i.x=0,i.y+=e.lineHeight,f=null,w=0)}const T=u[u.length-1];T!=="\r"&&T!==`
`&&(/(?:\s)/.test(T)&&(p=y),o.push(p),m=Math.max(m,p),a.push(-1));const A=[];for(let D=0;D<=v;D++){let P=0;this._align==="right"?P=m-o[D]:this._align==="center"?P=(m-o[D])/2:this._align==="justify"&&(P=a[D]<0?0:(m-o[D])/a[D]),A.push(P)}const C=s.length,b={},I=[],N=this._activePagesMeshData;h.push(...N);for(let D=0;D<C;D++){const P=s[D].texture,O=P.baseTexture.uid;if(!b[O]){let z=h.pop();if(!z){const W=new KI;let k,U;e.distanceFieldType==="none"?(k=new uy(ie.EMPTY),U=me.NORMAL):(k=new uy(ie.EMPTY,{program:nn.from(EM,bM),uniforms:{uFWidth:0}}),U=me.NORMAL_NPM);const R=new cy(W,k);R.blendMode=U,z={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:R,vertices:null,uvs:null,indices:null}}z.index=0,z.indexCount=0,z.vertexCount=0,z.uvsCount=0,z.total=0;const{_textureCache:H}=this;H[O]=H[O]||new ie(P.baseTexture),z.mesh.texture=H[O],z.mesh.tint=this._tintColor.value,I.push(z),b[O]=z}b[O].total++}for(let D=0;D<N.length;D++)I.includes(N[D])||this.removeChild(N[D].mesh);for(let D=0;D<I.length;D++)I[D].mesh.parent!==this&&this.addChild(I[D].mesh);this._activePagesMeshData=I;for(const D in b){const P=b[D],O=P.total;if(!(((L=P.indices)==null?void 0:L.length)>6*O)||P.vertices.length<cy.BATCHABLE_SIZE*2)P.vertices=new Float32Array(4*2*O),P.uvs=new Float32Array(4*2*O),P.indices=new Uint16Array(6*O);else{const z=P.total,H=P.vertices;for(let W=z*4*2;W<H.length;W++)H[W]=0}P.mesh.size=6*O}for(let D=0;D<C;D++){const P=s[D];let O=P.position.x+A[P.line]*(this._align==="justify"?P.prevSpaces:1);this._roundPixels&&(O=Math.round(O));const z=O*n,H=P.position.y*n,W=P.texture,k=b[W.baseTexture.uid],U=W.frame,R=W._uvs,E=k.index++;k.indices[E*6+0]=0+E*4,k.indices[E*6+1]=1+E*4,k.indices[E*6+2]=2+E*4,k.indices[E*6+3]=0+E*4,k.indices[E*6+4]=2+E*4,k.indices[E*6+5]=3+E*4,k.vertices[E*8+0]=z,k.vertices[E*8+1]=H,k.vertices[E*8+2]=z+U.width*n,k.vertices[E*8+3]=H,k.vertices[E*8+4]=z+U.width*n,k.vertices[E*8+5]=H+U.height*n,k.vertices[E*8+6]=z,k.vertices[E*8+7]=H+U.height*n,k.uvs[E*8+0]=R.x0,k.uvs[E*8+1]=R.y0,k.uvs[E*8+2]=R.x1,k.uvs[E*8+3]=R.y1,k.uvs[E*8+4]=R.x2,k.uvs[E*8+5]=R.y2,k.uvs[E*8+6]=R.x3,k.uvs[E*8+7]=R.y3}this._textWidth=m*n,this._textHeight=(i.y+e.lineHeight)*n;for(const D in b){const P=b[D];if(this.anchor.x!==0||this.anchor.y!==0){let W=0;const k=this._textWidth*this.anchor.x,U=this._textHeight*this.anchor.y;for(let R=0;R<P.total;R++)P.vertices[W++]-=k,P.vertices[W++]-=U,P.vertices[W++]-=k,P.vertices[W++]-=U,P.vertices[W++]-=k,P.vertices[W++]-=U,P.vertices[W++]-=k,P.vertices[W++]-=U}this._maxLineHeight=g*n;const O=P.mesh.geometry.getBuffer("aVertexPosition"),z=P.mesh.geometry.getBuffer("aTextureCoord"),H=P.mesh.geometry.getIndex();O.data=P.vertices,z.data=P.uvs,H.data=P.indices,O.update(),z.update(),H.update()}for(let D=0;D<s.length;D++)gy.push(s[D]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:r,distanceFieldType:n,size:i}=En.available[this._fontName];if(n!=="none"){const{a:s,b:o,c:a,d:c}=this.worldTransform,u=Math.sqrt(s*s+o*o),d=Math.sqrt(a*a+c*c),h=(Math.abs(u)+Math.abs(d))/2,f=this.fontSize/i,p=e._view.resolution;for(const m of this._activePagesMeshData)m.mesh.shader.uniforms.uFWidth=h*r*f*p}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=En.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!En.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??En.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:r}=this,n=En.available[this._fontName].distanceFieldType==="none"?py:my;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>r[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=ie.EMPTY});for(const i in r)r[i].destroy(),delete r[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};TM.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const AM=[".xml",".fnt"],CM={extension:{type:Q.LoadParser,priority:br.Normal},name:"loadBitmapFont",test(t){return AM.includes(ht.extname(t).toLowerCase())},async testParse(t){return Ul.test(t)||Mf.test(t)},async parse(t,e,r){const n=Ul.test(t)?Ul.parse(t):Mf.parse(t),{src:i}=e,{page:s}=n,o=[];for(let u=0;u<s.length;++u){const d=s[u].file;let h=ht.join(ht.dirname(i),d);h=Tf(h,i),o.push(h)}const a=await r.load(o),c=o.map(u=>a[u]);return En.install(n,c,!0)},async load(t,e){return(await ee.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};se.add(CM);const jf=class ls extends ar{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new ls(Object.keys(ls.defaultOptions).reduce((r,n)=>({...r,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete ls.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,r={}){const{availableFonts:n}=ls;if(n[e]){const i=n[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return ee.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,o)=>{const a=URL.createObjectURL(i),c=new FileReader;c.onload=()=>s([a,c.result]),c.onerror=o,c.readAsDataURL(i)})).then(async([i,s])=>{const o=Object.assign({family:ht.basename(e,ht.extname(e)),weight:"normal",style:"normal",display:"auto",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},r);n[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const r=e.filter(n=>!this._overrides.includes(n));r.length>0&&(this._overrides.push(...r),this.styleID++)}removeOverride(...e){const r=e.filter(n=>this._overrides.includes(n));r.length>0&&(this._overrides=this._overrides.filter(n=>!r.includes(n)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,r)=>`${e}
            @font-face {
                font-family: "${r.family}";
                src: url('${r.dataSrc}');
                font-weight: ${r.weight};
                font-style: ${r.style};
                font-display: ${r.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=gk(e)),typeof e=="number"?mk(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const r=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&r<1&&(e+=(r*255|0).toString(16).padStart(2,"0"));const s=`${n}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,ls.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(r=>setTimeout(r,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=ee.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};jf.availableFonts={},jf.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Ld=jf;const ml=class cs extends Jn{constructor(e="",r={}){super(ie.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,i=ie.from(n,{scaleMode:ee.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new we,i.trim=new we,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),c=document.createElementNS(s,"foreignObject"),u=document.createElementNS(o,"div"),d=document.createElementNS(o,"style");c.setAttribute("width","10000"),c.setAttribute("height","10000"),c.style.overflow="hidden",a.appendChild(c),this.maxWidth=cs.defaultMaxWidth,this.maxHeight=cs.defaultMaxHeight,this._domElement=u,this._styleElement=d,this._svgRoot=a,this._foreignObject=c,this._foreignObject.appendChild(d),this._foreignObject.appendChild(u),this._image=n,this._loadImage=new Image,this._autoResolution=cs.defaultAutoResolution,this._resolution=cs.defaultResolution??ee.RESOLUTION,this.text=e,this.style=r}measureText(e){var d,h;const{text:r,style:n,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:r,style:n.toCSS(i)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const c=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",c.toString()),this._svgRoot.setAttribute("height",u.toString()),r!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(d=this._style)==null?void 0:d.toCSS(i)}),this._styleElement.textContent=(h=this._style)==null?void 0:h.toGlobalCSS()),{width:c+n.padding*2,height:u+n.padding*2}}async updateText(e=!0){const{style:r,_image:n,_loadImage:i}=this;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();n.width=i.width=Math.ceil(Math.max(1,s)),n.height=i.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(c=>{i.onload=async()=>{if(a<this._updateID){c();return}await r.onBeforeDraw(),n.src=i.src,i.onload=null,i.src="",this.updateTexture(),c()};const u=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:r,_image:n,resolution:i}=this,{padding:s}=e,{baseTexture:o}=r;r.trim.width=r._frame.width=n.width/i,r.trim.height=r._frame.height=n.height/i,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-s*2,r.orig.height=r._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(n.width,n.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var n,i,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},cs.defaultDestroyOptions,e),super.destroy(e);const r=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=r,(i=this._svgRoot)==null||i.remove(),this._svgRoot=r,(s=this._domElement)==null||s.remove(),this._domElement=r,(o=this._foreignObject)==null||o.remove(),this._foreignObject=r,(a=this._styleElement)==null||a.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const r=Nn(this.scale.x)||1;this.scale.x=r*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const r=Nn(this.scale.y)||1;this.scale.y=r*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Ld?(this.ownsStyle=!1,this._style=e):e instanceof ar?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ld.from(e)):(this.ownsStyle=!0,this._style=new Ld(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};ml.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},ml.defaultMaxWidth=2024,ml.defaultMaxHeight=2024,ml.defaultAutoResolution=!0;const Ft={background:1710638,surface:2960708,hitZone:16098851,laneLeft:2972199,laneRight:4886745,textMuted:10526896,perfect:5025616,partial:16098851,miss:15037299},kM=.72,Dd=85,Bf=.82,xy=new Map;async function yy(t){const e=`/${t}`,r=xy.get(t);if(r)return r;const n=(async()=>{try{console.log(`[Texture] Loading: ${e}`);const i=await Ao.load(e);return!i||!i.valid?(console.error(`[Texture] Invalid texture loaded: ${t}`,{fullPath:e,texture:i}),null):(console.log(`[Texture] Success: ${t}`),i)}catch(i){return console.error(`[Texture] Failed to load: ${t}`,{fullPath:e,error:i}),null}})();return xy.set(t,n),n}function PM({width:t,height:e,scheduledEvents:r,activeEvents:n,roundStartTime:i,roundState:s,scrollSpeed:o,currentFeedback:a,onChannelTap:c,trainingMode:u=!1,spectrogramMode:d="full",highContrast:h=!1}){const f=S.useRef(null),p=S.useRef(null),m=S.useRef(new Map),v=S.useRef(null),_=S.useCallback(y=>{var b;if(!c||!f.current)return;let x;"touches"in y?x=((b=y.touches[0])==null?void 0:b.clientX)??0:x=y.clientX;const g=f.current.getBoundingClientRect(),w=x-g.left,T=g.width/2,A=g.width*.1;if(Math.abs(w-T)<A/2)return;const C=w<T?"left":"right";c(C)},[c]);return S.useEffect(()=>{if(!f.current)return;const y=new P1({width:t,height:e,backgroundColor:Ft.background,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0});f.current.appendChild(y.view),p.current=y,_y(y,t,e),wy(y,t,e),Sy(y,t,e);const x=new Ut;return y.stage.addChild(x),v.current=x,()=>{p.current&&(p.current.destroy(!0,{children:!0}),p.current=null),m.current.clear()}},[t,e]),S.useEffect(()=>{if(p.current){p.current.renderer.resize(t,e);const y=p.current;for(;y.stage.children.length>0;)y.stage.removeChildAt(0);_y(y,t,e),wy(y,t,e),Sy(y,t,e);const x=new Ut;y.stage.addChild(x),v.current=x,m.current.clear()}},[t,e]),S.useEffect(()=>{const y=v.current;if(!y)return;if(s!=="playing"){y.removeChildren(),m.current.clear();return}if(r.length===0)return;const x=t/2,g=x*kM,w=e*Bf;for(const T of r){if(m.current.has(T.event_id))continue;const A=RM(T,x,g,Dd,w,T.spectrogramPath,u,d,h);A.container.y=-Dd,y.addChild(A.container),m.current.set(T.event_id,A)}},[r,s,t,e,u,d,h]),S.useEffect(()=>{if(s!=="playing"||!p.current)return;const y=e*Bf;let x;const g=()=>{const w=performance.now(),T=w-i;for(const A of m.current.values())if(A.hasBeenScored&&A.feedbackType){const C=w-A.feedbackStartTime;C>500&&(A.container.alpha=Math.max(0,1-(C-500)/200),A.container.alpha<=0&&(A.container.visible=!1))}else{const C=A.scheduledTimeMs-A.enterTimeMs,b=T-A.enterTimeMs,I=Math.max(0,b/C),N=-Dd,L=y;if(A.container.y=N+I*(L-N),d==="fading"){const D=A.container.getChildByName("spectrogram");D&&(I<.3?D.alpha=1:I<.8?D.alpha=1-(I-.3)/.5:D.alpha=0)}A.container.y>y+100&&(A.container.alpha=Math.max(0,1-(A.container.y-y-100)/50))}x=requestAnimationFrame(g)};return x=requestAnimationFrame(g),()=>{cancelAnimationFrame(x)}},[s,i,e,o,d]),S.useEffect(()=>{var y;if(a){for(const x of n)if(x.hasBeenScored&&x.channel===a.channel){const g=m.current.get(x.event_id);g&&!g.feedbackType&&(g.hasBeenScored=!0,g.feedbackType=a.type,g.feedbackStartTime=performance.now(),((y=a.breakdown)==null?void 0:y.speciesCorrect)?(vy(g,a.type,a.score),g.container.scale.set(1.3),setTimeout(()=>{g.container.visible=!1},400)):vy(g,a.type,a.score))}}},[a,n]),l.jsx("div",{ref:f,className:"pixi-game-container",onClick:_,onTouchStart:_,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none"}})}function RM(t,e,r,n,i,s,o=!1,a="full",c=!1){const u=new Ut,d=t.channel==="left"?e/2:e+e/2;u.x=d;const h=t.channel==="left"?Ft.laneLeft:Ft.laneRight,f=new Vt,p=c?.7:.4,m=c?4:2,v=c?1:.8;f.beginFill(h,p),f.lineStyle(m,h,v),f.drawRoundedRect(-r/2,-n/2,r,n,8),f.endFill(),u.addChild(f);const _=a!=="none"&&s;if(_&&yy(s).then(y=>{if(y&&u.parent){const x=new Jn(y);x.anchor.set(.5),x.position.set(0,0);const g=r-16,w=n-16;x.width=g,x.height=w,x.name="spectrogram",u.addChildAt(x,1),console.log(`[Sprite] Added spectrogram to tile: ${s}`)}else y?u.parent||console.warn(`[Sprite] Container removed before sprite could be added: ${s}`):console.error(`[Sprite] Texture null for: ${s}`)}),!_){const y=new Vt;for(let w=0;w<6;w++){const T=-n/2+10+w*10,A=(Math.random()*.4+.4)*r,C=-A/2+(Math.random()-.5)*20;y.beginFill(16777215,.2+Math.random()*.2),y.drawRect(C,T,A,2),y.endFill()}u.addChild(y);const x=new ar({fontFamily:"Inter, sans-serif",fontSize:18,fill:16777215,fontWeight:"700"}),g=new ji("?",x);g.anchor.set(.5),g.position.set(0,0),g.alpha=.4,u.addChild(g)}if(o){const y=new ar({fontFamily:"Inter, sans-serif",fontSize:10,fill:16777215,fontWeight:"700"}),x=new ji(t.species_code,y);x.anchor.set(.5),x.position.set(r/2-20,-n/2+44),x.alpha=.8;const g=new Vt;g.beginFill(0,.7);const w=3,T=x.width+w*2,A=x.height+w*2;g.drawRoundedRect(-T/2,-A/2,T,A,2),g.endFill(),g.position.set(x.position.x,x.position.y),u.addChild(g),u.addChild(x);const C=`data/icons/${t.species_code}.png`;yy(C).then(b=>{if(b&&u.parent){const I=new Jn(b);I.anchor.set(.5),I.width=32,I.height=32,I.position.set(r/2-20,-n/2+20),I.alpha=.9,u.addChild(I)}})}return{container:u,eventId:t.event_id,scheduledTimeMs:t.scheduled_time_ms,enterTimeMs:t.scoring_window_start_ms,channel:t.channel,speciesCode:t.species_code,hasBeenScored:!1,feedbackType:null,feedbackStartTime:0,spectrogramPath:s}}function vy(t,e,r){const n=t.container,i=e==="perfect"||e==="good"?Ft.perfect:e==="partial"?Ft.partial:Ft.miss,s=new Vt,o=100,a=70;if(s.beginFill(i,.5),s.drawRoundedRect(-o/2,-a/2,o,a,8),s.endFill(),n.addChildAt(s,1),r>0){const c=new ar({fontFamily:"JetBrains Mono, monospace",fontSize:20,fontWeight:"700",fill:i,stroke:0,strokeThickness:3}),u=new ji(`+${r}`,c);u.anchor.set(.5),u.position.set(0,-a/2-15),n.addChild(u)}n.scale.set(1.1),setTimeout(()=>{n.scale.set(1)},100)}function _y(t,e,r){const n=e/2,i=new Vt;i.beginFill(Ft.background,1),i.drawRect(0,0,n-1,r),i.endFill(),t.stage.addChild(i);const s=new Vt;s.beginFill(Ft.background,1),s.drawRect(n+1,0,n-1,r),s.endFill(),t.stage.addChild(s);const o=new ar({fontFamily:"Inter, sans-serif",fontSize:14,fill:Ft.textMuted,fontWeight:"600"}),a=new ji("LEFT",o);a.anchor.set(.5),a.position.set(n/2,30),a.alpha=.5,t.stage.addChild(a);const c=new ji("RIGHT",o);c.anchor.set(.5),c.position.set(n+n/2,30),c.alpha=.5,t.stage.addChild(c)}function wy(t,e,r){const n=e/2,i=r*Bf,s=4,o=new Vt;o.beginFill(Ft.hitZone,.8),o.drawRect(20,i,n-40,s),o.endFill(),t.stage.addChild(o);const a=new Vt;a.beginFill(Ft.hitZone,.8),a.drawRect(n+20,i,n-40,s),a.endFill(),t.stage.addChild(a);const c=new Vt;c.beginFill(Ft.hitZone,.2),c.drawRect(20,i-2,n-40,s+4),c.endFill(),t.stage.addChild(c);const u=new Vt;u.beginFill(Ft.hitZone,.2),u.drawRect(n+20,i-2,n-40,s+4),u.endFill(),t.stage.addChild(u)}function Sy(t,e,r){const n=e/2,i=new Vt,s=20,o=10;let a=0;for(i.beginFill(Ft.surface,.5);a<r;)i.drawRect(n-1,a,2,s),a+=s+o;i.endFill(),t.stage.addChild(i)}const IM=S.memo(PM),Sn={SPECIES_CORRECT:50,CHANNEL_CORRECT:25,TIMING_PERFECT:25,TIMING_PARTIAL:10};class MM{constructor(e){vn(this,"panner");this.panner=e.createStereoPanner()}get output(){return this.panner}setPan(e){this.panner.pan.value=Math.max(-1,Math.min(1,e))}disconnect(){this.panner.disconnect()}}class by{constructor(e){vn(this,"ctx");vn(this,"inputGain");vn(this,"leftGain");vn(this,"rightGain");vn(this,"merger");this.ctx=e,this.inputGain=e.createGain(),this.leftGain=e.createGain(),this.rightGain=e.createGain(),this.merger=e.createChannelMerger(2),this.inputGain.connect(this.leftGain),this.inputGain.connect(this.rightGain),this.leftGain.connect(this.merger,0,0),this.rightGain.connect(this.merger,0,1),this.setPan(0)}get output(){return this.inputGain}get destination(){return this.merger}setPan(e){const n=(Math.max(-1,Math.min(1,e))+1)*Math.PI/4,i=Math.cos(n),s=Math.sin(n);this.leftGain.gain.setValueAtTime(i,this.ctx.currentTime),this.rightGain.gain.setValueAtTime(s,this.ctx.currentTime)}disconnect(){this.inputGain.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.merger.disconnect()}}class jM{constructor(){vn(this,"capabilities");this.capabilities=this.detectCapabilities(),console.log("Audio capabilities:",this.capabilities)}detectCapabilities(){const e=navigator.userAgent,r=/iPad|iPhone|iPod/.test(e)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,n=r&&/CriOS/.test(e),i=r&&/FxiOS/.test(e),s=r&&/EdgiOS/.test(e),o=typeof AudioContext<"u"||typeof window.webkitAudioContext<"u",a=o&&typeof StereoPannerNode<"u"&&!n&&!i&&!s;return{supportsStereoPanner:a,supportsWebAudio:o,isIOSChrome:n,isIOS:r,browserInfo:`iOS: ${r}, Chrome: ${n}, StereoPanner: ${a}`}}getCapabilities(){return{...this.capabilities}}supportsStereoPanner(){return this.capabilities.supportsStereoPanner}isIOSChrome(){return this.capabilities.isIOSChrome}createPanner(e){return this.capabilities.supportsStereoPanner?new MM(e):new by(e)}createChannelPanner(e,r){const n=this.createPanner(e);return n.setPan(r==="left"?-1:1),n}connectPannerToDestination(e,r){e instanceof by?e.destination.connect(r):e.output.connect(r)}}let Od=null;function Ey(){return Od||(Od=new jM),Od}const Ty={low:100,medium:150,high:200},BM={level_id:1,pack_id:"common_se_birds",mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full"},NM={NOCA:"#E57373",CARW:"#81C784",BLJA:"#4FC3F7",AMCR:"#424242",TUTI:"#FFD54F",BEKI:"#00BCD4",RSHA:"#8D6E63",AMGO:"#FFEB3B",CACH:"#B0BEC5",PIWA:"#AED581",WTSP:"#BCAAA4",HOFI:"#EF9A9A",EABL:"#64B5F6",AMRO:"#FF8A65",HETH:"#D7CCC8",BHNU:"#A1887F",BRCR:"#8D6E63",WBNU:"#80CBC4",YBSA:"#FFF59D",RBWO:"#CE93D8",DOWO:"#90A4AE",HAWO:"#CFD8DC",NOFL:"#FFCC80",PIWO:"#B39DDB",BRTH:"#A1887F",GRCA:"#78909C",MODO:"#BCAAA4"};function FM(t){let e=t;return()=>(e=e*1103515245+12345&2147483647,e/2147483647)}function LM(t=BM){const e=S.useRef(null),r=S.useRef(new Map),n=S.useRef(new Map),i=S.useRef(new Map),s=S.useRef(new Map),o=S.useRef(new Map),a=S.useRef(null),[c,u]=S.useState({}),d=S.useMemo(()=>{try{return localStorage.getItem("soundfield_taxonomic_sort")==="true"}catch{return!1}},[]),[h,f]=S.useState([]),[p,m]=S.useState([]),[v,_]=S.useState([]);S.useEffect(()=>{console.log("species state changed, now has",v.length,"species:",v.map(G=>G.code))},[v]),S.useEffect(()=>{fetch("/data/taxonomic_order.json").then(G=>G.json()).then(G=>{u(G)}).catch(G=>console.error("Failed to load taxonomic order:",G))},[]);const y=S.useCallback(G=>d&&Object.keys(c).length>0?[...G].sort((de,xe)=>{const le=c[de.code]||9999,ye=c[xe.code]||9999;return le-ye}):[...G].sort((de,xe)=>de.code.localeCompare(xe.code)),[d,c]),[x,g]=S.useState("idle"),[w,T]=S.useState(0),[A,C]=S.useState(0),[b,I]=S.useState(t.round_duration_sec),[N,L]=S.useState(0),[D,P]=S.useState(0),[O,z]=S.useState(0),[H,W]=S.useState(0),[k,U]=S.useState(0),[R,E]=S.useState([]),[F,j]=S.useState([]),[q,J]=S.useState(0),B=S.useRef(1),Y=S.useRef(typeof window<"u"&&localStorage.getItem("soundfield_continuous_play")==="true"),[ge,pe]=S.useState(0),te=5e3,[fe,M]=S.useState(()=>{const G=Ty[t.event_density]||100,de=localStorage.getItem("soundfield_scroll_speed"),xe=de?parseFloat(de):.5;return B.current=xe,G*xe}),[K,ne]=S.useState(null),[ue,ke]=S.useState(!0),Le=S.useRef(null),et=S.useRef([]),Me=S.useRef(0),pn=S.useRef([]),zi=S.useRef(new Set),Gi=S.useRef(0),Er=S.useRef(0),hu=S.useRef(0),fu=S.useRef(0),pu=S.useRef(0),Hi=S.useRef(0),ka=S.useRef([]),mu=S.useRef([]),Pa=S.useRef(0),mn=S.useRef(null),Rt=S.useRef(null),gn=S.useRef({left:null,right:null}),yt=S.useRef({left:null,right:null}),Kp=S.useCallback(async()=>{var G;console.log("loadClips called with level:",{pack_id:t.pack_id,species_pool_length:(G=t.species_pool)==null?void 0:G.length,species_count:t.species_count});try{const de=await fetch("/data/clips.json");if(!de.ok)throw new Error("Failed to load clips.json");const xe=await de.json();f(xe);const le=t.species_pool,ye=le?new Set(le):null,he=new Map;for(const _e of xe)ye&&!ye.has(_e.species_code)||he.has(_e.species_code)||he.set(_e.species_code,{code:_e.species_code,name:_e.common_name,color:NM[_e.species_code]});const Se=Array.from(he.values());m(Se);const Ne=sessionStorage.getItem("roundSpecies");if(Ne)try{const _e=JSON.parse(Ne),Ie=Se.filter($=>_e.includes($.code)),Je=y(Ie);if(Je.length>0){console.log("loadClips: Using pre-selected species:",Je.map($=>$.code)),_(Je);return}}catch(_e){console.error("Failed to parse pre-selected species in loadClips:",_e)}_(Se)}catch(de){console.error("Error loading clips:",de)}},[t.species_pool,t.species_count]),qp=S.useCallback(async()=>{if(e.current){console.log("initializeAudio: Already initialized, setting isAudioReady"),ke(!0);return}try{const G=Ey();console.log("initializeAudio: Browser capabilities:",G.getCapabilities());const de=new AudioContext;e.current=de,console.log("initializeAudio: AudioContext created, state:",de.state),de.state==="suspended"&&(console.log("initializeAudio: AudioContext suspended, attempting resume..."),await de.resume(),console.log("initializeAudio: AudioContext resumed, state:",de.state)),ke(!0),console.log("initializeAudio: Audio is ready!")}catch(G){console.error("initializeAudio: Failed to initialize audio:",G),ke(!0)}},[]),gu=S.useCallback(async G=>{const de=e.current;if(!de)throw new Error("Audio context not initialized");const xe=r.current.get(G);if(xe)return console.log("loadAudioBuffer: Using cached buffer for",G),xe;console.log("loadAudioBuffer: Fetching",G);const le=await fetch(`/${G}`);if(!le.ok)throw console.error("loadAudioBuffer: Fetch failed",le.status,le.statusText),new Error(`Failed to load audio: ${G}`);console.log("loadAudioBuffer: Fetch OK, decoding...");const ye=await le.arrayBuffer();try{const he=await de.decodeAudioData(ye);return console.log("loadAudioBuffer: Decoded OK, duration:",he.duration),r.current.set(G,he),he}catch(he){throw console.error(` DECODE FAILED for ${G}:`,he),console.error("  This file cannot be played in Web Audio API (gameplay)"),console.error("  File size:",ye.byteLength,"bytes"),new Error(`Cannot decode audio file: ${G} - ${he}`)}},[]),Jp=S.useCallback(async(G,de,xe,le)=>{const ye=e.current;if(!ye){console.error("playAudio: No AudioContext!");return}console.log("playAudio:",G,"ctx.state:",ye.state);try{ye.state==="suspended"&&(console.log("playAudio: Context suspended, trying to resume..."),await ye.resume());const he=await gu(G);console.log("playAudio: Buffer loaded, duration:",he.duration);const Se=Ey();console.log("playAudio: Using adapter, capabilities:",Se.getCapabilities());const Ne=ye.createBufferSource(),_e=ye.createGain(),Ie=Se.createChannelPanner(ye,de);_e.gain.value=.05,Ne.buffer=he,Ne.connect(_e),_e.connect(Ie.output),Se.connectPannerToDestination(Ie,ye.destination),Ne.loop=!0,n.current.set(xe,Ne),i.current.set(xe,_e),s.current.set(xe,Ie),o.current.set(xe,le),Ne.onended=()=>{n.current.delete(xe),i.current.delete(xe);const Je=s.current.get(xe);Je&&(Je.disconnect(),s.current.delete(xe)),o.current.delete(xe)},Ne.start(),console.log("playAudio: Started playing")}catch(he){console.error(" playAudio FAILED for",G),console.error("   Error:",he),console.error("   This bird will have no audio during gameplay!")}},[gu]),eo=S.useCallback(G=>{const de=n.current.get(G);if(de)try{de.stop()}catch{}const xe=s.current.get(G);xe&&xe.disconnect(),n.current.delete(G),i.current.delete(G),s.current.delete(G),o.current.delete(G)},[]),Qp=S.useCallback((G,de,xe,le)=>{const ye=de.filter($=>$.species_code===G&&!$.rejected);if(ye.length===0)return[];const he=ye.filter($=>$.canonical),Se=ye.filter($=>!$.canonical);if(xe==="canonical")return he.length>0?he:ye.slice(0,1);if(xe==="all")return ye;const Ne=xe,_e=[];he.length>0&&_e.push(...he);const Ie=[...Se];for(let $=Ie.length-1;$>0;$--){const oe=Math.floor(le()*($+1));[Ie[$],Ie[oe]]=[Ie[oe],Ie[$]]}const Je=Ne-_e.length;return _e.push(...Ie.slice(0,Je)),_e},[]),Zp=S.useCallback(G=>{const de=[],xe=Date.now(),le=FM(xe),ye=t.clip_selection??(t.canonical_only?"canonical":"all");let he;if(G&&G.length>0)he=[...G];else if(t.species_pool&&t.species_pool.length>0)he=[...t.species_pool];else{const $=new Set;for(const Ce of h)Ce.rejected||$.add(Ce.species_code);const oe=Array.from($);for(let Ce=oe.length-1;Ce>0;Ce--){const je=Math.floor(le()*(Ce+1));[oe[Ce],oe[je]]=[oe[je],oe[Ce]]}he=oe.slice(0,t.species_count)}const Se=new Map;for(const $ of he){const oe=Qp($,h,ye,le);oe.length>0&&Se.set($,oe)}if(he=he.filter($=>Se.has($)),he.length===0)return console.error("No species with available clips!"),[];console.log("generateEvents:",{clipSelection:ye,selectedSpecies:he,clipsPerSpecies:Object.fromEntries(Array.from(Se.entries()).map(([$,oe])=>[$,oe.map(Ce=>Ce.clip_id)]))});const Ne=2,_e=new Map,Je=localStorage.getItem("soundfield_continuous_play")==="true"?100:Math.ceil(t.round_duration_sec/2)+5;for(let $=0;$<Je;$++){const oe=he.filter(Wr=>(Se.get(Wr)||[]).some(_t=>(_e.get(_t.clip_id)||0)<Ne));let Ce;oe.length>0?Ce=oe[Math.floor(le()*oe.length)]:Ce=he[Math.floor(le()*he.length)];const je=Se.get(Ce)||[],vt=je.filter(Wr=>(_e.get(Wr.clip_id)||0)<Ne);let It;if(vt.length>0?It=vt[Math.floor(le()*vt.length)]:It=je.reduce((Wr,$i)=>{const _t=_e.get(Wr.clip_id)||0;return(_e.get($i.clip_id)||0)<_t?$i:Wr},je[0]),!It)continue;_e.set(It.clip_id,(_e.get(It.clip_id)||0)+1);const ii=le()<.5?"left":"right";de.push({event_id:`evt_${$}_${xe}`,clip_id:It.clip_id,species_code:Ce,channel:ii,scheduled_time_ms:0,scoring_window_start_ms:0,scoring_window_end_ms:0,duration_ms:It.duration_ms,vocalization_type:It.vocalization_type})}return de},[h,t,Qp]),em=S.useCallback(G=>h.find(de=>de.clip_id===G),[h]),lr=S.useCallback(G=>{const de=mu.current,xe=Pa.current,le=t.channel_mode||"single",ye=te/B.current;if(xe>=de.length){le==="single"?mn.current=null:G&&(gn.current[G]=null);return}const he=performance.now(),Se=Me.current,Ne=he-Se;if(!Y.current&&t.round_duration_sec*1e3-Ne<2e3){le==="single"?mn.current=null:G&&(gn.current[G]=null);return}const _e=de[xe];Pa.current=xe+1;let Ie;if(le==="offset"&&G?Ie=G:Ie=_e.channel,le==="single")Rt.current!==null&&(clearTimeout(Rt.current),Rt.current=null);else{const _t=yt.current[Ie];_t!==null&&(clearTimeout(_t),yt.current[Ie]=null)}const Je=Ne,$=Ne+ye,oe={..._e,channel:Ie,scheduled_time_ms:$,scoring_window_start_ms:Je,scoring_window_end_ms:$+500};le==="single"?mn.current=oe.event_id:gn.current[Ie]=oe.event_id;const Ce=em(oe.clip_id);if(!Ce){console.error("spawnNextEvent: clip not found for clip_id:",oe.clip_id,"species:",oe.species_code),le==="single"?lr():G&&lr(G);return}pn.current.push(oe);const je={...oe,spectrogramPath:Ce.spectrogram_path||null,filePath:Ce.file_path};j(_t=>[..._t,je]),Jp(Ce.file_path,Ie,oe.event_id,oe.scheduled_time_ms),E(_t=>[..._t,{...oe,isActive:!0,hasBeenScored:!1}]);const vt=ye+500,It=oe.event_id,ii=Ie,Wr=oe.species_code,$i=window.setTimeout(()=>{if(le==="single"){if(mn.current!==It)return;Rt.current=null}else{if(gn.current[ii]!==It)return;yt.current[ii]=null}eo(It),E(_t=>_t.map(yn=>yn.event_id===It?{...yn,isActive:!1}:yn)),E(_t=>{const yn=_t.find(to=>to.event_id===It);if(yn&&!yn.hasBeenScored){U(Vi=>Vi+1),pu.current+=1,C(0),ka.current.push({expectedSpecies:Wr,guessedSpecies:null,channel:ii});const to={id:`miss_${Date.now()}`,type:"miss",score:0,breakdown:{speciesCorrect:!1,channelCorrect:!1,timingAccuracy:"miss",speciesPoints:0,channelPoints:0,timingPoints:0,totalPoints:0},channel:ii,timestamp:performance.now(),expectedSpecies:Wr};ne(to),setTimeout(()=>{ne(Vi=>(Vi==null?void 0:Vi.id)===to.id?null:Vi)},1500)}return _t}),window.setTimeout(()=>{le==="single"?lr():lr(ii)},200)},vt);le==="single"?Rt.current=$i:yt.current[Ie]=$i},[em,Jp,eo,t.round_duration_sec,t.channel_mode]),tm=S.useCallback((G,de)=>{if((t.channel_mode||"single")==="single"){if(mn.current!==G)return;Rt.current!==null&&(clearTimeout(Rt.current),Rt.current=null),mn.current=null,eo(G),lr()}else{if(gn.current[de]!==G)return;const le=yt.current[de];le!==null&&(clearTimeout(le),yt.current[de]=null),gn.current[de]=null,eo(G),lr(de)}},[eo,lr,t.channel_mode]),rm=S.useCallback(async()=>{console.log("initialize: Starting...");try{await Promise.all([Kp().catch(G=>console.error("initialize: loadClips failed:",G)),qp().catch(G=>console.error("initialize: initializeAudio failed:",G))])}catch(G){console.error("initialize: Failed:",G)}ke(!0),console.log("initialize: Complete, isAudioReady forced to true")},[Kp,qp]),nm=S.useCallback(async()=>{if(console.log("startRound called, roundState:",x,"clips.length:",h.length),x!=="idle"||h.length===0)return;let G=e.current;if(G||(G=new AudioContext,e.current=G,console.log("AudioContext created during tap")),G.state==="suspended")try{await G.resume(),console.log("AudioContext resumed, state:",G.state)}catch($){console.error("Failed to resume AudioContext:",$)}try{const $="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAYYoRwmHAAAAAAD/+1DEAAAHAAGf9AAAIgAANIAAAARMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7UMQbA8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",oe=new Audio($);oe.volume=.01,await oe.play(),console.log("HTML5 silent audio played to unlock iOS audio session")}catch($){console.error("Failed to play HTML5 silent audio:",$)}console.log("AudioContext state:",G.state),ke(!0);const de=Ty[t.event_density]||100,xe=localStorage.getItem("soundfield_scroll_speed"),le=xe?parseFloat(xe):.5;B.current=le,M(de*le),T(0),C(0),L(0),P(0),z(0),W(0),U(0),E([]),j([]),ne(null),I(t.round_duration_sec),zi.current.clear(),Gi.current=0,Er.current=0,hu.current=0,fu.current=0,pu.current=0,Hi.current=0,ka.current=[],pn.current=[];let ye;console.log("startRound: allPoolSpecies.length =",p.length,"species_count =",t.species_count);const he=sessionStorage.getItem("roundSpecies");if(he)try{const $=JSON.parse(he);sessionStorage.removeItem("roundSpecies");const oe=$.filter(Ce=>p.some(je=>je.code===Ce));if(oe.length>0){const Ce=p.filter(vt=>oe.includes(vt.code)),je=y(Ce);console.log("Using pre-selected species:",je.map(vt=>vt.code)),_(je),ye=je.map(vt=>vt.code)}}catch($){console.error("Failed to parse pre-selected species:",$),sessionStorage.removeItem("roundSpecies")}if(!ye)if(t.species_count&&p.length>t.species_count){const $=[...p];for(let je=$.length-1;je>0;je--){const vt=Math.floor(Math.random()*(je+1));[$[je],$[vt]]=[$[vt],$[je]]}const oe=$.slice(0,t.species_count),Ce=y(oe);console.log("Random selection: setting species to",Ce.length,"species:",Ce.map(je=>je.code)),_(Ce),ye=Ce.map(je=>je.code)}else console.log("Using all pool species:",p.length),_(p),ye=p.map($=>$.code);const Se=Zp(ye);mu.current=Se,Pa.current=0;const Ne=[...new Set(Se.map($=>$.clip_id))];console.log("Preloading",Ne.length,"audio clips during tap gesture...");const _e=Ne.map(async $=>{const oe=h.find(Ce=>Ce.clip_id===$);if(oe)try{await gu(oe.file_path)}catch(Ce){console.error("Failed to preload clip:",$,Ce)}});await Promise.all(_e),console.log("Audio preloading complete"),mn.current=null,Rt.current!==null&&(clearTimeout(Rt.current),Rt.current=null),gn.current={left:null,right:null},yt.current.left!==null&&clearTimeout(yt.current.left),yt.current.right!==null&&clearTimeout(yt.current.right),yt.current={left:null,right:null};const Ie=performance.now();if(g("playing"),J(Ie),Me.current=Ie,(t.channel_mode||"single")==="single")lr();else{lr("left");const oe=window.setTimeout(()=>{lr("right")},1500);et.current.push(oe)}if(Y.current=localStorage.getItem("soundfield_continuous_play")==="true",Y.current)I(0),Le.current=window.setInterval(()=>{I($=>$+1)},1e3);else{Le.current=window.setInterval(()=>{I(oe=>oe<=1?(xn(),0):oe-1)},1e3);const $=window.setTimeout(()=>{xn()},t.round_duration_sec*1e3);et.current.push($)}},[x,h.length,t.round_duration_sec,t.channel_mode,t.species_count,p,Zp,lr]),xn=S.useCallback(()=>{g("ended"),Le.current&&(clearInterval(Le.current),Le.current=null),Rt.current!==null&&(clearTimeout(Rt.current),Rt.current=null),mn.current=null,yt.current.left!==null&&clearTimeout(yt.current.left),yt.current.right!==null&&clearTimeout(yt.current.right),yt.current={left:null,right:null},gn.current={left:null,right:null};for(const le of et.current)clearTimeout(le);et.current=[];for(const le of n.current.values())try{le.stop()}catch{}for(const le of s.current.values())le.disconnect();n.current.clear(),i.current.clear(),s.current.clear(),o.current.clear();const G={};for(const le of pn.current){const ye=le.species_code;G[ye]||(G[ye]={total:0,correct:0}),G[ye].total++,zi.current.has(le.event_id)&&G[ye].correct++}const de=zi.current.size,xe={score:Er.current,eventsScored:de,totalEvents:pn.current.length,speciesCorrect:hu.current,channelCorrect:fu.current,perfectCount:Gi.current,missCount:pu.current,maxStreak:Hi.current,speciesResults:G,species:v.map(le=>({code:le.code,name:le.name})),mode:t.mode,packId:t.pack_id,levelId:t.level_id,levelTitle:t.title,confusionData:ka.current};localStorage.setItem("soundfield_round_results",JSON.stringify(xe))},[v,t.mode,t.pack_id,t.level_id,t.title]),im=S.useCallback((G,de,xe,le)=>{const ye=de===G.species_code,he=xe===G.channel,Se=G.scheduled_time_ms,Ne=G.scoring_window_start_ms,_e=Se-Ne,Ie=Se-le,Je=Math.max(0,Math.min(1,Ie/_e));let $;Je>=.5?$="perfect":(Je>=.25,$="partial");const oe=ye?Sn.SPECIES_CORRECT:0,Ce=ye&&he?Sn.CHANNEL_CORRECT:0;let je=0;ye&&he&&(Je>=.75?je=Sn.TIMING_PERFECT:Je>=.5&&(je=Sn.TIMING_PARTIAL));const vt=oe+Ce+je;return{speciesPoints:oe,channelPoints:Ce,timingPoints:je,totalPoints:vt,speciesCorrect:ye,channelCorrect:he,timingAccuracy:$}},[]),sm=S.useCallback((G,de)=>{if(x!=="playing")return;const xe=performance.now(),le=xe-Me.current,ye=t.channel_mode||"single",he=R.find($=>!($.hasBeenScored||le<$.scoring_window_start_ms||le>$.scoring_window_end_ms||ye==="offset"&&$.channel!==de));if(!he)return;const Se=im(he,G,de,le);ka.current.push({expectedSpecies:he.species_code,guessedSpecies:G,channel:he.channel}),Se.speciesCorrect&&zi.current.add(he.event_id),tm(he.event_id,he.channel),E($=>$.map(oe=>oe.event_id===he.event_id?{...oe,hasBeenScored:!0}:oe)),T($=>$+Se.totalPoints),Er.current+=Se.totalPoints,L($=>$+1),Se.speciesCorrect&&(P($=>$+1),hu.current+=1),Se.channelCorrect&&(z($=>$+1),fu.current+=1);const Ne=Sn.SPECIES_CORRECT+Sn.CHANNEL_CORRECT;Se.totalPoints===Ne?(W($=>$+1),Gi.current+=1,C($=>{const oe=$+1;return Hi.current=Math.max(Hi.current,oe),oe})):Se.totalPoints>0?C($=>{const oe=$+1;return Hi.current=Math.max(Hi.current,oe),oe}):C(0);let _e;const Ie=Sn.SPECIES_CORRECT+Sn.CHANNEL_CORRECT;Se.totalPoints===Ie?_e="perfect":Se.speciesCorrect&&Se.channelCorrect?_e="good":Se.speciesCorrect?_e="partial":_e="miss";const Je={id:`feedback_${Date.now()}`,type:_e,score:Se.totalPoints,breakdown:Se,channel:he.channel,timestamp:xe,expectedSpecies:_e==="miss"?he.species_code:void 0};ne(Je),setTimeout(()=>{ne($=>($==null?void 0:$.id)===Je.id?null:$)},_e==="miss"?1500:500)},[x,R,im,tm,t.channel_mode]),om=S.useCallback(()=>{xn(),g("idle"),T(0),C(0),L(0),P(0),z(0),W(0),U(0),E([]),j([]),J(0),ne(null),I(t.round_duration_sec)},[xn,t.round_duration_sec]);S.useEffect(()=>{if(x!=="playing"){a.current&&(cancelAnimationFrame(a.current),a.current=null);return}const G=()=>{var le;const de=performance.now()-Me.current,xe=te/B.current;for(const[ye,he]of i.current.entries()){const Se=o.current.get(ye);if(Se===void 0)continue;const Ne=Se-de,Ie=.05+Math.max(0,Math.min(1,1-Ne/xe))*.95;he.gain.setValueAtTime(Ie,((le=e.current)==null?void 0:le.currentTime)||0)}a.current=requestAnimationFrame(G)};return a.current=requestAnimationFrame(G),()=>{a.current&&cancelAnimationFrame(a.current)}},[x]),S.useEffect(()=>()=>{Le.current&&clearInterval(Le.current),a.current&&cancelAnimationFrame(a.current);for(const G of et.current)clearTimeout(G);for(const G of n.current.values())try{G.stop()}catch{}},[]),S.useEffect(()=>{if(x!=="playing"||!Y.current)return;const G=mu.current.length,de=Pa.current;G>0&&de>=G&&R.length===0&&(console.log("Continuous mode: all events processed, ending round"),xn())},[x,N,k,R.length,xn]);const Z1={roundState:x,score:w,streak:A,timeRemaining:b,totalTime:t.round_duration_sec,eventsScored:N,speciesCorrect:D,channelCorrect:O,perfectCount:H,missCount:k,activeEvents:R,scheduledEvents:F,roundStartTime:q,scrollSpeed:fe,currentFeedback:K,species:v,isAudioReady:ue},ew=S.useMemo(()=>({initialize:rm,startRound:nm,endRound:xn,submitInput:sm,reset:om}),[rm,nm,xn,sm,om]);return[Z1,ew]}function Ay({code:t,size:e=32,color:r}){const[n,i]=S.useState(!0),s=`/data/icons/${t}.png`;return l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[n&&l.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:"#FFFFFF",lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:t}),n?l.jsx("img",{src:s,alt:t,width:e,height:e,style:{borderRadius:"50%",objectFit:"cover"},onError:()=>i(!1)}):l.jsx("div",{style:{width:e,height:e,borderRadius:"50%",background:r||"transparent",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e*.35,fontWeight:700},children:t})]})}const Cy=["#E57373","#4FC3F7","#81C784","#FFD54F","#BA68C8","#FF8A65","#4DB6AC","#A1887F"],DM={1:"Meet the Birds",2:"Sound Variations",3:"Full Repertoire",4:"Both Ears",5:"Variations + Both Ears",6:"Master Birder"};function OM(t){return t===1||t===4?"canonical":t===2||t===5?3:"all"}function UM(t){return t>=4?"offset":"single"}const ky={campaign:{mode:"campaign",round_duration_sec:30,species_count:5,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},practice:{mode:"practice",round_duration_sec:60,species_count:3,event_density:"low",overlap_probability:0,scoring_window_ms:3e3,spectrogram_mode:"full",clip_selection:"canonical",channel_mode:"single"},challenge:{mode:"challenge",round_duration_sec:60,species_count:8,event_density:"medium",overlap_probability:0,scoring_window_ms:1500,spectrogram_mode:"fading",clip_selection:"all",channel_mode:"offset"},random:{mode:"random",round_duration_sec:45,species_count:6,event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:"full",clip_selection:"all",channel_mode:"single"}};function zM(){const t=qt(),[e]=qc(),r=S.useRef(null),[n,i]=S.useState({width:400,height:400}),[s,o]=S.useState(null),[a,c]=S.useState(null),[u,d]=S.useState([]),[h,f]=S.useState(!1),[p,m]=S.useState(()=>localStorage.getItem("soundfield_training_mode")==="true"),v=S.useRef(!1),_=S.useMemo(()=>localStorage.getItem("soundfield_spectrogram_mode")||"full",[]),y=S.useMemo(()=>localStorage.getItem("soundfield_high_contrast")==="true",[]);S.useEffect(()=>{localStorage.setItem("soundfield_training_mode",String(p)),p&&(v.current=!0)},[p]);const x=e.get("mode")||"campaign",g=e.get("pack")||"common_se_birds",w=parseInt(e.get("level")||"1",10);S.useEffect(()=>{console.log("Fetching levels.json..."),fetch("/data/levels.json").then(E=>E.json()).then(E=>{console.log("Loaded",E.length,"levels from levels.json"),d(E)}).catch(E=>{console.error("Failed to load levels.json:",E)})},[]);const T=S.useMemo(()=>{var F;if(console.log("levelConfig useMemo: mode =",x,"packId =",g,"campaignLevels.length =",u.length),g==="custom"){let j=[];try{const q=sessionStorage.getItem("roundSpecies");if(q)j=JSON.parse(q);else{const J=localStorage.getItem("soundfield_custom_pack");J&&(j=JSON.parse(J),sessionStorage.setItem("roundSpecies",J))}}catch(q){console.error("Failed to parse custom species:",q)}return console.log("Custom pack: using species:",j,"for level",w),{level_id:w,pack_id:"custom",mode:"campaign",title:DM[w]||`Level ${w}`,round_duration_sec:30,species_count:j.length,species_pool:j,clip_selection:OM(w),channel_mode:UM(w),event_density:"low",overlap_probability:0,scoring_window_ms:2e3,spectrogram_mode:_}}if(x==="campaign"&&u.length>0){const j=u.find(J=>J.pack_id===g&&J.level_id===w);if(j)return console.log("Found level from levels.json:",j.pack_id,j.title,"species_pool:",(F=j.species_pool)==null?void 0:F.length),{...j,spectrogram_mode:_};const q=u.find(J=>J.pack_id===g);return q?(console.log("Using first level for pack:",q.pack_id,q.title),{...q,spectrogram_mode:_}):(console.log("Ultimate fallback to first level"),{...u[0],spectrogram_mode:_})}console.log("Using hardcoded MODE_CONFIGS (no campaign levels loaded yet)");const E=ky[x]||ky.campaign;return{level_id:1,pack_id:g,...E,spectrogram_mode:_}},[x,g,w,u,_]),[A,C]=LM(T),b=S.useRef(null);S.useEffect(()=>{var j,q;if(x==="campaign"&&u.length===0&&g!=="custom"){console.log("Waiting for levels.json to load...");return}const E=((j=T.species_pool)==null?void 0:j.length)??"none",F=`${T.pack_id}-${T.level_id}-${E}`;console.log("Init effect: key =",F,"lastKey =",b.current),b.current!==F&&(b.current=F,console.log("Initializing for",F),C.initialize(),zE(T.pack_id,T.level_id,((q=T.species_pool)==null?void 0:q.length)??0))},[x,u.length,T.pack_id,T.level_id,T.species_pool,C]),S.useEffect(()=>{const E=()=>{if(r.current){const F=r.current.getBoundingClientRect();i({width:F.width,height:F.height})}};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const I=S.useRef(C);I.current=C;const N=S.useRef(A.roundState);N.current=A.roundState,S.useEffect(()=>()=>{N.current==="playing"&&I.current.reset()},[]);const L=S.useMemo(()=>localStorage.getItem("soundfield_continuous_play")==="true",[]),D=A.species.map((E,F)=>({code:E.code,name:E.name,color:E.color||Cy[F%Cy.length]})),P=S.useCallback(E=>{o(E);const F=document.getElementById(`flash-${E}`);F&&(F.classList.add("active"),setTimeout(()=>F.classList.remove("active"),150)),a&&(C.submitInput(a,E),o(null),c(null))},[a,C]),O=S.useCallback(E=>{c(E),s&&(C.submitInput(E,s),o(null),c(null))},[s,C]);S.useEffect(()=>{const E=F=>{if(A.roundState==="playing"){if(F.key==="a"||F.key==="A"||F.key==="ArrowLeft"||F.key==="1")P("left");else if(F.key==="d"||F.key==="D"||F.key==="ArrowRight"||F.key==="2")P("right");else if(F.key>="3"&&F.key<="9"){const j=parseInt(F.key)-3;j<D.length&&O(D[j].code)}}};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[A.roundState,P,O,D]);const z=S.useCallback(()=>{C.reset(),t("/")},[t,C]),H=S.useCallback(()=>{f(!0)},[]),W=S.useCallback(()=>{C.reset(),t(-1)},[t,C]),k=S.useCallback(()=>{f(!1)},[]),U=S.useCallback(()=>{console.log("handleStart clicked, isAudioReady:",A.isAudioReady,"species.length:",A.species.length),A.isAudioReady&&A.species.length>0?(console.log("Calling startRound..."),v.current=p,C.startRound()):console.log("Not calling startRound - conditions not met")},[A.isAudioReady,A.species.length,C,p]),R=S.useCallback(()=>{C.endRound();try{const E=localStorage.getItem("soundfield_round_results");if(E){const F=JSON.parse(E);F.usedTrainingMode=v.current,localStorage.setItem("soundfield_round_results",JSON.stringify(F))}}catch(E){console.error("Failed to update results with training mode flag:",E)}t("/summary",{replace:!0})},[t,C]);return S.useEffect(()=>{if(A.roundState==="ended"){try{const E=localStorage.getItem("soundfield_round_results");if(E){const F=JSON.parse(E);F.usedTrainingMode=v.current,localStorage.setItem("soundfield_round_results",JSON.stringify(F));const j=F.correctCount&&F.totalEvents?F.correctCount/F.totalEvents*100:0,q=F.duration??0;GE(T.pack_id,T.level_id,A.score,j,q)}}catch(E){console.error("Failed to update results with training mode flag:",E)}t("/summary",{replace:!0})}},[A.roundState,A.score,T.pack_id,T.level_id,t]),l.jsxs("div",{className:"gameplay-screen",children:[l.jsx(ST,{score:A.score,streak:A.streak,timeRemaining:A.timeRemaining,mode:x,levelId:T.level_id,levelTitle:T.title}),l.jsx("button",{className:"back-button",onClick:z,"aria-label":"Back to menu",children:l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}),A.roundState==="playing"&&l.jsx("button",{className:"quit-button",onClick:H,"aria-label":"Quit round",children:l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),l.jsx("button",{className:`training-toggle ${p?"active":""}`,onClick:()=>{const E=!p;m(E),HE(E)},"aria-label":p?"Disable training mode":"Enable training mode",title:p?"Training Mode ON - Icons visible":"Training Mode OFF",children:l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:p?l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]}):l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]})})}),L&&A.roundState==="playing"&&l.jsx("button",{className:"end-round-button",onClick:R,"aria-label":"End round",children:"End Round"}),l.jsxs("div",{ref:r,className:"game-container",children:[l.jsx(IM,{width:n.width,height:n.height,scheduledEvents:A.scheduledEvents,activeEvents:A.activeEvents,roundStartTime:A.roundStartTime,roundState:A.roundState,scrollSpeed:A.scrollSpeed,currentFeedback:A.currentFeedback,onChannelTap:P,trainingMode:p,spectrogramMode:T.spectrogram_mode,highContrast:y}),l.jsx("div",{id:"flash-left",className:"channel-flash left"}),l.jsx("div",{id:"flash-right",className:"channel-flash right"}),s&&l.jsx("div",{className:`channel-indicator ${s}`,children:s.toUpperCase()}),A.roundState==="idle"&&l.jsx("div",{className:"start-overlay",children:l.jsx("button",{className:"start-button",onClick:U,disabled:!A.isAudioReady||A.species.length===0,children:A.isAudioReady&&A.species.length>0?"Start Round":"Loading..."})}),A.currentFeedback&&l.jsxs("div",{className:`feedback-overlay ${A.currentFeedback.type} ${A.currentFeedback.channel}`,children:[l.jsxs("div",{className:"feedback-score",children:["+",A.currentFeedback.score]}),l.jsx("div",{className:"feedback-type",children:A.currentFeedback.type.toUpperCase()}),A.currentFeedback.type==="miss"&&A.currentFeedback.expectedSpecies&&l.jsxs("div",{className:"feedback-correct",children:["Was: ",A.currentFeedback.expectedSpecies]})]})]}),l.jsxs("div",{className:"dual-input-panel",children:[l.jsxs("div",{className:"input-column left",children:[l.jsx("div",{className:"column-label",children:"LEFT EAR"}),l.jsx("div",{className:"species-buttons",children:D.map(E=>l.jsx("button",{className:`species-btn ${a===E.code?"selected":""}`,style:{backgroundColor:a===E.code?E.color:void 0},onClick:()=>{C.submitInput(E.code,"left");const F=document.getElementById("flash-left");F&&(F.classList.add("active"),setTimeout(()=>F.classList.remove("active"),150))},disabled:A.roundState!=="playing",children:l.jsx(Ay,{code:E.code,size:36,color:E.color})},E.code))})]}),l.jsxs("div",{className:"input-column right",children:[l.jsx("div",{className:"column-label",children:"RIGHT EAR"}),l.jsx("div",{className:"species-buttons",children:D.map(E=>l.jsx("button",{className:`species-btn ${a===E.code?"selected":""}`,style:{backgroundColor:a===E.code?E.color:void 0},onClick:()=>{C.submitInput(E.code,"right");const F=document.getElementById("flash-right");F&&(F.classList.add("active"),setTimeout(()=>F.classList.remove("active"),150))},disabled:A.roundState!=="playing",children:l.jsx(Ay,{code:E.code,size:36,color:E.color})},E.code))})]})]}),h&&l.jsx("div",{className:"quit-modal-overlay",children:l.jsxs("div",{className:"quit-modal",children:[l.jsx("h3",{style:{margin:0,marginBottom:"16px",fontSize:"20px"},children:"Quit Round?"}),l.jsx("p",{style:{margin:0,marginBottom:"24px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Your progress will not be saved."}),l.jsxs("div",{style:{display:"flex",gap:"12px"},children:[l.jsx("button",{className:"btn-secondary",onClick:k,style:{flex:1,padding:"12px"},children:"Cancel"}),l.jsx("button",{className:"btn-primary",onClick:W,style:{flex:1,padding:"12px",background:"var(--color-error)"},children:"Quit"})]})]})}),l.jsx("style",{children:`
        .gameplay-screen {
          display: flex;
          flex-direction: column;
          height: 100%;
          background-color: var(--color-background);
          overflow: hidden;
        }

        .back-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 8px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-text);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .back-button:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .quit-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 8px;
          width: 40px;
          height: 40px;
          background: rgba(229, 115, 115, 0.3);
          border: none;
          border-radius: 50%;
          color: var(--color-error);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: background 0.2s;
        }

        .quit-button:hover {
          background: rgba(229, 115, 115, 0.5);
        }

        .quit-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        .quit-modal {
          background: var(--color-surface);
          border-radius: 16px;
          padding: 24px;
          max-width: 320px;
          width: 90%;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
          animation: slideUp 0.2s ease-out;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

        .training-toggle {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          left: 56px;
          width: 40px;
          height: 40px;
          background: rgba(0, 0, 0, 0.3);
          border: 2px solid transparent;
          border-radius: 50%;
          color: var(--color-text-muted);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
          transition: all 0.2s;
        }

        .training-toggle:hover {
          background: rgba(0, 0, 0, 0.5);
        }

        .training-toggle.active {
          background: rgba(76, 175, 80, 0.3);
          border-color: rgba(76, 175, 80, 0.6);
          color: #81C784;
        }

        .end-round-button {
          position: absolute;
          top: calc(12px + var(--safe-area-top, 0px));
          right: 12px;
          padding: 8px 16px;
          background: rgba(229, 115, 115, 0.8);
          border: none;
          border-radius: 20px;
          color: white;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          z-index: 100;
          transition: background 0.2s;
        }

        .end-round-button:hover {
          background: rgba(229, 115, 115, 1);
        }

        .game-container {
          flex: 1;
          position: relative;
          min-height: 0;
          overflow: hidden;
        }

        .channel-flash {
          position: absolute;
          top: 0;
          bottom: 0;
          width: 50%;
          pointer-events: none;
          background: transparent;
          transition: background 0.1s;
        }

        .channel-flash.left {
          left: 0;
        }

        .channel-flash.right {
          right: 0;
        }

        .channel-flash.active {
          background: rgba(255, 255, 255, 0.1);
        }

        .channel-indicator {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 8px 16px;
          background: var(--color-accent);
          color: var(--color-background);
          font-weight: 700;
          font-size: 14px;
          border-radius: 4px;
          pointer-events: none;
          animation: fadeIn 0.15s ease-out;
        }

        .channel-indicator.left {
          left: 20px;
        }

        .channel-indicator.right {
          right: 20px;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-50%) scale(0.9);
          }
          to {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
        }

        .start-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(0, 0, 0, 0.7);
          z-index: 50;
        }

        .start-button {
          padding: 16px 32px;
          font-size: 18px;
          font-weight: 700;
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: transform 0.2s, background 0.2s;
        }

        .start-button:hover:not(:disabled) {
          transform: scale(1.05);
          background: var(--color-accent);
        }

        .start-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .feedback-overlay {
          position: absolute;
          top: 50%;
          transform: translateY(-50%);
          padding: 12px 20px;
          border-radius: 8px;
          pointer-events: none;
          animation: feedbackPop 0.5s ease-out forwards;
          z-index: 60;
        }

        .feedback-overlay.left {
          left: 20%;
        }

        .feedback-overlay.right {
          right: 20%;
        }

        .feedback-overlay.perfect {
          background: var(--color-success);
        }

        .feedback-overlay.good {
          background: #4CAF50;
        }

        .feedback-overlay.partial {
          background: var(--color-accent);
        }

        .feedback-overlay.miss {
          background: var(--color-error);
          animation: feedbackPopMiss 1.5s ease-out forwards;
        }

        .feedback-score {
          font-family: var(--font-mono);
          font-size: 24px;
          font-weight: 700;
          color: white;
          text-align: center;
        }

        .feedback-type {
          font-size: 12px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          text-align: center;
        }

        .feedback-correct {
          font-size: 14px;
          font-weight: 700;
          color: white;
          text-align: center;
          margin-top: 4px;
          padding-top: 4px;
          border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes feedbackPop {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          20% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          40% {
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-80%) scale(1);
          }
        }

        @keyframes feedbackPopMiss {
          0% {
            opacity: 0;
            transform: translateY(-50%) scale(0.8);
          }
          5% {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
          }
          10% {
            transform: translateY(-50%) scale(1);
          }
          85% {
            opacity: 1;
            transform: translateY(-50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-70%) scale(1);
          }
        }

        .dual-input-panel {
          display: flex;
          justify-content: space-between;
          padding: 8px 12px;
          padding-bottom: calc(12px + var(--safe-area-bottom, 0px));
          background: linear-gradient(0deg, var(--color-surface) 0%, rgba(26, 26, 46, 0.9) 100%);
          gap: 20px;
        }

        .input-column {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }

        .input-column.left {
          align-items: flex-start;
        }

        .input-column.right {
          align-items: flex-end;
        }

        .column-label {
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          padding: 2px 8px;
          border-radius: 4px;
        }

        .input-column.left .column-label {
          color: #81C784;
          background: rgba(129, 199, 132, 0.15);
        }

        .input-column.right .column-label {
          color: #64B5F6;
          background: rgba(100, 181, 246, 0.15);
        }

        .species-buttons {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
        }

        .input-column.left .species-buttons {
          justify-content: flex-start;
        }

        .input-column.right .species-buttons {
          justify-content: flex-end;
        }

        .species-btn {
          padding: 6px;
          border-radius: 12px;
          border: 2px solid var(--color-text-muted);
          background: var(--color-surface);
          color: var(--color-text);
          font-size: 10px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.15s ease-out;
          touch-action: manipulation;
          -webkit-tap-highlight-color: transparent;
        }

        .species-btn:hover:not(:disabled) {
          transform: scale(1.1);
        }

        .species-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .species-btn.selected {
          color: var(--color-background);
          transform: scale(1.05);
        }

        .species-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }
      `})]})}const Q1=S.forwardRef(({score:t,accuracy:e,eventsScored:r,totalEvents:n,maxStreak:i,species:s,packId:o,levelId:a,levelTitle:c,topConfusion:u,usedTrainingMode:d},h)=>{const f=S.useRef(null),[p,m]=S.useState(!1),v=S.useRef(new Map),[_,y]=S.useState(!1),[x,g]=S.useState(!1),w=S.useRef(null);S.useEffect(()=>{(async()=>{const b="/",I=s.map(N=>new Promise((L,D)=>{const P=new Image;P.crossOrigin="anonymous",P.onload=()=>L({code:N.code,img:P}),P.onerror=D,P.src=`${b}data/icons/${N.code}.png`}));try{(await Promise.all(I)).forEach(({code:L,img:D})=>{v.current.set(L,D)}),m(!0)}catch(N){console.error("Failed to load bird icons:",N),m(!0)}})()},[s]),S.useEffect(()=>{(async()=>{const b="/",I=new Image;I.crossOrigin="anonymous",I.onload=()=>{w.current=I,g(!0)},I.onerror=()=>{console.error("Failed to load owl icon"),g(!0)},I.src=`${b}data/icons/OwlHeadphones.png`})()},[]),S.useEffect(()=>{if(!p||!x||!f.current)return;const C=f.current,b=C.getContext("2d");if(!b)return;const I=800,N=800,L=window.devicePixelRatio||1;C.width=I*L,C.height=N*L,C.style.width=`${I}px`,C.style.height=`${N}px`,b.scale(L,L),b.textBaseline="alphabetic";const D=b.createLinearGradient(0,0,0,N);if(D.addColorStop(0,"#f0f4f8"),D.addColorStop(1,"#d9e2ec"),b.fillStyle=D,b.fillRect(0,0,I,N),w.current){b.save(),b.globalAlpha=1;const Y=280,ge=I-Y-20,pe=20;b.beginPath(),b.arc(ge+Y/2,pe+Y/2,Y/2,0,Math.PI*2),b.clip(),b.drawImage(w.current,ge,pe,Y,Y),b.restore()}b.fillStyle="#102a43",b.font="bold 48px -apple-system, system-ui, sans-serif",b.textAlign="center",b.fillText("ChipNotes! ",I/2,80),b.textAlign="left";const P=60;b.font="80px -apple-system, system-ui, sans-serif",b.fillStyle=e>=80?"#6aaa64":e>=60?"#c9b458":"#787c7e",b.fillText("",P,200),b.font="bold 110px -apple-system, system-ui, sans-serif",b.fillText(`${e}%`,P+95,200),b.font="32px -apple-system, system-ui, sans-serif",b.fillStyle="#334e68",b.fillText(`${t} points`,P,245),b.font="22px -apple-system, system-ui, sans-serif",b.fillStyle="#486581",b.fillText(`${r}/${n} birds identified`,P,280),b.textAlign="center",b.font="bold 26px -apple-system, system-ui, sans-serif",b.fillStyle="#d97706",b.fillText(` Best Streak: ${i}`,I/2,320);const z=s.slice(0,4),H=160,W=24,k=z.length*H+(z.length-1)*W,U=(I-k)/2;let R=365;z.forEach((Y,ge)=>{const pe=U+ge*(H+W),te=R,fe=v.current.get(Y.code);if(fe){b.save(),b.beginPath(),b.arc(pe+H/2,te+H/2,H/2,0,Math.PI*2),b.clip();const M=fe.width/fe.height;let K=H,ne=H,ue=0,ke=0;M>1?(K=H*M,ue=-(K-H)/2):M<1&&(ne=H/M,ke=-(ne-H)/2),b.drawImage(fe,pe+ue,te+ke,K,ne),b.restore(),b.strokeStyle="#d3d6da",b.lineWidth=3,b.beginPath(),b.arc(pe+H/2,te+H/2,H/2,0,Math.PI*2),b.stroke(),b.font="22px -apple-system, system-ui, sans-serif",b.fillStyle="#102a43",b.fillText(Y.code,pe+H/2,te+H+38)}});const E=R+H+100;if(o&&a){const Y=GM(o);b.font="22px -apple-system, system-ui, sans-serif",b.fillStyle="#486581",b.fillText(`${Y}  Level ${a}`,I/2,E)}const F=s.map(Y=>Y.code).join("  ");b.font="18px -apple-system, system-ui, sans-serif",b.fillStyle="#627d98";const j=700,q=F.split(" ");let J="",B=E+32;for(let Y=0;Y<q.length;Y++){const ge=J+q[Y]+" ";b.measureText(ge).width>j&&Y>0?(b.fillText(J.trim(),I/2,B),J=q[Y]+" ",B+=25):J=ge}if(b.fillText(J.trim(),I/2,B),d){const Y=B+35;b.font="18px -apple-system, system-ui, sans-serif",b.fillStyle="#d97706",b.fillText(" Still training. Ready to migrate soon.",I/2,Y)}b.font="bold 26px -apple-system, system-ui, sans-serif",b.fillStyle="#102a43",b.textAlign="center",b.fillText("chipnotes.app",I/2,N-60),b.font="20px -apple-system, system-ui, sans-serif",b.fillStyle="#486581",b.fillText("#chipnotes #birdnerd",I/2,N-30),b.getImageData(0,0,1,1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{y(!0)})})},[p,x,t,e,r,n,i,s,o,a,u,d]);const T=()=>{if(!f.current)return;const C=document.createElement("a");C.download=`chipnotes-${e}pct-${Date.now()}.png`,C.href=f.current.toDataURL("image/png"),C.click()},A=async()=>{if(!f.current||!_)throw new Error("Canvas not ready");const C=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;try{if(C){const b=f.current.toDataURL("image/png"),I=window.open();return I&&(I.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
              <title>ChipNotes Score</title>
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <style>
                body {
                  margin: 0;
                  padding: 20px;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
                  background: #1a1a1a;
                  color: white;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  min-height: 100vh;
                }
                img {
                  max-width: 100%;
                  height: auto;
                  border-radius: 12px;
                  box-shadow: 0 10px 40px rgba(0,0,0,0.5);
                }
                .instructions {
                  margin-top: 20px;
                  padding: 16px;
                  background: rgba(255,255,255,0.1);
                  border-radius: 8px;
                  text-align: center;
                  max-width: 90%;
                }
                .instructions h2 {
                  margin: 0 0 12px 0;
                  font-size: 20px;
                }
                .instructions p {
                  margin: 8px 0;
                  font-size: 16px;
                  opacity: 0.9;
                }
                .highlight {
                  color: #d97706;
                  font-weight: 600;
                }
                .close-btn {
                  position: fixed;
                  top: 20px;
                  left: 20px;
                  width: 48px;
                  height: 48px;
                  border-radius: 50%;
                  background: rgba(255,255,255,0.9);
                  border: 2px solid rgba(0,0,0,0.1);
                  color: #1a1a1a;
                  font-size: 28px;
                  font-weight: bold;
                  cursor: pointer;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  transition: all 0.3s;
                  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                  z-index: 1000;
                }
                .close-btn:hover {
                  background: white;
                  transform: scale(1.1);
                  box-shadow: 0 6px 16px rgba(0,0,0,0.4);
                }
              </style>
            </head>
            <body>
              <button class="close-btn" onclick="window.close(); setTimeout(function() { window.history.back(); }, 100);"></button>
              <img src="${b}" alt="ChipNotes Score">
              <div class="instructions">
                <p> <span class="highlight">Press and hold the image above to share or save</span></p>
              </div>
            </body>
            </html>
          `),I.document.close()),"ios-instructions"}else{const b=await new Promise((N,L)=>{f.current.toBlob(D=>{D?N(D):L(new Error("toBlob failed"))},"image/png",1)}),I=new File([b],"chipnotes-score.png",{type:"image/png"});return navigator.share&&navigator.canShare&&navigator.canShare({files:[I]})?(await navigator.share({title:"ChipNotes! Score",text:`Just identified ${r}/${n} birds with ${e}% accuracy! `,files:[I]}),"shared"):(T(),"downloaded")}}catch(b){return console.error("Share failed:",b),T(),"error-downloaded"}};return S.useImperativeHandle(h,()=>({share:A,download:T,isReady:()=>_}),[_]),l.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px"},children:l.jsx("canvas",{ref:f})})});Q1.displayName="ShareCard";function GM(t){return{starter_birds:"Common Backyard",expanded_backyard:"Expanded Backyard",sparrows:"Sparrows",woodpeckers:"Woodpeckers",spring_warblers:"Warbler Academy",western_birds:"Western Backyard"}[t]||t}const Py=6;function HM(){const t=qt(),e=S.useRef(null),[r,n]=S.useState(null),[i,s]=S.useState([]),[o,a]=S.useState([]),[c,u]=S.useState(!1),[d,h]=S.useState(!1),[f,p]=S.useState(!1),[m,v]=S.useState(null);S.useEffect(()=>{var D;const L=localStorage.getItem("soundfield_round_results");if(L)try{const P=JSON.parse(L);if(n(P),P.mode==="campaign"&&P.levelId){const z="soundfield_progress",H=JSON.parse(localStorage.getItem(z)||"{}"),W=`level_${P.levelId}`,k=((D=H[W])==null?void 0:D.bestScore)||0;H[W]={completed:!0,bestScore:Math.max(k,P.score),accuracy:P.totalEvents>0?Math.round(P.eventsScored/P.totalEvents*100):0},localStorage.setItem(z,JSON.stringify(H))}const O=[];for(const z of P.species){const H=P.speciesResults[z.code]||{total:0,correct:0};H.total>0&&O.push({code:z.code,name:z.name,total:H.total,correct:H.correct,accuracy:Math.round(H.correct/H.total*100)})}if(O.sort((z,H)=>z.accuracy-H.accuracy),s(O),P.confusionData&&P.confusionData.length>0){const z=new Map;for(const W of P.confusionData){if(W.guessedSpecies===W.expectedSpecies)continue;const k=`${W.expectedSpecies}|${W.guessedSpecies??"MISS"}`;z.set(k,(z.get(k)||0)+1)}const H=[];for(const[W,k]of z.entries()){const[U,R]=W.split("|");H.push({expectedSpecies:U,guessedSpecies:R==="MISS"?null:R,count:k})}H.sort((W,k)=>k.count-W.count),a(H)}}catch(P){console.error("Failed to parse round results:",P)}},[]);const _=r&&r.totalEvents>0?Math.round(r.eventsScored/r.totalEvents*100):0,y=(r==null?void 0:r.mode)==="campaign",x=(r==null?void 0:r.levelId)||1,g=(r==null?void 0:r.packId)||"starter_birds",w=x>1,T=x<Py,A=L=>{if(r!=null&&r.species){const D=r.species.map(P=>P.code);sessionStorage.setItem("roundSpecies",JSON.stringify(D))}t(`/preview?pack=${g}&level=${L}&keepBirds=true`)},C=()=>{t(`/level-select?pack=${g}`)},b=()=>{t("/pack-select")},I=()=>{t("/")};S.useEffect(()=>{const L=setInterval(()=>{var D;(D=e.current)!=null&&D.isReady()&&(p(!0),clearInterval(L))},100);return()=>clearInterval(L)},[r]);const N=async()=>{if(e.current){h(!0),v(null);try{await e.current.share()==="ios-instructions"&&(v("Follow instructions in new tab to save & share! "),setTimeout(()=>v(null),5e3))}catch(L){console.error("Share failed:",L),v("Share failed. Please try again."),setTimeout(()=>v(null),3e3)}finally{h(!1)}}};return l.jsxs("div",{className:"screen",style:{paddingTop:"32px",paddingBottom:"calc(24px + var(--safe-area-bottom, 0px))"},children:[l.jsx("h1",{style:{textAlign:"center",marginBottom:"8px"},children:"ROUND COMPLETE"}),y&&l.jsxs("p",{className:"text-muted",style:{textAlign:"center",marginBottom:"16px"},children:["Level ",x,": ",(r==null?void 0:r.levelTitle)||"Campaign"]}),l.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto 16px"},children:[l.jsxs("button",{className:"btn-primary",onClick:N,disabled:d||!r||!f,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[l.jsx(WM,{}),d?"Generating...":f?"Share Your Score":"Preparing..."]}),l.jsx("p",{style:{fontSize:"13px",color:"var(--color-text-muted)",textAlign:"center",marginTop:"8px",marginBottom:"0",fontStyle:"italic"},children:"Let them Wordle, you already know how to spell."}),m&&l.jsx("p",{style:{fontSize:"14px",color:"var(--color-accent)",textAlign:"center",marginTop:"8px",marginBottom:"0",fontWeight:600,animation:"fadeIn 0.3s ease"},children:m})]}),r&&l.jsx(Q1,{ref:e,score:r.score,accuracy:_,eventsScored:r.eventsScored,totalEvents:r.totalEvents,maxStreak:r.maxStreak,species:r.species,packId:r.packId,levelId:r.levelId,levelTitle:r.levelTitle,usedTrainingMode:r.usedTrainingMode,topConfusion:o.length>0&&o[0].guessedSpecies?{from:o[0].expectedSpecies,to:o[0].guessedSpecies}:null}),l.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[l.jsx("span",{children:"Score"}),l.jsx("span",{className:"text-accent",style:{fontFamily:"var(--font-mono)",fontSize:"24px"},children:(r==null?void 0:r.score)||0})]}),l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[l.jsx("span",{children:"Birds Identified"}),l.jsxs("span",{children:[(r==null?void 0:r.eventsScored)||0," / ",(r==null?void 0:r.totalEvents)||0]})]}),l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[l.jsx("span",{children:"Overall Accuracy"}),l.jsxs("span",{className:_>=70?"text-success":_>=50?"text-accent":"text-error",children:[_,"%"]})]}),l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"12px"},children:[l.jsx("span",{children:"Perfect Hits"}),l.jsx("span",{className:"text-success",children:(r==null?void 0:r.perfectCount)||0})]}),l.jsxs("div",{className:"flex-row justify-between",children:[l.jsx("span",{children:"Best Streak"}),l.jsx("span",{children:(r==null?void 0:r.maxStreak)||0})]}),(r==null?void 0:r.usedTrainingMode)&&l.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid var(--color-surface)",fontSize:"13px",color:"var(--color-text-muted)",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"Training Mode was used"]})]}),i.length>0&&l.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Species Breakdown"}),i.map(L=>l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[l.jsxs("span",{style:{fontSize:"14px"},children:[L.code," ",l.jsxs("span",{className:"text-muted",children:["(",L.name,")"]})]}),l.jsxs("span",{style:{fontSize:"14px"},children:[L.correct,"/",L.total," (",L.accuracy,"%)"]})]}),l.jsx("div",{style:{height:"8px",backgroundColor:"var(--color-background)",borderRadius:"4px",overflow:"hidden"},children:l.jsx("div",{style:{width:`${L.accuracy}%`,height:"100%",backgroundColor:L.accuracy>=80?"var(--color-success)":L.accuracy>=50?"var(--color-accent)":"var(--color-error)",borderRadius:"4px",transition:"width 0.3s ease"}})})]},L.code))]}),o.length>0&&l.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"320px",margin:"0 auto 20px"},children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Confusion Summary"}),o.map((L,D)=>l.jsx("div",{style:{marginBottom:"8px",fontSize:"14px"},children:L.guessedSpecies===null?l.jsxs("span",{children:["Missed ",l.jsx("span",{className:"text-accent",children:L.expectedSpecies}),": ",L.count,"x"]}):l.jsxs("span",{children:[l.jsx("span",{className:"text-accent",children:L.expectedSpecies}),"  ",l.jsx("span",{className:"text-error",children:L.guessedSpecies}),": ",L.count,"x"]})},D))]}),l.jsxs("div",{style:{width:"100%",maxWidth:"320px",margin:"0 auto"},children:[y&&l.jsxs("div",{className:"flex-row gap-md",style:{marginBottom:"12px"},children:[l.jsxs("button",{className:"btn-secondary",onClick:()=>A(x-1),disabled:!w,style:{flex:1,opacity:w?1:.4},children:[l.jsx($M,{})," Prev"]}),l.jsxs("button",{className:"btn-secondary",onClick:()=>u(!c),style:{flex:1},children:["Level ",x,"/",Py]}),l.jsxs("button",{className:"btn-secondary",onClick:()=>A(x+1),disabled:!T,style:{flex:1,opacity:T?1:.4},children:["Next ",l.jsx(VM,{})]})]}),c&&l.jsxs("div",{className:"card",style:{marginBottom:"12px",padding:"12px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-muted)",marginBottom:"8px"},children:"Jump to level:"}),l.jsx("div",{className:"flex-row",style:{flexWrap:"wrap",gap:"8px"},children:[1,2,3,4,5,6].map(L=>l.jsx("button",{onClick:()=>{u(!1),A(L)},style:{width:"40px",height:"40px",borderRadius:"8px",border:L===x?"2px solid var(--color-accent)":"1px solid var(--color-text-muted)",background:L===x?"var(--color-accent)":"var(--color-surface)",color:L===x?"var(--color-background)":"var(--color-text)",fontWeight:600,cursor:"pointer"},children:L},L))})]}),l.jsxs("div",{className:"flex-col gap-md",children:[l.jsx("button",{className:"btn-primary",onClick:()=>A(x),style:{width:"100%"},children:"Play Again"}),l.jsxs("div",{className:"flex-row gap-md",children:[l.jsx("button",{className:"btn-secondary",onClick:C,style:{flex:1},children:"Levels"}),l.jsx("button",{className:"btn-secondary",onClick:b,style:{flex:1},children:"Packs"}),l.jsx("button",{className:"btn-secondary",onClick:I,style:{flex:1},children:"Home"})]})]})]})]})}function $M(){return l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"4px"},children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function VM(){return l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"4px"},children:l.jsx("path",{d:"M9 18l6-6-6-6"})})}function WM(){return l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"18",cy:"5",r:"3"}),l.jsx("circle",{cx:"6",cy:"12",r:"3"}),l.jsx("circle",{cx:"18",cy:"19",r:"3"}),l.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),l.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]})}const Cr={SCROLL_SPEED:"soundfield_scroll_speed",SPECTROGRAM_MODE:"soundfield_spectrogram_mode",HIGH_CONTRAST:"soundfield_high_contrast",CONTINUOUS_PLAY:"soundfield_continuous_play",COOKIE_CONSENT:"chipnotes_cookie_consent"};function XM(){const t=qt(),e=ti(),[r,n]=S.useState(()=>localStorage.getItem(Cr.SPECTROGRAM_MODE)||"full"),[i,s]=S.useState(()=>{const m=localStorage.getItem(Cr.SCROLL_SPEED);return m?parseFloat(m):.5}),[o,a]=S.useState(()=>localStorage.getItem(Cr.HIGH_CONTRAST)==="true"),[c,u]=S.useState(()=>localStorage.getItem(Cr.CONTINUOUS_PLAY)==="true"),[d,h]=S.useState(()=>localStorage.getItem(Cr.COOKIE_CONSENT)==="accepted");S.useEffect(()=>{localStorage.setItem(Cr.SPECTROGRAM_MODE,r)},[r]),S.useEffect(()=>{localStorage.setItem(Cr.SCROLL_SPEED,i.toString())},[i]),S.useEffect(()=>{localStorage.setItem(Cr.HIGH_CONTRAST,o.toString())},[o]),S.useEffect(()=>{localStorage.setItem(Cr.CONTINUOUS_PLAY,c.toString())},[c]);const f=m=>{h(m),localStorage.setItem(Cr.COOKIE_CONSENT,m?"accepted":"declined"),alert(m?"Analytics enabled. Please refresh the page for changes to take effect.":"Analytics disabled. Please refresh the page for changes to take effect.")},p=()=>{confirm("This will delete ALL your progress, settings, and custom packs. This cannot be undone. Are you sure?")&&(localStorage.clear(),"caches"in window&&caches.keys().then(v=>{v.forEach(_=>{caches.delete(_)})}),alert("All data has been deleted. The app will now reload."),window.location.href=window.location.origin+"/")};return l.jsxs("div",{className:"screen",children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[l.jsxs("button",{className:"btn-secondary",onClick:()=>{var m;return(m=e.state)!=null&&m.fromPackSelect?t("/pack-select"):t(-1)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 16px",background:"var(--color-accent)",color:"white",border:"none",fontWeight:600},children:[l.jsx(YM,{}),"Back"]}),l.jsx("h2",{style:{margin:0},children:"Settings"})]}),l.jsxs("div",{className:"flex-col gap-lg",children:[l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Spectrogram Mode"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:"Visual difficulty setting"}),l.jsx("div",{className:"flex-row gap-sm",children:["full","fading","none"].map(m=>l.jsx("button",{className:r===m?"btn-primary":"btn-secondary",onClick:()=>n(m),style:{flex:1,textTransform:"capitalize"},children:m},m))})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Scroll Speed"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",marginBottom:"12px"},children:["How fast tiles move: ",i.toFixed(1),"x"]}),l.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:i,onChange:m=>s(parseFloat(m.target.value)),style:{width:"100%"}})]}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex-row justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h3",{style:{marginBottom:"4px"},children:"High Contrast"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Enhanced visibility"})]}),l.jsx("button",{className:o?"btn-primary":"btn-secondary",onClick:()=>a(!o),style:{width:"60px"},children:o?"ON":"OFF"})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex-row justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h3",{style:{marginBottom:"4px"},children:"Continuous Play"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"No timer - play until all clips done"})]}),l.jsx("button",{className:c?"btn-primary":"btn-secondary",onClick:()=>u(!c),style:{width:"60px"},children:c?"ON":"OFF"})]})}),l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"flex-row justify-between items-center",style:{marginBottom:"8px"},children:[l.jsx("div",{children:l.jsx("h3",{style:{marginBottom:"0"},children:"Analytics"})}),l.jsx("button",{className:d?"btn-primary":"btn-secondary",onClick:()=>f(!d),style:{width:"60px"},children:d?"ON":"OFF"})]}),l.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"I know I'm a stranger, but please accept my cookies! Analytics help me understand how many players I have, which birds everyone loves, and what features are most useful. I promise I'm just adding bird nerds to my LIFE LIST, not stalking you. Your IP is anonymized, no personal data collected, full GDPR/CCPA compliance."})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"8px"},children:"Privacy Policy"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["Learn about how your privacy is protected, what data is collected, and your rights."," ",l.jsx("button",{onClick:()=>t("/privacy"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Privacy Policy "})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"8px"},children:"How to Play"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:["New to ChipNotes? Learn about gameplay, scoring, packs, and tips."," ",l.jsx("button",{onClick:()=>t("/help"),style:{background:"none",border:"none",color:"var(--color-accent)",fontSize:"13px",textDecoration:"underline",cursor:"pointer",padding:0},children:"View Help Guide "})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"8px"},children:"Feedback & Bug Reports"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["Found a bug? Have a feature idea? Email me at"," ",l.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:[l.jsx("span",{style:{color:"var(--color-text)"},children:"Have a bird sound on your phone that you think should be in the game?"})," Send it to me! I'll add it and give you credit in the app."]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"8px"},children:"Support This Project"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:["ChipNotes is free, open source, and built as a passion project. If it's helped you level-up your birding skills, consider"," ",l.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"supporting development"})," ","- your donations help me add new species, add features, and do more birding. Now, you go build something cool - it might be easier than you think! ;)"]}),l.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:"Please also consider supporting the organizations that make this possible, and tell them ChipNotes! sent you:"}),l.jsxs("ul",{style:{fontSize:"13px",lineHeight:"1.5",color:"var(--color-text-muted)",marginBottom:"12px"},children:[l.jsxs("li",{style:{marginBottom:"8px"},children:[l.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.birds.cornell.edu/home/support/"})," ","- Incredible bird sound archive"]}),l.jsxs("li",{children:[l.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://xeno-canto.org/about/donate"})," ","- Community-driven bird recording database"]})]}),l.jsx("div",{className:"text-muted",style:{fontSize:"13px",lineHeight:"1.5"},children:"Thank you for learning with me! "})]}),l.jsx("div",{className:"card",children:l.jsx("button",{className:"btn-secondary",onClick:p,style:{width:"100%",color:"var(--color-error)"},children:"Reset All Progress"})})]})]})}function YM(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}const gl=[{code:"NOCA",name:"Northern Cardinal",accuracy:92,attempts:45},{code:"BLJA",name:"Blue Jay",accuracy:88,attempts:38},{code:"CARW",name:"Carolina Wren",accuracy:76,attempts:29},{code:"AMCR",name:"American Crow",accuracy:95,attempts:22},{code:"TUTI",name:"Tufted Titmouse",accuracy:71,attempts:18}];function KM(){const t=qt(),e=Math.round(gl.reduce((r,n)=>r+n.accuracy,0)/gl.length);return l.jsxs("div",{className:"screen",children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"16px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:l.jsx(qM,{})}),l.jsx("h2",{style:{margin:0},children:"Progress"})]}),l.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"linear-gradient(135deg, rgba(245, 166, 35, 0.15) 0%, rgba(245, 166, 35, 0.05) 100%)",border:"2px solid var(--color-accent)",borderRadius:"12px",textAlign:"center"},children:[l.jsx("div",{style:{fontSize:"16px",fontWeight:700,color:"var(--color-accent)",marginBottom:"4px"},children:" Coming Soon! "}),l.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)",lineHeight:1.4},children:"Real stats tracking is in development. The data below is a preview of what's coming!"})]}),l.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)",marginBottom:"8px",textAlign:"center"},children:"Demo Data"}),l.jsxs("div",{className:"flex-row justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Overall Accuracy"}),l.jsxs("div",{style:{fontSize:"32px",fontWeight:700},className:"text-success",children:[e,"%"]})]}),l.jsxs("div",{style:{textAlign:"right"},children:[l.jsx("div",{className:"text-muted",style:{fontSize:"14px"},children:"Total Attempts"}),l.jsx("div",{style:{fontSize:"24px",fontWeight:600},children:gl.reduce((r,n)=>r+n.attempts,0)})]})]})]}),l.jsxs("div",{className:"card",style:{marginBottom:"24px",opacity:.7},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[l.jsx("h3",{style:{margin:0},children:"This Session"}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),l.jsxs("div",{className:"flex-row justify-between",style:{marginTop:"12px"},children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Rounds"}),l.jsx("div",{style:{fontSize:"20px"},children:"5"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Score"}),l.jsx("div",{style:{fontSize:"20px"},className:"text-accent",children:"12,450"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:"Best Streak"}),l.jsx("div",{style:{fontSize:"20px"},children:"18"})]})]})]}),l.jsxs("div",{className:"card",style:{opacity:.7},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[l.jsx("h3",{style:{margin:0},children:"Species Accuracy"}),l.jsx("div",{style:{fontSize:"11px",color:"var(--color-text-muted)"},children:"Demo Data"})]}),gl.map(r=>l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsxs("div",{className:"flex-row justify-between",style:{marginBottom:"4px"},children:[l.jsxs("span",{style:{fontSize:"14px"},children:[r.code," ",l.jsxs("span",{className:"text-muted",children:["(",r.attempts,")"]})]}),l.jsxs("span",{style:{fontSize:"14px"},className:r.accuracy>=80?"text-success":r.accuracy>=60?"text-accent":"text-error",children:[r.accuracy,"%"]})]}),l.jsx("div",{style:{height:"6px",backgroundColor:"var(--color-background)",borderRadius:"3px",overflow:"hidden"},children:l.jsx("div",{style:{width:`${r.accuracy}%`,height:"100%",backgroundColor:r.accuracy>=80?"var(--color-success)":r.accuracy>=60?"var(--color-accent)":"var(--color-error)",borderRadius:"3px"}})})]},r.code))]}),l.jsx("div",{className:"card",style:{marginTop:"24px",opacity:.7},children:l.jsx("button",{className:"btn-secondary",style:{width:"100%",cursor:"not-allowed"},disabled:!0,children:"View Confusion Matrix (Coming Soon)"})})]})}function qM(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function JM(){var v;const t=qt(),e=ti(),r=["Why Learn Bird Song?","The Basics","Scoring"];(v=e.state)!=null&&v.openVersionHistory&&r.push("Version History"),e.hash==="#training-mode"&&r.push("Training Mode");const[n,i]=S.useState(new Set(r)),[s,o]=S.useState(!1),a=S.useRef(null),c=S.useRef(null),u=S.useRef(!1),d=["Why Learn Bird Song?","The Basics","Scoring","The Packs","The Levels","Tips","Training Mode","Taxonomic Sorting","The 4-Letter Codes","The Spectrograms","About & Credits","Support This Project","Feedback & Bug Reports","Version History"],h=_=>{const y=new Set(n);y.has(_)?y.delete(_):y.add(_),i(y)},f=()=>{n.size===d.length?i(new Set):i(new Set(d))},p=n.size===d.length;S.useEffect(()=>{const _=()=>{!s&&a.current&&a.current.scrollTop>0&&o(!0)},y=a.current;if(y)return y.addEventListener("scroll",_),()=>y.removeEventListener("scroll",_)},[s]),S.useEffect(()=>{var _;(_=e.state)!=null&&_.openVersionHistory&&c.current&&setTimeout(()=>{var y;(y=c.current)==null||y.scrollIntoView({behavior:"smooth",block:"start"})},100)},[e.state]),S.useEffect(()=>{e.hash==="#training-mode"&&!u.current&&(u.current=!0,setTimeout(()=>{const _=document.getElementById("training-mode");_&&_.scrollIntoView({behavior:"smooth",block:"start"})},100))},[e.hash]);const m=()=>{var _;(_=a.current)==null||_.scrollTo({top:0,behavior:"smooth"})};return l.jsxs("div",{ref:a,className:"screen",style:{paddingBottom:"32px",position:"relative"},children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>{var _;return(_=e.state)!=null&&_.fromPackSelect?t("/pack-select"):t(-1)},"aria-label":"Back",children:l.jsx(QM,{})}),l.jsx("h2",{style:{margin:0},children:"How to Play"})]}),l.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[l.jsxs(Mt,{title:"Why Learn Bird Song?",isExpanded:n.has("Why Learn Bird Song?"),onToggle:()=>h("Why Learn Bird Song?"),children:[l.jsxs("p",{style:{marginBottom:"12px"},children:["Birds are ",l.jsx("em",{children:"heard"})," way more often than they're ",l.jsx("em",{children:"seen"}),". Once you know the songs, you'll know what to look for - and suddenly your backyard becomes way more interesting."]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{children:"Why the left/right thing?"}),` That's birding! You're constantly triangulating: "Cardinal to my left, chickadee to my right, warbler... somewhere up there?" Training your ears to separate simultaneous sounds - like a pianist controlling both hands - dramatically sharpens your field skills.`]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{children:"Neuroplasticity works:"})," Your brain rewires with practice. These sound patterns feel impossible at first, but repeated exposure trains your auditory cortex faster than you'd think. Give it a few sessions - you'll be amazed what you can hear."]}),l.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsx("strong",{children:"Need real-time ID?"})," Get Cornell's free ",l.jsx("a",{href:"https://merlin.allaboutbirds.org/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)"},children:"Merlin app"}),` - it's magic for "what bird is that singing `,l.jsx("em",{children:"right now"}),'?"']})]}),l.jsxs(Mt,{title:"The Basics",isExpanded:n.has("The Basics"),onToggle:()=>h("The Basics"),children:[l.jsx("p",{style:{marginBottom:"12px"},children:l.jsx("strong",{children:"Listen. Identify. Tap."})}),l.jsx("p",{style:{marginBottom:"12px"},children:"Bird sounds play through your left or right ear. Identify which bird is singing and tap its circle on the correct side before the tile passes the scoring zone."}),l.jsx("p",{style:{marginBottom:"12px"},children:"Each round is 30 seconds. Use headphones for the best experience - unless you want everyone to know you're a bird nerd!"}),l.jsxs("p",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsx("strong",{children:"Mobile tip:"}),' For fullscreen play on iOS, use Safari. On Android Chrome, tap   "Add to Home screen" and launch from the icon.']})]}),l.jsxs(Mt,{title:"Scoring",isExpanded:n.has("Scoring"),onToggle:()=>h("Scoring"),children:[l.jsx(xl,{label:"Perfect",points:100,description:"Right bird + right ear + great timing",color:"var(--color-success)"}),l.jsx(xl,{label:"Good",points:75,description:"Right bird + right ear",color:"var(--color-success)"}),l.jsx(xl,{label:"Partial",points:25,description:"Right bird, wrong ear",color:"var(--color-accent)"}),l.jsx(xl,{label:"Miss",points:0,description:"Wrong bird or no response",color:"var(--color-error)"})]}),l.jsxs(Mt,{title:"The Packs",isExpanded:n.has("The Packs"),onToggle:()=>h("The Packs"),children:[l.jsx(es,{name:"Eastern Backyard Birds",description:"Perfect for beginners. Six distinctive birds you'll hear in your own backyard: American Crow (AMCR), American Robin (AMRO), Blue Jay (BLJA), Carolina Wren (CARW), Northern Cardinal (NOCA), and Tufted Titmouse (TUTI)."}),l.jsx(es,{name:"Expanded Eastern US Birds",description:"46 species from the eastern US. Nine birds are selected randomly, and you can shuffle for a new set anytime from the preview screen."}),l.jsx(es,{name:"Sparrows",description:"Master the subtle singers! Eight sparrow species with distinctive patterns: White-throated, Song, Chipping, Swamp, Savannah, Field, Lincoln's, and White-crowned."}),l.jsx(es,{name:"Woodpeckers",description:"Drums, rattles, and calls. Learn seven species: Downy, Hairy, Red-bellied, Pileated, Yellow-bellied Sapsucker, Northern Flicker, and Red-headed."}),l.jsx(es,{name:"Western Backyard Birds",description:"14 common backyard species from western North America: Steller's Jay, Western Scrub-Jay, Black-capped Chickadee, White-crowned Sparrow, Cassin's Finch, Pine Siskin, Evening Grosbeak, and more."}),l.jsx(es,{name:"Warbler Academy",description:"For experts! 33 wood-warbler species with their high-pitched, buzzy songs. Nine warblers are selected randomly - shuffle for a new set anytime."}),l.jsxs("p",{style:{marginTop:"16px",fontSize:"13px",color:"var(--color-text-muted)",fontStyle:"italic"},children:["There are 11,000 birds out there, so more are coming soon. Send your suggestions to"," ",l.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"}),"!"]})]}),l.jsxs(Mt,{title:"The Levels",isExpanded:n.has("The Levels"),onToggle:()=>h("The Levels"),children:[l.jsx("p",{style:{marginBottom:"12px",color:"var(--color-text-muted)",fontSize:"14px"},children:"Each pack has 6 levels that build your skills:"}),l.jsx(ts,{level:1,title:"Meet the Birds",description:"One clear recording per bird, single ear. Learn each signature voice."}),l.jsx(ts,{level:2,title:"Sound Variations",description:"Up to 3 recordings per bird. Same species, different songs."}),l.jsx(ts,{level:3,title:"Full Repertoire",description:"All recordings in play. Master every variation."}),l.jsx(ts,{level:4,title:"Both Ears",description:"Sounds from either side. Identify the bird AND the direction."}),l.jsx(ts,{level:5,title:"Variations + Both Ears",description:"Multiple recordings, either ear. Getting challenging!"}),l.jsx(ts,{level:6,title:"Master Birder",description:"Everything at once. You're a pro now."})]}),l.jsxs(Mt,{title:"Tips",isExpanded:n.has("Tips"),onToggle:()=>h("Tips"),children:[l.jsx(rs,{children:"Start with the 6 common birds, even if you're eager for more."}),l.jsxs(rs,{children:["Use"," ",l.jsx(ua,{to:"/pack-select#bird-reference",state:{fromHelp:!0},style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Bird Reference"})," ","to preview all sounds included in the game."]}),l.jsx(rs,{children:"Your birds stay the same between rounds. Hit the shuffle button on the preview screen for a fresh set."}),l.jsx(rs,{children:"Don't rush. Let the sound register before you tap."}),l.jsx(rs,{children:"Check the round summary and confusion matrix to see which birds need practice."}),l.jsx(rs,{children:"Adjust tile speed in Settings if things move too fast (or too slow). Once you're an expert, try playing muted using only spectrograms!"})]}),l.jsxs(Mt,{id:"training-mode",title:"Training Mode",isExpanded:n.has("Training Mode"),onToggle:()=>h("Training Mode"),children:[l.jsx("p",{children:"Training Mode shows bird icons and species codes on each tile alongside the spectrogram - perfect for learning which sounds belong to which birds."}),l.jsxs("p",{children:["You can enable it on the preview screen before starting a round, or toggle it on/off anytime during gameplay using the ",l.jsx("strong",{children:"eye icon"})," (next to the back button). Start with labels visible, then toggle off to challenge yourself!"]}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(76, 175, 80, 0.3)",border:"2px solid rgba(76, 175, 80, 0.6)",borderRadius:"50%",color:"#81C784"},children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),l.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Eye icon glows green when Training Mode is ON"})]})]}),l.jsxs(Mt,{title:"Taxonomic Sorting",isExpanded:n.has("Taxonomic Sorting"),onToggle:()=>h("Taxonomic Sorting"),children:[l.jsx("p",{children:"Toggle taxonomic sorting on the preview screen to see birds in phylogenetic order with scientific names - perfect for learning evolutionary relationships! "}),l.jsxs("p",{style:{marginTop:"12px"},children:["When enabled, birds are sorted by their position on the evolutionary tree (using the 2025 eBird/AOS taxonomy) instead of alphabetically. Common names are replaced with ",l.jsx("em",{children:"scientific names in italics"}),"."]}),l.jsx("p",{style:{marginTop:"12px"},children:"This sorting also applies to the species buttons during gameplay, helping you build taxonomic muscle memory as you learn."}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"12px",fontSize:"14px",display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(100, 181, 246, 0.3)",border:"2px solid rgba(100, 181, 246, 0.6)",borderRadius:"50%",color:"#64B5F6"},children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),l.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),l.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),l.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})}),l.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Toggle glows blue when Taxonomic Sorting is ON"})]})]}),l.jsxs(Mt,{title:"The 4-Letter Codes",isExpanded:n.has("The 4-Letter Codes"),onToggle:()=>h("The 4-Letter Codes"),children:[l.jsx("p",{children:`Birders use standardized 4-letter codes (called "Alpha codes") as shorthand for species names. They're easy to learn:`}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"12px",borderRadius:"8px",marginTop:"8px",fontSize:"14px",lineHeight:1.6},children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Two-word names:"})," First 2 letters of each word"]}),l.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Northern Cardinal  NO + CA  NOCA"}),l.jsxs("div",{style:{marginTop:"8px"},children:[l.jsx("strong",{children:"Three-word names:"})," 1 + 1 + 2 letters"]}),l.jsx("div",{style:{color:"var(--color-text-muted)",marginLeft:"12px"},children:"Red-bellied Woodpecker  R + B + WO  RBWO"}),l.jsxs("div",{style:{marginTop:"12px",fontStyle:"italic",color:"var(--color-text-muted)"},children:["There ",l.jsx("a",{href:"https://www.birdpop.org/pages/birdSpeciesCodes.php",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"are exceptions"}),". Because, ornithology."]})]})]}),l.jsxs(Mt,{title:"The Spectrograms",isExpanded:n.has("The Spectrograms"),onToggle:()=>h("The Spectrograms"),children:[l.jsx("p",{children:"The colorful images on tiles are spectrograms - visual pictures of sound. Time flows left to right, pitch goes bottom to top, and brightness shows volume."}),l.jsx("p",{style:{color:"var(--color-text-muted)",fontSize:"14px"},children:"With practice, you'll recognize birds by their visual patterns too!"})]}),l.jsxs(Mt,{title:"About & Credits",isExpanded:n.has("About & Credits"),onToggle:()=>h("About & Credits"),children:[l.jsxs("div",{style:{textAlign:"center",marginBottom:"16px"},children:[l.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"   "}),l.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--color-text)",marginBottom:"4px"},children:"Created by Peter Repetti"}),l.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:"Made with love by bird nerds, for bird nerds"})]}),l.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:[l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"Bird sounds:"})," Sourced from"," ",l.jsx("a",{href:"https://xeno-canto.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Xeno-Canto"}),", the"," ",l.jsx("a",{href:"https://www.macaulaylibrary.org",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Cornell Macaulay Library"})," ","and from user contributions. All sound clips have attribution with XC catalog numbers and recordist names in the Bird Reference (expand any species on the"," ",l.jsx(ua,{to:"/pack-select#bird-reference",state:{fromHelp:!0},style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Pack Select"})," ","screen)."]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"The Tech:"})," Built by Claude Code with TypeScript, React, and PixiJS for buttery-smooth scrolling spectrograms. The Web Audio API handles sample-accurate playback with real-time stereo panning - your browser decodes and buffers audio into memory for zero-latency triggering. Vite bundles it all into a PWA (Progressive Web App) that caches sounds as you play them - so load up those birds before your flight to New Zealand takes off ."]}),l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:"Special thanks:"})," To the global birding community for sharing these recordings."]}),l.jsx("p",{style:{marginTop:"16px",fontSize:"13px",fontStyle:"italic"},children:"Good birding! "})]})]}),l.jsxs(Mt,{title:"Support This Project",isExpanded:n.has("Support This Project"),onToggle:()=>h("Support This Project"),children:[l.jsxs("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:["ChipNotes is free, open source, and built as a passion project. If it's helped you level-up your birding skills, consider"," ",l.jsx("a",{href:"https://ko-fi.com/chipnotes",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"supporting development"})," ","- your donations help me add new species, add features, and do more birding. Now, you go build something cool - it might be easier than you think! ;)"]}),l.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"8px",fontWeight:600},children:"Please also consider supporting the organizations that make this possible, and tell them ChipNotes! sent you:"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"var(--color-text-muted)",lineHeight:1.8},children:[l.jsxs("li",{children:[l.jsx("a",{href:"https://www.birds.cornell.edu/home/support/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://www.birds.cornell.edu/home/support/"})," ","- Incredible bird sound archive"]}),l.jsxs("li",{children:[l.jsx("a",{href:"https://xeno-canto.org/about/donate",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"https://xeno-canto.org/about/donate"})," ","- Community-driven bird recording database"]})]}),l.jsx("p",{style:{marginTop:"16px",fontSize:"14px",fontStyle:"italic",color:"var(--color-text-muted)"},children:"Thank you for learning with me! "})]}),l.jsxs(Mt,{title:"Feedback & Bug Reports",isExpanded:n.has("Feedback & Bug Reports"),onToggle:()=>h("Feedback & Bug Reports"),children:[l.jsx("p",{style:{color:"var(--color-text-muted)",lineHeight:1.6,marginBottom:"16px"},children:"I'd love to hear from you! Found a bug? Have a feature suggestion? Want to share your experience?"}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px",marginBottom:"12px"},children:[l.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" Email"}),l.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"feedback@chipnotes.app"})]}),l.jsxs("div",{style:{background:"var(--color-surface)",padding:"16px",borderRadius:"12px"},children:[l.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"var(--color-accent)"},children:" GitHub Issues"}),l.jsx("a",{href:"https://github.com/chrysogonum/bird-sound-game/issues",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-text)",textDecoration:"none",fontSize:"14px"},children:"github.com/chrysogonum/bird-sound-game/issues"})]})]}),l.jsx("div",{ref:c,children:l.jsxs(Mt,{title:"Version History",isExpanded:n.has("Version History"),onToggle:()=>h("Version History"),children:[l.jsxs("div",{className:"card",style:{marginBottom:"16px",background:"rgba(255, 152, 0, 0.08)",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[l.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"16px",color:"var(--color-accent)"},children:" Recent Highlights (v3.23  v3.43)"}),l.jsxs("div",{style:{fontSize:"14px",color:"var(--color-text-muted)",lineHeight:1.6},children:[l.jsx("strong",{style:{color:"var(--color-text)"},children:"Major additions:"}),l.jsxs("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Taxonomic Sorting"}),"  Find and play birds based on how they're related to each other"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Redesigned Ready-to-Play Screen"}),"  Easy access to Training Mode, taxonomic sorting, pack reference library (), and gameplay tips"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder"}),"  Improved search, taxonomic filtering, and ability to save up to 10 named custom packs"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Shareable Score Summary"}),"  Think you're as good as Merlin? Prove it and share your results!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Expanded Eastern Birds Pack"}),"  Grew from 40 to 45 species with flycatchers and vireos"]})]})]})]}),l.jsx(be,{version:"3.45",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Red-eyed Vireo Added:"})," Expanded Eastern Birds pack now includes 46 species with Red-eyed Vireo (5 new audio clips and spectrograms). One of the most common forest songbirds in eastern North America."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Add-Bird Workflow Improvements:"})," New automated pack count validation tool prevents UI species count mismatches. Script detects and auto-fixes hardcoded counts in PackSelect and Help screens with ",l.jsx("code",{children:"--fix"})," flag, integrated into add-bird workflow as Step 6c."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Attribution Bug Fix:"})," Fixed merge_candidates.py to generate clickable Xeno-canto source URLs for all new bird additions. Recordist names now appear as proper links in Bird Reference."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Data Consistency:"})," Synced species arrays in expanded_backyard pack definition for clearer data structure (species and display_species now both contain all 46 birds)."]})]})}),l.jsx(be,{version:"3.44",date:"January 21, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"Documentation Updates:"})," Updated Expanded Eastern Birds pack count from 40 to 45 in Help page, and clarified Training Mode can be enabled before or during gameplay."]})})}),l.jsx(be,{version:"3.43",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference Attribution Overhaul:"}),' Improved clip source attribution system with clear categorization (Xeno-canto, Cornell Macaulay, User-contributed). Compact display format shows "XC667361  Nick Komar" with clickable links to original Xeno-canto recordings. Recovered 363 lost recordist attributions and corrected 78 vocalization type errors from earlier data migration.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Source Transparency:"})," Every clip now clearly shows its origin - Xeno-canto (with catalog number link), Cornell CD track number, or user-contributed recordings. Enables proper attribution to recordists and easy access to original recordings for deeper learning."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Metadata Protection:"})," Enhanced git pre-commit hooks now protect recordist attributions and vocalization type classifications (song/call/drum) in addition to canonical flags, preventing future accidental data loss during bulk operations."]})]})}),l.jsx(be,{version:"3.42",date:"January 21, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"5 New Eastern Birds:"})," Expanded Eastern Birds pack from 40 to 45 species with White-eyed Vireo, Acadian Flycatcher, Eastern Phoebe, Great Crested Flycatcher, and Eastern Wood-Pewee (24 new audio clips and spectrograms)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data Integrity Safeguards:"})," Added comprehensive protection for canonical clip flags (Bird Reference signature indicators) including git pre-commit hooks, extensive documentation, and automated validation to prevent accidental data loss."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio Quality Improvements:"})," Trimmed dead space from multiple clips for cleaner, more focused bird vocalizations."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Count Corrections:"})," Updated Expanded Eastern Birds pack display to correctly show 45 species across all UI locations."]})]})}),l.jsx(be,{version:"3.41",date:"January 20, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Dark-eyed Junco added:"})," Expanded Eastern Birds pack now includes 40 species (previously 39) with Dark-eyed Junco clips and spectrograms."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Level rotation fix:"})," Fixed bug where newly added species appeared in pack definitions but not in gameplay rotation - Dark-eyed Junco now appears in all 6 levels."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Species count corrections:"})," Updated pack selection and help text to reflect accurate species counts."]})]})}),l.jsx(be,{version:"3.40",date:"January 20, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Editing:"}),' Load, edit, and update existing saved packs! When you load a pack and modify it, you can choose to update the original pack or save as a new one. Visual indicator shows "Editing: [Pack Name]" at the top of the builder.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Expansion:"}),' Increased max pack size from 9 to 30 birds! For packs with 10+ birds, the game randomly selects 9 for each round with a re-roll button to shuffle the selection. Perfect for creating comprehensive regional packs like "All Midwest Warblers" or "Backyard Regulars."']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack UX:"}),' Made entire bird card clickable (not just the icon) for easier selection, added 4-letter species codes below bird names in taxonomic sort mode, and improved button labels to show "Update / Save As New" when editing.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Spectrogram Fix:"})," Fixed missing spectrograms for species updated in 2025 AOS taxonomy (American Goldfinch, Cedar Waxwing, California Scrub-Jay, Savannah Sparrow) - all 415 clips now have working visual tiles."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Preview Screen UX:"})," Made Training Mode and Taxonomic Sort toggle boxes more visible with subtle background and borders in inactive state."]})]})}),l.jsx(be,{version:"3.39",date:"January 20, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Separated Controls:"})," Redesigned bird cards with distinct touch areas - play button () on left for audio preview, bird icon on right for add/remove. No more overlapping actions!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Saved Packs:"}),' Save up to 10 named custom packs (e.g., "My Backyard", "Lake Erie Migrants") with persistent localStorage storage. Saved packs appear in a collapsible section with load/delete buttons for easy management across sessions.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Pack Validation & Versioning:"})," Saved packs now auto-validate species codes on load - if birds are removed from the game due to taxonomy updates, you'll see a friendly warning and the pack auto-cleans invalid entries. Includes version field for future migrations and backward compatibility with legacy packs."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Mobile Touch Fix:"})," Fixed delete button not working on mobile devices - replaced native browser confirm() dialog (which was being blocked on touch) with custom modal dialog that works reliably across all devices and screen sizes."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Taxonomic Sorting:"})," Added taxonomic sort toggle ( Taxonomic ) to group birds by evolutionary relationships - perfect for adding related species like all woodpeckers, corvids, or comparing warbler genera. Displays scientific names in italic when active."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder: Smart Search:"}),' Search behavior now adapts - single match (e.g., "cardinal") auto-clears for next search; multiple matches (e.g., "warbler") keeps filter active so you can select multiple birds from the same group']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Page Navigation:"}),' Repositioned floating buttons for better UX - small " Back" button on bottom left, "Expand/Collapse All" and " Top" grouped on bottom right. All buttons now consistently styled and only appear after scrolling.']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Suggestions:"}),' Added note in Packs section: "There are 11,000 birds out there, so more are coming soon" with feedback email link']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Branding Consistency:"}),' Standardized "ChipNotes!" (with !) for logos/titles/first mentions, "ChipNotes" (no !) for prose and mid-sentence references']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Support Section Harmonized:"}),' Updated Help and Settings "Support This Project" sections with consistent messaging emphasizing open source nature and attribution to Cornell/Xeno-Canto']}),l.jsxs("li",{children:[l.jsx("strong",{children:"PWA Safe Area Fix:"})," Fixed content bleeding into iOS status bar on PreRoundPreview screen when installed as home screen app"]})]})}),l.jsx(be,{version:"3.38",date:"January 20, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Taxonomy Migration:"})," Updated all bird species codes to 2025 AOS/IBP taxonomy - migrated 5 codes (AMGOAGOL, CEWACEDW, SASPSAVS, WESJCASJ, EWPEEAWP) and fixed species names to match current ornithological standards"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data Audit System:"})," Added comprehensive species data validation tools to ensure 100% consistency between game data and the authoritative IBP-AOS-list25.csv taxonomy reference"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Bug Fix:"})," Fixed taxonomic sort toggle re-shuffling birds on preview screen - now correctly re-orders existing birds without selecting new random ones"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Preview Screen Redesign:"}),' Completely overhauled "Ready to Play" page for better space efficiency - compact header, side-by-side toggles, larger bird grid visibility, and new tip box explaining grid positions']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Training Mode Visual Update:"})," Training mode toggle now highlights in green (instead of orange) for better visual distinction from other controls"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Sort Button Clarity:"}),' Alphabetical sort now displays as "Sort" by default, switching to "Taxonomic " when phylogenetic ordering is active']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference Quick Access:"}),` Added  book icon button on preview screen that jumps directly to the pack's Bird Reference section with auto-expansion - includes "Ready to Play?" button for easy return`]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Page Navigation:"}),' Added paired navigation buttons in bottom-right corner: green " Top" for scroll-to-top and orange "Expand/Collapse All" for section management']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Preview Instructions:"}),' Updated preview text to "Tap to preview signature song. Press and hold to get a closer look!" for clearer user guidance']})]})}),l.jsx(be,{version:"3.37",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Help Documentation:"}),' Added dedicated "Taxonomic Sorting" section to Help page - explains phylogenetic ordering, scientific name display, and how the feature works during gameplay']}),l.jsxs("li",{children:[l.jsx("strong",{children:"README Update:"})," Fixed Eastern Backyard Birds species count (56, added Robin) and updated version number"]})]})}),l.jsx(be,{version:"3.36",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Taxonomic Sort Toggle:"})," Added taxonomic/alphabetical sort toggle to pre-round preview screen - when enabled, shows birds in phylogenetic order with scientific names (italicized) instead of common names "]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Button Sort Persistence:"})," Species buttons during gameplay now respect taxonomic sort preference, making it easier for taxonomically-inclined players to build muscle memory"]})]})}),l.jsx(be,{version:"3.35",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"2025 AOS Taxonomy:"})," Updated all 86 species to official 2025 American Ornithological Society (66th Supplement) taxonomic positions - fixes phylogenetic ordering across all families, especially warblers (Swainson's Warbler now correctly appears before Setophaga radiation)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Scientific Names Fix:"})," Corrected numerous errors in displayed scientific names - WEWA now shows ",l.jsx("em",{children:"Helmitheros vermivorum"})," (not ",l.jsx("em",{children:"Setophaga pensylvanica"}),"!), plus 13+ other species fixed to match 2025 AOS data"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Species Data File:"})," Added comprehensive species.json with common names, scientific names, genus, species epithet, and taxonomic order for all birds - auto-generated from authoritative IBP-AOS-list25.csv"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder Icons:"})," Replaced generic circles with cute illustrated bird icon images - makes custom pack building more visual and fun!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data Source:"})," All taxonomy from The Institute for Bird Populations' official 2025 AOS list (2352 taxa) - scientifically accurate and up-to-date"]})]})}),l.jsx(be,{version:"3.34",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Scientific Names:"})," Bird Reference now shows scientific names (italicized) below common names when sorted taxonomically - perfect for learning phylogenetic relationships!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Select UX:"}),' Enhanced grasshopper sparrow joke to read "6 levels/packstart @ #1,  sparrow" - more punchy and visual']}),l.jsxs("li",{children:[l.jsx("strong",{children:"OCWA Clips:"})," Added 7 new Orange-crowned Warbler clips from Xeno-Canto (6 songs, 1 call) - all quality A recordings for expanded species coverage"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio Quality:"})," Trimmed OCWA_985696 to remove interfering bird vocalization at beginning - now shows clean warbler song only"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data Fixes:"})," Removed duplicate OCWA_1046368 entry in clips database, set OCWA_976251 as canonical clip, removed low-quality SASP_1060896 clip"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Home Page:"})," Tightened spacing between title and tagline for better visual balance"]})]})}),l.jsx(be,{version:"3.33",date:"January 19, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Taxonomic Sort:"})," Bird Reference now supports eBird/Clements 2025 taxonomic order - toggle between alphabetical and phylogenetic sorting with a fun easter egg for the science nerds"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Species Fixes:"})," Corrected Carolina Wren code from CAWR to CARW, and Barred Owl from BADO to BAOW - now matches eBird standard across all packs and data files"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"American Robin:"})," Added AMRO to starter pack (now 6 birds) - merged PR #4 with Cornell/Macaulay Library attribution"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Naming:"}),' Simplified "Common Eastern US Backyard Birds" to just "Eastern Backyard Birds" everywhere']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Page Polish:"}),' Alphabetized bird list in pack descriptions, added "There are exceptions. Because, ornithology." note to 4-letter codes section']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help Navigation Fix:"})," Fixed unwanted auto-scroll when expanding sections after navigating from Pack Select with hash links"]})]})}),l.jsx(be,{version:"3.32",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Select UX:"})," Simplified intro bullets with direct links to Help (Training Mode section) and Settings - reduced text, added helpful navigation"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Back Button Enhancement:"}),' Made back buttons more prominent on Help and Settings pages (orange color, "Back" text instead of just icon) for better PWA navigation visibility']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Settings Copy:"})," Updated Support section with friendlier wording"]})]})}),l.jsx(be,{version:"3.31",date:"January 18, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference Link:"}),' Made "Bird Reference" in Tips section clickable - now all references to Pack Select have proper back navigation in PWA mode!']})})}),l.jsx(be,{version:"3.30",date:"January 18, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"PWA Navigation Fix:"}),` Added "Back to Help" button on Bird Reference screen when navigated from Help page's About & Credits section - complete PWA navigation coverage!`]})})}),l.jsx(be,{version:"3.29",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"PWA Navigation Enhancement:"}),' Added "Back to Level Select" button on Bird Reference screen when navigated from Level Select - no more getting stuck in PWA mode!']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Rejection tracking system:"})," Clips rejected during review are now logged to prevent re-downloading - no more duplicate review efforts!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Yellow-rumped Warbler (YRWA) quality improvements:"})," Curated down to 2 high-quality clips (from 14 candidates) - improved from Q3 to Q4 with better song/call diversity"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Cedar Waxwing (CEWA) audit:"})," Reviewed and optimized clip selection for better quality and vocalization diversity"]})]})}),l.jsx(be,{version:"3.28",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference Navigation:"}),` Added contextual "Bird Reference" link from Level Select screen that jumps directly to the selected pack's bird list - easily review sounds before starting a level`]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Improved Xeno-canto Attribution:"}),' Now displays XC catalog numbers (e.g., "XC1015145 - David A. Brinkman") for proper credit and licensing compliance']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Deep Linking:"})," Navigate directly to Bird Reference section from Help page with smooth scrolling"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pack Auto-Expansion:"})," When navigating from Level Select, the relevant pack automatically expands in Bird Reference"]})]})}),l.jsx(be,{version:"3.27",date:"January 18, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"Share Card UX:"}),' Improved share instructions with upward arrow emoji and clearer text "Press and hold the image above" to prevent confusion']})})}),l.jsx(be,{version:"3.26",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"PWA Home Screen Fix:"})," Fixed 404 error when adding ChipNotes to iPhone home screen - start_url now correctly points to root path"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Manifest Update:"}),' Updated PWA description to match new tagline "Train your ear. Know the birds."']})]})}),l.jsx(be,{version:"3.25",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Home Screen Refresh:"}),' New tagline "Train your ear. Know the birds." emphasizes the educational journey and real-world birding payoff']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Enhanced Visual Flow:"}),' Added 3-step "Hear  Match  Train" diagram with brain icon to clearly show the learning process']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Cleaner Layout:"})," Redesigned home screen with tighter spacing and more intuitive visual hierarchy"]})]})}),l.jsx(be,{version:"3.24",date:"January 18, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Share Card Polish:"})," Refined share card design with circular bird icons and owl mascot, cleaner font hierarchy (removed monospace, reduced bold usage), and improved spacing for better visual balance"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Icon Improvements:"})," Bird icons and owl now display as perfect circles with proper aspect ratio scaling - no more white backgrounds or distortion"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Layout Refinement:"})," Moved Best Streak above bird icons, tightened spacing between pack/level and bird codes, centered text better in available space"]})]})}),l.jsx(be,{version:"3.23",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Share Score Card:"})," New shareable score card feature - download or share your round results with fun bird icons, stats, and confusion matrix highlights"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Domain:"})," ChipNotes now available at ",l.jsx("a",{href:"https://chipnotes.app",style:{color:"var(--color-accent)"},children:"chipnotes.app"})," - easier to remember and share!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Training Mode indicator:"})," Share cards now show when Training Mode was used during the round"]})]})}),l.jsx(be,{version:"3.22",date:"January 17, 2026",children:l.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:l.jsxs("li",{children:[l.jsx("strong",{children:"Version chronology fix:"})," Moved v3.02 and v3.03 to correct position in version history (after v3.13, before v2.0) - no more time-traveling versions!"]})})}),l.jsx(be,{version:"3.21",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"All Birds pack race condition fix:"})," Fixed state management bug where pack JSON loading overwrote the All Birds pack, causing it to disappear - now merges state correctly to preserve all packs"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Clickable version number:"})," Main menu version now links to Version History - auto-expands and scrolls to changelog"]})]})}),l.jsx(be,{version:"3.20",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Service worker cache fix:"}),' Fixed "Twilight Zone" bug where All Birds pack appeared on first load but disappeared after refresh - hashed JS bundles no longer cached, ensuring fresh code always loads']}),l.jsxs("li",{children:[l.jsx("strong",{children:"PWA stability:"})," Installed PWAs now properly update to show latest changes without requiring reinstall"]})]})}),l.jsx(be,{version:"3.19",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Version numbering fix:"})," Renamed v3.4 to v3.19 to maintain sequential ordering - fixes Apple-style confusion where 3.4 appeared after 3.18"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help page UX:"})," Collapsible sections with floating Expand All button - less scrolling, more scanning"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"All Birds reference:"})," Fixed missing bird icons in Bird Reference pack"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Navigation improvements:"})," Added Back button at bottom of Help page, Help link in Settings for easy cross-navigation"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Support link:"})," Ko-fi donation link added to Settings - buy me a coffee if ChipNotes helps you ID more birds"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Tech description restored:"})," Brought back the detailed tech paragraph about TypeScript, React, PixiJS, and PWA offline caching"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Privacy language:"}),' Updated Settings privacy text to be more neutral and less "we"-focused, "not stalking you" instead of "them"']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Credits update:"})," Added Cornell Macaulay Library, user contributions, and Bird Reference attribution"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Project timeline:"})," Documented creation timeline (Jan 8-11, 2026) and Claude Code collaboration"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Voice consistency:"}),' Changed "we" to "I" in Feedback section']})]})}),l.jsx(be,{version:"3.18",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"UI polish:"})," Streamlined pack selection, tightened layout, less visual clutter"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Custom Pack Builder:"}),' Sticky "Start" button stays visible with iOS keyboard, auto-focus for rapid bird entry, added preview tip']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help page:"})," Reorganized sections, added creator attribution"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Privacy page:"})," Full privacy policy accessible from Settings"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Analytics fix:"})," Fixed gtag initialization pattern - tracking now works correctly"]})]})}),l.jsx(be,{version:"3.17",date:"January 16, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Cookie consent:"})," I know I'm a stranger, but please accept my cookies! It really helps me document how many players I have and which birds everyone loves. (GDPR-compliant banner now appears on first visit)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Privacy controls:"}),' Changed your mind? New "Analytics Cookies" toggle in Settings lets you opt in/out anytime']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Your data is safe:"})," IP anonymization enabled, secure cookie flags set, full GDPR/CCPA compliance - I promise I'm just adding bird nerds to my LIFE LIST, not stalking you"]})]})}),l.jsx(be,{version:"3.16",date:"January 16, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference enhancement:"})," Separated display species (40) from gameplay rotation (28) for Expanded Eastern US Birds pack - Bird Reference now shows all available species for preview"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"UI improvements:"})," Streamlined pack selection tips, improved Help page tips with confusion matrix mention"]})]})}),l.jsx(be,{version:"3.15",date:"January 16, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Xeno-canto attribution:"})," All Xeno-canto recordings now display recordist names for legal compliance (355 recordings attributed to 87+ contributors)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Help page enhancements:"}),' Added "Why Learn Bird Song?" section explaining the educational value of left/right audio training, tech details about PWA offline caching']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio curation:"})," Extensive clip review and quality improvements - refined canonical clips, updated vocalization types (call/song/drum), removed low-quality recordings"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"UI improvements:"}),' Moved shuffle button above bird grid for better visibility, added "Coming Soon" banner to Stats screen to clarify demo data']}),l.jsxs("li",{children:[l.jsx("strong",{children:"New bird icons:"})," Added icons for upcoming Macaulay species (ACFL, EAPH, EWPE, WEVI)"]})]})}),l.jsx(be,{version:"3.14",date:"January 15, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Analytics:"})," Added Google Analytics 4 tracking for usage insights (page views, pack/level selections, Training Mode adoption)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data fixes:"})," Restored BCCH, MODO, and WBNU clips lost during Cornell CD processing"]})]})}),l.jsx(be,{version:"3.13",date:"January 15, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Western Backyard Birds pack:"})," 14 new species including Steller's Jay, Western Scrub-Jay, Black-capped Chickadee, and more. Fixed to use 9 random birds per round."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Audio improvements:"})," Restored canonical clips for 71+ species, resolved 202 broken audio references, cleaned up duplicate EATO clips (115)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"UI refinements:"})," Black backgrounds on Training Mode labels for better readability, Warbler Academy icon updated to Blackburnian Warbler, improved loading indicators"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Bird Reference enhancements:"})," Collapsible packs with expand/collapse controls, source badges (Xeno-canto, Cornell, contributors), pack cards with representative bird icons"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Fixed blank spectrograms"})," (async texture loading), added pull-to-refresh on main menu, audio preloading on preview screen"]}),l.jsx("li",{children:"Added White-crowned Sparrow to Sparrows pack (now 8 species)"})]})}),l.jsx(be,{version:"3.03",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Quit button:"})," Added X button during gameplay to quit rounds early with confirmation"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Support section:"})," Added Ko-fi donation link and encouragement to support Cornell Macaulay Library and Xeno-Canto"]})]})}),l.jsx(be,{version:"3.02",date:"January 17, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Mobile navigation fix:"})," Bottom menu icons now properly visible on both Safari and Chrome mobile browsers"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Fullscreen tip:"})," Added browser guidance for best mobile experience"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"PWA improvements:"})," Enhanced Apple mobile web app support"]})]})}),l.jsx(be,{version:"2.0",date:"January 12, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsx("li",{children:"Rebranded to ChipNotes! with Owl Professor mascot"}),l.jsx("li",{children:"Training Mode: Toggle eye icon to show bird labels on tiles"}),l.jsx("li",{children:"Warbler Academy pack: 33 wood-warbler species for experts"}),l.jsx("li",{children:"Complete icon set: Hand-illustrated icons for all 91+ species"}),l.jsx("li",{children:"Added Eastern Towhee to Expanded Backyard pack"}),l.jsx("li",{children:"Birds now persist between rounds by default"}),l.jsx("li",{children:"Fixed scoring to allow full 100 points as documented"}),l.jsx("li",{children:"iOS audio improvements and playback fixes"})]})}),l.jsx(be,{version:"1.0",date:"January 11, 2026",children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px",color:"var(--color-text-muted)"},children:[l.jsx("li",{children:"Initial release with 6 bird packs"}),l.jsx("li",{children:"Pre-round preview screen to hear and see birds before playing"}),l.jsx("li",{children:"Custom pack builder for targeted practice"}),l.jsx("li",{children:"Continuous play mode (untimed, relaxed practice)"}),l.jsx("li",{children:"Enhanced round summary with per-species breakdown"}),l.jsx("li",{children:"Progressive difficulty: 6 levels per pack"}),l.jsx("li",{children:"Real spectrograms for visual learning"}),l.jsx("li",{children:"PWA support for offline play and mobile installation"})]})})]})})]}),s&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>{var _;return(_=e.state)!=null&&_.fromPackSelect?t("/pack-select"):t(-1)},style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",left:"24px",padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px",zIndex:1e3},onMouseEnter:_=>{_.currentTarget.style.transform="scale(1.05)",_.currentTarget.style.background="rgba(255, 152, 0, 0.25)",_.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:_=>{_.currentTarget.style.transform="scale(1)",_.currentTarget.style.background="rgba(255, 152, 0, 0.15)",_.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},"aria-label":"Back",children:[l.jsx("span",{style:{fontSize:"12px"},children:""}),"Back"]}),l.jsxs("div",{style:{position:"fixed",bottom:"calc(24px + var(--safe-area-bottom, 0px))",right:"24px",display:"flex",gap:"8px",zIndex:1e3},children:[l.jsxs("button",{onClick:f,style:{padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(255, 152, 0, 0.15)",color:"var(--color-accent)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:_=>{_.currentTarget.style.transform="scale(1.05)",_.currentTarget.style.background="rgba(255, 152, 0, 0.25)",_.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:_=>{_.currentTarget.style.transform="scale(1)",_.currentTarget.style.background="rgba(255, 152, 0, 0.15)",_.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},children:[l.jsx("span",{style:{fontSize:"12px"},children:p?"":""}),p?"Collapse All":"Expand All"]}),l.jsxs("button",{onClick:m,style:{padding:"6px 10px",fontSize:"11px",fontWeight:600,background:"rgba(76, 175, 80, 0.15)",color:"var(--color-success)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:_=>{_.currentTarget.style.transform="scale(1.05)",_.currentTarget.style.background="rgba(76, 175, 80, 0.25)",_.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)"},onMouseLeave:_=>{_.currentTarget.style.transform="scale(1)",_.currentTarget.style.background="rgba(76, 175, 80, 0.15)",_.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},"aria-label":"Scroll to top",children:[l.jsx("span",{style:{fontSize:"12px"},children:""}),"Top"]})]})]})]})}function Mt({id:t,title:e,children:r,isExpanded:n,onToggle:i}){return l.jsxs("div",{id:t,style:{marginBottom:"16px",scrollMarginTop:"20px"},children:[l.jsxs("h3",{onClick:i,style:{fontSize:"16px",fontWeight:600,marginBottom:n?"12px":"0",color:"var(--color-accent)",borderBottom:"1px solid var(--color-surface)",paddingBottom:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"color 0.2s",userSelect:"none"},onMouseEnter:s=>s.currentTarget.style.color="#FFA726",onMouseLeave:s=>s.currentTarget.style.color="var(--color-accent)",children:[l.jsx("span",{style:{fontSize:"14px",width:"14px",textAlign:"center",flexShrink:0},children:n?"":""}),e]}),n&&l.jsx("div",{style:{fontSize:"15px",lineHeight:1.6,color:"var(--color-text)"},children:r})]})}function xl({label:t,points:e,description:r,color:n}){return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[l.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:n,minWidth:"40px"},children:["+",e]}),l.jsxs("div",{children:[l.jsx("span",{style:{fontWeight:600},children:t}),l.jsx("span",{style:{color:"var(--color-text-muted)",marginLeft:"8px",fontSize:"13px"},children:r})]})]})}function es({name:t,description:e}){return l.jsxs("div",{style:{marginBottom:"12px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px"},children:[l.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:t}),l.jsx("div",{style:{fontSize:"14px",color:"var(--color-text-muted)"},children:e})]})}function ts({level:t,title:e,description:r}){return l.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"8px",padding:"8px 12px",background:"var(--color-surface)",borderRadius:"8px"},children:[l.jsx("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,color:"var(--color-accent)",minWidth:"24px"},children:t}),l.jsxs("div",{children:[l.jsx("span",{style:{fontWeight:600},children:e}),l.jsx("div",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:r})]})]})}function rs({children:t}){return l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px"},children:[l.jsx("span",{style:{color:"var(--color-accent)"},children:""}),l.jsx("span",{children:t})]})}function be({version:t,date:e,children:r}){return l.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"var(--color-surface)",borderRadius:"8px",borderLeft:"3px solid var(--color-accent)"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"8px",marginBottom:"8px"},children:[l.jsxs("span",{style:{fontWeight:700,fontSize:"16px",color:"var(--color-accent)"},children:["v",t]}),l.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-muted)"},children:e})]}),r]})}function QM(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}function ZM(){const t=qt();return l.jsxs("div",{className:"screen",children:[l.jsxs("div",{className:"flex-row items-center gap-md",style:{marginBottom:"24px"},children:[l.jsx("button",{className:"btn-icon",onClick:()=>t(-1),"aria-label":"Back",children:l.jsx(ej,{})}),l.jsx("h2",{style:{margin:0},children:"Privacy Policy"})]}),l.jsxs("div",{className:"flex-col gap-lg",style:{maxWidth:"800px"},children:[l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsxs("p",{style:{marginBottom:"12px"},children:[l.jsx("strong",{children:"Last Updated:"})," January 20, 2026"]}),l.jsx("p",{style:{marginBottom:"12px"},children:"ChipNotes! is committed to protecting your privacy. This policy explains what data is collected, how it is used, and your rights."})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Data Collection"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Local Data (Always Stored on Your Device):"})}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsx("li",{children:"Game settings (scroll speed, spectrogram mode, high contrast, continuous play)"}),l.jsx("li",{children:"Custom pack selections (bird species you choose) and saved custom packs (pack names you create, up to 10 packs)"}),l.jsx("li",{children:"Round results and scores (not linked to your identity)"}),l.jsx("li",{children:"Cookie consent preference"})]}),l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Analytics Data (Only if You Consent):"})}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsx("li",{children:"Anonymized usage data via Google Analytics (IP addresses are anonymized)"}),l.jsx("li",{children:"Which features are used and which birds are practiced"}),l.jsx("li",{children:"App performance metrics"})]}),l.jsxs("p",{style:{fontSize:"13px",color:"var(--color-accent)"},children:[l.jsx("strong",{children:"Not collected:"})," Names, email addresses, phone numbers, precise location, or any personally identifiable information. Your game data stays on your device."]})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"How Your Data Is Used"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:l.jsxs("ul",{style:{marginLeft:"20px"},children:[l.jsx("li",{children:"Local data: Saves your preferences and tracks your progress"}),l.jsx("li",{children:"Analytics data: Used to understand how many players use ChipNotes, which features are popular, and how to improve the app"}),l.jsx("li",{children:"Your data is never sold, rented, or shared with third parties (except Google Analytics if you consent)"})]})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Third-Party Services"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsxs("p",{style:{marginBottom:"8px"},children:[l.jsx("strong",{children:"Google Analytics"})," (only if you consent)"]}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsx("li",{children:"Used to collect anonymized usage statistics"}),l.jsx("li",{children:"IP anonymization enabled"}),l.jsx("li",{children:"No ad personalization or cross-device tracking"}),l.jsxs("li",{children:["Learn more: ",l.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Google Privacy Policy"})]})]}),l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Xeno-Canto Audio"})}),l.jsxs("ul",{style:{marginLeft:"20px"},children:[l.jsx("li",{children:"Bird sound recordings are sourced from Xeno-Canto and cached locally on your device"}),l.jsx("li",{children:"No data is sent to Xeno-Canto when you play sounds offline"})]})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Your Rights"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:"You have the right to:"}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Access your data:"})," All local data is stored in your browser's localStorage (visible in browser dev tools)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Delete your data:"}),' Delete individual saved custom packs using the Delete button in Custom Pack Builder, or use the "Reset All Progress" button in Settings to delete all local data and cache']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Withdraw consent:"}),' Toggle "Analytics" in Settings to disable Google Analytics at any time']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Data portability:"})," Local data can be exported via browser dev tools (localStorage)"]})]}),l.jsx("p",{style:{fontSize:"13px"},children:"Since all game data is stored locally on your device, you have full control. Uninstalling the app or clearing browser data will permanently delete all your data."})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Cookies & Local Storage"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Essential (Always Active):"})}),l.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"12px"},children:[l.jsxs("li",{children:[l.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"chipnotes_cookie_consent"})," - Stores your cookie consent choice"]}),l.jsxs("li",{children:[l.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"soundfield_*"})," - Game settings and progress (all stored in localStorage)"]})]}),l.jsx("p",{style:{marginBottom:"8px"},children:l.jsx("strong",{children:"Analytics (Only if You Consent):"})}),l.jsx("ul",{style:{marginLeft:"20px"},children:l.jsxs("li",{children:[l.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga"}),", ",l.jsx("code",{style:{background:"var(--color-surface)",padding:"2px 6px",borderRadius:"4px"},children:"_ga_*"})," - Google Analytics cookies (2-year expiration)"]})})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Data Security"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:l.jsxs("ul",{style:{marginLeft:"20px"},children:[l.jsx("li",{children:"All data is stored locally on your device (no cloud servers)"}),l.jsx("li",{children:"HTTPS encryption for all web traffic"}),l.jsx("li",{children:"No user accounts or authentication (no password risks)"}),l.jsx("li",{children:"Service Worker caches audio files for offline use (stored locally)"})]})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Children's Privacy"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:l.jsx("p",{children:"ChipNotes does not knowingly collect data from children under 13. The app does not require any personal information, and analytics are opt-in. Parents can disable analytics in Settings."})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"International Users"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:"ChipNotes complies with:"}),l.jsxs("ul",{style:{marginLeft:"20px"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"GDPR"})," (European Union) - Right to access, deletion, and data portability"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"CCPA"})," (California) - Right to know and delete personal information"]}),l.jsx("li",{children:"Since no personal information is collected, compliance is straightforward"})]})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Changes to This Policy"}),l.jsx("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:l.jsx("p",{children:'This Privacy Policy may be updated from time to time. Changes will be posted on this page with an updated "Last Updated" date. Continued use of the app after changes constitutes acceptance of the updated policy.'})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{style:{marginBottom:"12px"},children:"Contact Us"}),l.jsxs("div",{className:"text-muted",style:{fontSize:"14px",lineHeight:1.6},children:[l.jsx("p",{style:{marginBottom:"8px"},children:"Questions about this Privacy Policy or your data?"}),l.jsxs("p",{children:["Email:"," ",l.jsx("a",{href:"mailto:feedback@chipnotes.app",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"feedback@chipnotes.app"})]})]})]})]})]})}function ej(){return l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M15 18l-6-6 6-6"})})}const Ud="chipnotes_cookie_consent";function Ry(){if(typeof window>"u")return;if(window.gtag){console.log("Google Analytics already loaded");return}window.dataLayer=window.dataLayer||[],window.gtag=function(){var e;(e=window.dataLayer)==null||e.push(arguments)},window.gtag("js",new Date),window.gtag("config","G-MJXQZYWWZ0",{anonymize_ip:!0,cookie_flags:"SameSite=Lax;Secure",cookie_expires:63072e3,allow_ad_personalization_signals:!1,allow_google_signals:!1});const t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-MJXQZYWWZ0",document.head.appendChild(t),console.log("Google Analytics loading with user consent")}function tj(){const[t,e]=S.useState(!1);S.useEffect(()=>{const i=localStorage.getItem(Ud);i==="accepted"?Ry():i===null&&e(!0)},[]);const r=()=>{localStorage.setItem(Ud,"accepted"),e(!1),Ry(),setTimeout(()=>{window.location.reload()},100)},n=()=>{localStorage.setItem(Ud,"declined"),e(!1),setTimeout(()=>{window.location.reload()},100)};return t?l.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"rgba(26, 26, 46, 0.98)",backdropFilter:"blur(10px)",borderTop:"1px solid var(--color-primary)",padding:"16px",paddingBottom:"calc(16px + var(--safe-area-bottom, 0px))",zIndex:1e4,boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.3)"},children:l.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"12px"},children:[l.jsxs("div",{style:{fontSize:"14px",lineHeight:1.5,color:"var(--color-text)"},children:[l.jsx("strong",{style:{color:"var(--color-accent)"},children:" Cookies & Privacy"}),l.jsxs("p",{style:{margin:"8px 0 0 0",color:"var(--color-text-muted)"},children:["We use Google Analytics to understand how people use ChipNotes and improve the app. This helps us know which features are useful and which birds people practice most. We anonymize your IP address and don't collect personal information."," ",l.jsx("a",{href:"/bird-sound-game/privacy",style:{color:"var(--color-accent)",textDecoration:"underline"},children:"Learn more"})]})]}),l.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[l.jsx("button",{onClick:r,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="#3a7332"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-primary)"},children:"Accept Analytics"}),l.jsx("button",{onClick:n,style:{flex:"1 1 auto",minWidth:"120px",padding:"12px 24px",fontSize:"14px",fontWeight:600,background:"var(--color-surface)",color:"var(--color-text)",border:"1px solid var(--color-text-muted)",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="var(--color-background)"},onMouseLeave:i=>{i.currentTarget.style.background="var(--color-surface)"},children:"Decline"})]})]})}):null}function rj(){return l.jsxs(l.Fragment,{children:[l.jsxs(bE,{children:[l.jsx(Jt,{path:"/",element:l.jsx(NE,{})}),l.jsx(Jt,{path:"/pack-select",element:l.jsx(YE,{})}),l.jsx(Jt,{path:"/level-select",element:l.jsx(nT,{})}),l.jsx(Jt,{path:"/preview",element:l.jsx(dT,{})}),l.jsx(Jt,{path:"/custom-pack",element:l.jsx(mT,{})}),l.jsx(Jt,{path:"/gameplay",element:l.jsx(zM,{})}),l.jsx(Jt,{path:"/summary",element:l.jsx(HM,{})}),l.jsx(Jt,{path:"/settings",element:l.jsx(XM,{})}),l.jsx(Jt,{path:"/progress",element:l.jsx(KM,{})}),l.jsx(Jt,{path:"/help",element:l.jsx(JM,{})}),l.jsx(Jt,{path:"/privacy",element:l.jsx(ZM,{})})]}),l.jsx(tj,{})]})}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{for(const e of t)e.unregister()});zd.createRoot(document.getElementById("root")).render(l.jsx(zy.StrictMode,{children:l.jsx(IE,{basename:"/",children:l.jsx(rj,{})})}));
