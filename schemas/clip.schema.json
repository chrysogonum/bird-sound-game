{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Clip",
  "description": "Schema for bird audio clip metadata",
  "type": "array",
  "items": {
    "type": "object",
    "required": [
      "clip_id",
      "species_code",
      "common_name",
      "vocalization_type",
      "duration_ms",
      "quality_score",
      "source",
      "source_id",
      "file_path"
    ],
    "properties": {
      "clip_id": {
        "type": "string",
        "description": "Unique identifier for the clip"
      },
      "species_code": {
        "type": "string",
        "pattern": "^[A-Z]{4}$",
        "description": "4-letter species code"
      },
      "common_name": {
        "type": "string",
        "description": "Common name of the bird species"
      },
      "vocalization_type": {
        "type": "string",
        "enum": ["song", "call"],
        "description": "Type of vocalization"
      },
      "duration_ms": {
        "type": "number",
        "minimum": 500,
        "maximum": 3000,
        "description": "Duration in milliseconds (500-3000)"
      },
      "quality_score": {
        "type": "number",
        "minimum": 1,
        "maximum": 5,
        "description": "Quality score (1-5)"
      },
      "source": {
        "type": "string",
        "enum": ["macaulay", "xenocanto", "cornell", "demo", "user_recording"],
        "description": "Audio source"
      },
      "source_id": {
        "type": "string",
        "description": "ID from the source database"
      },
      "file_path": {
        "type": "string",
        "description": "Path to the audio file"
      },
      "spectrogram_path": {
        "type": ["string", "null"],
        "description": "Path to the spectrogram image"
      },
      "recordist": {
        "type": ["string", "null"],
        "description": "Name of the person who recorded the audio (required for Xeno-canto attribution)"
      },
      "canonical": {
        "type": "boolean",
        "description": "Whether this is a canonical/signature clip for the species"
      },
      "rejected": {
        "type": "boolean",
        "description": "Whether this clip has been rejected/excluded from gameplay"
      },
      "quality_rating": {
        "type": ["string", "null"],
        "description": "Quality rating (legacy field, use quality_score instead)"
      },
      "species_name": {
        "type": ["string", "null"],
        "description": "Legacy field, use common_name instead"
      },
      "xeno_canto_id": {
        "type": ["string", "null"],
        "description": "Legacy field, use source_id instead"
      }
    },
    "additionalProperties": false
  }
}
